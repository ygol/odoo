odoo.define('web_editor.jabberwock', function(require) {
'use strict';
var JWEditor =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./packages/bundle-odoo-website-editor/odoo-integration.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/@odoo/owl/dist/owl.js":
/*!********************************************!*\
  !*** ./node_modules/@odoo/owl/dist/owl.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, '__esModule', { value: true });

/**
 * We define here a simple event bus: it can
 * - emit events
 * - add/remove listeners.
 *
 * This is a useful pattern of communication in many cases.  For OWL, each
 * components and stores are event buses.
 */
//------------------------------------------------------------------------------
// EventBus
//------------------------------------------------------------------------------
class EventBus {
    constructor() {
        this.subscriptions = {};
    }
    /**
     * Add a listener for the 'eventType' events.
     *
     * Note that the 'owner' of this event can be anything, but will more likely
     * be a component or a class. The idea is that the callback will be called with
     * the proper owner bound.
     *
     * Also, the owner should be kind of unique. This will be used to remove the
     * listener.
     */
    on(eventType, owner, callback) {
        if (!callback) {
            throw new Error("Missing callback");
        }
        if (!this.subscriptions[eventType]) {
            this.subscriptions[eventType] = [];
        }
        this.subscriptions[eventType].push({
            owner,
            callback
        });
    }
    /**
     * Remove a listener
     */
    off(eventType, owner) {
        const subs = this.subscriptions[eventType];
        if (subs) {
            this.subscriptions[eventType] = subs.filter(s => s.owner !== owner);
        }
    }
    /**
     * Emit an event of type 'eventType'.  Any extra arguments will be passed to
     * the listeners callback.
     */
    trigger(eventType, ...args) {
        const subs = this.subscriptions[eventType] || [];
        for (let i = 0, iLen = subs.length; i < iLen; i++) {
            const sub = subs[i];
            sub.callback.call(sub.owner, ...args);
        }
    }
    /**
     * Remove all subscriptions.
     */
    clear() {
        this.subscriptions = {};
    }
}

/**
 * Owl Observer
 *
 * This code contains the logic that allows Owl to observe and react to state
 * changes.
 *
 * This is a Observer class that can observe any JS values.  The way it works
 * can be summarized thusly:
 * - primitive values are not observed at all
 * - Objects and arrays are observed by replacing them with a Proxy
 * - each object/array metadata are tracked in a weakmap, and keep a revision
 *   number
 *
 * Note that this code is loosely inspired by Vue.
 */
//------------------------------------------------------------------------------
// Observer
//------------------------------------------------------------------------------
class Observer {
    constructor() {
        this.rev = 1;
        this.allowMutations = true;
        this.weakMap = new WeakMap();
    }
    notifyCB() { }
    observe(value, parent) {
        if (value === null || typeof value !== "object" || value instanceof Date) {
            // fun fact: typeof null === 'object'
            return value;
        }
        let metadata = this.weakMap.get(value) || this._observe(value, parent);
        return metadata.proxy;
    }
    revNumber(value) {
        const metadata = this.weakMap.get(value);
        return metadata ? metadata.rev : 0;
    }
    _observe(value, parent) {
        var self = this;
        const proxy = new Proxy(value, {
            get(target, k) {
                const targetValue = target[k];
                return self.observe(targetValue, value);
            },
            set(target, key, newVal) {
                const value = target[key];
                if (newVal !== value) {
                    if (!self.allowMutations) {
                        throw new Error(`Observed state cannot be changed here! (key: "${key}", val: "${newVal}")`);
                    }
                    self._updateRevNumber(target);
                    target[key] = newVal;
                    self.notifyCB();
                }
                return true;
            },
            deleteProperty(target, key) {
                if (key in target) {
                    delete target[key];
                    self._updateRevNumber(target);
                    self.notifyCB();
                }
                return true;
            }
        });
        const metadata = {
            value,
            proxy,
            rev: this.rev,
            parent
        };
        this.weakMap.set(value, metadata);
        this.weakMap.set(metadata.proxy, metadata);
        return metadata;
    }
    _updateRevNumber(target) {
        this.rev++;
        let metadata = this.weakMap.get(target);
        let parent = target;
        do {
            metadata = this.weakMap.get(parent);
            metadata.rev++;
        } while ((parent = metadata.parent) && parent !== target);
    }
}

//------------------------------------------------------------------------------
// module/props.ts
//------------------------------------------------------------------------------
function updateProps(oldVnode, vnode) {
    var key, cur, old, elm = vnode.elm, oldProps = oldVnode.data.props, props = vnode.data.props;
    if (!oldProps && !props)
        return;
    if (oldProps === props)
        return;
    oldProps = oldProps || {};
    props = props || {};
    for (key in oldProps) {
        if (!props[key]) {
            delete elm[key];
        }
    }
    for (key in props) {
        cur = props[key];
        old = oldProps[key];
        if (old !== cur && (key !== "value" || elm[key] !== cur)) {
            elm[key] = cur;
        }
    }
}
const propsModule = {
    create: updateProps,
    update: updateProps
};
//------------------------------------------------------------------------------
// module/eventlisteners.ts
//------------------------------------------------------------------------------
function invokeHandler(handler, vnode, event) {
    if (typeof handler === "function") {
        // call function handler
        handler.call(vnode, event, vnode);
    }
    else if (typeof handler === "object") {
        // call handler with arguments
        if (typeof handler[0] === "function") {
            // special case for single argument for performance
            if (handler.length === 2) {
                handler[0].call(vnode, handler[1], event, vnode);
            }
            else {
                var args = handler.slice(1);
                args.push(event);
                args.push(vnode);
                handler[0].apply(vnode, args);
            }
        }
        else {
            // call multiple handlers
            for (let i = 0, iLen = handler.length; i < iLen; i++) {
                invokeHandler(handler[i], vnode, event);
            }
        }
    }
}
function handleEvent(event, vnode) {
    var name = event.type, on = vnode.data.on;
    // call event handler(s) if exists
    if (on) {
        if (on[name]) {
            invokeHandler(on[name], vnode, event);
        }
        else if (on["!" + name]) {
            invokeHandler(on["!" + name], vnode, event);
        }
    }
}
function createListener() {
    return function handler(event) {
        handleEvent(event, handler.vnode);
    };
}
function updateEventListeners(oldVnode, vnode) {
    var oldOn = oldVnode.data.on, oldListener = oldVnode.listener, oldElm = oldVnode.elm, on = vnode && vnode.data.on, elm = (vnode && vnode.elm), name;
    // optimization for reused immutable handlers
    if (oldOn === on) {
        return;
    }
    // remove existing listeners which no longer used
    if (oldOn && oldListener) {
        // if element changed or deleted we remove all existing listeners unconditionally
        if (!on) {
            for (name in oldOn) {
                // remove listener if element was changed or existing listeners removed
                const capture = name.charAt(0) === "!";
                name = capture ? name.slice(1) : name;
                oldElm.removeEventListener(name, oldListener, capture);
            }
        }
        else {
            for (name in oldOn) {
                // remove listener if existing listener removed
                if (!on[name]) {
                    const capture = name.charAt(0) === "!";
                    name = capture ? name.slice(1) : name;
                    oldElm.removeEventListener(name, oldListener, capture);
                }
            }
        }
    }
    // add new listeners which has not already attached
    if (on) {
        // reuse existing listener or create new
        var listener = (vnode.listener = oldVnode.listener || createListener());
        // update vnode for listener
        listener.vnode = vnode;
        // if element changed or added we add all needed listeners unconditionally
        if (!oldOn) {
            for (name in on) {
                // add listener if element was changed or new listeners added
                const capture = name.charAt(0) === "!";
                name = capture ? name.slice(1) : name;
                elm.addEventListener(name, listener, capture);
            }
        }
        else {
            for (name in on) {
                // add listener if new listener added
                if (!oldOn[name]) {
                    const capture = name.charAt(0) === "!";
                    name = capture ? name.slice(1) : name;
                    elm.addEventListener(name, listener, capture);
                }
            }
        }
    }
}
const eventListenersModule = {
    create: updateEventListeners,
    update: updateEventListeners,
    destroy: updateEventListeners
};
//------------------------------------------------------------------------------
// attributes.ts
//------------------------------------------------------------------------------
const xlinkNS = "http://www.w3.org/1999/xlink";
const xmlNS = "http://www.w3.org/XML/1998/namespace";
const colonChar = 58;
const xChar = 120;
function updateAttrs(oldVnode, vnode) {
    var key, elm = vnode.elm, oldAttrs = oldVnode.data.attrs, attrs = vnode.data.attrs;
    if (!oldAttrs && !attrs)
        return;
    if (oldAttrs === attrs)
        return;
    oldAttrs = oldAttrs || {};
    attrs = attrs || {};
    // update modified attributes, add new attributes
    for (key in attrs) {
        const cur = attrs[key];
        const old = oldAttrs[key];
        if (old !== cur) {
            if (cur === true) {
                elm.setAttribute(key, "");
            }
            else if (cur === false) {
                elm.removeAttribute(key);
            }
            else {
                if (key.charCodeAt(0) !== xChar) {
                    elm.setAttribute(key, cur);
                }
                else if (key.charCodeAt(3) === colonChar) {
                    // Assume xml namespace
                    elm.setAttributeNS(xmlNS, key, cur);
                }
                else if (key.charCodeAt(5) === colonChar) {
                    // Assume xlink namespace
                    elm.setAttributeNS(xlinkNS, key, cur);
                }
                else {
                    elm.setAttribute(key, cur);
                }
            }
        }
    }
    // remove removed attributes
    // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)
    // the other option is to remove all attributes with value == undefined
    for (key in oldAttrs) {
        if (!(key in attrs)) {
            elm.removeAttribute(key);
        }
    }
}
const attrsModule = {
    create: updateAttrs,
    update: updateAttrs
};
//------------------------------------------------------------------------------
// class.ts
//------------------------------------------------------------------------------
function updateClass(oldVnode, vnode) {
    var cur, name, elm, oldClass = oldVnode.data.class, klass = vnode.data.class;
    if (!oldClass && !klass)
        return;
    if (oldClass === klass)
        return;
    oldClass = oldClass || {};
    klass = klass || {};
    elm = vnode.elm;
    for (name in oldClass) {
        if (name && !klass[name]) {
            elm.classList.remove(name);
        }
    }
    for (name in klass) {
        cur = klass[name];
        if (cur !== oldClass[name]) {
            elm.classList[cur ? "add" : "remove"](name);
        }
    }
}
const classModule = { create: updateClass, update: updateClass };

/**
 * Owl VDOM
 *
 * This file contains an implementation of a virtual DOM, which is a system that
 * can generate in-memory representations of a DOM tree, compare them, and
 * eventually change a concrete DOM tree to match its representation, in an
 * hopefully efficient way.
 *
 * Note that this code is a fork of Snabbdom, slightly tweaked/optimized for our
 * needs (see https://github.com/snabbdom/snabbdom).
 *
 * The main exported values are:
 * - interface VNode
 * - h function (a helper function to generate a vnode)
 * - patch function (to apply a vnode to an actual DOM node)
 */
function vnode(sel, data, children, text, elm) {
    let key = data === undefined ? undefined : data.key;
    return { sel, data, children, text, elm, key };
}
//------------------------------------------------------------------------------
// snabbdom.ts
//------------------------------------------------------------------------------
function isUndef(s) {
    return s === undefined;
}
function isDef(s) {
    return s !== undefined;
}
const emptyNode = vnode("", {}, [], undefined, undefined);
function sameVnode(vnode1, vnode2) {
    return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;
}
function isVnode(vnode) {
    return vnode.sel !== undefined;
}
function createKeyToOldIdx(children, beginIdx, endIdx) {
    let i, map = {}, key, ch;
    for (i = beginIdx; i <= endIdx; ++i) {
        ch = children[i];
        if (ch != null) {
            key = ch.key;
            if (key !== undefined)
                map[key] = i;
        }
    }
    return map;
}
const hooks = ["create", "update", "remove", "destroy", "pre", "post"];
function init(modules, domApi) {
    let i, j, cbs = {};
    const api = domApi !== undefined ? domApi : htmlDomApi;
    for (i = 0; i < hooks.length; ++i) {
        cbs[hooks[i]] = [];
        for (j = 0; j < modules.length; ++j) {
            const hook = modules[j][hooks[i]];
            if (hook !== undefined) {
                cbs[hooks[i]].push(hook);
            }
        }
    }
    function emptyNodeAt(elm) {
        const id = elm.id ? "#" + elm.id : "";
        const c = elm.className ? "." + elm.className.split(" ").join(".") : "";
        return vnode(api.tagName(elm).toLowerCase() + id + c, {}, [], undefined, elm);
    }
    function createRmCb(childElm, listeners) {
        return function rmCb() {
            if (--listeners === 0) {
                const parent = api.parentNode(childElm);
                api.removeChild(parent, childElm);
            }
        };
    }
    function createElm(vnode, insertedVnodeQueue) {
        let i, iLen, data = vnode.data;
        if (data !== undefined) {
            if (isDef((i = data.hook)) && isDef((i = i.init))) {
                i(vnode);
                data = vnode.data;
            }
        }
        let children = vnode.children, sel = vnode.sel;
        if (sel === "!") {
            if (isUndef(vnode.text)) {
                vnode.text = "";
            }
            vnode.elm = api.createComment(vnode.text);
        }
        else if (sel !== undefined) {
            const elm = vnode.elm ||
                (vnode.elm =
                    isDef(data) && isDef((i = data.ns))
                        ? api.createElementNS(i, sel)
                        : api.createElement(sel));
            for (i = 0, iLen = cbs.create.length; i < iLen; ++i)
                cbs.create[i](emptyNode, vnode);
            if (array(children)) {
                for (i = 0, iLen = children.length; i < iLen; ++i) {
                    const ch = children[i];
                    if (ch != null) {
                        api.appendChild(elm, createElm(ch, insertedVnodeQueue));
                    }
                }
            }
            else if (primitive(vnode.text)) {
                api.appendChild(elm, api.createTextNode(vnode.text));
            }
            i = vnode.data.hook; // Reuse variable
            if (isDef(i)) {
                if (i.create)
                    i.create(emptyNode, vnode);
                if (i.insert)
                    insertedVnodeQueue.push(vnode);
            }
        }
        else {
            vnode.elm = api.createTextNode(vnode.text);
        }
        return vnode.elm;
    }
    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {
        for (; startIdx <= endIdx; ++startIdx) {
            const ch = vnodes[startIdx];
            if (ch != null) {
                api.insertBefore(parentElm, createElm(ch, insertedVnodeQueue), before);
            }
        }
    }
    function invokeDestroyHook(vnode) {
        let i, iLen, j, jLen, data = vnode.data;
        if (data !== undefined) {
            if (isDef((i = data.hook)) && isDef((i = i.destroy)))
                i(vnode);
            for (i = 0, iLen = cbs.destroy.length; i < iLen; ++i)
                cbs.destroy[i](vnode);
            if (vnode.children !== undefined) {
                for (j = 0, jLen = vnode.children.length; j < jLen; ++j) {
                    i = vnode.children[j];
                    if (i != null && typeof i !== "string") {
                        invokeDestroyHook(i);
                    }
                }
            }
        }
    }
    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {
        for (; startIdx <= endIdx; ++startIdx) {
            let i, iLen, listeners, rm, ch = vnodes[startIdx];
            if (ch != null) {
                if (isDef(ch.sel)) {
                    invokeDestroyHook(ch);
                    listeners = cbs.remove.length + 1;
                    rm = createRmCb(ch.elm, listeners);
                    for (i = 0, iLen = cbs.remove.length; i < iLen; ++i)
                        cbs.remove[i](ch, rm);
                    if (isDef((i = ch.data)) && isDef((i = i.hook)) && isDef((i = i.remove))) {
                        i(ch, rm);
                    }
                    else {
                        rm();
                    }
                }
                else {
                    // Text node
                    api.removeChild(parentElm, ch.elm);
                }
            }
        }
    }
    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {
        let oldStartIdx = 0, newStartIdx = 0;
        let oldEndIdx = oldCh.length - 1;
        let oldStartVnode = oldCh[0];
        let oldEndVnode = oldCh[oldEndIdx];
        let newEndIdx = newCh.length - 1;
        let newStartVnode = newCh[0];
        let newEndVnode = newCh[newEndIdx];
        let oldKeyToIdx;
        let idxInOld;
        let elmToMove;
        let before;
        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {
            if (oldStartVnode == null) {
                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left
            }
            else if (oldEndVnode == null) {
                oldEndVnode = oldCh[--oldEndIdx];
            }
            else if (newStartVnode == null) {
                newStartVnode = newCh[++newStartIdx];
            }
            else if (newEndVnode == null) {
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldStartVnode, newStartVnode)) {
                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);
                oldStartVnode = oldCh[++oldStartIdx];
                newStartVnode = newCh[++newStartIdx];
            }
            else if (sameVnode(oldEndVnode, newEndVnode)) {
                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);
                oldEndVnode = oldCh[--oldEndIdx];
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldStartVnode, newEndVnode)) {
                // Vnode moved right
                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);
                api.insertBefore(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));
                oldStartVnode = oldCh[++oldStartIdx];
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldEndVnode, newStartVnode)) {
                // Vnode moved left
                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);
                api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);
                oldEndVnode = oldCh[--oldEndIdx];
                newStartVnode = newCh[++newStartIdx];
            }
            else {
                if (oldKeyToIdx === undefined) {
                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);
                }
                idxInOld = oldKeyToIdx[newStartVnode.key];
                if (isUndef(idxInOld)) {
                    // New element
                    api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);
                    newStartVnode = newCh[++newStartIdx];
                }
                else {
                    elmToMove = oldCh[idxInOld];
                    if (elmToMove.sel !== newStartVnode.sel) {
                        api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);
                    }
                    else {
                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);
                        oldCh[idxInOld] = undefined;
                        api.insertBefore(parentElm, elmToMove.elm, oldStartVnode.elm);
                    }
                    newStartVnode = newCh[++newStartIdx];
                }
            }
        }
        if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {
            if (oldStartIdx > oldEndIdx) {
                before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;
                addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);
            }
            else {
                removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);
            }
        }
    }
    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {
        let i, iLen, hook;
        if (isDef((i = vnode.data)) && isDef((hook = i.hook)) && isDef((i = hook.prepatch))) {
            i(oldVnode, vnode);
        }
        const elm = (vnode.elm = oldVnode.elm);
        let oldCh = oldVnode.children;
        let ch = vnode.children;
        if (oldVnode === vnode)
            return;
        if (vnode.data !== undefined) {
            for (i = 0, iLen = cbs.update.length; i < iLen; ++i)
                cbs.update[i](oldVnode, vnode);
            i = vnode.data.hook;
            if (isDef(i) && isDef((i = i.update)))
                i(oldVnode, vnode);
        }
        if (isUndef(vnode.text)) {
            if (isDef(oldCh) && isDef(ch)) {
                if (oldCh !== ch)
                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);
            }
            else if (isDef(ch)) {
                if (isDef(oldVnode.text))
                    api.setTextContent(elm, "");
                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);
            }
            else if (isDef(oldCh)) {
                removeVnodes(elm, oldCh, 0, oldCh.length - 1);
            }
            else if (isDef(oldVnode.text)) {
                api.setTextContent(elm, "");
            }
        }
        else if (oldVnode.text !== vnode.text) {
            if (isDef(oldCh)) {
                removeVnodes(elm, oldCh, 0, oldCh.length - 1);
            }
            api.setTextContent(elm, vnode.text);
        }
        if (isDef(hook) && isDef((i = hook.postpatch))) {
            i(oldVnode, vnode);
        }
    }
    return function patch(oldVnode, vnode) {
        let i, iLen, elm, parent;
        const insertedVnodeQueue = [];
        for (i = 0, iLen = cbs.pre.length; i < iLen; ++i)
            cbs.pre[i]();
        if (!isVnode(oldVnode)) {
            oldVnode = emptyNodeAt(oldVnode);
        }
        if (sameVnode(oldVnode, vnode)) {
            patchVnode(oldVnode, vnode, insertedVnodeQueue);
        }
        else {
            elm = oldVnode.elm;
            parent = api.parentNode(elm);
            createElm(vnode, insertedVnodeQueue);
            if (parent !== null) {
                api.insertBefore(parent, vnode.elm, api.nextSibling(elm));
                removeVnodes(parent, [oldVnode], 0, 0);
            }
        }
        for (i = 0, iLen = insertedVnodeQueue.length; i < iLen; ++i) {
            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);
        }
        for (i = 0, iLen = cbs.post.length; i < iLen; ++i)
            cbs.post[i]();
        return vnode;
    };
}
//------------------------------------------------------------------------------
// is.ts
//------------------------------------------------------------------------------
const array = Array.isArray;
function primitive(s) {
    return typeof s === "string" || typeof s === "number";
}
function createElement(tagName) {
    return document.createElement(tagName);
}
function createElementNS(namespaceURI, qualifiedName) {
    return document.createElementNS(namespaceURI, qualifiedName);
}
function createTextNode(text) {
    return document.createTextNode(text);
}
function createComment(text) {
    return document.createComment(text);
}
function insertBefore(parentNode, newNode, referenceNode) {
    parentNode.insertBefore(newNode, referenceNode);
}
function removeChild(node, child) {
    node.removeChild(child);
}
function appendChild(node, child) {
    node.appendChild(child);
}
function parentNode(node) {
    return node.parentNode;
}
function nextSibling(node) {
    return node.nextSibling;
}
function tagName(elm) {
    return elm.tagName;
}
function setTextContent(node, text) {
    node.textContent = text;
}
const htmlDomApi = {
    createElement,
    createElementNS,
    createTextNode,
    createComment,
    insertBefore,
    removeChild,
    appendChild,
    parentNode,
    nextSibling,
    tagName,
    setTextContent
};
function addNS(data, children, sel) {
    if (sel === "dummy") {
        // we do not need to add the namespace on dummy elements, they come from a
        // subcomponent, which will handle the namespace itself
        return;
    }
    data.ns = "http://www.w3.org/2000/svg";
    if (sel !== "foreignObject" && children !== undefined) {
        for (let i = 0, iLen = children.length; i < iLen; ++i) {
            const child = children[i];
            let childData = child.data;
            if (childData !== undefined) {
                addNS(childData, child.children, child.sel);
            }
        }
    }
}
function h(sel, b, c) {
    var data = {}, children, text, i, iLen;
    if (c !== undefined) {
        data = b;
        if (array(c)) {
            children = c;
        }
        else if (primitive(c)) {
            text = c;
        }
        else if (c && c.sel) {
            children = [c];
        }
    }
    else if (b !== undefined) {
        if (array(b)) {
            children = b;
        }
        else if (primitive(b)) {
            text = b;
        }
        else if (b && b.sel) {
            children = [b];
        }
        else {
            data = b;
        }
    }
    if (children !== undefined) {
        for (i = 0, iLen = children.length; i < iLen; ++i) {
            if (primitive(children[i]))
                children[i] = vnode(undefined, undefined, undefined, children[i], undefined);
        }
    }
    return vnode(sel, data, children, text, undefined);
}

const patch = init([eventListenersModule, attrsModule, propsModule, classModule]);

/**
 * Owl QWeb Expression Parser
 *
 * Owl needs in various contexts to be able to understand the structure of a
 * string representing a javascript expression.  The usual goal is to be able
 * to rewrite some variables.  For example, if a template has
 *
 *  ```xml
 *  <t t-if="computeSomething({val: state.val})">...</t>
 * ```
 *
 * this needs to be translated in something like this:
 *
 * ```js
 *   if (context["computeSomething"]({val: context["state"].val})) { ... }
 * ```
 *
 * This file contains the implementation of an extremely naive tokenizer/parser
 * and evaluator for javascript expressions.  The supported grammar is basically
 * only expressive enough to understand the shape of objects, of arrays, and
 * various operators.
 */
//------------------------------------------------------------------------------
// Misc types, constants and helpers
//------------------------------------------------------------------------------
const RESERVED_WORDS = "true,false,NaN,null,undefined,debugger,console,window,in,instanceof,new,function,return,this,eval,void,Math,RegExp,Array,Object,Date".split(",");
const WORD_REPLACEMENT = {
    and: "&&",
    or: "||",
    gt: ">",
    gte: ">=",
    lt: "<",
    lte: "<="
};
const STATIC_TOKEN_MAP = {
    "{": "LEFT_BRACE",
    "}": "RIGHT_BRACE",
    "[": "LEFT_BRACKET",
    "]": "RIGHT_BRACKET",
    ":": "COLON",
    ",": "COMMA",
    "(": "LEFT_PAREN",
    ")": "RIGHT_PAREN"
};
// note that the space after typeof is relevant. It makes sure that the formatted
// expression has a space after typeof
const OPERATORS = "...,.,===,==,+,!==,!=,!,||,&&,>=,>,<=,<,?,-,*,/,%,typeof ,=>,=,;,in ".split(",");
let tokenizeString = function (expr) {
    let s = expr[0];
    let start = s;
    if (s !== "'" && s !== '"') {
        return false;
    }
    let i = 1;
    let cur;
    while (expr[i] && expr[i] !== start) {
        cur = expr[i];
        s += cur;
        if (cur === "\\") {
            i++;
            cur = expr[i];
            if (!cur) {
                throw new Error("Invalid expression");
            }
            s += cur;
        }
        i++;
    }
    if (expr[i] !== start) {
        throw new Error("Invalid expression");
    }
    s += start;
    return { type: "VALUE", value: s };
};
let tokenizeNumber = function (expr) {
    let s = expr[0];
    if (s && s.match(/[0-9]/)) {
        let i = 1;
        while (expr[i] && expr[i].match(/[0-9]|\./)) {
            s += expr[i];
            i++;
        }
        return { type: "VALUE", value: s };
    }
    else {
        return false;
    }
};
let tokenizeSymbol = function (expr) {
    let s = expr[0];
    if (s && s.match(/[a-zA-Z_\$]/)) {
        let i = 1;
        while (expr[i] && expr[i].match(/\w/)) {
            s += expr[i];
            i++;
        }
        if (s in WORD_REPLACEMENT) {
            return { type: "OPERATOR", value: WORD_REPLACEMENT[s], size: s.length };
        }
        return { type: "SYMBOL", value: s };
    }
    else {
        return false;
    }
};
const tokenizeStatic = function (expr) {
    const char = expr[0];
    if (char && char in STATIC_TOKEN_MAP) {
        return { type: STATIC_TOKEN_MAP[char], value: char };
    }
    return false;
};
const tokenizeOperator = function (expr) {
    for (let op of OPERATORS) {
        if (expr.startsWith(op)) {
            return { type: "OPERATOR", value: op };
        }
    }
    return false;
};
const TOKENIZERS = [
    tokenizeString,
    tokenizeNumber,
    tokenizeOperator,
    tokenizeSymbol,
    tokenizeStatic
];
/**
 * Convert a javascript expression (as a string) into a list of tokens. For
 * example: `tokenize("1 + b")` will return:
 * ```js
 *  [
 *   {type: "VALUE", value: "1"},
 *   {type: "OPERATOR", value: "+"},
 *   {type: "SYMBOL", value: "b"}
 * ]
 * ```
 */
function tokenize(expr) {
    const result = [];
    let token = true;
    while (token) {
        expr = expr.trim();
        if (expr) {
            for (let tokenizer of TOKENIZERS) {
                token = tokenizer(expr);
                if (token) {
                    result.push(token);
                    expr = expr.slice(token.size || token.value.length);
                    break;
                }
            }
        }
        else {
            token = false;
        }
    }
    if (expr.length) {
        throw new Error(`Tokenizer error: could not tokenize "${expr}"`);
    }
    return result;
}
//------------------------------------------------------------------------------
// Expression "evaluator"
//------------------------------------------------------------------------------
/**
 * This is the main function exported by this file. This is the code that will
 * process an expression (given as a string) and returns another expression with
 * proper lookups in the context.
 *
 * Usually, this kind of code would be very simple to do if we had an AST (so,
 * if we had a javascript parser), since then, we would only need to find the
 * variables and replace them.  However, a parser is more complicated, and there
 * are no standard builtin parser API.
 *
 * Since this method is applied to simple javasript expressions, and the work to
 * be done is actually quite simple, we actually can get away with not using a
 * parser, which helps with the code size.
 *
 * Here is the heuristic used by this method to determine if a token is a
 * variable:
 * - by default, all symbols are considered a variable
 * - unless the previous token is a dot (in that case, this is a property: `a.b`)
 * - or if the previous token is a left brace or a comma, and the next token is
 *   a colon (in that case, this is an object key: `{a: b}`)
 *
 * Some specific code is also required to support arrow functions. If we detect
 * the arrow operator, then we add the current (or some previous tokens) token to
 * the list of variables so it does not get replaced by a lookup in the context
 */
function compileExprToArray(expr, scope) {
    scope = Object.create(scope);
    const tokens = tokenize(expr);
    for (let i = 0; i < tokens.length; i++) {
        let token = tokens[i];
        let prevToken = tokens[i - 1];
        let nextToken = tokens[i + 1];
        let isVar = token.type === "SYMBOL" && !RESERVED_WORDS.includes(token.value);
        if (token.type === "SYMBOL" && !RESERVED_WORDS.includes(token.value)) {
            if (prevToken) {
                if (prevToken.type === "OPERATOR" && prevToken.value === ".") {
                    isVar = false;
                }
                else if (prevToken.type === "LEFT_BRACE" || prevToken.type === "COMMA") {
                    if (nextToken && nextToken.type === "COLON") {
                        isVar = false;
                    }
                }
            }
        }
        if (nextToken && nextToken.type === "OPERATOR" && nextToken.value === "=>") {
            if (token.type === "RIGHT_PAREN") {
                let j = i - 1;
                while (j > 0 && tokens[j].type !== "LEFT_PAREN") {
                    if (tokens[j].type === "SYMBOL" && tokens[j].originalValue) {
                        tokens[j].value = tokens[j].originalValue;
                        scope[tokens[j].value] = { id: tokens[j].value, expr: tokens[j].value };
                    }
                    j--;
                }
            }
            else {
                scope[token.value] = { id: token.value, expr: token.value };
            }
        }
        if (isVar) {
            token.varName = token.value;
            if (token.value in scope && "id" in scope[token.value]) {
                token.value = scope[token.value].expr;
            }
            else {
                token.originalValue = token.value;
                token.value = `scope['${token.value}']`;
            }
        }
    }
    return tokens;
}
function compileExpr(expr, scope) {
    return compileExprToArray(expr, scope)
        .map(t => t.value)
        .join("");
}

const INTERP_REGEXP = /\{\{.*?\}\}/g;
//------------------------------------------------------------------------------
// Compilation Context
//------------------------------------------------------------------------------
class CompilationContext {
    constructor(name) {
        this.code = [];
        this.variables = {};
        this.escaping = false;
        this.parentNode = null;
        this.parentTextNode = null;
        this.rootNode = null;
        this.indentLevel = 0;
        this.shouldDefineParent = false;
        this.shouldDefineScope = false;
        this.protectedScopeNumber = 0;
        this.shouldDefineQWeb = false;
        this.shouldDefineUtils = false;
        this.shouldDefineRefs = false;
        this.shouldDefineResult = true;
        this.loopNumber = 0;
        this.inPreTag = false;
        this.allowMultipleRoots = false;
        this.hasParentWidget = false;
        this.hasKey0 = false;
        this.keyStack = [];
        this.rootContext = this;
        this.templateName = name || "noname";
        this.addLine("let h = this.h;");
    }
    generateID() {
        return CompilationContext.nextID++;
    }
    /**
     * This method generates a "template key", which is basically a unique key
     * which depends on the currently set keys, and on the iteration numbers (if
     * we are in a loop).
     *
     * Such a key is necessary when we need to associate an id to some element
     * generated by a template (for example, a component)
     */
    generateTemplateKey(prefix = "") {
        const id = this.generateID();
        if (this.loopNumber === 0 && !this.hasKey0) {
            return `'${prefix}__${id}__'`;
        }
        let key = `\`${prefix}__${id}__`;
        let start = this.hasKey0 ? 0 : 1;
        for (let i = start; i < this.loopNumber + 1; i++) {
            key += `\${key${i}}__`;
        }
        this.addLine(`let k${id} = ${key}\`;`);
        return `k${id}`;
    }
    generateCode() {
        if (this.shouldDefineResult) {
            this.code.unshift("    let result;");
        }
        if (this.shouldDefineScope) {
            this.code.unshift("    let scope = Object.create(context);");
        }
        if (this.shouldDefineRefs) {
            this.code.unshift("    context.__owl__.refs = context.__owl__.refs || {};");
        }
        if (this.shouldDefineParent) {
            if (this.hasParentWidget) {
                this.code.unshift("    let parent = extra.parent;");
            }
            else {
                this.code.unshift("    let parent = context;");
            }
        }
        if (this.shouldDefineQWeb) {
            this.code.unshift("    let QWeb = this.constructor;");
        }
        if (this.shouldDefineUtils) {
            this.code.unshift("    let utils = this.constructor.utils;");
        }
        return this.code;
    }
    withParent(node) {
        if (!this.allowMultipleRoots &&
            this === this.rootContext &&
            (this.parentNode || this.parentTextNode)) {
            throw new Error("A template should not have more than one root node");
        }
        if (!this.rootContext.rootNode) {
            this.rootContext.rootNode = node;
        }
        if (!this.parentNode && this.rootContext.shouldDefineResult) {
            this.addLine(`result = vn${node};`);
        }
        return this.subContext("parentNode", node);
    }
    subContext(key, value) {
        const newContext = Object.create(this);
        newContext[key] = value;
        return newContext;
    }
    indent() {
        this.rootContext.indentLevel++;
    }
    dedent() {
        this.rootContext.indentLevel--;
    }
    addLine(line) {
        const prefix = new Array(this.indentLevel + 2).join("    ");
        this.code.push(prefix + line);
        return this.code.length - 1;
    }
    addIf(condition) {
        this.addLine(`if (${condition}) {`);
        this.indent();
    }
    addElse() {
        this.dedent();
        this.addLine("} else {");
        this.indent();
    }
    closeIf() {
        this.dedent();
        this.addLine("}");
    }
    getValue(val) {
        return val in this.variables ? this.getValue(this.variables[val]) : val;
    }
    /**
     * Prepare an expression for being consumed at render time.  Its main job
     * is to
     * - replace unknown variables by a lookup in the context
     * - replace already defined variables by their internal name
     */
    formatExpression(expr) {
        this.rootContext.shouldDefineScope = true;
        return compileExpr(expr, this.variables);
    }
    captureExpression(expr) {
        this.rootContext.shouldDefineScope = true;
        const argId = this.generateID();
        const tokens = compileExprToArray(expr, this.variables);
        const done = new Set();
        return tokens
            .map(tok => {
            if (tok.varName) {
                if (!done.has(tok.varName)) {
                    done.add(tok.varName);
                    this.addLine(`const ${tok.varName}_${argId} = ${tok.value};`);
                }
                tok.value = `${tok.varName}_${argId}`;
            }
            return tok.value;
        })
            .join("");
    }
    /**
     * Perform string interpolation on the given string. Note that if the whole
     * string is an expression, it simply returns it (formatted and enclosed in
     * parentheses).
     * For instance:
     *   'Hello {{x}}!' -> `Hello ${x}`
     *   '{{x ? 'a': 'b'}}' -> (x ? 'a' : 'b')
     */
    interpolate(s) {
        let matches = s.match(INTERP_REGEXP);
        if (matches && matches[0].length === s.length) {
            return `(${this.formatExpression(s.slice(2, -2))})`;
        }
        let r = s.replace(/\{\{.*?\}\}/g, s => "${" + this.formatExpression(s.slice(2, -2)) + "}");
        return "`" + r + "`";
    }
    startProtectScope(codeBlock) {
        const protectID = this.generateID();
        this.rootContext.protectedScopeNumber++;
        this.rootContext.shouldDefineScope = true;
        const scopeExpr = `Object.create(scope);`;
        this.addLine(`let _origScope${protectID} = scope;`);
        this.addLine(`scope = ${scopeExpr}`);
        if (!codeBlock) {
            this.addLine(`scope.__access_mode__ = 'ro';`);
        }
        return protectID;
    }
    stopProtectScope(protectID) {
        this.rootContext.protectedScopeNumber--;
        this.addLine(`scope = _origScope${protectID};`);
    }
}
CompilationContext.nextID = 1;

const browser = {
    setTimeout: window.setTimeout.bind(window),
    clearTimeout: window.clearTimeout.bind(window),
    setInterval: window.setInterval.bind(window),
    clearInterval: window.clearInterval.bind(window),
    requestAnimationFrame: window.requestAnimationFrame.bind(window),
    random: Math.random,
    Date: window.Date,
    fetch: (window.fetch || (() => { })).bind(window),
    localStorage: window.localStorage
};

/**
 * Owl Utils
 *
 * We have here a small collection of utility functions:
 *
 * - whenReady
 * - loadJS
 * - loadFile
 * - escape
 * - debounce
 */
function whenReady(fn) {
    return new Promise(function (resolve) {
        if (document.readyState !== "loading") {
            resolve();
        }
        else {
            document.addEventListener("DOMContentLoaded", resolve, false);
        }
    }).then(fn || function () { });
}
const loadedScripts = {};
function loadJS(url) {
    if (url in loadedScripts) {
        return loadedScripts[url];
    }
    const promise = new Promise(function (resolve, reject) {
        const script = document.createElement("script");
        script.type = "text/javascript";
        script.src = url;
        script.onload = function () {
            resolve();
        };
        script.onerror = function () {
            reject(`Error loading file '${url}'`);
        };
        const head = document.head || document.getElementsByTagName("head")[0];
        head.appendChild(script);
    });
    loadedScripts[url] = promise;
    return promise;
}
async function loadFile(url) {
    const result = await browser.fetch(url);
    if (!result.ok) {
        throw new Error("Error while fetching xml templates");
    }
    return await result.text();
}
function escape(str) {
    if (str === undefined) {
        return "";
    }
    if (typeof str === "number") {
        return String(str);
    }
    const p = document.createElement("p");
    p.textContent = str;
    return p.innerHTML;
}
/**
 * Returns a function, that, as long as it continues to be invoked, will not
 * be triggered. The function will be called after it stops being called for
 * N milliseconds. If `immediate` is passed, trigger the function on the
 * leading edge, instead of the trailing.
 *
 * Inspired by https://davidwalsh.name/javascript-debounce-function
 */
function debounce(func, wait, immediate) {
    let timeout;
    return function () {
        const context = this;
        const args = arguments;
        function later() {
            timeout = null;
            if (!immediate) {
                func.apply(context, args);
            }
        }
        const callNow = immediate && !timeout;
        browser.clearTimeout(timeout);
        timeout = browser.setTimeout(later, wait);
        if (callNow) {
            func.apply(context, args);
        }
    };
}
function shallowEqual(p1, p2) {
    for (let k in p1) {
        if (p1[k] !== p2[k]) {
            return false;
        }
    }
    return true;
}

var _utils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    whenReady: whenReady,
    loadJS: loadJS,
    loadFile: loadFile,
    escape: escape,
    debounce: debounce,
    shallowEqual: shallowEqual
});

//------------------------------------------------------------------------------
// Const/global stuff/helpers
//------------------------------------------------------------------------------
const DISABLED_TAGS = ["input", "textarea", "button", "select", "option", "optgroup"];
const TRANSLATABLE_ATTRS = ["label", "title", "placeholder", "alt"];
const lineBreakRE = /[\r\n]/;
const whitespaceRE = /\s+/g;
const NODE_HOOKS_PARAMS = {
    create: "(_, n)",
    insert: "vn",
    remove: "(vn, rm)",
    destroy: "()"
};
function isComponent(obj) {
    return obj && obj.hasOwnProperty("__owl__");
}
const UTILS = {
    zero: Symbol("zero"),
    toObj(expr) {
        if (typeof expr === "string") {
            expr = expr.trim();
            if (!expr) {
                return {};
            }
            let words = expr.split(/\s+/);
            let result = {};
            for (let i = 0; i < words.length; i++) {
                result[words[i]] = true;
            }
            return result;
        }
        return expr;
    },
    shallowEqual,
    addNameSpace(vnode) {
        addNS(vnode.data, vnode.children, vnode.sel);
    },
    VDomArray: class VDomArray extends Array {
    },
    vDomToString: function (vdom) {
        return vdom
            .map(vnode => {
            if (vnode.sel) {
                const node = document.createElement(vnode.sel);
                const result = patch(node, vnode);
                return result.elm.outerHTML;
            }
            else {
                return vnode.text;
            }
        })
            .join("");
    },
    getComponent(obj) {
        while (obj && !isComponent(obj)) {
            obj = obj.__proto__;
        }
        return obj;
    },
    getScope(obj, property) {
        const obj0 = obj;
        while (obj &&
            !obj.hasOwnProperty(property) &&
            !(obj.hasOwnProperty("__access_mode__") && obj.__access_mode__ === "ro")) {
            const newObj = obj.__proto__;
            if (!newObj || isComponent(newObj)) {
                return obj0;
            }
            obj = newObj;
        }
        return obj;
    }
};
function parseXML(xml) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(xml, "text/xml");
    if (doc.getElementsByTagName("parsererror").length) {
        let msg = "Invalid XML in template.";
        const parsererrorText = doc.getElementsByTagName("parsererror")[0].textContent;
        if (parsererrorText) {
            msg += "\nThe parser has produced the following error message:\n" + parsererrorText;
            const re = /\d+/g;
            const firstMatch = re.exec(parsererrorText);
            if (firstMatch) {
                const lineNumber = Number(firstMatch[0]);
                const line = xml.split("\n")[lineNumber - 1];
                const secondMatch = re.exec(parsererrorText);
                if (line && secondMatch) {
                    const columnIndex = Number(secondMatch[0]) - 1;
                    if (line[columnIndex]) {
                        msg +=
                            `\nThe error might be located at xml line ${lineNumber} column ${columnIndex}\n` +
                                `${line}\n${"-".repeat(columnIndex - 1)}^`;
                    }
                }
            }
        }
        throw new Error(msg);
    }
    return doc;
}
function escapeQuotes(str) {
    return str.replace(/\'/g, "\\'");
}
//------------------------------------------------------------------------------
// QWeb rendering engine
//------------------------------------------------------------------------------
class QWeb extends EventBus {
    constructor(config = {}) {
        super();
        this.h = h;
        // recursiveTemplates contains sub templates called with t-call, but which
        // ends up in recursive situations.  This is very similar to the slot situation,
        // as in we need to propagate the scope.
        this.subTemplates = {};
        this.isUpdating = false;
        this.templates = Object.create(QWeb.TEMPLATES);
        if (config.templates) {
            this.addTemplates(config.templates);
        }
        if (config.translateFn) {
            this.translateFn = config.translateFn;
        }
    }
    static addDirective(directive) {
        if (directive.name in QWeb.DIRECTIVE_NAMES) {
            throw new Error(`Directive "${directive.name} already registered`);
        }
        QWeb.DIRECTIVES.push(directive);
        QWeb.DIRECTIVE_NAMES[directive.name] = 1;
        QWeb.DIRECTIVES.sort((d1, d2) => d1.priority - d2.priority);
        if (directive.extraNames) {
            directive.extraNames.forEach(n => (QWeb.DIRECTIVE_NAMES[n] = 1));
        }
    }
    static registerComponent(name, Component) {
        if (QWeb.components[name]) {
            throw new Error(`Component '${name}' has already been registered`);
        }
        QWeb.components[name] = Component;
    }
    /**
     * Register globally a template.  All QWeb instances will obtain their
     * templates from their own template map, and then, from the global static
     * TEMPLATES property.
     */
    static registerTemplate(name, template) {
        if (QWeb.TEMPLATES[name]) {
            throw new Error(`Template '${name}' has already been registered`);
        }
        const qweb = new QWeb();
        qweb.addTemplate(name, template);
        QWeb.TEMPLATES[name] = qweb.templates[name];
    }
    /**
     * Add a template to the internal template map.  Note that it is not
     * immediately compiled.
     */
    addTemplate(name, xmlString, allowDuplicate) {
        if (allowDuplicate && name in this.templates) {
            return;
        }
        const doc = parseXML(xmlString);
        if (!doc.firstChild) {
            throw new Error("Invalid template (should not be empty)");
        }
        this._addTemplate(name, doc.firstChild);
    }
    /**
     * Load templates from a xml (as a string or xml document).  This will look up
     * for the first <templates> tag, and will consider each child of this as a
     * template, with the name given by the t-name attribute.
     */
    addTemplates(xmlstr) {
        const doc = typeof xmlstr === "string" ? parseXML(xmlstr) : xmlstr;
        const templates = doc.getElementsByTagName("templates")[0];
        if (!templates) {
            return;
        }
        for (let elem of templates.children) {
            const name = elem.getAttribute("t-name");
            this._addTemplate(name, elem);
        }
    }
    _addTemplate(name, elem) {
        if (name in this.templates) {
            throw new Error(`Template ${name} already defined`);
        }
        this._processTemplate(elem);
        const template = {
            elem,
            fn: function (context, extra) {
                const compiledFunction = this._compile(name, elem);
                template.fn = compiledFunction;
                return compiledFunction.call(this, context, extra);
            }
        };
        this.templates[name] = template;
    }
    _processTemplate(elem) {
        let tbranch = elem.querySelectorAll("[t-elif], [t-else]");
        for (let i = 0, ilen = tbranch.length; i < ilen; i++) {
            let node = tbranch[i];
            let prevElem = node.previousElementSibling;
            let pattr = function (name) {
                return prevElem.getAttribute(name);
            };
            let nattr = function (name) {
                return +!!node.getAttribute(name);
            };
            if (prevElem && (pattr("t-if") || pattr("t-elif"))) {
                if (pattr("t-foreach")) {
                    throw new Error("t-if cannot stay at the same level as t-foreach when using t-elif or t-else");
                }
                if (["t-if", "t-elif", "t-else"].map(nattr).reduce(function (a, b) {
                    return a + b;
                }) > 1) {
                    throw new Error("Only one conditional branching directive is allowed per node");
                }
                // All text (with only spaces) and comment nodes (nodeType 8) between
                // branch nodes are removed
                let textNode;
                while ((textNode = node.previousSibling) !== prevElem) {
                    if (textNode.nodeValue.trim().length && textNode.nodeType !== 8) {
                        throw new Error("text is not allowed between branching directives");
                    }
                    textNode.remove();
                }
            }
            else {
                throw new Error("t-elif and t-else directives must be preceded by a t-if or t-elif directive");
            }
        }
    }
    /**
     * Render a template
     *
     * @param {string} name the template should already have been added
     */
    render(name, context = {}, extra = null) {
        const template = this.templates[name];
        if (!template) {
            throw new Error(`Template ${name} does not exist`);
        }
        return template.fn.call(this, context, extra);
    }
    /**
     * Render a template to a html string.
     *
     * Note that this is more limited than the `render` method: it is not suitable
     * to render a full component tree, since this is an asynchronous operation.
     * This method can only render templates without components.
     */
    renderToString(name, context = {}, extra) {
        const vnode = this.render(name, context, extra);
        if (vnode.sel === undefined) {
            return vnode.text;
        }
        const node = document.createElement(vnode.sel);
        const elem = patch(node, vnode).elm;
        function escapeTextNodes(node) {
            if (node.nodeType === 3) {
                node.textContent = escape(node.textContent);
            }
            for (let n of node.childNodes) {
                escapeTextNodes(n);
            }
        }
        escapeTextNodes(elem);
        return elem.outerHTML;
    }
    /**
     * Force all widgets connected to this QWeb instance to rerender themselves.
     *
     * This method is mostly useful for external code that want to modify the
     * application in some cases.  For example, a router plugin.
     */
    forceUpdate() {
        this.isUpdating = true;
        Promise.resolve().then(() => {
            if (this.isUpdating) {
                this.isUpdating = false;
                this.trigger("update");
            }
        });
    }
    _compile(name, elem, parentContext, defineKey) {
        const isDebug = elem.attributes.hasOwnProperty("t-debug");
        const ctx = new CompilationContext(name);
        if (elem.tagName !== "t") {
            ctx.shouldDefineResult = false;
        }
        if (parentContext) {
            ctx.variables = Object.create(parentContext.variables);
            ctx.parentNode = parentContext.parentNode || ctx.generateID();
            ctx.allowMultipleRoots = true;
            ctx.hasParentWidget = true;
            ctx.shouldDefineResult = false;
            ctx.addLine(`let c${ctx.parentNode} = extra.parentNode;`);
            if (defineKey) {
                ctx.addLine(`let key0 = extra.key || "";`);
                ctx.hasKey0 = true;
            }
        }
        this._compileNode(elem, ctx);
        if (!parentContext) {
            if (ctx.shouldDefineResult) {
                ctx.addLine(`return result;`);
            }
            else {
                if (!ctx.rootNode) {
                    throw new Error(`A template should have one root node (${ctx.templateName})`);
                }
                ctx.addLine(`return vn${ctx.rootNode};`);
            }
        }
        let code = ctx.generateCode();
        const templateName = ctx.templateName.replace(/`/g, "'").slice(0, 200);
        code.unshift(`    // Template name: "${templateName}"`);
        let template;
        try {
            template = new Function("context, extra", code.join("\n"));
        }
        catch (e) {
            console.groupCollapsed(`Invalid Code generated by ${templateName}`);
            console.warn(code.join("\n"));
            console.groupEnd();
            throw new Error(`Invalid generated code while compiling template '${templateName}': ${e.message}`);
        }
        if (isDebug) {
            const tpl = this.templates[name];
            if (tpl) {
                const msg = `Template: ${tpl.elem.outerHTML}\nCompiled code:\n${template.toString()}`;
                console.log(msg);
            }
        }
        return template;
    }
    /**
     * Generate code from an xml node
     *
     */
    _compileNode(node, ctx) {
        if (!(node instanceof Element)) {
            // this is a text node, there are no directive to apply
            let text = node.textContent;
            if (!ctx.inPreTag) {
                if (lineBreakRE.test(text) && !text.trim()) {
                    return;
                }
                text = text.replace(whitespaceRE, " ");
            }
            if (this.translateFn) {
                if (node.parentNode.getAttribute("t-translation") !== "off") {
                    text = this.translateFn(text);
                }
            }
            if (ctx.parentNode) {
                if (node.nodeType === 3) {
                    ctx.addLine(`c${ctx.parentNode}.push({text: \`${text}\`});`);
                }
                else if (node.nodeType === 8) {
                    ctx.addLine(`c${ctx.parentNode}.push(h('!', \`${text}\`));`);
                }
            }
            else if (ctx.parentTextNode) {
                ctx.addLine(`vn${ctx.parentTextNode}.text += \`${text}\`;`);
            }
            else {
                // this is an unusual situation: this text node is the result of the
                // template rendering.
                let nodeID = ctx.generateID();
                ctx.addLine(`let vn${nodeID} = {text: \`${text}\`};`);
                ctx.addLine(`result = vn${nodeID};`);
                ctx.rootContext.rootNode = nodeID;
                ctx.rootContext.parentTextNode = nodeID;
            }
            return;
        }
        const firstLetter = node.tagName[0];
        if (firstLetter === firstLetter.toUpperCase()) {
            // this is a component, we modify in place the xml document to change
            // <SomeComponent ... /> to <t t-component="SomeComponent" ... />
            node.setAttribute("t-component", node.tagName);
        }
        else if (node.tagName !== "t" && node.hasAttribute("t-component")) {
            throw new Error(`Directive 't-component' can only be used on <t> nodes (used on a <${node.tagName}>)`);
        }
        const attributes = node.attributes;
        const validDirectives = [];
        const finalizers = [];
        // maybe this is not optimal: we iterate on all attributes here, and again
        // just after for each directive.
        for (let i = 0; i < attributes.length; i++) {
            let attrName = attributes[i].name;
            if (attrName.startsWith("t-")) {
                let dName = attrName.slice(2).split(/-|\./)[0];
                if (!(dName in QWeb.DIRECTIVE_NAMES)) {
                    throw new Error(`Unknown QWeb directive: '${attrName}'`);
                }
                if (node.tagName !== "t" && (attrName === "t-esc" || attrName === "t-raw")) {
                    const tNode = document.createElement("t");
                    tNode.setAttribute(attrName, node.getAttribute(attrName));
                    for (let child of Array.from(node.childNodes)) {
                        tNode.appendChild(child);
                    }
                    node.appendChild(tNode);
                    node.removeAttribute(attrName);
                }
            }
        }
        const DIR_N = QWeb.DIRECTIVES.length;
        const ATTR_N = attributes.length;
        let withHandlers = false;
        for (let i = 0; i < DIR_N; i++) {
            let directive = QWeb.DIRECTIVES[i];
            let fullName;
            let value;
            for (let j = 0; j < ATTR_N; j++) {
                const name = attributes[j].name;
                if (name === "t-" + directive.name ||
                    name.startsWith("t-" + directive.name + "-") ||
                    name.startsWith("t-" + directive.name + ".")) {
                    fullName = name;
                    value = attributes[j].textContent;
                    validDirectives.push({ directive, value, fullName });
                    if (directive.name === "on" || directive.name === "model") {
                        withHandlers = true;
                    }
                }
            }
        }
        for (let { directive, value, fullName } of validDirectives) {
            if (directive.finalize) {
                finalizers.push({ directive, value, fullName });
            }
            if (directive.atNodeEncounter) {
                const isDone = directive.atNodeEncounter({
                    node,
                    qweb: this,
                    ctx,
                    fullName,
                    value
                });
                if (isDone) {
                    for (let { directive, value, fullName } of finalizers) {
                        directive.finalize({ node, qweb: this, ctx, fullName, value });
                    }
                    return;
                }
            }
        }
        if (node.nodeName !== "t") {
            let nodeID = this._compileGenericNode(node, ctx, withHandlers);
            ctx = ctx.withParent(nodeID);
            let nodeHooks = {};
            let addNodeHook = function (hook, handler) {
                nodeHooks[hook] = nodeHooks[hook] || [];
                nodeHooks[hook].push(handler);
            };
            for (let { directive, value, fullName } of validDirectives) {
                if (directive.atNodeCreation) {
                    directive.atNodeCreation({
                        node,
                        qweb: this,
                        ctx,
                        fullName,
                        value,
                        nodeID,
                        addNodeHook
                    });
                }
            }
            if (Object.keys(nodeHooks).length) {
                ctx.addLine(`p${nodeID}.hook = {`);
                for (let hook in nodeHooks) {
                    ctx.addLine(`  ${hook}: ${NODE_HOOKS_PARAMS[hook]} => {`);
                    for (let handler of nodeHooks[hook]) {
                        ctx.addLine(`    ${handler}`);
                    }
                    ctx.addLine(`  },`);
                }
                ctx.addLine(`};`);
            }
        }
        if (node.nodeName === "pre") {
            ctx = ctx.subContext("inPreTag", true);
        }
        this._compileChildren(node, ctx);
        // svg support
        // we hadd svg namespace if it is a svg or if it is a g, but only if it is
        // the root node.  This is the easiest way to support svg sub components:
        // they need to have a g tag as root. Otherwise, we would need a complete
        // list of allowed svg tags.
        const shouldAddNS = node.nodeName === "svg" || (node.nodeName === "g" && ctx.rootNode === ctx.parentNode);
        if (shouldAddNS) {
            ctx.rootContext.shouldDefineUtils = true;
            ctx.addLine(`utils.addNameSpace(vn${ctx.parentNode});`);
        }
        for (let { directive, value, fullName } of finalizers) {
            directive.finalize({ node, qweb: this, ctx, fullName, value });
        }
    }
    _compileGenericNode(node, ctx, withHandlers = true) {
        // nodeType 1 is generic tag
        if (node.nodeType !== 1) {
            throw new Error("unsupported node type");
        }
        const attributes = node.attributes;
        const attrs = [];
        const props = [];
        const tattrs = [];
        function handleBooleanProps(key, val) {
            let isProp = false;
            if (node.nodeName === "input" && key === "checked") {
                let type = node.getAttribute("type");
                if (type === "checkbox" || type === "radio") {
                    isProp = true;
                }
            }
            if (node.nodeName === "option" && key === "selected") {
                isProp = true;
            }
            if (key === "disabled" && DISABLED_TAGS.indexOf(node.nodeName) > -1) {
                isProp = true;
            }
            if ((key === "readonly" && node.nodeName === "input") || node.nodeName === "textarea") {
                isProp = true;
            }
            if (isProp) {
                props.push(`${key}: _${val}`);
            }
        }
        let classObj = "";
        for (let i = 0; i < attributes.length; i++) {
            let name = attributes[i].name;
            let value = attributes[i].textContent;
            if (this.translateFn && TRANSLATABLE_ATTRS.includes(name)) {
                value = this.translateFn(value);
            }
            // regular attributes
            if (!name.startsWith("t-") && !node.getAttribute("t-attf-" + name)) {
                const attID = ctx.generateID();
                if (name === "class") {
                    if ((value = value.trim())) {
                        let classDef = value
                            .split(/\s+/)
                            .map(a => `'${escapeQuotes(a)}':true`)
                            .join(",");
                        classObj = `_${ctx.generateID()}`;
                        ctx.addLine(`let ${classObj} = {${classDef}};`);
                    }
                }
                else {
                    ctx.addLine(`let _${attID} = '${escapeQuotes(value)}';`);
                    if (!name.match(/^[a-zA-Z]+$/)) {
                        // attribute contains 'non letters' => we want to quote it
                        name = '"' + name + '"';
                    }
                    attrs.push(`${name}: _${attID}`);
                    handleBooleanProps(name, attID);
                }
            }
            // dynamic attributes
            if (name.startsWith("t-att-")) {
                let attName = name.slice(6);
                const v = ctx.getValue(value);
                let formattedValue = typeof v === "string" ? ctx.formatExpression(v) : `scope.${v.id}`;
                if (attName === "class") {
                    ctx.rootContext.shouldDefineUtils = true;
                    formattedValue = `utils.toObj(${formattedValue})`;
                    if (classObj) {
                        ctx.addLine(`Object.assign(${classObj}, ${formattedValue})`);
                    }
                    else {
                        classObj = `_${ctx.generateID()}`;
                        ctx.addLine(`let ${classObj} = ${formattedValue};`);
                    }
                }
                else {
                    const attID = ctx.generateID();
                    if (!attName.match(/^[a-zA-Z]+$/)) {
                        // attribute contains 'non letters' => we want to quote it
                        attName = '"' + attName + '"';
                    }
                    // we need to combine dynamic with non dynamic attributes:
                    // class="a" t-att-class="'yop'" should be rendered as class="a yop"
                    const attValue = node.getAttribute(attName);
                    if (attValue) {
                        const attValueID = ctx.generateID();
                        ctx.addLine(`let _${attValueID} = ${formattedValue};`);
                        formattedValue = `'${attValue}' + (_${attValueID} ? ' ' + _${attValueID} : '')`;
                        const attrIndex = attrs.findIndex(att => att.startsWith(attName + ":"));
                        attrs.splice(attrIndex, 1);
                    }
                    ctx.addLine(`let _${attID} = ${formattedValue};`);
                    attrs.push(`${attName}: _${attID}`);
                    handleBooleanProps(attName, attID);
                }
            }
            if (name.startsWith("t-attf-")) {
                let attName = name.slice(7);
                if (!attName.match(/^[a-zA-Z]+$/)) {
                    // attribute contains 'non letters' => we want to quote it
                    attName = '"' + attName + '"';
                }
                const formattedExpr = ctx.interpolate(value);
                const attID = ctx.generateID();
                let staticVal = node.getAttribute(attName);
                if (staticVal) {
                    ctx.addLine(`let _${attID} = '${staticVal} ' + ${formattedExpr};`);
                }
                else {
                    ctx.addLine(`let _${attID} = ${formattedExpr};`);
                }
                attrs.push(`${attName}: _${attID}`);
            }
            // t-att= attributes
            if (name === "t-att") {
                let id = ctx.generateID();
                ctx.addLine(`let _${id} = ${ctx.formatExpression(value)};`);
                tattrs.push(id);
            }
        }
        let nodeID = ctx.generateID();
        let key = ctx.loopNumber || ctx.hasKey0 ? `\`\${key${ctx.loopNumber}}_${nodeID}\`` : nodeID;
        const parts = [`key:${key}`];
        if (attrs.length + tattrs.length > 0) {
            parts.push(`attrs:{${attrs.join(",")}}`);
        }
        if (props.length > 0) {
            parts.push(`props:{${props.join(",")}}`);
        }
        if (classObj) {
            parts.push(`class:${classObj}`);
        }
        if (withHandlers) {
            parts.push(`on:{}`);
        }
        ctx.addLine(`let c${nodeID} = [], p${nodeID} = {${parts.join(",")}};`);
        for (let id of tattrs) {
            ctx.addIf(`_${id} instanceof Array`);
            ctx.addLine(`p${nodeID}.attrs[_${id}[0]] = _${id}[1];`);
            ctx.addElse();
            ctx.addLine(`for (let key in _${id}) {`);
            ctx.indent();
            ctx.addLine(`p${nodeID}.attrs[key] = _${id}[key];`);
            ctx.dedent();
            ctx.addLine(`}`);
            ctx.closeIf();
        }
        ctx.addLine(`let vn${nodeID} = h('${node.nodeName}', p${nodeID}, c${nodeID});`);
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(vn${nodeID});`);
        }
        else if (ctx.loopNumber || ctx.hasKey0) {
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`result = vn${nodeID};`);
        }
        return nodeID;
    }
    _compileChildren(node, ctx) {
        if (node.childNodes.length > 0) {
            for (let child of Array.from(node.childNodes)) {
                this._compileNode(child, ctx);
            }
        }
    }
}
QWeb.utils = UTILS;
QWeb.components = Object.create(null);
QWeb.DIRECTIVE_NAMES = {
    name: 1,
    att: 1,
    attf: 1,
    translation: 1
};
QWeb.DIRECTIVES = [];
QWeb.TEMPLATES = {};
QWeb.nextId = 1;
// dev mode enables better error messages or more costly validations
QWeb.dev = false;
// slots contains sub templates defined with t-set inside t-component nodes, and
// are meant to be used by the t-slot directive.
QWeb.slots = {};
QWeb.nextSlotId = 1;

const parser = new DOMParser();
function htmlToVDOM(html) {
    const doc = parser.parseFromString(html, "text/html");
    const result = [];
    for (let child of doc.body.childNodes) {
        result.push(htmlToVNode(child));
    }
    return result;
}
function htmlToVNode(node) {
    if (!(node instanceof Element)) {
        return { text: node.textContent };
    }
    const attrs = {};
    for (let attr of node.attributes) {
        attrs[attr.name] = attr.textContent;
    }
    const children = [];
    for (let c of node.childNodes) {
        children.push(htmlToVNode(c));
    }
    return h(node.tagName, { attrs }, children);
}

/**
 * Owl QWeb Directives
 *
 * This file contains the implementation of most standard QWeb directives:
 * - t-esc
 * - t-raw
 * - t-set/t-value
 * - t-if/t-elif/t-else
 * - t-call
 * - t-foreach/t-as
 * - t-debug
 * - t-log
 */
//------------------------------------------------------------------------------
// t-esc and t-raw
//------------------------------------------------------------------------------
QWeb.utils.htmlToVDOM = htmlToVDOM;
function compileValueNode(value, node, qweb, ctx) {
    ctx.rootContext.shouldDefineScope = true;
    if (value === "0") {
        if (ctx.parentNode) {
            // the 'zero' magical symbol is where we can find the result of the rendering
            // of  the body of the t-call.
            ctx.rootContext.shouldDefineUtils = true;
            const zeroArgs = ctx.escaping
                ? `{text: utils.vDomToString(scope[utils.zero])}`
                : `...scope[utils.zero]`;
            ctx.addLine(`c${ctx.parentNode}.push(${zeroArgs});`);
        }
        return;
    }
    let exprID;
    if (typeof value === "string") {
        exprID = `_${ctx.generateID()}`;
        ctx.addLine(`let ${exprID} = ${ctx.formatExpression(value)};`);
    }
    else {
        exprID = `scope.${value.id}`;
    }
    ctx.addIf(`${exprID} != null`);
    if (ctx.escaping) {
        let protectID;
        if (value.hasBody) {
            protectID = ctx.startProtectScope();
            ctx.addLine(`${exprID} = ${exprID} instanceof utils.VDomArray ? utils.vDomToString(${exprID}) : ${exprID};`);
        }
        if (ctx.parentTextNode) {
            ctx.addLine(`vn${ctx.parentTextNode}.text += ${exprID};`);
        }
        else if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push({text: ${exprID}});`);
        }
        else {
            let nodeID = ctx.generateID();
            ctx.rootContext.rootNode = nodeID;
            ctx.rootContext.parentTextNode = nodeID;
            ctx.addLine(`let vn${nodeID} = {text: ${exprID}};`);
            if (ctx.rootContext.shouldDefineResult) {
                ctx.addLine(`result = vn${nodeID}`);
            }
        }
        if (value.hasBody) {
            ctx.stopProtectScope(protectID);
        }
    }
    else {
        ctx.rootContext.shouldDefineUtils = true;
        if (value.hasBody) {
            ctx.addLine(`const vnodeArray = ${exprID} instanceof utils.VDomArray ? ${exprID} : utils.htmlToVDOM(${exprID});`);
            ctx.addLine(`c${ctx.parentNode}.push(...vnodeArray);`);
        }
        else {
            ctx.addLine(`c${ctx.parentNode}.push(...utils.htmlToVDOM(${exprID}));`);
        }
    }
    if (node.childNodes.length) {
        ctx.addElse();
        qweb._compileChildren(node, ctx);
    }
    ctx.closeIf();
}
QWeb.addDirective({
    name: "esc",
    priority: 70,
    atNodeEncounter({ node, qweb, ctx }) {
        let value = ctx.getValue(node.getAttribute("t-esc"));
        compileValueNode(value, node, qweb, ctx.subContext("escaping", true));
        return true;
    }
});
QWeb.addDirective({
    name: "raw",
    priority: 80,
    atNodeEncounter({ node, qweb, ctx }) {
        let value = ctx.getValue(node.getAttribute("t-raw"));
        compileValueNode(value, node, qweb, ctx);
        return true;
    }
});
//------------------------------------------------------------------------------
// t-set
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "set",
    extraNames: ["value"],
    priority: 60,
    atNodeEncounter({ node, qweb, ctx }) {
        ctx.rootContext.shouldDefineScope = true;
        const variable = node.getAttribute("t-set");
        let value = node.getAttribute("t-value");
        ctx.variables[variable] = ctx.variables[variable] || {};
        let qwebvar = ctx.variables[variable];
        const hasBody = node.hasChildNodes();
        qwebvar.id = variable;
        qwebvar.expr = `scope.${variable}`;
        if (value) {
            const formattedValue = ctx.formatExpression(value);
            let scopeExpr = `scope`;
            if (ctx.protectedScopeNumber) {
                ctx.rootContext.shouldDefineUtils = true;
                scopeExpr = `utils.getScope(scope, '${variable}')`;
            }
            ctx.addLine(`${scopeExpr}.${variable} = ${formattedValue};`);
            qwebvar.value = formattedValue;
        }
        if (hasBody) {
            ctx.rootContext.shouldDefineUtils = true;
            if (value) {
                ctx.addIf(`!(${qwebvar.expr})`);
            }
            const tempParentNodeID = ctx.generateID();
            const _parentNode = ctx.parentNode;
            ctx.parentNode = tempParentNodeID;
            ctx.addLine(`let c${tempParentNodeID} = new utils.VDomArray();`);
            const nodeCopy = node.cloneNode(true);
            for (let attr of ["t-set", "t-value", "t-if", "t-else", "t-elif"]) {
                nodeCopy.removeAttribute(attr);
            }
            qweb._compileNode(nodeCopy, ctx);
            ctx.addLine(`${qwebvar.expr} = c${tempParentNodeID}`);
            qwebvar.value = `c${tempParentNodeID}`;
            qwebvar.hasBody = true;
            ctx.parentNode = _parentNode;
            if (value) {
                ctx.closeIf();
            }
        }
        return true;
    }
});
//------------------------------------------------------------------------------
// t-if, t-elif, t-else
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "if",
    priority: 20,
    atNodeEncounter({ node, ctx }) {
        let cond = ctx.getValue(node.getAttribute("t-if"));
        ctx.addIf(typeof cond === "string" ? ctx.formatExpression(cond) : `scope.${cond.id}`);
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
QWeb.addDirective({
    name: "elif",
    priority: 30,
    atNodeEncounter({ node, ctx }) {
        let cond = ctx.getValue(node.getAttribute("t-elif"));
        ctx.addLine(`else if (${typeof cond === "string" ? ctx.formatExpression(cond) : `scope.${cond.id}`}) {`);
        ctx.indent();
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
QWeb.addDirective({
    name: "else",
    priority: 40,
    atNodeEncounter({ ctx }) {
        ctx.addLine(`else {`);
        ctx.indent();
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
//------------------------------------------------------------------------------
// t-call
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "call",
    priority: 50,
    atNodeEncounter({ node, qweb, ctx }) {
        // Step 1: sanity checks
        // ------------------------------------------------
        ctx.rootContext.shouldDefineScope = true;
        ctx.rootContext.shouldDefineUtils = true;
        if (node.nodeName !== "t") {
            throw new Error("Invalid tag for t-call directive (should be 't')");
        }
        const subTemplate = node.getAttribute("t-call");
        const nodeTemplate = qweb.templates[subTemplate];
        if (!nodeTemplate) {
            throw new Error(`Cannot find template "${subTemplate}" (t-call)`);
        }
        // Step 2: compile target template in sub templates
        // ------------------------------------------------
        if (!qweb.subTemplates[subTemplate]) {
            qweb.subTemplates[subTemplate] = true;
            const subTemplateFn = qweb._compile(subTemplate, nodeTemplate.elem, ctx, true);
            qweb.subTemplates[subTemplate] = subTemplateFn;
        }
        // Step 3: compile t-call body if necessary
        // ------------------------------------------------
        let hasBody = node.hasChildNodes();
        let protectID;
        if (hasBody) {
            // we add a sub scope to protect the ambient scope
            ctx.addLine(`{`);
            ctx.indent();
            protectID = ctx.startProtectScope();
            const nodeCopy = node.cloneNode(true);
            for (let attr of ["t-if", "t-else", "t-elif", "t-call"]) {
                nodeCopy.removeAttribute(attr);
            }
            const parentNode = ctx.parentNode;
            ctx.parentNode = "__0";
            // this local scope is intended to trap c__0
            ctx.addLine(`{`);
            ctx.indent();
            ctx.addLine("let c__0 = [];");
            qweb._compileNode(nodeCopy, ctx);
            ctx.rootContext.shouldDefineUtils = true;
            ctx.addLine("scope[utils.zero] = c__0;");
            ctx.parentNode = parentNode;
            ctx.dedent();
            ctx.addLine(`}`);
        }
        // Step 4: add the appropriate function call to current component
        // ------------------------------------------------
        const callingScope = hasBody ? "scope" : "Object.assign(Object.create(context), scope)";
        const parentComponent = `utils.getComponent(context)`;
        const key = ctx.generateTemplateKey();
        const parentNode = ctx.parentNode ? `c${ctx.parentNode}` : "result";
        const extra = `Object.assign({}, extra, {parentNode: ${parentNode}, parent: ${parentComponent}, key: ${key}})`;
        if (ctx.parentNode) {
            ctx.addLine(`this.subTemplates['${subTemplate}'].call(this, ${callingScope}, ${extra});`);
        }
        else {
            // this is a t-call with no parentnode, we need to extract the result
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`result = []`);
            ctx.addLine(`this.subTemplates['${subTemplate}'].call(this, ${callingScope}, ${extra});`);
            ctx.addLine(`result = result[0]`);
        }
        // Step 5: restore previous scope
        // ------------------------------------------------
        if (hasBody) {
            ctx.stopProtectScope(protectID);
            ctx.dedent();
            ctx.addLine(`}`);
        }
        return true;
    }
});
//------------------------------------------------------------------------------
// t-foreach
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "foreach",
    extraNames: ["as"],
    priority: 10,
    atNodeEncounter({ node, qweb, ctx }) {
        ctx.rootContext.shouldDefineScope = true;
        ctx = ctx.subContext("loopNumber", ctx.loopNumber + 1);
        const elems = node.getAttribute("t-foreach");
        const name = node.getAttribute("t-as");
        let arrayID = ctx.generateID();
        ctx.addLine(`let _${arrayID} = ${ctx.formatExpression(elems)};`);
        ctx.addLine(`if (!_${arrayID}) { throw new Error('QWeb error: Invalid loop expression')}`);
        let keysID = ctx.generateID();
        let valuesID = ctx.generateID();
        ctx.addLine(`let _${keysID} = _${valuesID} = _${arrayID};`);
        ctx.addIf(`!(_${arrayID} instanceof Array)`);
        ctx.addLine(`_${keysID} = Object.keys(_${arrayID});`);
        ctx.addLine(`_${valuesID} = Object.values(_${arrayID});`);
        ctx.closeIf();
        ctx.addLine(`let _length${keysID} = _${keysID}.length;`);
        let varsID = ctx.startProtectScope(true);
        const loopVar = `i${ctx.loopNumber}`;
        ctx.addLine(`for (let ${loopVar} = 0; ${loopVar} < _length${keysID}; ${loopVar}++) {`);
        ctx.indent();
        ctx.addLine(`scope.${name}_first = ${loopVar} === 0`);
        ctx.addLine(`scope.${name}_last = ${loopVar} === _length${keysID} - 1`);
        ctx.addLine(`scope.${name}_index = ${loopVar}`);
        ctx.addLine(`scope.${name} = _${keysID}[${loopVar}]`);
        ctx.addLine(`scope.${name}_value = _${valuesID}[${loopVar}]`);
        const nodeCopy = node.cloneNode(true);
        let shouldWarn = !nodeCopy.hasAttribute("t-key") &&
            node.children.length === 1 &&
            node.children[0].tagName !== "t" &&
            !node.children[0].hasAttribute("t-key");
        if (shouldWarn) {
            console.warn(`Directive t-foreach should always be used with a t-key! (in template: '${ctx.templateName}')`);
        }
        if (nodeCopy.hasAttribute("t-key")) {
            const expr = ctx.formatExpression(nodeCopy.getAttribute("t-key"));
            ctx.addLine(`let key${ctx.loopNumber} = ${expr};`);
            nodeCopy.removeAttribute("t-key");
        }
        else {
            ctx.addLine(`let key${ctx.loopNumber} = i${ctx.loopNumber};`);
        }
        nodeCopy.removeAttribute("t-foreach");
        qweb._compileNode(nodeCopy, ctx);
        ctx.dedent();
        ctx.addLine("}");
        ctx.stopProtectScope(varsID);
        return true;
    }
});
//------------------------------------------------------------------------------
// t-debug
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "debug",
    priority: 1,
    atNodeEncounter({ ctx }) {
        ctx.addLine("debugger;");
    }
});
//------------------------------------------------------------------------------
// t-log
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "log",
    priority: 1,
    atNodeEncounter({ ctx, value }) {
        const expr = ctx.formatExpression(value);
        ctx.addLine(`console.log(${expr})`);
    }
});

/**
 * Owl QWeb Extensions
 *
 * This file contains the implementation of non standard QWeb directives, added
 * by Owl and that will only work on Owl projects:
 *
 * - t-on
 * - t-ref
 * - t-transition
 * - t-mounted
 * - t-slot
 * - t-model
 */
//------------------------------------------------------------------------------
// t-on
//------------------------------------------------------------------------------
// these are pieces of code that will be injected into the event handler if
// modifiers are specified
const MODS_CODE = {
    prevent: "e.preventDefault();",
    self: "if (e.target !== this.elm) {return}",
    stop: "e.stopPropagation();"
};
const FNAMEREGEXP = /^[$A-Z_][0-9A-Z_$]*$/i;
function makeHandlerCode(ctx, fullName, value, putInCache, modcodes = MODS_CODE) {
    let [event, ...mods] = fullName.slice(5).split(".");
    if (mods.includes("capture")) {
        event = "!" + event;
    }
    if (!event) {
        throw new Error("Missing event name with t-on directive");
    }
    let code;
    // check if it is a method with no args, a method with args or an expression
    let args = "";
    const name = value.replace(/\(.*\)/, function (_args) {
        args = _args.slice(1, -1);
        return "";
    });
    const isMethodCall = name.match(FNAMEREGEXP);
    // then generate code
    if (isMethodCall) {
        ctx.rootContext.shouldDefineUtils = true;
        const comp = `utils.getComponent(context)`;
        if (args) {
            const argId = ctx.generateID();
            ctx.addLine(`let args${argId} = [${ctx.formatExpression(args)}];`);
            code = `${comp}['${name}'](...args${argId}, e);`;
            putInCache = false;
        }
        else {
            code = `${comp}['${name}'](e);`;
        }
    }
    else {
        // if we get here, then it is an expression
        // we need to capture every variable in it
        putInCache = false;
        code = ctx.captureExpression(value);
    }
    const modCode = mods.map(mod => modcodes[mod]).join("");
    let handler = `function (e) {if (!context.__owl__.isMounted){return}${modCode}${code}}`;
    if (putInCache) {
        const key = ctx.generateTemplateKey(event);
        ctx.addLine(`extra.handlers[${key}] = extra.handlers[${key}] || ${handler};`);
        handler = `extra.handlers[${key}]`;
    }
    return { event, handler };
}
QWeb.addDirective({
    name: "on",
    priority: 90,
    atNodeCreation({ ctx, fullName, value, nodeID }) {
        const { event, handler } = makeHandlerCode(ctx, fullName, value, true);
        ctx.addLine(`p${nodeID}.on['${event}'] = ${handler};`);
    }
});
//------------------------------------------------------------------------------
// t-ref
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "ref",
    priority: 95,
    atNodeCreation({ ctx, value, addNodeHook }) {
        ctx.rootContext.shouldDefineRefs = true;
        const refKey = `ref${ctx.generateID()}`;
        ctx.addLine(`const ${refKey} = ${ctx.interpolate(value)};`);
        addNodeHook("create", `context.__owl__.refs[${refKey}] = n.elm;`);
        addNodeHook("destroy", `delete context.__owl__.refs[${refKey}];`);
    }
});
//------------------------------------------------------------------------------
// t-transition
//------------------------------------------------------------------------------
QWeb.utils.nextFrame = function (cb) {
    requestAnimationFrame(() => requestAnimationFrame(cb));
};
QWeb.utils.transitionInsert = function (vn, name) {
    const elm = vn.elm;
    // remove potential duplicated vnode that is currently being removed, to
    // prevent from having twice the same node in the DOM during an animation
    const dup = elm.parentElement && elm.parentElement.querySelector(`*[data-owl-key='${vn.key}']`);
    if (dup) {
        dup.remove();
    }
    elm.classList.add(name + "-enter");
    elm.classList.add(name + "-enter-active");
    elm.classList.remove(name + "-leave-active");
    elm.classList.remove(name + "-leave-to");
    const finalize = () => {
        elm.classList.remove(name + "-enter-active");
        elm.classList.remove(name + "-enter-to");
    };
    this.nextFrame(() => {
        elm.classList.remove(name + "-enter");
        elm.classList.add(name + "-enter-to");
        whenTransitionEnd(elm, finalize);
    });
};
QWeb.utils.transitionRemove = function (vn, name, rm) {
    const elm = vn.elm;
    elm.setAttribute("data-owl-key", vn.key);
    elm.classList.add(name + "-leave");
    elm.classList.add(name + "-leave-active");
    const finalize = () => {
        if (!elm.classList.contains(name + "-leave-active")) {
            return;
        }
        elm.classList.remove(name + "-leave-active");
        elm.classList.remove(name + "-leave-to");
        rm();
    };
    this.nextFrame(() => {
        elm.classList.remove(name + "-leave");
        elm.classList.add(name + "-leave-to");
        whenTransitionEnd(elm, finalize);
    });
};
function getTimeout(delays, durations) {
    /* istanbul ignore next */
    while (delays.length < durations.length) {
        delays = delays.concat(delays);
    }
    return Math.max.apply(null, durations.map((d, i) => {
        return toMs(d) + toMs(delays[i]);
    }));
}
// Old versions of Chromium (below 61.0.3163.100) formats floating pointer numbers
// in a locale-dependent way, using a comma instead of a dot.
// If comma is not replaced with a dot, the input will be rounded down (i.e. acting
// as a floor function) causing unexpected behaviors
function toMs(s) {
    return Number(s.slice(0, -1).replace(",", ".")) * 1000;
}
function whenTransitionEnd(elm, cb) {
    if (!elm.parentNode) {
        // if we get here, this means that the element was removed for some other
        // reasons, and in that case, we don't want to work on animation since nothing
        // will be displayed anyway.
        return;
    }
    const styles = window.getComputedStyle(elm);
    const delays = (styles.transitionDelay || "").split(", ");
    const durations = (styles.transitionDuration || "").split(", ");
    const timeout = getTimeout(delays, durations);
    if (timeout > 0) {
        elm.addEventListener("transitionend", cb, { once: true });
    }
    else {
        cb();
    }
}
QWeb.addDirective({
    name: "transition",
    priority: 96,
    atNodeCreation({ ctx, value, addNodeHook }) {
        ctx.rootContext.shouldDefineUtils = true;
        let name = value;
        const hooks = {
            insert: `utils.transitionInsert(vn, '${name}');`,
            remove: `utils.transitionRemove(vn, '${name}', rm);`
        };
        for (let hookName in hooks) {
            addNodeHook(hookName, hooks[hookName]);
        }
    }
});
//------------------------------------------------------------------------------
// t-slot
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "slot",
    priority: 80,
    atNodeEncounter({ ctx, value, node, qweb }) {
        const slotKey = ctx.generateID();
        ctx.addLine(`const slot${slotKey} = this.constructor.slots[context.__owl__.slotId + '_' + '${value}'];`);
        ctx.addIf(`slot${slotKey}`);
        let parentNode = `c${ctx.parentNode}`;
        if (!ctx.parentNode) {
            ctx.rootContext.shouldDefineResult = true;
            ctx.rootContext.shouldDefineUtils = true;
            parentNode = `children${ctx.generateID()}`;
            ctx.addLine(`let ${parentNode}= []`);
            ctx.addLine(`result = {}`);
        }
        ctx.addLine(`slot${slotKey}.call(this, context.__owl__.scope, Object.assign({}, extra, {parentNode: ${parentNode}, parent: extra.parent || context}));`);
        if (!ctx.parentNode) {
            ctx.addLine(`utils.defineProxy(result, ${parentNode}[0]);`);
        }
        if (node.hasChildNodes()) {
            ctx.addElse();
            const nodeCopy = node.cloneNode(true);
            nodeCopy.removeAttribute("t-slot");
            qweb._compileNode(nodeCopy, ctx);
        }
        ctx.closeIf();
        return true;
    }
});
//------------------------------------------------------------------------------
// t-model
//------------------------------------------------------------------------------
QWeb.utils.toNumber = function (val) {
    const n = parseFloat(val);
    return isNaN(n) ? val : n;
};
QWeb.addDirective({
    name: "model",
    priority: 42,
    atNodeCreation({ ctx, nodeID, value, node, fullName, addNodeHook }) {
        const type = node.getAttribute("type");
        let handler;
        let event = fullName.includes(".lazy") ? "change" : "input";
        // we keep here a reference to the "base expression" (if the expression
        // is `t-model="some.expr.value", then the base expression is "some.expr").
        // This is necessary so we can capture it in the handler closure.
        let expr = ctx.formatExpression(value);
        const index = expr.lastIndexOf(".");
        const baseExpr = expr.slice(0, index);
        ctx.addLine(`let expr${nodeID} = ${baseExpr};`);
        expr = `expr${nodeID}.${expr.slice(index + 1)}`;
        const key = ctx.generateTemplateKey();
        if (node.tagName === "select") {
            ctx.addLine(`p${nodeID}.props = {value: ${expr}};`);
            addNodeHook("create", `n.elm.value=${expr};`);
            event = "change";
            handler = `(ev) => {${expr} = ev.target.value}`;
        }
        else if (type === "checkbox") {
            ctx.addLine(`p${nodeID}.props = {checked: ${expr}};`);
            handler = `(ev) => {${expr} = ev.target.checked}`;
        }
        else if (type === "radio") {
            const nodeValue = node.getAttribute("value");
            ctx.addLine(`p${nodeID}.props = {checked:${expr} === '${nodeValue}'};`);
            handler = `(ev) => {${expr} = ev.target.value}`;
            event = "click";
        }
        else {
            ctx.addLine(`p${nodeID}.props = {value: ${expr}};`);
            const trimCode = fullName.includes(".trim") ? ".trim()" : "";
            let valueCode = `ev.target.value${trimCode}`;
            if (fullName.includes(".number")) {
                ctx.rootContext.shouldDefineUtils = true;
                valueCode = `utils.toNumber(${valueCode})`;
            }
            handler = `(ev) => {${expr} = ${valueCode}}`;
        }
        ctx.addLine(`extra.handlers[${key}] = extra.handlers[${key}] || (${handler});`);
        ctx.addLine(`p${nodeID}.on['${event}'] = extra.handlers[${key}];`);
    }
});
//------------------------------------------------------------------------------
// t-key
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "key",
    priority: 45,
    atNodeEncounter({ ctx, value, node }) {
        if (ctx.loopNumber === 0) {
            ctx.keyStack.push(ctx.rootContext.hasKey0);
            ctx.rootContext.hasKey0 = true;
        }
        ctx.addLine("{");
        ctx.indent();
        ctx.addLine(`let key${ctx.loopNumber} = ${ctx.formatExpression(value)};`);
    },
    finalize({ ctx }) {
        ctx.dedent();
        ctx.addLine("}");
        if (ctx.loopNumber === 0) {
            ctx.rootContext.hasKey0 = ctx.keyStack.pop();
        }
    }
});

const config = {};
Object.defineProperty(config, "mode", {
    get() {
        return QWeb.dev ? "dev" : "prod";
    },
    set(mode) {
        QWeb.dev = mode === "dev";
        if (QWeb.dev) {
            const url = `https://github.com/odoo/owl/blob/master/doc/reference/config.md#mode`;
            console.warn(`Owl is running in 'dev' mode.  This is not suitable for production use. See ${url} for more information.`);
        }
        else {
            console.log(`Owl is now running in 'prod' mode.`);
        }
    }
});

/**
 * We define here OwlEvent, a subclass of CustomEvent, with an additional
 * attribute:
 *  - originalComponent: the component that triggered the event
 */
class OwlEvent extends CustomEvent {
    constructor(component, eventType, options) {
        super(eventType, options);
        this.originalComponent = component;
    }
}

//------------------------------------------------------------------------------
// t-component
//------------------------------------------------------------------------------
const T_COMPONENT_MODS_CODE = Object.assign({}, MODS_CODE, {
    self: "if (e.target !== vn.elm) {return}"
});
QWeb.utils.defineProxy = function defineProxy(target, source) {
    for (let k in source) {
        Object.defineProperty(target, k, {
            get() {
                return source[k];
            },
            set(val) {
                source[k] = val;
            }
        });
    }
};
QWeb.utils.assignHooks = function assignHooks(dataObj, hooks) {
    if ("hook" in dataObj) {
        const hookObject = dataObj.hook;
        for (let name in hooks) {
            const current = hookObject[name];
            const fn = hooks[name];
            if (current) {
                hookObject[name] = (...args) => {
                    current(...args);
                    fn(...args);
                };
            }
            else {
                hookObject[name] = fn;
            }
        }
    }
    else {
        dataObj.hook = hooks;
    }
};
/**
 * The t-component directive is certainly a complicated and hard to maintain piece
 * of code.  To help you, fellow developer, if you have to maintain it, I offer
 * you this advice: Good luck...
 *
 * Since it is not 'direct' code, but rather code that generates other code, it
 * is not easy to understand.  To help you, here  is a detailed and commented
 * explanation of the code generated by the t-component directive for the following
 * situation:
 * ```xml
 *   <Child
 *      t-key="'somestring'"
 *      flag="state.flag"
 *      t-transition="fade"/>
 * ```
 *
 * ```js
 * // we assign utils on top of the function because it will be useful for
 * // each components
 * let utils = this.utils;
 *
 * // this is the virtual node representing the parent div
 * let c1 = [], p1 = { key: 1 };
 * var vn1 = h("div", p1, c1);
 *
 * // t-component directive: we start by evaluating the expression given by t-key:
 * let key5 = "somestring";
 *
 * // def3 is the promise that will contain later either the new component
 * // creation, or the props update...
 * let def3;
 *
 * // this is kind of tricky: we need here to find if the component was already
 * // created by a previous rendering.  This is done by checking the internal
 * // `cmap` (children map) of the parent component: it maps keys to component ids,
 * // and, then, if there is an id, we look into the children list to get the
 * // instance
 * let w4 =
 *   key5 in context.__owl__.cmap
 *   ? context.__owl__.children[context.__owl__.cmap[key5]]
 *   : false;
 *
 * // We keep the index of the position of the component in the closure.  We push
 * // null to reserve the slot, and will replace it later by the component vnode,
 * // when it will be ready (do not forget that preparing/rendering a component is
 * // asynchronous)
 * let _2_index = c1.length;
 * c1.push(null);
 *
 * // we evaluate here the props given to the component. It is done here to be
 * // able to easily reference it later, and also, it might be an expensive
 * // computation, so it is certainly better to do it only once
 * let props4 = { flag: context["state"].flag };
 *
 * // If we have a component, currently rendering, but not ready yet, we do not want
 * // to wait for it to be ready if we can avoid it
 * if (w4 && w4.__owl__.renderPromise && !w4.__owl__.vnode) {
 *   // we check if the props are the same.  In that case, we can simply reuse
 *   // the previous rendering and skip all useless work
 *   if (utils.shallowEqual(props4, w4.__owl__.renderProps)) {
 *     def3 = w4.__owl__.renderPromise;
 *   } else {
 *     // if the props are not the same, we destroy the component and starts anew.
 *     // this will be faster than waiting for its rendering, then updating it
 *     w4.destroy();
 *     w4 = false;
 *   }
 * }
 *
 * if (!w4) {
 *   // in this situation, we need to create a new component.  First step is
 *   // to get a reference to the class, then create an instance with
 *   // current context as parent, and the props.
 *   let W4 = context.component && context.components[componentKey4] || QWeb.component[componentKey4];

 *   if (!W4) {
 *     throw new Error("Cannot find the definition of component 'child'");
 *   }
 *   w4 = new W4(owner, props4);
 *
 *   // Whenever we rerender the parent component, we need to be sure that we
 *   // are able to find the component instance. To do that, we register it to
 *   // the parent cmap (children map).  Note that the 'template' key is
 *   // used here, since this is what identify the component from the template
 *   // perspective.
 *   context.__owl__.cmap[key5] = w4.__owl__.id;
 *
 *   // __prepare is called, to basically call willStart, then render the
 *   // component
 *   def3 = w4.__prepare();
 *
 *   def3 = def3.then(vnode => {
 *     // we create here a virtual node for the parent (NOT the component). This
 *     // means that the vdom of the parent will be stopped here, and from
 *     // the parent's perspective, it simply is a vnode with no children.
 *     // However, it shares the same dom element with the component root
 *     // vnode.
 *     let pvnode = h(vnode.sel, { key: key5 });
 *
 *     // we add hooks to the parent vnode so we can interact with the new
 *     // component at the proper time
 *     pvnode.data.hook = {
 *       insert(vn) {
 *         // the __mount method will patch the component vdom into the elm vn.elm,
 *         // then call the mounted hooks. However, suprisingly, the snabbdom
 *         // patch method actually replace the elm by a new elm, so we need
 *         // to synchronise the pvnode elm with the resulting elm
 *         let nvn = w4.__mount(vnode, vn.elm);
 *         pvnode.elm = nvn.elm;
 *         // what follows is only present if there are animations on the component
 *         utils.transitionInsert(vn, "fade");
 *       },
 *       remove() {
 *         // override with empty function to prevent from removing the node
 *         // directly. It will be removed when destroy is called anyway, which
 *         // delays the removal if there are animations.
 *       },
 *       destroy() {
 *         // if there are animations, we delay the call to destroy on the
 *         // component, if not, we call it directly.
 *         let finalize = () => {
 *           w4.destroy();
 *         };
 *         utils.transitionRemove(vn, "fade", finalize);
 *       }
 *     };
 *     // the pvnode is inserted at the correct position in the div's children
 *     c1[_2_index] = pvnode;
 *
 *     // we keep here a reference to the parent vnode (representing the
 *     // component, so we can reuse it later whenever we update the component
 *     w4.__owl__.pvnode = pvnode;
 *   });
 * } else {
 *   // this is the 'update' path of the directive.
 *   // the call to __updateProps is the actual component update
 *   // Note that we only update the props if we cannot reuse the previous
 *   // rendering work (in the case it was rendered with the same props)
 *   def3 = def3 || w4.__updateProps(props4, extra.forceUpdate, extra.patchQueue);
 *   def3 = def3.then(() => {
 *     // if component was destroyed in the meantime, we do nothing (so, this
 *     // means that the parent's element children list will have a null in
 *     // the component's position, which will cause the pvnode to be removed
 *     // when it is patched.
 *     if (w4.__owl__.isDestroyed) {
 *       return;
 *     }
 *     // like above, we register the pvnode to the children list, so it
 *     // will not be patched out of the dom.
 *     let pvnode = w4.__owl__.pvnode;
 *     c1[_2_index] = pvnode;
 *   });
 * }
 *
 * // we register the deferred here so the parent can coordinate its patch operation
 * // with all the children.
 * extra.promises.push(def3);
 * return vn1;
 * ```
 */
QWeb.addDirective({
    name: "component",
    extraNames: ["props"],
    priority: 100,
    atNodeEncounter({ ctx, value, node, qweb }) {
        ctx.addLine(`// Component '${value}'`);
        ctx.rootContext.shouldDefineQWeb = true;
        ctx.rootContext.shouldDefineParent = true;
        ctx.rootContext.shouldDefineUtils = true;
        ctx.rootContext.shouldDefineScope = true;
        let hasDynamicProps = node.getAttribute("t-props") ? true : false;
        // t-on- events and t-transition
        const events = [];
        let transition = "";
        const attributes = node.attributes;
        const props = {};
        for (let i = 0; i < attributes.length; i++) {
            const name = attributes[i].name;
            const value = attributes[i].textContent;
            if (name.startsWith("t-on-")) {
                events.push([name, value]);
            }
            else if (name === "t-transition") {
                transition = value;
            }
            else if (!name.startsWith("t-")) {
                if (name !== "class" && name !== "style") {
                    // this is a prop!
                    props[name] = ctx.formatExpression(value) || "undefined";
                }
            }
        }
        // computing the props string representing the props object
        let propStr = Object.keys(props)
            .map(k => k + ":" + props[k])
            .join(",");
        let componentID = ctx.generateID();
        const templateKey = ctx.generateTemplateKey();
        let ref = node.getAttribute("t-ref");
        let refExpr = "";
        let refKey = "";
        if (ref) {
            ctx.rootContext.shouldDefineRefs = true;
            refKey = `ref${ctx.generateID()}`;
            ctx.addLine(`const ${refKey} = ${ctx.interpolate(ref)};`);
            refExpr = `context.__owl__.refs[${refKey}] = w${componentID};`;
        }
        let finalizeComponentCode = `w${componentID}.destroy();`;
        if (ref) {
            finalizeComponentCode += `delete context.__owl__.refs[${refKey}];`;
        }
        if (transition) {
            finalizeComponentCode = `let finalize = () => {
          ${finalizeComponentCode}
        };
        delete w${componentID}.__owl__.transitionInserted;
        utils.transitionRemove(vn, '${transition}', finalize);`;
        }
        let createHook = "";
        let classAttr = node.getAttribute("class");
        let tattClass = node.getAttribute("t-att-class");
        let styleAttr = node.getAttribute("style");
        let tattStyle = node.getAttribute("t-att-style");
        if (tattStyle) {
            const attVar = `_${ctx.generateID()}`;
            ctx.addLine(`const ${attVar} = ${ctx.formatExpression(tattStyle)};`);
            tattStyle = attVar;
        }
        let classObj = "";
        if (classAttr || tattClass || styleAttr || tattStyle || events.length) {
            if (classAttr) {
                let classDef = classAttr
                    .trim()
                    .split(/\s+/)
                    .map(a => `'${a}':true`)
                    .join(",");
                classObj = `_${ctx.generateID()}`;
                ctx.addLine(`let ${classObj} = {${classDef}};`);
            }
            if (tattClass) {
                let tattExpr = ctx.formatExpression(tattClass);
                if (tattExpr[0] !== "{" || tattExpr[tattExpr.length - 1] !== "}") {
                    tattExpr = `utils.toObj(${tattExpr})`;
                }
                if (classAttr) {
                    ctx.addLine(`Object.assign(${classObj}, ${tattExpr})`);
                }
                else {
                    classObj = `_${ctx.generateID()}`;
                    ctx.addLine(`let ${classObj} = ${tattExpr};`);
                }
            }
            let eventsCode = events
                .map(function ([name, value]) {
                const capture = name.match(/\.capture/);
                name = capture ? name.replace(/\.capture/, "") : name;
                const { event, handler } = makeHandlerCode(ctx, name, value, false, T_COMPONENT_MODS_CODE);
                if (capture) {
                    return `vn.elm.addEventListener('${event}', ${handler}, true);`;
                }
                return `vn.elm.addEventListener('${event}', ${handler});`;
            })
                .join("");
            const styleExpr = tattStyle || (styleAttr ? `'${styleAttr}'` : false);
            const styleCode = styleExpr ? `vn.elm.style = ${styleExpr};` : "";
            createHook = `utils.assignHooks(vnode.data, {create(_, vn){${styleCode}${eventsCode}}});`;
        }
        ctx.addLine(`let w${componentID} = ${templateKey} in parent.__owl__.cmap ? parent.__owl__.children[parent.__owl__.cmap[${templateKey}]] : false;`);
        let shouldProxy = !ctx.parentNode;
        if (shouldProxy) {
            let id = ctx.generateID();
            ctx.rootContext.rootNode = id;
            shouldProxy = true;
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`let vn${id} = {};`);
            ctx.addLine(`result = vn${id};`);
        }
        if (hasDynamicProps) {
            const dynamicProp = ctx.formatExpression(node.getAttribute("t-props"));
            ctx.addLine(`let props${componentID} = Object.assign({${propStr}}, ${dynamicProp});`);
        }
        else {
            ctx.addLine(`let props${componentID} = {${propStr}};`);
        }
        ctx.addIf(`w${componentID} && w${componentID}.__owl__.currentFiber && !w${componentID}.__owl__.vnode`);
        ctx.addLine(`w${componentID}.destroy();`);
        ctx.addLine(`w${componentID} = false;`);
        ctx.closeIf();
        let registerCode = "";
        if (shouldProxy) {
            registerCode = `utils.defineProxy(vn${ctx.rootNode}, pvnode);`;
        }
        // SLOTS
        const hasSlots = node.childNodes.length;
        let scope = hasSlots ? `Object.assign(Object.create(context), scope)` : "undefined";
        ctx.addIf(`w${componentID}`);
        // need to update component
        let styleCode = "";
        if (tattStyle) {
            styleCode = `.then(()=>{if (w${componentID}.__owl__.isDestroyed) {return};w${componentID}.el.style=${tattStyle};});`;
        }
        ctx.addLine(`w${componentID}.__updateProps(props${componentID}, extra.fiber, ${scope})${styleCode};`);
        ctx.addLine(`let pvnode = w${componentID}.__owl__.pvnode;`);
        if (registerCode) {
            ctx.addLine(registerCode);
        }
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(pvnode);`);
        }
        ctx.addElse();
        // new component
        let dynamicFallback = "";
        if (!value.match(INTERP_REGEXP)) {
            dynamicFallback = `|| ${ctx.formatExpression(value)}`;
        }
        const interpValue = ctx.interpolate(value);
        ctx.addLine(`let componentKey${componentID} = ${interpValue};`);
        ctx.addLine(`let W${componentID} = context.constructor.components[componentKey${componentID}] || QWeb.components[componentKey${componentID}]${dynamicFallback};`);
        // maybe only do this in dev mode...
        ctx.addLine(`if (!W${componentID}) {throw new Error('Cannot find the definition of component "' + componentKey${componentID} + '"')}`);
        ctx.addLine(`w${componentID} = new W${componentID}(parent, props${componentID});`);
        if (transition) {
            ctx.addLine(`const __patch${componentID} = w${componentID}.__patch;`);
            ctx.addLine(`w${componentID}.__patch = (t, vn) => {__patch${componentID}.call(w${componentID}, t, vn); if(!w${componentID}.__owl__.transitionInserted){w${componentID}.__owl__.transitionInserted = true;utils.transitionInsert(w${componentID}.__owl__.vnode, '${transition}');}};`);
        }
        ctx.addLine(`parent.__owl__.cmap[${templateKey}] = w${componentID}.__owl__.id;`);
        if (hasSlots) {
            const clone = node.cloneNode(true);
            const slotNodes = Array.from(clone.querySelectorAll("[t-set-slot]"));
            // The next code is a fallback for compatibility reason. It accepts t-set
            // elements that are direct children with a non empty body as nodes defining
            // the content of a slot.
            //
            // This is wrong, but is necessary to prevent breaking all existing Owl
            // code using slots. This will be removed in v2.0 someday. Meanwhile,
            // please use t-set-slot everywhere you need to set the content of a
            // slot.
            for (let el of clone.children) {
                if (el.getAttribute("t-set") && el.hasChildNodes()) {
                    slotNodes.push(el);
                }
            }
            const slotId = QWeb.nextSlotId++;
            ctx.addLine(`w${componentID}.__owl__.slotId = ${slotId};`);
            if (slotNodes.length) {
                for (let i = 0, length = slotNodes.length; i < length; i++) {
                    const slotNode = slotNodes[i];
                    slotNode.parentElement.removeChild(slotNode);
                    let key = slotNode.getAttribute("t-set-slot");
                    slotNode.removeAttribute("t-set-slot");
                    // here again, this code should be removed when we stop supporting
                    // using t-set to define the content of named slots.
                    if (!key) {
                        key = slotNode.getAttribute("t-set");
                        slotNode.removeAttribute("t-set");
                    }
                    const slotFn = qweb._compile(`slot_${key}_template`, slotNode, ctx);
                    QWeb.slots[`${slotId}_${key}`] = slotFn;
                }
            }
            if (clone.childNodes.length) {
                const t = clone.ownerDocument.createElement("t");
                for (let child of Object.values(clone.childNodes)) {
                    t.appendChild(child);
                }
                const slotFn = qweb._compile(`slot_default_template`, t, ctx);
                QWeb.slots[`${slotId}_default`] = slotFn;
            }
        }
        ctx.addLine(`let fiber = w${componentID}.__prepare(extra.fiber, ${scope}, () => { const vnode = fiber.vnode; pvnode.sel = vnode.sel; ${createHook}});`);
        // hack: specify empty remove hook to prevent the node from being removed from the DOM
        const insertHook = refExpr ? `insert(vn) {${refExpr}},` : "";
        ctx.addLine(`let pvnode = h('dummy', {key: ${templateKey}, hook: {${insertHook}remove() {},destroy(vn) {${finalizeComponentCode}}}});`);
        if (registerCode) {
            ctx.addLine(registerCode);
        }
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(pvnode);`);
        }
        ctx.addLine(`w${componentID}.__owl__.pvnode = pvnode;`);
        ctx.closeIf();
        if (classObj) {
            ctx.addLine(`w${componentID}.__owl__.classObj=${classObj};`);
        }
        ctx.addLine(`w${componentID}.__owl__.parentLastFiberId = extra.fiber.id;`);
        return true;
    }
});

class Scheduler {
    constructor(requestAnimationFrame) {
        this.tasks = [];
        this.isRunning = false;
        this.requestAnimationFrame = requestAnimationFrame;
    }
    start() {
        this.isRunning = true;
        this.scheduleTasks();
    }
    stop() {
        this.isRunning = false;
    }
    addFiber(fiber) {
        // if the fiber was remapped into a larger rendering fiber, it may not be a
        // root fiber.  But we only want to register root fibers
        fiber = fiber.root;
        return new Promise((resolve, reject) => {
            if (fiber.error) {
                return reject(fiber.error);
            }
            this.tasks.push({
                fiber,
                callback: () => {
                    if (fiber.error) {
                        return reject(fiber.error);
                    }
                    resolve();
                }
            });
            if (!this.isRunning) {
                this.start();
            }
        });
    }
    rejectFiber(fiber, reason) {
        fiber = fiber.root;
        const index = this.tasks.findIndex(t => t.fiber === fiber);
        if (index >= 0) {
            const [task] = this.tasks.splice(index, 1);
            fiber.cancel();
            fiber.error = new Error(reason);
            task.callback();
        }
    }
    /**
     * Process all current tasks. This only applies to the fibers that are ready.
     * Other tasks are left unchanged.
     */
    flush() {
        let tasks = this.tasks;
        this.tasks = [];
        tasks = tasks.filter(task => {
            if (task.fiber.isCompleted) {
                task.callback();
                return false;
            }
            if (task.fiber.counter === 0) {
                if (!task.fiber.error) {
                    try {
                        task.fiber.complete();
                    }
                    catch (e) {
                        task.fiber.handleError(e);
                    }
                }
                task.callback();
                return false;
            }
            return true;
        });
        this.tasks = tasks.concat(this.tasks);
        if (this.tasks.length === 0) {
            this.stop();
        }
    }
    scheduleTasks() {
        this.requestAnimationFrame(() => {
            this.flush();
            if (this.isRunning) {
                this.scheduleTasks();
            }
        });
    }
}
const scheduler = new Scheduler(browser.requestAnimationFrame);

/**
 * Owl Fiber Class
 *
 * Fibers are small abstractions designed to contain all the internal state
 * associated with a "rendering work unit", relative to a specific component.
 *
 * A rendering will cause the creation of a fiber for each impacted components.
 *
 * Fibers capture all that necessary information, which is critical to owl
 * asynchronous rendering pipeline. Fibers can be cancelled, can be in different
 * states and in general determine the state of the rendering.
 */
class Fiber {
    constructor(parent, component, force, target, position) {
        this.id = Fiber.nextId++;
        // isCompleted means that the rendering corresponding to this fiber's work is
        // done, either because the component has been mounted or patched, or because
        // fiber has been cancelled.
        this.isCompleted = false;
        // the fibers corresponding to component updates (updateProps) need to call
        // the willPatch and patched hooks from the corresponding component. However,
        // fibers corresponding to a new component do not need to do that. So, the
        // shouldPatch hook is the boolean that we check whenever we need to apply
        // a patch.
        this.shouldPatch = true;
        // isRendered is the last state of a fiber. If true, this means that it has
        // been rendered and is inert (so, it should not be taken into account when
        // counting the number of active fibers).
        this.isRendered = false;
        // the counter number is a critical information. It is only necessary for a
        // root fiber.  For that fiber, this number counts the number of active sub
        // fibers.  When that number reaches 0, the fiber can be applied by the
        // scheduler.
        this.counter = 0;
        this.vnode = null;
        this.child = null;
        this.sibling = null;
        this.lastChild = null;
        this.parent = null;
        this.component = component;
        this.force = force;
        this.target = target;
        this.position = position;
        const __owl__ = component.__owl__;
        this.scope = __owl__.scope;
        this.root = parent ? parent.root : this;
        this.parent = parent;
        let oldFiber = __owl__.currentFiber;
        if (oldFiber && !oldFiber.isCompleted) {
            if (oldFiber.root === oldFiber && !parent) {
                // both oldFiber and this fiber are root fibers
                this._reuseFiber(oldFiber);
                return oldFiber;
            }
            else {
                this._remapFiber(oldFiber);
            }
        }
        this.root.counter++;
        __owl__.currentFiber = this;
    }
    /**
     * When the oldFiber is not completed yet, and both oldFiber and this fiber
     * are root fibers, we want to reuse the oldFiber instead of creating a new
     * one. Doing so will guarantee that the initiator(s) of those renderings will
     * be notified (the promise will resolve) when the last rendering will be done.
     *
     * This function thus assumes that oldFiber is a root fiber.
     */
    _reuseFiber(oldFiber) {
        oldFiber.cancel(); // cancel children fibers
        oldFiber.isCompleted = false; // keep the root fiber alive
        oldFiber.isRendered = false; // the fiber has to be re-rendered
        if (oldFiber.child) {
            // remove relation to children
            oldFiber.child.parent = null;
            oldFiber.child = null;
            oldFiber.lastChild = null;
        }
        oldFiber.counter = 1; // re-initialize counter
        oldFiber.id = Fiber.nextId++;
    }
    /**
     * In some cases, a rendering initiated at some component can detect that it
     * should be part of a larger rendering initiated somewhere up the component
     * tree.  In that case, it needs to cancel the previous rendering and
     * remap itself as a part of the current parent rendering.
     */
    _remapFiber(oldFiber) {
        oldFiber.cancel();
        this.shouldPatch = oldFiber.shouldPatch;
        if (oldFiber === oldFiber.root) {
            oldFiber.counter++;
        }
        if (oldFiber.parent && !this.parent) {
            // re-map links
            this.parent = oldFiber.parent;
            this.root = this.parent.root;
            this.sibling = oldFiber.sibling;
            if (this.parent.lastChild === oldFiber) {
                this.parent.lastChild = this;
            }
            if (this.parent.child === oldFiber) {
                this.parent.child = this;
            }
            else {
                let current = this.parent.child;
                while (true) {
                    if (current.sibling === oldFiber) {
                        current.sibling = this;
                        break;
                    }
                    current = current.sibling;
                }
            }
        }
    }
    /**
     * This function has been taken from
     * https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7
     */
    _walk(doWork) {
        let root = this;
        let current = this;
        while (true) {
            const child = doWork(current);
            if (child) {
                current = child;
                continue;
            }
            if (current === root) {
                return;
            }
            while (!current.sibling) {
                if (!current.parent || current.parent === root) {
                    return;
                }
                current = current.parent;
            }
            current = current.sibling;
        }
    }
    /**
     * Successfully complete the work of the fiber: call the mount or patch hooks
     * and patch the DOM. This function is called once the fiber and its children
     * are ready, and the scheduler decides to process it.
     */
    complete() {
        let component = this.component;
        this.isCompleted = true;
        if (!this.target && !component.__owl__.isMounted) {
            return;
        }
        // build patchQueue
        const patchQueue = [];
        const doWork = function (f) {
            patchQueue.push(f);
            return f.child;
        };
        this._walk(doWork);
        const patchLen = patchQueue.length;
        // call willPatch hook on each fiber of patchQueue
        for (let i = 0; i < patchLen; i++) {
            const fiber = patchQueue[i];
            if (fiber.shouldPatch) {
                component = fiber.component;
                if (component.__owl__.willPatchCB) {
                    component.__owl__.willPatchCB();
                }
                component.willPatch();
            }
        }
        // call __patch on each fiber of (reversed) patchQueue
        for (let i = patchLen - 1; i >= 0; i--) {
            const fiber = patchQueue[i];
            component = fiber.component;
            if (fiber.target && i === 0) {
                let target;
                if (fiber.position === "self") {
                    target = fiber.target;
                    if (target.tagName.toLowerCase() !== fiber.vnode.sel) {
                        throw new Error(`Cannot attach '${component.constructor.name}' to target node (not same tag name)`);
                    }
                    // In self mode, we *know* we are to take possession of the target
                    // Hence we manually create the corresponding VNode and copy the "key" in data
                    const selfVnodeData = fiber.vnode.data ? { key: fiber.vnode.data.key } : {};
                    const selfVnode = h(fiber.vnode.sel, selfVnodeData);
                    selfVnode.elm = target;
                    target = selfVnode;
                }
                else {
                    target = component.__owl__.vnode || document.createElement(fiber.vnode.sel);
                }
                component.__patch(target, fiber.vnode);
            }
            else {
                if (fiber.shouldPatch) {
                    component.__patch(component.__owl__.vnode, fiber.vnode);
                }
                else {
                    component.__patch(document.createElement(fiber.vnode.sel), fiber.vnode);
                    component.__owl__.pvnode.elm = component.__owl__.vnode.elm;
                }
            }
            component.__owl__.currentFiber = null;
        }
        // insert into the DOM (mount case)
        let inDOM = false;
        if (this.target) {
            switch (this.position) {
                case "first-child":
                    this.target.prepend(this.component.el);
                    break;
                case "last-child":
                    this.target.appendChild(this.component.el);
                    break;
            }
            inDOM = document.body.contains(this.component.el);
            this.component.env.qweb.trigger("dom-appended");
        }
        // call patched/mounted hook on each fiber of (reversed) patchQueue
        for (let i = patchLen - 1; i >= 0; i--) {
            const fiber = patchQueue[i];
            component = fiber.component;
            if (fiber.shouldPatch && !this.target) {
                component.patched();
                if (component.__owl__.patchedCB) {
                    component.__owl__.patchedCB();
                }
            }
            else if (this.target ? inDOM : true) {
                component.__callMounted();
            }
        }
    }
    /**
     * Cancel a fiber and all its children.
     */
    cancel() {
        this._walk(f => {
            if (!f.isRendered) {
                f.root.counter--;
            }
            f.isCompleted = true;
            return f.child;
        });
    }
    /**
     * This is the global error handler for errors occurring in Owl main lifecycle
     * methods.  Caught errors are triggered on the QWeb instance, and are
     * potentially given to some parent component which implements `catchError`.
     *
     * If there are no such component, we destroy everything. This is better than
     * being in a corrupted state.
     */
    handleError(error) {
        let component = this.component;
        this.vnode = component.__owl__.vnode || h("div");
        const qweb = component.env.qweb;
        let root = component;
        let canCatch = false;
        while (component && !(canCatch = !!component.catchError)) {
            root = component;
            component = component.__owl__.parent;
        }
        qweb.trigger("error", error);
        if (canCatch) {
            component.catchError(error);
        }
        else {
            // the 3 next lines aim to mark the root fiber as being in error, and
            // to force it to end, without waiting for its children
            this.root.counter = 0;
            this.root.error = error;
            scheduler.flush();
            root.destroy();
        }
    }
}
Fiber.nextId = 1;

//------------------------------------------------------------------------------
// Prop validation helper
//------------------------------------------------------------------------------
/**
 * Validate the component props (or next props) against the (static) props
 * description.  This is potentially an expensive operation: it may needs to
 * visit recursively the props and all the children to check if they are valid.
 * This is why it is only done in 'dev' mode.
 */
QWeb.utils.validateProps = function (Widget, props) {
    const propsDef = Widget.props;
    if (propsDef instanceof Array) {
        // list of strings (prop names)
        for (let i = 0, l = propsDef.length; i < l; i++) {
            const propName = propsDef[i];
            if (propName[propName.length - 1] === "?") {
                // optional prop
                break;
            }
            if (!(propName in props)) {
                throw new Error(`Missing props '${propsDef[i]}' (component '${Widget.name}')`);
            }
        }
        for (let key in props) {
            if (!propsDef.includes(key) && !propsDef.includes(key + "?")) {
                throw new Error(`Unknown prop '${key}' given to component '${Widget.name}'`);
            }
        }
    }
    else if (propsDef) {
        // propsDef is an object now
        for (let propName in propsDef) {
            if (props[propName] === undefined) {
                if (propsDef[propName] && !propsDef[propName].optional) {
                    throw new Error(`Missing props '${propName}' (component '${Widget.name}')`);
                }
                else {
                    break;
                }
            }
            let isValid;
            try {
                isValid = isValidProp(props[propName], propsDef[propName]);
            }
            catch (e) {
                e.message = `Invalid prop '${propName}' in component ${Widget.name} (${e.message})`;
                throw e;
            }
            if (!isValid) {
                throw new Error(`Invalid Prop '${propName}' in component '${Widget.name}'`);
            }
        }
        for (let propName in props) {
            if (!(propName in propsDef)) {
                throw new Error(`Unknown prop '${propName}' given to component '${Widget.name}'`);
            }
        }
    }
};
/**
 * Check if an invidual prop value matches its (static) prop definition
 */
function isValidProp(prop, propDef) {
    if (propDef === true) {
        return true;
    }
    if (typeof propDef === "function") {
        // Check if a value is constructed by some Constructor.  Note that there is a
        // slight abuse of language: we want to consider primitive values as well.
        //
        // So, even though 1 is not an instance of Number, we want to consider that
        // it is valid.
        if (typeof prop === "object") {
            return prop instanceof propDef;
        }
        return typeof prop === propDef.name.toLowerCase();
    }
    else if (propDef instanceof Array) {
        // If this code is executed, this means that we want to check if a prop
        // matches at least one of its descriptor.
        let result = false;
        for (let i = 0, iLen = propDef.length; i < iLen; i++) {
            result = result || isValidProp(prop, propDef[i]);
        }
        return result;
    }
    // propsDef is an object
    if (propDef.optional && prop === undefined) {
        return true;
    }
    let result = propDef.type ? isValidProp(prop, propDef.type) : true;
    if (propDef.validate) {
        result = result && propDef.validate(prop);
    }
    if (propDef.type === Array && propDef.element) {
        for (let i = 0, iLen = prop.length; i < iLen; i++) {
            result = result && isValidProp(prop[i], propDef.element);
        }
    }
    if (propDef.type === Object && propDef.shape) {
        const shape = propDef.shape;
        for (let key in shape) {
            result = result && isValidProp(prop[key], shape[key]);
        }
        if (result) {
            for (let propName in prop) {
                if (!(propName in shape)) {
                    throw new Error(`unknown prop '${propName}'`);
                }
            }
        }
    }
    return result;
}

/**
 * Owl Style System
 *
 * This files contains the Owl code related to processing (extended) css strings
 * and creating/adding <style> tags to the document head.
 */
const STYLESHEETS = {};
function processSheet(str) {
    const tokens = str.split(/(\{|\}|;)/).map(s => s.trim());
    const selectorStack = [];
    const parts = [];
    let rules = [];
    function generateSelector(stackIndex, parentSelector) {
        const parts = [];
        for (const selector of selectorStack[stackIndex]) {
            let part = (parentSelector && parentSelector + " " + selector) || selector;
            if (part.includes("&")) {
                part = selector.replace(/&/g, parentSelector || "");
            }
            if (stackIndex < selectorStack.length - 1) {
                part = generateSelector(stackIndex + 1, part);
            }
            parts.push(part);
        }
        return parts.join(", ");
    }
    function generateRules() {
        if (rules.length) {
            parts.push(generateSelector(0) + " {");
            parts.push(...rules);
            parts.push("}");
            rules = [];
        }
    }
    while (tokens.length) {
        let token = tokens.shift();
        if (token === "}") {
            generateRules();
            selectorStack.pop();
        }
        else {
            if (tokens[0] === "{") {
                generateRules();
                selectorStack.push(token.split(/\s*,\s*/));
                tokens.shift();
            }
            if (tokens[0] === ";") {
                rules.push("  " + token + ";");
            }
        }
    }
    return parts.join("\n");
}
function registerSheet(id, css) {
    const sheet = document.createElement("style");
    sheet.innerHTML = processSheet(css);
    STYLESHEETS[id] = sheet;
}
function activateSheet(id, name) {
    const sheet = STYLESHEETS[id];
    if (!sheet) {
        throw new Error(`Invalid css stylesheet for component '${name}'. Did you forget to use the 'css' tag helper?`);
    }
    sheet.setAttribute("component", name);
    document.head.appendChild(sheet);
}

const portalSymbol = Symbol("portal"); // FIXME
//------------------------------------------------------------------------------
// Component
//------------------------------------------------------------------------------
let nextId = 1;
class Component {
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Creates an instance of Component.
     *
     * Note that most of the time, only the root component needs to be created by
     * hand.  Other components should be created automatically by the framework (with
     * the t-component directive in a template)
     */
    constructor(parent, props) {
        Component.current = this;
        let constr = this.constructor;
        const defaultProps = constr.defaultProps;
        if (defaultProps) {
            props = props || {};
            this.__applyDefaultProps(props, defaultProps);
        }
        this.props = props;
        if (QWeb.dev) {
            QWeb.utils.validateProps(constr, this.props);
        }
        const id = nextId++;
        let depth;
        if (parent) {
            this.env = parent.env;
            const __powl__ = parent.__owl__;
            __powl__.children[id] = this;
            depth = __powl__.depth + 1;
        }
        else {
            // we are the root component
            this.env = this.constructor.env;
            if (!this.env.qweb) {
                this.env.qweb = new QWeb();
            }
            if (!this.env.browser) {
                this.env.browser = browser;
            }
            this.env.qweb.on("update", this, () => {
                if (this.__owl__.isMounted) {
                    this.render(true);
                }
                if (this.__owl__.isDestroyed) {
                    // this is unlikely to happen, but if a root widget is destroyed,
                    // we want to remove our subscription.  The usual way to do that
                    // would be to perform some check in the destroy method, but since
                    // it is very performance sensitive, and since this is a rare event,
                    // we simply do it lazily
                    this.env.qweb.off("update", this);
                }
            });
            depth = 0;
        }
        const qweb = this.env.qweb;
        const template = constr.template || this.__getTemplate(qweb);
        this.__owl__ = {
            id: id,
            depth: depth,
            vnode: null,
            pvnode: null,
            isMounted: false,
            isDestroyed: false,
            parent: parent || null,
            children: {},
            cmap: {},
            currentFiber: null,
            parentLastFiberId: 0,
            boundHandlers: {},
            mountedCB: null,
            willUnmountCB: null,
            willPatchCB: null,
            patchedCB: null,
            willStartCB: null,
            willUpdatePropsCB: null,
            observer: null,
            renderFn: qweb.render.bind(qweb, template),
            classObj: null,
            refs: null,
            scope: null
        };
        if (constr.style) {
            this.__applyStyles(constr);
        }
    }
    /**
     * The `el` is the root element of the component.  Note that it could be null:
     * this is the case if the component is not mounted yet, or is destroyed.
     */
    get el() {
        return this.__owl__.vnode ? this.__owl__.vnode.elm : null;
    }
    /**
     * willStart is an asynchronous hook that can be implemented to perform some
     * action before the initial rendering of a component.
     *
     * It will be called exactly once before the initial rendering. It is useful
     * in some cases, for example, to load external assets (such as a JS library)
     * before the component is rendered.
     *
     * Note that a slow willStart method will slow down the rendering of the user
     * interface.  Therefore, some effort should be made to make this method as
     * fast as possible.
     *
     * Note: this method should not be called manually.
     */
    async willStart() { }
    /**
     * mounted is a hook that is called each time a component is attached to the
     * DOM. This is a good place to add some listeners, or to interact with the
     * DOM, if the component needs to perform some measure for example.
     *
     * Note: this method should not be called manually.
     *
     * @see willUnmount
     */
    mounted() { }
    /**
     * The willUpdateProps is an asynchronous hook, called just before new props
     * are set. This is useful if the component needs some asynchronous task
     * performed, depending on the props (for example, assuming that the props are
     * some record Id, fetching the record data).
     *
     * This hook is not called during the first render (but willStart is called
     * and performs a similar job).
     */
    async willUpdateProps(nextProps) { }
    /**
     * The willPatch hook is called just before the DOM patching process starts.
     * It is not called on the initial render.  This is useful to get some
     * information which are in the DOM.  For example, the current position of the
     * scrollbar
     */
    willPatch() { }
    /**
     * This hook is called whenever a component did actually update its props,
     * state or env.
     *
     * This method is not called on the initial render. It is useful to interact
     * with the DOM (for example, through an external library) whenever the
     * component was updated.
     *
     * Updating the component state in this hook is possible, but not encouraged.
     * One need to be careful, because updates here will cause rerender, which in
     * turn will cause other calls to updated. So, we need to be particularly
     * careful at avoiding endless cycles.
     */
    patched() { }
    /**
     * willUnmount is a hook that is called each time just before a component is
     * unmounted from the DOM. This is a good place to remove some listeners, for
     * example.
     *
     * Note: this method should not be called manually.
     *
     * @see mounted
     */
    willUnmount() { }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Mount the component to a target element.
     *
     * This should only be done if the component was created manually. Components
     * created declaratively in templates are managed by the Owl system.
     *
     * Note that a component can be mounted an unmounted several times
     */
    async mount(target, options = {}) {
        const position = options.position || "last-child";
        const __owl__ = this.__owl__;
        if (__owl__.isMounted) {
            if (position !== "self" && this.el.parentNode !== target) {
                // in this situation, we are trying to mount a component on a different
                // target. In this case, we need to unmount first, otherwise it will
                // not work.
                this.unmount();
            }
            else {
                return Promise.resolve();
            }
        }
        if (__owl__.currentFiber) {
            const currentFiber = __owl__.currentFiber;
            if (currentFiber.target === target && currentFiber.position === position) {
                return scheduler.addFiber(currentFiber);
            }
            else {
                scheduler.rejectFiber(currentFiber, "Mounting operation cancelled");
            }
        }
        if (!(target instanceof HTMLElement || target instanceof DocumentFragment)) {
            let message = `Component '${this.constructor.name}' cannot be mounted: the target is not a valid DOM node.`;
            message += `\nMaybe the DOM is not ready yet? (in that case, you can use owl.utils.whenReady)`;
            throw new Error(message);
        }
        const fiber = new Fiber(null, this, false, target, position);
        fiber.shouldPatch = false;
        if (!__owl__.vnode) {
            this.__prepareAndRender(fiber, () => { });
        }
        else {
            this.__render(fiber);
        }
        return scheduler.addFiber(fiber);
    }
    /**
     * The unmount method is the opposite of the mount method.  It is useful
     * to call willUnmount calls and remove the component from the DOM.
     */
    unmount() {
        if (this.__owl__.isMounted) {
            this.__callWillUnmount();
            this.el.remove();
        }
    }
    /**
     * The render method is the main entry point to render a component (once it
     * is ready. This method is not initially called when the component is
     * rendered the first time).
     *
     * This method will cause all its sub components to potentially rerender
     * themselves.  Note that `render` is not called if a component is updated via
     * its props.
     */
    async render(force = false) {
        const __owl__ = this.__owl__;
        const currentFiber = __owl__.currentFiber;
        if (!__owl__.isMounted && !currentFiber) {
            // if we get here, this means that the component was either never mounted,
            // or was unmounted and some state change  triggered a render. Either way,
            // we do not want to actually render anything in this case.
            return;
        }
        if (currentFiber && !currentFiber.isRendered && !currentFiber.isCompleted) {
            return scheduler.addFiber(currentFiber.root);
        }
        // if we aren't mounted at this point, it implies that there is a
        // currentFiber that is already rendered (isRendered is true), so we are
        // about to be mounted
        const isMounted = __owl__.isMounted;
        const fiber = new Fiber(null, this, force, null, null);
        Promise.resolve().then(() => {
            if (__owl__.isMounted || !isMounted) {
                if (fiber.isCompleted) {
                    return;
                }
                // we are mounted (__owl__.isMounted), or if we are currently being
                // mounted (!isMounted), so we call __render
                this.__render(fiber);
            }
            else {
                // we were mounted when render was called, but we aren't anymore, so we
                // were actually about to be unmounted ; we can thus forget about this
                // fiber
                fiber.isCompleted = true;
                __owl__.currentFiber = null;
            }
        });
        return scheduler.addFiber(fiber);
    }
    /**
     * Destroy the component.  This operation is quite complex:
     *  - it recursively destroy all children
     *  - call the willUnmount hooks if necessary
     *  - remove the dom node from the dom
     *
     * This should only be called manually if you created the component.  Most
     * components will be automatically destroyed.
     */
    destroy() {
        const __owl__ = this.__owl__;
        if (!__owl__.isDestroyed) {
            const el = this.el;
            this.__destroy(__owl__.parent);
            if (el) {
                el.remove();
            }
        }
    }
    /**
     * This method is called by the component system whenever its props are
     * updated. If it returns true, then the component will be rendered.
     * Otherwise, it will skip the rendering (also, its props will not be updated)
     */
    shouldUpdate(nextProps) {
        return true;
    }
    /**
     * Emit a custom event of type 'eventType' with the given 'payload' on the
     * component's el, if it exists. However, note that the event will only bubble
     * up to the parent DOM nodes. Thus, it must be called between mounted() and
     * willUnmount().
     */
    trigger(eventType, payload) {
        this.__trigger(this, eventType, payload);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Private helper to perform a full destroy, from the point of view of an Owl
     * component. It does not remove the el (this is done only once on the top
     * level destroyed component, for performance reasons).
     *
     * The job of this method is mostly to call willUnmount hooks, and to perform
     * all necessary internal cleanup.
     *
     * Note that it does not call the __callWillUnmount method to avoid visiting
     * all children many times.
     */
    __destroy(parent) {
        const __owl__ = this.__owl__;
        const isMounted = __owl__.isMounted;
        if (isMounted) {
            if (__owl__.willUnmountCB) {
                __owl__.willUnmountCB();
            }
            this.willUnmount();
            __owl__.isMounted = false;
        }
        const children = __owl__.children;
        for (let key in children) {
            children[key].__destroy(this);
        }
        if (parent) {
            let id = __owl__.id;
            delete parent.__owl__.children[id];
            __owl__.parent = null;
        }
        __owl__.isDestroyed = true;
        delete __owl__.vnode;
        if (__owl__.currentFiber) {
            __owl__.currentFiber.isCompleted = true;
        }
    }
    __callMounted() {
        const __owl__ = this.__owl__;
        __owl__.isMounted = true;
        __owl__.currentFiber = null;
        this.mounted();
        if (__owl__.mountedCB) {
            __owl__.mountedCB();
        }
    }
    __callWillUnmount() {
        const __owl__ = this.__owl__;
        if (__owl__.willUnmountCB) {
            __owl__.willUnmountCB();
        }
        this.willUnmount();
        __owl__.isMounted = false;
        if (this.__owl__.currentFiber) {
            this.__owl__.currentFiber.isCompleted = true;
            this.__owl__.currentFiber.root.counter = 0;
        }
        const children = __owl__.children;
        for (let id in children) {
            const comp = children[id];
            if (comp.__owl__.isMounted) {
                comp.__callWillUnmount();
            }
        }
    }
    /**
     * Private trigger method, allows to choose the component which triggered
     * the event in the first place
     */
    __trigger(component, eventType, payload) {
        if (this.el) {
            const ev = new OwlEvent(component, eventType, {
                bubbles: true,
                cancelable: true,
                detail: payload
            });
            const triggerHook = this.env[portalSymbol];
            if (triggerHook) {
                triggerHook(ev);
            }
            this.el.dispatchEvent(ev);
        }
    }
    /**
     * The __updateProps method is called by the t-component directive whenever
     * it updates a component (so, when the parent template is rerendered).
     */
    async __updateProps(nextProps, parentFiber, scope) {
        this.__owl__.scope = scope;
        const shouldUpdate = parentFiber.force || this.shouldUpdate(nextProps);
        if (shouldUpdate) {
            const __owl__ = this.__owl__;
            const fiber = new Fiber(parentFiber, this, parentFiber.force, null, null);
            if (!parentFiber.child) {
                parentFiber.child = fiber;
            }
            else {
                parentFiber.lastChild.sibling = fiber;
            }
            parentFiber.lastChild = fiber;
            const defaultProps = this.constructor.defaultProps;
            if (defaultProps) {
                this.__applyDefaultProps(nextProps, defaultProps);
            }
            if (QWeb.dev) {
                QWeb.utils.validateProps(this.constructor, nextProps);
            }
            await Promise.all([
                this.willUpdateProps(nextProps),
                __owl__.willUpdatePropsCB && __owl__.willUpdatePropsCB(nextProps)
            ]);
            if (fiber.isCompleted) {
                return;
            }
            this.props = nextProps;
            this.__render(fiber);
        }
    }
    /**
     * Main patching method. We call the virtual dom patch method here to convert
     * a virtual dom vnode into some actual dom.
     */
    __patch(target, vnode) {
        this.__owl__.vnode = patch(target, vnode);
    }
    /**
     * The __prepare method is only called by the t-component directive, when a
     * subcomponent is created. It gets its scope, if any, from the
     * parent template.
     */
    __prepare(parentFiber, scope, cb) {
        this.__owl__.scope = scope;
        const fiber = new Fiber(parentFiber, this, parentFiber.force, null, null);
        fiber.shouldPatch = false;
        if (!parentFiber.child) {
            parentFiber.child = fiber;
        }
        else {
            parentFiber.lastChild.sibling = fiber;
        }
        parentFiber.lastChild = fiber;
        this.__prepareAndRender(fiber, cb);
        return fiber;
    }
    /**
     * Apply the stylesheets defined by the component. Note that we need to make
     * sure all inherited stylesheets are applied as well.  We then delete the
     * `style` key from the constructor to make sure we do not apply it again.
     */
    __applyStyles(constr) {
        while (constr && constr.style) {
            if (constr.hasOwnProperty("style")) {
                activateSheet(constr.style, constr.name);
                delete constr.style;
            }
            constr = constr.__proto__;
        }
    }
    __getTemplate(qweb) {
        let p = this.constructor;
        if (!p.hasOwnProperty("_template")) {
            // here, the component and none of its superclasses defines a static `template`
            // key. So we fall back on looking for a template matching its name (or
            // one of its subclass).
            let template = p.name;
            while (!(template in qweb.templates) && p !== Component) {
                p = p.__proto__;
                template = p.name;
            }
            if (p === Component) {
                throw new Error(`Could not find template for component "${this.constructor.name}"`);
            }
            else {
                p._template = template;
            }
        }
        return p._template;
    }
    async __prepareAndRender(fiber, cb) {
        try {
            await Promise.all([this.willStart(), this.__owl__.willStartCB && this.__owl__.willStartCB()]);
        }
        catch (e) {
            fiber.handleError(e);
            return Promise.resolve();
        }
        if (this.__owl__.isDestroyed) {
            return Promise.resolve();
        }
        if (!fiber.isCompleted) {
            this.__render(fiber);
            cb();
        }
    }
    __render(fiber) {
        const __owl__ = this.__owl__;
        if (__owl__.observer) {
            __owl__.observer.allowMutations = false;
        }
        let error;
        try {
            let vnode = __owl__.renderFn(this, {
                handlers: __owl__.boundHandlers,
                fiber: fiber
            });
            // we iterate over the children to detect those that no longer belong to the
            // current rendering: those ones, if not mounted yet, can (and have to) be
            // destroyed right now, because they are not in the DOM, and thus we won't
            // be notified later on (when patching), that they are removed from the DOM
            for (let childKey in __owl__.children) {
                let child = __owl__.children[childKey];
                if (!child.__owl__.isMounted && child.__owl__.parentLastFiberId < fiber.id) {
                    child.destroy();
                }
            }
            if (!vnode) {
                throw new Error(`Rendering '${this.constructor.name}' did not return anything`);
            }
            fiber.vnode = vnode;
            // we apply here the class information described on the component by the
            // template (so, something like <MyComponent class="..."/>) to the actual
            // root vnode
            if (__owl__.classObj) {
                const data = vnode.data;
                data.class = Object.assign(data.class || {}, __owl__.classObj);
            }
        }
        catch (e) {
            error = e;
        }
        if (__owl__.observer) {
            __owl__.observer.allowMutations = true;
        }
        fiber.root.counter--;
        fiber.isRendered = true;
        if (error) {
            fiber.handleError(error);
        }
    }
    /**
     * Only called by qweb t-component directive (when t-keepalive is set)
     */
    __remount() {
        const __owl__ = this.__owl__;
        if (!__owl__.isMounted) {
            __owl__.isMounted = true;
            this.mounted();
        }
    }
    /**
     * Apply default props (only top level).
     *
     * Note that this method does modify in place the props
     */
    __applyDefaultProps(props, defaultProps) {
        for (let propName in defaultProps) {
            if (props[propName] === undefined) {
                props[propName] = defaultProps[propName];
            }
        }
    }
}
Component.template = null;
Component._template = null;
Component.current = null;
Component.components = {};
Component.env = {};
// expose scheduler s.t. it can be mocked for testing purposes
Component.scheduler = scheduler;

/**
 * The `Context` object provides a way to share data between an arbitrary number
 * of component. Usually, data is passed from a parent to its children component,
 * but when we have to deal with some mostly global information, this can be
 * annoying, since each component will need to pass the information to each
 * children, even though some or most of them will not use the information.
 *
 * With a `Context` object, each component can subscribe (with the `useContext`
 * hook) to its state, and will be updated whenever the context state is updated.
 */
function partitionBy(arr, fn) {
    let lastGroup = false;
    let lastValue;
    return arr.reduce((acc, cur) => {
        let curVal = fn(cur);
        if (lastGroup) {
            if (curVal === lastValue) {
                lastGroup.push(cur);
            }
            else {
                lastGroup = false;
            }
        }
        if (!lastGroup) {
            lastGroup = [cur];
            acc.push(lastGroup);
        }
        lastValue = curVal;
        return acc;
    }, []);
}
class Context extends EventBus {
    constructor(state = {}) {
        super();
        this.rev = 1;
        // mapping from component id to last observed context id
        this.mapping = {};
        this.observer = new Observer();
        this.observer.notifyCB = () => {
            // notify components in the next microtask tick to ensure that subscribers
            // are notified only once for all changes that occur in the same micro tick
            let rev = this.rev;
            return Promise.resolve().then(() => {
                if (rev === this.rev) {
                    this.__notifyComponents();
                }
            });
        };
        this.state = this.observer.observe(state);
        this.subscriptions.update = [];
    }
    /**
     * Instead of using trigger to emit an update event, we actually implement
     * our own function to do that.  The reason is that we need to be smarter than
     * a simple trigger function: we need to wait for parent components to be
     * done before doing children components.  More precisely, if an update
     * as an effect of destroying a children, we do not want to call any code
     * from the child, and certainly not render it.
     *
     * This method implements a simple grouping algorithm by depth. If we have
     * connected components of depths [2, 4,4,4,4, 3,8,8], the Context will notify
     * them in the following groups: [2], [4,4,4,4], [3], [8,8]. Each group will
     * be updated sequentially, but each components in a given group will be done in
     * parallel.
     *
     * This is a very simple algorithm, but it avoids checking if a given
     * component is a child of another.
     */
    async __notifyComponents() {
        const rev = ++this.rev;
        const subscriptions = this.subscriptions.update;
        const groups = partitionBy(subscriptions, s => (s.owner ? s.owner.__owl__.depth : -1));
        for (let group of groups) {
            const proms = group.map(sub => sub.callback.call(sub.owner, rev));
            // at this point, each component in the current group has registered a
            // top level fiber in the scheduler. It could happen that rendering these
            // components is done (if they have no children).  This is why we manually
            // flush the scheduler.  This will force the scheduler to check
            // immediately if they are done, which will cause their rendering
            // promise to resolve earlier, which means that there is a chance of
            // processing the next group in the same frame.
            scheduler.flush();
            await Promise.all(proms);
        }
    }
}
/**
 * The`useContext` hook is the normal way for a component to register themselve
 * to context state changes. The `useContext` method returns the context state
 */
function useContext(ctx) {
    const component = Component.current;
    return useContextWithCB(ctx, component, component.render.bind(component));
}
function useContextWithCB(ctx, component, method) {
    const __owl__ = component.__owl__;
    const id = __owl__.id;
    const mapping = ctx.mapping;
    if (id in mapping) {
        return ctx.state;
    }
    if (!__owl__.observer) {
        __owl__.observer = new Observer();
        __owl__.observer.notifyCB = component.render.bind(component);
    }
    const currentCB = __owl__.observer.notifyCB;
    __owl__.observer.notifyCB = function () {
        if (ctx.rev > mapping[id]) {
            // in this case, the context has been updated since we were rendering
            // last, and we do not need to render here with the observer. A
            // rendering is coming anyway, with the correct props.
            return;
        }
        currentCB();
    };
    mapping[id] = 0;
    const renderFn = __owl__.renderFn;
    __owl__.renderFn = function (comp, params) {
        mapping[id] = ctx.rev;
        return renderFn(comp, params);
    };
    ctx.on("update", component, async (contextRev) => {
        if (mapping[id] < contextRev) {
            mapping[id] = contextRev;
            await method();
        }
    });
    const __destroy = component.__destroy;
    component.__destroy = parent => {
        ctx.off("update", component);
        delete mapping[id];
        __destroy.call(component, parent);
    };
    return ctx.state;
}

/**
 * Owl Hook System
 *
 * This file introduces the concept of hooks, similar to React or Vue hooks.
 * We have currently an implementation of:
 * - useState (reactive state)
 * - onMounted
 * - onWillUnmount
 * - useRef
 */
// -----------------------------------------------------------------------------
// useState
// -----------------------------------------------------------------------------
/**
 * This is the main way a component can be made reactive.  The useState hook
 * will return an observed object (or array).  Changes to that value will then
 * trigger a rerendering of the current component.
 */
function useState(state) {
    const component = Component.current;
    const __owl__ = component.__owl__;
    if (!__owl__.observer) {
        __owl__.observer = new Observer();
        __owl__.observer.notifyCB = component.render.bind(component);
    }
    return __owl__.observer.observe(state);
}
// -----------------------------------------------------------------------------
// Life cycle hooks
// -----------------------------------------------------------------------------
function makeLifecycleHook(method, reverse = false) {
    if (reverse) {
        return function (cb) {
            const component = Component.current;
            if (component.__owl__[method]) {
                const current = component.__owl__[method];
                component.__owl__[method] = function () {
                    current.call(component);
                    cb.call(component);
                };
            }
            else {
                component.__owl__[method] = cb;
            }
        };
    }
    else {
        return function (cb) {
            const component = Component.current;
            if (component.__owl__[method]) {
                const current = component.__owl__[method];
                component.__owl__[method] = function () {
                    cb.call(component);
                    current.call(component);
                };
            }
            else {
                component.__owl__[method] = cb;
            }
        };
    }
}
function makeAsyncHook(method) {
    return function (cb) {
        const component = Component.current;
        if (component.__owl__[method]) {
            const current = component.__owl__[method];
            component.__owl__[method] = function (...args) {
                return Promise.all([current.call(component, ...args), cb.call(component, ...args)]);
            };
        }
        else {
            component.__owl__[method] = cb;
        }
    };
}
const onMounted = makeLifecycleHook("mountedCB", true);
const onWillUnmount = makeLifecycleHook("willUnmountCB");
const onWillPatch = makeLifecycleHook("willPatchCB");
const onPatched = makeLifecycleHook("patchedCB", true);
const onWillStart = makeAsyncHook("willStartCB");
const onWillUpdateProps = makeAsyncHook("willUpdatePropsCB");
function useRef(name) {
    const __owl__ = Component.current.__owl__;
    return {
        get el() {
            const val = __owl__.refs && __owl__.refs[name];
            if (val instanceof HTMLElement) {
                return val;
            }
            else if (val instanceof Component) {
                return val.el;
            }
            return null;
        },
        get comp() {
            const val = __owl__.refs && __owl__.refs[name];
            return val instanceof Component ? val : null;
        }
    };
}
// -----------------------------------------------------------------------------
// useSubEnv
// -----------------------------------------------------------------------------
/**
 * This hook is a simple way to let components use a sub environment.  Note that
 * like for all hooks, it is important that this is only called in the
 * constructor method.
 */
function useSubEnv(nextEnv) {
    const component = Component.current;
    component.env = Object.assign(Object.create(component.env), nextEnv);
}
// -----------------------------------------------------------------------------
// useExternalListener
// -----------------------------------------------------------------------------
/**
 * When a component needs to listen to DOM Events on element(s) that are not
 * part of his hierarchy, we can use the `useExternalListener` hook.
 * It will correctly add and remove the event listener, whenever the
 * component is mounted and unmounted.
 *
 * Example:
 *  a menu needs to listen to the click on window to be closed automatically
 *
 * Usage:
 *  in the constructor of the OWL component that needs to be notified,
 *  `useExternalListener(window, 'click', this._doSomething);`
 * */
function useExternalListener(target, eventName, handler, eventParams) {
    const boundHandler = handler.bind(Component.current);
    onMounted(() => target.addEventListener(eventName, boundHandler, eventParams));
    onWillUnmount(() => target.removeEventListener(eventName, boundHandler, eventParams));
}

var _hooks = /*#__PURE__*/Object.freeze({
    __proto__: null,
    useState: useState,
    onMounted: onMounted,
    onWillUnmount: onWillUnmount,
    onWillPatch: onWillPatch,
    onPatched: onPatched,
    onWillStart: onWillStart,
    onWillUpdateProps: onWillUpdateProps,
    useRef: useRef,
    useSubEnv: useSubEnv,
    useExternalListener: useExternalListener
});

class Store extends Context {
    constructor(config) {
        super(config.state);
        this.actions = config.actions;
        this.env = config.env;
        this.getters = {};
        this.updateFunctions = [];
        if (config.getters) {
            const firstArg = {
                state: this.state,
                getters: this.getters
            };
            for (let g in config.getters) {
                this.getters[g] = config.getters[g].bind(this, firstArg);
            }
        }
    }
    dispatch(action, ...payload) {
        if (!this.actions[action]) {
            throw new Error(`[Error] action ${action} is undefined`);
        }
        const result = this.actions[action]({
            dispatch: this.dispatch.bind(this),
            env: this.env,
            state: this.state,
            getters: this.getters
        }, ...payload);
        return result;
    }
}
const isStrictEqual = (a, b) => a === b;
function useStore(selector, options = {}) {
    const component = Component.current;
    const componentId = component.__owl__.id;
    const store = options.store || component.env.store;
    if (!(store instanceof Store)) {
        throw new Error(`No store found when connecting '${component.constructor.name}'`);
    }
    let result = selector(store.state, component.props);
    const hashFn = store.observer.revNumber.bind(store.observer);
    let revNumber = hashFn(result);
    const isEqual = options.isEqual || isStrictEqual;
    if (!store.updateFunctions[componentId]) {
        store.updateFunctions[componentId] = [];
    }
    function selectCompareUpdate(state, props) {
        const oldResult = result;
        result = selector(state, props);
        const newRevNumber = hashFn(result);
        if ((newRevNumber > 0 && revNumber !== newRevNumber) || !isEqual(oldResult, result)) {
            revNumber = newRevNumber;
            if (options.onUpdate) {
                options.onUpdate(result);
            }
            return true;
        }
        return false;
    }
    store.updateFunctions[componentId].push(function () {
        return selectCompareUpdate(store.state, component.props);
    });
    useContextWithCB(store, component, function () {
        let shouldRender = false;
        for (let fn of store.updateFunctions[componentId]) {
            shouldRender = fn() || shouldRender;
        }
        if (shouldRender) {
            return component.render();
        }
    });
    onWillUpdateProps(props => {
        selectCompareUpdate(store.state, props);
    });
    const __destroy = component.__destroy;
    component.__destroy = parent => {
        delete store.updateFunctions[componentId];
        __destroy.call(component, parent);
    };
    if (typeof result !== "object" || result === null) {
        return result;
    }
    return new Proxy(result, {
        get(target, k) {
            return result[k];
        },
        set(target, k, v) {
            throw new Error("Store state should only be modified through actions");
        },
        has(target, k) {
            return k in result;
        }
    });
}
function useDispatch(store) {
    store = store || Component.current.env.store;
    return store.dispatch.bind(store);
}
function useGetters(store) {
    store = store || Component.current.env.store;
    return store.getters;
}

/**
 * Owl Tags
 *
 * We have here a (very) small collection of tag functions:
 *
 * - xml
 *
 * The plan is to add a few other tags such as css, globalcss.
 */
/**
 * XML tag helper for defining templates.  With this, one can simply define
 * an inline template with just the template xml:
 * ```js
 *   class A extends Component {
 *     static template = xml`<div>some template</div>`;
 *   }
 * ```
 */
function xml(strings, ...args) {
    const name = `__template__${QWeb.nextId++}`;
    const value = String.raw(strings, ...args);
    QWeb.registerTemplate(name, value);
    return name;
}
/**
 * CSS tag helper for defining inline stylesheets.  With this, one can simply define
 * an inline stylesheet with just the following code:
 * ```js
 *   class A extends Component {
 *     static style = css`.component-a { color: red; }`;
 *   }
 * ```
 */
function css(strings, ...args) {
    const name = `__sheet__${QWeb.nextId++}`;
    const value = String.raw(strings, ...args);
    registerSheet(name, value);
    return name;
}

var _tags = /*#__PURE__*/Object.freeze({
    __proto__: null,
    xml: xml,
    css: css
});

/**
 * AsyncRoot
 *
 * Owl is by default asynchronous, and the user interface will wait for all its
 * subcomponents to be rendered before updating the DOM. This is most of the
 * time what we want, but in some cases, it makes sense to "detach" a component
 * from this coordination.  This is the goal of the AsyncRoot component.
 */
class AsyncRoot extends Component {
    async __updateProps(nextProps, parentFiber) {
        this.render(parentFiber.force);
    }
}
AsyncRoot.template = xml `<t t-slot="default"/>`;

class Portal extends Component {
    constructor(parent, props) {
        super(parent, props);
        // boolean to indicate whether or not we must listen to 'dom-appended' event
        // to hook on the moment when the target is inserted into the DOM (because it
        // is not when the portal is rendered)
        this.doTargetLookUp = true;
        // set of encountered events that need to be redirected
        this._handledEvents = new Set();
        // function that will be the event's tunnel (needs to be an arrow function to
        // avoid having to rebind `this`)
        this._handlerTunnel = (ev) => {
            ev.stopPropagation();
            this.__trigger(ev.originalComponent, ev.type, ev.detail);
        };
        // Storing the parent's env
        this.parentEnv = null;
        // represents the element that is moved somewhere else
        this.portal = null;
        // the target where we will move `portal`
        this.target = null;
        this.parentEnv = parent ? parent.env : {};
        // put a callback in the env that is propagated to children s.t. portal can
        // register an handler to those events just before children will trigger them
        useSubEnv({
            [portalSymbol]: ev => {
                if (!this._handledEvents.has(ev.type)) {
                    this.portal.elm.addEventListener(ev.type, this._handlerTunnel);
                    this._handledEvents.add(ev.type);
                }
            }
        });
    }
    /**
     * Override to revert back to a classic Component's structure
     *
     * @override
     */
    __callWillUnmount() {
        super.__callWillUnmount();
        this.el.appendChild(this.portal.elm);
        this.doTargetLookUp = true;
    }
    /**
     * At each DOM change, we must ensure that the portal contains exactly one
     * child
     */
    __checkVNodeStructure(vnode) {
        const children = vnode.children;
        let countRealNodes = 0;
        for (let child of children) {
            if (child.sel) {
                countRealNodes++;
            }
        }
        if (countRealNodes !== 1) {
            throw new Error(`Portal must have exactly one non-text child (has ${countRealNodes})`);
        }
    }
    /**
     * Ensure the target is still there at whichever time we render
     */
    __checkTargetPresence() {
        if (!this.target || !document.contains(this.target)) {
            throw new Error(`Could not find any match for "${this.props.target}"`);
        }
    }
    /**
     * Move the portal's element to the target
     */
    __deployPortal() {
        this.__checkTargetPresence();
        this.target.appendChild(this.portal.elm);
    }
    /**
     * Override to remove from the DOM the element we have teleported
     *
     * @override
     */
    __destroy(parent) {
        if (this.portal && this.portal.elm) {
            const displacedElm = this.portal.elm;
            const parent = displacedElm.parentNode;
            if (parent) {
                parent.removeChild(displacedElm);
            }
        }
        super.__destroy(parent);
    }
    /**
     * Override to patch the element that has been teleported
     *
     * @override
     */
    __patch(target, vnode) {
        if (this.doTargetLookUp) {
            const target = document.querySelector(this.props.target);
            if (!target) {
                this.env.qweb.on("dom-appended", this, () => {
                    this.doTargetLookUp = false;
                    this.env.qweb.off("dom-appended", this);
                    this.target = document.querySelector(this.props.target);
                    this.__deployPortal();
                });
            }
            else {
                this.doTargetLookUp = false;
                this.target = target;
            }
        }
        this.__checkVNodeStructure(vnode);
        const shouldDeploy = (!this.portal || this.el.contains(this.portal.elm)) && !this.doTargetLookUp;
        if (!this.doTargetLookUp && !shouldDeploy) {
            // Only on pure patching, provided the
            // this.target's parent has not been unmounted
            this.__checkTargetPresence();
        }
        const portalPatch = this.portal ? this.portal : document.createElement(vnode.children[0].sel);
        this.portal = patch(portalPatch, vnode.children[0]);
        vnode.children = [];
        super.__patch(target, vnode);
        if (shouldDeploy) {
            this.__deployPortal();
        }
    }
    /**
     * Override to set the env
     */
    __trigger(component, eventType, payload) {
        const env = this.env;
        this.env = this.parentEnv;
        super.__trigger(component, eventType, payload);
        this.env = env;
    }
}
Portal.template = xml `<portal><t t-slot="default"/></portal>`;
Portal.props = {
    target: {
        type: String
    }
};

class Link extends Component {
    constructor() {
        super(...arguments);
        this.href = this.env.router.destToPath(this.props);
    }
    async willUpdateProps(nextProps) {
        this.href = this.env.router.destToPath(nextProps);
    }
    get isActive() {
        if (this.env.router.mode === "hash") {
            return document.location.hash === this.href;
        }
        return document.location.pathname === this.href;
    }
    navigate(ev) {
        // don't redirect with control keys
        if (ev.metaKey || ev.altKey || ev.ctrlKey || ev.shiftKey) {
            return;
        }
        // don't redirect on right click
        if (ev.button !== undefined && ev.button !== 0) {
            return;
        }
        // don't redirect if `target="_blank"`
        if (ev.currentTarget && ev.currentTarget.getAttribute) {
            const target = ev.currentTarget.getAttribute("target");
            if (/\b_blank\b/i.test(target)) {
                return;
            }
        }
        ev.preventDefault();
        this.env.router.navigate(this.props);
    }
}
Link.template = xml `
    <a  t-att-class="{'router-link-active': isActive }"
        t-att-href="href"
        t-on-click="navigate">
        <t t-slot="default"/>
    </a>
  `;

class RouteComponent extends Component {
    get routeComponent() {
        return this.env.router.currentRoute && this.env.router.currentRoute.component;
    }
}
RouteComponent.template = xml `
    <t>
        <t
            t-if="routeComponent"
            t-component="routeComponent"
            t-key="env.router.currentRouteName"
            t-props="env.router.currentParams" />
    </t>
  `;

const paramRegexp = /\{\{(.*?)\}\}/;
class Router {
    constructor(env, routes, options = { mode: "history" }) {
        this.currentRoute = null;
        this.currentParams = null;
        env.router = this;
        this.mode = options.mode;
        this.env = env;
        this.routes = {};
        this.routeIds = [];
        let nextId = 1;
        for (let partialRoute of routes) {
            if (!partialRoute.name) {
                partialRoute.name = "__route__" + nextId++;
            }
            if (partialRoute.component) {
                QWeb.registerComponent("__component__" + partialRoute.name, partialRoute.component);
            }
            if (partialRoute.redirect) {
                this.validateDestination(partialRoute.redirect);
            }
            partialRoute.params = partialRoute.path ? findParams(partialRoute.path) : [];
            this.routes[partialRoute.name] = partialRoute;
            this.routeIds.push(partialRoute.name);
        }
    }
    //--------------------------------------------------------------------------
    // Public API
    //--------------------------------------------------------------------------
    async start() {
        this._listener = ev => this._navigate(this.currentPath(), ev);
        window.addEventListener("popstate", this._listener);
        if (this.mode === "hash") {
            window.addEventListener("hashchange", this._listener);
        }
        const result = await this.matchAndApplyRules(this.currentPath());
        if (result.type === "match") {
            this.currentRoute = result.route;
            this.currentParams = result.params;
            const currentPath = this.routeToPath(result.route, result.params);
            if (currentPath !== this.currentPath()) {
                this.setUrlFromPath(currentPath);
            }
        }
    }
    async navigate(to) {
        const path = this.destToPath(to);
        return this._navigate(path);
    }
    async _navigate(path, ev) {
        const initialName = this.currentRouteName;
        const initialParams = this.currentParams;
        const result = await this.matchAndApplyRules(path);
        if (result.type === "match") {
            const finalPath = this.routeToPath(result.route, result.params);
            const isPopStateEvent = ev && ev instanceof PopStateEvent;
            if (!isPopStateEvent) {
                this.setUrlFromPath(finalPath);
            }
            this.currentRoute = result.route;
            this.currentParams = result.params;
        }
        else if (result.type === "nomatch") {
            this.currentRoute = null;
            this.currentParams = null;
        }
        const didChange = this.currentRouteName !== initialName || !shallowEqual(this.currentParams, initialParams);
        if (didChange) {
            this.env.qweb.forceUpdate();
            return true;
        }
        return false;
    }
    destToPath(dest) {
        this.validateDestination(dest);
        return dest.path || this.routeToPath(this.routes[dest.to], dest.params);
    }
    get currentRouteName() {
        return this.currentRoute && this.currentRoute.name;
    }
    //--------------------------------------------------------------------------
    // Private helpers
    //--------------------------------------------------------------------------
    setUrlFromPath(path) {
        const separator = this.mode === "hash" ? location.pathname : "";
        const url = location.origin + separator + path;
        if (url !== window.location.href) {
            window.history.pushState({}, path, url);
        }
    }
    validateDestination(dest) {
        if ((!dest.path && !dest.to) || (dest.path && dest.to)) {
            throw new Error(`Invalid destination: ${JSON.stringify(dest)}`);
        }
    }
    routeToPath(route, params) {
        const path = route.path;
        const parts = path.split("/");
        const l = parts.length;
        for (let i = 0; i < l; i++) {
            const part = parts[i];
            const match = part.match(paramRegexp);
            if (match) {
                const key = match[1].split(".")[0];
                parts[i] = params[key];
            }
        }
        const prefix = this.mode === "hash" ? "#" : "";
        return prefix + parts.join("/");
    }
    currentPath() {
        let result = this.mode === "history" ? window.location.pathname : window.location.hash.slice(1);
        return result || "/";
    }
    match(path) {
        for (let routeId of this.routeIds) {
            let route = this.routes[routeId];
            let params = this.getRouteParams(route, path);
            if (params) {
                return {
                    type: "match",
                    route: route,
                    params: params
                };
            }
        }
        return { type: "nomatch" };
    }
    async matchAndApplyRules(path) {
        const result = this.match(path);
        if (result.type === "match") {
            return this.applyRules(result);
        }
        return result;
    }
    async applyRules(matchResult) {
        const route = matchResult.route;
        if (route.redirect) {
            const path = this.destToPath(route.redirect);
            return this.matchAndApplyRules(path);
        }
        if (route.beforeRouteEnter) {
            const result = await route.beforeRouteEnter({
                env: this.env,
                from: this.currentRoute,
                to: route
            });
            if (result === false) {
                return { type: "cancelled" };
            }
            else if (result !== true) {
                // we want to navigate to another destination
                const path = this.destToPath(result);
                return this.matchAndApplyRules(path);
            }
        }
        return matchResult;
    }
    getRouteParams(route, path) {
        if (route.path === "*") {
            return {};
        }
        if (path.startsWith("#")) {
            path = path.slice(1);
        }
        const descrParts = route.path.split("/");
        const targetParts = path.split("/");
        const l = descrParts.length;
        if (l !== targetParts.length) {
            return false;
        }
        const result = {};
        for (let i = 0; i < l; i++) {
            const descr = descrParts[i];
            let target = targetParts[i];
            const match = descr.match(paramRegexp);
            if (match) {
                const [key, suffix] = match[1].split(".");
                if (suffix === "number") {
                    target = parseInt(target, 10);
                }
                result[key] = target;
            }
            else if (descr !== target) {
                return false;
            }
        }
        return result;
    }
}
function findParams(str) {
    const globalParamRegexp = /\{\{(.*?)\}\}/g;
    const result = [];
    let m;
    do {
        m = globalParamRegexp.exec(str);
        if (m) {
            result.push(m[1].split(".")[0]);
        }
    } while (m);
    return result;
}

/**
 * This file is the main file packaged by rollup (see rollup.config.js).  From
 * this file, we export all public owl elements.
 *
 * Note that dynamic values, such as a date or a commit hash are added by rollup
 */
const Context$1 = Context;
const useState$1 = useState;
const core = { EventBus, Observer };
const router = { Router, RouteComponent, Link };
const Store$1 = Store;
const utils = _utils;
const tags = _tags;
const misc = { AsyncRoot, Portal };
const hooks$1 = Object.assign({}, _hooks, {
    useContext: useContext,
    useDispatch: useDispatch,
    useGetters: useGetters,
    useStore: useStore
});
const __info__ = {};

exports.Component = Component;
exports.Context = Context$1;
exports.QWeb = QWeb;
exports.Store = Store$1;
exports.__info__ = __info__;
exports.config = config;
exports.core = core;
exports.hooks = hooks$1;
exports.misc = misc;
exports.router = router;
exports.tags = tags;
exports.useState = useState$1;
exports.utils = utils;

exports.__info__.version = '1.0.7';
exports.__info__.date = '2020-04-17T13:53:57.507Z';
exports.__info__.hash = '23ce19e';
exports.__info__.url = 'https://github.com/odoo/owl';


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/bundle-basic-editor/basicLayout.css":
/*!********************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/bundle-basic-editor/basicLayout.css ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-editor {\n    display: flex;\n    flex-direction: column;\n    position: relative;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/bundle-odoo-website-editor/odooLayout.css":
/*!**************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/bundle-odoo-website-editor/odooLayout.css ***!
  \**************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-editor {\n    display: flex;\n    flex-direction: column;\n}\n\n.jw-dropdown {\n    display: inline-block;\n}\n.jw-dropdown .dropdown-menu {\n    min-width: 250px;\n    border: 1px solid #000;\n    background-color: #141217;\n}\n\njw-toolbar input {\n    color: #C6C6C6;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-device-preview/assets/DevicePreview.css":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-device-preview/assets/DevicePreview.css ***!
  \*******************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "#jw-device-preview {\n    border-width: 80px 14px 40px;\n    border-radius: 16px;\n    border-style: solid;\n    border-color: #000;\n    background-color: white;\n    width: 400px;\n    height: 700px;\n    margin: auto;\n    display: block;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css":
/*!********************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "/* GLOBAL */\n\njw-devtools {\n    position: sticky;\n    position: -webkit-sticky;\n    bottom: 0;\n    min-height: 30px;\n    max-height: 100%;\n    top: auto;\n    background-color: white;\n    border-top: 1px solid #d0d0d0;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    user-select: none;\n    outline: none;\n}\n\ndevtools-table {\n    display: table;\n    width: 100%\n}\ndevtools-tbody {\n    display: table-row-group;\n}\ndevtools-tr {\n    display: table-row;\n}\ndevtools-td {\n    display: table-cell;\n    padding-right: 25px;\n}\ndevtools-button {\n    display: inline;\n    text-align: center;\n    align-items: flex-start;\n    box-sizing: border-box;\n    line-height: 2em;\n    font-family: initial;\n}\ndevtools-list {\n    display: block;\n    list-style: none;\n}\ndevtools-listitem {\n    display: list-item;\n}\n\njw-devtools.closed {\n    max-height: 31px;\n}\n\njw-devtools .bold {\n    font-weight: bold;\n}\n\njw-devtools .italic {\n    font-style: italic;\n}\n\njw-devtools .underline {\n    text-decoration: underline;\n}\n\njw-devtools .link {\n    text-decoration: underline;\n    color: blue;\n}\n\njw-devtools .subscript {\n    vertical-align: sub;\n    font-size: 0.7em;\n}\n\njw-devtools .superscript {\n    vertical-align: super;\n    font-size: 0.7em;\n}\n\njw-devtools .marker-node {\n    color: red;\n}\n\ndevtools-panel {\n    display: flex;\n    overflow: auto;\n}\n\ndevtools-panel:not(.active) {\n    display: none;\n}\n\ndevtools-panel .selectable-line:hover {\n    background-color: rgba(118, 82, 108, 0.2);\n}\n\ndevtools-panel .selectable-line.selected {\n    background-color: rgba(118, 82, 108, 0.3);\n}\n\ndevtools-panel devtools-button.logger {\n    float: right;\n    border: none;\n    background-color: transparent;\n    color: #666666;\n    padding: 0;\n    margin: 0;\n    display: none;\n    line-height: 0.7em;\n}\n\ndevtools-panel devtools-about > devtools-button.logger {\n    display: inline;\n    margin-left: 1em;\n}\n\ndevtools-panel .selectable-line:hover devtools-button.logger, devtools-panel .selected devtools-button.logger {\n    display: inline;\n}\n\n/* NAVBAR */\n\njw-devtools:not(.closed) > devtools-navbar {\n    cursor: row-resize;\n}\n\ndevtools-navbar {\n    background-color: #f3f3f3;\n    position: relative;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    height: 30px;\n    min-height: 30px;\n    width: 100%;\n    align-items: center;\n    border: 0;\n    border-bottom: 1px solid #d0d0d0;\n    box-sizing: border-box;\n    vertical-align: baseline;\n}\n\ndevtools-navbar > devtools-button {\n    padding: 0 10px 0 10px;\n    background: none;\n    border: 0;\n    vertical-align: middle;\n    outline: none;\n    cursor: auto;\n}\n\ndevtools-navbar > devtools-button:hover {\n    background-color: #d6d6d6;\n}\n\ndevtools-navbar > devtools-button.selected {\n    border-bottom: solid 2px #76526c;\n}\n\n/* CONTENTS */\n\ndevtools-contents {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n    overflow: auto;\n    position: relative;\n    font-family: 'Courier New', Courier, monospace;\n}\n\n/* mainpane */\n\ndevtools-mainpane {\n    display: flex;\n    overflow: auto;\n    flex-direction: column;\n    width: 100%;\n}\n\nmainpane-contents {\n    overflow: auto;\n    flex: 1;\n    padding: 1em;\n}\n\ndevtools-command {\n    display: block;\n}\n\ndevtools-td.numbering {\n    color: grey;\n}\n\n\n/* tree */\n\ndevtools-tree {\n    display: block;\n    flex-grow: 1;\n    width: 100%;\n}\n\ndevtools-tree devtools-children {\n    display: block;\n    position: relative;\n    box-sizing: border-box;\n    padding: 1px 0 1px 1.5em;\n    border-left: 1px solid #d0d0d0;\n}\n\ndevtools-tree div {\n    width: 100%;\n}\n\ndevtools-tree > devtools-node.root > devtools-nodename {\n    background-color: #76526c;\n    color: white;\n    padding-left: 5px;\n    box-sizing: border-box;\n}\n\njw-devtools devtools-nodename.inline {\n    display: inline;\n}\n\ndevtools-tree devtools-nodename.block {\n    color: #76526c;\n    width: 100%;\n    display: inline-block;\n}\n\ndevtools-tree devtools-nodename.line-break:after {\n    content: '\\A';\n    white-space: pre;\n}\n\ndevtools-node {\n    outline: none;\n}\n\ndevtools-node:not(.folded):not(.self-closing):not(.root) > devtools-nodename.block:before {\n    content: ' ';\n}\n\ndevtools-node.folded:not(.self-closing) > devtools-nodename.block:before {\n    content: ' ';\n}\n\ndevtools-node.folded devtools-children {\n    display: none;\n}\n\ndevtools-path {\n    display: block;\n    border-top: 1px solid #d0d0d0;\n    background-color: #dddddd;\n    bottom: 0;\n    left: 0;\n    right: 0;\n}\n\ndevtools-pathnode {\n    display: inline-block;\n    padding: .2em 1em .2em 1em;\n    color: #696969;\n    font-size: 13px;\n}\n\ndevtools-pathnode:hover {\n    background-color: #d6d6d6;\n}\n\ndevtools-pathnode.selected {\n    background-color: #d0d0d0;\n}\n\n/* sidepane */\n\ndevtools-sidepane {\n    position: relative;\n    overflow: auto;\n    display: block;\n    font-size: 15px;\n    box-sizing: border-box;\n    width: 30%;\n    background-color: white;\n    border-left: 1px solid #d0d0d0;\n}\n\ndevtools-sidepane devtools-about {\n    border-bottom: 1px solid #d0d0d0;\n    padding: 10px;\n}\n\ndevtools-sidepane devtools-about devtools-type {\n    font-family: initial;\n    font-style: italic;\n    font-size: smaller;\n    color: #76526c;\n    padding-right: .5em;\n}\n\ndevtools-sidepane devtools-properties {\n    font-size: 12px;\n    padding: 10px;\n    overflow: auto;\n    margin-bottom: 30px;\n}\n\ndevtools-infotitle {\n    display: block;\n}\n\ndevtools-sidepane devtools-properties devtools-infotitle {\n    padding: 1em;\n    font-family: initial;\n    font-size: larger;\n    color: #382034;\n}\n\ndevtools-sidepane devtools-properties devtools-infotitle:first-child {\n    padding-top: 0em;\n}\n\ndevtools-sidepane devtools-properties devtools-table {\n    width: 100%;\n    font-size: inherit;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-tbody{\n    vertical-align: top;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-td {\n    padding: 0.3em;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-td:nth-child(1) {\n    width: 100px;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-list {\n    list-style-position: inside;\n    padding-left: 0;\n    margin: 0;\n}\n\ndevtools-sidepane devtools-properties > devtools-table > devtools-tbody > devtools-tr:nth-child(even) {\n    background-color: #f4f4f4;\n}\n\ndevtools-info {\n    display: flex;\n    flex-direction: column;\n}\n\ndevtools-info devtools-about devtools-id {\n    float: right;\n    color: #76526c;\n    font-size: smaller;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/assets/Dialog.css":
/*!****************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/assets/Dialog.css ***!
  \****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-dialog-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\njw-dialog-container jw-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    opacity: 0.5;\n    background-color: #000000;\n}\njw-dialog-container jw-dialog {\n    position: absolute;\n    display: flex;\n    max-width: 80%;\n}\njw-dialog-container jw-dialog > jw-content {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    background-color: #F7F7F7;\n    padding: 10px;\n    border-radius: 10px;\n}\njw-dialog-container jw-dialog > jw-content > jw-button.close {\n    position: absolute;\n    right: 10px;\n    top: 4px;\n    cursor: pointer;\n}\njw-dialog-container jw-dialog table.form-table {\n    border: none;\n}\njw-dialog-container jw-dialog table.form-table td {\n    border: none;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dom-follow-range/assets/FollowRange.css":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-dom-follow-range/assets/FollowRange.css ***!
  \*******************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-follow-range {\n    position: absolute;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-fullscreen/assets/Fullscreen.css":
/*!************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-fullscreen/assets/Fullscreen.css ***!
  \************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".jw-fullscreen .jw-fullscreen {\n    display: block;\n    position: fixed;\n    transform: none;\n    overflow: hidden;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 100%;\n    min-height: 100%;\n    background: #ffffff;\n}\n.jw-fullscreen jw-follow-range {\n    z-index: 1;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-list/assets/checklist.css":
/*!*****************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-list/assets/checklist.css ***!
  \*****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "ul.checklist > li {\n    list-style: none;\n    position: relative;\n}\nul.checklist > li.unchecked:before, ul.checklist > li.checked:before {\n    content: '';\n    position: absolute;\n    left: -20px;\n    display: block;\n    height: 13px;\n    width: 13px;\n    border: 1px solid;\n    cursor: pointer;\n}\nul.checklist > li:after {\n    content: '';\n    position: absolute;\n    left: -17px;\n    top: -1px;\n    font-size: 13px;\n    opacity: 0;\n    cursor: pointer;\n}\nul.checklist > li.checked:after {\n    content: \"\";\n    transition: opacity .5s;\n    opacity: 1;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-table/assets/tableUI.css":
/*!****************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-table/assets/tableUI.css ***!
  \****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "table.table-picker {\n    position: absolute;\n    background-color: white;\n    border: 1px solid black;\n    -webkit-box-shadow: 2px 2px 5px 0px rgba(0,0,0,.4);\n    -moz-box-shadow: 2px 2px 5px 0px rgba(0,0,0,.4);\n    box-shadow: 2px 2px 5px 0px rgba(0,0,0,.4);\n}\ntable.table-picker tr {\n    height: 1em;\n    padding: 0;\n}\ntable.table-picker td {\n    width: 1em;\n    border: 1px solid black;\n    padding: 0;\n}\ntable.table-picker td.highlight {\n    background-color: #875A7B;\n}\n\nspan.table-handler.fa-plus-square {\n    position: absolute;\n    cursor: pointer;\n    background-color: white;\n    width: 1em;\n    color: #00FF00;\n}\nspan.table-handler.fa-minus-square {\n    position: absolute;\n    cursor: pointer;\n    background-color: white;\n    width: 1em;\n    color: #FF0000;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/runtime/api.js":
/*!*****************************************************!*\
  !*** ./node_modules/css-loader/dist/runtime/api.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
// eslint-disable-next-line func-names
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return "@media ".concat(item[2], " {").concat(content, "}");
      }

      return content;
    }).join('');
  }; // import a list of modules into the list
  // eslint-disable-next-line func-names


  list.i = function (modules, mediaQuery, dedupe) {
    if (typeof modules === 'string') {
      // eslint-disable-next-line no-param-reassign
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    if (dedupe) {
      for (var i = 0; i < this.length; i++) {
        // eslint-disable-next-line prefer-destructuring
        var id = this[i][0];

        if (id != null) {
          alreadyImportedModules[id] = true;
        }
      }
    }

    for (var _i = 0; _i < modules.length; _i++) {
      var item = [].concat(modules[_i]);

      if (dedupe && alreadyImportedModules[item[0]]) {
        // eslint-disable-next-line no-continue
        continue;
      }

      if (mediaQuery) {
        if (!item[2]) {
          item[2] = mediaQuery;
        } else {
          item[2] = "".concat(mediaQuery, " and ").concat(item[2]);
        }
      }

      list.push(item);
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring

  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return "/*# sourceURL=".concat(cssMapping.sourceRoot || '').concat(source, " */");
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = "sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);
  return "/*# ".concat(data, " */");
}

/***/ }),

/***/ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":
/*!****************************************************************************!*\
  !*** ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isOldIE = function isOldIE() {
  var memo;
  return function memorize() {
    if (typeof memo === 'undefined') {
      // Test for IE <= 9 as proposed by Browserhacks
      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805
      // Tests for existence of standard globals is to allow style-loader
      // to operate correctly into non-standard environments
      // @see https://github.com/webpack-contrib/style-loader/issues/177
      memo = Boolean(window && document && document.all && !window.atob);
    }

    return memo;
  };
}();

var getTarget = function getTarget() {
  var memo = {};
  return function memorize(target) {
    if (typeof memo[target] === 'undefined') {
      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself

      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {
        try {
          // This will throw an exception if access to iframe is blocked
          // due to cross-origin restrictions
          styleTarget = styleTarget.contentDocument.head;
        } catch (e) {
          // istanbul ignore next
          styleTarget = null;
        }
      }

      memo[target] = styleTarget;
    }

    return memo[target];
  };
}();

var stylesInDom = [];

function getIndexByIdentifier(identifier) {
  var result = -1;

  for (var i = 0; i < stylesInDom.length; i++) {
    if (stylesInDom[i].identifier === identifier) {
      result = i;
      break;
    }
  }

  return result;
}

function modulesToDom(list, options) {
  var idCountMap = {};
  var identifiers = [];

  for (var i = 0; i < list.length; i++) {
    var item = list[i];
    var id = options.base ? item[0] + options.base : item[0];
    var count = idCountMap[id] || 0;
    var identifier = "".concat(id, " ").concat(count);
    idCountMap[id] = count + 1;
    var index = getIndexByIdentifier(identifier);
    var obj = {
      css: item[1],
      media: item[2],
      sourceMap: item[3]
    };

    if (index !== -1) {
      stylesInDom[index].references++;
      stylesInDom[index].updater(obj);
    } else {
      stylesInDom.push({
        identifier: identifier,
        updater: addStyle(obj, options),
        references: 1
      });
    }

    identifiers.push(identifier);
  }

  return identifiers;
}

function insertStyleElement(options) {
  var style = document.createElement('style');
  var attributes = options.attributes || {};

  if (typeof attributes.nonce === 'undefined') {
    var nonce =  true ? __webpack_require__.nc : undefined;

    if (nonce) {
      attributes.nonce = nonce;
    }
  }

  Object.keys(attributes).forEach(function (key) {
    style.setAttribute(key, attributes[key]);
  });

  if (typeof options.insert === 'function') {
    options.insert(style);
  } else {
    var target = getTarget(options.insert || 'head');

    if (!target) {
      throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");
    }

    target.appendChild(style);
  }

  return style;
}

function removeStyleElement(style) {
  // istanbul ignore if
  if (style.parentNode === null) {
    return false;
  }

  style.parentNode.removeChild(style);
}
/* istanbul ignore next  */


var replaceText = function replaceText() {
  var textStore = [];
  return function replace(index, replacement) {
    textStore[index] = replacement;
    return textStore.filter(Boolean).join('\n');
  };
}();

function applyToSingletonTag(style, index, remove, obj) {
  var css = remove ? '' : obj.media ? "@media ".concat(obj.media, " {").concat(obj.css, "}") : obj.css; // For old IE

  /* istanbul ignore if  */

  if (style.styleSheet) {
    style.styleSheet.cssText = replaceText(index, css);
  } else {
    var cssNode = document.createTextNode(css);
    var childNodes = style.childNodes;

    if (childNodes[index]) {
      style.removeChild(childNodes[index]);
    }

    if (childNodes.length) {
      style.insertBefore(cssNode, childNodes[index]);
    } else {
      style.appendChild(cssNode);
    }
  }
}

function applyToTag(style, options, obj) {
  var css = obj.css;
  var media = obj.media;
  var sourceMap = obj.sourceMap;

  if (media) {
    style.setAttribute('media', media);
  } else {
    style.removeAttribute('media');
  }

  if (sourceMap && btoa) {
    css += "\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), " */");
  } // For old IE

  /* istanbul ignore if  */


  if (style.styleSheet) {
    style.styleSheet.cssText = css;
  } else {
    while (style.firstChild) {
      style.removeChild(style.firstChild);
    }

    style.appendChild(document.createTextNode(css));
  }
}

var singleton = null;
var singletonCounter = 0;

function addStyle(obj, options) {
  var style;
  var update;
  var remove;

  if (options.singleton) {
    var styleIndex = singletonCounter++;
    style = singleton || (singleton = insertStyleElement(options));
    update = applyToSingletonTag.bind(null, style, styleIndex, false);
    remove = applyToSingletonTag.bind(null, style, styleIndex, true);
  } else {
    style = insertStyleElement(options);
    update = applyToTag.bind(null, style, options);

    remove = function remove() {
      removeStyleElement(style);
    };
  }

  update(obj);
  return function updateStyle(newObj) {
    if (newObj) {
      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {
        return;
      }

      update(obj = newObj);
    } else {
      remove();
    }
  };
}

module.exports = function (list, options) {
  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
  // tags it will allow on a page

  if (!options.singleton && typeof options.singleton !== 'boolean') {
    options.singleton = isOldIE();
  }

  list = list || [];
  var lastIdentifiers = modulesToDom(list, options);
  return function update(newList) {
    newList = newList || [];

    if (Object.prototype.toString.call(newList) !== '[object Array]') {
      return;
    }

    for (var i = 0; i < lastIdentifiers.length; i++) {
      var identifier = lastIdentifiers[i];
      var index = getIndexByIdentifier(identifier);
      stylesInDom[index].references--;
    }

    var newLastIdentifiers = modulesToDom(newList, options);

    for (var _i = 0; _i < lastIdentifiers.length; _i++) {
      var _identifier = lastIdentifiers[_i];

      var _index = getIndexByIdentifier(_identifier);

      if (stylesInDom[_index].references === 0) {
        stylesInDom[_index].updater();

        stylesInDom.splice(_index, 1);
      }
    }

    lastIdentifiers = newLastIdentifiers;
  };
};

/***/ }),

/***/ "./packages/bundle-basic-editor/BasicEditor.ts":
/*!*****************************************************!*\
  !*** ./packages/bundle-basic-editor/BasicEditor.ts ***!
  \*****************************************************/
/*! exports provided: BasicEditor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicEditor", function() { return BasicEditor; });
/* harmony import */ var _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../packages/core/src/JWEditor */ "./packages/core/src/JWEditor.ts");
/* harmony import */ var _packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../packages/plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../plugin-renderer-dom-object/src/DomObjectRenderer */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts");
/* harmony import */ var _plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../packages/plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../packages/plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../packages/plugin-heading/src/Heading */ "./packages/plugin-heading/src/Heading.ts");
/* harmony import */ var _packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../packages/plugin-paragraph/src/Paragraph */ "./packages/plugin-paragraph/src/Paragraph.ts");
/* harmony import */ var _packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../packages/plugin-list/src/List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../packages/plugin-indent/src/Indent */ "./packages/plugin-indent/src/Indent.ts");
/* harmony import */ var _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../packages/plugin-paragraph/src/ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../packages/plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../packages/plugin-span/src/Span */ "./packages/plugin-span/src/Span.ts");
/* harmony import */ var _packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../packages/plugin-bold/src/Bold */ "./packages/plugin-bold/src/Bold.ts");
/* harmony import */ var _packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../packages/plugin-italic/src/Italic */ "./packages/plugin-italic/src/Italic.ts");
/* harmony import */ var _packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../packages/plugin-underline/src/Underline */ "./packages/plugin-underline/src/Underline.ts");
/* harmony import */ var _packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../packages/plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../packages/plugin-link/src/Link */ "./packages/plugin-link/src/Link.ts");
/* harmony import */ var _packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../packages/plugin-divider/src/Divider */ "./packages/plugin-divider/src/Divider.ts");
/* harmony import */ var _packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../packages/plugin-image/src/Image */ "./packages/plugin-image/src/Image.ts");
/* harmony import */ var _packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../packages/plugin-subscript/src/Subscript */ "./packages/plugin-subscript/src/Subscript.ts");
/* harmony import */ var _packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../packages/plugin-superscript/src/Superscript */ "./packages/plugin-superscript/src/Superscript.ts");
/* harmony import */ var _packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../packages/plugin-blockquote/src/Blockquote */ "./packages/plugin-blockquote/src/Blockquote.ts");
/* harmony import */ var _packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../packages/plugin-youtube/src/Youtube */ "./packages/plugin-youtube/src/Youtube.ts");
/* harmony import */ var _packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../packages/plugin-table/src/Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../packages/plugin-metadata/src/Metadata */ "./packages/plugin-metadata/src/Metadata.ts");
/* harmony import */ var _packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../packages/plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../packages/plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../packages/plugin-align/src/Align */ "./packages/plugin-align/src/Align.ts");
/* harmony import */ var _packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../packages/plugin-pre/src/Pre */ "./packages/plugin-pre/src/Pre.ts");
/* harmony import */ var _packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../../packages/plugin-textcolor/src/TextColor */ "./packages/plugin-textcolor/src/TextColor.ts");
/* harmony import */ var _packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../packages/plugin-backgroundcolor/src/BackgroundColor */ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts");
/* harmony import */ var _packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../../packages/plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../../packages/plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../../packages/plugin-dom-editable/src/DomEditable */ "./packages/plugin-dom-editable/src/DomEditable.ts");
/* harmony import */ var _packages_plugin_history_src_History__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../../packages/plugin-history/src/History */ "./packages/plugin-history/src/History.ts");
/* harmony import */ var _packages_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../../packages/plugin-input/src/Input */ "./packages/plugin-input/src/Input.ts");
/* harmony import */ var _packages_plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../../packages/plugin-dialog/src/Dialog */ "./packages/plugin-dialog/src/Dialog.ts");
/* harmony import */ var _packages_plugin_dom_follow_range_src_FollowRange__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../../packages/plugin-dom-follow-range/src/FollowRange */ "./packages/plugin-dom-follow-range/src/FollowRange.ts");
/* harmony import */ var _packages_plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../../packages/plugin-toolbar/src/Toolbar */ "./packages/plugin-toolbar/src/Toolbar.ts");
/* harmony import */ var _plugin_textarea_src_Textarea__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../plugin-textarea/src/Textarea */ "./packages/plugin-textarea/src/Textarea.ts");
/* harmony import */ var _basicLayout_xml__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./basicLayout.xml */ "./packages/bundle-basic-editor/basicLayout.xml");
/* harmony import */ var _basicLayout_xml__WEBPACK_IMPORTED_MODULE_41___default = /*#__PURE__*/__webpack_require__.n(_basicLayout_xml__WEBPACK_IMPORTED_MODULE_41__);
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./basicLayout.css */ "./packages/bundle-basic-editor/basicLayout.css");
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_42___default = /*#__PURE__*/__webpack_require__.n(_basicLayout_css__WEBPACK_IMPORTED_MODULE_42__);
/* harmony import */ var _packages_plugin_odoo_field_src_OdooField__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../../packages/plugin-odoo-field/src/OdooField */ "./packages/plugin-odoo-field/src/OdooField.ts");
/* harmony import */ var _packages_utils_src_configuration__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ../../packages/utils/src/configuration */ "./packages/utils/src/configuration.ts");
/* harmony import */ var _packages_plugin_fullscreen_src_Fullscreen__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../../packages/plugin-fullscreen/src/Fullscreen */ "./packages/plugin-fullscreen/src/Fullscreen.ts");
/* harmony import */ var _plugin_code_src_Code__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../plugin-code/src/Code */ "./packages/plugin-code/src/Code.ts");
/* harmony import */ var _plugin_font_size_src_FontSize__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../plugin-font-size/src/FontSize */ "./packages/plugin-font-size/src/FontSize.ts");
/* harmony import */ var _plugin_button_src_Button__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../plugin-button/src/Button */ "./packages/plugin-button/src/Button.ts");

















































class BasicEditor extends _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__["default"] {
    constructor(params) {
        super();
        this.configure({
            defaults: {
                Container: _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_10__["ParagraphNode"],
                Separator: _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_11__["LineBreakNode"],
            },
            plugins: [
                [_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]],
                [_packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_26__["Renderer"]],
                [_packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_32__["Layout"]],
                [_packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_27__["Keymap"]],
                [_plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderer"]],
                [_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_3__["Html"]],
                [_packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_33__["DomLayout"]],
                [_packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_34__["DomEditable"]],
                [_packages_plugin_history_src_History__WEBPACK_IMPORTED_MODULE_35__["History"]],
                [_packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_16__["Inline"]],
                [_packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_4__["Char"]],
                [_packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_5__["LineBreak"]],
                [_packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_6__["Heading"]],
                [_packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_7__["Paragraph"]],
                [_plugin_textarea_src_Textarea__WEBPACK_IMPORTED_MODULE_40__["Textarea"]],
                [_packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_8__["List"]],
                [_packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_9__["Indent"]],
                [_plugin_font_size_src_FontSize__WEBPACK_IMPORTED_MODULE_47__["FontSize"]],
                [_packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_12__["Span"]],
                [_packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_13__["Bold"]],
                [_packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_14__["Italic"]],
                [_packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_15__["Underline"]],
                [_packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_17__["Link"]],
                [_packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_18__["Divider"]],
                [_packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_19__["Image"]],
                [_packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_20__["Subscript"]],
                [_packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_21__["Superscript"]],
                [_packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_22__["Blockquote"]],
                [_packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_23__["Youtube"]],
                [_packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_24__["Table"]],
                [_packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_25__["Metadata"]],
                [_packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_28__["Align"]],
                [_packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_29__["Pre"]],
                [_packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_30__["TextColor"]],
                [_packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_31__["BackgroundColor"]],
                [_packages_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_36__["Input"]],
                [_packages_plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_37__["Dialog"]],
                [_packages_plugin_dom_follow_range_src_FollowRange__WEBPACK_IMPORTED_MODULE_38__["FollowRange"]],
                [_packages_plugin_fullscreen_src_Fullscreen__WEBPACK_IMPORTED_MODULE_45__["Fullscreen"], { component: 'editor' }],
                [_packages_plugin_odoo_field_src_OdooField__WEBPACK_IMPORTED_MODULE_43__["OdooField"]],
                [_plugin_code_src_Code__WEBPACK_IMPORTED_MODULE_46__["Code"]],
                [_plugin_button_src_Button__WEBPACK_IMPORTED_MODULE_48__["Button"]],
            ],
        });
        const config = {
            loadables: {
                components: [
                    {
                        id: 'editor',
                        render(editor) {
                            return editor.plugins.get(_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]).parse('text/html', _basicLayout_xml__WEBPACK_IMPORTED_MODULE_41___default.a);
                        },
                    },
                ],
                componentZones: [['editor', ['root']]],
            },
        };
        this.configure(config);
        this.configure(_packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_33__["DomLayout"], {
            location: (params === null || params === void 0 ? void 0 : params.editable) ? [params.editable, 'replace'] : null,
            components: [
                {
                    id: 'editable',
                    render: async (editor) => {
                        if (params === null || params === void 0 ? void 0 : params.editable) {
                            return Object(_packages_utils_src_configuration__WEBPACK_IMPORTED_MODULE_44__["parseEditable"])(editor, params.editable);
                        }
                        else {
                            return Object(_packages_utils_src_configuration__WEBPACK_IMPORTED_MODULE_44__["createEditable"])(editor);
                        }
                    },
                },
            ],
            componentZones: [['editable', ['main']]],
        });
        this.configure(_packages_plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_39__["Toolbar"], {
            layout: [
                [
                    [
                        'ParagraphButton',
                        'Heading1Button',
                        'Heading2Button',
                        'Heading3Button',
                        'Heading4Button',
                        'Heading5Button',
                        'Heading6Button',
                        'PreButton',
                    ],
                ],
                ['FontSizeInput'],
                ['BoldButton', 'ItalicButton', 'UnderlineButton', 'RemoveFormatButton'],
                ['AlignLeftButton', 'AlignCenterButton', 'AlignRightButton', 'AlignJustifyButton'],
                ['OrderedListButton', 'UnorderedListButton', 'ChecklistButton'],
                ['IndentButton', 'OutdentButton'],
                ['LinkButton', 'UnlinkButton'],
                ['TableButton'],
                ['CodeButton'],
                ['UndoButton', 'RedoButton'],
            ],
        });
    }
}


/***/ }),

/***/ "./packages/bundle-basic-editor/basicLayout.css":
/*!******************************************************!*\
  !*** ./packages/bundle-basic-editor/basicLayout.css ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../node_modules/css-loader/dist/cjs.js!./basicLayout.css */ "./node_modules/css-loader/dist/cjs.js!./packages/bundle-basic-editor/basicLayout.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/bundle-basic-editor/basicLayout.xml":
/*!******************************************************!*\
  !*** ./packages/bundle-basic-editor/basicLayout.xml ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<jw-editor>\n    <jw-header><t t-zone=\"tools\"/></jw-header>\n    <jw-body><t t-zone=\"main\"/></jw-body>\n    <jw-footer>\n        <t t-zone=\"status\"/>\n        <t t-zone=\"resizer\"/>\n    </jw-footer>\n    <t-dialog>\n        <t t-zone=\"dialog\"/>\n        <t t-zone=\"default\"/>\n    </t-dialog>\n    <t t-zone=\"debug\"/>\n</jw-editor>\n"

/***/ }),

/***/ "./packages/bundle-odoo-website-editor/OdooWebsiteEditor.ts":
/*!******************************************************************!*\
  !*** ./packages/bundle-odoo-website-editor/OdooWebsiteEditor.ts ***!
  \******************************************************************/
/*! exports provided: OdooWebsiteEditor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooWebsiteEditor", function() { return OdooWebsiteEditor; });
/* harmony import */ var _core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/src/JWEditor */ "./packages/core/src/JWEditor.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../plugin-heading/src/Heading */ "./packages/plugin-heading/src/Heading.ts");
/* harmony import */ var _plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../plugin-paragraph/src/Paragraph */ "./packages/plugin-paragraph/src/Paragraph.ts");
/* harmony import */ var _plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../plugin-list/src/List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../plugin-indent/src/Indent */ "./packages/plugin-indent/src/Indent.ts");
/* harmony import */ var _plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../plugin-paragraph/src/ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../plugin-span/src/Span */ "./packages/plugin-span/src/Span.ts");
/* harmony import */ var _plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../plugin-bold/src/Bold */ "./packages/plugin-bold/src/Bold.ts");
/* harmony import */ var _plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../plugin-italic/src/Italic */ "./packages/plugin-italic/src/Italic.ts");
/* harmony import */ var _plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../plugin-underline/src/Underline */ "./packages/plugin-underline/src/Underline.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../plugin-link/src/Link */ "./packages/plugin-link/src/Link.ts");
/* harmony import */ var _plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../plugin-divider/src/Divider */ "./packages/plugin-divider/src/Divider.ts");
/* harmony import */ var _plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../plugin-image/src/Image */ "./packages/plugin-image/src/Image.ts");
/* harmony import */ var _plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../plugin-subscript/src/Subscript */ "./packages/plugin-subscript/src/Subscript.ts");
/* harmony import */ var _plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../plugin-superscript/src/Superscript */ "./packages/plugin-superscript/src/Superscript.ts");
/* harmony import */ var _plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../plugin-blockquote/src/Blockquote */ "./packages/plugin-blockquote/src/Blockquote.ts");
/* harmony import */ var _plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../plugin-youtube/src/Youtube */ "./packages/plugin-youtube/src/Youtube.ts");
/* harmony import */ var _plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../plugin-table/src/Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../plugin-metadata/src/Metadata */ "./packages/plugin-metadata/src/Metadata.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../plugin-align/src/Align */ "./packages/plugin-align/src/Align.ts");
/* harmony import */ var _plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../plugin-pre/src/Pre */ "./packages/plugin-pre/src/Pre.ts");
/* harmony import */ var _plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../plugin-textcolor/src/TextColor */ "./packages/plugin-textcolor/src/TextColor.ts");
/* harmony import */ var _plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../plugin-backgroundcolor/src/BackgroundColor */ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../plugin-dom-editable/src/DomEditable */ "./packages/plugin-dom-editable/src/DomEditable.ts");
/* harmony import */ var _plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../plugin-toolbar/src/Toolbar */ "./packages/plugin-toolbar/src/Toolbar.ts");
/* harmony import */ var _plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../plugin-html/src/HtmlNode */ "./packages/plugin-html/src/HtmlNode.ts");
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_odoo_video_src_OdooVideo__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../plugin-odoo-video/src/OdooVideo */ "./packages/plugin-odoo-video/src/OdooVideo.ts");
/* harmony import */ var _plugin_dom_helpers_src_DomHelpers__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../plugin-dom-helpers/src/DomHelpers */ "./packages/plugin-dom-helpers/src/DomHelpers.ts");
/* harmony import */ var _plugin_odoo_src_Odoo__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../plugin-odoo/src/Odoo */ "./packages/plugin-odoo/src/Odoo.ts");
/* harmony import */ var _utils_src_configuration__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../utils/src/configuration */ "./packages/utils/src/configuration.ts");
/* harmony import */ var _plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ../plugin-dialog/src/Dialog */ "./packages/plugin-dialog/src/Dialog.ts");
/* harmony import */ var _plugin_shadow_src_Shadow__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ../plugin-shadow/src/Shadow */ "./packages/plugin-shadow/src/Shadow.ts");
/* harmony import */ var _plugin_fontawesome_src_FontAwesome__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../plugin-fontawesome/src/FontAwesome */ "./packages/plugin-fontawesome/src/FontAwesome.ts");
/* harmony import */ var _odooLayout_css__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./odooLayout.css */ "./packages/bundle-odoo-website-editor/odooLayout.css");
/* harmony import */ var _odooLayout_css__WEBPACK_IMPORTED_MODULE_44___default = /*#__PURE__*/__webpack_require__.n(_odooLayout_css__WEBPACK_IMPORTED_MODULE_44__);
/* harmony import */ var _plugin_textarea_src_Textarea__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../plugin-textarea/src/Textarea */ "./packages/plugin-textarea/src/Textarea.ts");
/* harmony import */ var _plugin_dom_follow_range_src_FollowRange__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../plugin-dom-follow-range/src/FollowRange */ "./packages/plugin-dom-follow-range/src/FollowRange.ts");
/* harmony import */ var _plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../plugin-input/src/Input */ "./packages/plugin-input/src/Input.ts");
/* harmony import */ var _plugin_font_size_src_FontSize__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../plugin-font-size/src/FontSize */ "./packages/plugin-font-size/src/FontSize.ts");
/* harmony import */ var _plugin_history_src_History__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ../plugin-history/src/History */ "./packages/plugin-history/src/History.ts");
/* harmony import */ var _plugin_iframe_src_Iframe__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ../plugin-iframe/src/Iframe */ "./packages/plugin-iframe/src/Iframe.ts");
/* harmony import */ var _plugin_theme_src_ThemeNode__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ../plugin-theme/src/ThemeNode */ "./packages/plugin-theme/src/ThemeNode.ts");
/* harmony import */ var _plugin_device_preview_src_DevicePreview__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ../plugin-device-preview/src/DevicePreview */ "./packages/plugin-device-preview/src/DevicePreview.ts");
/* harmony import */ var _plugin_button_src_Button__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ../plugin-button/src/Button */ "./packages/plugin-button/src/Button.ts");






















































const defaultToolbarLayout = [
    [
        [
            'ParagraphButton',
            'Heading1Button',
            'Heading2Button',
            'Heading3Button',
            'Heading4Button',
            'Heading5Button',
            'Heading6Button',
            'PreButton',
        ],
    ],
    ['FontSizeInput'],
    [
        'BoldButton',
        'ItalicButton',
        'UnderlineButton',
        'OdooTextColorButton',
        'OdooBackgroundColorButton',
        'RemoveFormatButton',
    ],
    ['AlignLeftButton', 'AlignCenterButton', 'AlignRightButton', 'AlignJustifyButton'],
    ['OrderedListButton', 'UnorderedListButton', 'ChecklistButton'],
    ['IndentButton', 'OutdentButton'],
    ['OdooLinkButton'],
    ['OdooMediaButton'],
];
class OdooWebsiteEditor extends _core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__["default"] {
    constructor(options) {
        super();
        class CustomPlugin extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_36__["JWPlugin"] {
            constructor() {
                super(...arguments);
                this.commands = Object.assign(options.customCommands);
            }
        }
        this.configure({
            defaults: {
                Container: _plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__["ParagraphNode"],
                Separator: _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"],
            },
            plugins: [
                [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]],
                [_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__["Renderer"]],
                [_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]],
                [_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__["Keymap"]],
                [_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__["Html"]],
                [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__["Inline"]],
                [_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__["Char"]],
                [_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__["LineBreak"]],
                [_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__["Heading"]],
                [_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__["Paragraph"]],
                [_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__["List"]],
                [_plugin_textarea_src_Textarea__WEBPACK_IMPORTED_MODULE_45__["Textarea"]],
                [_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__["Indent"]],
                [_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__["Span"]],
                [_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__["Bold"]],
                [_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__["Italic"]],
                [_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__["Underline"]],
                [_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_47__["Input"]],
                [_plugin_font_size_src_FontSize__WEBPACK_IMPORTED_MODULE_48__["FontSize"]],
                [_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__["Link"]],
                [_plugin_fontawesome_src_FontAwesome__WEBPACK_IMPORTED_MODULE_43__["FontAwesome"]],
                [_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__["Divider"]],
                [_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__["Image"]],
                [_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__["Subscript"]],
                [_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__["Superscript"]],
                [_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__["Blockquote"]],
                [_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__["Youtube"]],
                [_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__["Table"]],
                [_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__["Metadata"]],
                [_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__["Align"]],
                [_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__["Pre"]],
                [_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__["TextColor"]],
                [_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__["BackgroundColor"]],
                [_plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_41__["Dialog"]],
                [_plugin_shadow_src_Shadow__WEBPACK_IMPORTED_MODULE_42__["Shadow"]],
                [_plugin_dom_helpers_src_DomHelpers__WEBPACK_IMPORTED_MODULE_38__["DomHelpers"]],
                [_plugin_odoo_src_Odoo__WEBPACK_IMPORTED_MODULE_39__["Odoo"]],
                [_plugin_odoo_video_src_OdooVideo__WEBPACK_IMPORTED_MODULE_37__["OdooVideo"]],
                [CustomPlugin],
                [_plugin_dom_follow_range_src_FollowRange__WEBPACK_IMPORTED_MODULE_46__["FollowRange"]],
                [_plugin_history_src_History__WEBPACK_IMPORTED_MODULE_49__["History"]],
                [_plugin_iframe_src_Iframe__WEBPACK_IMPORTED_MODULE_50__["Iframe"]],
                [_plugin_button_src_Button__WEBPACK_IMPORTED_MODULE_53__["Button"]],
                ...(options.plugins || []),
            ],
        });
        this.configure(_plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_34__["Toolbar"], {
            layout: [...(options.toolbarLayout || defaultToolbarLayout)],
        });
        const defaultTemplate = `
        <t-dialog><t t-zone="default"/></t-dialog>
        <div class="wrap_editor d-flex flex-column">
            <div class="d-flex flex-grow-1 flex-row overflow-auto">
                <t t-zone="main_sidebar"/>
                <div class="d-flex flex-column o_editor_center">
                    <div class="o_toolbar">
                        <t t-zone="tools"/>
                    </div>
                    <div class="d-flex flex-grow-1 overflow-auto">
                        <t t-zone="snippetManipulators"/>
                        <t t-zone="main"/>
                    </div>
                </div>
            </div>
            <div class="o_debug_zone">
                <t t-zone="debug"/>
            </div>
        </div>
    `;
        this.configure(_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__["DomLayout"], {
            components: [
                {
                    id: 'main_template',
                    render(editor) {
                        return editor.plugins
                            .get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"])
                            .parse('text/html', options.template || defaultTemplate);
                    },
                },
                {
                    id: 'snippet_menu',
                    render() {
                        const node = options.snippetMenuElement
                            ? new _plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_35__["HtmlNode"]({ domNode: () => options.snippetMenuElement })
                            : new _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"]();
                        return Promise.resolve([node]);
                    },
                },
                {
                    id: 'snippetManipulators',
                    render() {
                        const node = options.snippetMenuElement
                            ? new _plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_35__["HtmlNode"]({ domNode: () => options.snippetManipulators })
                            : new _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"]();
                        return Promise.resolve([node]);
                    },
                },
                {
                    id: 'editable',
                    render: async (editor) => {
                        const theme = new _plugin_theme_src_ThemeNode__WEBPACK_IMPORTED_MODULE_51__["ThemeNode"]();
                        const contents = await Object(_utils_src_configuration__WEBPACK_IMPORTED_MODULE_40__["parseEditable"])(editor, options.source, true);
                        theme.append(...contents);
                        return [theme];
                    },
                },
            ],
            componentZones: [
                ['main_template', ['root']],
                ['snippet_menu', ['main_sidebar']],
                ['snippetManipulators', ['snippetManipulators']],
                ['editable', ['main']],
            ],
            location: options.location,
            pressedActionablesClassName: 'active',
        });
        this.configure(_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__["DomEditable"], {
            autoFocus: true,
            source: options.source.firstElementChild,
        });
        this.configure(_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__["Table"], {
            inlineUI: true,
        });
        this.configure(_plugin_device_preview_src_DevicePreview__WEBPACK_IMPORTED_MODULE_52__["DevicePreview"], {
            getTheme(editor) {
                const layout = editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]);
                const domLayout = layout.engines.dom;
                return domLayout.components.editable[0];
            },
        });
        if (options.mode) {
            this.configure({
                modes: [options.mode],
            });
            this.configure({ mode: options.mode.id });
        }
    }
    /**
     * Get the value by rendering the "editable" component of the editor.
     */
    async getValue() {
        const renderer = this.plugins.get(_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__["Renderer"]);
        const layout = this.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]);
        const domLayout = layout.engines.dom;
        const editable = domLayout.components.editable[0];
        const nodes = await renderer.render('dom/html', editable);
        return nodes && nodes[0];
    }
}


/***/ }),

/***/ "./packages/bundle-odoo-website-editor/odoo-integration.ts":
/*!*****************************************************************!*\
  !*** ./packages/bundle-odoo-website-editor/odoo-integration.ts ***!
  \*****************************************************************/
/*! exports provided: OdooWebsiteEditor, BasicEditor, DevTools, Layout, DomLayoutEngine, Renderer, ImageNode, VRange, InlineNode, LinkFormat, Attributes, ContainerNode, VElement, DividerNode, OdooStructureNode, OdooField, OdooFieldNode, OdooTranslationFormat, Inline, DomHelpers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _bundle_basic_editor_BasicEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../bundle-basic-editor/BasicEditor */ "./packages/bundle-basic-editor/BasicEditor.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BasicEditor", function() { return _bundle_basic_editor_BasicEditor__WEBPACK_IMPORTED_MODULE_0__["BasicEditor"]; });

/* harmony import */ var _plugin_devtools_src_DevTools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plugin-devtools/src/DevTools */ "./packages/plugin-devtools/src/DevTools.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DevTools", function() { return _plugin_devtools_src_DevTools__WEBPACK_IMPORTED_MODULE_1__["DevTools"]; });

/* harmony import */ var _OdooWebsiteEditor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooWebsiteEditor */ "./packages/bundle-odoo-website-editor/OdooWebsiteEditor.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooWebsiteEditor", function() { return _OdooWebsiteEditor__WEBPACK_IMPORTED_MODULE_2__["OdooWebsiteEditor"]; });

/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "VRange", function() { return _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__["VRange"]; });

/* harmony import */ var _plugin_dom_layout_src_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../plugin-dom-layout/src/DomLayoutEngine */ "./packages/plugin-dom-layout/src/DomLayoutEngine.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DomLayoutEngine", function() { return _plugin_dom_layout_src_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__["DomLayoutEngine"]; });

/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__["Layout"]; });

/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Renderer", function() { return _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_6__["Renderer"]; });

/* harmony import */ var _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../plugin-image/src/ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageNode", function() { return _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_7__["ImageNode"]; });

/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InlineNode", function() { return _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_8__["InlineNode"]; });

/* harmony import */ var _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../plugin-link/src/LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LinkFormat", function() { return _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_9__["LinkFormat"]; });

/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Attributes", function() { return _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]; });

/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ContainerNode", function() { return _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_11__["ContainerNode"]; });

/* harmony import */ var _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../plugin-divider/src/DividerNode */ "./packages/plugin-divider/src/DividerNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DividerNode", function() { return _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__["DividerNode"]; });

/* harmony import */ var _plugin_odoo_src_OdooStructureNode__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../plugin-odoo/src/OdooStructureNode */ "./packages/plugin-odoo/src/OdooStructureNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooStructureNode", function() { return _plugin_odoo_src_OdooStructureNode__WEBPACK_IMPORTED_MODULE_13__["OdooStructureNode"]; });

/* harmony import */ var _plugin_odoo_src_OdooTranslationFormat__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../plugin-odoo/src/OdooTranslationFormat */ "./packages/plugin-odoo/src/OdooTranslationFormat.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooTranslationFormat", function() { return _plugin_odoo_src_OdooTranslationFormat__WEBPACK_IMPORTED_MODULE_14__["OdooTranslationFormat"]; });

/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Inline", function() { return _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__["Inline"]; });

/* harmony import */ var _plugin_dom_helpers_src_DomHelpers__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../plugin-dom-helpers/src/DomHelpers */ "./packages/plugin-dom-helpers/src/DomHelpers.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DomHelpers", function() { return _plugin_dom_helpers_src_DomHelpers__WEBPACK_IMPORTED_MODULE_16__["DomHelpers"]; });

/* harmony import */ var _plugin_odoo_field_src_OdooField__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../plugin-odoo-field/src/OdooField */ "./packages/plugin-odoo-field/src/OdooField.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooField", function() { return _plugin_odoo_field_src_OdooField__WEBPACK_IMPORTED_MODULE_17__["OdooField"]; });

/* harmony import */ var _plugin_odoo_field_src_OdooFieldNode__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../plugin-odoo-field/src/OdooFieldNode */ "./packages/plugin-odoo-field/src/OdooFieldNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooFieldNode", function() { return _plugin_odoo_field_src_OdooFieldNode__WEBPACK_IMPORTED_MODULE_18__["OdooFieldNode"]; });

/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "VElement", function() { return _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_19__["VElement"]; });
























/***/ }),

/***/ "./packages/bundle-odoo-website-editor/odooLayout.css":
/*!************************************************************!*\
  !*** ./packages/bundle-odoo-website-editor/odooLayout.css ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../node_modules/css-loader/dist/cjs.js!./odooLayout.css */ "./node_modules/css-loader/dist/cjs.js!./packages/bundle-odoo-website-editor/odooLayout.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/core/src/ContextManager.ts":
/*!*********************************************!*\
  !*** ./packages/core/src/ContextManager.ts ***!
  \*********************************************/
/*! exports provided: ContextManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextManager", function() { return ContextManager; });
/**
 * Class that rank a hierarchy of vnode through a "specificity" algorithm.
 *
 * Specificity level is defined with:
 * - `lvl2`: if the last predicate of an item selector is deeper in the tree
 *   than the last predicate of another item selector; the first item have
 *   more specificity
 * - `lvl1`: if two or more items have the same `lvl2` specificity; the
 *   command with the longest selector will have more specificity
 * - `lvl0`: if the item has no selector (an empty list), there is no
 *   specificity
 * ```
 */
class ContextManager {
    constructor(editor, execCommand) {
        this.editor = editor;
        this.defaultContext = {
            range: this.editor.selection.range,
            execCommand: execCommand,
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Test all contextuals against a hierarchy of VNodes and return the result
     * ordered by specificity.
     */
    static getRankedMatches(hierarchy, contextuals) {
        const matches = [];
        for (let index = 0; index < contextuals.length; index++) {
            const contextual = contextuals[index];
            const match = ContextManager._matchNodes(hierarchy, contextual.selector);
            if (match) {
                matches.push({
                    lvl1Score: match[1].length,
                    lvl2Score: match[0],
                    matched: match[1],
                    index: index,
                    entry: contextual,
                });
            }
        }
        // Sort the matches:
        // - from highest to lowest score
        // - when the score is the same, from highest to lowest index
        const rankedMatch = matches.sort(function (a, b) {
            if (b.lvl2Score === a.lvl2Score && b.lvl1Score === a.lvl1Score) {
                return b.index - a.index;
            }
            else if (b.lvl2Score === a.lvl2Score) {
                return b.lvl1Score - a.lvl1Score;
            }
            else {
                return b.lvl2Score - a.lvl2Score;
            }
        });
        return rankedMatch;
    }
    /**
     * Match items selector depending on the editor current context range and
     * return the most specific item.
     *
     * @param items
     * @param paramsContext
     */
    match(items, paramsContext) {
        const context = Object.assign(Object.assign({}, this.defaultContext), paramsContext);
        const start = context.range.start;
        const hierarchy = start.ancestors();
        const node = start.previousSibling() || start.nextSibling();
        if (node) {
            hierarchy.unshift(node);
        }
        const entries = items.map(item => {
            const entry = {
                selector: item.selector || [],
                value: item,
            };
            return entry;
        });
        const matches = ContextManager.getRankedMatches(hierarchy, entries);
        const match = matches.find(match => {
            return (!match.entry.value.check ||
                match.entry.value.check(Object.assign(Object.assign({}, context), { selector: match.matched })));
        });
        return [match === null || match === void 0 ? void 0 : match.entry.value, context];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Check whether a hierarchy of `VNode` match with `selector`.
     *
     * The `hierarchy` is an array from the deepest node in a tree to the
     * shallowest.
     *
     * Return a tuple with the first value being level of specificity lvl2 and
     * the second value being the VNnode that matched with a selector
     * (specificity lvl1).
     */
    static _matchNodes(hierarchy, selector) {
        const matches = [];
        const maximumDepth = hierarchy.length - 1;
        let firstMatchDepth = -1;
        let index = 0;
        for (const predicate of [...selector].reverse()) {
            let matchFound = false;
            while (!matchFound && index < hierarchy.length) {
                if (hierarchy[index].test(predicate)) {
                    matchFound = true;
                    matches.unshift(hierarchy[index]);
                    if (firstMatchDepth === -1) {
                        // Deeper match has higher specificity. So lower
                        // index in ancestors, means higher specificity.
                        firstMatchDepth = maximumDepth - index;
                    }
                }
                index++;
            }
            // Stop checking the predicates of this particular command
            // since at least one of them don't match the context.
            if (!matchFound)
                break;
        }
        return matches.length === selector.length && [firstMatchDepth, matches];
    }
}


/***/ }),

/***/ "./packages/core/src/Core.ts":
/*!***********************************!*\
  !*** ./packages/core/src/Core.ts ***!
  \***********************************/
/*! exports provided: Core */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Core", function() { return Core; });
/* harmony import */ var _JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _Mode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Mode */ "./packages/core/src/Mode.ts");
/* harmony import */ var _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");




class Core extends _JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            insert: {
                handler: this.insert,
            },
            insertParagraphBreak: {
                handler: this.insertParagraphBreak,
            },
            setSelection: {
                handler: this.setSelection,
            },
            deleteBackward: {
                handler: this.deleteBackward,
            },
            deleteForward: {
                handler: this.deleteForward,
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert a paragraph break.
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        // Remove the contents of the range if needed.
        if (!range.isCollapsed()) {
            range.empty();
        }
        if (range.mode.is(range.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE)) {
            range.startContainer.splitAt(range.start);
        }
        else {
            // Use a separator to break paragraphs in an unbreakable.
            const Separator = this.editor.configuration.defaults.Separator;
            range.start.before(new Separator());
        }
    }
    /**
     * Insert a VNode at the current position of the selection.
     *
     * @param params
     */
    insert(params) {
        // Remove the contents of the range if needed.
        if (!params.context.range.isCollapsed()) {
            params.context.range.empty();
        }
        params.context.range.start.before(params.node);
    }
    /**
     * Delete in the backward direction (backspace key expected behavior).
     */
    deleteBackward(params) {
        const range = params.context.range;
        if (range.isCollapsed()) {
            // Basic case: remove the node directly preceding the range.
            const previousSibling = range.start.previousSibling();
            if (previousSibling && range.mode.is(previousSibling, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                previousSibling.removeBackward();
            }
            else if (range.mode.is(range.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                range.mode.is(range.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                // Otherwise set range start at previous valid leaf.
                let ancestor = range.start.parent;
                while (ancestor &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE) &&
                    !ancestor.previousSibling()) {
                    ancestor = ancestor.parent;
                }
                if (ancestor &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                    const previousSibling = ancestor.previousSibling();
                    if (previousSibling instanceof _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__["AtomicNode"]) {
                        ancestor.mergeWith(previousSibling.parent);
                    }
                    else {
                        const previousLeaf = previousSibling.lastLeaf();
                        if (previousSibling && !previousSibling.hasChildren()) {
                            // If the previous sibling is empty, remove it.
                            previousSibling.removeBackward();
                        }
                        else if (previousLeaf) {
                            range.setStart(previousLeaf, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER);
                            range.empty();
                        }
                    }
                }
            }
        }
        else {
            range.empty();
        }
    }
    /**
     * Delete in the forward direction (delete key expected behavior).
     */
    deleteForward(params) {
        const range = params.context.range;
        if (range.isCollapsed()) {
            // Basic case: remove the node directly following the range.
            const nextSibling = range.end.nextSibling();
            if (nextSibling && range.mode.is(nextSibling, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                nextSibling.removeForward();
            }
            else if (range.mode.is(range.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                range.mode.is(range.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                // Otherwise set range end at next valid leaf.
                let ancestor = range.end.parent;
                while (ancestor &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE) &&
                    !ancestor.nextSibling()) {
                    ancestor = ancestor.parent;
                }
                if (ancestor &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].BREAKABLE) &&
                    range.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_2__["RuleProperty"].EDITABLE)) {
                    const nextSibling = ancestor.nextSibling();
                    if (nextSibling instanceof _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__["AtomicNode"]) {
                        let next = nextSibling;
                        while (next && next instanceof _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__["AtomicNode"]) {
                            ancestor.append(next);
                            next = ancestor.nextSibling();
                        }
                    }
                    else {
                        const next = nextSibling.firstLeaf();
                        if (next && !range.endContainer.hasChildren()) {
                            // If the current container is empty, remove it.
                            range.endContainer.removeForward();
                            range.setStart(next, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE);
                            range.setEnd(next, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE);
                        }
                        else if (next) {
                            range.setEnd(next, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE);
                            range.empty();
                        }
                    }
                }
            }
        }
        else {
            range.empty();
        }
    }
    /**
     * Navigate to a given range.
     *
     * @param params
     */
    setSelection(params) {
        this.editor.selection.set(params.vSelection);
    }
}


/***/ }),

/***/ "./packages/core/src/Dispatcher.ts":
/*!*****************************************!*\
  !*** ./packages/core/src/Dispatcher.ts ***!
  \*****************************************/
/*! exports provided: Dispatcher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dispatcher", function() { return Dispatcher; });
class Dispatcher {
    constructor(editor) {
        this.__nextHandlerTokenID = 0;
        this.commands = {};
        this.commandHooks = {};
        this.editor = editor;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Call all hooks registred for the command `id`.
     *
     * @param commandId The identifier of the command.
     * @param params The parameters of the command.
     */
    async dispatch(commandId, params = {}) {
        const commands = this.commands[commandId];
        if (!commands) {
            console.warn(`Command '${commandId}' not found.`);
            return;
        }
        const [command, context] = this.editor.contextManager.match(commands, params.context);
        if (command) {
            // Update command arguments with the computed execution context.
            const args = Object.assign(Object.assign({}, params), { context });
            // Call command handler.
            const result = await command.handler(args);
            await this.dispatchHooks(commandId, args);
            return result;
        }
    }
    /**
     * Register all handlers declared in a plugin, and match them with their
     * corresponding command.
     *
     */
    registerCommand(id, impl) {
        if (!this.commands[id]) {
            this.commands[id] = [impl];
        }
        else {
            this.commands[id].push(impl);
        }
    }
    /**
     * Register a callback that will be executed for each `execCommand` call.
     *
     * @param id The identifier of the command to hook.
     * @param hook The callback that will be executed.
     */
    registerCommandHook(id, hook) {
        if (!this.commandHooks[id]) {
            this.commandHooks[id] = [];
        }
        this.commandHooks[id].push(hook);
    }
    /**
     * Remove a callback that will be executed for each `execCommand` call.
     *
     * @param id The identifier of the command to hook.
     * @param hook The callback that will be removed.
     */
    removeCommandHook(id, hook) {
        if (this.commandHooks[id]) {
            const index = this.commandHooks[id].indexOf(hook);
            if (index !== -1) {
                this.commandHooks[id].splice(index, 1);
            }
        }
    }
    /**
     * Dispatch to all registred `commandHooks`.
     */
    async dispatchHooks(signal, args) {
        const hooks = this.commandHooks[signal] || [];
        const globalHooks = this.commandHooks['*'] || [];
        for (const hookCallback of [...hooks, ...globalHooks]) {
            await hookCallback(args, signal);
        }
    }
}


/***/ }),

/***/ "./packages/core/src/Format.ts":
/*!*************************************!*\
  !*** ./packages/core/src/Format.ts ***!
  \*************************************/
/*! exports provided: Format */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Format", function() { return Format; });
/* harmony import */ var _Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _Modifiers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class Format extends _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] {
    constructor(htmlTag) {
        super();
        this.modifiers = new _Modifiers__WEBPACK_IMPORTED_MODULE_1__["Modifiers"]();
        this.htmlTag = htmlTag;
    }
    get name() {
        return this.htmlTag.toLowerCase();
    }
    toString() {
        const nonEmptyAttributes = this.modifiers.filter(modifier => !(modifier instanceof _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]) || !!modifier.length);
        if (nonEmptyAttributes.length) {
            const modifiersRepr = [];
            for (const modifier of nonEmptyAttributes) {
                modifiersRepr.push(modifier.toString());
            }
            return `${this.name}[${modifiersRepr.join(', ')}]`;
        }
        else {
            return this.name;
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    clone() {
        const clone = new this.constructor();
        clone.htmlTag = this.htmlTag;
        clone.modifiers = this.modifiers.clone();
        return clone;
    }
    isSameAs(otherFormat) {
        const aModifiers = this.modifiers;
        const bModifiers = otherFormat === null || otherFormat === void 0 ? void 0 : otherFormat.modifiers;
        return otherFormat instanceof this.constructor && aModifiers.areSameAs(bModifiers);
    }
}


/***/ }),

/***/ "./packages/core/src/JWEditor.ts":
/*!***************************************!*\
  !*** ./packages/core/src/JWEditor.ts ***!
  \***************************************/
/*! exports provided: EditorStage, JWEditor, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorStage", function() { return EditorStage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JWEditor", function() { return JWEditor; });
/* harmony import */ var _Dispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dispatcher */ "./packages/core/src/Dispatcher.ts");
/* harmony import */ var _JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _Core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Core */ "./packages/core/src/Core.ts");
/* harmony import */ var _ContextManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ContextManager */ "./packages/core/src/ContextManager.ts");
/* harmony import */ var _VSelection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _VRange__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utils/src/errors */ "./packages/utils/src/errors.ts");
/* harmony import */ var _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");
/* harmony import */ var _Mode__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Mode */ "./packages/core/src/Mode.ts");
/* harmony import */ var _Memory_Memory__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Memory/Memory */ "./packages/core/src/Memory/Memory.ts");
/* harmony import */ var _Memory_Versionable__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");
















var EditorStage;
(function (EditorStage) {
    EditorStage["CONFIGURATION"] = "configuration";
    EditorStage["STARTING"] = "starting";
    EditorStage["EDITION"] = "edition";
})(EditorStage || (EditorStage = {}));
class JWEditor {
    constructor() {
        this._stage = EditorStage.CONFIGURATION;
        this.plugins = new Map();
        this.configuration = {
            defaults: {
                Container: _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_9__["ContainerNode"],
                Atomic: _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_10__["AtomicNode"],
                Separator: _VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_11__["SeparatorNode"],
            },
            plugins: [],
            loadables: {},
        };
        this._memoryID = 0;
        this.loaders = {};
        this._mutex = Promise.resolve();
        // Use a set so that when asynchronous functions are called we ensure that
        // each command batch is waited for.
        this.preventRenders = new Set();
        this.enableRender = true;
        this.modes = {
            default: new _Mode__WEBPACK_IMPORTED_MODULE_12__["Mode"]({
                id: 'default',
                rules: [],
            }),
        };
        this.mode = this.modes.default;
        this.dispatcher = new _Dispatcher__WEBPACK_IMPORTED_MODULE_0__["Dispatcher"](this);
        this.plugins = new Map();
        this.selection = new _VSelection__WEBPACK_IMPORTED_MODULE_4__["VSelection"](this);
        this.contextManager = new _ContextManager__WEBPACK_IMPORTED_MODULE_3__["ContextManager"](this, this._execSubCommand.bind(this));
        // Core is a special mandatory plugin that handles the matching between
        // the commands supported in the core of the editor and the VDocument.
        this.load(_Core__WEBPACK_IMPORTED_MODULE_2__["Core"]);
        this.load(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_7__["Keymap"]);
    }
    /**
     * Set the current mode of the editor.
     */
    setMode(modeIdentifier) {
        this.mode = this.modes[modeIdentifier];
    }
    /**
     * Start the editor on the editable DOM node set on this editor instance.
     */
    async start() {
        this._stage = EditorStage.STARTING;
        this._loadPlugins();
        // Load editor-level loadables.
        if (this.configuration.loadables) {
            for (const loadableId of Object.keys(this.loaders)) {
                const loadable = this.configuration.loadables[loadableId];
                if (loadable) {
                    this.loaders[loadableId](loadable, this.configuration);
                }
            }
        }
        for (const mode of this.configuration.modes || []) {
            this.modes[mode.id] = new _Mode__WEBPACK_IMPORTED_MODULE_12__["Mode"](mode);
        }
        if (this.configuration.mode) {
            this.setMode(this.configuration.mode);
        }
        // create memory
        this.memoryInfo = Object(_Memory_Versionable__WEBPACK_IMPORTED_MODULE_14__["makeVersionable"])({ commandNames: [], uiCommand: false });
        this.memory = new _Memory_Memory__WEBPACK_IMPORTED_MODULE_13__["Memory"]();
        this.memory.attach(this.memoryInfo);
        this.memory.create(this._memoryID.toString());
        // Start all plugins in the first memory slice.
        await this.execCommand(async () => {
            for (const plugin of this.plugins.values()) {
                await plugin.start();
            }
        });
        this._stage = EditorStage.EDITION;
    }
    load(PluginOrLoadables, config) {
        // Actual loading is deferred to `start`.
        if (this._stage !== EditorStage.CONFIGURATION) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_8__["StageError"](EditorStage.CONFIGURATION);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_6__["isConstructor"])(PluginOrLoadables, _JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"])) {
            // Add the plugin to the configuration.
            const Plugin = PluginOrLoadables;
            const plugins = this.configuration.plugins;
            const index = plugins.findIndex(([p]) => p === Plugin);
            if (index !== -1) {
                // Remove this module from the config to avoid loading it twice.
                plugins.splice(index, 1);
            }
            plugins.push([Plugin, config || {}]);
        }
        else {
            // Add the loadables to the configuration.
            const configuredLoadables = this.configuration.loadables;
            for (const loadableIdentifier of Object.keys(PluginOrLoadables)) {
                const loadables = PluginOrLoadables[loadableIdentifier];
                if (configuredLoadables[loadableIdentifier]) {
                    configuredLoadables[loadableIdentifier].push(...loadables);
                }
                else {
                    configuredLoadables[loadableIdentifier] = [...loadables];
                }
            }
        }
    }
    /**
     * Load the plugins specified in the editor configuration.
     *
     */
    _loadPlugins() {
        // Resolve dependencies.
        const Plugins = [...this.configuration.plugins];
        for (let offset = 1; offset <= Plugins.length; offset++) {
            const index = Plugins.length - offset;
            const [Plugin] = Plugins[index];
            for (const Dependency of [...Plugin.dependencies].reverse()) {
                const depIndex = Plugins.findIndex(([P]) => P === Dependency);
                if (depIndex === -1) {
                    // Load the missing dependency with no config parameters.
                    Plugins.splice(index, 0, [Dependency, {}]);
                }
                else if (depIndex > index) {
                    // Load the dependency before the plugin depending on it.
                    const [[Dep, config]] = Plugins.splice(depIndex, 1);
                    Plugins.splice(index, 0, [Dep, config]);
                    offset--;
                }
            }
        }
        // Load plugins.
        for (const [PluginClass, configuration] of Plugins) {
            const plugin = new PluginClass(this, configuration);
            this.plugins.set(PluginClass, plugin);
            // Register the commands of this plugin.
            Object.keys(plugin.commands).forEach(key => {
                const implementation = Object.assign({}, plugin.commands[key]);
                // Bind handlers to the plugin itself. This preserves the
                // typing of the handler parameters which would be lost if
                // the binding was done in the plugin definition.
                implementation.handler = implementation.handler.bind(plugin);
                this.dispatcher.registerCommand(key, implementation);
            });
            // Register the hooks of this plugin.
            for (const [id, hook] of Object.entries(plugin.commandHooks)) {
                this.dispatcher.registerCommandHook(id, hook.bind(plugin));
            }
            // Load loaders.
            for (const loadableId of Object.keys(plugin.loaders)) {
                if (this.loaders[loadableId]) {
                    throw new Error(`Multiple loaders for '${loadableId}'.`);
                }
                else {
                    // Bind loaders to the plugin itself. This preserves the
                    // typing of the loader parameters which would be lost if
                    // the binding was done in the plugin definition.
                    const loader = plugin.loaders[loadableId];
                    this.loaders[loadableId] = loader.bind(plugin);
                }
            }
        }
        // Load loadables.
        for (const loadableIdentifier of Object.keys(this.loaders)) {
            for (const plugin of this.plugins.values()) {
                const loadableArray = plugin.loadables[loadableIdentifier];
                if (loadableArray) {
                    this.loaders[loadableIdentifier](loadableArray, plugin);
                }
            }
        }
    }
    configure(PluginOrEditorConfig, pluginConfig) {
        if (this._stage !== EditorStage.CONFIGURATION) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_8__["StageError"](EditorStage.CONFIGURATION);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_6__["isConstructor"])(PluginOrEditorConfig, _JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"])) {
            // Configure the plugin.
            const Plugin = PluginOrEditorConfig;
            const conf = this.configuration.plugins.find(([P]) => P === Plugin);
            if (conf) {
                // Update the previous config if the plugin was already added.
                conf[1] = Object.assign(Object.assign({}, conf[1]), pluginConfig);
            }
            else {
                // Add the new plugin constructor and his configuration.
                this.configuration.plugins.push([Plugin, pluginConfig]);
            }
        }
        else {
            // Configure the editor.
            const preconf = this.configuration;
            const conf = PluginOrEditorConfig;
            this.configuration = Object.assign(Object.assign({}, preconf), conf);
            // Merge special `defaults` configuration key.
            if (conf.defaults) {
                this.configuration.defaults = Object.assign(Object.assign({}, preconf.defaults), conf.defaults);
            }
            // Handle special `plugins` configuration key through `load`.
            if (conf.plugins) {
                this.configuration.plugins = [...preconf.plugins];
                for (const [Plugin, pluginConfiguration] of conf.plugins) {
                    this.load(Plugin, pluginConfiguration || {});
                }
            }
            // Handle special `loadables` configuration key through `load`.
            if (conf.loadables) {
                this.configuration.loadables = Object.assign({}, preconf.loadables);
                this.load(conf.loadables);
            }
        }
    }
    /**
     * Execute the command or arbitrary code in `callback` in memory.
     * The call to execCommand are executed into a mutex. Every plugin can
     * launch subcommands with the 'JWPlugin.execCommand' method instead.
     *
     * TODO: create memory for each plugin who use the command then use
     * squashInto(winnerSliceKey, winnerSliceKey, newMasterSliceKey)
     *
     * @param commandName name identifier of the command to execute or callback
     * @param params arguments object of the command to execute
     */
    async execCommand(commandName, params) {
        this._mutex = this._mutex.then(async () => {
            if (!this.memory.isFrozen()) {
                console.error('You are trying to call the external editor' +
                    ' execCommand method from within an execCommand. ' +
                    'Use the `execCommand` method of your plugin instead.');
                return;
            }
            const timeout = setTimeout(() => {
                console.warn('An execCommand call is taking more than 10 seconds to finish. It might be caused by a deadlock.\n' +
                    'Verify that you do not call editor.execCommand inside another editor.execCommand.');
            }, 10000);
            // Switch to the next memory slice (unfreeze the memory).
            const origin = this.memory.sliceKey;
            const memorySlice = this._memoryID.toString();
            this.memory.switchTo(memorySlice);
            this.memoryInfo.commandNames = new _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_15__["VersionableArray"]();
            this.memoryInfo.uiCommand = false;
            let commandNames = this.memoryInfo.commandNames;
            try {
                // Execute command.
                if (typeof commandName === 'function') {
                    const name = '@custom' + (commandName.name ? ':' + commandName.name : '');
                    this.memoryInfo.commandNames.push(name);
                    await commandName(this.contextManager.defaultContext);
                    if (this.memory.sliceKey !== memorySlice) {
                        // Override by the current commandName if the slice changed.
                        commandNames = [name];
                    }
                }
                else {
                    this.memoryInfo.commandNames.push(commandName);
                    await this.dispatcher.dispatch(commandName, params);
                    if (this.memory.sliceKey !== memorySlice) {
                        // Override by the current commandName if the slice changed.
                        commandNames = [commandName];
                    }
                }
                // Prepare nex slice and freeze the memory.
                this._memoryID++;
                const nextMemorySlice = this._memoryID.toString();
                this.memory.create(nextMemorySlice);
                // Send the commit message with a frozen memory.
                const changesLocations = this.memory.getChangesLocations(memorySlice, this.memory.sliceKey);
                await this.dispatcher.dispatchHooks('@commit', {
                    changesLocations: changesLocations,
                    commandNames: commandNames,
                });
                clearTimeout(timeout);
            }
            catch (error) {
                clearTimeout(timeout);
                if (this._stage !== EditorStage.EDITION) {
                    throw error;
                }
                console.error(error);
                const failedSlice = this.memory.sliceKey;
                // When an error occurs, we go back to part of the functional memory.
                this.memory.switchTo(origin);
                try {
                    // Send the commit message with a frozen memory.
                    const changesLocations = this.memory.getChangesLocations(failedSlice, origin);
                    await this.dispatcher.dispatchHooks('@commit', {
                        changesLocations: changesLocations,
                        commandNames: commandNames,
                    });
                }
                catch (revertError) {
                    if (this._stage !== EditorStage.EDITION) {
                        throw revertError;
                    }
                    console.error(revertError);
                }
            }
        });
        return this._mutex;
    }
    async execWithRange(bounds, commandName, params, mode) {
        const callback = async () => {
            this.memoryInfo.commandNames.push('@withRange');
            let range;
            if (typeof commandName === 'function') {
                range = new _VRange__WEBPACK_IMPORTED_MODULE_5__["VRange"](this, bounds, params);
                this.memoryInfo.commandNames.push('@custom' + (commandName.name ? ':' + commandName.name : ''));
                await commandName(Object.assign(Object.assign({}, this.contextManager.defaultContext), { range }));
            }
            else {
                range = new _VRange__WEBPACK_IMPORTED_MODULE_5__["VRange"](this, bounds, mode);
                this.memoryInfo.commandNames.push(commandName);
                const newParam = Object.assign({ context: {} }, params);
                newParam.context.range = range;
                await this.dispatcher.dispatch(commandName, newParam);
            }
            range.remove();
        };
        if (this.memory.isFrozen()) {
            await this.execCommand(callback);
        }
        else {
            await callback();
        }
    }
    /**
     * Stop this editor instance.
     */
    async stop() {
        if (this.memory) {
            this.memory.create('stop');
            this.memory.switchTo('stop'); // Unfreeze the memory.
        }
        for (const plugin of this.plugins.values()) {
            await plugin.stop();
        }
        if (this.memory) {
            this.memory.create('stopped'); // Freeze the memory.
            this.memory = null;
        }
        this.plugins.clear();
        this.dispatcher = new _Dispatcher__WEBPACK_IMPORTED_MODULE_0__["Dispatcher"](this);
        this.selection = new _VSelection__WEBPACK_IMPORTED_MODULE_4__["VSelection"](this);
        this.contextManager = new _ContextManager__WEBPACK_IMPORTED_MODULE_3__["ContextManager"](this, this._execSubCommand);
        // Clear loaders.
        this.loaders = {};
        this._stage = EditorStage.CONFIGURATION;
    }
    /**
     * Execute the command or arbitrary code in `callback` in memory.
     *
     * @param commandName name identifier of the command to execute or callback
     * @param params arguments object of the command to execute
     */
    async _execSubCommand(commandName, params) {
        if (typeof commandName === 'function') {
            this.memoryInfo.commandNames.push('@custom' + (commandName.name ? ':' + commandName.name : ''));
            await commandName(this.contextManager.defaultContext);
        }
        else {
            this.memoryInfo.commandNames.push(commandName);
            await this.dispatcher.dispatch(commandName, params);
        }
    }
}
/* harmony default export */ __webpack_exports__["default"] = (JWEditor);


/***/ }),

/***/ "./packages/core/src/JWPlugin.ts":
/*!***************************************!*\
  !*** ./packages/core/src/JWPlugin.ts ***!
  \***************************************/
/*! exports provided: JWPlugin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JWPlugin", function() { return JWPlugin; });
class JWPlugin {
    constructor(editor, configuration = {}) {
        this.editor = editor;
        this.configuration = configuration;
        this.dependencies = new Map();
        this.loaders = {};
        this.loadables = {};
        this.commands = {};
        this.commandHooks = {};
        // Populate instantiated dependencies.
        for (const Dependency of this.constructor.dependencies) {
            this.dependencies.set(Dependency, editor.plugins.get(Dependency));
        }
    }
    /**
     * Start the plugin. Called when the editor starts.
     */
    async start() {
        // This is where plugins can do asynchronous work when the editor is
        // starting (e.g. retrieve data from a server, render stuff, etc).
    }
    /**
     * Stop the plugin. Called when the editor stops.
     */
    async stop() {
        // This is where plugins can do asynchronous work when the editor is
        // stopping (e.g. save on a server, close connections, etc).
        this.dependencies.clear();
        this.editor = null;
    }
}
JWPlugin.dependencies = [];


/***/ }),

/***/ "./packages/core/src/Memory/Memory.ts":
/*!********************************************!*\
  !*** ./packages/core/src/Memory/Memory.ts ***!
  \********************************************/
/*! exports provided: MemoryTypeObject, MemoryTypeArray, MemoryArrayCompiledWithPatch, MemoryTypeSet, parentedPathSeparator, markAsDiffRoot, MemorySlice, Memory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryTypeObject", function() { return MemoryTypeObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryTypeArray", function() { return MemoryTypeArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryArrayCompiledWithPatch", function() { return MemoryArrayCompiledWithPatch; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryTypeSet", function() { return MemoryTypeSet; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parentedPathSeparator", function() { return parentedPathSeparator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "markAsDiffRoot", function() { return markAsDiffRoot; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemorySlice", function() { return MemorySlice; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Memory", function() { return Memory; });
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./const */ "./packages/core/src/Memory/const.ts");

// MemoryType
// MemoryType for Object
// Type that the memory handles in practice. This is how it is stored in memory.
class MemoryTypeObject {
    constructor() {
        this.props = {};
    }
}
// MemoryType for Array
// Type that the memory handles in practice. This is how it is stored in memory.
class MemoryTypeArray extends MemoryTypeObject {
    constructor() {
        super(...arguments);
        this.patch = {};
    }
}
// Output of memory given to proxy to operate
class MemoryArrayCompiledWithPatch {
    // the proxy has to differentiate between what was already there and what is
    // being done in the current slice because deleting a key does not yield the
    // same result if the key was already there before this slice or not (it
    // would be marked as "removed" or ignored if wasn't already there.)
    constructor(
    // array as it appears in the slice right before the current one "array as of t-1"
    compiledValues, 
    // very last patch at current time t
    newValues, 
    // new properties on the array at current time t
    props) {
        this.compiledValues = compiledValues;
        this.newValues = newValues;
        this.props = props;
    }
}
// MemoryType for Set
// Type that the memory handles in practice. This is how it is stored in memory.
class MemoryTypeSet {
    constructor() {
        this.add = new Set();
        this.delete = new Set();
    }
}
const parentedPathSeparator = '';
function markAsDiffRoot(obj) {
    obj[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]].isDiffRoot = true;
}
let memoryID = 0;
const memoryRootSliceName = '';
class MemorySlice {
    constructor(name, parent) {
        this.children = [];
        this.data = {}; // registry of values
        this.linkedParentOfProxy = {};
        this.invalidCache = {}; // paths that have been changed in given memory slice (when switching slice, this set is loaded in _invalidateCache)
        this.ids = new Set();
        this.name = name;
        this.parent = parent;
    }
    getPrevious() {
        return this.snapshotOrigin ? this.snapshotOrigin.parent : this.parent;
    }
}
class Memory {
    constructor() {
        this._slices = {}; // Record<children, parent>
        this._proxies = {};
        this._rootProxies = {};
        this._numberOfFlatSlices = 40;
        this._numberOfSlicePerSnapshot = 8;
        this._autoSnapshotCheck = 0;
        this._id = ++memoryID;
        this.create(memoryRootSliceName);
        this.switchTo(memoryRootSliceName);
        this._memoryWorker = {
            ID: this._id,
            getProxy: (ID) => this._proxies[ID],
            getSlice: () => this._currentSlice.data,
            getSliceValue: (ID) => this._getValue(this._sliceKey, ID),
            isFrozen: this.isFrozen.bind(this),
            // Mark as "modified" in this slice
            markDirty: (ID) => (this._currentSlice.invalidCache[ID] = true),
            // I am the proxy, I tell you I synchornized the value
            deleteSliceProxyParent: this._deleteSliceProxyParent.bind(this),
            addSliceProxyParent: this._addSliceProxyParent.bind(this),
            linkToMemory: this._linkToMemory.bind(this),
        };
        Object.freeze(this._memoryWorker);
    }
    get sliceKey() {
        return this._sliceKey;
    }
    /**
     * Create a memory slice.
     * Modifications and changes (of objects bound to memory) are all recorded
     * in these slices. The new slice created will be noted as being the
     * continuation (or the child) of the current one.
     *
     * A slice with "children" is immutable. The modifications are therefore
     * blocked and an error will be triggered if a code tries to modify one of
     * these objects. To be able to edit again, you must destroy the "child"
     * slices or change the memory slice.
     *
     * @param sliceKey
     */
    create(sliceKey) {
        this._create(sliceKey, this._sliceKey);
        return this;
    }
    /**
     * Change the working memory slice (this must be created beforehand).
     *
     * @param sliceKey
     */
    switchTo(sliceKey) {
        if (!(sliceKey in this._slices)) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["MemoryError"]('You must create the "' + sliceKey + '" slice before switch on it');
        }
        if (sliceKey === this._sliceKey) {
            return;
        }
        const invalidCache = this._aggregateInvalidCaches(this._sliceKey, sliceKey);
        this._currentSlice = this._slices[sliceKey];
        this._sliceKey = sliceKey;
        for (const key of invalidCache) {
            const proxy = this._proxies[key];
            const params = proxy[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]];
            params.synchronize();
        }
        this._autoSnapshotCheck++;
        if (!(this._autoSnapshotCheck % this._numberOfSlicePerSnapshot)) {
            this._autoSnapshot();
        }
        return this;
    }
    /**
     * Attach a versionable to memory.
     * The versionable will then be versioned and its modifications will be
     * recorded in the corresponding memory slots.
     * All other versionables linked to given versionable attached to memory
     * are automatically linked to memory.
     *
     * (Items bound to memory by this function will be noted as part of the
     * root of changes @see getRoots )
     *
     * @param versionable
     */
    attach(versionable) {
        const params = versionable[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]];
        if (!params) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["NotVersionableError"]();
        }
        if (params.object === versionable) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["VersionableAllreadyVersionableError"]();
        }
        if (!params.verify(versionable)) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["NotVersionableError"]();
        }
        if (this.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["FrozenError"]();
        }
        if (!params.memory || params.memory !== this._memoryWorker) {
            params.isDiffRoot = true;
            this._linkToMemory(versionable);
        }
        this._rootProxies[params.ID] = true;
    }
    /**
     * Returns the parents of the object.
     *
     * Example: p = {}; v = {point: p} axis = {origin: p}
     * The parents of p are [[v, ['point']], [axis, ['origin']]]
     *
     * @param versionable
     */
    getParents(versionable) {
        const pathChanges = new Map();
        const nodeID = versionable[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]].ID;
        const pathList = [[nodeID, []]];
        while (pathList.length) {
            const path = pathList.pop();
            const [nodeID, pathToNode] = path;
            const parentProxy = this._proxies[nodeID];
            let paths = pathChanges.get(parentProxy);
            if (!paths) {
                paths = [];
                pathChanges.set(parentProxy, paths);
            }
            paths.push(path[1]);
            if (this._rootProxies[nodeID]) {
                continue;
            }
            this._getProxyParentedPath(this._sliceKey, nodeID).forEach(path => {
                const parentNodeID = path.split(parentedPathSeparator, 1)[0];
                const partPath = path.slice(parentNodeID.length + 1);
                pathList.push([+parentNodeID, [partPath].concat(pathToNode)]);
            });
        }
        return pathChanges;
    }
    /**
     * Return the location of the changes.
     *
     * @param from
     * @param to
     */
    getChangesLocations(from, to) {
        const diff = {
            add: [],
            move: [],
            remove: [],
            update: [],
        };
        const ancestorKey = this._getCommonAncestor(from, to);
        const refs = this._getChangesPath(from, to, ancestorKey);
        if (from === ancestorKey && from !== to) {
            refs.shift();
        }
        const removeFromUpdate = new Set();
        let previous;
        let ref;
        while ((ref = refs.pop())) {
            const linkedParentOfProxy = ref.linkedParentOfProxy;
            for (const ID in linkedParentOfProxy) {
                const proxy = this._proxies[ID];
                if (linkedParentOfProxy[ID].length) {
                    if (ref.ids.has(+ID)) {
                        if (ref.parent === previous) {
                            diff.remove.push(proxy);
                        }
                        else {
                            diff.add.push(proxy);
                        }
                        removeFromUpdate.add(proxy);
                    }
                    else {
                        diff.move.push(proxy);
                    }
                }
                else {
                    if (ref.parent === previous) {
                        diff.add.push(proxy);
                    }
                    else {
                        diff.remove.push(proxy);
                    }
                    removeFromUpdate.add(proxy);
                }
            }
            if (ref.parent === previous) {
                for (const ID of previous.ids) {
                    const proxy = this._proxies[ID];
                    diff.remove.push(proxy);
                    removeFromUpdate.add(proxy);
                }
            }
            const slice = ref.data;
            Object.keys(slice).forEach(ID => {
                const id = +ID;
                const memoryItem = slice[id];
                const proxy = this._proxies[ID];
                if (removeFromUpdate.has(proxy)) {
                    return;
                }
                else if (memoryItem instanceof MemoryTypeArray) {
                    const keys = Object.keys(memoryItem.props);
                    if (keys.length) {
                        diff.update.push([proxy, keys]);
                    }
                    const params = proxy[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]];
                    const uniqIDs = params.uniqIDs;
                    const len = uniqIDs.length;
                    const half = len;
                    const indexes = [];
                    for (const i in memoryItem.patch) {
                        let index = half;
                        let step = index + 1;
                        while (step) {
                            const value = uniqIDs[index];
                            if (value === i) {
                                break;
                            }
                            else if (value > i) {
                                index -= step;
                                if (index < 0) {
                                    index = 0;
                                }
                            }
                            else {
                                index += step;
                                if (index >= len) {
                                    index = len - 1;
                                }
                            }
                            step = (step / 2) | 0;
                            if (step === 0 && value > i && uniqIDs[index] < i) {
                                index++;
                            }
                        }
                        if (!indexes.includes(index)) {
                            indexes.push(index);
                        }
                    }
                    if (indexes.length) {
                        diff.update.push([proxy, indexes]);
                    }
                }
                else if (memoryItem instanceof MemoryTypeSet) {
                    diff.update.push([proxy, null]);
                }
                else {
                    const keys = Object.keys(memoryItem.props);
                    if (keys.length) {
                        diff.update.push([proxy, keys]);
                    }
                }
            });
            previous = ref;
        }
        return diff;
    }
    /**
     * Get if the current memory slice are imutable or not.
     *
     */
    isFrozen() {
        return this._currentSlice.children.length > 0;
    }
    /**
     * Remove a memory slice.
     * The current slice cannot be the one being deleted or one of its children.
     *
     * @param sliceKey
     */
    remove(sliceKey) {
        if (!(sliceKey in this._slices)) {
            return this;
        }
        if (sliceKey === memoryRootSliceName) {
            throw new _const__WEBPACK_IMPORTED_MODULE_0__["MemoryError"]('You should not remove the original memory slice');
        }
        let ref = this._slices[this._sliceKey];
        while (ref) {
            if (ref.name === sliceKey) {
                throw new _const__WEBPACK_IMPORTED_MODULE_0__["MemoryError"]('Please switch to a non-children slice before remove it');
            }
            ref = ref.parent;
        }
        const IDs = this._remove(sliceKey);
        // check if the IDs are linked evrywere
        Object.values(this._slices).forEach(reference => {
            const linkedParentOfProxy = reference.linkedParentOfProxy;
            IDs.forEach(ID => {
                if (ID in linkedParentOfProxy) {
                    IDs.delete(ID);
                }
            });
        });
        // remove unlinked items
        IDs.forEach(ID => {
            delete this._proxies[ID];
            delete this._rootProxies[ID];
        });
        return this;
    }
    /**
     * Return ancestor versionables noted as roots.
     *
     * There are two ways for a versionable to be root, either via the
     * 'linkToMemory' method, or with the 'markAsDiffRoot' utility function.
     *
     * @param proxy
     */
    getRoots(proxy) {
        const roots = new Set();
        const nodeID = proxy[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]].ID;
        const pathList = [[nodeID, []]];
        while (pathList.length) {
            const path = pathList.pop();
            const [nodeID, pathToNode] = path;
            if (this._rootProxies[nodeID]) {
                roots.add(this._proxies[nodeID]);
                continue;
            }
            this._getProxyParentedPath(this._sliceKey, nodeID).forEach(path => {
                const parentNodeID = path.split(parentedPathSeparator, 1)[0];
                const partPath = path.slice(parentNodeID.length + 1);
                pathList.push([+parentNodeID, [partPath].concat(pathToNode)]);
            });
        }
        return roots;
    }
    /**
     * Return the list of names of all previous memory slice of the given
     * memory slice.
     *
     * @param sliceKey
     * @param withoutSnapshot
     */
    getPath(sliceKey, withoutSnapshot) {
        const sliceKeys = [];
        let ref = this._slices[sliceKey];
        while (ref && ref.name) {
            sliceKeys.push(ref.name);
            ref = withoutSnapshot ? ref.getPrevious() : ref.parent;
        }
        return sliceKeys;
    }
    /**
     * Create the snapshot of different memory slices (use the path between the
     * memory slice to get all changes) and merge the changes into a new
     * destination slice.
     *
     * @param fromSliceKey
     * @param unitSliceKey
     * @param newSliceKey
     */
    snapshot(fromSliceKey, unitSliceKey, newSliceKey) {
        const refs = this._slices;
        const fromRref = refs[fromSliceKey];
        const untilRref = refs[unitSliceKey];
        const newRef = this._create(newSliceKey, fromRref.parent && fromRref.parent.name);
        this._squashInto(fromSliceKey, unitSliceKey, newRef.name);
        untilRref.children.forEach(child => {
            child.parent = newRef;
        });
        newRef.children = untilRref.children;
        untilRref.children = [];
        untilRref.snapshot = newRef;
        newRef.snapshotOrigin = untilRref;
    }
    /**
     * Compress all changes between two parented memory slices and remove all
     * children memory slice.
     *
     * @param fromSliceKey
     * @param unitSliceKey
     */
    compress(fromSliceKey, unitSliceKey) {
        const refs = this._slices;
        const fromRref = refs[fromSliceKey];
        const untilRref = refs[unitSliceKey];
        const toRemove = fromRref.children.slice().map(ref => ref.name);
        fromRref.children = untilRref.children.splice(0);
        this._squashInto(fromSliceKey, unitSliceKey, fromSliceKey);
        let key;
        while ((key = toRemove.pop())) {
            this._remove(key);
        }
        return true;
    }
    /////////////////////////////////////////////////////
    // private
    /////////////////////////////////////////////////////
    _addSliceProxyParent(ID, parentID, attributeName) {
        const sliceKey = this._sliceKey;
        const sliceLinkedParentOfProxy = this._slices[sliceKey].linkedParentOfProxy;
        const path = parentID +
            (attributeName === undefined
                ? memoryRootSliceName
                : parentedPathSeparator + attributeName);
        let parents = sliceLinkedParentOfProxy[ID];
        if (!parents) {
            const parented = this._getProxyParentedPath(sliceKey, ID);
            parents = sliceLinkedParentOfProxy[ID] = parented
                ? parented.slice()
                : [];
        }
        parents.push(path);
    }
    _deleteSliceProxyParent(ID, parentID, attributeName) {
        const sliceKey = this._sliceKey;
        const sliceLinkedParentOfProxy = this._slices[sliceKey].linkedParentOfProxy;
        const path = parentID +
            (attributeName === undefined
                ? memoryRootSliceName
                : parentedPathSeparator + attributeName);
        let parents = this._getProxyParentedPath(sliceKey, ID);
        const index = parents.indexOf(path);
        if (!sliceLinkedParentOfProxy[ID]) {
            parents = sliceLinkedParentOfProxy[ID] = parents.slice();
        }
        parents.splice(index, 1);
    }
    _compiledArrayPatches(patches) {
        const props = {};
        const valueBySeq = {};
        while (patches.length) {
            const patch = patches.pop();
            const step = patch.value;
            Object.assign(props, step.props);
            Object.assign(valueBySeq, step.patch);
        }
        return {
            patch: valueBySeq,
            props: props,
        };
    }
    _compiledSetPatches(patches) {
        const obj = new Set();
        while (patches.length) {
            const patch = patches.pop();
            const step = patch.value;
            step.add.forEach((item) => obj.add(item));
            step.delete.forEach((item) => obj.delete(item));
        }
        return obj;
    }
    _compiledObjectPatches(patches) {
        const obj = new MemoryTypeObject();
        const props = obj.props;
        while (patches.length) {
            const patch = patches.pop();
            const step = patch.value;
            Object.assign(props, step.props);
        }
        Object.keys(props).forEach(key => {
            if (props[key] === _const__WEBPACK_IMPORTED_MODULE_0__["removedItem"]) {
                delete props[key];
            }
        });
        return obj;
    }
    _create(sliceKey, fromSliceKey) {
        const refs = this._slices;
        if (refs[sliceKey]) {
            throw new Error('The memory slice "' + sliceKey + '" already exists');
        }
        const parent = refs[fromSliceKey];
        const ref = (refs[sliceKey] = new MemorySlice(sliceKey, parent));
        if (parent) {
            parent.children.push(ref);
        }
        return ref;
    }
    _getChangesPath(fromSliceKey, toSliceKey, ancestorKey) {
        const fromPath = [];
        let ref = this._slices[fromSliceKey];
        while (ref) {
            fromPath.push(ref);
            if (ref.name === ancestorKey) {
                break;
            }
            ref = ref.getPrevious();
        }
        const toPath = [];
        ref = this._slices[toSliceKey];
        while (ref) {
            if (ref.name === ancestorKey) {
                break;
            }
            toPath.push(ref);
            ref = ref.getPrevious();
        }
        toPath.reverse();
        return fromPath.concat(toPath);
    }
    _getCommonAncestor(sliceKeyA, sliceKeyB) {
        const rootB = this._slices[sliceKeyB];
        let refA = this._slices[sliceKeyA];
        while (refA) {
            let refB = rootB;
            while (refB) {
                if (refA.name === refB.name) {
                    return refA.name;
                }
                refB = refB.getPrevious();
            }
            refA = refA.getPrevious();
        }
    }
    _getProxyParentedPath(sliceKey, ID) {
        // bubbling up magic for proxyParents
        let ref = this._slices[sliceKey];
        while (ref) {
            const slice = ref.linkedParentOfProxy;
            const path = slice && slice[ID];
            if (path) {
                return path;
            }
            ref = ref.parent;
        }
        return [];
    }
    _getValue(sliceKey, ID) {
        const patch = this._getPatches(undefined, sliceKey, ID);
        if (!patch) {
            return;
        }
        if (patch.type === 'set') {
            return this._compiledSetPatches(patch.patches);
        }
        else if (patch.type === 'array') {
            return this._getValueArray(sliceKey, ID, patch.patches);
        }
        else {
            return this._compiledObjectPatches(patch.patches);
        }
    }
    _getValueArray(sliceKey, ID, patches) {
        const ref = this._slices[sliceKey];
        let owner;
        if (ref.data[ID]) {
            owner = patches.shift().value;
        }
        const value = this._compiledArrayPatches(patches);
        return new MemoryArrayCompiledWithPatch(value.patch, owner || new MemoryTypeArray(), value.props);
    }
    _getPatches(fromSliceKey, toSliceKey, ID) {
        let ref = this._slices[toSliceKey];
        let type;
        const patches = [];
        while (ref && ref.name !== fromSliceKey) {
            const slice = ref.data;
            const value = slice && slice[ID];
            if (!value) {
                ref = ref.parent;
                continue;
            }
            if (!type) {
                if (value instanceof MemoryTypeArray) {
                    type = 'array';
                }
                else if (value instanceof MemoryTypeSet) {
                    type = 'set';
                }
                else {
                    type = 'object';
                }
            }
            patches.push({
                sliceKey: ref.name,
                value: value,
            });
            ref = ref.parent;
        }
        if (!type) {
            return;
        }
        return {
            patches: patches,
            type: type,
        };
    }
    _aggregateInvalidCaches(from, to) {
        const invalidCache = new Set();
        if (from === to) {
            return invalidCache;
        }
        const ancestorKey = this._getCommonAncestor(from, to);
        const refs = this._getChangesPath(from, to, ancestorKey);
        if (this._sliceKey === ancestorKey) {
            refs.shift();
        }
        while (refs.length) {
            const ref = refs.pop();
            Object.keys(ref.invalidCache).forEach(key => {
                // It was invalid before, it is still invalid now since it wasn't yet read
                invalidCache.add(+key);
            });
        }
        return invalidCache;
    }
    _linkToMemory(proxy) {
        const params = proxy[_const__WEBPACK_IMPORTED_MODULE_0__["memoryProxyPramsKey"]];
        if (params.memory) {
            if (params.memory !== this._memoryWorker) {
                throw new _const__WEBPACK_IMPORTED_MODULE_0__["MemoryError"]('This object is already linked to a other memory');
            }
            return;
        }
        const ID = params.ID;
        params.memory = this._memoryWorker;
        params.linkCallback(this._memoryWorker);
        this._proxies[ID] = proxy;
        if (params.isDiffRoot) {
            this._rootProxies[ID] = true;
        }
        this._currentSlice.ids.add(+ID);
    }
    _remove(sliceKey) {
        const IDs = [];
        let ref = this._slices[sliceKey];
        const index = ref.parent.children.indexOf(ref);
        ref.parent.children.splice(index, 1);
        const refs = [ref];
        while ((ref = refs.pop())) {
            const sliceKey = ref.name;
            ref.children.forEach(ref => refs.push(ref));
            Object.keys(ref.linkedParentOfProxy).forEach(ID => IDs.push(+ID));
            delete this._slices[sliceKey];
        }
        return new Set(IDs);
    }
    _squashInto(fromSliceKey, unitSliceKey, intoSliceKey) {
        const refs = this._slices;
        const fromRref = refs[fromSliceKey];
        const untilRref = refs[unitSliceKey];
        const intoRef = refs[intoSliceKey];
        const references = [];
        let ref = untilRref;
        while (ref) {
            references.push(ref);
            if (ref === fromRref) {
                break;
            }
            ref = ref.parent;
        }
        if (!ref) {
            throw new Error('Can not merge the slices');
        }
        const intoLinkedParentOfProxy = refs[intoSliceKey].linkedParentOfProxy;
        const intoInvalidCache = refs[intoSliceKey].invalidCache;
        const intoSlices = intoRef.data;
        while ((ref = references.pop())) {
            const LinkedParentOfProxy = ref.linkedParentOfProxy;
            Object.keys(LinkedParentOfProxy).forEach(ID => {
                intoLinkedParentOfProxy[ID] = LinkedParentOfProxy[ID].slice();
            });
            Object.keys(ref.invalidCache).forEach(link => {
                intoInvalidCache[link] = true;
            });
            const slice = ref.data;
            Object.keys(slice).forEach(ID => {
                const id = +ID;
                const memoryItem = slice[id];
                if (!intoSlices[id]) {
                    intoSlices[id] = memoryItem;
                    return;
                }
                if (memoryItem instanceof MemoryTypeArray) {
                    const intoItem = intoSlices[id];
                    Object.assign(intoItem.patch, memoryItem.patch);
                    Object.assign(intoItem.props, memoryItem.props);
                }
                else if (memoryItem instanceof MemoryTypeSet) {
                    const intoItem = intoSlices[id];
                    memoryItem.add.forEach(item => {
                        if (!intoItem.delete.has(item)) {
                            intoItem.add.add(item);
                        }
                        else {
                            intoItem.delete.delete(item);
                        }
                    });
                    memoryItem.delete.forEach(item => {
                        if (!intoItem.add.has(item)) {
                            intoItem.delete.add(item);
                        }
                        else {
                            intoItem.add.delete(item);
                        }
                    });
                }
                else {
                    const intoItem = intoSlices[id];
                    Object.assign(intoItem.props, memoryItem.props);
                }
            });
        }
    }
    _autoSnapshot() {
        const refs = [];
        let ref = this._currentSlice;
        while (ref && ref.name) {
            refs.push(ref);
            ref = ref.parent;
        }
        if (refs.length > this._numberOfFlatSlices + this._numberOfSlicePerSnapshot) {
            const fromSliceKey = refs[refs.length - 1].name;
            const unitSliceKey = refs[refs.length - 1 - this._numberOfSlicePerSnapshot].name;
            const newSliceKey = unitSliceKey + '[snapshot from ' + fromSliceKey + ']';
            this.snapshot(fromSliceKey, unitSliceKey, newSliceKey);
        }
    }
}


/***/ }),

/***/ "./packages/core/src/Memory/Versionable.ts":
/*!*************************************************!*\
  !*** ./packages/core/src/Memory/Versionable.ts ***!
  \*************************************************/
/*! exports provided: VersionableID, generateVersionableID, makeVersionable, proxifyVersionable, markNotVersionable, _checkVersionable, _stackedProxify */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VersionableID", function() { return VersionableID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateVersionableID", function() { return generateVersionableID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeVersionable", function() { return makeVersionable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "proxifyVersionable", function() { return proxifyVersionable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "markNotVersionable", function() { return markNotVersionable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_checkVersionable", function() { return _checkVersionable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_stackedProxify", function() { return _stackedProxify; });
/* harmony import */ var _VersionableObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");
/* harmony import */ var _VersionableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");
/* harmony import */ var _VersionableSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VersionableSet */ "./packages/core/src/Memory/VersionableSet.ts");
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./const */ "./packages/core/src/Memory/const.ts");




class VersionableID extends Number {
}
VersionableID.prototype[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyNotVersionableKey"]] = true;
let MemoryID = 0;
function generateVersionableID() {
    return new VersionableID(++MemoryID);
}
// queue of stuff to proxify
const toProxify = new Map();
/**
 * Take an object and return a versionable proxy to this object.
 *
 * @param object
 */
function makeVersionable(object) {
    const params = object[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyPramsKey"]];
    if (params) {
        if (params.object === object) {
            throw new _const__WEBPACK_IMPORTED_MODULE_3__["VersionableAllreadyVersionableError"]();
        }
        if (params && params.verify(object)) {
            return object;
        }
    }
    const proxy = _proxify(object);
    toProxify.forEach((callbacks, torototo) => {
        toProxify.delete(torototo);
        const proxy = _proxify(torototo);
        callbacks.forEach(callback => callback(proxy));
    });
    return proxy;
}
/**
 * Create a proxy from a versionable with given handler.
 *
 * @param versionable
 * @param handler
 */
function proxifyVersionable(versionable, handler) {
    const newProxy = new Proxy(versionable, handler);
    versionable[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyPramsKey"]].proxy = newProxy;
    return newProxy;
}
/**
 * Mark the current object as not versionable in memory.
 * A non versionable object is not linked to the memory. The memory does not
 * take care of the change inside this object, and this object is nerver
 * immutable.
 *
 * @param object
 */
function markNotVersionable(object) {
    object[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyNotVersionableKey"]] = true;
}
/**
 * Throw an error if the given object is not a versionable.
 *
 * @param object
 */
function _checkVersionable(object) {
    if (typeof object !== 'object' ||
        object === null ||
        object[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyNotVersionableKey"]] // this is set by the user
    ) {
        return;
    }
    const params = object[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyPramsKey"]];
    if (params) {
        if (params.object === object) {
            throw new _const__WEBPACK_IMPORTED_MODULE_3__["VersionableAllreadyVersionableError"]();
        }
        if (params.verify(object)) {
            // Already versioned ! (we could have inherited from the `params` of
            // another, already versioned object, but we might not)
            return;
        }
    }
    throw new _const__WEBPACK_IMPORTED_MODULE_3__["NotVersionableError"]();
}
// Recursive proxification is very limited because of callback depth. To
// circumvent this issue, we queue the proxification of children.
function _stackedProxify(customClass, callback) {
    if (!customClass ||
        typeof customClass !== 'object' ||
        customClass[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyNotVersionableKey"]]) {
        callback(customClass);
        return;
    }
    const params = customClass[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyPramsKey"]];
    if (params) {
        callback(params.proxy);
    }
    const callbacks = toProxify.get(customClass) || [];
    toProxify.set(customClass, callbacks);
    callbacks.push(callback);
}
function _proxify(customClass) {
    const params = customClass[_const__WEBPACK_IMPORTED_MODULE_3__["memoryProxyPramsKey"]];
    if (params && params.verify(customClass)) {
        return params.proxy;
    }
    let proxy;
    if (customClass instanceof Set) {
        proxy = Object(_VersionableSet__WEBPACK_IMPORTED_MODULE_2__["_proxifySet"])(customClass);
    }
    else if (customClass instanceof Array) {
        proxy = Object(_VersionableArray__WEBPACK_IMPORTED_MODULE_1__["_proxifyArray"])(customClass);
    }
    else {
        proxy = Object(_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["_proxifyObject"])(customClass);
    }
    return proxy;
}


/***/ }),

/***/ "./packages/core/src/Memory/VersionableArray.ts":
/*!******************************************************!*\
  !*** ./packages/core/src/Memory/VersionableArray.ts ***!
  \******************************************************/
/*! exports provided: _proxifyArray, VersionableArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_proxifyArray", function() { return _proxifyArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VersionableArray", function() { return VersionableArray; });
/* harmony import */ var _Memory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Memory */ "./packages/core/src/Memory/Memory.ts");
/* harmony import */ var _Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./const */ "./packages/core/src/Memory/const.ts");
/* harmony import */ var _VersionableObject__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");




const Undefined = Symbol('jabberwockMemoryUndefined');
const proxyArrayHandler = {
    get(array, prop, proxy) {
        if (typeof prop === 'symbol' || !isNaN(prop)) {
            return array[prop];
        }
        const params = array[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        if (!params.memory) {
            return array[prop];
        }
        switch (prop) {
            case 'indexOf':
                return indexOf.bind(proxy, params);
            case 'includes':
                return includes.bind(proxy, params);
            case 'splice':
                return splice.bind(proxy, params);
            case 'push':
                return array[prop];
            case 'unshift':
                return unshift.bind(proxy, params);
            case 'shift':
                return shift.bind(proxy, params);
            case 'pop':
                return pop.bind(proxy, params);
            case 'forEach':
                return forEach.bind(proxy, params);
            case 'map':
                return map.bind(proxy, params);
            case 'filter':
                return filter.bind(proxy, params);
            default:
                return array[prop];
        }
    },
    set(proxyObject, prop, value, proxy) {
        const params = proxyObject[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        const array = params.object;
        if (typeof prop === 'symbol' ||
            !params.memory ||
            (prop !== 'length' && isNaN(prop))) {
            return _VersionableObject__WEBPACK_IMPORTED_MODULE_3__["proxyObjectHandler"].set(array, prop, value, proxy);
        }
        const index = +prop;
        const memory = params.memory;
        if (memory.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_2__["FrozenError"]();
        }
        const oldValue = array[prop];
        if (oldValue === value || (value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"] && !(prop in array))) {
            // no change
            return true;
        }
        const slice = memory.getSlice();
        let memoryArray = slice[params.ID];
        if (!memoryArray) {
            slice[params.ID] = memoryArray = new params.MemoryType();
        }
        if (slice !== params.syncSlice) {
            // allready sync, the current value (before update) is the previous value
            params.syncSlice = slice;
            params.previousSliceValues = {};
            array.forEach((value, index) => {
                params.previousSliceValues[params.uniqIDs[index]] = value;
            });
        }
        if (prop === 'length') {
            const length = +value;
            for (let index = length; index < array.length; index++) {
                const val = array[index];
                const oldParams = typeof val === 'object' && val[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
                if (oldParams) {
                    memory.deleteSliceProxyParent(oldParams.ID, params.ID, '' + params.uniqIDs[index]);
                }
                const uid = params.uniqIDs[index];
                if (params.previousSliceValues[uid] === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"] ||
                    !(uid in params.previousSliceValues)) {
                    delete memoryArray.patch[uid];
                }
                else {
                    memoryArray.patch[uid] = _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"];
                }
            }
            array.length = length;
            memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
            return true;
        }
        let newParams;
        if (value !== null && typeof value === 'object' && !value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyNotVersionableKey"]]) {
            Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_checkVersionable"])(value);
            memory.linkToMemory(value);
            newParams = value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        }
        array[prop] = value;
        if (oldValue === Undefined) {
            const uid = params.uniqIDs[index];
            if (newParams) {
                memoryArray.patch[uid] = newParams.ID;
                memory.addSliceProxyParent(newParams.ID, params.ID, '' + uid);
            }
            else {
                memoryArray.patch[uid] = value;
            }
            params.map.set(value, uid);
        }
        else {
            const uniqIDs = params.uniqIDs;
            const uid = uniqIDs[index];
            // begin with remove previous
            if (uid) {
                const mapUID = params.map.get(oldValue);
                if (mapUID === uid) {
                    params.map.delete(oldValue);
                    const otherIndex = array.indexOf(oldValue);
                    if (otherIndex !== -1) {
                        params.map.set(oldValue, uniqIDs[otherIndex]);
                    }
                }
                if (params.previousSliceValues[uid] === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"] ||
                    !(uid in params.previousSliceValues)) {
                    delete memoryArray.patch[uid];
                }
                else {
                    memoryArray.patch[uid] = _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"];
                }
                const oldParams = oldValue && typeof oldValue === 'object' && oldValue[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
                if (oldParams) {
                    memory.deleteSliceProxyParent(oldParams.ID, params.ID, '' + uid);
                }
            }
            if (value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]) {
                memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
                return true;
            }
            // and then we add item
            if (!uid && index > uniqIDs.length) {
                // add fake undefined values (don't add undefined in array)
                for (let k = uniqIDs.length; k < index; k++) {
                    const newUniqID = generateUid(params.sequences, uniqIDs[k - 1]);
                    uniqIDs.push(newUniqID);
                    memoryArray.patch[newUniqID] = Undefined;
                }
            }
            const isEnd = index >= uniqIDs.length;
            const nearest = isEnd ? undefined : uniqIDs[index];
            const newUniqID = generateUid(params.sequences, nearest, isEnd);
            uniqIDs[index] = newUniqID;
            if (newParams) {
                memory.addSliceProxyParent(newParams.ID, params.ID, '' + newUniqID);
                memoryArray.patch[newUniqID] = newParams.ID;
            }
            else {
                memoryArray.patch[newUniqID] = value;
            }
            if (!params.map.has(oldValue)) {
                params.map.set(value, newUniqID);
            }
        }
        memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
        return true;
    },
    deleteProperty(obj, prop) {
        // `removedItem` is a marker to notify that there was something here but
        // it got removed
        this.set(obj, prop, _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]);
        delete obj[prop];
        return true;
    },
};
function _proxifyArray(array) {
    const proxyObject = Object(_VersionableObject__WEBPACK_IMPORTED_MODULE_3__["_proxifyObject"])(array);
    const proxy = new Proxy(proxyObject, proxyArrayHandler);
    const params = proxyObject[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
    params.proxy = proxy;
    params.linkCallback = linkVersionable;
    params.MemoryType = _Memory__WEBPACK_IMPORTED_MODULE_0__["MemoryTypeArray"];
    params.map = new Map();
    params.uniqIDs = [];
    params.sequences = [];
    return proxy;
}
function unshift(params, ...items) {
    for (let k = 0, len = items.length; k < len; k++) {
        const item = items[k];
        params.object.unshift(Undefined);
        params.uniqIDs.unshift(generateUid(params.sequences, undefined));
        this[0] = item;
    }
    return params.object.length;
}
function shift(params) {
    const value = params.object[0];
    this['0'] = _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"];
    params.object.shift();
    params.uniqIDs.shift();
    return value;
}
function pop(params) {
    const lastIndex = params.object.length - 1;
    const value = params.object[lastIndex];
    this.length = lastIndex;
    return value;
}
function splice(params, index, nb, ...items) {
    const array = params.object;
    const uniqIDs = params.uniqIDs;
    const len = array.length;
    if (nb === undefined) {
        nb = len - index;
    }
    const value = new array.constructor();
    if (nb > 0) {
        for (let i = 0; i < nb; i++) {
            value.push(array[i + index]);
        }
        for (let i = 0; i < nb; i++) {
            this[(i + index).toString()] = _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"];
        }
        array.splice(index, nb);
        uniqIDs.splice(index, nb);
    }
    for (let key = 0, len = items.length; key < len; key++) {
        const item = items[key];
        const i = key + index;
        array.splice(i, 0, Undefined);
        const nearest = uniqIDs[i - 1];
        uniqIDs.splice(i, 0, generateUid(params.sequences, nearest));
        this[i] = item;
    }
    return value;
}
function forEach(params, callback) {
    const array = params.object;
    for (let index = 0, len = array.length; index < len; index++) {
        callback(array[index], index, this);
    }
}
function map(params, callback) {
    const result = [];
    const array = params.object;
    for (let index = 0, len = array.length; index < len; index++) {
        result.push(callback(array[index], index, this));
    }
    return result;
}
function filter(params, callback) {
    const result = [];
    const array = params.object;
    for (let index = 0, len = array.length; index < len; index++) {
        const value = array[index];
        if (callback(value, index, this)) {
            result.push(value);
        }
    }
    return result;
}
function indexOf(params, item) {
    return params.object.indexOf(item);
}
function includes(params, item) {
    return params.object.includes(item);
}
function proxifySyncArray() {
    // Synchronization function
    // Most methods of the "proxy" will call this synchronization function, even
    // if it is not yet linked to a memory !
    const params = this;
    const memory = params.memory;
    // empties the array
    params.uniqIDs.length = 0;
    params.object.length = 0;
    // Clear props
    const keys = Object.keys(params.object);
    let key;
    while ((key = keys.pop())) {
        delete params.object[key];
    }
    const rawValues = memory.getSliceValue(params.ID);
    if (!rawValues) {
        return;
    }
    const values = Object.assign({}, rawValues.compiledValues, rawValues.newValues.patch);
    const sequences = Object.keys(values);
    sequences.sort();
    proxifySyncArrayItems(memory, sequences, values, params.object, params.uniqIDs);
    const props = Object.assign({}, rawValues.props, rawValues.newValues.props);
    proxifySyncArrayItems(memory, Object.keys(props), props, params.object);
    params.syncSlice = memory.getSlice();
    params.previousSliceValues = rawValues.compiledValues;
    params.sequences = sequences;
    params.map.clear();
    params.object.forEach((item, i) => {
        params.map.set(item, params.uniqIDs[i]);
    });
}
function proxifySyncArrayItems(memory, keys, values, array, uniqIDs) {
    let index = 0;
    for (let k = 0, len = keys.length; k < len; k++) {
        const key = keys[k];
        let value = values[key];
        if (value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]) {
            continue;
        }
        if (value instanceof _Versionable__WEBPACK_IMPORTED_MODULE_1__["VersionableID"]) {
            value = memory.getProxy(value);
        }
        if (uniqIDs) {
            if (value !== Undefined) {
                array[index] = value;
            }
            uniqIDs.push(key);
            index++;
        }
        else {
            array[key] = value;
        }
    }
}
function linkVersionable(memory) {
    const params = this;
    params.memory = memory;
    params.synchronize = proxifySyncArray;
    const slice = memory.getSlice();
    const array = params.object;
    const keys = Object.keys(array);
    const len = keys.length;
    const ID = params.ID;
    if (len === 0) {
        memory.markDirty(ID);
        return;
    }
    const memoryArray = (slice[ID] = new params.MemoryType());
    const props = memoryArray.props;
    const patch = memoryArray.patch;
    const uniqIDs = params.uniqIDs;
    const sequences = params.sequences;
    let arrayIndex = -1;
    for (let k = 0; k < len; k++) {
        const key = keys[k];
        const index = +key;
        const value = array[key];
        const valueParams = value !== null && typeof value === 'object' && value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        if (valueParams) {
            memory.linkToMemory(value);
        }
        if (isNaN(index)) {
            if (valueParams) {
                props[key] = valueParams.ID;
                memory.addSliceProxyParent(valueParams.ID, ID, key);
            }
            else {
                props[key] = value;
            }
        }
        else {
            arrayIndex++;
            while (arrayIndex < index) {
                const newUniqID = generateUid(sequences, undefined, true);
                uniqIDs[arrayIndex] = newUniqID;
                patch[newUniqID] = Undefined;
                arrayIndex++;
            }
            const newUniqID = generateUid(sequences, undefined, true);
            uniqIDs[index] = newUniqID;
            if (valueParams) {
                patch[newUniqID] = valueParams.ID;
                memory.addSliceProxyParent(valueParams.ID, ID, '' + newUniqID);
            }
            else {
                patch[newUniqID] = value;
            }
        }
    }
    params.map.clear();
    array.forEach((item, i) => {
        if (!params.map.has(item)) {
            params.map.set(item, uniqIDs[i]);
        }
    });
    memory.markDirty(ID);
}
// IDs
function allocUid(min, max) {
    const step = 4;
    if (!min && !max) {
        return [128];
    }
    min = min || [];
    max = max || [];
    const res = [];
    let minSeq = 0;
    let maxSeq = max[0];
    for (let index = 0, len = Math.max(min.length, max.length); index < len; index++) {
        minSeq = min[index] | 0;
        maxSeq = index in max ? max[index] : 4096;
        if (minSeq === 4095 && maxSeq === 4096) {
            res.push(minSeq);
        }
        else if (minSeq === maxSeq) {
            res.push(minSeq);
        }
        else if (minSeq === maxSeq - 1 && len > index - 1) {
            res.push(minSeq);
        }
        else {
            break;
        }
    }
    const diff = (maxSeq - minSeq) >> 1;
    if (diff === 0) {
        res.push(min.length ? 128 : 2048);
    }
    else if (minSeq === 0) {
        res.push(maxSeq - Math.min(diff, step));
    }
    else {
        res.push(minSeq + Math.min(diff, step));
    }
    return res;
}
function hexaToSeq(str) {
    const seq = [];
    for (let k = 0, len = str.length; k < len; k += 3) {
        seq.push(parseInt(str.slice(k, k + 3), 16));
    }
    return seq;
}
function SeqToHexa(seq) {
    let str = '';
    const len = seq.length;
    for (let k = 0; k < len; k++) {
        const n = seq[k];
        if (n === 0) {
            str += '000';
        }
        else if (n < 16) {
            str += '00' + n.toString(16);
        }
        else if (n < 256) {
            str += '0' + n.toString(16);
        }
        else {
            str += n.toString(16);
        }
    }
    return str;
}
function generateUid(sortedUniqIDs, min, isEnd) {
    let max;
    if (isEnd) {
        min = sortedUniqIDs[sortedUniqIDs.length - 1];
    }
    else if (min) {
        max = sortedUniqIDs[sortedUniqIDs.indexOf(min) + 1];
    }
    else {
        max = sortedUniqIDs[0];
    }
    const minSeq = min && hexaToSeq(min);
    const maxSeq = max && hexaToSeq(max);
    const newUniqID = SeqToHexa(allocUid(minSeq, maxSeq));
    if (isEnd) {
        sortedUniqIDs.push(newUniqID);
    }
    else {
        const sortedIndex = min ? sortedUniqIDs.indexOf(min) : -1;
        if (sortedIndex === -1) {
            sortedUniqIDs.unshift(newUniqID);
        }
        else {
            sortedUniqIDs.splice(sortedIndex + 1, 0, newUniqID);
        }
    }
    return newUniqID;
}
class VersionableArray extends Array {
    constructor(...items) {
        super(...items);
        return _proxifyArray(this);
    }
}


/***/ }),

/***/ "./packages/core/src/Memory/VersionableObject.ts":
/*!*******************************************************!*\
  !*** ./packages/core/src/Memory/VersionableObject.ts ***!
  \*******************************************************/
/*! exports provided: getPrototypeGettersSetters, proxyObjectHandler, _proxifyObject, proxifySyncObject, VersionableObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPrototypeGettersSetters", function() { return getPrototypeGettersSetters; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "proxyObjectHandler", function() { return proxyObjectHandler; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_proxifyObject", function() { return _proxifyObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "proxifySyncObject", function() { return proxifySyncObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VersionableObject", function() { return VersionableObject; });
/* harmony import */ var _Memory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Memory */ "./packages/core/src/Memory/Memory.ts");
/* harmony import */ var _Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./const */ "./packages/core/src/Memory/const.ts");



const classGettersSetters = new WeakMap();
const rootPrototype = Object.getPrototypeOf({});
function getPrototypeGettersSetters(obj) {
    let gettersSetters = classGettersSetters.get(obj.constructor);
    if (gettersSetters) {
        return gettersSetters;
    }
    gettersSetters = {
        getters: {},
        setters: {},
    };
    classGettersSetters.set(obj.constructor, gettersSetters);
    obj = Object.getPrototypeOf(obj);
    do {
        const descs = Object.getOwnPropertyDescriptors(obj);
        Object.keys(descs).forEach(propName => {
            const desc = descs[propName];
            if (!gettersSetters.getters[propName] && desc.get) {
                gettersSetters.getters[propName] = desc.get;
            }
            if (!gettersSetters.setters[propName] && desc.set) {
                gettersSetters.setters[propName] = desc.set;
            }
        });
    } while ((obj = Object.getPrototypeOf(obj)) && obj !== rootPrototype);
    return gettersSetters;
}
const proxyObjectHandler = {
    set(obj, prop, value, proxy) {
        // Object.assign might try to set the value of the paramsKey. We
        // obviously don't want that. Let it think it succeeded (returning false
        // will throw an error, which is not what we want here.)
        if (prop === _const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]) {
            return true;
        }
        if (prop === _const__WEBPACK_IMPORTED_MODULE_2__["symbolVerify"]) {
            obj[_const__WEBPACK_IMPORTED_MODULE_2__["symbolVerify"]] = value;
            return true;
        }
        const params = obj[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        const memory = params.memory;
        if (!memory && value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]) {
            // "synchronize" the delete
            delete obj[prop];
            return true;
        }
        // if the property is a method of the class or prototype.
        const protoMethod = params.proto.setters[prop];
        if (protoMethod) {
            protoMethod.call(proxy, value);
            return true;
        }
        // if the property is a getter
        const desc = Object.getOwnPropertyDescriptor(obj, prop);
        if (desc === null || desc === void 0 ? void 0 : desc.set) {
            desc.set.call(proxy, value);
            return true;
        }
        Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_checkVersionable"])(value);
        // if not linked to memory
        if (!memory) {
            obj[prop] = value;
            return true;
        }
        if (memory.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_2__["FrozenError"]();
        }
        const oldValue = obj[prop];
        // The value is the same, or we are deleting a value that was not
        // already there in the first place.
        if (oldValue === value || (value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"] && !(prop in obj))) {
            return true;
        }
        const slice = memory.getSlice();
        let memoryObject = slice[params.ID];
        if (!memoryObject) {
            slice[params.ID] = memoryObject = new params.MemoryType();
        }
        const memoryObjectProps = memoryObject.props;
        let memoryItem = value;
        if (value !== null && typeof value === 'object' && !value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyNotVersionableKey"]]) {
            // if object, the stored value needs to be "converted" (see Set)
            memory.linkToMemory(value);
            const newParams = value && value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
            memoryItem = newParams.ID;
            memory.addSliceProxyParent(newParams.ID, params.ID, prop);
        }
        // if the old value was a versionable as well, sever its link to its parent
        const oldParams = oldValue && typeof oldValue === 'object' && oldValue[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        if (oldParams) {
            memory.deleteSliceProxyParent(oldParams.ID, params.ID, prop);
        }
        if (value === _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]) {
            memoryObjectProps[prop] = _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]; // notify that the deletion happened in this slice
            delete obj[prop];
        }
        else {
            memoryObjectProps[prop] = memoryItem;
            obj[prop] = value;
        }
        memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
        return true;
    },
    deleteProperty(obj, prop) {
        // `removedItem` is a marker to notify that there was something here but
        // it got removed
        this.set(obj, prop, _const__WEBPACK_IMPORTED_MODULE_2__["removedItem"]);
        delete obj[prop];
        return true;
    },
};
function _proxifyObject(obj) {
    const proxy = new Proxy(obj, proxyObjectHandler);
    obj[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]] = {
        ID: Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["generateVersionableID"])(),
        linkCallback: linkVersionable,
        synchronize: proxifySyncObject,
        MemoryType: _Memory__WEBPACK_IMPORTED_MODULE_0__["MemoryTypeObject"],
        verify: verify,
        proxy: proxy,
        object: obj,
        proto: getPrototypeGettersSetters(obj),
    };
    const keys = Object.keys(obj);
    for (let k = 0, len = keys.length; k < len; k++) {
        const key = keys[k];
        const value = obj[key];
        Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_stackedProxify"])(value, newValue => {
            if (newValue !== value) {
                obj[key] = newValue;
            }
        });
    }
    return proxy;
}
function verify(proxy) {
    const params = this;
    const obj = params.object;
    proxy[_const__WEBPACK_IMPORTED_MODULE_2__["symbolVerify"]] = true;
    const value = obj[_const__WEBPACK_IMPORTED_MODULE_2__["symbolVerify"]];
    obj[_const__WEBPACK_IMPORTED_MODULE_2__["symbolVerify"]] = false;
    return value;
}
function proxifySyncObject() {
    // Synchronization function
    // Most methods of the "proxy" will call this synchronization function, even
    // if it is not yet linked to a memory !
    const params = this;
    const memory = params.memory;
    const memoryObject = memory.getSliceValue(params.ID);
    const memoryObjectProps = (memoryObject && memoryObject.props) || {};
    // Clear keys that do not exist anymore
    let keys = Object.keys(params.object);
    let key;
    while ((key = keys.pop())) {
        // if the object is not present in this slice or it does not have this key
        if (!(key in memoryObjectProps)) {
            delete params.object[key];
        }
    }
    if (!memoryObject) {
        return;
    }
    // Update values according to what is stored
    keys = Object.keys(memoryObjectProps);
    while ((key = keys.pop())) {
        let value = memoryObjectProps[key];
        if (value instanceof _Versionable__WEBPACK_IMPORTED_MODULE_1__["VersionableID"]) {
            // Convert proxy references to actual proxy
            value = memory.getProxy(value);
        }
        params.object[key] = value;
    }
}
function linkVersionable(memory) {
    const params = this;
    params.memory = memory;
    const slice = params.memory.getSlice();
    const obj = params.object;
    const ID = params.ID;
    const keys = Object.keys(obj);
    if (keys.length) {
        const memoryObjectProps = Object.assign({}, obj);
        let key;
        while ((key = keys.pop())) {
            const value = obj[key];
            // Some of the values in the original object may be versionable and
            // need to be converted
            const valueParams = value !== null && typeof value === 'object' && value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
            if (valueParams) {
                memory.linkToMemory(value);
                memory.addSliceProxyParent(valueParams.ID, ID, key);
                memoryObjectProps[key] = valueParams.ID;
            }
        }
        const memoryObject = new params.MemoryType();
        memoryObject.props = memoryObjectProps;
        slice[ID] = memoryObject; // store the "pure" value in memory
    }
    memory.markDirty(ID);
}
class VersionableObject {
    constructor(obj) {
        if (obj) {
            const keys = Object.keys(obj);
            let key;
            while ((key = keys.pop())) {
                this[key] = obj[key];
            }
        }
        return _proxifyObject(this);
    }
}


/***/ }),

/***/ "./packages/core/src/Memory/VersionableSet.ts":
/*!****************************************************!*\
  !*** ./packages/core/src/Memory/VersionableSet.ts ***!
  \****************************************************/
/*! exports provided: VersionableSet, _proxifySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VersionableSet", function() { return VersionableSet; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_proxifySet", function() { return _proxifySet; });
/* harmony import */ var _Memory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Memory */ "./packages/core/src/Memory/Memory.ts");
/* harmony import */ var _Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./const */ "./packages/core/src/Memory/const.ts");



// People can override the set methods. They will be called from the proxy, but
// sometimes we want to call the true original methods, not the override of the
// user. This is how we do it.
const genericSet = new Set();
const genericSetPrototype = Set.prototype;
function setPrototype(proxy, obj) {
    do {
        // This function loops on the prototypes of the object. This is what
        // stops it.
        // TODO refactor: while !== genericSetPrototype
        if (obj === genericSetPrototype) {
            break;
        }
        const op = Object.getOwnPropertyNames(obj);
        for (let i = 0; i < op.length; i++) {
            const prop = op[i]; // propName
            if (!proxy[prop]) {
                proxy[prop] = obj[prop];
            }
        }
    } while ((obj = Object.getPrototypeOf(obj)));
}
// eslint-disable-next-line @typescript-eslint/no-empty-function
function nothing() { }
class VersionableSet extends Set {
    constructor(params) {
        super();
        let set; // original set (won't be synced, it's just for its method ex: overrides)
        let size = 0;
        if (!params) {
            set = genericSet;
        }
        else if (params instanceof Array) {
            set = genericSet;
            params.forEach(value => {
                size++;
                Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_stackedProxify"])(value, newValue => {
                    set.add.call(this, newValue);
                });
            });
        }
        else {
            if (params instanceof VersionableSet) {
                set = params[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]].object;
            }
            else {
                set = params;
            }
            params.forEach(value => {
                size++;
                Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_stackedProxify"])(value, newValue => {
                    set.add.call(this, newValue);
                });
            });
            setPrototype(this, set);
        }
        this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]] = {
            ID: Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["generateVersionableID"])(),
            linkCallback: linkVersionable,
            synchronize: nothing,
            MemoryType: _Memory__WEBPACK_IMPORTED_MODULE_0__["MemoryTypeSet"],
            verify: (proxy) => proxy === this,
            size: size,
            object: set,
            proxy: this,
        };
    }
    add(item) {
        // For Set specifically, this line will never actually *proxify* per se.
        // It will either work if the item is already proxified, or throw an
        // error if it is not.
        Object(_Versionable__WEBPACK_IMPORTED_MODULE_1__["_checkVersionable"])(item);
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        const memory = params.memory;
        if (memory && memory.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_2__["FrozenError"]();
        }
        const check = this.has(item);
        if (!check) {
            params.object.add.call(this, item);
        }
        if (check || !memory) {
            // Nothing changed. Either the item was already there, or we don't
            // care because we are not linked to memory.
            return this;
        }
        let memoryItem = item;
        if (item !== null && typeof item === 'object' && !item[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyNotVersionableKey"]]) {
            // The item is versionable, great, but it is not versioned yet !
            // This call versions it into the memory.
            memory.linkToMemory(item);
            const itemParams = item[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
            memoryItem = itemParams.ID;
            memory.addSliceProxyParent(itemParams.ID, params.ID, undefined);
        }
        // Get current slice.
        const slice = memory.getSlice();
        let memorySet = slice[params.ID]; // read the pure value stored in memory
        if (!memorySet) {
            slice[params.ID] = memorySet = new _Memory__WEBPACK_IMPORTED_MODULE_0__["MemoryTypeSet"]();
            // Mark the set as being modified in this slice (not necesarilly "dirty")
            memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
        }
        // Update the stored changes for this slice
        memorySet.add.add(memoryItem);
        memorySet.delete.delete(memoryItem);
        return this;
    }
    delete(item) {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        const memory = params.memory;
        if (memory && memory.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_2__["FrozenError"]();
        }
        const check = this.has(item);
        if (check) {
            params.object.delete.call(this, item);
        }
        if (!check || !memory) {
            return check;
        }
        let memoryItem = item;
        const itemParams = item && typeof item === 'object' && item[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        if (itemParams) {
            memoryItem = itemParams.ID;
            memory.deleteSliceProxyParent(itemParams.ID, params.ID, undefined);
        }
        const slice = memory.getSlice();
        let memorySet = slice[params.ID];
        if (!memorySet) {
            slice[params.ID] = memorySet = new _Memory__WEBPACK_IMPORTED_MODULE_0__["MemoryTypeSet"]();
        }
        memorySet.delete.add(memoryItem);
        memorySet.add.delete(memoryItem);
        memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
        return check;
    }
    clear() {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        const memory = params.memory;
        if (memory && memory.isFrozen()) {
            throw new _const__WEBPACK_IMPORTED_MODULE_2__["FrozenError"]();
        }
        if (this.size === 0) {
            return this;
        }
        if (!memory) {
            params.object.clear.call(this);
            return this;
        }
        const slice = memory.getSlice();
        let memorySet = slice[params.ID];
        if (!memorySet) {
            slice[params.ID] = memorySet = new params.MemoryType();
        }
        params.object.forEach.call(this, (item) => {
            const itemParams = item && typeof item === 'object' && item[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
            if (itemParams) {
                item = itemParams.ID;
                memory.deleteSliceProxyParent(itemParams.ID, params.ID, undefined);
            }
            memorySet.delete.add(item);
            memorySet.add.delete(item);
        });
        params.object.clear.call(this);
        memory.markDirty(params.ID); // mark the cache as invalid when change the slide memory
        return this;
    }
    has(item) {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        return params.object.has.call(this, item);
    }
    values() {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        return params.object.values.call(this);
    }
    keys() {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        return params.object.keys.call(this);
    }
    forEach(callback) {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        return params.object.forEach.call(this, callback);
    }
    entries() {
        const params = this[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        return params.object.entries.call(this);
    }
}
function proxifySyncSet() {
    // Synchronization function
    // Most methods of the "proxy" will call this synchronization function, even
    // if it is not yet linked to a memory !
    const params = this;
    const memory = params.memory;
    const object = params.object;
    const proxy = params.proxy;
    // get current object state in memory
    const memorySet = memory.getSliceValue(params.ID);
    // reset all keys (+ explanation of best/worst case scenario)
    object.clear.call(proxy);
    if (!memorySet) {
        return;
    }
    // Update values according to what is stored
    memorySet.forEach(item => {
        if (item instanceof _Versionable__WEBPACK_IMPORTED_MODULE_1__["VersionableID"]) {
            item = memory.getProxy(item);
        }
        object.add.call(proxy, item);
    });
}
// This will be set on the versionable params object and called with the params
// as the value of `this`. It is created here so that it is created only once !
function linkVersionable(memory) {
    const params = this;
    params.memory = memory;
    params.synchronize = proxifySyncSet;
    memory.markDirty(params.ID);
    if (!params.proxy.size) {
        return;
    }
    const slice = memory.getSlice();
    const memorySet = new params.MemoryType();
    slice[params.ID] = memorySet; // store the "pure" value in memory
    params.object.forEach.call(params.proxy, (value) => {
        const valueParams = value !== null && typeof value === 'object' && value[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
        if (valueParams) {
            // If object is versionable then link it to memory as well
            memory.linkToMemory(value);
            memory.addSliceProxyParent(valueParams.ID, params.ID, undefined);
            memorySet.add.add(valueParams.ID);
        }
        else {
            memorySet.add.add(value);
        }
    });
}
function _proxifySet(set) {
    const versionableSet = new VersionableSet(set);
    set[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]] = versionableSet[_const__WEBPACK_IMPORTED_MODULE_2__["memoryProxyPramsKey"]];
    return versionableSet;
}


/***/ }),

/***/ "./packages/core/src/Memory/const.ts":
/*!*******************************************!*\
  !*** ./packages/core/src/Memory/const.ts ***!
  \*******************************************/
/*! exports provided: memoryProxyNotVersionableKey, memoryProxyPramsKey, removedItem, symbolVerify, MemoryError, NotVersionableError, VersionableAllreadyVersionableError, FrozenError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "memoryProxyNotVersionableKey", function() { return memoryProxyNotVersionableKey; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "memoryProxyPramsKey", function() { return memoryProxyPramsKey; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removedItem", function() { return removedItem; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "symbolVerify", function() { return symbolVerify; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryError", function() { return MemoryError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NotVersionableError", function() { return NotVersionableError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VersionableAllreadyVersionableError", function() { return VersionableAllreadyVersionableError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FrozenError", function() { return FrozenError; });
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/src/errors */ "./packages/utils/src/errors.ts");

const memoryProxyNotVersionableKey = Symbol('jabberwockMemoryNotVersionable');
const memoryProxyPramsKey = Symbol('jabberwockMemoryParams');
const removedItem = Symbol('jabberwockMemoryRemovedItem');
const symbolVerify = Symbol('jabberwockMemoryVerify');
/**
 * Creates an instance representing an error that occurs when theyr are any
 * error in the memory feature or with the integration of the memory.
 */
class MemoryError extends _utils_src_errors__WEBPACK_IMPORTED_MODULE_0__["CustomError"] {
    constructor(message, ...params) {
        super(message, ...params);
        this.message = message || 'Jabberwok error in memory feature';
    }
}
class NotVersionableError extends MemoryError {
    constructor() {
        super();
        this.message =
            'You can only link to the memory the instance of VersionableObject, VersionableArray or VersionableSet.' +
                "\nIf that's not possible, then you can also use makeVersionable method on your custom object." +
                '\nIf you do not want to make versionable this object, indicate it using MarkNotVersionable method' +
                '\nPlease read the Jabberwock documentation.';
    }
}
class VersionableAllreadyVersionableError extends MemoryError {
    constructor() {
        super();
        this.message =
            'This object was already update and a proxy was create to be versionable.' +
                '\nPlease use it instead of the source object.';
    }
}
class FrozenError extends MemoryError {
    constructor() {
        super();
        this.message =
            'This memory is frozen and immutable.' +
                '\nYou can not update a memory version who content memory dependencies';
    }
}


/***/ }),

/***/ "./packages/core/src/Mode.ts":
/*!***********************************!*\
  !*** ./packages/core/src/Mode.ts ***!
  \***********************************/
/*! exports provided: RuleProperty, Mode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RuleProperty", function() { return RuleProperty; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Mode", function() { return Mode; });
/* harmony import */ var _ContextManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContextManager */ "./packages/core/src/ContextManager.ts");

/**
 * Properties of a `VNode` that can be modified by a mode.
 */
var RuleProperty;
(function (RuleProperty) {
    RuleProperty["EDITABLE"] = "editable";
    RuleProperty["BREAKABLE"] = "breakable";
    RuleProperty["ALLOW_EMPTY"] = "allowEmpty";
})(RuleProperty || (RuleProperty = {}));
class Mode {
    constructor(mode) {
        this.id = mode.id;
        this.rules = mode.rules;
        // Convert the rules into an object describing them for each property.
        const ruleEntries = {};
        this._entries = this.rules.reduce((accumulator, rule) => {
            for (const property of Object.keys(rule.properties)) {
                const entry = {
                    selector: rule.selector,
                    value: rule.properties[property],
                };
                if (!ruleEntries[property])
                    ruleEntries[property] = [];
                ruleEntries[property].push(entry);
            }
            return accumulator;
        }, ruleEntries);
    }
    /**
     * Return true if this mode defines the given node's property as true. If
     * the mode does not define a value for the given node's property then
     * return true if the actual value of the property on the node itself is
     * true.
     *
     * @param node
     * @param property
     */
    is(node, property) {
        const hierarchy = [node, ...node.ancestors()];
        const entries = this._entries[property] || [];
        const result = _ContextManager__WEBPACK_IMPORTED_MODULE_0__["ContextManager"].getRankedMatches(hierarchy, entries);
        // For each result from a non-cascading rule property, keep only the
        // ones that match the given node, not one of its ancestors.
        const filteredResults = result.filter(r => r.entry.value.cascading || r.matched.some(match => match === node));
        if (filteredResults.length) {
            return filteredResults[0].entry.value.value;
        }
        else {
            return node[property];
        }
    }
}


/***/ }),

/***/ "./packages/core/src/Modifier.ts":
/*!***************************************!*\
  !*** ./packages/core/src/Modifier.ts ***!
  \***************************************/
/*! exports provided: Modifier */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Modifier", function() { return Modifier; });
/* harmony import */ var _Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");

class Modifier extends _Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"] {
    constructor() {
        super(...arguments);
        this.preserve = new _Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"]({
            after: true,
            paragraphBreak: true,
            lineBreak: true,
        });
    }
    get name() {
        return '';
    }
    toString() {
        return this.name;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    applyTo(node) {
        node.modifiers.prepend(this);
    }
    isSameAs(otherModifier) {
        return this === otherModifier;
    }
    clone() {
        return new this.constructor();
    }
}


/***/ }),

/***/ "./packages/core/src/Modifiers.ts":
/*!****************************************!*\
  !*** ./packages/core/src/Modifiers.ts ***!
  \****************************************/
/*! exports provided: Modifiers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Modifiers", function() { return Modifiers; });
/* harmony import */ var _Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");
/* harmony import */ var _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");




class Modifiers extends _Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__["VersionableObject"] {
    constructor(...modifiers) {
        super();
        const clonedModifiers = modifiers.map(mod => {
            return mod instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] ? mod.clone() : mod;
        });
        this.append(...clonedModifiers);
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the length of the array.
     */
    get length() {
        var _a;
        return ((_a = this._contents) === null || _a === void 0 ? void 0 : _a.length) || 0;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new instance of the Modifiers class containing the same
     * modifiers.
     */
    clone() {
        if (this._contents) {
            return new Modifiers(...this._contents);
        }
        else {
            return new Modifiers();
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Append one or more modifiers to the array. If one of the given modifiers
     * is a modifier class constructor, instantiate it.
     *
     * @param modifiers
     */
    append(...modifiers) {
        if (modifiers.length && !this._contents) {
            this._contents = new _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_3__["VersionableArray"]();
        }
        for (const modifier of modifiers) {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                this._contents.push(modifier);
            }
            else {
                this._contents.push(new modifier());
            }
        }
    }
    /**
     * Prepend one or more modifiers to the array. If one of the given modifiers
     * is a modifier class constructor, instantiate it.
     *
     * @param modifiers
     */
    prepend(...modifiers) {
        if (modifiers.length && !this._contents) {
            this._contents = new _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_3__["VersionableArray"]();
        }
        for (const modifier of [...modifiers].reverse()) {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                this._contents.unshift(modifier);
            }
            else {
                this._contents.unshift(new modifier());
            }
        }
    }
    find(modifier) {
        if (!this._contents) {
            return;
        }
        else if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
            // `modifier` is an instance of `Modifier` -> find it in the array.
            return this._contents.find(instance => instance === modifier);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            // `modifier` is a `Modifier` class -> find its first instance in
            // the array.
            return this._contents.find(mod => mod.constructor.name === modifier.name);
        }
        else if (modifier instanceof Function) {
            // `modifier` is a callback -> call `find` natively on the array.
            return this._contents.find(modifier);
        }
    }
    /**
     * Return the first modifier in the array that is an instance of the given
     * modifier class or create one, append it and return it.
     * If the modifier passed is a modifier instance, return it if it was
     * present in the array.
     *
     * @param modifier
     */
    get(modifier) {
        let found = this.find(modifier);
        if (!found && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            found = new modifier();
            this.append(found);
        }
        return found;
    }
    filter(modifier, 
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    thisArg) {
        if (!this._contents) {
            return [];
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            // `modifier` is a `Modifier` class -> return all instances of it in
            // the array.
            return this._contents.filter(m => m instanceof modifier);
        }
        else {
            // `modifier` is a callback -> call `filter` natively on the array.
            return this._contents.filter(modifier, thisArg);
        }
    }
    /**
     * Remove the first modifier in the array that is an instance of the given
     * modifier class. If a modifier instance is given, remove that particuar
     * instance from the array. Return true if a modifier was removed, false
     * otherwise.
     *
     * @param modifier
     */
    remove(modifier) {
        if (!this._contents) {
            return false;
        }
        const modifierIndex = this._contents.findIndex(modifierInstance => {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                return modifierInstance === modifier;
            }
            else {
                return modifierInstance instanceof modifier;
            }
        });
        if (modifierIndex === -1) {
            return false;
        }
        else {
            this._contents.splice(modifierIndex, 1);
            return true;
        }
    }
    /**
     * Replace the first modifier in the array that is an instance of the given
     * modifier class or that matches the particular instance passed with the
     * given modifier instance. If the new modifier passed is a class,
     * instantiate it. If no modifier was found, simply push the new modifier on
     * the array.
     *
     * Return true if a modifier was replaced, false if the modifier was simply
     * added.
     *
     * @param oldModifier
     * @param newModifier
     */
    replace(oldModifier, newModifier) {
        var _a;
        const oldModifierIndex = (_a = this._contents) === null || _a === void 0 ? void 0 : _a.findIndex(modifierInstance => {
            if (oldModifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                return modifierInstance === oldModifier;
            }
            else {
                return modifierInstance instanceof oldModifier;
            }
        });
        if (!this._contents || oldModifierIndex === -1) {
            this.append(newModifier);
            return false;
        }
        else {
            const modifier = newModifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] ? newModifier : new newModifier();
            this._contents[oldModifierIndex] = modifier;
            return true;
        }
    }
    /**
     * Set the given modifiers on this Modifiers instance. Replace the modifiers
     * with same constructor if they exist, otherwise append the modifiers.
     *
     * @param modfiers
     */
    set(...modifiers) {
        for (const modifier of modifiers) {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                this.replace(modifier.constructor, modifier);
            }
            else {
                this.replace(modifier, modifier);
            }
        }
    }
    /**
     * Remove the first modifier in the array that is an instance of the given
     * modifier class or that matches the particular instance passed.
     * If no modifier was found, add the given modifier instead.
     * If the given new modifier is a class, instantiate it.
     *
     * @param modifier
     */
    toggle(modifier) {
        this.remove(modifier) || this.append(modifier);
    }
    /**
     * Return true if the modifiers in this array are the same as the modifiers
     * in the given array (as defined by the `isSameAs` methods of the
     * modifiers).
     *
     * @param otherModifiers
     */
    areSameAs(otherModifiers) {
        var _a;
        const modifiersMap = new Map(((_a = this._contents) === null || _a === void 0 ? void 0 : _a.map(a => [a, otherModifiers.find(b => a.isSameAs(b))])) || []);
        const aModifiers = Array.from(modifiersMap.keys());
        const bModifiers = Array.from(modifiersMap.values());
        const allAinB = aModifiers.every(a => a.isSameAs(modifiersMap.get(a)));
        const allBinA = otherModifiers.every(b => bModifiers.includes(b) || b.isSameAs(this.find(b)));
        return allAinB && allBinA;
    }
    /**
     * Remove all modifiers.
     */
    empty() {
        if (this._contents) {
            this._contents.length = 0;
        }
    }
    /**
     * Proxy for the native `some` method of `Array`, called on `this._contents`.
     *
     * @see Array.some
     * @param callbackfn
     */
    some(callbackfn) {
        var _a;
        return ((_a = this._contents) === null || _a === void 0 ? void 0 : _a.some(callbackfn)) || false;
    }
    /**
     * Proxy for the native `every` method of `Array`, called on `this._contents`.
     *
     * @see Array.every
     * @param callbackfn
     */
    every(callbackfn) {
        return this._contents ? this._contents.every(callbackfn) : true;
    }
    /**
     * Proxy for the native `map` method of `Array`, called on `this._contents`.
     *
     * @see Array.map
     * @param callbackfn
     */
    map(callbackfn) {
        var _a;
        return ((_a = this._contents) === null || _a === void 0 ? void 0 : _a.map(callbackfn)) || [];
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/AbstractNode.ts":
/*!**************************************************!*\
  !*** ./packages/core/src/VNodes/AbstractNode.ts ***!
  \**************************************************/
/*! exports provided: AbstractNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractNode", function() { return AbstractNode; });
/* harmony import */ var _VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _Modifiers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _utils_src_EventMixin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/src/EventMixin */ "./packages/utils/src/EventMixin.ts");
/* harmony import */ var _Memory_Memory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Memory/Memory */ "./packages/core/src/Memory/Memory.ts");





let id = 0;
class AbstractNode extends _utils_src_EventMixin__WEBPACK_IMPORTED_MODULE_3__["EventMixin"] {
    constructor(params) {
        super();
        this.id = id;
        /**
         * True If the node will have a representation in the dom. Eg: markers are
         * not tangible.
         */
        this.tangible = true;
        /**
         * True if the node can be split.
         * Can be overridden with a `Mode`.
         */
        this.breakable = true;
        this.modifiers = new _Modifiers__WEBPACK_IMPORTED_MODULE_2__["Modifiers"]();
        id++;
        if (params === null || params === void 0 ? void 0 : params.modifiers) {
            if (params.modifiers instanceof _Modifiers__WEBPACK_IMPORTED_MODULE_2__["Modifiers"]) {
                this.modifiers = params.modifiers;
            }
            else {
                this.modifiers.append(...params.modifiers);
            }
        }
        Object(_Memory_Memory__WEBPACK_IMPORTED_MODULE_4__["markAsDiffRoot"])(this);
    }
    /**
     * True if the node is editable. Propagates to the children.
     * A node that is editable can have its modifiers edited, be moved, removed,
     * and a selection can be made within it.
     * Can be overridden with a `Mode`.
     */
    get editable() {
        if (this._editable === false)
            return false;
        return (!this.parent ||
            (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["hasContentEditable"])(this.parent)
                ? Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isContentEditable"])(this.parent)
                : this.parent.editable));
    }
    set editable(state) {
        this._editable = state;
    }
    /**
     * Return whether the given predicate is a constructor of a VNode class.
     *
     * @param predicate The predicate to check.
     */
    static isConstructor(predicate) {
        return predicate.prototype instanceof AbstractNode;
    }
    get name() {
        return this.constructor.name;
    }
    /**
     * Return the text content of this node.
     */
    get textContent() {
        return this.children()
            .map(child => child.textContent)
            .join('');
    }
    /**
     * @override
     */
    toString() {
        return this.name;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Transform the given DOM location into its VDocument counterpart.
     *
     * @param domNode DOM node corresponding to this VNode
     * @param offset The offset of the location in the given domNode
     */
    locate(domNode, offset) {
        // Position `BEFORE` is preferred over `AFTER`, unless the offset
        // overflows the children list, in which case `AFTER` is needed.
        let position = _VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
        const domNodeLength = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(domNode);
        if (domNodeLength && offset >= domNodeLength) {
            position = _VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        }
        return [this, position];
    }
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(params) {
        const clone = new this.constructor(params);
        clone.modifiers = this.modifiers.clone();
        return clone;
    }
    /**
     * Replace this VNode with the given VNode.
     *
     * @param node
     */
    replaceWith(node) {
        this.before(node);
        this.mergeWith(node);
    }
    //--------------------------------------------------------------------------
    // Properties
    //--------------------------------------------------------------------------
    /**
     * Return the length of this VNode.
     */
    get length() {
        return this.children().length;
    }
    /**
     * Test this node against the given predicate.
     *
     * If the predicate is falsy, return true. If the predicate is a constructor
     * of a VNode class, return whether this node is an instance of that class.
     * If the predicate is a standard function, return the result of this
     * function when called with the node as parameter.
     *
     *
     * @param predicate The predicate to test this node against.
     */
    test(predicate) {
        if (!predicate) {
            return true;
        }
        else if (AbstractNode.isConstructor(predicate)) {
            return this instanceof predicate;
        }
        else {
            return predicate(this);
        }
    }
    /**
     * Return true if this VNode comes before the given VNode in the pre-order
     * traversal.
     *
     * @param vNode
     */
    isBefore(vNode) {
        const thisPath = [this, ...this.ancestors()];
        const nodePath = [vNode, ...vNode.ancestors()];
        // Find the last distinct ancestors in the path to the root.
        let thisAncestor;
        let nodeAncestor;
        do {
            thisAncestor = thisPath.pop();
            nodeAncestor = nodePath.pop();
        } while (thisAncestor && nodeAncestor && thisAncestor === nodeAncestor);
        if (thisAncestor && nodeAncestor) {
            const thisParent = thisAncestor.parent;
            const nodeParent = nodeAncestor.parent;
            if (thisParent && thisParent === nodeParent) {
                // Compare the indices of both ancestors in their shared parent.
                const thisIndex = thisParent.childVNodes.indexOf(thisAncestor);
                const nodeIndex = nodeParent.childVNodes.indexOf(nodeAncestor);
                return thisIndex < nodeIndex;
            }
            else {
                // The very first ancestor of both nodes are different so
                // they actually come from two different trees altogether.
                return false;
            }
        }
        else {
            // One of the nodes was in the ancestors path of the other.
            return !thisAncestor && !!nodeAncestor;
        }
    }
    /**
     * Return true if this VNode comes after the given VNode in the pre-order
     * traversal.
     *
     * @param vNode
     */
    isAfter(vNode) {
        return vNode.isBefore(this);
    }
    closest(predicate) {
        if (this.test(predicate)) {
            return this;
        }
        else {
            return this.ancestor(predicate);
        }
    }
    ancestor(predicate) {
        let ancestor = this.parent;
        while (ancestor && !ancestor.test(predicate)) {
            ancestor = ancestor.parent;
        }
        return ancestor;
    }
    ancestors(predicate) {
        const ancestors = [];
        let parent = this.parent;
        while (parent) {
            if (parent.test(predicate)) {
                ancestors.push(parent);
            }
            parent = parent.parent;
        }
        return ancestors;
    }
    commonAncestor(node, predicate) {
        if (!this.parent) {
            return;
        }
        else if (this.parent === node.parent && this.parent.test(predicate)) {
            return this.parent;
        }
        const thisPath = [this, ...this.ancestors(predicate)];
        const nodePath = [node, ...node.ancestors(predicate)];
        let commonAncestor;
        while (thisPath[thisPath.length - 1] === nodePath.pop()) {
            commonAncestor = thisPath.pop();
        }
        return commonAncestor;
    }
    siblings(predicate) {
        const siblings = [];
        let sibling = this.previousSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                siblings.unshift(sibling);
            }
            sibling = sibling.previousSibling();
        }
        sibling = this.nextSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                siblings.push(sibling);
            }
            sibling = sibling.nextSibling();
        }
        return siblings;
    }
    adjacents(predicate) {
        const adjacents = [];
        let sibling = this.previousSibling();
        while (sibling && sibling.test(predicate)) {
            adjacents.unshift(sibling);
            sibling = sibling.previousSibling();
        }
        sibling = this.nextSibling();
        while (sibling && sibling.test(predicate)) {
            adjacents.push(sibling);
            sibling = sibling.nextSibling();
        }
        return adjacents;
    }
    previousSibling(predicate) {
        if (!this.parent)
            return;
        const index = this.parent.childVNodes.indexOf(this);
        let sibling = this.parent.childVNodes[index - 1];
        // Skip ignored siblings and those failing the predicate test.
        while (sibling && !(sibling.tangible && sibling.test(predicate))) {
            sibling = sibling.previousSibling();
        }
        return sibling;
    }
    nextSibling(predicate) {
        if (!this.parent)
            return;
        const index = this.parent.childVNodes.indexOf(this);
        let sibling = this.parent.childVNodes[index + 1];
        // Skip ignored siblings and those failing the predicate test.
        while (sibling && !(sibling.tangible && sibling.test(predicate))) {
            sibling = sibling.nextSibling();
        }
        return sibling;
    }
    previous(predicate) {
        let previous = this.previousSibling();
        if (previous) {
            // The previous node is the last leaf of the previous sibling.
            previous = previous.lastLeaf();
        }
        else {
            // If it has no previous sibling then climb up to the parent.
            previous = this.parent;
        }
        while (previous && !previous.test(predicate)) {
            previous = previous.previous();
        }
        return previous;
    }
    next(predicate) {
        // The node after node is its first child.
        let next = this.firstChild();
        if (!next) {
            // If it has no children then it is its next sibling.
            next = this.nextSibling();
        }
        if (!next) {
            // If it has no siblings either then climb up to the closest parent
            // which has a next sibiling.
            let ancestor = this.parent;
            while (ancestor && !ancestor.nextSibling()) {
                ancestor = ancestor.parent;
            }
            next = ancestor && ancestor.nextSibling();
        }
        while (next && !next.test(predicate)) {
            next = next.next();
        }
        return next;
    }
    previousLeaf(predicate) {
        return this.previous((node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_0__["isLeaf"])(node) && node.test(predicate);
        });
    }
    nextLeaf(predicate) {
        return this.next((node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_0__["isLeaf"])(node) && node.test(predicate);
        });
    }
    previousSiblings(predicate) {
        const previousSiblings = [];
        let sibling = this.previousSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                previousSiblings.push(sibling);
            }
            sibling = sibling.previousSibling();
        }
        return previousSiblings;
    }
    nextSiblings(predicate) {
        const nextSiblings = [];
        let sibling = this.nextSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                nextSiblings.push(sibling);
            }
            sibling = sibling.nextSibling();
        }
        return nextSiblings;
    }
    //--------------------------------------------------------------------------
    // Updating
    //--------------------------------------------------------------------------
    /**
     * Insert the given VNode before this VNode.
     *
     * @param node
     */
    before(node) {
        if (!this.parent) {
            throw new Error('Cannot insert a VNode before a VNode with no parent.');
        }
        this.parent.insertBefore(node, this);
    }
    /**
     * Insert the given VNode after this VNode.
     *
     * @param node
     */
    after(node) {
        if (!this.parent) {
            throw new Error('Cannot insert a VNode after a VNode with no parent.');
        }
        this.parent.insertAfter(node, this);
    }
    /**
     * Wrap this node in the given node by inserting the given node at this
     * node's position in its parent and appending this node to the given node.
     *
     * @param node
     */
    wrap(node) {
        this.before(node);
        node.append(this);
    }
    /**
     * Remove this node.
     */
    remove() {
        if (this.parent) {
            this.parent.removeChild(this);
        }
    }
    /**
     * Remove this node in forward direction. (e.g. `Delete` key)
     */
    removeForward() {
        this.remove();
    }
    /**
     * Remove this node in backward direction. (e.g. `Backspace` key)
     */
    removeBackward() {
        this.remove();
    }
    //--------------------------------------------------------------------------
    // Events.
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    async trigger(eventName, args) {
        super.trigger(eventName, args);
        if (this.parent) {
            await this.parent.trigger(eventName, args);
        }
    }
    //--------------------------------------------------------------------------
    // Private.
    //--------------------------------------------------------------------------
    /**
     * Return a convenient string representation of this node and its
     * descendants.
     *
     * @param __repr
     * @param level
     */
    _repr(__repr = '', level = 0) {
        __repr += Array(level * 4 + 1).join(' ') + this.name + ' (' + this.id + ')' + '\n';
        this.childVNodes.forEach(child => {
            __repr = child._repr(__repr, level + 1);
        });
        return __repr;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/AtomicNode.ts":
/*!************************************************!*\
  !*** ./packages/core/src/VNodes/AtomicNode.ts ***!
  \************************************************/
/*! exports provided: AtomicNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AtomicNode", function() { return AtomicNode; });
/* harmony import */ var _AbstractNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/errors */ "./packages/utils/src/errors.ts");


/**
 * This class provides typing overrides for multiple VNode methods which are
 * supposed to take parameters but that are unused in the case of atomic nodes.
 */
/* eslint-disable @typescript-eslint/no-unused-vars */
class AtomicNode extends _AbstractNode__WEBPACK_IMPORTED_MODULE_0__["AbstractNode"] {
    get childVNodes() {
        return [];
    }
    children(predicate) {
        return [];
    }
    /**
     * See {@link AbstractNode.hasChildren}.
     *
     * @return Returns `false` since an atomic node cannot have children.
     */
    hasChildren() {
        return false;
    }
    /**
     * See {@link AbstractNode.nthChild}.
     *
     * @return Returns `undefined` since an atomic node cannot have children.
     */
    nthChild(n) {
        return undefined;
    }
    firstChild(predicate) {
        return undefined;
    }
    lastChild(predicate) {
        return undefined;
    }
    firstLeaf(predicate) {
        return this;
    }
    lastLeaf(predicate) {
        return this;
    }
    firstDescendant(predicate) {
        return undefined;
    }
    lastDescendant(predicate) {
        return undefined;
    }
    descendants(predicate) {
        return [];
    }
    //--------------------------------------------------------------------------
    // Updating children.
    //--------------------------------------------------------------------------
    /**
     * See {@link AbstractNode.prepend}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    prepend(...children) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.prepend}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    append(...children) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
   /**
     * See {@link AbstractNode.insertBefore}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    insertBefore(node, reference) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.insertAfter}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    insertAfter(node, reference) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.empty}.
     */
    empty() {
        return;
    }
    /**
     * See {@link AbstractNode.removeChild}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    removeChild(child) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.splitAt}.
     *
     * @throws AtomicityError An atomic node cannot be split.
     */
    splitAt(child) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.mergeWith}.
     */
    mergeWith(newContainer) {
        return;
    }
    /**
     * See {@link AbstractNode.unwrap}.
     */
    unwrap() {
        return;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/ContainerNode.ts":
/*!***************************************************!*\
  !*** ./packages/core/src/VNodes/ContainerNode.ts ***!
  \***************************************************/
/*! exports provided: ContainerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContainerNode", function() { return ContainerNode; });
/* harmony import */ var _AbstractNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/src/errors */ "./packages/utils/src/errors.ts");
/* harmony import */ var _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");




class ContainerNode extends _AbstractNode__WEBPACK_IMPORTED_MODULE_0__["AbstractNode"] {
    constructor() {
        super(...arguments);
        this.childVNodes = new _Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_3__["VersionableArray"]();
    }
    children(predicate) {
        const children = [];
        this.childVNodes.forEach(child => {
            if (child.tangible && (!predicate || child.test(predicate))) {
                children.push(child);
            }
        });
        return children;
    }
    /**
     * See {@link AbstractNode.hasChildren}.
     */
    hasChildren() {
        return !!this.childVNodes.find(child => child.tangible);
    }
    /**
     * See {@link AbstractNode.nthChild}.
     */
    nthChild(n) {
        return this.children()[n - 1];
    }
    firstChild(predicate) {
        let child = this.childVNodes[0];
        while (child && !(child.tangible && (!predicate || child.test(predicate)))) {
            child = child.nextSibling();
        }
        return child;
    }
    lastChild(predicate) {
        let child = this.childVNodes[this.childVNodes.length - 1];
        while (child && !(child.tangible && (!predicate || child.test(predicate)))) {
            child = child.previousSibling();
        }
        return child;
    }
    firstLeaf(predicate) {
        const isValidLeaf = (node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_1__["isLeaf"])(node) && (!predicate || node.test(predicate));
        };
        if (isValidLeaf(this)) {
            return this;
        }
        else {
            return this.firstDescendant((node) => isValidLeaf(node));
        }
    }
    lastLeaf(predicate) {
        const isValidLeaf = (node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_1__["isLeaf"])(node) && (!predicate || node.test(predicate));
        };
        if (isValidLeaf(this)) {
            return this;
        }
        else {
            return this.lastDescendant((node) => isValidLeaf(node));
        }
    }
    firstDescendant(predicate) {
        let firstDescendant = this.firstChild();
        while (firstDescendant && predicate && !firstDescendant.test(predicate)) {
            firstDescendant = this._descendantAfter(firstDescendant);
        }
        return firstDescendant;
    }
    lastDescendant(predicate) {
        let lastDescendant = this.lastChild();
        while (lastDescendant && lastDescendant.hasChildren()) {
            lastDescendant = lastDescendant.lastChild();
        }
        while (lastDescendant && predicate && !lastDescendant.test(predicate)) {
            lastDescendant = this._descendantBefore(lastDescendant);
        }
        return lastDescendant;
    }
    descendants(predicate) {
        const descendants = [];
        const stack = [...this.childVNodes];
        while (stack.length) {
            const node = stack.shift();
            if (node.tangible && (!predicate || node.test(predicate))) {
                descendants.push(node);
            }
            if (node instanceof ContainerNode) {
                stack.unshift(...node.childVNodes);
            }
        }
        return descendants;
    }
    //--------------------------------------------------------------------------
    // Updating
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(deepClone, params) {
        const clone = super.clone(params);
        if (deepClone) {
            for (const child of this.childVNodes) {
                clone.append(child.clone(true));
            }
        }
        return clone;
    }
    /**
     * See {@link AbstractNode.prepend}.
     */
    prepend(...children) {
        for (const child of children) {
            this._insertAtIndex(child, 0);
        }
        if (children.find(child => child.tangible)) {
            this.trigger('childList');
        }
    }
    /**
     * See {@link AbstractNode.append}.
     */
    append(...children) {
        for (const child of children) {
            this._insertAtIndex(child, this.childVNodes.length);
        }
        if (children.find(child => child.tangible)) {
            this.trigger('childList');
        }
    }
    /**
     * See {@link AbstractNode.insertBefore}.
     */
    insertBefore(node, reference) {
        const index = this.childVNodes.indexOf(reference);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, node);
        }
        this._insertAtIndex(node, index);
        if (node.tangible) {
            this.trigger('childList');
        }
    }
    /**
     * See {@link AbstractNode.insertAfter}.
     */
    insertAfter(node, reference) {
        const index = this.childVNodes.indexOf(reference);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, node);
        }
        this._insertAtIndex(node, index + 1);
        if (node.tangible) {
            this.trigger('childList');
        }
    }
    /**
     * See {@link AbstractNode.empty}.
     */
    empty() {
        for (const child of [...this.childVNodes]) {
            child.remove();
        }
    }
    /**
     * See {@link AbstractNode.removeChild}.
     */
    removeChild(child) {
        const index = this.childVNodes.indexOf(child);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, child);
        }
        this._removeAtIndex(index);
    }
    /**
     * See {@link AbstractNode.splitAt}.
     */
    splitAt(child) {
        if (child.parent !== this) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, child);
        }
        const duplicate = this.clone();
        const index = this.childVNodes.indexOf(child);
        const children = this.childVNodes.splice(index);
        duplicate.childVNodes.push(...children);
        for (const child of children) {
            child.parent = duplicate;
        }
        this.after(duplicate);
        return duplicate;
    }
    /**
     * See {@link AbstractNode.mergeWith}.
     */
    mergeWith(newContainer) {
        if (newContainer !== this) {
            if (newContainer.childVNodes.includes(this)) {
                for (const child of this.childVNodes.slice()) {
                    newContainer.insertBefore(child, this);
                }
            }
            else {
                newContainer.append(...this.childVNodes);
            }
            this.remove();
        }
    }
    /**
     * See {@link AbstractNode.unwrap}.
     */
    unwrap() {
        for (const child of this.childVNodes.slice()) {
            this.before(child);
        }
        this.remove();
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return the descendant of this node that directly precedes the given node
     * in depth-first pre-order traversal.
     *
     * @param node
     */
    _descendantBefore(node) {
        let previous = node.previousSibling();
        if (previous) {
            // The node before node is the last leaf of its previous sibling.
            previous = previous.lastLeaf();
        }
        else if (node.parent !== this) {
            // If it has no previous sibling then climb up to the parent.
            // This is similar to `previous` but can't go further than `this`.
            previous = node.parent;
        }
        return previous;
    }
    /**
     * Return the descendant of this node that directly follows the given node
     * in depth-first pre-order traversal.
     *
     * @param node
     */
    _descendantAfter(node) {
        // The node after node is its first child.
        let next = node.firstChild();
        if (!next) {
            // If it has no children then it is its next sibling.
            next = node.nextSibling();
        }
        if (!next) {
            // If it has no siblings either then climb up to the closest parent
            // which has a next sibiling.
            // This is similar to `next` but can't go further than `this`.
            let ancestor = node.parent;
            while (ancestor !== this && !ancestor.nextSibling()) {
                ancestor = ancestor.parent;
            }
            if (ancestor !== this) {
                next = ancestor.nextSibling();
            }
        }
        return next;
    }
    /**
     * Insert a VNode at the given index within this VNode's children.
     *
     * @param child
     * @param index The index at which the insertion must take place within this
     * VNode's parent, holding marker nodes into account.
     */
    _insertAtIndex(child, index) {
        if (child.parent) {
            const currentIndex = child.parent.childVNodes.indexOf(child);
            if (index && child.parent === this && currentIndex < index) {
                index--;
            }
            child.parent.removeChild(child);
        }
        this.childVNodes.splice(index, 0, child);
        child.parent = this;
    }
    /**
     * Remove the nth child from this node.
     *
     * @param index The index of the child to remove including marker nodes.
     */
    _removeAtIndex(index) {
        const child = this.childVNodes.splice(index, 1)[0];
        if (child.tangible) {
            this.trigger('childList');
        }
        child.parent = undefined;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/FragmentNode.ts":
/*!**************************************************!*\
  !*** ./packages/core/src/VNodes/FragmentNode.ts ***!
  \**************************************************/
/*! exports provided: FragmentNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FragmentNode", function() { return FragmentNode; });
/* harmony import */ var _ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class FragmentNode extends _ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor() {
        super(...arguments);
        this.editable = false;
        this.breakable = false;
    }
    set parent(parent) {
        this.mergeWith(parent);
        parent.removeChild(this);
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/MarkerNode.ts":
/*!************************************************!*\
  !*** ./packages/core/src/VNodes/MarkerNode.ts ***!
  \************************************************/
/*! exports provided: MarkerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MarkerNode", function() { return MarkerNode; });
/* harmony import */ var _AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class MarkerNode extends _AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor() {
        super(...arguments);
        this.editable = false;
        this.tangible = false;
    }
}
MarkerNode.atomic = true;


/***/ }),

/***/ "./packages/core/src/VNodes/SeparatorNode.ts":
/*!***************************************************!*\
  !*** ./packages/core/src/VNodes/SeparatorNode.ts ***!
  \***************************************************/
/*! exports provided: SeparatorNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SeparatorNode", function() { return SeparatorNode; });
/* harmony import */ var _AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

/**
 * This class represents an atomic node that is used as a content separator.
 */
class SeparatorNode extends _AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
}


/***/ }),

/***/ "./packages/core/src/VNodes/VElement.ts":
/*!**********************************************!*\
  !*** ./packages/core/src/VNodes/VElement.ts ***!
  \**********************************************/
/*! exports provided: VElement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VElement", function() { return VElement; });
/* harmony import */ var _ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class VElement extends _ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super();
        this.htmlTag = params.htmlTag;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(deepClone, params) {
        const defaults = {
            htmlTag: this.htmlTag,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/VNode.ts":
/*!*******************************************!*\
  !*** ./packages/core/src/VNodes/VNode.ts ***!
  \*******************************************/
/*! exports provided: RelativePosition, isLeaf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RelativePosition", function() { return RelativePosition; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isLeaf", function() { return isLeaf; });
var RelativePosition;
(function (RelativePosition) {
    RelativePosition["BEFORE"] = "BEFORE";
    RelativePosition["AFTER"] = "AFTER";
    RelativePosition["INSIDE"] = "INSIDE";
})(RelativePosition || (RelativePosition = {}));
/**
 * Return true if the given node is a leaf in the VDocument, that is a node that
 * has no children.
 *
 * @param node node to check
 */
function isLeaf(node) {
    return !node.hasChildren();
}


/***/ }),

/***/ "./packages/core/src/VRange.ts":
/*!*************************************!*\
  !*** ./packages/core/src/VRange.ts ***!
  \*************************************/
/*! exports provided: VRange */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VRange", function() { return VRange; });
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/MarkerNode */ "./packages/core/src/VNodes/MarkerNode.ts");
/* harmony import */ var _VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VNodes/FragmentNode */ "./packages/core/src/VNodes/FragmentNode.ts");
/* harmony import */ var _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _plugin_table_src_TableCellNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-table/src/TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _Mode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Mode */ "./packages/core/src/Mode.ts");







class VRange {
    constructor(editor, boundaryPoints, _mode) {
        this.editor = editor;
        this._mode = _mode;
        this.start = new _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__["MarkerNode"]();
        this.end = new _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__["MarkerNode"]();
        // If a range context is given, adapt this range to match it.
        if (boundaryPoints) {
            const [start, end] = boundaryPoints;
            const [startNode, startPosition] = start;
            const [endNode, endPosition] = end;
            if (endPosition === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
                this.setEnd(endNode, endPosition);
                this.setStart(startNode, startPosition);
            }
            else {
                this.setStart(startNode, startPosition);
                this.setEnd(endNode, endPosition);
            }
        }
    }
    /**
     * Return the context of a collapsed range at the given location, targetting
     * a reference VNode and specifying the position relative to that VNode.
     *
     * @param reference
     * @param position
     */
    static at(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
        return VRange.selecting(reference, position, reference, position);
    }
    /**
     * Return the context of a range at the location of the given range.
     *
     * @param range
     */
    static clone(range) {
        return [
            [range.start, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE],
            [range.end, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER],
        ];
    }
    static selecting(startNode, startPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE, endNode = startNode, endPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
        if (startPosition instanceof _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_4__["AbstractNode"]) {
            endNode = startPosition;
            startPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
        }
        return [
            [startNode, startPosition],
            [endNode, endPosition],
        ];
    }
    get mode() {
        return this._mode || this.editor.mode;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    get startContainer() {
        return this.start.parent;
    }
    get endContainer() {
        return this.end.parent;
    }
    /**
     * Return true if the range is collapsed.
     */
    isCollapsed() {
        if (!this.startContainer || !this.endContainer)
            return;
        const childVNodes = this.start.parent.childVNodes;
        let index = childVNodes.indexOf(this.end);
        while (index > 0) {
            index--;
            const sibling = childVNodes[index];
            if (sibling === this.start) {
                return true;
            }
            if (sibling.tangible) {
                break;
            }
        }
        return false;
    }
    /**
     * Return true if the start or end of the range is contained within the
     * given container.
     *
     * @param container
     */
    isIn(container) {
        let startAncestor = this.start;
        let endAncestor = this.end;
        while (startAncestor || endAncestor) {
            if (startAncestor === container || endAncestor === container) {
                return true;
            }
            startAncestor = startAncestor === null || startAncestor === void 0 ? void 0 : startAncestor.parent;
            endAncestor = endAncestor === null || endAncestor === void 0 ? void 0 : endAncestor.parent;
        }
        return false;
    }
    selectedNodes(predicate) {
        const selectedNodes = [];
        let node = this.start;
        const bound = this.end.next();
        const endContainers = this.end.ancestors();
        while ((node = node.next()) && node !== bound) {
            if (!endContainers.includes(node) &&
                !(node instanceof _VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__["FragmentNode"]) &&
                this.mode.is(node, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) && (node === null || node === void 0 ? void 0 : node.test(predicate))) {
                selectedNodes.push(node);
            }
        }
        const alreadyTested = new Set();
        for (const selectedNode of selectedNodes) {
            // Find the next ancestor whose children are all selected
            // and add it to the list.
            // TODO: Ideally, selected nodes should be returned in DFS order.
            const ancestor = selectedNode.parent;
            if (ancestor && !alreadyTested.has(ancestor)) {
                alreadyTested.add(ancestor);
                const allChildrenSelected = ancestor
                    .children()
                    .every(child => selectedNodes.includes(child));
                if (allChildrenSelected &&
                    !selectedNodes.includes(ancestor) &&
                    !(ancestor instanceof _VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__["FragmentNode"]) &&
                    this.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) &&
                    ancestor.test(predicate)) {
                    selectedNodes.push(ancestor);
                }
            }
        }
        return selectedNodes;
    }
    targetedNodes(predicate) {
        const targetedNodes = this.traversedNodes(predicate);
        if (!this.end.previousSibling() &&
            targetedNodes.length &&
            targetedNodes[targetedNodes.length - 1] === this.endContainer) {
            // When selecting a container and the space between it and the next
            // one (eg. triple click), don't return the next container as well.
            targetedNodes.pop();
        }
        const closestStartAncestor = this.start.ancestor(predicate);
        if (closestStartAncestor && this.mode.is(closestStartAncestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE)) {
            targetedNodes.unshift(closestStartAncestor);
        }
        else if (closestStartAncestor) {
            const children = [...closestStartAncestor.childVNodes].reverse();
            for (const child of children) {
                if (!targetedNodes.includes(child) &&
                    this.mode.is(child, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) &&
                    child.test(predicate)) {
                    targetedNodes.unshift(child);
                }
            }
        }
        return targetedNodes;
    }
    traversedNodes(predicate) {
        const traversedNodes = [];
        let node = this.start;
        const bound = this.end.next();
        while ((node = node.next()) && node !== bound) {
            if (this.mode.is(node, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) && node.test(predicate)) {
                traversedNodes.push(node);
            }
        }
        return traversedNodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Collapse the range.
     *
     * @param [edge] range edge on which to collapse
     */
    collapse(edge = this.start) {
        if (edge === this.start) {
            this.setEnd(edge);
        }
        else if (edge === this.end) {
            this.setStart(edge);
        }
    }
    /**
     * Set the range's start point (in traversal order) at the given location,
     * targetting a `reference` VNode and specifying the `position` in reference
     * to that VNode ('BEFORE', 'AFTER'), like in an `xpath.
     *
     * @param reference
     * @param [position]
     */
    setStart(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
        if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
            reference = reference.firstLeaf();
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
            reference = reference.lastLeaf();
        }
        if (reference instanceof _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"] && !reference.hasChildren()) {
            reference.prepend(this.start);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER && reference !== this.end) {
            // We check that `reference` isn't `this.end` to avoid a backward
            // collapsed range.
            reference.after(this.start);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
            reference.append(this.start);
        }
        else {
            reference.before(this.start);
        }
    }
    /**
     * Set the range's end point (in traversal order) at the given location,
     * targetting a `reference` VNode and specifying the `position` in reference
     * to that VNode ('BEFORE', 'AFTER'), like in an `xpath.
     *
     * @param reference
     * @param [position]
     */
    setEnd(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
        if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
            reference = reference.firstLeaf();
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
            reference = reference.lastLeaf();
        }
        if (reference instanceof _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"] && !reference.hasChildren()) {
            reference.append(this.end);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE && reference !== this.start) {
            // We check that `reference` isn't `this.start` to avoid a backward
            // collapsed range.
            reference.before(this.end);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
            reference.append(this.end);
        }
        else {
            reference.after(this.end);
        }
    }
    /**
     * Extend this range in such a way that it includes the given node.
     *
     * This method moves the boundary marker that is closest to the given node
     * up or down the tree in order to include the given node into the range.
     * Because of that, calling this method will always result in a range that
     * is at least the size that it was prior to calling it, and usually bigger.
     *
     * @param targetNode The node to extend the range to.
     */
    extendTo(targetNode) {
        let position;
        if (targetNode.isBefore(this.start)) {
            targetNode = targetNode.previous();
            if (targetNode.hasChildren()) {
                targetNode = targetNode.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
            }
            if (targetNode && this.end.nextSibling() !== targetNode) {
                this.setStart(targetNode, position);
            }
        }
        else if (targetNode.isAfter(this.end)) {
            if (targetNode.hasChildren()) {
                targetNode = targetNode.next();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
            }
            if (targetNode) {
                this.setEnd(targetNode, position);
            }
        }
    }
    /**
     * Split the range containers up to their common ancestor. Return all
     * children of the common ancestor that are targeted by the range after the
     * split. If a predicate is given, splitting continues up to and including
     * the node closest to the common ancestor that matches the predicate.
     *
     * @param predicate
     */
    split(predicate) {
        const ancestor = this.startContainer.commonAncestor(this.endContainer);
        const closest = ancestor.closest(predicate);
        const container = closest ? closest.parent : ancestor;
        // Split the start ancestors.
        let start = this.start;
        do {
            let startAncestor = start.parent;
            // Do not split at the start edge of a node.
            if (start.previousSibling() && this.mode.is(startAncestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE)) {
                startAncestor = startAncestor.splitAt(start);
            }
            start = startAncestor;
        } while (start.parent !== container);
        // Split the end ancestors.
        let end = this.end;
        do {
            const endAncestor = end.parent;
            // Do not split at the end edge of a node.
            if (end.nextSibling() && this.mode.is(endAncestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE)) {
                endAncestor.splitAt(end);
                endAncestor.append(end);
            }
            end = endAncestor;
        } while (end.parent !== container);
        // Return all top-most split nodes between and including start and end.
        const nodes = [];
        let node = start;
        while (node !== end) {
            nodes.push(node);
            node = node.nextSibling();
        }
        nodes.push(end);
        return nodes;
    }
    /**
     * Empty the range by removing selected nodes and collapsing it by merging
     * nodes between start and end.
     */
    empty() {
        const removableNodes = this.selectedNodes(node => {
            // TODO: Replace Table check with complex table selection support.
            return this.mode.is(node, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) && !(node instanceof _plugin_table_src_TableCellNode__WEBPACK_IMPORTED_MODULE_5__["TableCellNode"]);
        });
        // Remove selected nodes without touching the start range's ancestors.
        const startAncestors = this.start.ancestors();
        for (const node of removableNodes.filter(node => !startAncestors.includes(node))) {
            node.remove();
        }
        // Collapse the range by merging nodes between start and end, if it
        // doesn't traverse an unbreakable node.
        if (this.startContainer !== this.endContainer) {
            const commonAncestor = this.start.commonAncestor(this.end);
            let ancestor = this.endContainer.parent;
            while (ancestor && ancestor !== commonAncestor) {
                if (ancestor.children().length > 1 &&
                    this.endContainer.parent === ancestor &&
                    this.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE)) {
                    ancestor.splitAt(this.endContainer);
                }
                if (this.mode.is(this.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE) &&
                    this.mode.is(ancestor, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE) &&
                    this.mode.is(this.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) &&
                    this.mode.is(this.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE)) {
                    this.endContainer.mergeWith(ancestor);
                }
                ancestor = ancestor.parent;
            }
            const traversedUnbreakables = this.traversedNodes(this._isUnbreakable.bind(this));
            const unbreakableStartAncestor = this.start.ancestor(this._isUnbreakable.bind(this));
            if (unbreakableStartAncestor &&
                !this.end.ancestor(node => node === unbreakableStartAncestor)) {
                traversedUnbreakables.unshift(unbreakableStartAncestor);
            }
            if (!traversedUnbreakables.length &&
                this.mode.is(this.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE) &&
                this.mode.is(this.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE) &&
                this.mode.is(this.startContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE) &&
                this.mode.is(this.endContainer, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].EDITABLE)) {
                this.endContainer.mergeWith(this.startContainer);
            }
            this.collapse();
        }
    }
    /**
     * Remove this range from its VDocument.
     */
    remove() {
        this.start.remove();
        this.end.remove();
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given node is unbreakable.
     *
     * @param node
     */
    _isUnbreakable(node) {
        return !this.mode.is(node, _Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE);
    }
}


/***/ }),

/***/ "./packages/core/src/VSelection.ts":
/*!*****************************************!*\
  !*** ./packages/core/src/VSelection.ts ***!
  \*****************************************/
/*! exports provided: ANCHOR_CHAR, FOCUS_CHAR, Direction, VSelection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ANCHOR_CHAR", function() { return ANCHOR_CHAR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FOCUS_CHAR", function() { return FOCUS_CHAR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Direction", function() { return Direction; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VSelection", function() { return VSelection; });
/* harmony import */ var _VRange__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");



const ANCHOR_CHAR = '[';
const FOCUS_CHAR = ']';
var Direction;
(function (Direction) {
    Direction["BACKWARD"] = "BACKWARD";
    Direction["FORWARD"] = "FORWARD";
})(Direction || (Direction = {}));
class VSelection {
    constructor(editor) {
        this.editor = editor;
        this.range = new _VRange__WEBPACK_IMPORTED_MODULE_0__["VRange"](this.editor);
        this._direction = Direction.FORWARD;
    }
    get anchor() {
        return this.direction === Direction.FORWARD ? this.range.start : this.range.end;
    }
    get focus() {
        return this.direction === Direction.FORWARD ? this.range.end : this.range.start;
    }
    get direction() {
        return this._direction;
    }
    isCollapsed() {
        return this.range.isCollapsed();
    }
    /**
     * Update the selection according to the given description.
     *
     * @param selection
     */
    set(selection) {
        this._direction = selection.direction;
        this.select(selection.anchorNode, selection.anchorPosition, selection.focusNode, selection.focusPosition);
    }
    /**
     * Set a collapsed selection at the given location, targetting a `reference`
     * VNode and specifying the `position` in reference to that VNode ('BEFORE',
     * 'AFTER'), like in an `xpath`.
     *
     * @param position
     * @param reference
     */
    setAt(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE) {
        this.setAnchor(reference, position);
        this.collapse();
    }
    select(anchorNode, anchorPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE, focusNode = anchorNode, focusPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
        if (anchorPosition instanceof _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            focusNode = anchorPosition;
            anchorPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
        }
        if (focusPosition === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
            this.setFocus(focusNode, focusPosition);
            this.setAnchor(anchorNode, anchorPosition);
        }
        else {
            this.setAnchor(anchorNode, anchorPosition);
            this.setFocus(focusNode, focusPosition);
        }
    }
    /**
     * Set the anchor of the selection by targetting a `reference` VNode and
     * specifying the `position` in reference to that VNode ('BEFORE', 'AFTER'),
     * like in an `xpath`. If no relative position if given, include the
     * reference node in the selection.
     *
     * @param reference
     * @param [position]
     */
    setAnchor(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE) {
        if (this.direction === Direction.FORWARD) {
            this.range.setStart(reference, position);
        }
        else {
            this.range.setEnd(reference, position);
        }
    }
    /**
     * Set the focus of the selection by targetting a `reference` VNode and
     * specifying the `position` in reference to that VNode ('BEFORE', 'AFTER'),
     * like in an `xpath`. If no relative position if given, include the
     * reference node in the selection.
     *
     * @param reference
     * @param [position]
     */
    setFocus(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
        if (this.direction === Direction.FORWARD) {
            this.range.setEnd(reference, position);
        }
        else {
            this.range.setStart(reference, position);
        }
    }
    /**
     * Extend the selection from its anchor to the given location, targetting a
     * `reference` VNode and specifying the `direction` of the extension.
     *
     * @param reference
     * @param [direction] default: Direction.FORWARD
     */
    extendTo(reference, direction = Direction.FORWARD) {
        let position;
        if (direction === Direction.FORWARD) {
            if (reference.hasChildren()) {
                reference = reference.next();
                reference = reference.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER;
            }
        }
        else {
            reference = reference.previous();
            if (reference.hasChildren()) {
                reference = reference.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER;
            }
        }
        if (reference) {
            this.setFocus(reference, position);
        }
    }
    /**
     * Collapse the selection on its anchor.
     *
     */
    collapse() {
        this.range.collapse(this.anchor);
    }
}


/***/ }),

/***/ "./packages/plugin-align/src/Align.ts":
/*!********************************************!*\
  !*** ./packages/plugin-align/src/Align.ts ***!
  \********************************************/
/*! exports provided: AlignType, Align */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignType", function() { return AlignType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Align", function() { return Align; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");




var AlignType;
(function (AlignType) {
    AlignType["LEFT"] = "left";
    AlignType["CENTER"] = "center";
    AlignType["RIGHT"] = "right";
    AlignType["JUSTIFY"] = "justify";
})(AlignType || (AlignType = {}));
class Align extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            align: {
                handler: this.align.bind(this),
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'Ctrl+Shift+L',
                    commandId: 'align',
                    commandArgs: { type: AlignType.LEFT },
                },
                {
                    pattern: 'Ctrl+Shift+E',
                    commandId: 'align',
                    commandArgs: { type: AlignType.CENTER },
                },
                {
                    pattern: 'Ctrl+Shift+R',
                    commandId: 'align',
                    commandArgs: { type: AlignType.RIGHT },
                },
                {
                    pattern: 'Ctrl+Shift+J',
                    commandId: 'align',
                    commandArgs: { type: AlignType.JUSTIFY },
                },
            ],
            components: [
                {
                    id: 'AlignLeftButton',
                    async render() {
                        return [alignButton(AlignType.LEFT)];
                    },
                },
                {
                    id: 'AlignCenterButton',
                    async render() {
                        return [alignButton(AlignType.CENTER)];
                    },
                },
                {
                    id: 'AlignRightButton',
                    async render() {
                        return [alignButton(AlignType.RIGHT)];
                    },
                },
                {
                    id: 'AlignJustifyButton',
                    async render() {
                        return [alignButton(AlignType.JUSTIFY)];
                    },
                },
            ],
            componentZones: [
                ['AlignLeftButton', ['actionables']],
                ['AlignCenterButton', ['actionables']],
                ['AlignRightButton', ['actionables']],
                ['AlignJustifyButton', ['actionables']],
            ],
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the given node has the given alignment style. If no type
     * is passed, return true if the given node has an alignment style at all.
     *
     * @param node
     * @param [type]
     */
    static isAligned(node, type) {
        var _a;
        const align = (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get('text-align');
        return type ? align === null || align === void 0 ? void 0 : align.includes(type) : !!align;
    }
    /**
     * Align text.
     */
    align(params) {
        var _a, _b;
        const range = params.context.range;
        const nodes = range.targetedNodes();
        const type = params.type;
        for (const node of nodes.filter(node => !nodes.includes(node.parent))) {
            const alignedAncestor = node.closest(Align.isAligned);
            // Compute current alignment.
            const currentAlignment = (_b = (_a = alignedAncestor === null || alignedAncestor === void 0 ? void 0 : alignedAncestor.modifiers) === null || _a === void 0 ? void 0 : _a.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"])) === null || _b === void 0 ? void 0 : _b.style.get('text-align');
            if (!alignedAncestor || currentAlignment !== type) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]).style.set('text-align', type.toLowerCase());
            }
        }
    }
}
Align.dependencies = [];
function alignButton(type) {
    function isAligned(node, type) {
        const alignedAncestor = node.closest(Align.isAligned);
        return Align.isAligned(alignedAncestor || node, type);
    }
    const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_3__["ActionableNode"]({
        name: 'align' + type,
        label: 'Align ' + type,
        commandId: 'align',
        commandArgs: { type: type },
        selected: (editor) => {
            const range = editor.selection.range;
            const ancestor = range.start.closest(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]);
            const startIsAligned = ancestor && isAligned(ancestor, type);
            if (!startIsAligned || range.isCollapsed()) {
                return startIsAligned;
            }
            else {
                const ancestor = range.end.closest(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]);
                return ancestor && isAligned(ancestor, type);
            }
        },
    });
    button.modifiers.append(new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]({
        class: 'fa fa-align-' + type + ' fa-fw',
    }));
    return button;
}


/***/ }),

/***/ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-backgroundcolor/src/BackgroundColor.ts ***!
  \****************************************************************/
/*! exports provided: BackgroundColor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BackgroundColor", function() { return BackgroundColor; });
/* harmony import */ var _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-color/src/Color */ "./packages/plugin-color/src/Color.ts");

class BackgroundColor extends _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__["Color"] {
    constructor() {
        super(...arguments);
        this.styleName = 'background-color';
        this.configuration = Object.assign({ defaultColor: 'white' }, this.configuration);
        this.commands = {
            colorBackground: {
                handler: this.color,
            },
            uncolorBackground: {
                handler: this.uncolor,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'CTRL+H',
                    commandId: 'colorBackground',
                    // TODO: use dialog to get params
                    commandArgs: {
                        color: 'yellow',
                    },
                },
                {
                    pattern: 'CTRL+SHIFT+H',
                    commandId: 'uncolorBackground',
                },
            ],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/Blockquote.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-blockquote/src/Blockquote.ts ***!
  \******************************************************/
/*! exports provided: Blockquote */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Blockquote", function() { return Blockquote; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _BlockquoteXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BlockquoteXmlDomParser */ "./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts");


class Blockquote extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_BlockquoteXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["BlockquoteXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/BlockquoteNode.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-blockquote/src/BlockquoteNode.ts ***!
  \**********************************************************/
/*! exports provided: BlockquoteNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockquoteNode", function() { return BlockquoteNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class BlockquoteNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'BLOCKQUOTE' });
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts ***!
  \******************************************************************/
/*! exports provided: BlockquoteXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockquoteXmlDomParser", function() { return BlockquoteXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _BlockquoteNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BlockquoteNode */ "./packages/plugin-blockquote/src/BlockquoteNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class BlockquoteXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'BLOCKQUOTE';
        };
    }
    async parse(item) {
        const blockquote = new _BlockquoteNode__WEBPACK_IMPORTED_MODULE_2__["BlockquoteNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            blockquote.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        blockquote.append(...nodes);
        return [blockquote];
    }
}
BlockquoteXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-bold/src/Bold.ts":
/*!******************************************!*\
  !*** ./packages/plugin-bold/src/Bold.ts ***!
  \******************************************/
/*! exports provided: Bold */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bold", function() { return Bold; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _BoldFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BoldFormat */ "./packages/plugin-bold/src/BoldFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _BoldXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BoldXmlDomParser */ "./packages/plugin-bold/src/BoldXmlDomParser.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");







class Bold extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_BoldXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["BoldXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+B',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"] },
                },
            ],
            components: [
                {
                    id: 'BoldButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__["ActionableNode"]({
                            name: 'bold',
                            label: 'Toggle bold',
                            commandId: 'toggleFormat',
                            commandArgs: { FormatClass: _BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"] },
                            selected: (editor) => {
                                var _a, _b, _c;
                                const range = editor.selection.range;
                                if (range.isCollapsed()) {
                                    const pluginInline = editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]);
                                    return !!((_a = pluginInline.getCurrentModifiers(range)) === null || _a === void 0 ? void 0 : _a.find(_BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"]));
                                }
                                else {
                                    const startIsFormated = !!((_b = range.start
                                        .nextSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _b === void 0 ? void 0 : _b.modifiers.find(_BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"]));
                                    if (!startIsFormated || range.isCollapsed()) {
                                        return startIsFormated;
                                    }
                                    else {
                                        return !!((_c = range.end
                                            .previousSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _c === void 0 ? void 0 : _c.modifiers.find(_BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"]));
                                    }
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]({ class: 'fa fa-bold fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['BoldButton', ['actionables']]],
        };
    }
}
Bold.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-bold/src/BoldFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-bold/src/BoldFormat.ts ***!
  \************************************************/
/*! exports provided: BoldFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BoldFormat", function() { return BoldFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class BoldFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'B') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-bold/src/BoldXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-bold/src/BoldXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: BoldXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BoldXmlDomParser", function() { return BoldXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _BoldFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BoldFormat */ "./packages/plugin-bold/src/BoldFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class BoldXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'B' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'STRONG');
        };
    }
    /**
     * Parse a bold node.
     *
     * @param item
     */
    async parse(item) {
        const bold = new _BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item));
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            bold.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(bold, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-button/src/Button.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-button/src/Button.ts ***!
  \**********************************************/
/*! exports provided: Button */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Button", function() { return Button; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _ButtonXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ButtonXmlDomParser */ "./packages/plugin-button/src/ButtonXmlDomParser.ts");



class Button extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ButtonXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["ButtonXmlDomParser"]],
        };
    }
}
Button.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]];


/***/ }),

/***/ "./packages/plugin-button/src/ButtonFormat.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-button/src/ButtonFormat.ts ***!
  \****************************************************/
/*! exports provided: ButtonFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ButtonFormat", function() { return ButtonFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");


class ButtonFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super('BUTTON');
        this.preserve = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_1__["VersionableObject"]({
            after: true,
            paragraphBreak: false,
            lineBreak: false,
        });
    }
}


/***/ }),

/***/ "./packages/plugin-button/src/ButtonXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-button/src/ButtonXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ButtonXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ButtonXmlDomParser", function() { return ButtonXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _ButtonFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ButtonFormat */ "./packages/plugin-button/src/ButtonFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class ButtonXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'BUTTON';
        };
    }
    /**
     * Parse a bold node.
     *
     * @param item
     */
    async parse(item) {
        const bold = new _ButtonFormat__WEBPACK_IMPORTED_MODULE_1__["ButtonFormat"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            bold.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(bold, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-char/src/Char.ts":
/*!******************************************!*\
  !*** ./packages/plugin-char/src/Char.ts ***!
  \******************************************/
/*! exports provided: Char */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Char", function() { return Char; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _CharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CharDomObjectRenderer */ "./packages/plugin-char/src/CharDomObjectRenderer.ts");
/* harmony import */ var _CharXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CharXmlDomParser */ "./packages/plugin-char/src/CharXmlDomParser.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");








class Char extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_CharXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["CharXmlDomParser"]],
            renderers: [_CharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__["CharDomObjectRenderer"]],
        };
        this.commands = {
            insertText: {
                handler: this.insertText,
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert text at the current position of the selection.
     *
     * If the selection is collapsed, add `text` to the vDocument and copy the
     * formating of the previous char or the next char.
     *
     * If the selection is not collapsed, replace the text with the formating
     * that was present in the selection.
     *
     * @param params
     */
    insertText(params) {
        const range = params.context.range;
        const text = params.text;
        const inline = this.editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]);
        let modifiers = inline.getCurrentModifiers(range);
        // Ony preserved modifiers are applied at the start of a container.
        if (modifiers && range.isCollapsed()) {
            const previousSibling = range.start.previousSibling();
            const isAfterLineBreak = previousSibling instanceof _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_7__["LineBreakNode"];
            const preservedModifiers = modifiers.filter(mod => {
                if (isAfterLineBreak) {
                    return mod.preserve.lineBreak;
                }
                else if (previousSibling) {
                    return mod.preserve.after;
                }
                else {
                    return mod.preserve.paragraphBreak;
                }
            });
            if (preservedModifiers.length) {
                modifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"](...preservedModifiers);
            }
            else if (!previousSibling) {
                modifiers = null;
            }
        }
        if (params.formats) {
            if (!modifiers) {
                modifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"]();
            }
            modifiers.set(...params.formats.map(format => format.clone()));
        }
        const style = inline.getCurrentStyle(range);
        // Remove the contents of the range if needed.
        if (!range.isCollapsed()) {
            range.empty();
        }
        // Split the text into CHAR nodes and insert them at the range.
        const characters = text.split('');
        const charNodes = characters.map(char => {
            if (modifiers) {
                return new _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]({ char: char, modifiers: modifiers.clone() });
            }
            else {
                return new _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]({ char: char });
            }
        });
        charNodes.forEach(charNode => {
            if (style === null || style === void 0 ? void 0 : style.length) {
                charNode.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]).style = style;
            }
            range.start.before(charNode);
        });
        if (params.select && charNodes.length) {
            this.editor.selection.select(charNodes[0], charNodes[charNodes.length - 1]);
        }
    }
}
Char.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-char/src/CharDomObjectRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-char/src/CharDomObjectRenderer.ts ***!
  \***********************************************************/
/*! exports provided: CharDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharDomObjectRenderer", function() { return CharDomObjectRenderer; });
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");




class CharDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_3__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _CharNode__WEBPACK_IMPORTED_MODULE_0__["CharNode"];
    }
    async render(charNode, worker) {
        return this._renderText([charNode], worker);
    }
    async renderBatch(charNodes, worker) {
        const domObjects = [];
        const domObject = this._renderText(charNodes, worker);
        for (let i = 0; i < charNodes.length; i++)
            domObjects.push(domObject);
        return domObjects;
    }
    _renderText(charNodes, worker) {
        // Create textObject.
        const texts = [];
        for (const charNode of charNodes) {
            // Same text node.
            if (charNode.char === ' ' && texts[texts.length - 1] === ' ') {
                // Browsers don't render consecutive space chars otherwise.
                texts.push('\u00A0');
            }
            else {
                texts.push(charNode.char);
            }
        }
        // Render block edge spaces as non-breakable space (otherwise browsers
        // won't render them).
        const previous = charNodes[0].previousSibling();
        if (!previous || !(previous instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"])) {
            texts[0] = texts[0].replace(/^ /g, '\u00A0');
        }
        const next = charNodes[charNodes.length - 1].nextSibling();
        if (!next || !(next instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"])) {
            texts[texts.length - 1] = texts[texts.length - 1].replace(/^ /g, '\u00A0');
        }
        const textObject = { text: texts.join('') };
        worker.locate(charNodes, textObject);
        return textObject;
    }
}
CharDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-char/src/CharNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-char/src/CharNode.ts ***!
  \**********************************************/
/*! exports provided: CharNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharNode", function() { return CharNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class CharNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
    constructor(params) {
        super(params);
        if (params.char.length !== 1) {
            throw new Error('Cannot make a CharNode out of anything else than a string of length 1.');
        }
        this.char = params.char;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    get name() {
        return this.char;
    }
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     * @override
     */
    clone(params) {
        const defaults = {
            char: this.char,
            modifiers: this.modifiers.clone(),
        };
        return super.clone(Object.assign(Object.assign({}, defaults), params));
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the length of this VNode.
     */
    get length() {
        return 1;
    }
    /**
     * Return the text content of this node.
     *
     * @override
     */
    get textContent() {
        return this.char;
    }
    /**
     * Return true if `a` has the same format properties as `b`.
     *
     * @param a
     * @param b
     */
    isSameTextNode(node) {
        if (node instanceof CharNode) {
            // Char VNodes are the same text node if they have the same
            // modifiers.
            return this.modifiers.areSameAs(node.modifiers);
        }
        else {
            // Nodes that are not valid in a text node must end the text node.
            return false;
        }
    }
}
CharNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-char/src/CharXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-char/src/CharXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: CharXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharXmlDomParser", function() { return CharXmlDomParser; });
/* harmony import */ var _utils_src_formattingSpace__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/formattingSpace */ "./packages/utils/src/formattingSpace.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");




class CharXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item.nodeType === Node.TEXT_NODE;
        };
    }
    async parse(item) {
        const nodes = [];
        const text = Object(_utils_src_formattingSpace__WEBPACK_IMPORTED_MODULE_0__["removeFormattingSpace"])(item);
        for (let i = 0; i < text.length; i++) {
            const char = text.charAt(i);
            let parsedVNode;
            if (char === '\n') {
                parsedVNode = new this.engine.editor.configuration.defaults.Separator();
            }
            else {
                parsedVNode = new _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]({ char: char });
            }
            nodes.push(parsedVNode);
        }
        return nodes;
    }
}
CharXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-code/src/Code.ts":
/*!******************************************!*\
  !*** ./packages/plugin-code/src/Code.ts ***!
  \******************************************/
/*! exports provided: Code */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Code", function() { return Code; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _CodeViewNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CodeViewNode */ "./packages/plugin-code/src/CodeViewNode.ts");
/* harmony import */ var _CodeViewDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CodeViewDomObjectRenderer */ "./packages/plugin-code/src/CodeViewDomObjectRenderer.ts");
/* harmony import */ var _utils_src_configuration__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/src/configuration */ "./packages/utils/src/configuration.ts");
/* harmony import */ var _utils_src_isBlock__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/src/isBlock */ "./packages/utils/src/isBlock.ts");








class Code extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.codeView = new _CodeViewNode__WEBPACK_IMPORTED_MODULE_4__["CodeViewNode"]();
        this.loadables = {
            renderers: [_CodeViewDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["CodeViewDomObjectRenderer"]],
            components: [
                {
                    id: 'CodeButton',
                    render: async () => {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__["ActionableNode"]({
                            name: 'code',
                            label: 'Toggle Code view',
                            commandId: 'toggleCodeView',
                            selected: () => this.active,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]({ class: 'fas fa-code fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'code',
                    render: async () => {
                        return [this.codeView];
                    },
                },
            ],
            componentZones: [['CodeButton', ['actionables']]],
        };
        this.commands = {
            toggleCodeView: {
                handler: this.toggle.bind(this),
            },
        };
        this.active = false;
    }
    async start() {
        await super.start();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    async toggle(params) {
        if (this.active) {
            return this.deactivate(params);
        }
        else {
            return this.activate(params);
        }
    }
    async activate(params) {
        this.active = true;
        const domLayoutEngine = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).engines.dom;
        const editable = domLayoutEngine.components.editable[0];
        // Update the view's contents.
        const domEditable = domLayoutEngine.getDomNodes(editable)[0];
        this.codeView.value = this._formatElementHtml(domEditable).innerHTML.trim() || '';
        // Show the code view and hide the editable.
        await this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).append('code', 'main');
        await params.context.execCommand('hide', { componentId: 'editable' });
    }
    async deactivate(params) {
        this.active = false;
        const domLayoutEngine = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).engines.dom;
        const editable = domLayoutEngine.components.editable[0];
        // Parse the code view into the editable.
        const codeContainer = document.createElement('div');
        codeContainer.innerHTML = domLayoutEngine.getDomNodes(this.codeView)[0].value;
        const newEditable = await Object(_utils_src_configuration__WEBPACK_IMPORTED_MODULE_6__["parseEditable"])(this.editor, codeContainer);
        editable.empty();
        editable.append(...newEditable[0].children());
        // Show the editable and hide the code view.
        await params.context.execCommand('show', { componentId: 'editable' });
        await this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).remove('code', 'main');
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Format an element's inner HTML by recursively adding inner indentation
     * where it is relevant.
     *
     * @param element
     * @param [_level]
     */
    _formatElementHtml(element, _level = 0) {
        element = element.cloneNode(true);
        const indentBefore = new Array(_level + 1).join('    ');
        const indentAfter = new Array(_level).join('    ');
        for (const child of element.children) {
            const isChildBlock = Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_7__["isBlock"])(child);
            if (isChildBlock) {
                element.insertBefore(document.createTextNode('\n' + indentBefore), child);
            }
            this._formatElementHtml(child, _level + 1);
            if (isChildBlock && element.lastElementChild === child) {
                element.appendChild(document.createTextNode('\n' + indentAfter));
            }
        }
        return element;
    }
}


/***/ }),

/***/ "./packages/plugin-code/src/CodeViewDomObjectRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-code/src/CodeViewDomObjectRenderer.ts ***!
  \***************************************************************/
/*! exports provided: CodeViewDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CodeViewDomObjectRenderer", function() { return CodeViewDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _CodeViewNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CodeViewNode */ "./packages/plugin-code/src/CodeViewNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class CodeViewDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _CodeViewNode__WEBPACK_IMPORTED_MODULE_1__["CodeViewNode"];
    }
    async render(codeView) {
        const domCodeView = document.createElement('TEXTAREA');
        domCodeView.value = codeView.value;
        domCodeView.setAttribute('style', [
            'width: 100%',
            'height: 100%',
            'background-color: black',
            'color: white',
            'padding: 5px',
            'font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace;',
        ].join('; '));
        return { dom: [domCodeView] };
    }
}
CodeViewDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-code/src/CodeViewNode.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-code/src/CodeViewNode.ts ***!
  \**************************************************/
/*! exports provided: CodeViewNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CodeViewNode", function() { return CodeViewNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class CodeViewNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor() {
        super(...arguments);
        this.value = '';
    }
}


/***/ }),

/***/ "./packages/plugin-color/src/Color.ts":
/*!********************************************!*\
  !*** ./packages/plugin-color/src/Color.ts ***!
  \********************************************/
/*! exports provided: Color */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Color", function() { return Color; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/CssStyle */ "./packages/plugin-xml/src/CssStyle.ts");







class Color extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    hasColor(color, node) {
        var _a;
        if (color instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            node = color;
        }
        const nodeColor = (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get(this.styleName);
        if (color instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            return !!nodeColor;
        }
        else {
            return nodeColor === color;
        }
    }
    /**
     * Apply the given color to the range.
     *
     * @param params
     */
    color(params) {
        const color = params.color;
        if (params.context.range.isCollapsed()) {
            // Set the style cache.
            const inline = this.dependencies.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]);
            // Convert CssStyle class into a true object for spread operator.
            const currentCache = inline.cache.style ? inline.cache.style.toJSON() : {};
            inline.cache.style = new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__["CssStyle"](Object.assign(Object.assign({}, currentCache), { [this.styleName]: color }));
        }
        else {
            let selectedNodes = params.context.range.selectedNodes();
            selectedNodes = selectedNodes.filter(node => !selectedNodes.includes(node.parent));
            // Color the highest ancestor.
            for (const node of selectedNodes) {
                // Color the highest fully selected format if any.
                const fullySelectedFormats = this._newFormats(node).filter(format => {
                    // This format is started by this node. Now find out if we
                    // end it within the selection.
                    return selectedNodes.includes(this._lastNodeWithFormat(node, format));
                });
                if (fullySelectedFormats.length) {
                    const highestFullFormat = fullySelectedFormats.pop();
                    const pairs = selectedNodes.map(selectedNode => {
                        const format = this._findFormat(selectedNode, highestFullFormat);
                        if (format) {
                            return [this._inheritsColorFrom(selectedNode, color), format];
                        }
                    });
                    for (const pair of pairs) {
                        if (pair === null || pair === void 0 ? void 0 : pair[1]) {
                            // Color the formats.
                            if (pair[0]) {
                                // If the node inherited the color, remove the
                                // inherited color.
                                this._removeColor(pair[0]);
                            }
                            this._applyColor(pair[1], color);
                        }
                    }
                }
                else if (!this._inheritsColorFrom(node, color)) {
                    // Skip if the node already has the right color, through an
                    // ancestor or a format.
                    this._applyColor(node, color);
                }
            }
        }
    }
    /**
     * Remove the current color from the range. If the color was applied to
     * an ancestor, apply the default color to its relevant inline descendants.
     *
     * @param params
     */
    uncolor(params) {
        var _a, _b, _c, _d;
        const range = params.context.range;
        const defaultColor = this.configuration.defaultColor;
        const hasColor = this.hasColor.bind(this);
        if (range.isCollapsed()) {
            const inline = this.dependencies.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]);
            if (range.start.ancestor(hasColor)) {
                // Set the color style cache to the default color.
                if (!inline.cache.style) {
                    inline.cache.style = new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__["CssStyle"]();
                }
                inline.cache.style.set(this.styleName, defaultColor);
            }
            else if (inline.cache.style) {
                // Unset the color style cache.
                inline.cache.style.remove(this.styleName);
            }
        }
        else {
            for (const node of params.context.range.selectedNodes()) {
                const target = this._nodeOrFirstFormat(node);
                const currentColor = (_a = target.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get(this.styleName);
                if (!currentColor || currentColor === defaultColor || node.ancestor(hasColor)) {
                    // Set the color to the default color.
                    target.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.set(this.styleName, defaultColor);
                }
                else {
                    // Remove the color.
                    (_b = target.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _b === void 0 ? void 0 : _b.style.remove(this.styleName);
                }
                // Uncolor the children and their formats as well.
                for (const child of node.children()) {
                    (_c = child.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _c === void 0 ? void 0 : _c.style.remove(this.styleName);
                    if (child instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]) {
                        for (const format of child.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"])) {
                            (_d = format.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _d === void 0 ? void 0 : _d.style.remove(this.styleName);
                        }
                    }
                }
            }
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return the node's first format if any, itself otherwise.
     *
     * @param node
     */
    _nodeOrFirstFormat(node) {
        return node.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"])[0] || node;
    }
    /**
     * Return true if all the children of the given node have the given color.
     *
     * @param node
     * @param color
     */
    _isAllColored(node, color) {
        return node.children().every(child => this.hasColor(color, child));
    }
    /**
     * Return the first format that matches the given format, on the given node.
     *
     * @param node
     * @param format
     */
    _findFormat(node, format) {
        return node.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"]).find(nodeFormat => nodeFormat.isSameAs(format));
    }
    /**
     * Return the last consecutive node to have the given format (assumed to be
     * held by the given node too).
     *
     * @param node
     * @param format
     */
    _lastNodeWithFormat(node, format) {
        let current = node;
        let next = node.nextSibling();
        while (this._findFormat(next, format)) {
            current = next;
            next = current.nextSibling();
        }
        return current;
    }
    /**
     * Return all formats that are started by the given node.
     *
     * @param node
     */
    _newFormats(node) {
        const formats = node.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"]);
        const previous = node.previousSibling();
        // A new format is starting if the previous sibling doesn't have it.
        if (!previous)
            return formats;
        return formats.filter(format => !this._findFormat(previous, format));
    }
    /**
     * If the given node inherits the given color through an ancestor of a
     * format, or if it simply has it itself, return the node or format it
     * inherits it from.
     *
     * @param node
     * @param color
     */
    _inheritsColorFrom(node, color) {
        if (this.hasColor(color, node)) {
            return node;
        }
        const colorAncestor = node.ancestor(this.hasColor.bind(this));
        if (colorAncestor && this.hasColor(color, colorAncestor)) {
            return colorAncestor;
        }
        for (const format of node.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"])) {
            if (this.hasColor(color, format)) {
                return format;
            }
        }
    }
    _applyColor(node, color) {
        node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.set(this.styleName, color);
    }
    _removeColor(node) {
        node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.remove(this.styleName);
    }
}
Color.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]];


/***/ }),

/***/ "./packages/plugin-device-preview/assets/DevicePreview.css":
/*!*****************************************************************!*\
  !*** ./packages/plugin-device-preview/assets/DevicePreview.css ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./DevicePreview.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-device-preview/assets/DevicePreview.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-device-preview/src/DevicePreview.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-device-preview/src/DevicePreview.ts ***!
  \*************************************************************/
/*! exports provided: DevicePreview */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DevicePreview", function() { return DevicePreview; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_theme_src_Theme__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-theme/src/Theme */ "./packages/plugin-theme/src/Theme.ts");
/* harmony import */ var _plugin_iframe_src_Iframe__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-iframe/src/Iframe */ "./packages/plugin-iframe/src/Iframe.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _plugin_theme_src_ThemeNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-theme/src/ThemeNode */ "./packages/plugin-theme/src/ThemeNode.ts");
/* harmony import */ var _assets_DevicePreview_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../assets/DevicePreview.css */ "./packages/plugin-device-preview/assets/DevicePreview.css");
/* harmony import */ var _assets_DevicePreview_css__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_assets_DevicePreview_css__WEBPACK_IMPORTED_MODULE_8__);









class DevicePreview extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, configuration) {
        super(editor, configuration);
        this.loadables = {
            components: [
                {
                    id: 'DevicePreviewButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__["ActionableNode"]({
                            name: 'devicePreview',
                            label: 'Toggle device preview',
                            commandId: 'toggleDevicePreview',
                            selected: (editor) => !!editor.selection.anchor.ancestor(node => node instanceof _plugin_theme_src_ThemeNode__WEBPACK_IMPORTED_MODULE_7__["ThemeNode"] && node.themeName.endsWith('Preview')),
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]({ class: 'fa fa-mobile-alt fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['DevicePreviewButton', ['actionables']]],
        };
        this.commands = {
            toggleDevicePreview: {
                handler: this.toggleDevicePreview,
            },
        };
        if (!this.configuration.getTheme) {
            throw new Error('Please define the getTheme method to configure the DevicePreview plugin.');
        }
        if (!this.configuration.devices) {
            const styleSheets = [];
            for (const style of document.querySelectorAll('style, link')) {
                styleSheets.push(style.outerHTML.replace(style.innerHTML, style.innerHTML.replace(/</, '&lt;').replace(/>/, '&gt;')));
            }
            this.configuration.devices = {
                mobile: {
                    label: 'Mobile preview',
                    head: styleSheets.join(''),
                },
            };
        }
    }
    /**
     * @override
     */
    start() {
        for (const deviceName in this.configuration.devices) {
            const device = this.configuration.devices[deviceName];
            this.dependencies.get(_plugin_theme_src_Theme__WEBPACK_IMPORTED_MODULE_4__["Theme"]).addTheme({
                id: deviceName + 'DevicePreview',
                label: device.label,
                render: async (editor) => {
                    return editor.plugins
                        .get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"])
                        .parse('text/html', '<t-iframe id="jw-device-preview" class="device-preview-' +
                        deviceName +
                        '">' +
                        device.head +
                        '<t-placeholder/></t-iframe>');
                },
            });
        }
        return super.start();
    }
    /**
     * Toggle the device preview.
     *
     * @param params
     */
    async toggleDevicePreview(params) {
        const theme = this.configuration.getTheme(this.editor);
        if (theme) {
            if (params.device) {
                const device = params.device + 'DevicePreview';
                theme.themeName = theme.themeName === device ? 'default' : device;
            }
            else {
                const devices = ['default'].concat(Object.keys(this.configuration.devices).map(device => device + 'DevicePreview'));
                const index = devices.indexOf(theme.themeName) + 1;
                theme.themeName = devices[index] ? devices[index] : 'default';
            }
        }
    }
}
DevicePreview.dependencies = [_plugin_theme_src_Theme__WEBPACK_IMPORTED_MODULE_4__["Theme"], _plugin_iframe_src_Iframe__WEBPACK_IMPORTED_MODULE_5__["Iframe"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_6__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-devtools/assets/DevTools.css":
/*!******************************************************!*\
  !*** ./packages/plugin-devtools/assets/DevTools.css ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./DevTools.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-devtools/assets/DevTools.xml":
/*!******************************************************!*\
  !*** ./packages/plugin-devtools/assets/DevTools.xml ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<templates>\n    <!-- INSPECTOR -->\n    <devtools-panel class=\"inspector\" t-name=\"InspectorComponent\" t-att-class=\"{active: props.isOpen}\"\n        t-on-node-selected=\"selectNode\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane>\n                <mainpane-contents>\n                    <devtools-tree>\n                        <TreeComponent\n                            vNode=\"domEngine.root\"\n                            isRoot=\"true\"\n                            selectedPath=\"getPath(selectedNode)\"\n                            selectedID=\"state.selectedID\"/>\n                    </devtools-tree>\n                </mainpane-contents>\n                <PathComponent\n                    path=\"getPath(selectedNode)\"\n                    selectedID=\"state.selectedID\"/>\n            </devtools-mainpane>\n            <devtools-sidepane>\n                <InfoComponent vNode=\"selectedNode\"/>\n            </devtools-sidepane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- INSPECTOR.Tree -->\n    <devtools-node t-name=\"TreeComponent\"\n        t-att-class=\"{\n            block: props.vNode.length and !props.vNode.char,\n            folded: state.folded,\n            root: props.isRoot,\n            'self-closing': !props.vNode.hasChildren(),\n        }\"\n        tabindex=\"1\"\n        t-on-keydown=\"onKeydown\"\n        t-on-node-selected=\"selectNode\">\n        <t t-if=\"props.isRoot\">\n            <devtools-nodename class=\"selectable-line block\"\n                t-on-click=\"onClickNode\" t-on-dblclick=\"onDblClickNode\"\n                t-att-class=\"{\n                    selected: props.selectedID == props.vNode.id,\n                }\">root</devtools-nodename>\n            <t t-call=\"treeChildren\"/>\n        </t>\n        <t t-else=\"\">\n            <devtools-nodename t-if=\"!props.vNode.tangible\"\n                t-on-click=\"onClickNode\" t-on-dblclick=\"onDblClickNode\"\n                class=\"selectable-line inline marker-node\" t-att-class=\"{\n                    selected: props.selectedID == props.vNode.id,\n                }\">\n                <b><t t-esc=\"repr()\"/></b>\n            </devtools-nodename>\n            <devtools-nodename t-elif=\"props.vNode.char\" t-on-click=\"onClickNode\"\n                t-on-dblclick=\"onDblClickNode\"\n                class=\"selectable-line inline\" t-att-class=\"{\n                    bold: isFormat(props.vNode, 'b'),\n                    italic: isFormat(props.vNode, 'i'),\n                    underline: isFormat(props.vNode, 'u'),\n                    link: isFormat(props.vNode, 'link'),\n                    subscript: isFormat(props.vNode, 'subscript'),\n                    superscript: isFormat(props.vNode, 'superscript'),\n                    selected: props.selectedID == props.vNode.id,\n                }\">\n                <t t-esc=\"repr()\"/>\n            </devtools-nodename>\n            <t t-else=\"\">\n                <devtools-nodename class=\"selectable-line block\" t-on-click=\"onClickNode\"\n                    t-on-dblclick=\"onDblClickNode\"\n                    t-att-class=\"{\n                        bold: isFormat(props.vNode, 'b'),\n                        italic: isFormat(props.vNode, 'i'),\n                        underline: isFormat(props.vNode, 'u'),\n                        link: isFormat(props.vNode, 'link'),\n                        subscript: isFormat(props.vNode, 'subscript'),\n                        superscript: isFormat(props.vNode, 'superscript'),\n                        selected: props.selectedID == props.vNode.id,\n                        'line-break': props.vNode.htmlTag === 'BR',\n                    }\">\n                    <t t-esc=\"repr()\"/>\n                </devtools-nodename>\n                <t t-call=\"treeChildren\"/>\n            </t>\n        </t>\n    </devtools-node>\n\n    <t t-name=\"treeChildren\">\n        <devtools-children>\n            <TreeComponent t-if=\"!state.folded\"\n                t-foreach=\"props.vNode.childVNodes.slice()\" t-as=\"child\"\n                t-key=\"child.id\"\n                vNode=\"child\"\n                selectedPath=\"props.selectedPath\"\n                selectedID=\"props.selectedID\"/>\n        </devtools-children>\n    </t>\n\n    <!-- INSPECTOR.Path -->\n    <devtools-path t-name=\"PathComponent\">\n        <devtools-pathnode t-foreach=\"props.path\" t-as=\"vNode\"\n            t-key=\"vNode.id\"\n            t-att-class=\"{\n                selected: vNode.id == props.selectedID\n            }\"\n            t-on-click=\"selectNode(vNode)\">\n            <t t-esc=\"getNodeRepr(vNode)\"/>\n        </devtools-pathnode>\n    </devtools-path>\n\n    <!-- INSPECTOR.Info -->\n    <devtools-info t-name=\"InfoComponent\">\n        <devtools-navbar>\n            <devtools-button t-on-click=\"openTab('vNode')\" t-att-class=\"{\n                selected: state.currentTab == 'vNode',\n            }\">VNode</devtools-button>\n            <devtools-button t-on-click=\"openTab('selection')\" t-att-class=\"{\n                selected: state.currentTab == 'selection',\n            }\">Selection</devtools-button>\n        </devtools-navbar>\n        <t t-call=\"infoVNode\" t-if=\"state.currentTab == 'vNode'\"/>\n        <t t-call=\"infoSelection\" t-if=\"state.currentTab == 'selection'\"/>\n    </devtools-info>\n\n    <!-- INSPECTOR.Info.vNode -->\n    <t t-name=\"infoVNode\">\n        <devtools-about>\n            <devtools-type><t t-esc=\"className(props.vNode)\"/></devtools-type> <t t-esc=\"props.vNode.name\"/>\n            <t t-if=\"props.vNode.char\">:\n                \"<t t-esc=\"props.vNode.char\"/>\"\n            </t>\n            <devtools-button class=\"logger\" t-on-click=\"logVNode(props.vNode)\">&gt;_</devtools-button>\n            <devtools-id><t t-esc=\"props.vNode.id\"/></devtools-id>\n        </devtools-about>\n        <devtools-properties>\n            <devtools-infotitle> About me</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"aboutMeProps\" t-as=\"propName\" t-key=\"propName_index\">\n                        <devtools-td><t t-esc=\"propName\"/></devtools-td>\n                        <devtools-td><t t-esc=\"propRepr(props.vNode, propName)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td>total length</devtools-td>\n                        <devtools-td><t t-esc=\"totalLength(props.vNode)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td>text content</devtools-td>\n                        <devtools-td><t t-esc=\"props.vNode.textContent\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n            <devtools-infotitle> My Properties</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"nodeProperties(props.vNode)\" t-as=\"prop\" t-key=\"prop_index\">\n                        <devtools-td><t t-esc=\"prop.key\"/></devtools-td>\n                        <devtools-td><t t-esc=\"prop.value\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n            <devtools-infotitle> My Family</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"familyProps\" t-as=\"propName\"\n                    t-key=\"propName_index\">\n                        <devtools-td><t t-esc=\"propName\"/></devtools-td>\n                        <devtools-td t-if=\"propName === 'parent'\" t-on-click=\"selectNode(props.vNode.parent)\">\n                            <t t-esc=\"propRepr(props.vNode, propName)\"/>\n                        </devtools-td>\n                        <devtools-td t-elif=\"propName === 'siblings'\">\n                            <devtools-list>\n                                <devtools-listitem t-if=\"props.vNode.previousSibling()\"\n                                    t-on-click=\"selectNode(props.vNode.previousSibling())\">\n                                    previous: <t t-esc=\"props.vNode.previousSibling().name\"/>\n                                </devtools-listitem>\n                                <devtools-listitem t-else=\"\">previous: none</devtools-listitem>\n                                <devtools-listitem t-if=\"props.vNode.nextSibling()\"\n                                    t-on-click=\"selectNode(props.vNode.nextSibling())\">\n                                    next: <t t-esc=\"props.vNode.nextSibling().name\"/>\n                                </devtools-listitem>\n                                <devtools-listitem t-else=\"\">next: none</devtools-listitem>\n                            </devtools-list>\n                        </devtools-td>\n                        <devtools-td t-elif=\"propName === 'children'\">\n                            <devtools-list t-if=\"props.vNode.childVNodes.length\">\n                                <devtools-listitem t-foreach=\"props.vNode.children()\"\n                                    t-as=\"child\" t-key=\"child.id\"\n                                    t-on-click=\"selectNode(child)\">\n                                    <t t-esc=\"child.name\"/>\n                                </devtools-listitem>\n                            </devtools-list>\n                            <t t-else=\"\">none</t>\n                        </devtools-td>\n                        <devtools-td t-else=\"\"><t t-esc=\"propRepr(props.vNode, propName)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </devtools-properties>\n    </t>\n\n    <!-- INSPECTOR.Info.selection -->\n    <t t-name=\"infoSelection\">\n        <devtools-about>\n            <devtools-type>VSelection</devtools-type> Selection\n        </devtools-about>\n        <devtools-properties>\n            <devtools-infotitle> About me</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr>\n                        <devtools-td>direction</devtools-td>\n                        <devtools-td><t t-esc=\"env.editor.selection.direction\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td><strong class=\"marker-node\">[</strong> anchor</devtools-td>\n                        <devtools-td><t t-esc=\"_repr(env.editor.selection.anchor)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td><strong class=\"marker-node\">]</strong> focus</devtools-td>\n                        <devtools-td><t t-esc=\"_repr(env.editor.selection.focus)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </devtools-properties>\n    </t>\n\n    <devtools-panel t-name=\"CommandsComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <t t-set=\"selectedCommandImplementations\" t-value=\"state.registry[state.selectedCommandIdentifier]\"/>\n            <devtools-mainpane style=\"overflow: hidden\">\n                <devtools-navbar>\n                    <devtools-button t-on-click=\"openTab('queue')\" t-att-class=\"{\n                        selected: state.currentTab == 'queue',\n                    }\">Queue</devtools-button>\n                    <devtools-button t-on-click=\"openTab('registry')\" t-att-class=\"{\n                        selected: state.currentTab == 'registry',\n                    }\">Registry</devtools-button>\n                </devtools-navbar>\n                <mainpane-contents t-if=\"state.currentTab == 'queue'\" style=\"overflow: auto\">\n                    <devtools-table style=\"width: 100%;\">\n                        <devtools-tbody>\n                            <devtools-tr t-foreach=\"Array.from(props.commands.keys()).reverse()\" t-as=\"commandIndex\"\n                                t-key=\"commandIndex_index\" class=\"selectable-line\"\n                                t-att-class=\"{\n                                    selected: state.selectedCommandIndex == commandIndex,\n                                }\"\n                                t-on-click=\"selectCommandByIndex(commandIndex)\">\n                                <devtools-td class=\"numbering\"><t t-esc=\"commandIndex + 1\"/></devtools-td>\n                                <devtools-td><t t-esc=\"props.commands[commandIndex][0]\"/></devtools-td>\n                            </devtools-tr>\n                        </devtools-tbody>\n                    </devtools-table>\n                </mainpane-contents>\n                <mainpane-contents t-elif=\"state.currentTab == 'registry'\" style=\"overflow: auto\">\n                    <devtools-command t-foreach=\"Object.keys(state.registry).sort()\" t-as=\"commandIdentifier\"\n                        t-key=\"record_index\" class=\"selectable-line\"\n                        t-att-class=\"{\n                            selected: state.selectedCommandIdentifier == commandIdentifier,\n                        }\"\n                        t-on-click=\"selectCommand(commandIdentifier)\">\n                        <t t-esc=\"commandIdentifier\"/>\n                    </devtools-command>\n                </mainpane-contents>\n            </devtools-mainpane>\n            <devtools-sidepane>\n                <devtools-info t-if=\"state.currentTab == 'queue'\">\n                    <t t-set=\"selectedCommand\" t-value=\"props.commands[state.selectedCommandIndex]\"/>\n                    <devtools-about t-if=\"selectedCommand\">\n                        <devtools-type>Command</devtools-type> <t t-esc=\"selectedCommand[0]\"/>\n                    </devtools-about>\n                    <devtools-properties t-if=\"selectedCommand\">\n                        <devtools-infotitle>Arguments</devtools-infotitle>\n                        <devtools-properties>\n                            <t t-if=\"selectedCommand\">\n                                <t t-set=\"payload\" t-value=\"selectedCommand[1]\"/>\n                                <t t-call=\"commandArgs\"/>\n                            </t>\n                            <t t-call=\"selectedCommandTable\"/>\n                        </devtools-properties>\n                    </devtools-properties>\n                </devtools-info>\n                <devtools-info t-elif=\"state.currentTab == 'registry'\">\n                    <t t-if=\"state.registry\">\n                        <devtools-about t-if=\"state.selectedCommandIdentifier\">\n                            <devtools-type>Command</devtools-type> <t t-esc=\"state.selectedCommandIdentifier\"/>\n                        </devtools-about>\n                        <devtools-properties t-if=\"state.selectedCommandIdentifier\">\n                            <t t-call=\"selectedCommandTable\"/>\n                        </devtools-properties>\n                    </t>\n                </devtools-info>\n            </devtools-sidepane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <t t-name=\"commandArgs\">\n        <devtools-table t-if=\"payload\">\n            <devtools-tbody>\n                <t t-foreach=\"Object.keys(payload)\" t-as=\"key\" t-key=\"key_index\">\n                    <devtools-tr t-if=\"key !== 'context'\">\n                        <t t-set=\"value\" t-value=\"payload[key]\"/>\n                        <devtools-td>\n                            <t t-esc=\"key\"/>\n                        </devtools-td>\n                        <devtools-td>\n                            <t t-if=\"value and key == 'vSelection'\" t-call=\"payloadVSelection\"/>\n                            <t t-else=\"\"><t t-esc=\"formatPayloadValue(value)\"/></t>\n                        </devtools-td>\n                    </devtools-tr>\n                </t>\n            </devtools-tbody>\n        </devtools-table>\n        <p t-else=\"\">None</p>\n    </t>\n\n    <t t-name=\"payloadVSelection\">\n        <devtools-table>\n            <devtools-tbody>\n                <devtools-tr>\n                    <devtools-td>\n                        direction\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.direction or 'unset'\"/>\n                    </devtools-td>\n                </devtools-tr>\n                <devtools-tr>\n                    <devtools-td>\n                        anchor\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.anchorPosition\"/> <t t-esc=\"value.anchorNode.id\"/> (<t t-esc=\"value.anchorNode.name\"/>)\n                    </devtools-td>\n                </devtools-tr>\n                <devtools-tr>\n                    <devtools-td>\n                        focus\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.focusPosition\"/> <t t-esc=\"value.focusNode.id\"/> (<t t-esc=\"value.focusNode.name\"/>)\n                    </devtools-td>\n                </devtools-tr>\n            </devtools-tbody>\n        </devtools-table>\n    </t>\n\n    <t t-name=\"selectedCommandTable\">\n        <devtools-infotitle>Command definitions</devtools-infotitle>\n        <devtools-table t-if=\"selectedCommandImplementations\">\n            <devtools-tbody>\n                <devtools-tr t-foreach=\"selectedCommandImplementations\"\n                    t-as=\"selectedCommandImplementation\" t-key=\"selectedCommandImplementation_index\"\n                    class=\"selectable-line\"\n                    t-att-class=\"{\n                        selected: state.selectedCommandImplementationIndex == handlerIndex,\n                    }\">\n                    <devtools-td><t t-esc=\"selectedCommandImplementation.handler.name\"/></devtools-td>\n                    <devtools-td><t t-esc=\"selectedCommandImplementation.handler\"/></devtools-td>\n                </devtools-tr>\n            </devtools-tbody>\n        </devtools-table>\n        <p t-else=\"\">None</p>\n        <t t-set=\"mappings\" t-value=\"matchingMappings(state.selectedCommandIdentifier)\"/>\n        <t t-if=\"mappings.length\">\n            <devtools-infotitle>Shortcuts</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"mappings\" t-as=\"mapping\" t-key=\"mapping_index\">\n                        <devtools-td style=\"width: 50%;\"><t t-esc=\"stringifyPattern(mapping.pattern)\"/></devtools-td>\n                        <devtools-td><t t-esc=\"argsRepr(mapping.configuredCommand.commandArgs)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </t>\n    </t>\n\n    <!-- SHORTCUTS -->\n    <devtools-panel t-name=\"ShortcutsComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane style=\"overflow: hidden\">\n                <mainpane-contents style=\"overflow: auto\">\n                    <devtools-table>\n                        <devtools-tr t-foreach=\"mappings\" t-as=\"mapping\" t-key=\"mapping_index\" class=\"selectable-line\">\n                            <devtools-td><t t-esc=\"stringifyPattern(mapping.pattern)\"/></devtools-td>\n                            <devtools-td><t t-esc=\"mapping.configuredCommand.commandId\"/></devtools-td>\n                            <devtools-td><t t-esc=\"argsRepr(mapping.configuredCommand.commandArgs)\"/></devtools-td>\n                        </devtools-tr>\n                    </devtools-table>\n                </mainpane-contents>\n            </devtools-mainpane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- PLUGINS -->\n    <devtools-panel t-name=\"PluginsComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane style=\"overflow: hidden\">\n                <mainpane-contents style=\"overflow: auto\">\n                    <devtools-table>\n                        <devtools-tr t-foreach=\"plugins\" t-as=\"plugin\" t-key=\"plugin_index\" class=\"selectable-line\">\n                            <devtools-td><t t-esc=\"plugin\"/></devtools-td>\n                        </devtools-tr>\n                    </devtools-table>\n                </mainpane-contents>\n            </devtools-mainpane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- MODES -->\n    <devtools-panel t-name=\"ModesComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane style=\"overflow: hidden\">\n                <mainpane-contents style=\"overflow: auto\">\n                    <devtools-table>\n                        <devtools-tr t-foreach=\"Object.values(modes)\"\n                            t-as=\"mode\" t-key=\"mode.id\"\n                            class=\"selectable-line\"\n                            t-att-class=\"{\n                                selected: state.selectedMode and state.selectedMode.id == mode.id,\n                            }\"\n                            t-on-click=\"selectMode(mode.id)\"\n                            t-on-dblclick=\"setMode(mode.id)\">\n                            <devtools-td><t t-if=\"mode.id == state.currentMode.id\"></t> <t t-esc=\"mode.id\"/></devtools-td>\n                        </devtools-tr>\n                    </devtools-table>\n                </mainpane-contents>\n            </devtools-mainpane>\n            <devtools-sidepane>\n                <devtools-info>\n                    <devtools-about t-if=\"state.selectedMode\">\n                        <devtools-type>Mode</devtools-type> <t t-esc=\"state.selectedMode.id\"/>\n                    </devtools-about>\n                    <devtools-properties t-if=\"state.selectedMode\">\n                        <devtools-infotitle> Rules</devtools-infotitle>\n                        <t t-if=\"state.selectedMode\">\n                            <devtools-table>\n                                <devtools-tbody>\n                                    <devtools-tr\n                                    t-foreach=\"state.selectedMode.rules\"\n                                    t-as=\"rule\" t-key=\"rule.id\"\n                                    class=\"selectable-line\">\n                                        <devtools-td>\n                                            <devtools-list>\n                                                <devtools-listitem>Selector: <devtools-button t-on-click=\"logSelector(rule.selector)\">&gt;_</devtools-button></devtools-listitem>\n                                                <devtools-listitem t-foreach=\"Object.keys(rule.properties)\"\n                                                t-as=\"property\"\n                                                t-key=\"property_id\">\n                                                    <t t-esc=\"property\"/>: <t t-esc=\"rule.properties[property].value\"/>\n                                                    <t t-if=\"rule.properties[property].cascading\"> (cascading)</t>\n                                                    <t t-else=\"\"> (targeted)</t>\n                                                </devtools-listitem>\n                                            </devtools-list>\n                                        </devtools-td>\n                                    </devtools-tr>\n                                </devtools-tbody>\n                            </devtools-table>\n                        </t>\n                    </devtools-properties>\n                </devtools-info>\n            </devtools-sidepane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- MAIN -->\n    <jw-devtools t-name=\"devtools\"\n        t-att-class=\"{\n            closed: state.closed,\n        }\"\n        t-attf-style=\"height: {{state.height}}px\"\n        tabindex=\"2\">\n        <devtools-navbar\n            t-on-click=\"toggleClosed\"\n            t-on-mousedown=\"startResize\"\n            t-on-touchstart=\"startResize\">\n            <devtools-button t-on-click=\"openTab('inspector')\" t-att-class=\"{\n                selected: state.currentTab == 'inspector',\n            }\">Inspector</devtools-button>\n            <devtools-button t-on-click=\"openTab('commands')\" t-att-class=\"{\n                selected: state.currentTab == 'commands',\n            }\">Commands</devtools-button>\n            <devtools-button t-on-click=\"openTab('shortcuts')\" t-att-class=\"{\n                selected: state.currentTab == 'shortcuts',\n            }\">Shortcuts</devtools-button>\n            <devtools-button t-on-click=\"openTab('plugins')\" t-att-class=\"{\n                selected: state.currentTab == 'plugins',\n            }\">Plugins</devtools-button>\n            <devtools-button t-on-click=\"openTab('modes')\" t-att-class=\"{\n                selected: state.currentTab == 'modes',\n            }\">Modes</devtools-button>\n            <devtools-button t-on-click=\"inspectDom()\">&#128269;</devtools-button>\n        </devtools-navbar>\n        <t t-if=\"!state.closed\">\n            <InspectorComponent isOpen=\"state.currentTab == 'inspector'\" t-ref=\"inspector\"/>\n            <CommandsComponent isOpen=\"state.currentTab == 'commands'\"\n                commands=\"state.commands\"/>\n            <ShortcutsComponent isOpen=\"state.currentTab == 'shortcuts'\"/>\n            <PluginsComponent isOpen=\"state.currentTab == 'plugins'\"/>\n            <ModesComponent isOpen=\"state.currentTab == 'modes'\"/>\n        </t>\n    </jw-devtools>\n\n</templates>\n"

/***/ }),

/***/ "./packages/plugin-devtools/src/DevTools.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-devtools/src/DevTools.ts ***!
  \**************************************************/
/*! exports provided: DevTools */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DevTools", function() { return DevTools; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-owl/src/Owl */ "./packages/plugin-owl/src/Owl.ts");
/* harmony import */ var _plugin_owl_src_OwlNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-owl/src/OwlNode */ "./packages/plugin-owl/src/OwlNode.ts");
/* harmony import */ var _components_DevToolsComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/DevToolsComponent */ "./packages/plugin-devtools/src/components/DevToolsComponent.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderer */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../assets/DevTools.xml */ "./packages/plugin-devtools/assets/DevTools.xml");
/* harmony import */ var _assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../assets/DevTools.css */ "./packages/plugin-devtools/assets/DevTools.css");
/* harmony import */ var _assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7__);








class DevTools extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            components: [
                {
                    id: 'devTools',
                    async render() {
                        return [new _plugin_owl_src_OwlNode__WEBPACK_IMPORTED_MODULE_2__["OwlNode"]({ Component: _components_DevToolsComponent__WEBPACK_IMPORTED_MODULE_3__["DevToolsComponent"], props: {} })];
                    },
                },
            ],
            componentZones: [['devTools', ['debug']]],
            owlTemplates: [_assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6___default.a],
        };
    }
}
DevTools.dependencies = [_plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__["Owl"], _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_4__["DomObjectRenderer"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-devtools/src/components/CommandsComponent.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/CommandsComponent.ts ***!
  \**********************************************************************/
/*! exports provided: CommandsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommandsComponent", function() { return CommandsComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./packages/plugin-devtools/src/utils.ts");




class CommandsComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.state = {
            currentTab: 'queue',
            registry: this.env.editor.dispatcher.commands,
            selectedCommandIndex: null,
            selectedCommandIdentifier: null,
            selectedCommandImplementationIndex: null,
        };
        this.localStorage = ['currentTab'];
        this.argsRepr = _utils__WEBPACK_IMPORTED_MODULE_3__["argsRepr"];
        this.stringifyPattern = this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__["Keymap"]).stringifyPattern;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Take a payload value and format it for display (mostly to ensure that
     * we can display it properly as a string).
     *
     * @param value
     */
    formatPayloadValue(value) {
        if (value && value instanceof Node && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(value)) {
            return '<' + Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(value).toLowerCase() + '>';
        }
        if (value instanceof Array) {
            return '' + value.join(', ');
        }
        return '' + value;
    }
    /**
     * Handle keydown event to navigate in the command stack.
     */
    onKeydown(event) {
        if (this.state.currentTab === 'queue') {
            if (event.code === 'ArrowDown') {
                this.state.selectedCommandIndex = Math.max(this.state.selectedCommandIndex - 1, 0);
            }
            else if (event.code === 'ArrowUp') {
                this.state.selectedCommandIndex = Math.min(this.state.selectedCommandIndex + 1, this.props.commands.length - 1);
            }
            else {
                return;
            }
        }
        else if (this.state.currentTab === 'registry') {
            const identifiers = Object.keys(this.state.registry).sort();
            const currentIndex = identifiers.indexOf(this.state.selectedCommandIdentifier);
            if (event.code === 'ArrowDown') {
                this.state.selectedCommandIdentifier =
                    identifiers[Math.min(currentIndex + 1, identifiers.length - 1)];
            }
            else if (event.code === 'ArrowUp') {
                this.state.selectedCommandIdentifier = identifiers[Math.max(currentIndex - 1, 0)];
            }
            else {
                return;
            }
        }
        event.preventDefault();
        event.stopImmediatePropagation();
    }
    /**
     * Open the tab with the given tabName.
     *
     * @param tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Select the command at given index.
     *
     * @param index
     */
    selectCommandByIndex(index) {
        this.state.selectedCommandIndex = index;
        this.state.selectedCommandIdentifier = this.props.commands[index][0];
    }
    /**
     * Select the command with given identifier.
     *
     * @param commandIdentifier
     */
    selectCommand(commandIdentifier) {
        this.state.selectedCommandIdentifier = commandIdentifier;
    }
    /**
     * Return the key mappings matching the given command identifier.
     *
     * @param commandIdentifier
     */
    matchingMappings(commandIdentifier) {
        return Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["flat"])(this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__["Keymap"]).mappings).filter(mapping => mapping.configuredCommand.commandId === commandIdentifier);
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/DevToolsComponent.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/DevToolsComponent.ts ***!
  \**********************************************************************/
/*! exports provided: DevToolsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DevToolsComponent", function() { return DevToolsComponent; });
/* harmony import */ var _CommandsComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CommandsComponent */ "./packages/plugin-devtools/src/components/CommandsComponent.ts");
/* harmony import */ var _InspectorComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InspectorComponent */ "./packages/plugin-devtools/src/components/InspectorComponent.ts");
/* harmony import */ var _ShortcutsComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ShortcutsComponent */ "./packages/plugin-devtools/src/components/ShortcutsComponent.ts");
/* harmony import */ var _PluginsComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PluginsComponent */ "./packages/plugin-devtools/src/components/PluginsComponent.ts");
/* harmony import */ var _ModesComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ModesComponent */ "./packages/plugin-devtools/src/components/ModesComponent.ts");
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_7__);








class DevToolsComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_5__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.inspectorRef = _odoo_owl__WEBPACK_IMPORTED_MODULE_7__["hooks"].useRef('inspector');
        this.state = {
            closed: true,
            currentTab: 'inspector',
            height: 300,
            commands: [],
        };
        this.localStorage = ['closed', 'currentTab', 'height'];
    }
    async willStart() {
        this.env.editor.dispatcher.registerCommandHook('*', this.addCommand.bind(this));
        this.env.editor.dispatcher.registerCommandHook('@commit', this.render.bind(this));
        return super.willStart();
    }
    willUnmount() {
        this.state.commands = [];
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Open the tab with the given `tabName`
     *
     * @param {string} tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Bind mouse handler to allow the selection of the node in the devtools inspector.
     * When the mouse will move, we add a class to highlight the targeted node (linked to VNode).
     * Will be unbind when the user click inside the dom.
     *
     * @param ev
     */
    inspectDom() {
        var _a;
        this.state.currentTab = 'inspector';
        (_a = this.inspectorRef.comp) === null || _a === void 0 ? void 0 : _a.inspectDom();
    }
    /**
     * Add the recent dispatching of the given command with the given arguments.
     */
    addCommand(params, id) {
        this.state.commands.push([id, params]);
    }
    /**
     * Drag the DevTools to resize them
     *
     * @param {MouseEvent} event
     */
    startResize(event) {
        event.preventDefault();
        this._heightOnLastMousedown = this.state.height;
        if (this.state.closed) {
            return; // Do not resize if the DevTools are closed
        }
        const startY = event instanceof MouseEvent ? event.pageY : event.targetTouches[0].pageY; // Y position of the mousedown
        /**
         * Perform the resizing on every mouse mouvement
         *
         * @param ev
         */
        const doResize = (ev) => {
            const currentY = ev instanceof MouseEvent ? ev.pageY : ev.targetTouches[0].pageY;
            const offset = startY - currentY;
            this.state.height = this._heightOnLastMousedown + offset;
        };
        /**
         * Stop resizing on mouse up
         */
        const stopResize = () => {
            window.removeEventListener('mousemove', doResize, false);
            window.removeEventListener('mouseup', stopResize, false);
            window.removeEventListener('touchmove', doResize, false);
            window.removeEventListener('touchend', stopResize, false);
        };
        window.addEventListener('mousemove', doResize);
        window.addEventListener('mouseup', stopResize);
        window.addEventListener('touchmove', doResize);
        window.addEventListener('touchend', stopResize);
    }
    /**
     * Toggle the `closed` state of the DevTools (only on a simple click: not
     * if some resizing occurred between mousedown and mouseup)
     */
    toggleClosed(event) {
        const didJustResize = this._heightOnLastMousedown !== this.state.height;
        const isOnButton = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_6__["nodeName"])(event.target) === 'DEVTOOLS-BUTTON';
        if (!didJustResize && !(isOnButton && !this.state.closed)) {
            this.state.closed = !this.state.closed;
        }
    }
}
DevToolsComponent.components = {
    CommandsComponent: _CommandsComponent__WEBPACK_IMPORTED_MODULE_0__["CommandsComponent"],
    InspectorComponent: _InspectorComponent__WEBPACK_IMPORTED_MODULE_1__["InspectorComponent"],
    ShortcutsComponent: _ShortcutsComponent__WEBPACK_IMPORTED_MODULE_2__["ShortcutsComponent"],
    PluginsComponent: _PluginsComponent__WEBPACK_IMPORTED_MODULE_3__["PluginsComponent"],
    ModesComponent: _ModesComponent__WEBPACK_IMPORTED_MODULE_4__["ModesComponent"],
};
DevToolsComponent.template = 'devtools';


/***/ }),

/***/ "./packages/plugin-devtools/src/components/InfoComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/InfoComponent.ts ***!
  \******************************************************************/
/*! exports provided: InfoComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InfoComponent", function() { return InfoComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");



class InfoComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.aboutMeProps = ['id', 'name', 'length', 'atomic', 'modifiers'];
        this.familyProps = ['parent', 'children', 'siblings'];
        this.customPropsBlacklist = this.aboutMeProps.concat(this.familyProps).concat(['childVNodes']);
        this.state = {
            currentTab: 'vNode',
        };
        this.localStorage = ['currentTab'];
    }
    /**
     * Open the tab with the given `tabName`
     *
     * @param {string} tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Trigger a 'node-selected' custom event
     * with the given `vNode` to select it
     *
     * @param {VNode} vNode
     */
    selectNode(vNode) {
        this.trigger('node-selected', {
            vNode: vNode,
        });
    }
    /**
     * Return the name of the class of the given VNode.
     *
     * @param vNode
     */
    className(vNode) {
        return vNode.constructor.name;
    }
    /**
     * Return a string representing the contents of a property of a VNode.
     *
     * @param vNode
     * @param propName
     */
    propRepr(vNode, propName) {
        let prop = vNode[propName];
        if (propName === 'atomic') {
            if (vNode instanceof _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_1__["AtomicNode"]) {
                return 'true';
            }
            else if (vNode instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"]) {
                return 'false';
            }
            else {
                return '?';
            }
        }
        else if (propName === 'modifiers') {
            if (!vNode.modifiers.length)
                return '[]';
            return `[ ${vNode.modifiers.map(m => m.toString()).join(', ')} ]`;
        }
        else {
            if ({}.toString.call(prop) === '[object Function]') {
                prop = vNode[propName]();
            }
            return this._propRepr(prop);
        }
    }
    /**
     * Return an object representing the given VNode's public properties as
     * alphabetically sorted pairs of key and value strings.
     *
     * @param vNode
     */
    nodeProperties(vNode) {
        return Object.keys(vNode)
            .filter(key => !key.startsWith('_') && !this.customPropsBlacklist.includes(key))
            .sort()
            .map(key => {
            return { key: key, value: this._propRepr(vNode[key]) };
        });
    }
    /**
     * Return the length of this node and all its descendents.
     *
     * @param __current
     */
    totalLength(vNode, __current = 0) {
        __current += vNode.length;
        vNode.children().forEach((child) => {
            if (child.hasChildren()) {
                __current = this.totalLength(child, __current);
            }
        });
        return __current;
    }
    /**
     * Log a `VNode` to the console.
     *
     * @param vNode
     */
    logVNode(vNode) {
        console.log(vNode);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _repr(vNode) {
        const nextSibling = vNode.nextSibling();
        const prevSibling = vNode.previousSibling();
        const position = nextSibling ? 'BEFORE' : prevSibling ? 'AFTER' : 'INSIDE';
        const reference = nextSibling || prevSibling || vNode.parent;
        if (reference) {
            return `${position} ${reference.id} (${reference.name})`;
        }
        else {
            return 'Not in VDocument';
        }
    }
    /**
     * Return a string representing the contents of a property of a VNode.
     *
     * @param vNode
     * @param propName
     */
    _propRepr(prop) {
        let value = '' + prop;
        if (typeof prop === 'object') {
            if (Array.isArray(prop) && !prop.length) {
                value = '[]';
            }
            else if (prop === null) {
                value = 'null';
            }
            else if (prop === undefined) {
                value = 'undefined';
            }
            else if (prop instanceof Set) {
                const items = [];
                prop.forEach(item => {
                    items.push(item);
                });
                value = items.join('\n');
            }
            else if (!prop || !Object.keys(prop).length) {
                value = '{}';
            }
            else if (prop.toString === {}.toString) {
                value = this._objectRepr(prop);
            }
        }
        else if (typeof prop === 'string') {
            value = '"' + value + '"';
        }
        return value;
    }
    /**
     * Return a string representing all key/value pairs of an object.
     *
     * @param vNode
     * @param propName
     */
    _objectRepr(obj) {
        return Object.keys(obj)
            .filter(key => key !== 'toString')
            .map(key => {
            return key + ': ' + obj[key];
        })
            .join('\n');
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/InspectorComponent.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/InspectorComponent.ts ***!
  \***********************************************************************/
/*! exports provided: InspectorComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InspectorComponent", function() { return InspectorComponent; });
/* harmony import */ var _InfoComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InfoComponent */ "./packages/plugin-devtools/src/components/InfoComponent.ts");
/* harmony import */ var _PathComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PathComponent */ "./packages/plugin-devtools/src/components/PathComponent.ts");
/* harmony import */ var _TreeComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TreeComponent */ "./packages/plugin-devtools/src/components/TreeComponent.ts");
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _utils_src_polyfill__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/src/polyfill */ "./packages/utils/src/polyfill.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");








const hoverStyle = 'box-shadow: inset 0 0 0 100vh rgba(95, 146, 204, 0.5); cursor: pointer;';
class InspectorComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_3__["OwlComponent"] {
    constructor(parent, props) {
        var _a;
        super(parent, props);
        this.domEngine = this.env.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        this._hoveredTargets = [];
        this.state = {
            selectedID: ((_a = this.domEngine.components.editable[0]) === null || _a === void 0 ? void 0 : _a.id) || this.domEngine.root.id,
        };
        this.selectedNode = this.getNode(this.state.selectedID);
        this._inspecting = new Set();
        this._onInspectorMouseEnter = this._onInspectorMouseEnter.bind(this);
        this._onInspectorMouseMove = this._onInspectorMouseMove.bind(this);
        this._onInspectorMouseLeave = this._onInspectorMouseLeave.bind(this);
        this._onInspectorMouseDown = this._onInspectorMouseDown.bind(this);
        this._onInspectorClick = this._onInspectorClick.bind(this);
    }
    willUnmount() {
        this._hoveredTargets = [];
        this.selectedNode = null;
    }
    async render(force = false) {
        var _a;
        await super.render(force);
        (_a = this.el.querySelector('devtools-nodename.selected')) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
    }
    /**
     * Handle keyboard navigation in DevTools (arrows to move in the tree)
     *
     * @param {KeyboardEvent} event
     */
    onKeydown(event) {
        const selected = this.getNode(this.state.selectedID);
        let newSelection;
        switch (event.code) {
            case 'ArrowDown':
                newSelection = selected.nextSibling() || selected.firstChild();
                break;
            case 'ArrowUp':
                newSelection = selected.previousSibling() || selected.parent;
                break;
            case 'ArrowLeft':
                newSelection = selected.previousSibling();
                break;
            case 'ArrowRight':
                newSelection = selected.nextSibling();
                break;
            default:
                return;
        }
        if (newSelection) {
            event.preventDefault();
            this.state.selectedID = newSelection.id;
            this.selectedNode = this.getNode(this.state.selectedID);
        }
    }
    /**
     * Handle the selection of a node. A subcomponent triggers a 'select-node'
     * custom event and this method listens to it, retrieves the `vNode` that it
     * passes in its `detail` key, and modifies its state to account for the
     * change in selection.
     *
     * @param {CustomEvent} event
     * @param {VNode} event.detail.vNode
     */
    selectNode(event) {
        this.state.selectedID = event.detail.vNode.id;
        this.selectedNode = this.getNode(this.state.selectedID);
    }
    getNode(id) {
        return this.domEngine.root.descendants(node => node.id === id)[0] || this.domEngine.root;
    }
    /**
     * Return the path between the given `vNode` and the root vNode, as an array
     * of VNode, sorted from the highest parent (the root) to the given vNode.
     *
     * @param {VNode} vNode
     * @returns {VNode []}
     */
    getPath(vNode) {
        const path = [vNode];
        let parent = vNode.parent;
        while (parent) {
            path.unshift(parent);
            parent = parent.parent;
        }
        return path;
    }
    patched() {
        super.patched();
        const selected = this.el.querySelector('.selected');
        if (selected) {
            //selected.scrollIntoView();
        }
    }
    /**
     * Bind mouse handler to allow the selection of the node in the devtools inspector.
     * When the mouse will move, we add a class to highlight the targeted node (linked to VNode).
     * Will be unbind when the user click inside the dom.
     *
     * @param ev
     */
    inspectDom(doc = document) {
        if (!this._inspecting.has(doc)) {
            this._inspecting.add(doc);
            doc.addEventListener('mouseenter', this._onInspectorMouseEnter, true);
            doc.addEventListener('mousemove', this._onInspectorMouseMove, true);
            doc.addEventListener('mouseleave', this._onInspectorMouseLeave, true);
            doc.addEventListener('mousedown', this._onInspectorMouseDown, true);
            doc.addEventListener('click', this._onInspectorClick, true);
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    async _onInspectorMouseEnter(ev) {
        var _a;
        const el = ev.target;
        if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_7__["nodeName"])(el) === 'IFRAME') {
            const doc = (_a = ev.target.contentWindow) === null || _a === void 0 ? void 0 : _a.document;
            if (doc) {
                this.inspectDom(doc);
            }
        }
        else if (el.shadowRoot) {
            this.inspectDom(el.shadowRoot);
        }
    }
    /**
     * Add a class to highlight the targeted node (like to VNode).
     *
     * @param ev
     */
    async _onInspectorMouseMove(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            inspected.element.setAttribute('style', inspected.oldStyle);
        }
        this._hoveredTargets = [];
        const elements = [];
        for (const node of this._getNodeFromPosition(ev.clientX, ev.clientY, ev.target.ownerDocument)) {
            for (const domNode of this.domEngine.getDomNodes(node)) {
                const element = domNode instanceof HTMLElement ? domNode : domNode.parentElement;
                if (!elements.includes(element)) {
                    elements.push(element);
                }
            }
        }
        for (const element of elements) {
            const style = element.getAttribute('style') || '';
            this._hoveredTargets.push({
                element: element,
                oldStyle: style,
            });
            element.setAttribute('style', style + ';' + hoverStyle);
        }
    }
    /**
     * remove class to remove the highlight.
     *
     * @param ev
     */
    _onInspectorMouseLeave(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            if (inspected.element === ev.target) {
                this._hoveredTargets.splice(this._hoveredTargets.indexOf(inspected), 1);
                inspected.element.setAttribute('style', inspected.oldStyle);
            }
        }
    }
    /**
     * Prevent default behavior (domEditable normalisation).
     *
     * @param ev
     */
    _onInspectorMouseDown(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
    }
    _getNodeFromPosition(clientX, clientY, doc) {
        const caretPosition = Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_5__["caretPositionFromPoint"])(clientX, clientY, doc);
        let node = caretPosition === null || caretPosition === void 0 ? void 0 : caretPosition.offsetNode;
        let nodes = [];
        while (!nodes.length && node) {
            nodes = this.domEngine.getNodes(node);
            node = node.parentNode;
        }
        if (nodes[0] instanceof _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_6__["CharNode"] && nodes[caretPosition.offset]) {
            return [nodes[caretPosition.offset]];
        }
        return nodes;
    }
    /**
     * Select the targeted node in the devtools inspector and unbind the mouse handler
     *
     * @param ev
     */
    async _onInspectorClick(ev) {
        for (const doc of this._inspecting) {
            doc.removeEventListener('mouseenter', this._onInspectorMouseEnter, true);
            doc.removeEventListener('mousemove', this._onInspectorMouseMove, true);
            doc.removeEventListener('mouseleave', this._onInspectorMouseLeave, true);
            doc.removeEventListener('mousedown', this._onInspectorMouseDown, true);
            doc.removeEventListener('click', this._onInspectorClick, true);
        }
        this._inspecting.clear();
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            inspected.element.setAttribute('style', inspected.oldStyle);
        }
        this._hoveredTargets = [];
        const nodes = this._getNodeFromPosition(ev.clientX, ev.clientY, ev.target.ownerDocument);
        if (nodes.length) {
            this.state.selectedID = nodes[0].id;
            this.selectedNode = this.getNode(this.state.selectedID);
        }
    }
}
InspectorComponent.components = { InfoComponent: _InfoComponent__WEBPACK_IMPORTED_MODULE_0__["InfoComponent"], PathComponent: _PathComponent__WEBPACK_IMPORTED_MODULE_1__["PathComponent"], TreeComponent: _TreeComponent__WEBPACK_IMPORTED_MODULE_2__["TreeComponent"] };


/***/ }),

/***/ "./packages/plugin-devtools/src/components/ModesComponent.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/ModesComponent.ts ***!
  \*******************************************************************/
/*! exports provided: ModesComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModesComponent", function() { return ModesComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");

class ModesComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.modes = this.env.editor.modes;
        this.localStorage = ['currentTab'];
        this.state = {
            selectedMode: null,
            currentMode: this.env.editor.mode,
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Select the mode at given index.
     *
     * @param index
     */
    selectModeByIndex(index) {
        this.state.selectedMode = this.modes[Object.keys(this.modes)[index]];
    }
    /**
     * Select the mode with given identifier.
     *
     * @param modeIdentifier
     */
    selectMode(modeIdentifier) {
        this.state.selectedMode = this.modes[modeIdentifier];
    }
    /**
     * Handle keydown event to navigate in the modes list.
     */
    onKeydown(event) {
        const modeIdentifiers = Object.keys(this.modes);
        const currentModeIndex = modeIdentifiers.findIndex(key => key === this.state.selectedMode.id);
        if (event.code === 'ArrowDown') {
            this.selectModeByIndex(Math.min(currentModeIndex + 1, modeIdentifiers.length - 1));
        }
        else if (event.code === 'ArrowUp') {
            this.selectModeByIndex(Math.max(currentModeIndex - 1, 0));
        }
        else {
            return;
        }
        event.preventDefault();
        event.stopImmediatePropagation();
    }
    setMode(modeIdentifier) {
        this.env.editor.setMode(modeIdentifier);
        this.state.currentMode = this.env.editor.mode;
    }
    /**
     * Log a selector to the console.
     *
     * @param selector
     */
    logSelector(selector) {
        console.log(selector);
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/PathComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/PathComponent.ts ***!
  \******************************************************************/
/*! exports provided: PathComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PathComponent", function() { return PathComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/src/Format */ "./packages/core/src/Format.ts");


class PathComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    getNodeRepr(vNode) {
        if (!vNode.id) {
            return 'death-VNode: ' + vNode.constructor.name;
        }
        let repr = vNode.name || '?';
        for (const format of vNode.modifiers.filter(_core_src_Format__WEBPACK_IMPORTED_MODULE_1__["Format"])) {
            repr += '.' + format.name;
        }
        return repr;
    }
    /**
     * Trigger a 'node-selected' custom event
     * with the given `vNode` to select it
     *
     * @param {VNode} vNode
     */
    selectNode(vNode) {
        this.trigger('node-selected', {
            vNode: vNode,
        });
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/PluginsComponent.ts":
/*!*********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/PluginsComponent.ts ***!
  \*********************************************************************/
/*! exports provided: PluginsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PluginsComponent", function() { return PluginsComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");

class PluginsComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.plugins = Array.from(this.env.editor.plugins.values())
            .map(plugin => plugin.constructor.name)
            .sort();
        this.localStorage = ['currentTab'];
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/ShortcutsComponent.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/ShortcutsComponent.ts ***!
  \***********************************************************************/
/*! exports provided: ShortcutsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShortcutsComponent", function() { return ShortcutsComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "./packages/plugin-devtools/src/utils.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ShortcutsComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.mappings = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["flat"])(this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__["Keymap"]).mappings).sort((a, b) => {
            if (a.configuredCommand.commandId < b.configuredCommand.commandId)
                return -1;
            if (a.configuredCommand.commandId > b.configuredCommand.commandId)
                return 1;
            return 0;
        });
        this.localStorage = ['currentTab'];
        this.argsRepr = _utils__WEBPACK_IMPORTED_MODULE_2__["argsRepr"];
        this.stringifyPattern = this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__["Keymap"]).stringifyPattern;
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/TreeComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/TreeComponent.ts ***!
  \******************************************************************/
/*! exports provided: TreeComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TreeComponent", function() { return TreeComponent; });
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");





/**
 * Note: `TreeComponent` requires three properties passed by the parent
 *       Component (`DevToolsComponent`) via the template (see `DevTools.xml`):
 *       - vNode: VNode
 *       - isRoot: boolean
 *       - selectedID: number (the ID of the selected VNode)
 */
class TreeComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_1__["OwlComponent"] {
    constructor() {
        super(...arguments);
        // User-friendly representation of the node
        this._repr = this._getNodeRepr(this.props.vNode);
        this.state = {
            // Show the selected node and root by default
            folded: !this.props.isRoot && !this.props.selectedPath.includes(this.props.vNode),
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Update `state.folded` when `props.selectedPath` changes if `props.vNode`
     * is in `props.selectedPath`, unless it is the last item. Also update
     * `state.folded` for the ancestors of the selection marker nodes.
     */
    async willUpdateProps(nextProps) {
        // The selected node itself should stay folded even when selected. Only
        // the nodes in the path leading to it should actually be unfolded. By
        // construction, the last item of `selected path` is always the selected
        // node itself so it can safely be omitted from the check.
        const path = nextProps.selectedPath.slice(0, -1);
        if (path.some(node => node.id === nextProps.vNode.id)) {
            this.state.folded = false;
        }
        const selectionMarkersPath = this._getSelectionMarkersAncestors();
        if (selectionMarkersPath.has(nextProps.vNode.id)) {
            this.state.folded = false;
        }
    }
    /**
     * Handle a click event on a node of the tree: toggle its fold on click its
     * caret, select it otherwise
     *
     * @param {MouseEvent} event
     */
    onClickNode(event) {
        const didClickCaret = event.offsetX < 10;
        if (didClickCaret) {
            this.toggleFolded();
        }
        else {
            this.trigger('node-selected', {
                vNode: this.props.vNode,
            });
        }
    }
    onDblClickNode() {
        const location = {
            anchorNode: this.props.vNode,
            focusNode: this.props.vNode,
            direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD,
        };
        this.env.editor.execCommand('setSelection', { vSelection: location });
    }
    /**
     * Handle folding/unfolding on press Enter
     *
     * @param {KeyboardEvent} event
     */
    onKeydown(event) {
        if (event.code === 'Enter') {
            event.preventDefault();
            this.toggleFolded();
            event.stopImmediatePropagation();
        }
    }
    repr() {
        if (this.props.vNode.tangible) {
            return this._repr;
        }
        else {
            // Representation of intangible nodes (e.g. markers) might change
            // depending on the context in which they are referenced, even
            // though they did not actually change per se.
            return this._getNodeRepr(this.props.vNode);
        }
    }
    /**
     * Unfold all of a node's direct ancestors on select it
     * TODO: find a way to do this cross-components
     *
     * @param {CustomEvent} event
     */
    selectNode(event) {
        if (event.detail.vNode.id !== this.props.vNode.id) {
            this.state.folded = false;
        }
    }
    /**
     * Toggle the `folded` propoerty of the state
     */
    toggleFolded() {
        this.state.folded = !this.state.folded;
    }
    /**
     * Return true if the given node has the given format.
     *
     * @param node
     */
    isFormat(node, formatName) {
        return (node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"] &&
            !!node.modifiers.find(format => format.name === formatName));
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a user-friendly representation of the node
     *
     * @param {VNode} node
     * @returns {string}
     */
    _getNodeRepr(node) {
        if (node === this.env.editor.selection.anchor) {
            return _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["ANCHOR_CHAR"];
        }
        if (node === this.env.editor.selection.focus) {
            return _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["FOCUS_CHAR"];
        }
        if (node.name) {
            return Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["toUnicode"])(node.name).replace(/Node/, '');
        }
        return '?';
    }
    /**
     * Return a set of the IDs of all ancestors of both selection marker nodes.
     */
    _getSelectionMarkersAncestors() {
        const selectionMarkersAncestors = new Set();
        let ancestor = this.env.editor.selection.anchor.parent;
        while (ancestor) {
            selectionMarkersAncestors.add(ancestor.id);
            ancestor = ancestor.parent;
        }
        ancestor = this.env.editor.selection.focus.parent;
        while (ancestor) {
            selectionMarkersAncestors.add(ancestor.id);
            ancestor = ancestor.parent;
        }
        return selectionMarkersAncestors;
    }
}
// This is a recursive Component: each node of the tree is itself a tree
TreeComponent.components = { TreeComponent };


/***/ }),

/***/ "./packages/plugin-devtools/src/utils.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-devtools/src/utils.ts ***!
  \***********************************************/
/*! exports provided: argsRepr */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "argsRepr", function() { return argsRepr; });
function argsRepr(args) {
    if (args === undefined)
        return '';
    return `{ ${Object.keys(args)
        .map(key => key + ': ' + args[key])
        .join(', ')} }`;
}


/***/ }),

/***/ "./packages/plugin-dialog/assets/Dialog.css":
/*!**************************************************!*\
  !*** ./packages/plugin-dialog/assets/Dialog.css ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./Dialog.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/assets/Dialog.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-dialog/assets/Dialog.xml":
/*!**************************************************!*\
  !*** ./packages/plugin-dialog/assets/Dialog.xml ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<jw-dialog>\n    <jw-backdrop class=\"jw-close\"></jw-backdrop>\n    <jw-content>\n        <jw-button class=\"jw-close\"></jw-button>\n    </jw-content>\n</jw-dialog>\n"

/***/ }),

/***/ "./packages/plugin-dialog/src/Dialog.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-dialog/src/Dialog.ts ***!
  \**********************************************/
/*! exports provided: Dialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialog", function() { return Dialog; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _DialogZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogZoneDomObjectRenderer */ "./packages/plugin-dialog/src/DialogZoneDomObjectRenderer.ts");
/* harmony import */ var _DialogZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DialogZoneXmlDomParser */ "./packages/plugin-dialog/src/DialogZoneXmlDomParser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");






class Dialog extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_DialogZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["DialogZoneXmlDomParser"]],
            renderers: [_DialogZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["DialogZoneDomObjectRenderer"]],
        };
    }
}
Dialog.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__["Renderer"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-dialog/src/DialogZoneDomObjectRenderer.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-dialog/src/DialogZoneDomObjectRenderer.ts ***!
  \*******************************************************************/
/*! exports provided: DialogZoneDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneDomObjectRenderer", function() { return DialogZoneDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogZoneNode */ "./packages/plugin-dialog/src/DialogZoneNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-metadata/src/MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");
/* harmony import */ var _assets_Dialog_xml__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../assets/Dialog.xml */ "./packages/plugin-dialog/assets/Dialog.xml");
/* harmony import */ var _assets_Dialog_xml__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_assets_Dialog_xml__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _assets_Dialog_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../assets/Dialog.css */ "./packages/plugin-dialog/assets/Dialog.css");
/* harmony import */ var _assets_Dialog_css__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_assets_Dialog_css__WEBPACK_IMPORTED_MODULE_6__);







const container = document.createElement('jw-container');
container.innerHTML = _assets_Dialog_xml__WEBPACK_IMPORTED_MODULE_5___default.a;
const dialog = container.firstElementChild;
class DialogZoneDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__["DialogZoneNode"];
    }
    async render(node, worker) {
        var _a;
        const float = document.createElement('jw-dialog-container');
        for (const child of node.childVNodes) {
            if (child.tangible || child instanceof _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_4__["MetadataNode"]) {
                if (!((_a = node.hidden) === null || _a === void 0 ? void 0 : _a[child.id])) {
                    float.appendChild(await this._renderDialog(child));
                }
                worker.depends(child, node);
            }
        }
        return {
            dom: float.childNodes.length ? [float] : [],
        };
    }
    async _renderDialog(node) {
        const clone = dialog.cloneNode(true);
        const content = clone.querySelector('jw-content');
        content.appendChild(this.engine.renderPlaceholder(node));
        let componentId;
        const components = this.engine.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).engines.dom.components;
        for (const id in components) {
            if (components[id].includes(node)) {
                componentId = id;
            }
        }
        clone.addEventListener('click', (ev) => {
            const target = ev.target;
            if (target.classList.contains('jw-close')) {
                this.engine.editor.execCommand('hide', { componentId: componentId });
            }
        });
        return clone;
    }
}
DialogZoneDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dialog/src/DialogZoneNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-dialog/src/DialogZoneNode.ts ***!
  \******************************************************/
/*! exports provided: DialogZoneNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneNode", function() { return DialogZoneNode; });
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");

class DialogZoneNode extends _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"] {
}


/***/ }),

/***/ "./packages/plugin-dialog/src/DialogZoneXmlDomParser.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-dialog/src/DialogZoneXmlDomParser.ts ***!
  \**************************************************************/
/*! exports provided: DialogZoneXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneXmlDomParser", function() { return DialogZoneXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogZoneNode */ "./packages/plugin-dialog/src/DialogZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class DialogZoneXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-DIALOG';
        };
    }
    async parse(item) {
        const zones = [];
        for (const child of item.querySelectorAll('t[t-zone]')) {
            zones.push(child.getAttribute('t-zone'));
        }
        return [new _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__["DialogZoneNode"]({ managedZones: zones })];
    }
}
DialogZoneXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-divider/src/Divider.ts":
/*!************************************************!*\
  !*** ./packages/plugin-divider/src/Divider.ts ***!
  \************************************************/
/*! exports provided: Divider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Divider", function() { return Divider; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _DividerXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DividerXmlDomParser */ "./packages/plugin-divider/src/DividerXmlDomParser.ts");


class Divider extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_DividerXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["DividerXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-divider/src/DividerNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-divider/src/DividerNode.ts ***!
  \****************************************************/
/*! exports provided: DividerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DividerNode", function() { return DividerNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class DividerNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'DIV' });
    }
}


/***/ }),

/***/ "./packages/plugin-divider/src/DividerXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-divider/src/DividerXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: DividerXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DividerXmlDomParser", function() { return DividerXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _DividerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DividerNode */ "./packages/plugin-divider/src/DividerNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class DividerXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'DIV';
        };
    }
    async parse(item) {
        const divider = new _DividerNode__WEBPACK_IMPORTED_MODULE_2__["DividerNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            divider.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        divider.append(...nodes);
        return [divider];
    }
}
DividerXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-editable/src/DomEditable.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-dom-editable/src/DomEditable.ts ***!
  \*********************************************************/
/*! exports provided: DomEditable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomEditable", function() { return DomEditable; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _EventNormalizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./EventNormalizer */ "./packages/plugin-dom-editable/src/EventNormalizer.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _core_src_Mode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/Mode */ "./packages/core/src/Mode.ts");








class DomEditable extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            selectAll: {
                handler: this.selectAll,
            },
        };
    }
    async start() {
        const domLayout = this.dependencies.get(_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__["DomLayout"]);
        this.eventNormalizer = new _EventNormalizer__WEBPACK_IMPORTED_MODULE_3__["EventNormalizer"](domLayout.isInEditable.bind(domLayout), this._onNormalizedEvent.bind(this), {
            handle: this._processKeydown.bind(this),
            handleCapture: domLayout.processKeydown,
        });
    }
    async stop() {
        this.eventNormalizer.destroy();
        return super.stop();
    }
    /**
     * Update the selection in such a way that it selects the entire document.
     *
     * @param params
     */
    selectAll() {
        const unbreakableAncestor = this.editor.selection.range.start.ancestor(node => !this.editor.mode.is(node, _core_src_Mode__WEBPACK_IMPORTED_MODULE_7__["RuleProperty"].BREAKABLE));
        const domEngine = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        const editable = domEngine.components.editable[0];
        this.editor.selection.set({
            anchorNode: (unbreakableAncestor === null || unbreakableAncestor === void 0 ? void 0 : unbreakableAncestor.firstLeaf()) || editable.firstLeaf(),
            anchorPosition: _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__["RelativePosition"].BEFORE,
            focusNode: (unbreakableAncestor === null || unbreakableAncestor === void 0 ? void 0 : unbreakableAncestor.lastLeaf()) || editable.lastLeaf(),
            focusPosition: _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__["RelativePosition"].AFTER,
            direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD,
        });
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Handle the received signal and dispatch the corresponding editor command,
     * based on the user's configuration and context.
     *
     * @param action
     */
    _matchCommand(action) {
        switch (action.type) {
            case 'insertLineBreak':
                return ['insertLineBreak', {}];
            case 'insertText':
            case 'insertHtml': {
                const params = { text: action.text };
                return ['insertText', params];
            }
            case 'selectAll':
                return ['selectAll', {}];
            case 'setSelection': {
                const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
                const domLayoutEngine = layout.engines.dom;
                const vSelectionParams = {
                    vSelection: domLayoutEngine.parseSelection(action.domSelection),
                };
                return ['setSelection', vSelectionParams];
            }
            case 'insertParagraphBreak':
                return ['insertParagraphBreak', {}];
            case 'deleteWord':
                if (action.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD) {
                    const text = Array.from(action.text);
                    if (text[text.length - 1] === ' ') {
                        // Make sure to handle a space _before_ the word.
                        text.unshift(text.pop());
                    }
                    let end = this.editor.selection.range.end;
                    while (end && text.length) {
                        const next = end.nextSibling();
                        if ((next === null || next === void 0 ? void 0 : next.textContent) === text.shift()) {
                            end = next;
                        }
                    }
                    return [
                        'deleteForward',
                        {},
                        _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].selecting(this.editor.selection.range.start, end),
                    ];
                }
                else {
                    let start = this.editor.selection.range.start;
                    const text = Array.from(action.text);
                    if (text[0] === ' ') {
                        // Make sure to treat a space _before_ the word.
                        text.push(text.shift());
                    }
                    while (start && text.length) {
                        const previous = start.previousSibling();
                        if ((previous === null || previous === void 0 ? void 0 : previous.textContent) === text.pop()) {
                            start = previous;
                        }
                    }
                    return [
                        'deleteBackward',
                        {},
                        _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].selecting(start, this.editor.selection.range.end),
                    ];
                }
            case 'deleteContent': {
                if (action.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD) {
                    return ['deleteForward', {}];
                }
                else {
                    return ['deleteBackward', {}];
                }
            }
            default:
                break;
        }
    }
    /**
     * Handle the received signal and dispatch the corresponding editor command,
     * based on the user's configuration and context.
     *
     * @param batchPromise
     */
    async _onNormalizedEvent(batchPromise) {
        // TODO: The `nextEventMutex` shenanigans that were removed in this
        // commit should be reinstated unless we want the normalizer to call
        // `execCommand` regardless of the observation outcome like it used to
        // call `nextEventMutex` before calling `execCommand`.
        const batch = await batchPromise;
        const domEngine = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        if (batch.mutatedElements) {
            domEngine.markForRedraw(batch.mutatedElements);
        }
        let processed = false;
        if (batch.inferredKeydownEvent) {
            const domLayout = this.dependencies.get(_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__["DomLayout"]);
            processed = !!(await domLayout.processKeydown(new KeyboardEvent('keydown', Object.assign(Object.assign({}, batch.inferredKeydownEvent), { key: batch.inferredKeydownEvent.key, code: batch.inferredKeydownEvent.code }))));
        }
        if (!processed) {
            for (const action of batch.actions) {
                const commandSpec = this._matchCommand(action);
                if (commandSpec) {
                    const [commandName, commandParams, rangeBounds] = commandSpec;
                    if (commandName && rangeBounds) {
                        await this.editor.execWithRange(rangeBounds, commandName, commandParams);
                    }
                    else if (commandName) {
                        await this.editor.execCommand(commandName, commandParams);
                    }
                }
            }
        }
    }
    /**
     * In DomLayout, KeyboardEvent listener to be added to the DOM that calls
     * `execCommand` if the keys pressed match one of the shortcut registered
     * in the keymap.
     * In case of the keydow are defaultPrevented it's means we executed a new
     * command. We split the event agragation of normalizer to ensure to have
     * the next execCommand at the right time.
     *
     * @param event
     */
    _processKeydown(event) {
        if (event.defaultPrevented) {
            this.eventNormalizer.initNextObservation();
        }
    }
}
DomEditable.dependencies = [_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__["DomLayout"], _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]];


/***/ }),

/***/ "./packages/plugin-dom-editable/src/EventNormalizer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-dom-editable/src/EventNormalizer.ts ***!
  \*************************************************************/
/*! exports provided: EventNormalizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventNormalizer", function() { return EventNormalizer; });
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _MutationNormalizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MutationNormalizer */ "./packages/plugin-dom-editable/src/MutationNormalizer.ts");
/* harmony import */ var _utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/polyfill */ "./packages/utils/src/polyfill.ts");
/* harmony import */ var _utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/Dom */ "./packages/utils/src/Dom.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





const navigationKey = new Set([
    'ArrowUp',
    'ArrowDown',
    'ArrowLeft',
    'ArrowRight',
    'PageUp',
    'PageDown',
    'End',
    'Home',
]);
const inputTypeCommands = new Set([
    'historyUndo',
    'historyRedo',
    'formatBold',
    'formatItalic',
    'formatUnderline',
    'formatStrikeThrough',
    'formatSuperscript',
    'formatSubscript',
    'formatJustifyFull',
    'formatJustifyCenter',
    'formatJustifyRight',
    'formatJustifyLeft',
    'formatIndent',
    'formatOutdent',
    'formatRemove',
    'formatSetBlockTextDirection',
    'formatSetInlineTextDirection',
    'formatBackColor',
    'formatFontColor',
    'formatFontName',
]);
/*
 * Regexp to test if a character is within an alphabet known by us.
 *
 * Note: Not all alphabets are taken into consideration and this RegExp is subject to be completed
 *       as more alphabets will be covered.
 *
 * Unicode range source:
 * - wikipedia
 * - google translate
 * - https://jrgraphix.net/r/Unicode/
 *
 * Tool to generate RegExp range:
 * - https://apps.timwhitlock.info/js/regex
 *
 * The strategy is to separate any word by selecting subsequent characters of a common alphabet.
 */
const alphabetsContainingSpaces = new RegExp('(' +
    [
        '[----]+',
        '[--]+',
        '[\u0530-\u058F]+',
        '[\u0600--\u08a0-\u08fe]+',
        '[\u0900-\u0DFF]+',
        '[a-zA-Z]+',
        '[a-zA-Z-]+',
        '[a-zA-Z-]+',
        '[a-zA-Z-]+',
    ].join('|') +
    ')$');
/**
 * These javascript event types might, in case of safari or spell-checking
 * keyboard, trigger dom events in multiple javascript stacks. They will require
 * to observe events during two ticks rather than after a single tick.
 */
const MultiStackEventTypes = ['input', 'compositionend', 'selectAll'];
/**
 * Create a promise that resolve once a timeout finish or when calling
 * `executeAndClear`.
 */
class Timeout {
    constructor(fn, interval = 0) {
        this.fn = fn;
        this.pending = true;
        this.promise = new Promise((resolve) => {
            this._resolve = resolve;
            this.id = window.setTimeout(() => {
                this.pending = false;
                resolve(fn());
            }, interval);
        });
    }
    fire(result) {
        clearTimeout(this.id);
        this.pending = false;
        if (result) {
            this._resolve(result);
        }
        else {
            this._resolve(this.fn());
        }
    }
}
/**
 * ## The problems the normalizer solve
 * Browser and virtual keyboards on mobile does not implement properly the w3c
 * contenteditable specification and are inconsistent.
 *
 * ## Goal of the normalizer
 * 1. Hook any change that happend in an element called the `editable`.
 * 2. Trigger the same event for the same action accross all browsers and
 *    devices.
 *
 * ## Strategy
 * Hook all javascript events that modify the `editable` element. Then, trigger
 * normalized events.
 *
 * ## How to use this normalizer?
 * 1. Javascript Events occurs
 * 2. Normalize javascript one or more `Event` to one or more
 *    `NormalizedAction`.
 * 3. Update our `VDocument` in regard of triggered normalized actions.
 * 4. Render what changed in the `VDocument` HTML in the `editable`.
 *
 * The normalizer does not preventDefault most of the change in the editable
 * happen (the exception for "paste" and "drop" javascript event).
 *
 *
 * ## Handeling javascript events
 * A javascript event is almost never prevented and almost always alter the
 * editable in the DOM.
 *
 * The reason that we do not prevent default is because we need more
 * informations. The information modified in the dom (by observing observing
 * mutations).
 *
 * There is an exception for the event 'paste' and 'drop'.
 *
 * The reason to preventDefault 'paste' is because most of the time, browsers
 * paste content that need to be cleaned. For that reason we prevent it from
 * being inserted in the editable element but the informations can be found in
 * the triggered normalized events actions.
 *
 * The reason to preventDefault 'drop' is because some browsers change page when
 * dropping an image or an url that comes from the address bar (e.g. chrome).
 *
 * ## Supported browser and virtual keyboard
 * - Mac
 *   - Chrome
 *   - Firefox
 *   - Edge
 *   - Safari
 * - Windows
 *   - Chrome
 *   - Firefox
 *   - Edge
 *   - Safari
 * - Linux
 *   - Chrome
 *   - Firefox
 * - Android
 *   - Chrome
 *   - Firefox
 *   - Google keyboard
 *   - Swift keyboard
 * - IOS
 *   - Safari
 *   - Chrome
 *   - Firefox
 */
class EventNormalizer {
    /**
     *
     * @param _isInEditable Callback to check if the node is in editable.
     * @param _triggerEventBatch Callback to trigger for each user action.
     */
    constructor(_isInEditable, _triggerEventBatch, processKeydown, root = document) {
        this._isInEditable = _isInEditable;
        this._triggerEventBatch = _triggerEventBatch;
        this.processKeydown = processKeydown;
        this.root = root;
        /**
         * Event listeners that are bound in the DOM by the normalizer on creation
         * and unbound on destroy.
         */
        this._eventListeners = [];
        /**
         * Cache the state of modifiers keys on each keystrokes.
         */
        this._modifierKeys = {
            ctrlKey: false,
            altKey: false,
            metaKey: false,
            shiftKey: false,
        };
        /**
         * Map of the shadow dom event normalizer.
         * If an event is triggered inside a shadow dom, we instanciate a new
         * EventNormalizer in the shadow dom.
         */
        this._shadowNormalizers = new Map();
        /**
         * This is a cache of the selection state used only for determining whether
         * a particular deleteContent is actually a deleteWord using the SwiftKey
         * mobile keyboard or not.
         */
        this._swiftKeyDeleteWordSelectionCache = [];
        this._shadowNormalizers.set(root, this);
        this.initNextObservation();
        this._bindEvent(root, 'keydown', processKeydown.handle);
        this._bindEvent(root, 'keydown', processKeydown.handleCapture, true);
        this._bindEventInEditable(root, 'compositionstart', this._registerEvent);
        this._bindEventInEditable(root, 'compositionupdate', this._registerEvent);
        this._bindEventInEditable(root, 'compositionend', this._registerEvent);
        this._bindEventInEditable(root, 'beforeinput', this._registerEvent);
        this._bindEventInEditable(root, 'input', this._registerEvent);
        this._bindEvent(root.ownerDocument || root, 'selectionchange', this._onSelectionChange);
        this._bindEventInEditable(root, 'contextmenu', this._onContextMenu);
        this._bindEvent(root, 'mousedown', this._onPointerDown);
        this._bindEvent(root, 'touchstart', this._onPointerDown);
        this._bindEvent(root, 'load-iframe', this._onEventEnableNormalizer);
        this._bindEvent(root, 'mousedown', this._onEventEnableNormalizer);
        this._bindEvent(root, 'touchstart', this._onEventEnableNormalizer);
        this._bindEvent(root, 'mouseup', this._onPointerUp);
        this._bindEvent(root, 'touchend', this._onPointerUp);
        this._bindEventInEditable(root, 'keydown', this._onKeyDownOrKeyPress);
        this._bindEventInEditable(root, 'keypress', this._onKeyDownOrKeyPress);
        this._bindEvent(root, 'onkeyup', this._updateModifiersKeys);
        this._bindEventInEditable(root, 'cut', this._onClipboard);
        this._bindEventInEditable(root, 'paste', this._onClipboard);
        this._bindEventInEditable(root, 'dragstart', this._onDragStart);
        this._bindEventInEditable(root, 'drop', this._onDrop);
        this._mutationNormalizer = new _MutationNormalizer__WEBPACK_IMPORTED_MODULE_1__["MutationNormalizer"](root instanceof Document ? root.body : root.lastElementChild);
        // Create EventNormalizer for all already loaded iframes.
        for (const iframe of root.querySelectorAll('iframe')) {
            this._enableNormalizer(iframe);
        }
    }
    /**
     * Called when destroy the event normalizer.
     * Remove all added handlers.
     *
     */
    destroy() {
        this._mutationNormalizer.destroy();
        this._unbindEvents();
        this._shadowNormalizers.forEach(eventNormalizer => eventNormalizer !== this && eventNormalizer.destroy());
        this._triggerEventBatch = null;
        this._isInEditable = null;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Bind the occurence of given even type on the given target element to the
     * given listener function. See _unbindEvents to unbind all events bound by
     * calling this function.
     *
     * @param target element on which to listen for events
     * @param type of the event to listen
     * @param listener to call when the even occurs on the target
     */
    _bindEvent(target, type, listener, capture = true) {
        const boundListener = (ev) => {
            if ('target' in ev) {
                const doc = ev.target.ownerDocument;
                if (doc !== this.root && doc !== this.root.ownerDocument) {
                    return;
                }
            }
            listener.call(this, ev);
        };
        this._eventListeners.push({
            target: target,
            type: type,
            listener: boundListener,
            capture: capture,
        });
        target.addEventListener(type, boundListener, true);
    }
    /**
     * Filter event from editable.
     *
     * @see _bindEvent
     *
     * @param target element on which to listen for events
     * @param type of the event to listen
     * @param listener to call when the even occurs on the target
     */
    _bindEventInEditable(target, type, listener) {
        const boundListener = (ev) => {
            let eventTarget = 'target' in ev && ev.target;
            if (eventTarget instanceof Element &&
                (eventTarget.shadowRoot || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(eventTarget) === 'IFRAME')) {
                this._enableNormalizer(eventTarget);
            }
            else {
                if (eventTarget && ev.constructor.name === 'MouseEvent') {
                    eventTarget = this._getEventTarget(ev);
                }
                else if (eventTarget && ev.constructor.name === 'TouchEvent') {
                    eventTarget = this._getEventTarget(ev);
                }
                else if (this._isInEditable(eventTarget)) {
                    eventTarget = eventTarget === null || eventTarget === void 0 ? void 0 : eventTarget.ownerDocument.getSelection().focusNode;
                }
                if (eventTarget && this._isInEditable(eventTarget)) {
                    listener.call(this, ev);
                }
            }
        };
        this._bindEvent(target, type, boundListener);
    }
    /**
     * Unbind all events bound by calls to _bindEvent.
     *
     */
    _unbindEvents() {
        this._eventListeners.forEach(({ target, type, listener, capture }) => {
            target.removeEventListener(type, listener, capture);
        });
    }
    /**
     * Register given event on the this.currentStackObservation._events queue.
     * If the queue is not yet initialized or has been cleared prior to this
     * call, re-initialize it. After a tick (setTimeout 0ms) the
     * '_processEvents' method is called. All events that happened during the
     * tick are read from the queue and the analysis tries to extract the
     * actions desired by the user such as insert, delete, backspace, spell
     * checking, special characters, etc.
     *
     * @see _processEvents
     */
    _registerEvent(ev) {
        var _a, _b, _c;
        // See comment on `_keyboardSelectionTimeout`.
        if ((_a = this._keyboardSelectionTimeout) === null || _a === void 0 ? void 0 : _a.pending) {
            this._keyboardSelectionTimeout.fire();
        }
        // See comment on `_pointerSelectionTimeout`.
        if ((_b = this._pointerSelectionTimeout) === null || _b === void 0 ? void 0 : _b.pending) {
            this._pointerSelectionTimeout.fire();
        }
        const isNavigationEvent = ev instanceof KeyboardEvent && ev.type === 'keydown' && navigationKey.has(ev.key);
        if (isNavigationEvent) {
            // Manually triggering the processing of the current stack at this
            // point forces the rendering in the DOM of the result of the
            // observed events. This ensures that the new selection that is
            // eventually going to be set by the browser actually targets nodes
            // that are properly recognized in our abstration, which would not
            // be the case otherwise. See comment on `_stackTimeout`.
            if ((_c = this._stackTimeout) === null || _c === void 0 ? void 0 : _c.pending) {
                this._stackTimeout.fire();
            }
            // TODO: no rendering in editable can happen before the analysis of
            // the selection. There should be a mechanism here that can be used
            // by the normalizer to block the rendering until this resolves.
            const currentDomSelection = this._getSelection();
            this._keyboardSelectionTimeout = new Timeout(async () => {
                const newDomSelection = this._getSelection();
                const collapsed = newDomSelection.anchorNode === newDomSelection.focusNode &&
                    newDomSelection.anchorOffset === newDomSelection.focusOffset;
                let domSelection;
                if (collapsed && !this._isInEditable(newDomSelection.anchorNode)) {
                    // Prevent a collapsed selection outside the editable
                    // context: keep the current selection.
                    domSelection = currentDomSelection;
                }
                else {
                    domSelection = newDomSelection;
                }
                const setSelectionAction = {
                    type: 'setSelection',
                    domSelection: domSelection,
                };
                return { actions: [setSelectionAction], mutatedElements: new Set([]) };
            });
            this._triggerEventBatch(this._keyboardSelectionTimeout.promise);
            this.initNextObservation();
        }
        else {
            if (this.currentStackObservation._events.length === 0) {
                // The queue is not initialized or has been reset, so this is a
                // new user action. Re-initialize the queue such that the
                // analysis is not polluted by previous observations.
                // this.initNextObservation();
                const stack = this.currentStackObservation;
                // Start observing mutations.
                this._mutationNormalizer.start();
                // All events of this tick will be processed in the next one.
                this._stackTimeout = new Timeout(() => {
                    return this._processEvents(stack);
                });
                this._triggerEventBatch(this._stackTimeout.promise);
            }
            // It is possible to have multiples keys that must trigger multiples
            // times that are being push in the same tick. To be able to handle
            // this case in `_processEvents`, we aggregate the informations in
            // `_multiKeyStack`.
            if (['keydown', 'keypress', 'input'].includes(ev.type)) {
                // In the multiple key case, a 'keydown' is always the first
                // event triggered between the three (keydown, keypress, input).
                // So we create a new map each time a 'keydown' is registred.
                if (ev instanceof KeyboardEvent && ev.type === 'keydown') {
                    this.currentStackObservation._multiKeyStack.push({});
                    // Drop any selection that is not the last one before input.
                    this._swiftKeyDeleteWordSelectionCache = [
                        this._swiftKeyDeleteWordSelectionCache.pop(),
                    ];
                }
                const lastMultiKeys = this.currentStackObservation._multiKeyStack[this.currentStackObservation._multiKeyStack.length - 1];
                if (lastMultiKeys) {
                    lastMultiKeys[ev.type] = ev;
                }
            }
            this.currentStackObservation._eventsMap[ev.type] = ev;
            if (ev.type.startsWith('composition')) {
                // In most cases we only need the last composition of the
                // registred events
                this.currentStackObservation._eventsMap.lastComposition = ev;
            }
            this.currentStackObservation._events.push(ev);
        }
    }
    /**
     * This function is the root of the normalization for most events.
     *
     * Process the events registered with `_regiterEvent` and call
     * `_triggerEventBatch` with one or more `NormalizedEvent` when sufficient
     * information has been gathered from all registred events.
     *
     * It could take up to two tick in the browser to gather all the sufficient
     * information. (e.g. Safari)
     *
     */
    /**
     * In some cases, the observation must be delayed to the next tick. In these
     * cases, this control variable will be set to true such that the analysis
     * process knows the current event queue processing has been delayed.
     */
    async _processEvents(currentStackObservation, secondTickObservation = false) {
        var _a;
        // In some cases, for example cutting with Cmd+X on Safari, the browser
        // triggers events in two different stacks. In such cases, observing
        // events occuring during one tick is not enough so we need to delay the
        // analysis after we observe events during two ticks instead.
        const needSecondTickObservation = currentStackObservation._events.every(ev => {
            return !MultiStackEventTypes.includes(ev.type);
        });
        if (needSecondTickObservation && !secondTickObservation) {
            return await new Promise((resolve) => {
                setTimeout(() => {
                    resolve(this._processEvents(currentStackObservation, true));
                });
            });
        }
        let normalizedActions = [];
        const keydownEvent = currentStackObservation._eventsMap.keydown;
        const keypressEvent = currentStackObservation._eventsMap.keypress;
        const inputEvent = currentStackObservation._eventsMap.input;
        const keyboardSelectAllEvent = currentStackObservation._eventsMap.keyboardSelectAll;
        const compositionEvent = currentStackObservation._eventsMap.lastComposition;
        const cutEvent = currentStackObservation._eventsMap.cut;
        const dropEvent = currentStackObservation._eventsMap.drop;
        const pasteEvent = currentStackObservation._eventsMap.paste;
        const compositionData = this._getCompositionData(compositionEvent, inputEvent);
        const isGoogleKeyboardBackspace = compositionData &&
            compositionData.compositionFrom.slice(0, -1) === compositionData.compositionTo &&
            keydownEvent &&
            keydownEvent.key === 'Unidentified';
        const inferredKeydownEvent = keydownEvent &&
            keydownEvent.key === 'Unidentified' &&
            this._inferKeydownEvent(inputEvent);
        //
        // First pass to get the informations
        //
        const key = (keypressEvent &&
            keypressEvent.key !== 'Unidentified' &&
            keypressEvent.key !== 'Dead' &&
            keypressEvent.key) ||
            (inputEvent && ((_a = inputEvent.data) === null || _a === void 0 ? void 0 : _a.length) === 1 && inputEvent.data) ||
            (keydownEvent &&
                keydownEvent.key !== 'Unidentified' &&
                keydownEvent.key !== 'Dead' &&
                keydownEvent.key) ||
            (isGoogleKeyboardBackspace && 'Backspace') ||
            (keydownEvent &&
                keydownEvent.key === 'Unidentified' &&
                inferredKeydownEvent &&
                inferredKeydownEvent.code);
        const inputType = (cutEvent && 'deleteByCut') ||
            (dropEvent && 'insertFromDrop') ||
            (pasteEvent && 'insertFromPaste') ||
            (inputEvent && inputEvent.inputType);
        // In case of accent inserted from a Mac, check that the char before was
        // one of the special accent temporarily inserted in the DOM (e.g. '^',
        // '`', ...).
        //
        const compositionReplaceOneChar = compositionData &&
            compositionData.compositionFrom.length === 1 &&
            compositionData.compositionTo.length === 1;
        const compositionAddOneChar = compositionData &&
            compositionData.compositionFrom === '' &&
            compositionData.compositionTo.length === 1;
        const isCompositionKeyboard = compositionAddOneChar || compositionReplaceOneChar;
        const isVirtualKeyboard = compositionEvent && key && key.length !== 1;
        // Compute the set of mutated elements accross all observed events.
        const mutatedElements = this._mutationNormalizer.getMutatedElements();
        this._mutationNormalizer.stop();
        // When the browser trigger multiples keydown at once, for each keydown
        // there is always also a keypress and an input that must be present.
        const possibleMultiKeydown = currentStackObservation._multiKeyStack.every(keydownMap => keydownMap.keydown &&
            keydownMap.keydown.key !== 'Unidentified' &&
            (keydownMap.input || keydownMap.keydown.key.length > 1));
        // if there is only one _multiKeyMap, it means that there is no
        // multiples keys pushed.
        if (currentStackObservation._multiKeyStack.length > 1 && possibleMultiKeydown) {
            currentStackObservation._multiKeyStack.map(keydownMap => {
                const keyboardAction = this._getKeyboardAction(keydownMap.keydown.key, (keydownMap.input && keydownMap.input.inputType) || '', !!mutatedElements.size);
                if (keyboardAction) {
                    normalizedActions.push(keyboardAction);
                }
            });
        }
        else if (cutEvent) {
            const deleteContentAction = {
                type: 'deleteContent',
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            };
            // remove previously parsed keyboard action as we only want to remove
            normalizedActions.push(deleteContentAction);
        }
        else if (dropEvent) {
            normalizedActions.push(...this._getDropActions(dropEvent));
        }
        else if (pasteEvent) {
            normalizedActions.push(this._getDataTransferAction(pasteEvent));
        }
        else if (keyboardSelectAllEvent) {
            const selectAllAction = {
                type: 'selectAll',
            };
            normalizedActions.push(selectAllAction);
        }
        else if (normalizedActions.length === 0 &&
            ((!compositionEvent && key) || isCompositionKeyboard || isVirtualKeyboard)) {
            const keyboardAction = this._getKeyboardAction(key, inputType, !!mutatedElements.size, keydownEvent);
            if (keyboardAction) {
                normalizedActions.push(keyboardAction);
            }
            if (compositionReplaceOneChar) {
                normalizedActions = compositionData.actions;
            }
        }
        else if (normalizedActions.length === 0 && compositionData) {
            normalizedActions.push(...compositionData.actions);
        }
        if (inputEvent && inputEvent.inputType && inputEvent.inputType.indexOf('format') === 0) {
            const formatName = inputEvent.inputType.replace('format', '').toLowerCase();
            const applyFormatAction = {
                type: 'applyFormat',
                format: formatName,
                data: inputEvent.data,
            };
            normalizedActions.push(applyFormatAction);
        }
        else if (inputEvent && ['historyUndo', 'historyRedo'].includes(inputEvent.inputType)) {
            const historyAction = {
                type: inputEvent.inputType,
            };
            normalizedActions.push(historyAction);
        }
        this.initNextObservation();
        if (normalizedActions.length > 0) {
            const batch = {
                actions: normalizedActions,
                mutatedElements,
            };
            if (inferredKeydownEvent) {
                batch.inferredKeydownEvent = inferredKeydownEvent;
            }
            return batch;
        }
        return { actions: [] };
    }
    /**
     * Set the next observation.
     */
    initNextObservation() {
        this._followsPointerAction = false;
        this.currentStackObservation = {
            _events: [],
            _multiKeyStack: [],
            _eventsMap: {},
        };
    }
    _getCompositionData(compositionEvent, inputEvent) {
        if (compositionEvent && inputEvent) {
            let compositionDataString = compositionEvent.data;
            // Specific case for SwiftKey. Swiftkey add a space in the
            // inputEvent but not in the composition event.
            const isSwiftKeyAutocorrect = inputEvent.inputType === 'insertText' &&
                inputEvent.data &&
                inputEvent.data.length === 1 &&
                inputEvent.data !== compositionDataString &&
                inputEvent.data === ' ';
            if (isSwiftKeyAutocorrect) {
                compositionDataString += ' ';
            }
            return this._getCompositionFromString(compositionDataString);
        }
        else if (inputEvent && inputEvent.inputType === 'insertReplacementText') {
            // safari trigger an input with 'insertReplacementText' when it
            // correct a word.
            return this._getCompositionFromString(inputEvent.data);
        }
    }
    /**
     * Infer a `KeyboardEvent` `code` from an `InputEvent`
     */
    _inferKeydownEvent(inputEvent) {
        let code;
        if (inputEvent.inputType === 'insertParagraph') {
            code = 'Enter';
        }
        else if (inputEvent.inputType === 'deleteContentBackward') {
            code = 'Backspace';
        }
        else if (inputEvent.inputType === 'deleteContentForward') {
            code = 'Delete';
        }
        if (code) {
            return Object.assign(Object.assign({}, this._modifierKeys), { key: code, code: code });
        }
    }
    /**
     * Get a keyboard action if something has happned in the DOM (insert,
     * delete, navigation).
     *
     * @param key
     * @param inputType
     * @param hasMutataedElements
     * @param isMultiKey
     */
    _getKeyboardAction(key, inputType, hasMutatedElements, keydownEvent) {
        const isInsertOrRemoveAction = hasMutatedElements && !inputTypeCommands.has(inputType);
        if (isInsertOrRemoveAction) {
            if (key === 'Backspace' || key === 'Delete') {
                return this._getRemoveAction(key, inputType, keydownEvent);
            }
            else if (key === 'Enter') {
                if (inputType === 'insertLineBreak') {
                    const insertLineBreakAction = {
                        type: 'insertLineBreak',
                    };
                    return insertLineBreakAction;
                }
                else {
                    const insertParagraphAction = {
                        type: 'insertParagraphBreak',
                    };
                    return insertParagraphAction;
                }
            }
            else if (key.length === 1) {
                const insertTextAction = {
                    type: 'insertText',
                    text: key,
                };
                return insertTextAction;
            }
        }
    }
    /**
     * Get the actions for a event `ev` of type drop.
     *
     * @param ev
     */
    _getDropActions(ev) {
        const actions = [];
        if (ev.draggingFromEditable && !ev.files.length) {
            const selection = document.getSelection();
            if (!selection.isCollapsed) {
                const deleteContentAction = {
                    type: 'deleteContent',
                    direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                };
                actions.push(deleteContentAction);
            }
        }
        const setSelectionAction = {
            type: 'setSelection',
            domSelection: ev.selection,
        };
        actions.push(setSelectionAction);
        actions.push(this._getDataTransferAction(ev));
        return actions;
    }
    /**
     * Extract informations from dataTranser to know what has been done in the
     * DOM and return it a normalizedAction.
     *
     * when drag and dropping, most browsers wrap the element with tags and
     * styles.  And when dropping in the (same or different) browser, there is
     * many differents behavior.
     *
     * Some browser reload the page when dropping (img or link (from status
     * bar)).  For this reason, we block all the content from being added in the
     * editable. (otherwise reloading happen).
     *
     * Note: The user can drag and drop a link or an img, from the browser
     * navigation bar.
     *
     */
    _getDataTransferAction(dataTransfer) {
        if (dataTransfer.files.length) {
            const insertFilesAction = {
                type: 'insertFiles',
                files: dataTransfer.files,
            };
            return insertFilesAction;
        }
        const uri = dataTransfer['text/uri-list'];
        // eslint-disable-next-line no-control-regex
        const html = dataTransfer['text/html'].replace(/\x00/g, ''); // replace for drag&drop from firefox to chrome
        const text = dataTransfer['text/plain'];
        if (html && uri) {
            const temp = document.createElement('temp');
            temp.innerHTML = html;
            const element = temp.querySelector('a, img');
            if (element) {
                if (!dataTransfer.draggingFromEditable &&
                    Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(element) === 'A' &&
                    element.innerHTML === '') {
                    // add default content if it's external link
                    element.innerHTML = uri;
                }
                const insertHtmlAction = {
                    type: 'insertHtml',
                    html: element.outerHTML,
                    text: uri,
                };
                return insertHtmlAction;
            }
            else {
                const insertHtmlAction = {
                    type: 'insertHtml',
                    html: html,
                    text: uri,
                };
                return insertHtmlAction;
            }
        }
        else if (html) {
            const insertHtmlAction = {
                type: 'insertHtml',
                // Cross browser drag & drop will add useless meta tag at the
                // beginning of the html.
                html: html && html.replace(/^<meta[^>]+>/, ''),
                text: text,
            };
            return insertHtmlAction;
        }
        else if (uri) {
            const insertHtmlAction = {
                type: 'insertHtml',
                html: '<a href="' + uri + '">' + uri + '</a>',
                text: uri,
            };
            return insertHtmlAction;
        }
        else {
            const insertTextAction = {
                type: 'insertText',
                text: text,
            };
            return insertTextAction;
        }
    }
    /**
     * Process the composition to identify the text that was inserted.
     *
     * Attention, there is a case impossible to retrieve the complete
     * information. In the case of we don't have the event data and mutation
     * and we might have "a b" change from a composition to "a c". We receive
     * the word change "b" to "c" instead of "a b" to "a c".
     *
     */
    _getCompositionFromString(compositionData) {
        const charMap = this._mutationNormalizer.getCharactersMapping();
        // The goal of this function is to precisely find what was inserted by
        // a keyboard supporting spell-checking and suggestions.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe| was here.'
        //   Current content:  'My friend Christophe Matthieu| was here.'
        //   Actual text inserted by the keyboard: 'Christophe Matthieu'
        let index = charMap.index;
        let insert = charMap.insert;
        let remove = charMap.remove;
        if (insert === remove && compositionData) {
            insert = compositionData;
            remove = compositionData;
        }
        // In mutation:
        // - we get the changes
        // - try to extract the word or a part of the word (with or without
        //   position)
        // - locate: where the change has been made
        const selection = this._getSelection();
        // if index === -1 it means we could not find the position in the mutated elements
        if (index === -1) {
            // It is possible that the index of the observed change are
            // undefined
            // Example (`|` represents the collapsed selection):
            //   Previous content: 'aa aa aa| aa aa'
            //   Current content:  'aa aa aa aa| aa aa'
            //   Actual text inserted by the keyboard: 'aa '
            //   Observed change:  'aa ]aa aa aa aa[ aa'
            // TODO CHM: the below min/max does not cover all cases
            // With most spell-checking mobile keyboards, the range is set right
            // after the inserted text. It can then be used as a marker to
            // identify the end of the change.
            let insertEnd = 0;
            // The text has been flattened in the characters mapping. When
            // the index of the node has been found, use the range offset
            // to find the index of the character proper.
            insertEnd += selection.focusOffset;
            index = insertEnd - insert.length;
        }
        else {
            let offset = index + insert.length - 1;
            if (charMap.current.nodes[offset] &&
                (selection.focusNode !== charMap.current.nodes[offset] ||
                    selection.focusOffset !== charMap.current.offsets[offset] + 1)) {
                offset++;
                while (charMap.current.nodes[offset] &&
                    (selection.focusNode !== charMap.current.nodes[offset] ||
                        selection.focusOffset > charMap.current.offsets[offset])) {
                    const text = charMap.current.chars[offset];
                    insert += text;
                    remove += text;
                    offset++;
                }
            }
        }
        const before = charMap.previous.chars.slice(0, index);
        const match = before.match(alphabetsContainingSpaces);
        if (match &&
            (insert === '' || alphabetsContainingSpaces.test(insert)) &&
            (remove === '' || alphabetsContainingSpaces.test(remove))) {
            // the word is write in a alphabet which contain space, search
            // to complete the change and include the rest of the word
            const beginWord = match[1];
            remove = beginWord + remove;
            insert = beginWord + insert;
            index -= beginWord.length;
            // Some virtual keyboards (e.g. SwiftKey) add a space at the end of
            // each composition such that the insert is ' '. We filter out those
            // events.
        }
        else if (compositionData &&
            insert &&
            (remove || insert !== ' ') &&
            compositionData !== insert) {
            const charIndex = compositionData.lastIndexOf(insert);
            if (charIndex !== -1) {
                index -= charIndex;
                insert = compositionData;
                const len = remove.length + charIndex;
                remove = charMap.previous.chars.slice(index, index + len + 1);
            }
        }
        // Trim the trailing space added by some virtual keyboards (e.g.
        // SwiftKey).
        const removedEndSpace = remove[remove.length - 1] === ' ';
        const insertedEndSpace = insert[insert.length - 1] === ' ';
        let rawRemove = remove;
        let rawInsert = insert;
        if (insertedEndSpace && removedEndSpace) {
            rawRemove = rawRemove.slice(0, -1);
        }
        if (insertedEndSpace) {
            rawInsert = rawInsert.slice(0, -1);
        }
        const previousNodes = charMap.previous.nodes;
        const previousOffsets = charMap.previous.offsets;
        const lastPreviousNode = previousNodes[previousNodes.length - 1];
        const lastPreviousOffset = previousOffsets[previousOffsets.length - 1] + 1;
        const offsetEnd = index + rawRemove.length;
        const setSelectionAction = {
            type: 'setSelection',
            domSelection: {
                anchorNode: previousNodes[index] || lastPreviousNode,
                anchorOffset: index in previousOffsets ? previousOffsets[index] : lastPreviousOffset,
                focusNode: previousNodes[offsetEnd] || lastPreviousNode,
                focusOffset: offsetEnd in previousOffsets ? previousOffsets[offsetEnd] : lastPreviousOffset,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            },
        };
        const insertTextAction = {
            type: 'insertText',
            text: rawInsert,
        };
        const actions = [setSelectionAction, insertTextAction];
        if (insertedEndSpace) {
            if (removedEndSpace) {
                index += rawRemove.length;
                const setSelectionAction = {
                    type: 'setSelection',
                    domSelection: {
                        anchorNode: previousNodes[index],
                        anchorOffset: previousOffsets[index],
                        focusNode: previousNodes[offsetEnd],
                        focusOffset: previousOffsets[index + 1],
                        direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                    },
                };
                actions.push(setSelectionAction);
            }
            const insertTextAction = {
                type: 'insertText',
                text: ' ',
            };
            actions.push(insertTextAction);
        }
        return {
            compositionFrom: remove,
            compositionTo: insert,
            actions: actions,
        };
    }
    /**
     * Process the given compiled event as a backspace/delete to identify the
     * text that was removed and return an array of the corresponding
     * NormalizedAction.
     *
     * In the case of cut event, the direction will be `Direction.FORWARD`.
     *
     */
    _getRemoveAction(key, inputType, keydownEvent) {
        const direction = key === 'Backspace' ? _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD : _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD;
        // Check if this is a deleteWord from the SwiftKey mobile keyboard. This
        // be triggered by long-pressing the backspace key, however SwiftKey
        // does not trigger a proper deleteWord event so we must detect it.
        // This is extremely ad-hoc for the particular case of SwiftKey and we
        // need to retrieve the selection as it was right before the deletion.
        const selection = this._swiftKeyDeleteWordSelectionCache[0];
        this._swiftKeyDeleteWordSelectionCache.length = 0;
        // Get characterMapping to retrieve which word has been deleted.
        const characterMapping = this._mutationNormalizer.getCharactersMapping();
        const isCollapsed = selection &&
            selection.anchorNode === selection.focusNode &&
            selection.anchorOffset === selection.focusOffset;
        const isSwiftKeyDeleteWord = (inputType === 'deleteContentForward' || inputType === 'deleteContentBackward') &&
            (keydownEvent === null || keydownEvent === void 0 ? void 0 : keydownEvent.key) === 'Unidentified' &&
            isCollapsed &&
            characterMapping.remove.length > 1;
        if (inputType === 'deleteWordForward' ||
            inputType === 'deleteWordBackward' ||
            isSwiftKeyDeleteWord) {
            const deleteWordAction = {
                type: 'deleteWord',
                direction: direction,
                text: characterMapping.remove,
            };
            return deleteWordAction;
        }
        if (inputType === 'deleteHardLineForward' ||
            inputType === 'deleteHardLineBackward' ||
            inputType === 'deleteSoftLineForward' ||
            inputType === 'deleteSoftLineBackward') {
            const deleteHardLineAction = {
                type: 'deleteHardLine',
                direction: direction,
                domSelection: {
                    anchorNode: characterMapping.previous.nodes[characterMapping.index],
                    anchorOffset: characterMapping.previous.offsets[characterMapping.index],
                    focusNode: characterMapping.previous.nodes[characterMapping.index + characterMapping.remove.length - 1],
                    focusOffset: characterMapping.previous.offsets[characterMapping.index + characterMapping.remove.length - 1] + 1,
                    direction: direction,
                },
            };
            return deleteHardLineAction;
        }
        const deleteContentAction = {
            type: 'deleteContent',
            direction: direction,
        };
        return deleteContentAction;
    }
    /**
     * Return true if the given node can be considered a textual node, that is
     * a text node or a BR node.
     *
     * @param node
     */
    _isTextualNode(node) {
        return node.nodeType === Node.TEXT_NODE || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(node) === 'BR';
    }
    /**
     * Get the current selection from the DOM. If there is no selection in the
     * DOM, return a fake one at offset 0 of the editable element.
     * If an event is given, then the selection must be at least partially
     * contained in the target of the event, otherwise it means it took no
     * part in it. In this case, return the caret position instead.
     *
     * @param [ev]
     */
    _getSelection(ev) {
        var _a;
        let selectionDescription;
        let target;
        let root;
        if (ev) {
            target = this._getEventTarget(ev);
            root = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["getDocument"])(target);
        }
        else if ((_a = this._initialCaretPosition) === null || _a === void 0 ? void 0 : _a.offsetNode) {
            root = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["getDocument"])(this._initialCaretPosition.offsetNode);
        }
        else {
            root = document;
        }
        const selection = root.getSelection
            ? root.getSelection()
            : root.ownerDocument.getSelection();
        let forward;
        if (!selection || selection.rangeCount === 0) {
            // No selection in the DOM. Create a fake one.
            selectionDescription = {
                anchorNode: document.body,
                anchorOffset: 0,
                focusNode: document.body,
                focusOffset: 0,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            };
        }
        else {
            // The selection direction is sorely missing from the DOM api.
            const nativeRange = selection.getRangeAt(0);
            if (selection.anchorNode === selection.focusNode) {
                forward = selection.anchorOffset <= selection.focusOffset;
            }
            else {
                forward = selection.anchorNode === nativeRange.startContainer;
            }
            selectionDescription = {
                anchorNode: selection.anchorNode,
                anchorOffset: selection.anchorOffset,
                focusNode: selection.focusNode,
                focusOffset: selection.focusOffset,
                direction: forward ? _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD : _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD,
            };
        }
        // If an event is given, then the range must be at least partially
        // contained in the target of the event, otherwise it means it took no
        // part in it. In this case, consider the caret position instead.
        // This can happen when target is an input or a contenteditable=false.
        if (target instanceof Node) {
            const caretPosition = this._getEventCaretPosition(ev);
            if (!target.contains(selectionDescription.anchorNode) &&
                !target.contains(selectionDescription.focusNode) &&
                caretPosition.offsetNode === target) {
                selectionDescription = {
                    anchorNode: caretPosition.offsetNode,
                    anchorOffset: caretPosition.offset,
                    focusNode: caretPosition.offsetNode,
                    focusOffset: caretPosition.offset,
                    direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                };
            }
        }
        return selectionDescription;
    }
    /**
     * Check if the given range is selecting the whole editable.
     *
     * @param selection
     */
    _isSelectAll(selection) {
        // The selection from the context menu or a shortcut never have
        // direction forward.
        if (selection.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD) {
            return false;
        }
        let startContainer = selection.anchorNode;
        let startOffset = selection.anchorOffset;
        let endContainer = selection.focusNode;
        let endOffset = selection.focusOffset;
        // The selection might still be on a node which has since been removed.
        let invalidStart = true;
        let domNode = startContainer;
        while (domNode && invalidStart) {
            if (domNode instanceof ShadowRoot) {
                domNode = domNode.host;
            }
            else if (document.body.contains(domNode)) {
                invalidStart = false;
            }
            else {
                domNode = domNode.parentNode;
            }
        }
        let invalidEnd = true;
        domNode = endContainer;
        while (domNode && invalidEnd) {
            if (domNode instanceof ShadowRoot) {
                domNode = domNode.host;
            }
            else if (document.body.contains(domNode)) {
                invalidEnd = false;
            }
            else {
                domNode = domNode.parentNode;
            }
        }
        const invalidSelection = invalidStart || invalidEnd;
        // The selection might be collapsed in which case there is no selection.
        const onlyOneNodeSelected = startContainer === endContainer;
        const noCharacterSelected = startOffset === endOffset;
        const isCollapsed = onlyOneNodeSelected && noCharacterSelected;
        // If the selection is invalid or the selection is collapsed, it
        // definitely does not correspond to a select all action.
        if (invalidSelection || isCollapsed) {
            return false;
        }
        [startContainer, startOffset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(startContainer, startOffset);
        [endContainer, endOffset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(endContainer, endOffset);
        // Look for visible nodes in editable that would be outside the range.
        const startInsideEditable = this._isInEditable(startContainer);
        const endInsideEditable = this._isInEditable(endContainer);
        if (startInsideEditable && endInsideEditable) {
            return (startOffset === 0 &&
                this._isAtVisibleEdge(startContainer, 'start') &&
                this._isAtVisibleEdge(endContainer, 'end'));
        }
        else if (startInsideEditable) {
            return startOffset === 0 && this._isAtVisibleEdge(startContainer, 'start');
        }
        else if (endInsideEditable) {
            return this._isAtVisibleEdge(endContainer, 'end');
        }
        else {
            return true;
        }
    }
    /**
     * Return true if the given element is at the edge of the editable node in
     * the given direction. An element is considered at the edge of the editable
     * node if there is no other visible element in editable that is located
     * beyond it in the given direction.
     *
     * @param node to check whether it is at the visible edge
     * @param side from which to look for textual nodes ('start' or 'end')
     */
    _isAtVisibleEdge(node, side) {
        const editable = this._getClosestElement(node).closest('[contentEditable=true]');
        // Start from the top and do a depth-first search trying to find a
        // visible node that would be in editable and beyond the given element.
        let currentNode = editable;
        const child = side === 'start' ? 'firstChild' : 'lastChild';
        const sibling = side === 'start' ? 'nextSibling' : 'previousSibling';
        let crossVisible = false;
        while (currentNode) {
            if (currentNode === node) {
                // The element was reached without finding another visible node.
                return !crossVisible;
            }
            if (this._isTextualNode(currentNode) && this._isVisible(currentNode, editable)) {
                // There is a textual node in editable beyond the given element.
                crossVisible = true;
            }
            // Continue the depth-first search.
            if (currentNode[child]) {
                currentNode = currentNode[child];
            }
            else if (currentNode[sibling]) {
                currentNode = currentNode[sibling];
            }
            else if (currentNode.parentNode === editable) {
                // Depth-first search has checked all elements in editable.
                return true;
            }
            else {
                let ancestor = currentNode.parentNode;
                currentNode = ancestor[sibling];
                // When checking from the end we need to go up the ancestors
                // tree to find one which does have a previous sibling.
                while (!currentNode && side === 'end') {
                    ancestor = ancestor.parentNode;
                    currentNode = ancestor[sibling];
                }
            }
        }
        return false;
    }
    /**
     * Determine if a node is considered visible.
     */
    _isVisible(el, editable) {
        if (el === document) {
            return false;
        }
        if (el === editable) {
            // The editable node was reached without encountering a hidden
            // container. The editable node is supposed to be visible.
            return true;
        }
        // A <br> element with no next sibling is never visible.
        if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(el) === 'BR' && !el.nextSibling) {
            return false;
        }
        const style = window.getComputedStyle(this._getClosestElement(el));
        if (style.display === 'none' || style.visibility === 'hidden') {
            return false;
        }
        return this._isVisible(el.parentNode, editable);
    }
    /**
     * Return the node and offset targeted by a event, including if the target
     * is inside a shadow element
     *
     * @param ev
     */
    _getEventCaretPosition(ev) {
        const x = ev.constructor.name === 'TouchEvent'
            ? ev.touches[0].clientX
            : ev.clientX;
        const y = ev.constructor.name === 'TouchEvent'
            ? ev.touches[0].clientY
            : ev.clientY;
        const target = ev.target;
        let caretPosition = Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__["caretPositionFromPoint"])(x, y, target.ownerDocument);
        if (!caretPosition) {
            caretPosition = { offsetNode: ev.target, offset: 0 };
        }
        return caretPosition;
    }
    /**
     * Use the position to get the target from the event (including the target
     * in shadow element)
     *
     * @param ev
     */
    _getEventTarget(ev) {
        const x = ev.constructor.name === 'TouchEvent'
            ? ev.touches[0].clientX
            : ev.clientX;
        const y = ev.constructor.name === 'TouchEvent'
            ? ev.touches[0].clientY
            : ev.clientY;
        const target = ev.target;
        return Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__["elementFromPoint"])(x, y, target.ownerDocument) || target;
    }
    //--------------------------------------------------------------------------
    // Handlers
    //--------------------------------------------------------------------------
    /**
     * Catch setSelection and selectAll actions
     *
     * @param {MouseEvent} ev
     */
    _onContextMenu(ev) {
        var _a;
        if ((_a = this._pointerSelectionTimeout) === null || _a === void 0 ? void 0 : _a.pending) {
            this._pointerSelectionTimeout.fire();
        }
        this._pointerSelectionTimeout = new Timeout(() => {
            if (!this._selectionHasChanged || this._currentlySelectingAll) {
                return { actions: [] };
            }
            this._initialCaretPosition = this._getEventCaretPosition(ev);
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: this._getSelection(ev),
            };
            this._selectionHasChanged = false;
            return {
                actions: [setSelectionAction],
                mutatedElements: new Set([]),
            };
        });
        this._triggerEventBatch(this._pointerSelectionTimeout.promise);
        // The _clickedInEditable property is used to assess whether the user is
        // currently changing the selection by using the mouse. If the context
        // menu ends up opening, the user is definitely not selecting.
        this._mousedownInEditable = false;
    }
    /**
     * Catch Enter, Backspace, Delete and insert actions
     *
     * @param {KeyboardEvent} ev
     */
    _onKeyDownOrKeyPress(ev) {
        this._updateModifiersKeys(ev);
        this._registerEvent(ev);
        const selection = this._getSelection();
        const [offsetNode, offset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(selection.anchorNode, selection.anchorOffset);
        this._initialCaretPosition = { offsetNode, offset };
    }
    /**
     * Set internal properties of the pointer down event to retrieve them later
     * on when the user stops dragging its selection and the selection has
     * changed.
     *
     * @param {MouseEvent} ev
     */
    _onPointerDown(ev) {
        // Don't trigger events on the editable if the click was done outside of
        // the editable itself or on something else than an element.
        const target = this._getEventTarget(ev);
        const caretPosition = this._getEventCaretPosition(ev);
        if (target && this._isInEditable(caretPosition.offsetNode)) {
            this._mousedownInEditable = true;
            this._initialCaretPosition = caretPosition;
            this._selectionHasChanged = false;
            this._followsPointerAction = true;
        }
        else {
            this._mousedownInEditable = false;
            this._initialCaretPosition = undefined;
        }
    }
    /**
     * Catch setSelection actions coming from clicks.
     *
     * @param ev
     */
    _onPointerUp(ev) {
        // Don't trigger events on the editable if the click was done outside of
        // the editable itself or on something else than an element.
        if (this._mousedownInEditable && ev.target instanceof Element) {
            try {
                // When the users clicks in the DOM, the range is set in the next
                // tick. The observation of the resulting range must thus be delayed
                // to the next tick as well. Store the data we have now before it
                // gets invalidated by the redrawing of the DOM.
                this._initialCaretPosition = this._getEventCaretPosition(ev);
                this._pointerSelectionTimeout = new Timeout(() => {
                    return this._analyzeSelectionChange(ev);
                });
                this._triggerEventBatch(this._pointerSelectionTimeout.promise);
            }
            catch (e) {
                this._mousedownInEditable = false;
                this._initialCaretPosition = undefined;
            }
        }
        else if (ev.target instanceof Element && !!ev.target.closest('[contentEditable=true]')) {
            // When within a contenteditable element but in a non-editable
            // context, prevent a collapsed selection by removing all ranges.
            // TODO: remove them from the VDocument as well.
            this._pointerSelectionTimeout = new Timeout(() => {
                const selection = this._getSelection();
                const collapsed = selection.anchorNode === selection.focusNode &&
                    selection.anchorOffset === selection.focusOffset;
                const target = this._getClosestElement(selection.focusNode);
                if (collapsed && !!target.closest('[contentEditable=true]')) {
                    document.getSelection().removeAllRanges();
                }
                return {
                    actions: [],
                };
            });
            this._triggerEventBatch(this._pointerSelectionTimeout.promise);
        }
    }
    /**
     * Analyze a change of selection to trigger a pointer event for it.
     *
     * @param ev
     */
    _analyzeSelectionChange(ev) {
        const eventBatch = {
            actions: [],
            mutatedElements: new Set([]),
        };
        if (this._selectionHasChanged) {
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: this._getSelection(ev),
            };
            eventBatch.actions.push(setSelectionAction);
        }
        return eventBatch;
    }
    /**
     * Return a node's parent if it's not an instance of `Element`.
     *
     * @param node
     */
    _getClosestElement(node) {
        return node instanceof Element ? node : node.parentElement;
    }
    /**
     * If the drag start event is observed by the normalizer, it means the
     * dragging started in the editable itself. It means the user is dragging
     * content around in the editable zone.
     *
     */
    _onDragStart() {
        this._draggingFromEditable = true;
    }
    /**
     * Convert the drop event into a custom pre-processed format in order to
     * store additional information that are specific to this point in time,
     * such as the current range and the initial caret position.
     *
     * In some browser we need to infer the drop from other events.
     *
     * Example of droppable object are file, text, url.
     *
     * Drop event can originate from another software, outside the editor zone
     * or inside the editor zone.
     *
     * @param ev
     */
    _onDrop(ev) {
        // Prevent default behavior (e.g. prevent file from being opened in the
        // current tab).
        ev.preventDefault();
        const transfer = ev.dataTransfer;
        const files = [];
        for (const item of transfer.items) {
            if (item.kind === 'file') {
                files.push(item.getAsFile());
            }
        }
        const caretPosition = this._getEventCaretPosition(ev);
        const dropEvent = {
            type: 'drop',
            'text/plain': transfer.getData('text/plain'),
            'text/html': transfer.getData('text/html'),
            'text/uri-list': transfer.getData('text/uri-list'),
            files: files,
            originalEvent: ev,
            selection: {
                anchorNode: caretPosition.offsetNode,
                anchorOffset: caretPosition.offset,
                focusNode: caretPosition.offsetNode,
                focusOffset: caretPosition.offset,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            },
            caretPosition: caretPosition,
            draggingFromEditable: this._draggingFromEditable,
        };
        this._registerEvent(dropEvent);
        // Dragging is over, reset this property.
        this._draggingFromEditable = false;
    }
    /**
     * Convert the clipboard event into a custom pre-processed format in order
     * to store additional information that are specific to this point in time,
     * such as the current range and the initial caret position.
     *
     * @param ev
     */
    _onClipboard(ev) {
        if (ev.type === 'paste') {
            // Prevent the default browser wild pasting behavior.
            ev.preventDefault();
        }
        const clipboard = ev.clipboardData;
        const pasteEvent = {
            type: ev.type,
            'text/plain': clipboard.getData('text/plain'),
            'text/html': clipboard.getData('text/html'),
            'text/uri-list': clipboard.getData('text/uri-list'),
            files: [],
            originalEvent: ev,
            selection: this._getSelection(),
            caretPosition: this._initialCaretPosition,
            draggingFromEditable: false,
        };
        this._registerEvent(pasteEvent);
    }
    /**
     * Update the modifiers keys to know which modifiers keys are pushed.
     *
     * @param e
     */
    _updateModifiersKeys(e) {
        this._modifierKeys = {
            ctrlKey: e.ctrlKey,
            altKey: e.altKey,
            metaKey: e.metaKey,
            shiftKey: e.shiftKey,
        };
    }
    /**
     * On each change of selection, check if it might be a "selectAll" action.
     *
     * A "selectAll" action can be triggered by:
     * - The shortcut 'CTRL+A'
     * - A user mapping of the OS or browser
     * - From the context menu
     * - Programmatically
     */
    _onSelectionChange() {
        if (!this._initialCaretPosition) {
            // Filter the events because we can have some Shadow root and each
            // normaliser bind event on document.
            return;
        }
        const selection = this._getSelection();
        this._swiftKeyDeleteWordSelectionCache.push(selection);
        const keydownEvent = this.currentStackObservation._eventsMap.keydown;
        const isNavEvent = keydownEvent instanceof KeyboardEvent &&
            keydownEvent.type === 'keydown' &&
            navigationKey.has(keydownEvent.key);
        if (isNavEvent) {
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: selection,
            };
            this.initNextObservation();
            this._triggerEventBatch(new Promise((resolve) => {
                setTimeout(() => {
                    resolve({ actions: [setSelectionAction] });
                });
            }));
        }
        else {
            this._selectionHasChanged = true;
            // This heuristic protects against a costly `_isSelectAll` call.
            const modifiedKeyEvent = this._modifierKeys.ctrlKey || this._modifierKeys.metaKey;
            const heuristic = modifiedKeyEvent || this._followsPointerAction;
            const isSelectAll = heuristic && this._isSelectAll(selection);
            if (isSelectAll && !this._currentlySelectingAll) {
                if (modifiedKeyEvent) {
                    // This select all was triggered from the keyboard. Add a
                    // fake selectAll event to the queue as a marker for
                    // `_processEvents` to register that a select all was
                    // triggered in this stack.
                    this._registerEvent(new CustomEvent('keyboardSelectAll'));
                }
                else {
                    // The target of the select all specifies where the user caret
                    // was when the select all was triggered.
                    const selectAllAction = {
                        type: 'selectAll',
                    };
                    // We did not find any case where a select all triggered
                    // from the mouse actually resulted in a mutation, so the
                    // mutation normalizer is not listnening in this case. If it
                    // happens to be insufficient later on, the mutated elements
                    // will need to be retrieved from the mutation normalizer.
                    this._triggerEventBatch(Promise.resolve({
                        actions: [selectAllAction],
                        mutatedElements: new Set(),
                    }));
                }
            }
            // Safari on MacOS triggers a selection change when pressing Ctrl
            // even though the selection did not actually change. This property
            // is used to store whether the current state is considered to be a
            // select all. The point is to avoid triggering a new event for a
            // selection change if everything was already selected beforehand.
            this._currentlySelectingAll = isSelectAll;
        }
    }
    /**
     * Create an instance of EventNormalizer if the pointer touch a shadow node.
     *
     * @param {MouseEvent} ev
     */
    _onEventEnableNormalizer(ev) {
        this._enableNormalizer(ev.target);
    }
    /**
     * Create an instance of EventNormalizer for the given element with shadow
     * content or iframe content.
     * To be editable an iframe cannot have src because it must be an iframe
     * with content generated by the editor.
     *
     * @param {Element} el
     */
    _enableNormalizer(el) {
        const root = el.shadowRoot ||
            (el instanceof HTMLIFrameElement &&
                (!el.src || el.src === window.location.href) &&
                el.contentWindow.document);
        if (root && !this._shadowNormalizers.get(root)) {
            const eventNormalizer = new EventNormalizer(this._isInEditable, this._triggerEventBatch, this.processKeydown, root);
            this._shadowNormalizers.set(root, eventNormalizer);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-editable/src/MutationNormalizer.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-dom-editable/src/MutationNormalizer.ts ***!
  \****************************************************************/
/*! exports provided: MutationNormalizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationNormalizer", function() { return MutationNormalizer; });
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");

class MutationNormalizer {
    constructor(el = document.body) {
        this._observer = new MutationObserver(this._onMutation.bind(this));
        this._observer.observe(el, {
            characterDataOldValue: true,
            characterData: true,
            childList: true,
            subtree: true,
        });
    }
    start() {
        this._listen = true;
        this._mutations = [];
    }
    /**
     * Extract a mapping of the separate characters, their corresponding text
     * nodes and their offsets in said nodes from the given node's subtree.
     *
     * @private
     * @param charMutations
     * @returns { previous, current }
     */
    getCharactersMapping() {
        const before = new Set();
        const add = new Set();
        const current = new Set();
        const textMutations = [];
        // Gather all modified nodes to notify the listener.
        function getSelfAndAllChildren(target) {
            const texts = [target];
            target.childNodes.forEach(target => {
                texts.push(...getSelfAndAllChildren(target));
            });
            return texts;
        }
        function isTextNode(target) {
            return target.nodeType === Node.TEXT_NODE || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["nodeName"])(target) === 'BR';
        }
        this._mutations.forEach(record => {
            const targetMutation = record.target;
            const targetIsAdded = add.has(targetMutation);
            if (!targetIsAdded) {
                before.add(targetMutation);
            }
            if (record.type === 'characterData') {
                current.add(targetMutation);
                textMutations.push({
                    target: targetMutation,
                    old: record.oldValue.replace(/\u00A0/g, ' '),
                    current: targetMutation.textContent.replace(/\u00A0/g, ' '),
                });
            }
            else {
                record.addedNodes.forEach(node => {
                    getSelfAndAllChildren(node).forEach(child => {
                        if (!before.has(child)) {
                            add.add(child);
                        }
                        current.add(child);
                        if (!isTextNode(child)) {
                            return;
                        }
                        textMutations.push({
                            target: child,
                            old: '',
                            current: child.nodeType === Node.TEXT_NODE
                                ? child.textContent.replace(/\u00A0/g, ' ')
                                : '\n',
                        });
                    });
                });
                record.removedNodes.forEach(node => {
                    getSelfAndAllChildren(node).forEach(child => {
                        if (current.has(child)) {
                            current.delete(child);
                        }
                        if (targetIsAdded) {
                            add.add(child);
                        }
                        if (!add.has(child)) {
                            before.add(child);
                        }
                        if (!isTextNode(child)) {
                            return;
                        }
                        textMutations.push({
                            target: child,
                            old: child.nodeType === Node.TEXT_NODE
                                ? child.textContent.replace(/\u00A0/g, ' ')
                                : '\n',
                            current: '',
                        });
                    });
                });
            }
        });
        const already = new Map();
        const charMutations = [];
        textMutations.forEach(textMutation => {
            const target = textMutation.target;
            let mutation = already.get(target);
            if (mutation) {
                if (current.has(target) && !mutation.current.length) {
                    mutation.current = textMutation.current;
                }
                return;
            }
            if (current.has(target)) {
                mutation = {
                    target: target,
                    old: before.has(target) ? textMutation.old : '',
                    current: textMutation.current,
                };
                charMutations.push(mutation);
            }
            else if (before.has(target)) {
                mutation = {
                    target: target,
                    old: textMutation.old,
                    current: '',
                };
                charMutations.push(mutation);
            }
            already.set(target, mutation);
        });
        const currentLinked = this._getCharLinked(charMutations, 'current');
        const previousLinked = this._getCharLinked(charMutations, 'old');
        const oldText = previousLinked.chars;
        const currentText = currentLinked.chars;
        if (oldText === currentText) {
            return {
                index: -1,
                insert: '',
                remove: '',
                previous: previousLinked,
                current: currentLinked,
            };
        }
        const changePosition = this._changedOffset(oldText, currentText);
        const minLength = Math.min(oldText.length, currentText.length);
        let insertByChange;
        const unknownPosition = changePosition.left > minLength - changePosition.right;
        if (unknownPosition) {
            const maxLength = Math.max(oldText.length, currentText.length);
            const len = maxLength - minLength;
            insertByChange = currentText.slice(currentText.length - changePosition.right);
            for (let k = 0; k + len < minLength; k++) {
                if (insertByChange[k - 1] === ' ') {
                    insertByChange = insertByChange.slice(k);
                    break;
                }
            }
            insertByChange = insertByChange.slice(0, len);
            const removeByChange = oldText.slice(oldText.length - changePosition.right - len, oldText.length - changePosition.right);
            return {
                index: -1,
                insert: insertByChange,
                remove: removeByChange,
                previous: previousLinked,
                current: currentLinked,
            };
        }
        else {
            insertByChange = currentText.slice(changePosition.left, currentText.length - changePosition.right);
        }
        let fineChangePosition;
        let insertedWordAnalysed;
        if (textMutations.length > 1) {
            let alreadyFound = false;
            for (let k = textMutations.length - 1; k >= 0; k--) {
                const charMutation = textMutations[k];
                if (charMutation.old.length >= charMutation.current.length) {
                    continue;
                }
                let currentChange;
                if (charMutation.old !== '') {
                    if (alreadyFound) {
                        continue;
                    }
                    const oldTextMutation = charMutation.old;
                    const currentTextMutation = charMutation.current;
                    const resMutation = this._changedOffset(oldTextMutation, currentTextMutation);
                    currentChange = currentTextMutation.slice(resMutation.left, currentTextMutation.length - resMutation.right);
                }
                else if (charMutation.current === currentText) {
                    continue;
                }
                else {
                    currentChange = charMutation.current;
                }
                const changeIndex = currentChange.indexOf(insertByChange);
                if (changeIndex === -1) {
                    continue;
                }
                const indexStart = currentText.indexOf(currentChange);
                const indexEnd = indexStart + currentChange.length;
                const rangeChangeStart = changePosition.left - changeIndex;
                const rangeChangeEnd = currentText.length - changePosition.right;
                if ((rangeChangeStart >= indexStart && rangeChangeStart < indexEnd) ||
                    (rangeChangeEnd > indexStart && rangeChangeEnd <= indexEnd) ||
                    (rangeChangeEnd >= indexEnd && rangeChangeStart <= indexStart)) {
                    fineChangePosition = {
                        left: indexStart,
                        right: currentText.length - indexEnd,
                    };
                    insertedWordAnalysed = currentChange;
                    alreadyFound = true;
                    if (charMutation.old === '') {
                        break;
                    }
                }
            }
        }
        if (typeof insertedWordAnalysed === 'undefined') {
            insertedWordAnalysed = insertByChange;
            let beforeIndex = insertedWordAnalysed.indexOf(insertByChange);
            if (insertByChange === '') {
                beforeIndex = insertedWordAnalysed.length;
            }
            else {
                beforeIndex = 0;
            }
            fineChangePosition = {
                left: changePosition.left - beforeIndex,
                right: changePosition.right,
            };
        }
        const removedWordAnalysed = oldText.slice(fineChangePosition.left, oldText.length - fineChangePosition.right);
        return {
            index: fineChangePosition.left,
            insert: insertedWordAnalysed,
            remove: removedWordAnalysed,
            previous: previousLinked,
            current: currentLinked,
        };
    }
    getMutatedElements() {
        const elements = new Set();
        this._mutations.forEach(MutationRecord => {
            if (MutationRecord.type === 'characterData') {
                elements.add(MutationRecord.target);
            }
            else {
                MutationRecord.addedNodes.forEach(target => elements.add(target));
                MutationRecord.removedNodes.forEach(target => elements.add(target));
            }
        });
        return elements;
    }
    stop() {
        this._listen = false;
    }
    /**
     * Called when destroy the mutation normalizer.
     * Remove all added handlers.
     *
     */
    destroy() {
        this._observer.disconnect();
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _getCharLinked(charMutations, type) {
        const mapNodeValue = new WeakMap();
        const obj = {
            chars: '',
            nodes: [],
            offsets: [],
        };
        charMutations.forEach(charMutation => {
            mapNodeValue.set(charMutation.target, charMutation[type]);
            const len = charMutation[type].length;
            if (obj.nodes.length) {
                const charParented = new Set();
                let node = charMutation.target;
                while (node &&
                    (!(node instanceof Element) || !node.getAttribute('contentEditable'))) {
                    charParented.add(node);
                    node = node.parentNode;
                }
                let first = obj.nodes[0];
                while (first &&
                    (!(first instanceof Element) || !first.getAttribute('contentEditable'))) {
                    if (charParented.has(first.previousSibling)) {
                        obj.chars = charMutation[type] + obj.chars;
                        obj.nodes.unshift(...new Array(len).fill(charMutation.target));
                        obj.offsets.unshift(...Array(len).keys());
                        return;
                    }
                    first = first.parentNode;
                }
            }
            obj.chars += charMutation[type];
            obj.nodes.push(...new Array(len).fill(charMutation.target));
            obj.offsets.push(...Array(len).keys());
        });
        obj.chars = obj.chars.replace(/\u00A0/g, ' ');
        return obj;
    }
    _changedOffset(old, current) {
        // In the optimal case where both the range is correctly placed and the
        // data property of the composition event is correctly set, the above
        // analysis is capable of finding the precise text that was inserted.
        // However, if any of these two conditions are not met, the results
        // might be spectacularly wrong. For example, spell checking suggestions
        // on MacOS are displayed while hovering the mispelled word, regardless
        // of the current position of the range, and the correction does not
        // trigger an update of the range position either after correcting.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe was here.|'
        //   Current content:  'My friend Christophe Matthieu was here.|'
        //   Actual text inserted by the keyboard: 'Christophe Matthieu'
        //   Result if data is set to 'Christophe' (length: 10): 'e was here'
        //   Result if data is not set (regardless of the range): ''
        //
        // Because the first analysis might not be enough in some cases, a
        // second analysis must be performed. This analysis aims at precisely
        // identifying the offset of the actual change in the text by comparing
        // the previous content with the current one from left to right to find
        // the start of the change and from right to left to find its end.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe| was here.'
        //   Current content:  'My friend Christophe Matthieu| was here.'
        //   Observed change:  'My friend Christo[fe => phe Matthieu] was here.'
        //   Change offsets in the current content: {left: 17, right: 29}
        const oldText = old;
        const currentText = current;
        const maxLength = Math.max(oldText.length, currentText.length);
        let left = 0;
        for (; left < maxLength; left++) {
            if (oldText[left] !== currentText[left]) {
                break;
            }
        }
        let right = 0;
        for (; right < maxLength; right++) {
            if (oldText[oldText.length - 1 - right] !== currentText[currentText.length - 1 - right]) {
                break;
            }
        }
        return { left, right };
    }
    //--------------------------------------------------------------------------
    // Handlers
    //--------------------------------------------------------------------------
    _onMutation(mutationsList) {
        if (this._listen) {
            // we push the mutation because some browser (e.g. safari) separate mutations with
            // microtask.
            this._mutations.push(...mutationsList);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-follow-range/assets/FollowRange.css":
/*!*****************************************************************!*\
  !*** ./packages/plugin-dom-follow-range/assets/FollowRange.css ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./FollowRange.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dom-follow-range/assets/FollowRange.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-dom-follow-range/src/FollowRange.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-dom-follow-range/src/FollowRange.ts ***!
  \*************************************************************/
/*! exports provided: FollowRange */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FollowRange", function() { return FollowRange; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _FollowRangeZoneNodeXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FollowRangeZoneNodeXmlDomParser */ "./packages/plugin-dom-follow-range/src/FollowRangeZoneNodeXmlDomParser.ts");
/* harmony import */ var _FollowRangeZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FollowRangeZoneDomObjectRenderer */ "./packages/plugin-dom-follow-range/src/FollowRangeZoneDomObjectRenderer.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");







class FollowRange extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_FollowRangeZoneNodeXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["FollowRangeZoneNodeXmlDomParser"]],
            renderers: [_FollowRangeZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__["FollowRangeZoneDomObjectRenderer"]],
        };
    }
}
FollowRange.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__["Renderer"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__["DomLayout"], _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__["Layout"]];


/***/ }),

/***/ "./packages/plugin-dom-follow-range/src/FollowRangeZoneDomObjectRenderer.ts":
/*!**********************************************************************************!*\
  !*** ./packages/plugin-dom-follow-range/src/FollowRangeZoneDomObjectRenderer.ts ***!
  \**********************************************************************************/
/*! exports provided: FollowRangeZoneDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FollowRangeZoneDomObjectRenderer", function() { return FollowRangeZoneDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _FollowRangeZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FollowRangeZoneNode */ "./packages/plugin-dom-follow-range/src/FollowRangeZoneNode.ts");
/* harmony import */ var _utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/Dom */ "./packages/utils/src/Dom.ts");
/* harmony import */ var _assets_FollowRange_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../assets/FollowRange.css */ "./packages/plugin-dom-follow-range/assets/FollowRange.css");
/* harmony import */ var _assets_FollowRange_css__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_assets_FollowRange_css__WEBPACK_IMPORTED_MODULE_4__);





class FollowRangeZoneDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _FollowRangeZoneNode__WEBPACK_IMPORTED_MODULE_2__["FollowRangeZoneNode"];
    }
    async render(node) {
        if (node.hasChildren()) {
            let debounce;
            let followRangeDebounced;
            const followRange = {
                tag: 'JW-FOLLOW-RANGE',
                children: node.children(),
                attributes: { style: { 'display': 'none' } },
                attach: (el) => {
                    followRangeDebounced = () => {
                        window.clearTimeout(debounce);
                        debounce = window.setTimeout(this._followChangedSelection.bind(this, el), 3);
                    };
                    document.addEventListener('selectionchange', followRangeDebounced, false);
                    window.addEventListener('resize', followRangeDebounced);
                },
                detach: () => {
                    document.removeEventListener('selectionchange', followRangeDebounced, false);
                    window.removeEventListener('resize', followRangeDebounced);
                },
            };
            return followRange;
        }
        else {
            return { children: [] };
        }
    }
    _followChangedSelection(container) {
        let selection;
        let doc = document;
        let isCollapsed = true;
        do {
            selection = doc.getSelection();
            doc = null;
            // don't use selection.isCollapsed because in shadowRoot the value
            // is every time true.
            isCollapsed =
                selection.anchorNode === selection.focusNode &&
                    selection.anchorOffset === selection.focusOffset;
            if (selection.rangeCount && isCollapsed) {
                const [el] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(selection.anchorNode, selection.anchorOffset);
                if (el instanceof Element && el.shadowRoot) {
                    doc = el.shadowRoot;
                }
            }
        } while (doc);
        const selectionIsInEditable = !!selection &&
            selection.anchorNode &&
            selection.anchorNode.parentElement.closest('[contenteditable="true"]');
        // If the selection goes into an input inside the jw-follow-range, do nothing.
        if (document.activeElement instanceof HTMLInputElement &&
            document.activeElement.closest('JW-FOLLOW-RANGE')) {
            return;
        }
        if (selection.rangeCount && !isCollapsed && selectionIsInEditable) {
            if (container.parentElement.tagName !== 'BODY') {
                document.body.append(container);
            }
            container.style.display = '';
            const size = container.getBoundingClientRect();
            const range = selection.getRangeAt(0);
            const box = range.getBoundingClientRect();
            container.style.top = window.scrollY + box.top - size.height + 'px';
            let leftPosition = box.left + (box.width - size.width) / 2;
            leftPosition = Math.max(0, leftPosition);
            container.style.left = leftPosition + 'px';
        }
        else if (container.style.display !== 'none') {
            // Use condition to have the minimum of mutations.
            container.style.display = 'none';
        }
    }
}
FollowRangeZoneDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-follow-range/src/FollowRangeZoneNode.ts":
/*!*********************************************************************!*\
  !*** ./packages/plugin-dom-follow-range/src/FollowRangeZoneNode.ts ***!
  \*********************************************************************/
/*! exports provided: FollowRangeZoneNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FollowRangeZoneNode", function() { return FollowRangeZoneNode; });
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");

class FollowRangeZoneNode extends _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"] {
}


/***/ }),

/***/ "./packages/plugin-dom-follow-range/src/FollowRangeZoneNodeXmlDomParser.ts":
/*!*********************************************************************************!*\
  !*** ./packages/plugin-dom-follow-range/src/FollowRangeZoneNodeXmlDomParser.ts ***!
  \*********************************************************************************/
/*! exports provided: FollowRangeZoneNodeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FollowRangeZoneNodeXmlDomParser", function() { return FollowRangeZoneNodeXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _FollowRangeZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FollowRangeZoneNode */ "./packages/plugin-dom-follow-range/src/FollowRangeZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class FollowRangeZoneNodeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-RANGE';
        };
    }
    async parse(item) {
        const zones = [];
        for (const child of item.querySelectorAll('t[t-zone]')) {
            zones.push(child.getAttribute('t-zone'));
        }
        return [new _FollowRangeZoneNode__WEBPACK_IMPORTED_MODULE_2__["FollowRangeZoneNode"]({ managedZones: zones })];
    }
}
FollowRangeZoneNodeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-helpers/src/DomHelpers.ts":
/*!*******************************************************!*\
  !*** ./packages/plugin-dom-helpers/src/DomHelpers.ts ***!
  \*******************************************************/
/*! exports provided: DomHelpers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomHelpers", function() { return DomHelpers; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");






class DomHelpers extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Add a class or a list of classes to a DOM node or a list of DOM nodes.
     *
     * @param params
     */
    async addClass(context, domNode, className) {
        const domHelpersAddClass = async () => {
            const classes = Array.isArray(className) ? className : [className];
            for (const node of this.getNodes(domNode)) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).classList.add(...classes);
            }
        };
        return context.execCommand(domHelpersAddClass);
    }
    /**
     * Remove a class or a list of classes from a DOM node or a list of DOM nodes.
     *
     * @param params
     */
    async removeClass(context, domNode, className) {
        const domHelpersRemoveClass = async () => {
            var _a;
            const classes = Array.isArray(className) ? className : [className];
            for (const node of this.getNodes(domNode)) {
                (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"])) === null || _a === void 0 ? void 0 : _a.classList.remove(...classes);
            }
        };
        return context.execCommand(domHelpersRemoveClass);
    }
    /**
     * Add or remove a class or a list of classes from a DOM node or a list of
     * DOM nodes.
     *
     * @param params
     */
    async toggleClass(context, domNode, className) {
        const domHelpersToggleClass = async () => {
            const classes = Array.isArray(className) ? className : [className];
            for (const node of this.getNodes(domNode)) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).classList.toggle(...classes);
            }
        };
        return context.execCommand(domHelpersToggleClass);
    }
    /**
     * Set an attribute on a DOM node or a list of DOM nodes.
     *
     * @param params
     */
    async setAttribute(context, domNode, name, value) {
        const domHelpersSetAttribute = async () => {
            for (const node of this.getNodes(domNode)) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).set(name, value);
            }
        };
        return context.execCommand(domHelpersSetAttribute);
    }
    /**
     * Update the attributes with the given dictionnary and clear all previous
     * attributes.
     */
    async updateAttributes(context, domNode, attributes) {
        const domHelpersUpdateAttribute = async () => {
            for (const node of this.getNodes(domNode)) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).clear();
                for (const [name, value] of Object.entries(attributes)) {
                    node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).set(name, value);
                }
            }
        };
        return context.execCommand(domHelpersUpdateAttribute);
    }
    /**
     * Set a style key/value pair on a DOM node or a list of DOM nodes.
     *
     * @param params
     */
    async setStyle(context, domNode, name, value, important) {
        const domHelpersSetStyle = async () => {
            for (const node of this.getNodes(domNode)) {
                value = important ? value + ' !important' : value;
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).style.set(name, value);
            }
        };
        return context.execCommand(domHelpersSetStyle);
    }
    /**
     * Remove a DOM node or a list of DOM nodes.
     *
     * @param params
     */
    async remove(context, domNode) {
        const domHelpersRemove = async () => {
            for (const node of this.getNodes(domNode)) {
                node.remove();
            }
        };
        return context.execCommand(domHelpersRemove);
    }
    /**
     * Remove the contents of a DOM node or of a list of DOM nodes.
     *
     * @param params
     */
    async empty(context, domNode) {
        const domHelpersEmpty = async () => {
            for (const node of this.getNodes(domNode)) {
                node.empty();
            }
        };
        return context.execCommand(domHelpersEmpty);
    }
    /**
     * Replace a DOM node or a list of DOM nodes with the given HTML content.
     *
     * @param params
     */
    async replace(context, domNodes, html) {
        const domHelpersReplace = async () => {
            const nodes = this.getNodes(domNodes);
            const parsedNodes = await this._parseHtmlString(html);
            const firstNode = nodes[0];
            for (const parsedNode of parsedNodes) {
                firstNode.before(parsedNode);
            }
            for (const node of nodes) {
                node.remove();
            }
        };
        return context.execCommand(domHelpersReplace);
    }
    /**
     * Wrap the given HTML content within a DOM container.
     *
     * @param params
     */
    async wrap(context, domContainer, html) {
        const domHelpersWrap = async () => {
            const container = this.getNodes(domContainer)[0];
            if (!(container instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"])) {
                throw new Error('The provided container must be a ContainerNode in the Jabberwock structure.');
            }
            const parsedNodes = await this._parseHtmlString(html);
            for (const parsedNode of parsedNodes) {
                container.wrap(parsedNode);
            }
        };
        return context.execCommand(domHelpersWrap);
    }
    /**
     * Move a DOM Node before another.
     *
     * @param params
     */
    async moveBefore(context, fromDomNode, toDomNode) {
        const domHelpersMoveBefore = async () => {
            const toNode = this.getNodes(toDomNode)[0];
            for (const fromNode of this.getNodes(fromDomNode)) {
                fromNode.before(toNode);
            }
        };
        return context.execCommand(domHelpersMoveBefore);
    }
    /**
     * Move a DOM Node after another.
     *
     * @param params
     */
    async moveAfter(context, fromDomNode, toDomNode) {
        const domHelpersMoveAfter = async () => {
            const toNodes = this.getNodes(toDomNode);
            const toNode = toNodes[toNodes.length - 1];
            for (const fromNode of this.getNodes(fromDomNode).reverse()) {
                fromNode.after(toNode);
            }
        };
        return context.execCommand(domHelpersMoveAfter);
    }
    /**
     * Insert html content before, after or inside a DOM Node. If no DOM Node
     * was provided, empty the range and insert the html content before the it.
     *
     * @param params
     */
    async insertHtml(context, html, domNode, position) {
        let parsedNodes;
        await context.execCommand(async () => {
            let nodes;
            if (domNode) {
                nodes = this.getNodes(domNode);
                if (!nodes.length) {
                    throw new Error('The given DOM node does not have a corresponding VNode.');
                }
                position = position || _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            else {
                this.editor.selection.range.empty();
                nodes = [this.editor.selection.range.start];
                position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            parsedNodes = await this._parseHtmlString(html);
            switch (position.toUpperCase()) {
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE:
                    for (const parsedNode of parsedNodes) {
                        nodes[0].before(parsedNode);
                    }
                    break;
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER:
                    for (const parsedNode of [...parsedNodes].reverse()) {
                        nodes[nodes.length - 1].after(parsedNode);
                    }
                    break;
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE:
                    for (const parsedNode of [...parsedNodes]) {
                        nodes[nodes.length - 1].append(parsedNode);
                    }
                    break;
            }
        });
        return parsedNodes;
    }
    /**
     * Return the `VNode`(s) matching a DOM Node or a list of DOM Nodes.
     *
     * @param domNode
     */
    getNodes(domNode) {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
        const domEngine = layout.engines.dom;
        let nodes = [];
        if (Array.isArray(domNode)) {
            for (const oneDomNode of domNode) {
                nodes.push(...domEngine.getNodes(oneDomNode));
            }
        }
        else {
            nodes = domEngine.getNodes(domNode);
        }
        return nodes;
    }
    /**
     * Return the DOM Node(s) matching a VNode or a list of VNodes.
     *
     * @param node
     */
    getDomNodes(node) {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
        const domEngine = layout.engines.dom;
        let domNodes = [];
        if (Array.isArray(node)) {
            for (const oneNode of node) {
                domNodes.push(...domEngine.getDomNodes(oneNode));
            }
        }
        else {
            domNodes = domEngine.getDomNodes(node);
        }
        return domNodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Parse an HTML string and return the resulting `VNodes`.
     *
     * @param html
     */
    async _parseHtmlString(html) {
        const parser = this.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_5__["Parser"]);
        const div = document.createElement('div');
        div.innerHTML = html;
        return parser.parse('dom/html', ...div.childNodes);
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ActionableDomObjectRenderer.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ActionableDomObjectRenderer.ts ***!
  \***********************************************************************/
/*! exports provided: ActionableDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionableDomObjectRenderer", function() { return ActionableDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _DomLayout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");





class ActionableDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor(engine) {
        super(engine);
        this.predicate = _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__["ActionableNode"];
        this.actionableNodes = new Map();
        this.engine.editor.dispatcher.registerCommandHook('@commit', this._updateActionables.bind(this));
    }
    async render(button, 
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    worker) {
        let clickHandler;
        let mousedownHandler;
        const objectButton = {
            tag: 'JW-BUTTON',
            attributes: {
                name: button.actionName,
            },
            handler: () => {
                if (button.commandId) {
                    this.engine.editor.execCommand(button.commandId, button.commandArgs);
                }
            },
            attach: (el) => {
                clickHandler = (ev) => {
                    ev.stopImmediatePropagation();
                    ev.stopPropagation();
                    ev.preventDefault();
                    objectButton.handler();
                };
                mousedownHandler = (ev) => {
                    ev.stopImmediatePropagation();
                    ev.stopPropagation();
                    ev.preventDefault();
                };
                el.addEventListener('click', clickHandler);
                el.addEventListener('mousedown', mousedownHandler);
                this.actionableNodes.set(button, el);
            },
            detach: (el) => {
                el.removeEventListener('click', clickHandler);
                el.removeEventListener('mousedown', mousedownHandler);
                this.actionableNodes.delete(button);
            },
        };
        const attributes = button.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]);
        const className = attributes === null || attributes === void 0 ? void 0 : attributes.get('class');
        if (className === null || className === void 0 ? void 0 : className.includes(' fa-')) {
            if (!attributes.get('title')) {
                objectButton.attributes.title = button.label;
            }
        }
        else {
            objectButton.children = [{ text: button.label }];
        }
        return objectButton;
    }
    /**
     * Update button rendering after the command if the value of selected or
     * enabled change.
     */
    _updateActionables() {
        const pluginConfig = this.engine.editor.plugins.get(_DomLayout__WEBPACK_IMPORTED_MODULE_4__["DomLayout"]).configuration;
        const pressedActionablesClassName = pluginConfig.pressedActionablesClassName
            ? pluginConfig.pressedActionablesClassName
            : 'pressed';
        for (const [actionable, element] of this.actionableNodes) {
            const editor = this.engine.editor;
            const select = !!actionable.selected(editor);
            const enable = !!actionable.enabled(editor);
            const visible = !!actionable.visible(editor);
            const attrSelected = element.getAttribute('aria-pressed');
            if (select.toString() !== attrSelected) {
                element.setAttribute('aria-pressed', select.toString());
                if (select) {
                    element.classList.add(pressedActionablesClassName);
                }
                else {
                    element.classList.remove(pressedActionablesClassName);
                }
            }
            const domEnable = !element.getAttribute('disabled');
            if (enable !== domEnable) {
                if (enable) {
                    element.removeAttribute('disabled');
                }
                else {
                    element.setAttribute('disabled', 'true');
                }
            }
            const domVisible = element.style.display !== 'none';
            if (visible !== domVisible) {
                if (visible) {
                    element.style.display = 'inline-block';
                }
                else {
                    element.style.display = 'none';
                }
            }
        }
    }
}
ActionableDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ActionableGroupDomObjectRenderer.ts":
/*!****************************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ActionableGroupDomObjectRenderer.ts ***!
  \****************************************************************************/
/*! exports provided: ActionableGroupDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionableGroupDomObjectRenderer", function() { return ActionableGroupDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableGroupNode */ "./packages/plugin-layout/src/ActionableGroupNode.ts");



class ActionableGroupDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_2__["ActionableGroupNode"];
    }
    async render(group) {
        if (!group.descendants(node => !(node instanceof _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_2__["ActionableGroupNode"]) && node.tangible)
            .length) {
            return { children: [] };
        }
        else if (group.ancestor(_plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_2__["ActionableGroupNode"])) {
            return this._renderSelect(group);
        }
        else {
            return this._renderGroup(group);
        }
    }
    _renderSelect(group) {
        const objectSelect = {
            tag: 'SELECT',
            children: [{ tag: 'OPTION' }, ...group.children()],
        };
        return objectSelect;
    }
    _renderGroup(group) {
        const objectGroup = {
            tag: 'JW-GROUP',
            children: group.children(),
        };
        return objectGroup;
    }
}
ActionableGroupDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ActionableGroupSelectItemDomObjectRenderer.ts":
/*!**************************************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ActionableGroupSelectItemDomObjectRenderer.ts ***!
  \**************************************************************************************/
/*! exports provided: ActionableGroupSelectItemDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionableGroupSelectItemDomObjectRenderer", function() { return ActionableGroupSelectItemDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableGroupNode */ "./packages/plugin-layout/src/ActionableGroupNode.ts");
/* harmony import */ var _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");
/* harmony import */ var _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-layout/src/LabelNode */ "./packages/plugin-layout/src/LabelNode.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");








class ActionableGroupSelectItemDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor(engine) {
        super(engine);
        this.predicate = (node) => node.ancestors(_plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_4__["ActionableGroupNode"]).length >= 2;
        this.actionableNodes = new Map();
        this.engine.editor.dispatcher.registerCommandHook('@commit', this._updateActionables.bind(this));
    }
    async render(item, worker) {
        var _a;
        let domObject;
        if (item instanceof _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__["ActionableNode"]) {
            let handler;
            const domObjectActionable = {
                tag: 'OPTION',
                attributes: {
                    value: item.actionName,
                },
                children: item.label ? [{ text: item.label }] : [],
                handler: () => {
                    if (item.commandId) {
                        this.engine.editor.execCommand(item.commandId, item.commandArgs);
                    }
                },
                attach: (el) => {
                    const select = el.closest('select') || el.parentElement;
                    handler = (ev) => {
                        const option = select.querySelector('option:checked');
                        if (option === el) {
                            ev.stopImmediatePropagation();
                            domObjectActionable.handler();
                        }
                    };
                    select.addEventListener('change', handler);
                    this.actionableNodes.set(item, el);
                },
                detach: (el) => {
                    const select = el.closest('select') || el.parentElement;
                    select.removeEventListener('change', handler);
                    this.actionableNodes.delete(item);
                },
            };
            domObject = domObjectActionable;
        }
        else if (item instanceof _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_4__["ActionableGroupNode"]) {
            if (item.ancestors(_plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_4__["ActionableGroupNode"]).length <= 2) {
                const title = (_a = item.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('title');
                domObject = {
                    tag: 'OPTGROUP',
                    attributes: {
                        name: item.groupName || null,
                        label: title || null,
                    },
                    children: item.children(),
                };
            }
            else {
                domObject = {
                    children: item.children(),
                };
            }
        }
        else if (item instanceof _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_5__["SeparatorNode"]) {
            domObject = {
                tag: 'OPTION',
                attributes: {
                    role: 'separator',
                    disabled: 'true',
                },
            };
        }
        else if (item instanceof _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_6__["LabelNode"]) {
            domObject = {
                tag: 'OPTION',
                attributes: {
                    class: new Set(['label']),
                    disabled: 'true',
                },
                children: [{ text: item.label }],
            };
        }
        else if (item instanceof _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_7__["ZoneNode"]) {
            domObject = await this.super.render(item, worker);
            if (!('tag' in domObject) || domObject.tag.toUpperCase() !== 'OPTION') {
                domObject = { children: item.children() };
            }
        }
        else {
            domObject = {
                tag: 'OPTION',
                children: [{ text: item.textContent }],
            };
        }
        return domObject;
    }
    /**
     * Update option rendering after the command if the value of selected or
     * enabled change.
     *
     * @param aactionable
     * @param element
     */
    _updateActionables() {
        for (const [aactionable, element] of this.actionableNodes) {
            const editor = this.engine.editor;
            const select = aactionable.selected(editor);
            const enable = aactionable.enabled(editor);
            const attrSelected = element.getAttribute('selected');
            if (select.toString() !== attrSelected) {
                if (select) {
                    element.setAttribute('selected', 'true');
                    element.closest('select').value = element.getAttribute('value');
                }
                else {
                    element.removeAttribute('selected');
                }
            }
            const domEnable = !element.getAttribute('disabled');
            if (enable !== domEnable) {
                if (enable) {
                    element.removeAttribute('disabled');
                }
                else {
                    element.setAttribute('disabled', 'true');
                }
            }
        }
    }
}
ActionableGroupSelectItemDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/DomLayout.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-dom-layout/src/DomLayout.ts ***!
  \*****************************************************/
/*! exports provided: DomLayout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomLayout", function() { return DomLayout; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./DomLayoutEngine */ "./packages/plugin-dom-layout/src/DomLayoutEngine.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderer */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts");
/* harmony import */ var _ZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ZoneDomObjectRenderer */ "./packages/plugin-dom-layout/src/ZoneDomObjectRenderer.ts");
/* harmony import */ var _ZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ZoneXmlDomParser */ "./packages/plugin-dom-layout/src/ZoneXmlDomParser.ts");
/* harmony import */ var _LayoutContainerDomObjectRenderer__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./LayoutContainerDomObjectRenderer */ "./packages/plugin-dom-layout/src/LayoutContainerDomObjectRenderer.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _ActionableDomObjectRenderer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ActionableDomObjectRenderer */ "./packages/plugin-dom-layout/src/ActionableDomObjectRenderer.ts");
/* harmony import */ var _ActionableGroupDomObjectRenderer__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ActionableGroupDomObjectRenderer */ "./packages/plugin-dom-layout/src/ActionableGroupDomObjectRenderer.ts");
/* harmony import */ var _ActionableGroupSelectItemDomObjectRenderer__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./ActionableGroupSelectItemDomObjectRenderer */ "./packages/plugin-dom-layout/src/ActionableGroupSelectItemDomObjectRenderer.ts");
/* harmony import */ var _LabelDomObjectRenderer__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./LabelDomObjectRenderer */ "./packages/plugin-dom-layout/src/LabelDomObjectRenderer.ts");
/* harmony import */ var _SeparatorDomObjectRenderer__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./SeparatorDomObjectRenderer */ "./packages/plugin-dom-layout/src/SeparatorDomObjectRenderer.ts");
/* harmony import */ var _core_src_Mode__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../core/src/Mode */ "./packages/core/src/Mode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");


















class DomLayout extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, configuration) {
        super(editor, configuration);
        this.loadables = {
            renderers: [
                _ZoneDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__["ZoneDomObjectRenderer"],
                _LayoutContainerDomObjectRenderer__WEBPACK_IMPORTED_MODULE_8__["LayoutContainerDomObjectRenderer"],
                _ActionableGroupSelectItemDomObjectRenderer__WEBPACK_IMPORTED_MODULE_13__["ActionableGroupSelectItemDomObjectRenderer"],
                _ActionableGroupDomObjectRenderer__WEBPACK_IMPORTED_MODULE_12__["ActionableGroupDomObjectRenderer"],
                _ActionableDomObjectRenderer__WEBPACK_IMPORTED_MODULE_11__["ActionableDomObjectRenderer"],
                _LabelDomObjectRenderer__WEBPACK_IMPORTED_MODULE_14__["LabelDomObjectRenderer"],
                _SeparatorDomObjectRenderer__WEBPACK_IMPORTED_MODULE_15__["SeparatorDomObjectRenderer"],
            ],
            parsers: [_ZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_7__["ZoneXmlDomParser"]],
            layoutEngines: [],
            components: [],
        };
        this.loaders = {
            domLocations: this._loadComponentLocations,
        };
        this.commandHooks = {
            '@commit': this._redraw,
        };
        this.loadables.layoutEngines.push(_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__["DomLayoutEngine"]);
        this.processKeydown = this.processKeydown.bind(this);
    }
    async start() {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        for (const component of this.configuration.components || []) {
            domLayoutEngine.loadComponent(component);
        }
        const zones = {};
        for (const [id, zone] of this.configuration.componentZones || []) {
            zones[id] = zone;
        }
        domLayoutEngine.loadComponentZones(zones);
        this._loadComponentLocations(this.configuration.locations || []);
        domLayoutEngine.location = this.configuration.location;
        await domLayoutEngine.start();
        window.addEventListener('keydown', this.processKeydown, true);
    }
    async stop() {
        window.removeEventListener('keydown', this.processKeydown, true);
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        await domLayoutEngine.stop();
        return super.stop();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * KeyboardEvent listener to be added to the DOM that calls `execCommand` if
     * the keys pressed match one of the shortcut registered in the keymap.
     *
     * @param event
     */
    async processKeydown(event) {
        // If target == null we bypass the editable zone check.
        // This should only occurs when we receive an inferredKeydownEvent
        // created from an InputEvent send by a mobile device.
        if (event.target && !this.isInEditable(event.target)) {
            // Don't process keydown if the user is outside the current editor editable Zone.
            return;
        }
        const keymap = this.dependencies.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_10__["Keymap"]);
        const commands = keymap.match(event);
        const [command, context] = this.editor.contextManager.match(commands);
        if (command && command.commandId) {
            const params = Object.assign({ context }, command.commandArgs);
            event.preventDefault();
            event.stopPropagation();
            event.stopImmediatePropagation();
            await this.editor.execCommand(command.commandId, params);
            return command.commandId;
        }
    }
    /**
     * Return true if the target node is inside Jabberwock's main editable Zone.
     *
     * @param target: Node
     */
    isInEditable(target) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        target = this._getDeepestTarget(target);
        let nodes = domLayoutEngine.getNodes(target);
        while (!nodes.length && target) {
            if (target.previousSibling) {
                target = target.previousSibling;
            }
            else {
                target = target.parentNode;
            }
            nodes = domLayoutEngine.getNodes(target);
        }
        const node = nodes === null || nodes === void 0 ? void 0 : nodes.pop();
        // We cannot always expect a 'contentEditable' attribute on the main
        // ancestor. So we expect to find the main editor ZoneNode if we are in
        // the editable part of Jabberwock.
        return (node &&
            (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_17__["isContentEditable"])(node) || this.editor.mode.is(node, _core_src_Mode__WEBPACK_IMPORTED_MODULE_16__["RuleProperty"].EDITABLE)) &&
            !!node.ancestor(node => node instanceof _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_9__["ZoneNode"] && node.managedZones.includes('main')));
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _loadComponentLocations(locations) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        for (const [id, location] of locations) {
            domLayoutEngine.locations[id] = location;
        }
    }
    /**
     * Return the deepest target, based on the given target and the current
     * selection. The selection can be used only if it is indeed contained
     * within the target.
     *
     * @param target
     */
    _getDeepestTarget(target) {
        var _a;
        const selection = (_a = target.ownerDocument) === null || _a === void 0 ? void 0 : _a.getSelection();
        const anchorNode = selection === null || selection === void 0 ? void 0 : selection.anchorNode;
        let node = anchorNode;
        let isAnchorDescendantOfTarget = false;
        while (node) {
            if (node === target) {
                isAnchorDescendantOfTarget = true;
                break;
            }
            node = node.parentElement;
        }
        return isAnchorDescendantOfTarget ? anchorNode : target;
    }
    async _redraw(params) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        await domLayoutEngine.redraw(params.changesLocations);
    }
}
DomLayout.dependencies = [_plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["DomObjectRenderer"], _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"], _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"], _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_10__["Keymap"]];


/***/ }),

/***/ "./packages/plugin-dom-layout/src/DomLayoutEngine.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-dom-layout/src/DomLayoutEngine.ts ***!
  \***********************************************************/
/*! exports provided: DomLayoutEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomLayoutEngine", function() { return DomLayoutEngine; });
/* harmony import */ var _plugin_layout_src_LayoutEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-layout/src/LayoutEngine */ "./packages/plugin-layout/src/LayoutEngine.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _DomReconciliationEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DomReconciliationEngine */ "./packages/plugin-dom-layout/src/DomReconciliationEngine.ts");
/* harmony import */ var _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./LayoutContainerNode */ "./packages/plugin-dom-layout/src/LayoutContainerNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");










class DomLayoutEngine extends _plugin_layout_src_LayoutEngine__WEBPACK_IMPORTED_MODULE_0__["LayoutEngine"] {
    constructor() {
        super(...arguments);
        this._domReconciliationEngine = new _DomReconciliationEngine__WEBPACK_IMPORTED_MODULE_3__["DomReconciliationEngine"]();
        // used only to develop and avoid wrong promise from commands
        this._currentlyRedrawing = false;
        this.renderingMap = {};
        this._markedForRedraw = new Set();
        this.locations = {};
        this.defaultRootComponent = {
            id: 'editor',
            async render() {
                const editor = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_5__["VElement"]({ htmlTag: 'JW-EDITOR' });
                editor.append(new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_1__["ZoneNode"]({ managedZones: ['main'] }));
                editor.append(new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_1__["ZoneNode"]({ managedZones: ['default'] }));
                return [editor];
            },
        };
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    async start() {
        for (const componentId in this.locations) {
            this.renderingMap[componentId] = [];
            this.componentZones[componentId] = ['root'];
            if (!this.componentDefinitions[componentId]) {
                throw new Error('Layout component "' + componentId + '" not found.');
            }
        }
        if (!Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_6__["flat"])(Object.values(this.componentZones)).includes('root')) {
            this.componentDefinitions.editor = this.defaultRootComponent;
            this.componentZones.editor = ['root'];
        }
        for (const componentId in this.componentDefinitions) {
            this._prepareLayoutContainerAndLocation(this.componentDefinitions[componentId]);
        }
        await super.start();
    }
    async stop() {
        for (const componentId in this.componentDefinitions) {
            const location = this.locations[componentId];
            if (location) {
                const nodes = this.components[componentId];
                for (const node of nodes) {
                    const domNodes = this._domReconciliationEngine.toDom(node);
                    if (location[1] === 'replace') {
                        // Undo the replace that was done by the layout engine.
                        let first = domNodes && domNodes[0];
                        if (!first) {
                            first = this.renderingMap[componentId][0];
                        }
                        if (first && first.parentNode) {
                            first.parentNode.insertBefore(location[0], first);
                        }
                    }
                }
            }
        }
        this.renderingMap = {};
        this._markedForRedraw = new Set();
        this.location = null;
        this.locations = {};
        this._rendererCache = null;
        this._domReconciliationEngine.clear();
        return super.stop();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the VNode(s) corresponding to the given DOM Node.
     *
     * @param Node
     */
    getNodes(domNode) {
        return this._domReconciliationEngine.fromDom(domNode);
    }
    /**
     * Return the DOM Node(s) corresponding to the given VNode.
     *
     * @param node
     */
    getDomNodes(node) {
        return this._domReconciliationEngine.toDom(node);
    }
    async redraw(params) {
        if (this._currentlyRedrawing) {
            throw new Error('Double redraw detected');
        }
        this._currentlyRedrawing = true;
        return this._redraw(params)
            .then(() => {
            this._currentlyRedrawing = false;
        })
            .catch(error => {
            this._currentlyRedrawing = false;
            throw error;
        });
    }
    /**
     * Parse the dom selection into the description of a VSelection.
     *
     * @param selection
     * @param [direction]
     */
    parseSelection(selection) {
        const start = this._domReconciliationEngine.locate(selection.anchorNode, selection.anchorOffset);
        const end = this._domReconciliationEngine.locate(selection.focusNode, selection.focusOffset);
        const [startVNode, startPosition] = start;
        const [endVNode, endPosition] = end;
        let direction;
        if (selection instanceof Selection) {
            const domRange = selection.rangeCount && selection.getRangeAt(0);
            if (domRange.startContainer === selection.anchorNode &&
                domRange.startOffset === selection.anchorOffset) {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD;
            }
            else {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].BACKWARD;
            }
        }
        else {
            direction = selection.direction;
        }
        return {
            anchorNode: startVNode,
            anchorPosition: startPosition,
            focusNode: endVNode,
            focusPosition: endPosition,
            direction: direction,
        };
    }
    markForRedraw(domNodes) {
        for (const domNode of domNodes) {
            this._markedForRedraw.add(domNode);
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    async _redraw(params) {
        const updatedNodes = [...this._getInvalidNodes(params)];
        const layout = this.editor.plugins.get(_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_9__["Renderer"]);
        const engine = layout.engines['dom/object'];
        const cache = (this._rendererCache = await engine.render(updatedNodes, this._rendererCache));
        this._domReconciliationEngine.update(updatedNodes, cache.renderings, cache.locations, cache.renderingDependent, this._markedForRedraw);
        this._markedForRedraw = new Set();
        // Append in dom if needed.
        for (const componentId in this.locations) {
            const nodes = this.components[componentId];
            const needInsert = nodes.find(node => {
                const domNodes = this._domReconciliationEngine.toDom(node);
                return !domNodes.length || domNodes.some(node => !node.parentNode);
            });
            if (needInsert) {
                this._appendComponentInDom(componentId);
            }
        }
        this._renderSelection();
    }
    /**
     * Get the invalidated nodes in the rendering.
     * Clear the renderer in cache for this node or modifier. The cache
     * renderer is added only for performance at redrawing time. The
     * invalidation are automatically made from memory changes.
     */
    _getInvalidNodes(diff) {
        const cache = this._rendererCache;
        const remove = new Set();
        const update = new Set();
        const updatedModifiers = new Set();
        const updatedSiblings = new Set();
        const add = new Set();
        // Add new nodes for redrawing it.
        for (const object of diff.add) {
            if (object instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                add.add(object);
            }
            else if (object instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__["Modifier"]) {
                updatedModifiers.add(object);
            }
        }
        for (const node of add) {
            if (!node.parent) {
                add.delete(node);
                remove.add(node);
                if (node.childVNodes) {
                    for (const child of node.descendants()) {
                        add.delete(node);
                        remove.add(child);
                    }
                }
            }
        }
        if (cache) {
            // Select the removed VNode and Modifiers.
            const allRemove = new Set(diff.remove);
            for (const object of diff.remove) {
                if (object instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                    remove.add(object);
                }
                else {
                    if (object instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__["Modifier"]) {
                        updatedModifiers.add(object);
                    }
                    for (const [parent] of this.editor.memory.getParents(object)) {
                        if (parent instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                            update.add(parent);
                        }
                        else if (parent instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__["Modifier"]) {
                            updatedModifiers.add(parent);
                        }
                    }
                }
            }
            const filterd = this._filterInRoot([...remove]);
            for (const node of filterd.remove) {
                update.delete(node);
                remove.add(node);
                if (node.childVNodes) {
                    for (const child of node.descendants()) {
                        remove.add(child);
                    }
                }
            }
            for (const node of filterd.keep) {
                update.add(node); // TODO: memory change to have real add and not add + move.
            }
            const needSiblings = new Set();
            // Filter to keep only update not added or removed nodes.
            const paramsUpdate = [];
            diff.update.filter(up => {
                const object = up[0];
                if (up[1] && object instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"] && !object.parent) {
                    remove.add(object);
                    for (const child of object.descendants()) {
                        remove.add(child);
                    }
                }
                else if (!remove.has(object)) {
                    paramsUpdate.push(up);
                }
            });
            const mayBeAlreadyRemoved = [];
            // Select the updated VNode and Modifiers and the VNode siblings.
            // From the parent, select the removed VNode siblings.
            for (const [object, changes] of paramsUpdate) {
                if (allRemove.has(object) ||
                    remove.has(object) ||
                    update.has(object) ||
                    updatedModifiers.has(object)) {
                    continue;
                }
                if (object instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                    update.add(object);
                    needSiblings.add(object);
                    mayBeAlreadyRemoved.push(object);
                }
                else {
                    if (object instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__["Modifier"]) {
                        updatedModifiers.add(object);
                    }
                    for (const [parent, parentProp] of this.editor.memory.getParents(object)) {
                        if (parent instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                            if (remove.has(parent)) {
                                // The node was already removed in an other memory slice.
                            }
                            else if (!parent.parent) {
                                // An old removed node can change. For eg: move a children
                                // into the active VDocument.
                                remove.add(parent);
                                for (const child of parent.descendants()) {
                                    remove.add(child);
                                    update.delete(child);
                                }
                            }
                            else if (changes &&
                                parentProp[0][0] === 'childVNodes' &&
                                typeof changes[0] === 'number') {
                                // If change a children (add or remove) redraw the node and
                                // siblings.
                                const childVNodes = parent.childVNodes;
                                for (let i = 0; i < changes.length; i++) {
                                    const index = changes[i];
                                    const child = childVNodes[index];
                                    if (child) {
                                        if (!add.has(child)) {
                                            update.add(child);
                                        }
                                        if (changes[i - 1] !== index - 1) {
                                            const previous = child.previousSibling();
                                            if (previous &&
                                                !add.has(previous) &&
                                                !update.has(previous)) {
                                                updatedSiblings.add(previous);
                                            }
                                        }
                                        if (changes[i + 1] !== index + 1) {
                                            const next = child.nextSibling();
                                            if (next && !add.has(next) && !update.has(next)) {
                                                if (next)
                                                    updatedSiblings.add(next);
                                            }
                                        }
                                    }
                                    else {
                                        const children = parent.children();
                                        if (children.length) {
                                            const last = children[children.length - 1];
                                            if (last && !add.has(last) && !update.has(last)) {
                                                updatedSiblings.add(last);
                                            }
                                        }
                                    }
                                }
                                update.add(parent);
                                mayBeAlreadyRemoved.push(parent);
                            }
                            else {
                                update.add(parent);
                                needSiblings.add(parent);
                                mayBeAlreadyRemoved.push(parent);
                            }
                        }
                        else if (parent instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_7__["Modifier"]) {
                            updatedModifiers.add(parent);
                        }
                    }
                }
            }
            for (const node of this._filterInRoot(mayBeAlreadyRemoved).remove) {
                update.delete(node);
                remove.add(node);
                update.delete(node);
                needSiblings.delete(node);
            }
            // If any change invalidate the siblings.
            for (const node of needSiblings) {
                const next = node.nextSibling();
                if (next)
                    updatedSiblings.add(next);
                const previous = node.previousSibling();
                if (previous)
                    updatedSiblings.add(previous);
            }
            // Invalidate compatible renderer cache.
            for (const node of update) {
                cache.cachedCompatibleRenderer.delete(node);
            }
            for (const node of remove) {
                cache.cachedCompatibleRenderer.delete(node);
            }
            // Add removed nodes modifiers for invalidation.
            for (const node of remove) {
                if (node.modifiers) {
                    // If the node is created after this memory slice (undo),
                    // the node has no values, no id, no modifiers... But the
                    // modifiers is inside the list of removed objects.
                    node.modifiers.map(modifier => updatedModifiers.add(modifier));
                }
            }
            // Invalidate compatible renderer cache and modifier compare cache.
            for (const modifier of updatedModifiers) {
                cache.cachedCompatibleModifierRenderer.delete(modifier);
                const id = cache.cachedModifierId.get(modifier);
                if (id) {
                    const keys = cache.cachedIsSameAsModifierIds[id];
                    if (keys) {
                        for (const key of keys) {
                            delete cache.cachedIsSameAsModifier[key];
                        }
                        delete cache.cachedIsSameAsModifierIds[id];
                    }
                }
            }
            // Add the siblings to invalidate the sibling groups.
            for (const sibling of updatedSiblings) {
                update.add(sibling);
            }
            // Get all linked and dependent VNodes and Modifiers to invalidate cache.
            const treated = new Set();
            const nodesOrModifiers = [...update, ...remove, ...updatedModifiers];
            const treatedItem = new Set(nodesOrModifiers);
            for (const nodeOrModifier of nodesOrModifiers) {
                const linkedRenderings = cache.nodeDependent.get(nodeOrModifier);
                if (linkedRenderings) {
                    for (const link of linkedRenderings) {
                        if (!treated.has(link)) {
                            treated.add(link);
                            const from = cache.renderingDependent.get(link);
                            if (from) {
                                for (const n of from) {
                                    if (!treatedItem.has(n)) {
                                        // Add to invalid domObject origin nodes or modifiers.
                                        nodesOrModifiers.push(n);
                                        treatedItem.add(n);
                                    }
                                }
                            }
                        }
                    }
                }
                const linkedNodes = cache.linkedNodes.get(nodeOrModifier);
                if (linkedNodes) {
                    for (const node of linkedNodes) {
                        if (!treatedItem.has(node)) {
                            // Add to invalid linked nodes of linkes nodes.
                            nodesOrModifiers.push(node);
                            treatedItem.add(node);
                        }
                    }
                }
                if (nodeOrModifier instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"]) {
                    update.add(nodeOrModifier);
                }
                else {
                    updatedModifiers.add(nodeOrModifier);
                }
            }
            // Remove all removed children from node to update.
            for (const node of remove) {
                update.delete(node);
            }
            // Invalidate VNode cache origin, location and linked.
            for (const node of [...update, ...remove]) {
                cache.renderingPromises.delete(node);
                const item = cache.renderings.get(node);
                if (item) {
                    const items = [item];
                    for (const item of items) {
                        cache.renderingDependent.delete(item);
                        cache.locations.delete(item);
                        if ('children' in item) {
                            for (const child of item.children) {
                                if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_8__["AbstractNode"])) {
                                    items.push(child);
                                }
                            }
                        }
                    }
                }
                cache.renderings.delete(node);
                cache.nodeDependent.delete(node);
                cache.linkedNodes.delete(node);
            }
            // Invalidate Modifiers cache linked.
            for (const modifier of updatedModifiers) {
                cache.nodeDependent.delete(modifier);
            }
        }
        for (const node of add) {
            update.add(node);
        }
        // Render nodes.
        return update;
    }
    _filterInRoot(nodes) {
        const inRoot = new Set();
        const notRoot = new Set();
        const nodesInRoot = new Set();
        const nodesInNotRoot = new Set();
        for (const node of nodes) {
            const parents = [];
            let ancestor = node;
            while (ancestor && !notRoot.has(ancestor)) {
                if (ancestor === this.root || inRoot.has(ancestor)) {
                    // The VNode is in the domLayout.
                    nodesInRoot.add(node);
                    for (const parent of parents) {
                        inRoot.add(parent);
                    }
                    break;
                }
                parents.push(ancestor);
                ancestor = ancestor.parent;
                if (!ancestor || !ancestor.id) {
                    // A VNode without an id does not exist yet/anymore in the
                    // current memory slice.
                    // The VNode is not in the domLayout.
                    nodesInNotRoot.add(node);
                    for (const parent of parents) {
                        notRoot.add(parent);
                    }
                }
            }
        }
        return { keep: nodesInRoot, remove: nodesInNotRoot };
    }
    /**
     * Render the given VSelection as a DOM selection in the given target.
     *
     * @param selection
     * @param target
     */
    _renderSelection() {
        const selection = this.editor.selection;
        const domNodes = this._domReconciliationEngine.toDom(selection.anchor.parent);
        if (!domNodes.length) {
            document.getSelection().removeAllRanges();
            return;
        }
        if (selection.anchor.ancestors().pop() !== this.root ||
            selection.focus.ancestors().pop() !== this.root) {
            console.warn('Cannot render a selection that is outside the Layout.');
            document.getSelection().removeAllRanges();
        }
        const anchor = this._domReconciliationEngine.getLocations(selection.anchor);
        const focus = this._domReconciliationEngine.getLocations(selection.focus);
        const doc = anchor[0].ownerDocument;
        const domSelection = doc.getSelection();
        if (domSelection.anchorNode === anchor[0] &&
            domSelection.anchorOffset === anchor[1] &&
            domSelection.focusNode === focus[0] &&
            domSelection.focusOffset === focus[1]) {
            return;
        }
        const domRange = doc.createRange();
        if (selection.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD) {
            domRange.setStart(anchor[0], anchor[1]);
            domRange.collapse(true);
        }
        else {
            domRange.setEnd(anchor[0], anchor[1]);
            domRange.collapse(false);
        }
        domSelection.removeAllRanges();
        domSelection.addRange(domRange);
        domSelection.extend(focus[0], focus[1]);
    }
    _appendComponentInDom(id) {
        var _a;
        let [target, position] = this.locations[id];
        const nodes = this.renderingMap[id];
        const first = nodes.find(node => node.parentNode && node.ownerDocument.body.contains(node));
        if (first === null || first === void 0 ? void 0 : first.previousSibling) {
            target = first.previousSibling;
            position = 'after';
        }
        else if ((_a = first === null || first === void 0 ? void 0 : first.parentNode) === null || _a === void 0 ? void 0 : _a.parentNode) {
            target = first.parentNode;
            position = 'prepend';
        }
        else {
            let previous = id;
            while ((previous = this._getPreviousComponentId(previous))) {
                const last = this.renderingMap[previous][this.renderingMap[previous].length - 1];
                if (last && last.ownerDocument.body.contains(last)) {
                    target = last;
                    position = 'after';
                }
            }
        }
        if (position === 'after' && !target.parentNode) {
            throw new Error('Impossible to render a component after an element with no parent.');
        }
        if (position === 'replace' && !target.parentNode) {
            throw new Error('Impossible to replace an element without any parent.');
        }
        const domNodes = [];
        for (const node of this.components[id]) {
            domNodes.push(...this._domReconciliationEngine.toDom(node));
        }
        if (!domNodes.length && this.locations[id][1] === 'replace') {
            throw new Error('Impossible to replace a element with an empty template.');
        }
        if (position === 'after') {
            if (target.nextSibling) {
                for (const domNode of domNodes) {
                    target.parentNode.insertBefore(domNode, target.nextSibling);
                }
            }
            else {
                for (const domNode of domNodes) {
                    target.parentNode.appendChild(domNode);
                }
            }
        }
        else if (position === 'prepend') {
            let item = target.firstChild;
            for (const domNode of domNodes) {
                if (!item) {
                    target.appendChild(domNode);
                }
                else if (domNode !== item) {
                    target.insertBefore(domNode, item);
                }
                else {
                    item = domNode.nextSibling;
                }
            }
        }
        else if (position === 'replace') {
            for (const domNode of domNodes) {
                target.parentNode.insertBefore(domNode, target);
            }
            target.parentNode.removeChild(target);
        }
        else {
            for (const domNode of domNodes) {
                target.appendChild(domNode);
            }
        }
        for (const node of this.renderingMap[id]) {
            if (node.parentNode && !domNodes.includes(node)) {
                node.parentNode.removeChild(node);
            }
        }
        this.renderingMap[id] = domNodes;
    }
    _getPreviousComponentId(id) {
        const [target, position] = this.locations[id];
        const locations = Object.values(this.locations);
        const componentIds = Object.keys(this.locations);
        const index = componentIds.indexOf(id);
        if (position === 'after') {
            for (let u = index - 1; u >= 0; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget &&
                    (otherPosition === 'after' || otherPosition === 'replace')) {
                    return componentIds[u];
                }
            }
            for (let u = locations.length - 1; u > index; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget && otherPosition === 'replace') {
                    return componentIds[u];
                }
            }
        }
        else if (position === 'replace') {
            for (let u = index - 1; u >= 0; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget && otherPosition === 'replace') {
                    return componentIds[u];
                }
            }
        }
    }
    _prepareLayoutContainerAndLocation(componentDefinition) {
        const zone = this.componentZones[componentDefinition.id];
        if (zone === null || zone === void 0 ? void 0 : zone.includes('root')) {
            // automatically wrap the child into a layoutContainer to keep location of all nodes
            // when update the template and redraw
            this.componentDefinitions[componentDefinition.id] = {
                id: componentDefinition.id,
                async render(editor) {
                    const nodes = await componentDefinition.render(editor);
                    const layoutContainer = new _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_4__["LayoutContainer"]();
                    layoutContainer.append(...nodes);
                    return [layoutContainer];
                },
            };
            if (this.location) {
                if (!this.locations[componentDefinition.id]) {
                    this.locations[componentDefinition.id] = this.location;
                    this.renderingMap[componentDefinition.id] = [];
                }
            }
        }
    }
}
DomLayoutEngine.id = 'dom';


/***/ }),

/***/ "./packages/plugin-dom-layout/src/DomReconciliationEngine.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/DomReconciliationEngine.ts ***!
  \*******************************************************************/
/*! exports provided: DomReconciliationEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomReconciliationEngine", function() { return DomReconciliationEngine; });
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/Dom */ "./packages/utils/src/Dom.ts");





let diffObjectId = 0;
/**
 * Set the style of an element keeping the "!important" css modifier in the value
 */
function setStyle(element, name, value) {
    if (value.includes('!important')) {
        element.style.setProperty(name, value.replace('!important', ''), 'important');
    }
    else {
        element.style.setProperty(name, value);
    }
}
class DomReconciliationEngine {
    constructor() {
        this._objects = {};
        this._objectIds = new Map();
        this._fromItem = new Map();
        this._fromDom = new Map();
        this._renderedNodes = new Map();
        this._renderedIds = new Set();
        this._locations = new Map();
        this._items = new Map();
        // The diff is filled in update when we compare the new domObject with the
        // old one, and the diff are consumed when we redraw the node.
        this._diff = {};
        this._rendererTreated = new Set();
        this._releasedItems = new Set();
        this._domUpdated = new Set();
    }
    update(updatedNodes, renderings, locations, from, domNodesToRedraw = new Set()) {
        var _a;
        const renderedSet = new Set();
        for (const node of updatedNodes) {
            const rendering = renderings.get(node);
            if (rendering) {
                renderedSet.add(rendering);
            }
        }
        const rendered = [...renderedSet];
        // Found the potential old values (they could become children of the current node).
        // In old values the renderer are may be merge some object, we want to found the
        // children object in old value to campare it with the newest.
        const mapOldIds = new Map();
        const domObjects = [];
        for (const domObject of rendered) {
            if (this._rendererTreated.has(domObject)) {
                continue;
            }
            domObjects.push(domObject);
            let oldObjects = mapOldIds.get(domObject);
            if (!oldObjects) {
                this._addLocations(domObject, locations, from);
                oldObjects = new Set();
                mapOldIds.set(domObject, oldObjects);
            }
            const nodes = this._items.get(domObject);
            for (const linkedNode of nodes) {
                const ids = this._renderedNodes.get(linkedNode);
                if (ids) {
                    for (const id of ids) {
                        if (!oldObjects.has(id)) {
                            const object = this._objects[id].object;
                            this._rendererTreated.delete(object);
                            this._objectIds.delete(object);
                            this._renderedIds.delete(id);
                            oldObjects.add(id);
                        }
                    }
                }
            }
            this._rendererTreated.delete(domObject);
            this._objectIds.delete(domObject);
        }
        // Make diff.
        for (const domObject of domObjects) {
            if (!this._objectIds.has(domObject)) {
                const items = this._items.get(domObject);
                const node = items.find(node => node instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]);
                const oldRefId = this._fromItem.get(node);
                const oldIds = mapOldIds.get(domObject);
                const id = this._diffObject(renderings, domObject, items, mapOldIds);
                this._renderedIds.add(id);
                const parentObject = (_a = this._objects[this._objects[id].parent]) === null || _a === void 0 ? void 0 : _a.object;
                if (oldRefId !== id ||
                    !parentObject ||
                    !this._rendererTreated.has(parentObject) ||
                    oldIds.size > 1) {
                    // If the rendering change, we must check if we redraw the parent.
                    const ancestorWithRendering = node.ancestor(ancestor => !!this._fromItem.get(ancestor));
                    if (!updatedNodes.includes(ancestorWithRendering)) {
                        const ancestorObjectId = this._fromItem.get(ancestorWithRendering);
                        if (ancestorObjectId && !this._diff[ancestorObjectId]) {
                            const parentObject = this._objects[ancestorObjectId];
                            const nodes = this._items.get(parentObject.object);
                            mapOldIds.set(parentObject.object, new Set([ancestorObjectId]));
                            this._rendererTreated.delete(parentObject.object);
                            this._diffObject(renderings, parentObject.object, nodes, mapOldIds);
                        }
                    }
                }
            }
        }
        const diffs = Object.values(this._diff);
        // Prepare path for fragment insertion in the dom.
        const objectsPath = {};
        for (const diff of diffs) {
            const object = this._objects[diff.id];
            const nodes = diff.dom.length ? diff.dom : this._getchildrenDomNodes(diff.id);
            const path = [];
            let parent = this._objects[object.parent];
            while (parent && !parent.object.tag) {
                parent = this._objects[parent.parent];
            }
            if (!parent) {
                let domNode = nodes[0];
                while (domNode && domNode.parentElement && domNode !== document.body) {
                    path.push([
                        domNode.parentElement,
                        [].indexOf.call(domNode.parentElement.childNodes, domNode),
                    ]);
                    domNode = domNode.parentElement;
                }
            }
            objectsPath[diff.id] = path;
        }
        // Select removed objects.
        const removeObjects = [];
        for (const diff of diffs) {
            for (const id of diff.removedChildren) {
                const object = this._objects[id];
                if (!object.parent) {
                    removeObjects.push(id);
                }
            }
        }
        for (const id of removeObjects) {
            const object = this._objects[id];
            if (!object.parent && removeObjects.includes(id)) {
                object.parent = null;
                for (const childId of object.children) {
                    const child = this._objects[childId];
                    if ((!child.parent || child.parent === id) &&
                        !removeObjects.includes(childId)) {
                        removeObjects.push(childId);
                    }
                }
            }
        }
        // Remove referencies to removed objects.
        const allOldDomNodes = [];
        for (const id of removeObjects) {
            const old = this._objects[id];
            if (typeof old.object.detach === 'function') {
                old.object.detach(...old.dom);
            }
            for (const node of this._locations.get(old.object) || []) {
                if (this._fromItem.get(node) === id) {
                    this._fromItem.delete(node);
                }
            }
            for (const node of this._items.get(old.object) || []) {
                const ids = this._renderedNodes.get(node);
                if (ids && ids.has(id)) {
                    this._renderedNodes.delete(node);
                }
            }
            if (old.dom) {
                for (const domNode of old.dom) {
                    if (this._fromDom.get(domNode) === id) {
                        this._fromDom.delete(domNode);
                        if (domNode instanceof Element) {
                            domNode.remove();
                        }
                        else {
                            allOldDomNodes.push(domNode);
                        }
                    }
                }
            }
            delete this._diff[id];
            delete this._objects[id];
            this._renderedIds.delete(id);
            this._items.delete(old.object);
            this._locations.delete(old.object);
            this._rendererTreated.delete(old.object);
            const i = diffs.findIndex(diff => diff.id === id);
            if (i !== -1) {
                diffs.splice(i, 1);
            }
        }
        // Unvalidate object linked to domNodesToRedraw;
        for (const domNode of domNodesToRedraw) {
            const id = this._fromDom.get(domNode);
            if (id) {
                if (this._diff[id]) {
                    this._diff[id].askCompleteRedrawing = true;
                }
                else if (this._objects[id]) {
                    const object = this._objects[id];
                    const domObject = object.object;
                    if (typeof domObject.detach === 'function') {
                        domObject.detach(...object.dom);
                    }
                    this._diff[id] = {
                        id: id,
                        attributes: {},
                        style: {},
                        classList: {},
                        dom: object.dom,
                        parentDomNode: object.parentDomNode,
                        removedChildren: [],
                        askCompleteRedrawing: true,
                    };
                    diffs.push(this._diff[id]);
                }
            }
            allOldDomNodes.push(domNode);
            allOldDomNodes.push(...domNode.childNodes);
        }
        // Select all dom nodes.
        for (const diff of diffs) {
            allOldDomNodes.push(...diff.dom);
        }
        // Sort the diff by ancestors.
        diffs.sort((da, db) => {
            let aLen = 0;
            let a = this._objects[da.id];
            while (a === null || a === void 0 ? void 0 : a.parent) {
                aLen++;
                a = this._objects[a.parent];
            }
            let bLen = 0;
            let b = this._objects[db.id];
            while (b === null || b === void 0 ? void 0 : b.parent) {
                bLen++;
                b = this._objects[b.parent];
            }
            return aLen - bLen;
        });
        // Redraw all objects.
        const objectToInsert = [];
        for (const diff of diffs) {
            if (this._updateDom(diff.id)) {
                objectToInsert.push(diff.id);
            }
        }
        // Insert object dom nodes which don't have direct object with nodeName
        // and not added by the updateDom because his parent have no diff.
        for (const id of objectToInsert) {
            const path = objectsPath[id] || [];
            const item = this._objects[id];
            let parent = this._objects[item.parent] || item;
            while (!parent.object.tag && parent.parent) {
                parent = this._objects[parent.parent];
            }
            const parentDomNode = parent.dom[0];
            const domNodes = [];
            for (const childId of parent.children) {
                domNodes.push(...this._getDomChild(childId, parentDomNode));
            }
            if (domNodes.length) {
                if (parent !== item && parent.object.tag) {
                    this._insertDomChildren(domNodes, parentDomNode, parentDomNode.firstChild);
                }
                else {
                    let parentDomNode;
                    let firstDomNode;
                    while (!parentDomNode && path.length) {
                        const pathItem = path.shift();
                        const isAvailableParent = pathItem[0].ownerDocument.contains(pathItem[0]) &&
                            !domNodes.find(domNode => pathItem[0] === domNode || domNode.contains(pathItem[0]));
                        if (isAvailableParent) {
                            parentDomNode = pathItem[0];
                            firstDomNode = parentDomNode.childNodes[pathItem[1]];
                        }
                    }
                    if (parentDomNode) {
                        this._insertDomChildren(domNodes, parentDomNode, firstDomNode);
                    }
                }
            }
        }
        // Clean/remove unused dom nodes.
        for (const domNode of allOldDomNodes) {
            if (!this._fromDom.get(domNode) && domNode.parentNode) {
                domNode.parentNode.removeChild(domNode);
            }
        }
        // Call attach methods for the changed domNodes.
        for (const id of this._domUpdated) {
            const object = this._objects[id];
            if (typeof (object === null || object === void 0 ? void 0 : object.object.attach) === 'function') {
                object.object.attach(...object.dom);
            }
        }
        this._domUpdated.clear();
        this._releasedItems.clear();
    }
    /**
     * Return the VNodes linked in renderng to the given VNode.
     *
     * @param node
     */
    getRenderedWith(node) {
        const id = this._fromItem.get(node);
        if (id) {
            const object = this._objects[id];
            const locations = this._locations.get(object.object);
            return [...(locations.length ? locations : this._items.get(object.object))];
        }
        return [];
    }
    /**
     * Return the VNode(s) corresponding to the given DOM Node.
     *
     * @param domNode
     */
    fromDom(domNode) {
        let object;
        const nodes = [];
        while (!object && domNode) {
            object = this._objects[this._fromDom.get(domNode)];
            const locations = object && this._locations.get(object.object);
            const items = object && (locations.length ? locations : this._items.get(object.object));
            if (items === null || items === void 0 ? void 0 : items.length) {
                for (const item of items) {
                    if (item instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
                        nodes.push(item);
                    }
                }
            }
            else {
                if (domNode.previousSibling) {
                    domNode = domNode.previousSibling;
                }
                else {
                    domNode = domNode.parentNode;
                }
            }
        }
        return nodes;
    }
    /**
     * Return the DOM Node corresponding to the given VNode.
     *
     * @param node
     */
    toDom(node) {
        const id = this._fromItem.get(node);
        const object = this._objects[id];
        if (!object) {
            return [];
        }
        else if (object.dom.length) {
            return [...object.dom];
        }
        else {
            return this._getchildrenDomNodes(id);
        }
    }
    /**
     * Return a position in the VNodes as a tuple containing a reference
     * node and a relative position with respect to this node ('BEFORE' or
     * 'AFTER'). The position is always given on the leaf.
     *
     * @param container
     * @param offset
     */
    locate(domNode, domOffset) {
        let forceAfter = false;
        let forcePrepend = false;
        let container = domNode;
        let offset = domOffset;
        // When targetting the end of a node, the DOM gives an offset that is
        // equal to the length of the container. In order to retrieve the last
        // descendent, we need to make sure we target an existing node, ie. an
        // existing index.
        if (!Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(domNode) && offset >= Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(container)) {
            forceAfter = true;
            offset = container.childNodes.length - 1;
            while (container.childNodes.length) {
                container = container.childNodes[offset];
                offset = container.childNodes.length - 1;
            }
        }
        // We are targetting the deepest descendant.
        while (container.childNodes[offset]) {
            if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(container.childNodes[offset]) === 'BR' &&
                !container.childNodes[offset].nextSibling) {
                // Target the last br in a container.
                forceAfter = true;
            }
            if (forceAfter) {
                container = container.childNodes[Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(container) - 1];
                offset = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(container) - 1;
            }
            else {
                container = container.childNodes[offset];
                offset = 0;
            }
        }
        // Search to domObject coresponding to the dom element.
        let object;
        while (!object) {
            const id = this._fromDom.get(container);
            if (id) {
                object = this._objects[id];
                if (!object) {
                    throw new Error('Dom location altered.');
                }
            }
            else if (container.previousSibling) {
                forceAfter = true;
                container = container.previousSibling;
                offset = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(container) - 1;
            }
            else {
                forcePrepend = true;
                offset = [].indexOf.call(container.parentNode.childNodes, container);
                container = container.parentNode;
            }
        }
        while (object.children[offset]) {
            const childId = object.children[offset];
            object = this._objects[childId];
            if (forceAfter && this._locations.get(object.object).length) {
                offset = this._locations.get(object.object).length - 1;
            }
            else {
                offset = 0;
            }
        }
        // For domObjectText, add the previous text length as offset.
        if (object.object.text && Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(domNode)) {
            const texts = object.dom;
            let index = texts.indexOf(domNode);
            while (index > 0) {
                index--;
                offset += texts[index].textContent.length;
            }
        }
        let objectChild = object;
        while (!this._locations.get(object.object).length) {
            const parent = this._objects[object.parent];
            const index = parent.children.indexOf(object.id);
            if (index > 0) {
                object = this._objects[parent.children[index - 1]];
                offset = object.children.length - 1;
                const locations = this._locations.get(object.object);
                if (locations.length) {
                    return [locations[locations.length - 1], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER];
                }
            }
            else {
                offset = parent.children.indexOf(objectChild.id);
                object = parent;
                objectChild = object;
                forcePrepend = true;
                const locations = this._locations.get(parent.object);
                if (locations.length === 1) {
                    offset = 0;
                    if (offset > parent.children.length / 2) {
                        forceAfter = true;
                    }
                }
            }
        }
        const locations = this._locations.get(object.object);
        if (!locations[offset]) {
            return [locations[locations.length - 1], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER];
        }
        else if (forcePrepend && locations[offset] instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"]) {
            return [locations[offset], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE];
        }
        else if (forceAfter) {
            return [locations[offset], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER];
        }
        else {
            return [locations[offset], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE];
        }
    }
    /**
     * Clear the map of all correspondances.
     *
     */
    clear() {
        for (const objectMap of Object.values(this._objects)) {
            if (typeof objectMap.object.detach === 'function') {
                objectMap.object.detach(...objectMap.dom);
            }
        }
        for (const fromDom of this._fromDom) {
            const domNode = fromDom[0];
            if (domNode.parentNode) {
                domNode.parentNode.removeChild(domNode);
            }
        }
        this._objects = {};
        this._fromItem.clear();
        this._fromDom.clear();
        this._renderedNodes.clear();
        this._renderedIds.clear();
        this._objectIds.clear();
        this._locations.clear();
        this._items.clear();
        this._rendererTreated.clear();
        this._domUpdated.clear();
    }
    /**
     * Return the location in the DOM corresponding to the location in the
     * VDocument of the given VNode. The location in the DOM is expressed as a
     * tuple containing a reference Node and a relative position with respect to
     * the reference Node.
     *
     * @param node
     */
    getLocations(node) {
        let reference = node.previousSibling();
        let position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        if (!reference || reference.hasChildren()) {
            reference = node.nextSibling();
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            if (reference) {
                reference = reference.firstLeaf();
            }
        }
        if (!reference) {
            reference = node.parent;
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE;
            if (!reference) {
                return;
            }
        }
        let object;
        let locations;
        // use the location
        let domNodes;
        let isText = true;
        const alreadyCheck = new Set();
        while (!domNodes && reference) {
            alreadyCheck.add(reference);
            const ids = this._renderedNodes.get(reference);
            if (ids) {
                for (let id of ids) {
                    object = this._objects[id];
                    locations = this._locations.get(object.object);
                    if (!locations.includes(reference)) {
                        let hasLocate;
                        const ids = [id];
                        while (ids.length && (!hasLocate || position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER)) {
                            const id = ids.pop();
                            const child = this._objects[id];
                            if (this._locations.get(child.object).includes(reference)) {
                                hasLocate = id;
                            }
                            if (child.children) {
                                ids.push(...[...child.children].reverse());
                            }
                        }
                        id = hasLocate;
                        object = this._objects[id];
                        locations = this._locations.get(object.object);
                    }
                    if (object.dom.length) {
                        if (!domNodes)
                            domNodes = [];
                        domNodes.push(...object.dom);
                    }
                    else {
                        if (!domNodes)
                            domNodes = [];
                        domNodes.push(...this._getchildrenDomNodes(id));
                    }
                    if (domNodes.length && (object.object.tag || object.object.dom)) {
                        isText = false;
                    }
                }
            }
            if (!(domNodes === null || domNodes === void 0 ? void 0 : domNodes.length) || !domNodes[0].parentNode) {
                const next = reference.nextLeaf();
                if (next && !alreadyCheck.has(next)) {
                    position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
                    reference = next;
                }
                else {
                    position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE;
                    reference = reference.parent;
                }
                domNodes = null;
            }
        }
        let domNode;
        let offset = position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER
            ? locations.lastIndexOf(reference)
            : locations.indexOf(reference);
        if (isText) {
            let index = 0;
            while (offset >= domNodes[index].textContent.length) {
                offset -= domNodes[index].textContent.length;
                index++;
            }
            domNode = domNodes[index];
            if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
                // Increment the offset to be positioned after the reference node.
                offset += 1;
            }
        }
        else if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
            domNode = domNodes[offset];
            offset = 0;
        }
        else {
            if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
                domNode = domNodes[domNodes.length - 1];
            }
            else {
                domNode = domNodes[0];
            }
            if (domNode.nodeType === Node.TEXT_NODE) {
                offset = domNode.textContent.length;
            }
            else {
                // Char nodes have their offset in the corresponding text nodes
                // registered in the map via `set` but void nodes don't. Their
                // location need to be computed with respect to their parents.
                const container = domNode.parentNode;
                offset = Array.prototype.indexOf.call(container.childNodes, domNode);
                domNode = container;
                if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
                    // Increment the offset to be positioned after the reference node.
                    offset += 1;
                }
            }
        }
        return [domNode, offset];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    // eslint-disable-next-line max-params
    _diffObject(nodeToDomObject, domObject, fromNodes, mapOldIds, childrenMapping) {
        let oldIds = mapOldIds.get(domObject);
        const items = this._items.get(domObject);
        if (!oldIds) {
            oldIds = new Set();
            if (items) {
                for (const item of items) {
                    const ids = this._renderedNodes.get(item);
                    if (ids) {
                        for (const id of ids) {
                            if (!this._diff[id]) {
                                oldIds.add(id);
                            }
                        }
                    }
                }
            }
        }
        let hasChanged = false;
        if (oldIds.size) {
            for (const id of [...oldIds]) {
                const old = this._objects[id];
                if (!old || this._rendererTreated.has(old.object)) {
                    oldIds.delete(id);
                }
            }
            if (!childrenMapping) {
                childrenMapping = this._diffObjectAssociateChildrenMap(domObject, oldIds);
            }
            hasChanged = oldIds.size !== 1;
        }
        let id = childrenMapping === null || childrenMapping === void 0 ? void 0 : childrenMapping.get(domObject);
        if (id) {
            oldIds.add(id);
        }
        let old = this._objects[id];
        if (old && !this._rendererTreated.has(old.object)) {
            childrenMapping.delete(domObject);
            this._rendererTreated.add(old.object);
        }
        else {
            old = null;
            hasChanged = true;
            diffObjectId++;
            id = diffObjectId;
        }
        this._rendererTreated.add(domObject);
        this._objectIds.set(domObject, id);
        const removedChildren = [];
        const diffAttributes = {};
        const diffStyle = {};
        const diffClassList = {};
        const nodes = this._locations.get(domObject) || [];
        const attributes = {};
        const children = [];
        let domNodes = [];
        let allDomNodes = [];
        let domNodesChildren;
        let domNodesChildrenProcess;
        const oldChildren = (old === null || old === void 0 ? void 0 : old.children) || [];
        const newChildren = domObject.children || [];
        if (domObject.dom) {
            hasChanged = true;
            domNodes = domObject.dom;
            domNodesChildrenProcess = [];
            const placeholders = {};
            let havePlaceholder = false;
            for (const domNode of domNodes) {
                if (domNode instanceof Element) {
                    if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(domNode) === 'JW-DOMOBJECT-VNODE') {
                        havePlaceholder = true;
                        placeholders[domNode.id] = domNode;
                    }
                    else {
                        const childNodes = domNode.shadowRoot
                            ? domNode.shadowRoot.querySelectorAll('jw-domobject-vnode')
                            : domNode.querySelectorAll('jw-domobject-vnode');
                        for (const dom of childNodes) {
                            havePlaceholder = true;
                            placeholders[dom.id] = dom;
                        }
                    }
                }
            }
            if (havePlaceholder) {
                const placeholderVNodes = [];
                const allNodes = fromNodes.filter(item => item instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]);
                for (const node of allNodes) {
                    allNodes.push(...node.childVNodes);
                }
                for (const node of allNodes) {
                    const placeholder = placeholders[node.id];
                    if (placeholder) {
                        placeholderVNodes.push([placeholder, node]);
                    }
                }
                placeholderVNodes.reverse();
                for (const [placeholder, node] of placeholderVNodes) {
                    let child;
                    let index = domNodes.indexOf(placeholder);
                    if (index !== -1) {
                        if (index !== domNodes.length - 1) {
                            // Eg: [PLACEHOLDER, PLACEHOLDER, <div></div>]
                            child = [domNodes[index + 1], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE, [node]];
                        }
                        else {
                            // Eg: [<div></div>, PLACEHOLDER, PLACEHOLDER]
                            while (!child && index > 0) {
                                index--;
                                if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(domNodes[index]) !== 'JW-DOMOBJECT-VNODE') {
                                    child = [domNodes[index], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER, [node]];
                                }
                            }
                        }
                        domNodes.splice(domNodes.indexOf(placeholder), 1);
                    }
                    else if (placeholder.nextSibling) {
                        // Eg: [<div>PLACEHOLDER<i></i></div>]
                        child = [placeholder.nextSibling, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE, [node]];
                    }
                    else if (placeholder.parentNode) {
                        // Eg: [<div><i></i>PLACEHOLDER</div>]
                        child = [placeholder.parentNode, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE, [node]];
                    }
                    if (child) {
                        const next = domNodesChildrenProcess.find(next => next[0] === child[0] && next[1] === child[1]);
                        if (next) {
                            next[2].unshift(node);
                        }
                        else {
                            domNodesChildrenProcess.push(child);
                        }
                    }
                    newChildren.push(node);
                    placeholder.remove();
                }
                if (!domNodesChildrenProcess.length) {
                    // Every domNodes are placeholder. It's like children only.
                    domNodesChildrenProcess = null;
                }
            }
            // Add all nodes as mapping to avoid association by children.
            allDomNodes = [];
            const allNodes = [...domNodes];
            while (allNodes.length) {
                const domNode = allNodes.pop();
                allDomNodes.push(domNode);
                if (domNode instanceof Element) {
                    allNodes.push(...domNode.childNodes);
                }
            }
        }
        for (const child of newChildren) {
            let childId;
            if (child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
                const domObject = nodeToDomObject.get(child);
                let oldChildId = this._objectIds.get(domObject) || this._fromItem.get(child);
                if (!oldChildId) {
                    const oldChildIds = this._renderedNodes.get(child);
                    if (oldChildIds === null || oldChildIds === void 0 ? void 0 : oldChildIds.size) {
                        oldChildId = [...oldChildIds][0];
                    }
                }
                const nodes = this._items.get(domObject);
                if (this._rendererTreated.has(domObject)) {
                    childId = oldChildId;
                }
                else if (!domObject) {
                    if (oldChildId) {
                        childId = oldChildId;
                    }
                    else {
                        console.error('No rendering for the node(' + child.id + '): ' + child.name);
                    }
                }
                else {
                    childId = this._diffObject(nodeToDomObject, domObject, nodes, mapOldIds);
                    this._renderedIds.add(childId);
                }
            }
            else if (this._rendererTreated.has(child)) {
                childId = this._objectIds.get(child);
            }
            else {
                childId = this._diffObject(nodeToDomObject, child, nodes, mapOldIds, childrenMapping);
            }
            if (childId) {
                this._objects[childId].parent = id;
                if (!children.includes(childId)) {
                    children.push(childId);
                }
            }
        }
        if (children.join() !== oldChildren.join()) {
            hasChanged = true;
            for (const childId of oldChildren) {
                if (!children.includes(childId)) {
                    if (this._objects[childId].parent === id) {
                        this._objects[childId].parent = null;
                    }
                    removedChildren.push(childId);
                }
            }
        }
        if (domNodesChildrenProcess) {
            domNodesChildren = [];
            for (const [ref, position, nodes] of domNodesChildrenProcess) {
                const nodeIds = nodes
                    .map(node => this._fromItem.get(node))
                    .filter(id => id);
                domNodesChildren.push([ref, position, nodeIds]);
            }
        }
        if (!domNodes.length && domObject.tag) {
            if (!old || domObject.tag !== old.object.tag) {
                hasChanged = true;
            }
            // Update attributes.
            const newAttributes = domObject.attributes || {};
            const oldAttributes = (old === null || old === void 0 ? void 0 : old.object.attributes) || {};
            for (const name in oldAttributes) {
                if (!newAttributes[name]) {
                    hasChanged = true;
                    if (name === 'style') {
                        for (const key in oldAttributes[name]) {
                            diffStyle[key] = null;
                        }
                    }
                    else if (name === 'class') {
                        for (const className of oldAttributes[name]) {
                            diffClassList[className] = false;
                        }
                    }
                    else {
                        diffAttributes[name] = null;
                    }
                }
            }
            for (const name in newAttributes) {
                if (name === 'style') {
                    const newStyle = newAttributes[name];
                    const oldStyle = oldAttributes[name];
                    if (oldStyle) {
                        for (const key in oldStyle) {
                            if (!newStyle[key]) {
                                hasChanged = true;
                                diffStyle[key] = null;
                            }
                        }
                    }
                    for (const key in newStyle) {
                        if (newStyle[key] !== (oldStyle === null || oldStyle === void 0 ? void 0 : oldStyle[key])) {
                            hasChanged = true;
                            diffStyle[key] = newStyle[key];
                        }
                    }
                }
                else if (name === 'class') {
                    const newClassNames = newAttributes[name];
                    const oldClassNames = oldAttributes[name];
                    if (oldClassNames) {
                        for (const className of oldClassNames) {
                            if (className && !newClassNames.has(className)) {
                                hasChanged = true;
                                diffClassList[className] = false;
                            }
                        }
                    }
                    for (const className of newClassNames) {
                        if (className && !(oldClassNames === null || oldClassNames === void 0 ? void 0 : oldClassNames.has(className))) {
                            hasChanged = true;
                            diffClassList[className] = true;
                        }
                    }
                }
                else {
                    const value = newAttributes[name];
                    if (value !== oldAttributes[name]) {
                        hasChanged = true;
                        diffAttributes[name] = value;
                    }
                }
                attributes[name] = newAttributes[name];
            }
        }
        else if (!domNodes.length && domObject.text) {
            if (!old || domObject.text !== old.object.text) {
                hasChanged = true;
            }
        }
        else if (!domNodes.length && (old === null || old === void 0 ? void 0 : old.dom.length)) {
            hasChanged = true;
        }
        // remove old referencies
        const oldIdsToRelease = [];
        if (items && oldIds.size) {
            oldIdsToRelease.push(...oldIds);
        }
        if (old) {
            oldIdsToRelease.push(old.id);
            if (typeof old.object.detach === 'function') {
                old.object.detach(...old.dom);
            }
        }
        for (const id of oldIdsToRelease) {
            const old = this._objects[id];
            for (const item of this._items.get(old.object)) {
                const ids = this._renderedNodes.get(item);
                if (ids && ids.has(id)) {
                    if (!this._releasedItems.has(item)) {
                        this._releasedItems.add(item);
                        this._renderedNodes.delete(item);
                    }
                }
            }
        }
        // Add new referencies.
        for (const node of nodes) {
            this._fromItem.set(node, id);
        }
        if (items) {
            for (const item of new Set([...items, ...this._items.get(domObject)])) {
                let ids = this._renderedNodes.get(item);
                if (!ids) {
                    ids = new Set();
                    this._renderedNodes.set(item, ids);
                }
                ids.add(id);
            }
        }
        if (!this._locations.get(domObject)) {
            this._locations.set(domObject, []);
        }
        this._objects[id] = {
            id: id,
            object: domObject,
            parent: old === null || old === void 0 ? void 0 : old.parent,
            children: children,
            dom: domNodes,
            domNodes: allDomNodes,
            domNodesChildren: domNodesChildren,
            parentDomNode: old === null || old === void 0 ? void 0 : old.parentDomNode,
        };
        if (hasChanged) {
            const oldDomNodes = (old === null || old === void 0 ? void 0 : old.dom) ? [...old.dom] : [];
            if (oldIds) {
                for (const id of oldIds) {
                    for (const domNode of this._objects[id].dom) {
                        if (!oldDomNodes.includes(domNode)) {
                            oldDomNodes.push(domNode);
                        }
                    }
                }
            }
            this._diff[id] = {
                id: id,
                attributes: diffAttributes,
                style: diffStyle,
                classList: diffClassList,
                dom: oldDomNodes,
                parentDomNode: old === null || old === void 0 ? void 0 : old.parentDomNode,
                removedChildren: removedChildren,
            };
        }
        else {
            this._objects[id].dom = old.dom;
            if (typeof domObject.attach === 'function') {
                domObject.attach(...old.dom);
            }
        }
        return id;
    }
    _diffObjectAssociateChildrenMap(objectA, objectIdsB) {
        const map = new Map();
        if (!objectIdsB.size) {
            return map;
        }
        const allChildrenA = [objectA];
        for (const domObject of allChildrenA) {
            if (domObject.children) {
                for (const child of domObject.children) {
                    if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                        allChildrenA.push(child);
                    }
                }
            }
        }
        const allChildrenB = [...objectIdsB];
        for (const id of allChildrenB) {
            const objB = this._objects[id];
            this._rendererTreated.delete(objB.object);
            if (objB === null || objB === void 0 ? void 0 : objB.children) {
                for (const id of objB.children) {
                    if (this._objects[id] && !this._renderedIds.has(id)) {
                        allChildrenB.push(id);
                    }
                }
            }
        }
        const mapRatios = this._diffObjectAssociateChildren(allChildrenA, allChildrenB);
        mapRatios.sort((a, b) => b[0] - a[0]);
        const used = new Set();
        for (const [, childRef, id] of mapRatios) {
            if (!map.get(childRef) && !used.has(id)) {
                map.set(childRef, id);
                used.add(id);
            }
        }
        return map;
    }
    _diffObjectAssociateChildren(arrayA, arrayB) {
        const mapRatios = [];
        for (const objectA of arrayA) {
            for (const idB of arrayB) {
                const itemB = this._objects[idB];
                const objectB = itemB.object;
                let currentRatio = 0;
                if (objectA.tag) {
                    if (objectA.tag === objectB.tag) {
                        const attrA = objectA.attributes || {};
                        const attrB = objectB.attributes;
                        // add some points for attributes matching
                        let max = 0;
                        let same = 0;
                        for (const name in attrA) {
                            if (name === 'style') {
                                const styleA = attrA[name];
                                const styleB = attrB === null || attrB === void 0 ? void 0 : attrB[name];
                                if (styleA) {
                                    for (const key in styleA) {
                                        max++;
                                        if (styleA[key] === (styleB === null || styleB === void 0 ? void 0 : styleB[key])) {
                                            same++;
                                        }
                                    }
                                }
                            }
                            else if (name === 'class') {
                                const classA = attrA[name];
                                const classB = attrB === null || attrB === void 0 ? void 0 : attrB[name];
                                if (classA) {
                                    for (const c of classA) {
                                        max++;
                                        if (classB === null || classB === void 0 ? void 0 : classB.has(c)) {
                                            same++;
                                        }
                                    }
                                }
                            }
                            else {
                                max++;
                                if (attrA[name] === (attrB === null || attrB === void 0 ? void 0 : attrB[name])) {
                                    same++;
                                }
                            }
                        }
                        for (const name in attrB) {
                            if (name === 'style') {
                                const styleA = attrA === null || attrA === void 0 ? void 0 : attrA[name];
                                const styleB = attrB[name];
                                if (styleB) {
                                    for (const key in styleB) {
                                        if (!styleA || !(key in styleA)) {
                                            max++;
                                        }
                                    }
                                }
                            }
                            else if (name === 'class') {
                                const classA = attrA === null || attrA === void 0 ? void 0 : attrA[name];
                                const classB = attrB[name];
                                if (classB) {
                                    for (const c of classB) {
                                        if (!(classA === null || classA === void 0 ? void 0 : classA.has(c))) {
                                            max++;
                                        }
                                    }
                                }
                            }
                            else if (!attrA || !(name in attrA)) {
                                max++;
                            }
                        }
                        currentRatio = 1 + same / (max || 1);
                    }
                }
                else if (objectA.text) {
                    if (objectB.text) {
                        currentRatio = 1;
                    }
                }
                else if (objectA.dom) {
                    if (itemB.dom.length && !objectB.tag && !objectB.text) {
                        currentRatio = 1;
                    }
                }
                else if (objectA.children) {
                    if (itemB.children && !objectB.text && !objectB.tag) {
                        currentRatio = 1;
                    }
                }
                if (currentRatio >= 1) {
                    // The best have at leat on node in common or the twice does not have node.
                    const itemsA = this._items.get(objectA);
                    const itemsB = this._items.get(objectB);
                    // Some points for children nodes.
                    let matchNode = 0;
                    let maxNode = 0;
                    for (const node of itemsA) {
                        if (node instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
                            maxNode++;
                            if (itemsB.includes(node)) {
                                matchNode++;
                            }
                        }
                    }
                    for (const node of itemsB) {
                        if (node instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
                            if (!itemsB.includes(node)) {
                                maxNode++;
                            }
                        }
                    }
                    const nodeRatio = maxNode ? matchNode / maxNode : 1;
                    if (nodeRatio > 0) {
                        currentRatio += nodeRatio;
                        // The best candidate must have the most common located nodes.
                        const locA = this._locations.get(objectA);
                        const locB = this._locations.get(objectB);
                        let match = 0;
                        let max = 0;
                        for (const node of locA) {
                            max++;
                            if (locB.includes(node)) {
                                match++;
                            }
                        }
                        for (const node of locB) {
                            if (!locA.includes(node)) {
                                max++;
                            }
                        }
                        currentRatio += max ? match / max : 0;
                        // The best candidate must have the most common modifiers.
                        let matchModifier = 0;
                        let maxModifier = 0;
                        for (const node of itemsA) {
                            if (!(node instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                                maxModifier++;
                                if (itemsB.includes(node)) {
                                    matchModifier++;
                                }
                            }
                        }
                        for (const node of itemsB) {
                            if (!(node instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                                if (!itemsB.includes(node)) {
                                    maxModifier++;
                                }
                            }
                        }
                        currentRatio += (maxModifier ? matchModifier / maxModifier : 0) / 10;
                        mapRatios.push([currentRatio, objectA, idB]);
                    }
                }
            }
        }
        return mapRatios;
    }
    _addLocations(domObject, locations, from) {
        const allItems = [];
        const items = from.get(domObject);
        if (items) {
            for (const item of items) {
                if (!allItems.includes(item)) {
                    allItems.push(item);
                }
            }
        }
        const nodes = locations.get(domObject);
        if (nodes) {
            this._locations.set(domObject, nodes ? Array.from(nodes) : []);
            for (const node of nodes) {
                if (!allItems.includes(node)) {
                    allItems.push(node);
                }
            }
        }
        else {
            this._locations.set(domObject, []);
        }
        if (domObject.children) {
            for (const index in domObject.children) {
                const child = domObject.children[index];
                if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                    for (const node of this._addLocations(child, locations, from)) {
                        allItems.push(node);
                    }
                }
            }
        }
        this._items.set(domObject, allItems);
        return allItems;
    }
    _updateDom(id) {
        var _a;
        const diff = this._diff[id];
        if (!diff) {
            return;
        }
        const object = this._objects[id];
        const domObject = object.object;
        let newNode = false;
        if (domObject.tag) {
            let domNode = this._getAvailableElement(id);
            if (domNode && !domObject.shadowRoot !== !domNode.shadowRoot) {
                domNode = null;
            }
            let attributes;
            if (domNode) {
                if (diff.askCompleteRedrawing) {
                    for (const attr of domNode.attributes) {
                        const value = domObject.attributes[attr.name];
                        if (typeof value === 'undefined') {
                            domNode.removeAttribute(attr.name);
                        }
                    }
                    attributes = domObject.attributes;
                }
                else {
                    attributes = diff.attributes;
                }
                if (!diff.askCompleteRedrawing) {
                    for (const name in diff.style) {
                        setStyle(domNode, name, diff.style[name] || '');
                    }
                    for (const name in diff.classList) {
                        if (diff.classList[name]) {
                            domNode.classList.add(name);
                        }
                        else {
                            domNode.classList.remove(name);
                        }
                    }
                }
            }
            else {
                domNode = document.createElement(domObject.tag);
                attributes = domObject.attributes;
                if (domObject.shadowRoot) {
                    domNode.attachShadow({ mode: 'open' });
                }
            }
            for (const name in attributes) {
                if (name === 'style') {
                    const style = attributes[name];
                    for (const name in style) {
                        setStyle(domNode, name, style[name]);
                    }
                    // Now we set the attribute again to keep order.
                    const styleInline = domNode.getAttribute('style');
                    if (styleInline) {
                        domNode.setAttribute('style', styleInline);
                    }
                }
                else if (name === 'class') {
                    const classList = attributes[name];
                    for (const className of classList) {
                        domNode.classList.add(className);
                    }
                    // Now we set the attribute again to keep order.
                    const classInline = domNode.getAttribute('class');
                    if (classInline) {
                        domNode.setAttribute('class', classInline);
                    }
                }
                else {
                    const value = attributes[name];
                    if (typeof value === 'string') {
                        domNode.setAttribute(name, value);
                    }
                    else if (!value) {
                        domNode.removeAttribute(name);
                    }
                }
            }
            if (domNode.getAttribute('class') === '') {
                domNode.removeAttribute('class');
            }
            if (domNode.getAttribute('style') === '') {
                domNode.removeAttribute('style');
            }
            object.dom = [domNode];
        }
        else if (domObject.text) {
            object.dom = this._redrawAndAssociateText(id);
        }
        else if (object.domNodesChildren && object.dom.length) {
            for (const domNode of object.dom) {
                if (this._fromDom.get(domNode) !== id) {
                    this._fromDom.set(domNode, id);
                    newNode = true;
                }
            }
            // Add all nodes as mapping to avoid association by children.
            for (const domNode of object.domNodes) {
                this._fromDom.set(domNode, id);
            }
            // Insert children in the dom which locate with the placeholder.
            for (const [ref, position, childIds] of object.domNodesChildren) {
                if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
                    const childDomNodes = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["flat"])(childIds.map(childId => this._getDomChild(childId, ref)));
                    for (const domNode of childDomNodes) {
                        ref.appendChild(domNode);
                    }
                }
                else {
                    const childDomNodes = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["flat"])(childIds.map(childId => this._getDomChild(childId, ref.parentElement)));
                    if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
                        for (const domNode of childDomNodes) {
                            ref.parentElement.insertBefore(domNode, ref);
                        }
                    }
                    else if (ref.nextSibling) {
                        const next = ref.nextSibling;
                        for (const domNode of childDomNodes) {
                            ref.parentElement.insertBefore(domNode, next);
                        }
                    }
                    else {
                        ref.parentElement.append(...childDomNodes);
                    }
                }
            }
            // Remove protected mapping.
            for (const domNode of object.domNodes) {
                this._fromDom.delete(domNode);
            }
            for (const domNode of object.dom) {
                this._fromDom.set(domNode, id);
            }
            // TODO remove ?
            let item = (_a = diff.dom) === null || _a === void 0 ? void 0 : _a[0];
            const parent = item === null || item === void 0 ? void 0 : item.parentNode;
            if (parent) {
                for (const domNode of object.dom) {
                    if (!item) {
                        parent.appendChild(domNode);
                    }
                    else if (domNode !== item) {
                        parent.insertBefore(domNode, item);
                    }
                    else {
                        item = domNode.nextSibling;
                    }
                }
            }
        }
        for (const domNode of diff.dom) {
            if (this._fromDom.get(domNode) === id && !object.dom.includes(domNode)) {
                this._fromDom.delete(domNode);
            }
        }
        for (const domNode of object.dom) {
            if (this._fromDom.get(domNode) !== id || !domNode.parentNode) {
                this._fromDom.set(domNode, id);
                newNode = true;
            }
        }
        if (!object.domNodesChildren && object.children.length) {
            let parentDomNode = object.parentDomNode;
            if (domObject.tag) {
                parentDomNode = object.dom[0];
                if (domObject.shadowRoot) {
                    parentDomNode = parentDomNode.shadowRoot;
                }
            }
            const domNodes = [];
            for (const childId of object.children) {
                domNodes.push(...this._getDomChild(childId, parentDomNode));
            }
            if (domNodes.length) {
                if (domObject.tag) {
                    this._insertDomChildren(domNodes, parentDomNode, parentDomNode.firstChild);
                }
                else {
                    newNode = true;
                }
            }
        }
        delete this._diff[id];
        this._domUpdated.add(id);
        return newNode;
    }
    _getDomChild(id, parentDomNode) {
        // Apply diff for descendents if needed.
        const descendents = [id];
        for (const id of descendents) {
            const descendent = this._objects[id];
            descendent.parentDomNode = parentDomNode;
            if (this._diff[id]) {
                this._updateDom(id);
            }
            else if (!('tag' in descendent.object) && descendent.children) {
                // Get children if it's a fragment.
                descendents.push(...descendent.children);
            }
        }
        // Get the dom representing this child.
        let domNodes = [];
        const child = this._objects[id];
        if (child.dom.length) {
            domNodes = child.dom;
        }
        else {
            domNodes = this._getchildrenDomNodes(id);
        }
        return domNodes;
    }
    _redrawAndAssociateText(id) {
        var _a;
        const domObject = this._objects[id].object;
        const textContent = domObject.text;
        let textNodes = this._getAvailableTextNodes(id);
        if (textNodes) {
            const chars = [];
            for (const textNode of textNodes) {
                const split = textNode.textContent.split('');
                if (split.length) {
                    for (let i = 0; i < split.length; i++) {
                        chars.push([split[i], textNode, i]);
                    }
                }
                else {
                    chars.push(['', textNode, 0]);
                }
            }
            const len = textContent.length;
            const charLen = chars.length;
            const maxLen = Math.max(len, charLen);
            let index = 0;
            let indexFirstChange = null; // index from begin
            let indexLastChange = null; // index from end
            while ((indexFirstChange === null || indexLastChange === null) && index < maxLen) {
                if (indexFirstChange === null) {
                    const char = textContent[index];
                    const old = chars[index];
                    if (!old || char !== old[0]) {
                        indexFirstChange = index;
                    }
                }
                if (indexLastChange === null) {
                    const char = textContent[len - 1 - index];
                    const old = chars[charLen - 1 - index];
                    if (!old || char !== old[0]) {
                        indexLastChange = index;
                    }
                }
                index++;
            }
            if (indexFirstChange !== null) {
                let textBegin;
                let textEnd;
                let first;
                let center;
                let last;
                const charBegin = chars[indexFirstChange];
                if (charBegin) {
                    textBegin = textEnd = charBegin[1];
                    first = textBegin.textContent.slice(0, charBegin[2]);
                    const charEnd = chars[charLen - indexLastChange];
                    if (indexFirstChange >= len - indexLastChange || !charEnd) {
                        // The indexes of the destination text cross, it is that
                        // the end and the beginning are just. Certain
                        // characters should be removed and replce by the and
                        // of the needed textContent. If there is no ending
                        // change, every ending chars are false and will be
                        // removed and replace by the new ending text.
                        // Please note that you must keep the existing text
                        // nodes. And therefore remove the character in the
                        // text nodes present in the dom.
                        const charEnd = chars[charLen - indexLastChange + 1] || chars[charLen - 1];
                        indexLastChange = charLen;
                        textEnd = charEnd[1];
                        center = '';
                        last = textContent.slice(indexFirstChange);
                    }
                    else {
                        // The indexes, do not cross, so we will add the
                        // missing piece and remove the erroneous characters.
                        textEnd = charEnd[1];
                        last = textEnd.textContent.slice(charEnd[2]);
                        center = textContent.slice(indexFirstChange, len - indexLastChange);
                    }
                }
                else {
                    // If there is no start of change, this implies that only
                    // characters must be added.
                    const char = chars[indexFirstChange - 1];
                    textBegin = textEnd = char[1];
                    first = textBegin.textContent;
                    center = textContent.slice(indexFirstChange);
                    last = '';
                }
                // Search every text nodes between the begin and end of the
                // changes. This text nodes will be removed.
                const textsBetweenStartEnd = [];
                for (let index = indexFirstChange; index < indexLastChange; index++) {
                    const text = (_a = chars[index]) === null || _a === void 0 ? void 0 : _a[1];
                    if (text &&
                        text !== textBegin &&
                        text !== textEnd &&
                        !textsBetweenStartEnd.includes(text)) {
                        textsBetweenStartEnd.push(text);
                    }
                }
                // Update the dom with the minimum of mutations.
                if (textBegin === textEnd) {
                    if (first === '' && center === '' && last === '') {
                        textsBetweenStartEnd.push(textBegin);
                    }
                    else if (textBegin.textContent !== first + center + last) {
                        textBegin.textContent = first + center + last;
                    }
                }
                else {
                    if (first === '' && center === '') {
                        textsBetweenStartEnd.push(textBegin);
                    }
                    else if (textBegin.textContent !== first + center) {
                        textBegin.textContent = first + center;
                    }
                    if (last === '') {
                        textsBetweenStartEnd.push(textEnd);
                    }
                    else if (textEnd.textContent !== last) {
                        textEnd.textContent = last;
                    }
                }
                // Removes text nodes between the begin and end, and may be
                // remove an other text node, if it's replace by an empty string.
                for (const domNode of textsBetweenStartEnd) {
                    textNodes.splice(textNodes.indexOf(domNode), 1);
                    domNode.parentNode.removeChild(domNode);
                }
            }
        }
        else {
            textNodes = [document.createTextNode(textContent)];
        }
        return textNodes;
    }
    /**
     * Insert missing domNodes in this element.
     */
    _insertDomChildren(domNodes, parentNode, insertBefore) {
        for (const domNode of domNodes) {
            if (insertBefore) {
                if (insertBefore === domNode) {
                    insertBefore = insertBefore.nextSibling;
                }
                else {
                    parentNode.insertBefore(domNode, insertBefore);
                }
            }
            else {
                parentNode.appendChild(domNode);
            }
        }
    }
    _getAvailableElement(id) {
        const object = this._objects[id];
        const domObject = object.object;
        const tagName = domObject.tag.toUpperCase();
        const diff = this._diff[id];
        if (object.parentDomNode) {
            for (const domNode of object.parentDomNode.childNodes) {
                if (tagName === Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(domNode) && this.isAvailableNode(id, domNode)) {
                    return domNode;
                }
            }
        }
        if (diff) {
            for (const domNode of diff.dom) {
                if (tagName === Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(domNode) && this.isAvailableNode(id, domNode)) {
                    return domNode;
                }
            }
        }
    }
    _getAvailableTextNodes(id) {
        const object = this._objects[id];
        const diff = this._diff[id];
        let textNode;
        if (object.parentDomNode) {
            for (const domNode of object.parentDomNode.childNodes) {
                if (Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(domNode) && this.isAvailableNode(id, domNode)) {
                    textNode = domNode;
                }
            }
        }
        if (!textNode && diff) {
            for (const domNode of diff.dom) {
                if (Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(domNode) && this.isAvailableNode(id, domNode)) {
                    textNode = domNode;
                }
            }
        }
        if (textNode) {
            // Get all free text nodes.
            const textNodes = [textNode];
            let text = textNode;
            while (text.previousSibling &&
                Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(text.previousSibling) &&
                this.isAvailableNode(id, text.previousSibling)) {
                text = text.previousSibling;
                textNodes.unshift(text);
            }
            text = textNode;
            while (text.nextSibling &&
                Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_4__["isTextNode"])(text.nextSibling) &&
                this.isAvailableNode(id, text.nextSibling)) {
                text = text.nextSibling;
                textNodes.push(text);
            }
            return textNodes;
        }
    }
    /**
     * Check if the domNode are already associate to an other domObject and
     * this object don't need to be redrawed. The additional checking for the
     * diff is't use to associate the domNodecreate by a split from the browser.
     * The browser can add the new domNode after or before the split.
     */
    isAvailableNode(id, domNode) {
        var _a;
        const linkedId = this._fromDom.get(domNode);
        if (!linkedId) {
            // The browser can separate an item and keep all attributes on the
            // clone. In the event of a new element to be associated, a
            // complete redrawing is requested.
            this._diff[id].askCompleteRedrawing = true;
            return true;
        }
        if (linkedId === id) {
            return true;
        }
        if ((_a = this._diff[linkedId]) === null || _a === void 0 ? void 0 : _a.askCompleteRedrawing) {
            // The browser can add the new domNode after or before the split.
            // In this case, there is a change in both elements. In the case of
            // text it is important to keep the dom intact in order to guarantee
            // the operation of the spell checkers. It is also important to keep
            // order for the parents of these texts, but by doing this, we are
            // forced to reset the content, animations may be lost.
            this._diff[id].askCompleteRedrawing = true;
            return true;
        }
    }
    _getchildrenDomNodes(id) {
        const object = this._objects[id];
        const domNodes = [];
        const treatedObject = [];
        if (object.children) {
            for (const childId of object.children) {
                const child = this._objects[childId];
                if (child && !treatedObject.includes(childId)) {
                    treatedObject.push(childId);
                    let childDomNodes;
                    if (child.dom.length) {
                        childDomNodes = child.dom;
                    }
                    else {
                        childDomNodes = this._getchildrenDomNodes(childId);
                    }
                    for (const node of childDomNodes) {
                        if (!domNodes.includes(node)) {
                            domNodes.push(node);
                        }
                    }
                }
            }
        }
        return domNodes;
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/LabelDomObjectRenderer.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/LabelDomObjectRenderer.ts ***!
  \******************************************************************/
/*! exports provided: LabelDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabelDomObjectRenderer", function() { return LabelDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/LabelNode */ "./packages/plugin-layout/src/LabelNode.ts");



class LabelDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_2__["LabelNode"];
    }
    async render(label) {
        const objectLabel = {
            tag: 'SPAN',
            attributes: { class: new Set(['label']) },
            children: [{ text: label.label }],
        };
        return objectLabel;
    }
}
LabelDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/LayoutContainerDomObjectRenderer.ts":
/*!****************************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/LayoutContainerDomObjectRenderer.ts ***!
  \****************************************************************************/
/*! exports provided: LayoutContainerDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutContainerDomObjectRenderer", function() { return LayoutContainerDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LayoutContainerNode */ "./packages/plugin-dom-layout/src/LayoutContainerNode.ts");



class LayoutContainerDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_2__["LayoutContainer"];
    }
    async render(node) {
        return {
            children: [...node.childVNodes],
        };
    }
}
LayoutContainerDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/LayoutContainerNode.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/LayoutContainerNode.ts ***!
  \***************************************************************/
/*! exports provided: LayoutContainer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutContainer", function() { return LayoutContainer; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class LayoutContainer extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor() {
        super(...arguments);
        this.editable = false;
        this.breakable = false;
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/SeparatorDomObjectRenderer.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/SeparatorDomObjectRenderer.ts ***!
  \**********************************************************************/
/*! exports provided: SeparatorDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SeparatorDomObjectRenderer", function() { return SeparatorDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");
/* harmony import */ var _plugin_toolbar_src_ToolbarNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-toolbar/src/ToolbarNode */ "./packages/plugin-toolbar/src/ToolbarNode.ts");




class SeparatorDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => node instanceof _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_2__["SeparatorNode"] && !!node.ancestor(_plugin_toolbar_src_ToolbarNode__WEBPACK_IMPORTED_MODULE_3__["ToolbarNode"]);
    }
    async render() {
        const objectSeparator = {
            tag: 'JW-SEPARATOR',
            attributes: { role: 'separator' },
        };
        return objectSeparator;
    }
}
SeparatorDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ZoneDomObjectRenderer.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ZoneDomObjectRenderer.ts ***!
  \*****************************************************************/
/*! exports provided: ZoneDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneDomObjectRenderer", function() { return ZoneDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");



class ZoneDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__["ZoneNode"];
    }
    async render(node, worker) {
        var _a;
        const children = node.children();
        const domObject = { children: [] };
        for (let index = 0, len = children.length; index < len; index++) {
            const child = children[index];
            if (!((_a = node.hidden) === null || _a === void 0 ? void 0 : _a[child.id])) {
                domObject.children.push(child);
            }
            worker.depends(child, node);
        }
        return domObject;
    }
}
ZoneDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ZoneXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ZoneXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: ZoneXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneXmlDomParser", function() { return ZoneXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ZoneXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T' && !!item.getAttribute('t-zone');
        };
    }
    async parse(item) {
        return [new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__["ZoneNode"]({ managedZones: [item.getAttribute('t-zone')] })];
    }
}
ZoneXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-font-size/src/FontSize.ts":
/*!***************************************************!*\
  !*** ./packages/plugin-font-size/src/FontSize.ts ***!
  \***************************************************/
/*! exports provided: FontSize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontSize", function() { return FontSize; });
/* harmony import */ var _plugin_input_src_InputNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../plugin-input/src/InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _FontSizeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FontSizeDomObjectRenderer */ "./packages/plugin-font-size/src/FontSizeDomObjectRenderer.ts");
/* harmony import */ var _plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-input/src/Input */ "./packages/plugin-input/src/Input.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");






class FontSize extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            renderers: [_FontSizeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["FontSizeDomObjectRenderer"]],
            components: [
                {
                    id: 'FontSizeInput',
                    async render() {
                        const input = new _plugin_input_src_InputNode__WEBPACK_IMPORTED_MODULE_0__["InputNode"]({
                            inputType: 'number',
                            inputName: 'font-size',
                            change: (editor) => {
                                editor.execCommand('setFontSize', { value: parseInt(input.value) });
                            },
                        });
                        return [input];
                    },
                },
            ],
        };
        this.commands = {
            setFontSize: {
                handler: this.setFontSize,
            },
        };
    }
    /**
     * Set the font size of the context range
     */
    setFontSize(params) {
        let nodes = [];
        if (!params.context.range.isCollapsed()) {
            nodes = params.context.range.targetedNodes(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_4__["CharNode"]);
        }
        for (const node of nodes) {
            node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.set('font-size', `${params.value}px`);
        }
    }
}
FontSize.dependencies = [_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_3__["Input"]];


/***/ }),

/***/ "./packages/plugin-font-size/src/FontSizeDomObjectRenderer.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-font-size/src/FontSizeDomObjectRenderer.ts ***!
  \********************************************************************/
/*! exports provided: FontSizeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontSizeDomObjectRenderer", function() { return FontSizeDomObjectRenderer; });
/* harmony import */ var _plugin_input_src_InputDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../plugin-input/src/InputDomObjectRenderer */ "./packages/plugin-input/src/InputDomObjectRenderer.ts");
/* harmony import */ var _plugin_input_src_InputNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./../../plugin-input/src/InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");






class FontSizeDomObjectRenderer extends _plugin_input_src_InputDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__["InputDomObjectRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => node instanceof _plugin_input_src_InputNode__WEBPACK_IMPORTED_MODULE_1__["InputNode"] && node.inputName === 'font-size';
    }
    /**
     * @override
     */
    _onCommit(node, input) {
        var _a, _b;
        super._onCommit(node, input);
        const editor = this.engine.editor;
        const range = editor.selection.range;
        let next = range.start.nextSibling(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_2__["CharNode"]);
        if (next) {
            // If the end is before the charNode, the charNode is not selected.
            const childVNodes = next.parent.childVNodes;
            let index = childVNodes.indexOf(next);
            let sibling;
            while (index && (sibling = childVNodes[index - 1]) && sibling !== range.start) {
                if (sibling !== range.end) {
                    next = null;
                }
                index--;
            }
        }
        let fontSize = (_b = (_a = next === null || next === void 0 ? void 0 : next.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style) === null || _b === void 0 ? void 0 : _b.get('font-size');
        input.style.display = 'block';
        if (fontSize) {
            fontSize = parseInt(fontSize, 10).toString();
        }
        else if (next) {
            const layout = this.engine.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__["Layout"]);
            const domLayout = layout.engines.dom;
            const firstDomNode = domLayout.getDomNodes(next)[0];
            let firstDomElement;
            if (firstDomNode) {
                firstDomElement =
                    firstDomNode instanceof HTMLElement ? firstDomNode : firstDomNode.parentElement;
                if (firstDomElement) {
                    fontSize = parseInt(getComputedStyle(firstDomElement)['font-size'], 10).toString();
                }
            }
        }
        else {
            input.style.display = 'none';
        }
        input.value = fontSize || '';
    }
}
FontSizeDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-fontawesome/src/FontAwesome.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-fontawesome/src/FontAwesome.ts ***!
  \********************************************************/
/*! exports provided: FontAwesome */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontAwesome", function() { return FontAwesome; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _FontAwesomeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FontAwesomeXmlDomParser */ "./packages/plugin-fontawesome/src/FontAwesomeXmlDomParser.ts");
/* harmony import */ var _FontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FontAwesomeDomObjectRenderer */ "./packages/plugin-fontawesome/src/FontAwesomeDomObjectRenderer.ts");



class FontAwesome extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_FontAwesomeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["FontAwesomeXmlDomParser"]],
            renderers: [_FontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["FontAwesomeDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-fontawesome/src/FontAwesomeDomObjectRenderer.ts":
/*!*************************************************************************!*\
  !*** ./packages/plugin-fontawesome/src/FontAwesomeDomObjectRenderer.ts ***!
  \*************************************************************************/
/*! exports provided: FontAwesomeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontAwesomeDomObjectRenderer", function() { return FontAwesomeDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _FontAwesomeNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FontAwesomeNode */ "./packages/plugin-fontawesome/src/FontAwesomeNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



const zeroWidthSpace = '\u200b';
class FontAwesomeDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _FontAwesomeNode__WEBPACK_IMPORTED_MODULE_1__["FontAwesomeNode"];
    }
    async render(node, worker) {
        const fontawesome = {
            tag: node.htmlTag,
            attributes: {
                class: new Set(node.faClasses),
            },
        };
        // Surround the fontawesome with two invisible characters so the
        // selection can navigate around it.
        const domObject = {
            children: [
                // We are targetting the invisible character BEFORE the
                // fontawesome node.
                // If offset 1:
                // Moving from before the fontawesome node to after it.
                // (DOM is `<invisible/>[]<fontawesome/><invisible/>` but
                // should be `<invisible/><fontawesome/><invisible/>[]`).
                // else:
                // Stay before the fontawesome node.
                { text: zeroWidthSpace },
                // If we are targetting the fontawesome directyle then stay
                // before the fontawesome node.
                fontawesome,
                // We are targetting the invisible character AFTER the
                // fontawesome node.
                // If offset 0:
                // Moving from after the fontawesome node to before it.
                // (DOM is `<invisible/><fontawesome/>[]<invisible/>` but
                // should be `[]<invisible/><fontawesome/><invisible/>`).
                // else:
                // Stay after the fontawesome node.
                { text: zeroWidthSpace },
            ],
        };
        worker.locate([node], domObject.children[0]);
        worker.locate([node], fontawesome);
        worker.locate([node], domObject.children[2]);
        return domObject;
    }
}
FontAwesomeDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-fontawesome/src/FontAwesomeNode.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-fontawesome/src/FontAwesomeNode.ts ***!
  \************************************************************/
/*! exports provided: FontAwesomeNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontAwesomeNode", function() { return FontAwesomeNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class FontAwesomeNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
    constructor(params) {
        super(params);
        this.htmlTag = params.htmlTag;
        this.faClasses = params.faClasses;
    }
}
FontAwesomeNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-fontawesome/src/FontAwesomeXmlDomParser.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-fontawesome/src/FontAwesomeXmlDomParser.ts ***!
  \********************************************************************/
/*! exports provided: FontAwesomeRegex, FontAwesomeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontAwesomeRegex", function() { return FontAwesomeRegex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FontAwesomeXmlDomParser", function() { return FontAwesomeXmlDomParser; });
/* harmony import */ var _FontAwesomeNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FontAwesomeNode */ "./packages/plugin-fontawesome/src/FontAwesomeNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");





const FontAwesomeRegex = /(?:^|\s|\n)(fa[bdlrs]?)(?:.|\n)*?(fa-.*?)(?:\s|\n|$)/;
class FontAwesomeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return FontAwesomeXmlDomParser.isFontAwesome(item);
        };
    }
    async parse(item) {
        const attributes = this.engine.parseAttributes(item);
        // Remove fa classes to avoid having them spread to nearby nodes.
        // They will be put back at renderng time.
        const faClasses = item.className.match(FontAwesomeRegex).slice(1);
        const fontawesome = new _FontAwesomeNode__WEBPACK_IMPORTED_MODULE_0__["FontAwesomeNode"]({
            htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item),
            faClasses: new _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_4__["VersionableArray"](...faClasses),
        });
        attributes.classList.remove(...faClasses);
        // Keep the attributes even though it might be empty as it will be used
        // to restore the proper order of classes.
        fontawesome.modifiers.append(attributes);
        return [fontawesome];
    }
    /**
     * Return true if the given DOM node is a fontawesome.
     *
     * @param item
     */
    static isFontAwesome(item) {
        return item instanceof Element && FontAwesomeRegex.test(item.className);
    }
}
FontAwesomeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-fullscreen/assets/Fullscreen.css":
/*!**********************************************************!*\
  !*** ./packages/plugin-fullscreen/assets/Fullscreen.css ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./Fullscreen.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-fullscreen/assets/Fullscreen.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-fullscreen/src/Fullscreen.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-fullscreen/src/Fullscreen.ts ***!
  \******************************************************/
/*! exports provided: Fullscreen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Fullscreen", function() { return Fullscreen; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _FullscreenButtonDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FullscreenButtonDomObjectRenderer */ "./packages/plugin-fullscreen/src/FullscreenButtonDomObjectRenderer.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class Fullscreen extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            renderers: [_FullscreenButtonDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__["FullscreenButtonDomObjectRenderer"]],
            components: [
                {
                    id: 'FullscreenButton',
                    render: async () => {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_2__["ActionableNode"]({
                            name: 'fullscreen',
                            label: 'Toggle Fullscreen',
                            selected: () => this.isFullscreen,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]({ class: 'fas fa-expand fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['FullscreenButton', ['actionables']]],
        };
        this.isFullscreen = false;
    }
}


/***/ }),

/***/ "./packages/plugin-fullscreen/src/FullscreenButtonDomObjectRenderer.ts":
/*!*****************************************************************************!*\
  !*** ./packages/plugin-fullscreen/src/FullscreenButtonDomObjectRenderer.ts ***!
  \*****************************************************************************/
/*! exports provided: FullscreenButtonDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FullscreenButtonDomObjectRenderer", function() { return FullscreenButtonDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _assets_Fullscreen_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../assets/Fullscreen.css */ "./packages/plugin-fullscreen/assets/Fullscreen.css");
/* harmony import */ var _assets_Fullscreen_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_assets_Fullscreen_css__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _Fullscreen__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Fullscreen */ "./packages/plugin-fullscreen/src/Fullscreen.ts");






class FullscreenButtonDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => node instanceof _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_3__["ActionableNode"] && node.actionName === 'fullscreen';
    }
    /**
     * Render the FullscreenNode.
     */
    async render(button, worker) {
        const domObject = (await this.super.render(button, worker));
        const fullscreenPlugin = this.engine.editor.plugins.get(_Fullscreen__WEBPACK_IMPORTED_MODULE_5__["Fullscreen"]);
        const domLayoutEngine = this.engine.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines
            .dom;
        let elButton;
        domObject.handler = () => {
            var _a;
            // only one component can be display in fullscreen
            const component = (_a = domLayoutEngine.components[fullscreenPlugin.configuration.component]) === null || _a === void 0 ? void 0 : _a[0];
            if (component) {
                // only one element can be display in fullscreen
                const element = domLayoutEngine.getDomNodes(component)[0];
                if (element instanceof Element) {
                    if (fullscreenPlugin.isFullscreen) {
                        element.classList.remove('jw-fullscreen');
                        elButton.classList.remove('pressed');
                        elButton.setAttribute('aria-pressed', 'false');
                    }
                    else {
                        fullscreenPlugin.isFullscreen = true;
                        document.body.classList.add('jw-fullscreen');
                        element.classList.add('jw-fullscreen');
                        elButton.classList.add('pressed');
                        elButton.setAttribute('aria-pressed', 'true');
                        window.dispatchEvent(new CustomEvent('resize'));
                        return;
                    }
                }
            }
            if (fullscreenPlugin.isFullscreen) {
                fullscreenPlugin.isFullscreen = false;
                document.body.classList.remove('jw-fullscreen');
                window.dispatchEvent(new CustomEvent('resize'));
            }
        };
        const attach = domObject.attach;
        // TODO: Replace these handlers by a `stop` mechanism for renderers.
        domObject.attach = function (el) {
            elButton = el;
            attach.call(this, el);
            if (fullscreenPlugin.isFullscreen) {
                document.body.classList.add('jw-fullscreen');
            }
        };
        const detach = domObject.detach;
        // TODO: Replace these handlers by a `stop` mechanism for renderers.
        domObject.detach = function (el) {
            elButton = null;
            detach.call(this, el);
            document.body.classList.remove('jw-fullscreen');
        };
        return domObject;
    }
}
FullscreenButtonDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-heading/src/Heading.ts":
/*!************************************************!*\
  !*** ./packages/plugin-heading/src/Heading.ts ***!
  \************************************************/
/*! exports provided: Heading */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading", function() { return Heading; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _HeadingXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HeadingXmlDomParser */ "./packages/plugin-heading/src/HeadingXmlDomParser.ts");
/* harmony import */ var _HeadingNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeadingNode */ "./packages/plugin-heading/src/HeadingNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Mode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/Mode */ "./packages/core/src/Mode.ts");







function headingButton(level) {
    return {
        id: 'Heading' + level + 'Button',
        async render() {
            const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__["ActionableNode"]({
                name: 'heading' + level,
                label: 'Heading' + level,
                commandId: 'applyHeadingStyle',
                commandArgs: { level: level },
                selected: (editor) => {
                    var _a, _b;
                    const range = editor.selection.range;
                    const startIsHeading = ((_a = range.start.closest(_HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"])) === null || _a === void 0 ? void 0 : _a.level) === level;
                    if (!startIsHeading || range.isCollapsed()) {
                        return startIsHeading;
                    }
                    else {
                        return ((_b = range.end.closest(_HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"])) === null || _b === void 0 ? void 0 : _b.level) === level;
                    }
                },
                modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]({ class: 'h' + level })],
            });
            return [button];
        },
    };
}
class Heading extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            applyHeadingStyle: {
                handler: this.applyHeadingStyle,
            },
            insertParagraphBreak: {
                selector: [
                    (node) => node instanceof _HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"] &&
                        this.editor.mode.is(node, _core_src_Mode__WEBPACK_IMPORTED_MODULE_6__["RuleProperty"].BREAKABLE),
                ],
                check: (context) => {
                    const range = context.range;
                    return range.isCollapsed() && !range.start.nextSibling();
                },
                handler: this.insertParagraphBreak,
            },
        };
        this.loadables = {
            parsers: [_HeadingXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["HeadingXmlDomParser"]],
            shortcuts: [0, 1, 2, 3, 4, 5, 6].map(level => {
                return {
                    pattern: 'CTRL+SHIFT+<Digit' + level + '>',
                    commandId: 'applyHeadingStyle',
                    commandArgs: { level: level },
                };
            }),
            components: [
                {
                    id: 'ParagraphButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__["ActionableNode"]({
                            name: 'paragraph',
                            label: 'Paragraph',
                            commandId: 'applyHeadingStyle',
                            commandArgs: { level: 0 },
                            selected: (editor) => {
                                const range = editor.selection.range;
                                if (range.start.parent) {
                                    const startIsDefault = !!range.start.closest(ancestor => ancestor instanceof editor.configuration.defaults.Container);
                                    if (!startIsDefault || range.isCollapsed()) {
                                        return startIsDefault;
                                    }
                                    else {
                                        return !!range.end.closest(ancestor => ancestor instanceof
                                            editor.configuration.defaults.Container);
                                    }
                                }
                                else {
                                    return true;
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]({ class: 'p' })],
                        });
                        return [button];
                    },
                },
                ...[1, 2, 3, 4, 5, 6].map(headingButton),
            ],
            componentZones: [
                ['ParagraphButton', ['actionables']],
                ['Heading1Button', ['actionables']],
                ['Heading2Button', ['actionables']],
                ['Heading3Button', ['actionables']],
                ['Heading4Button', ['actionables']],
                ['Heading5Button', ['actionables']],
                ['Heading6Button', ['actionables']],
            ],
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Change the formatting of the nodes in given range to Heading.
     *
     * @param params
     */
    applyHeadingStyle(params) {
        for (const node of params.context.range.targetedNodes(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"])) {
            const heading = this._createHeadingContainer(params.level);
            heading.modifiers = node.modifiers.clone();
            node.replaceWith(heading);
        }
    }
    /**
     * Inserting a paragraph break at the end of a heading exits the heading.
     *
     * @param params
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        const heading = range.targetedNodes(_HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"])[0];
        const duplicate = heading.splitAt(range.start);
        const newContainer = new this.editor.configuration.defaults.Container();
        duplicate.replaceWith(newContainer);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a heading node or a base container based on the given level.
     *
     * @param level
     */
    _createHeadingContainer(level) {
        if (level === 0) {
            return new this.editor.configuration.defaults.Container();
        }
        else {
            return new _HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"]({ level: level });
        }
    }
}


/***/ }),

/***/ "./packages/plugin-heading/src/HeadingNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-heading/src/HeadingNode.ts ***!
  \****************************************************/
/*! exports provided: HeadingNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeadingNode", function() { return HeadingNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class HeadingNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super({ htmlTag: 'H' + params.level });
        this.level = params.level;
    }
    get name() {
        return super.name + ': ' + this.level;
    }
    clone(deepClone, params) {
        const defaults = {
            level: this.level,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
}


/***/ }),

/***/ "./packages/plugin-heading/src/HeadingXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-heading/src/HeadingXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: HeadingXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeadingXmlDomParser", function() { return HeadingXmlDomParser; });
/* harmony import */ var _HeadingNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HeadingNode */ "./packages/plugin-heading/src/HeadingNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




const HeadingTags = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6'];
class HeadingXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && HeadingTags.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    async parse(item) {
        const heading = new _HeadingNode__WEBPACK_IMPORTED_MODULE_0__["HeadingNode"]({ level: parseInt(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item)[1], 10) });
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            heading.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        heading.append(...nodes);
        return [heading];
    }
}
HeadingXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-history/src/History.ts":
/*!************************************************!*\
  !*** ./packages/plugin-history/src/History.ts ***!
  \************************************************/
/*! exports provided: History */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "History", function() { return History; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class History extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor) {
        super(editor);
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'CTRL+Z',
                    commandId: 'undo',
                },
                {
                    pattern: 'CTRL+SHIFT+Z',
                    commandId: 'redo',
                },
                {
                    pattern: 'CTRL+Y',
                    commandId: 'redo',
                },
            ],
            components: [
                {
                    id: 'UndoButton',
                    render: async () => {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'undo',
                            label: 'History undo',
                            commandId: 'undo',
                            enabled: () => this._memoryStep > 0,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]({ class: 'fa fa-undo fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'RedoButton',
                    render: async () => {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'redo',
                            label: 'History redo',
                            commandId: 'redo',
                            enabled: () => this._memoryKeys.length - 1 > this._memoryStep,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]({ class: 'fa fa-redo fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [
                ['UndoButton', ['actionables']],
                ['RedoButton', ['actionables']],
            ],
        };
        this.commands = {
            undo: {
                handler: this.undo,
            },
            redo: {
                handler: this.redo,
            },
        };
        this.commandHooks = {
            '@commit': this._registerMemoryKey,
        };
        this._memoryKeys = [];
        this._memoryCommands = [];
        this._memoryStep = -1;
        this.loadables.components.push();
    }
    undo() {
        this._memoryStep--;
        if (this._memoryStep < 0) {
            this._memoryStep = 0;
        }
        this.editor.memory.switchTo(this._memoryKeys[this._memoryStep]);
    }
    redo() {
        this._memoryStep++;
        const max = this._memoryKeys.length - 1;
        if (this._memoryStep > max) {
            this._memoryStep = max;
        }
        this.editor.memory.switchTo(this._memoryKeys[this._memoryStep]);
    }
    _registerMemoryKey(commitParams) {
        const sliceKey = this.editor.memory.sliceKey;
        if (!this._memoryKeys.includes(sliceKey)) {
            const commands = commitParams.commandNames;
            if (commands.length === 1 && commands[0] === 'setSelection') {
                if (this._memoryStep > this._memoryKeys.length - 1) {
                    // After an undo, don't replace history for setSelection.
                    return;
                }
                const prevCommand = this._memoryCommands[this._memoryStep];
                if (prevCommand && prevCommand.length === 1 && prevCommand[0] === 'setSelection') {
                    // Concat setSelection.
                    this._memoryKeys[this._memoryStep] = sliceKey;
                    return;
                }
            }
            else if (this.editor.memoryInfo.uiCommand) {
                return;
            }
            this._memoryStep++;
            this._memoryKeys.splice(this._memoryStep, Infinity, sliceKey);
            this._memoryCommands.splice(this._memoryStep, Infinity, [...commands]);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-html/src/DefaultHtmlDomModifierRenderer.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-html/src/DefaultHtmlDomModifierRenderer.ts ***!
  \********************************************************************/
/*! exports provided: DefaultHtmlDomModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultHtmlDomModifierRenderer", function() { return DefaultHtmlDomModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");

class DefaultHtmlDomModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    /**
     * Default rendering for Format.
     *
     * @param modifier
     * @param contents
     */
    async render(modifier, contents) {
        return contents;
    }
}
DefaultHtmlDomModifierRenderer.id = 'dom/html';


/***/ }),

/***/ "./packages/plugin-html/src/DefaultHtmlDomRenderer.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-html/src/DefaultHtmlDomRenderer.ts ***!
  \************************************************************/
/*! exports provided: DefaultHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultHtmlDomRenderer", function() { return DefaultHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");



class DefaultHtmlDomRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    async render(node) {
        const renderer = this.engine.editor.plugins.get(_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_1__["Renderer"]);
        const objectEngine = renderer.engines['dom/object'];
        const cache = await objectEngine.render([node]);
        const domNodes = [];
        for (const [, domObject] of cache.renderings) {
            await objectEngine.resolveChildren(domObject, cache.worker);
            const domNode = this._objectToDom(domObject);
            if (domNode instanceof DocumentFragment) {
                domNodes.push(...domNode.childNodes);
            }
            else {
                domNodes.push(domNode);
            }
        }
        return domNodes;
    }
    _objectToDom(domObject) {
        let domNode;
        if ('tag' in domObject) {
            const element = document.createElement(domObject.tag);
            const attributes = domObject.attributes;
            if (attributes) {
                for (const name in attributes) {
                    if (name === 'style') {
                        element.setAttribute('style', Object.keys(attributes.style)
                            .map(styleName => `${styleName}: ${attributes.style[styleName]};`)
                            .join(''));
                    }
                    else if (name === 'class') {
                        const classList = attributes[name];
                        for (const className of classList) {
                            element.classList.add(className);
                        }
                    }
                    else {
                        const value = attributes[name];
                        if (typeof value === 'string') {
                            element.setAttribute(name, value);
                        }
                    }
                }
            }
            if (domObject.children) {
                for (const child of domObject.children) {
                    if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                        element.appendChild(this._objectToDom(child));
                    }
                }
            }
            // Implement attach & detach: domObject into html.
            element.addEventListener('detach', () => {
                [...element.children].forEach(childElement => {
                    childElement.dispatchEvent(new CustomEvent('detach'));
                });
                if (domObject.detach) {
                    domObject.detach(element);
                }
            });
            if (domObject.attach) {
                domObject.attach(element);
            }
            domNode = element;
        }
        else if ('text' in domObject) {
            domNode = document.createTextNode(domObject.text);
        }
        else if ('children' in domObject) {
            domNode = document.createDocumentFragment();
            for (const child of domObject.children) {
                if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"])) {
                    domNode.appendChild(this._objectToDom(child));
                }
            }
        }
        else {
            domNode = document.createDocumentFragment();
            for (const domNode of domObject.dom) {
                domNode.appendChild(domNode);
            }
        }
        return domNode;
    }
}
DefaultHtmlDomRenderer.id = 'dom/html';


/***/ }),

/***/ "./packages/plugin-html/src/DefaultHtmlTextParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-html/src/DefaultHtmlTextParser.ts ***!
  \***********************************************************/
/*! exports provided: DefaultHtmlTextParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultHtmlTextParser", function() { return DefaultHtmlTextParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");


const autoCloseRegExp = /(<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)[^>]*[^/])>/gi;
class DefaultHtmlTextParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    async parse(item) {
        const domParser = new DOMParser();
        const template = item.replace(autoCloseRegExp, '$1/>');
        const xmlDoc = domParser.parseFromString('<t>' + template + '</t>', 'text/xml');
        const parser = this.engine.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]);
        return parser.parse('dom/xml', ...xmlDoc.firstChild.childNodes);
    }
}
DefaultHtmlTextParser.id = 'text/html';


/***/ }),

/***/ "./packages/plugin-html/src/Html.ts":
/*!******************************************!*\
  !*** ./packages/plugin-html/src/Html.ts ***!
  \******************************************/
/*! exports provided: Html */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Html", function() { return Html; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _HtmlTextParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HtmlTextParsingEngine */ "./packages/plugin-html/src/HtmlTextParsingEngine.ts");
/* harmony import */ var _HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HtmlDomParsingEngine */ "./packages/plugin-html/src/HtmlDomParsingEngine.ts");
/* harmony import */ var _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Xml */ "./packages/plugin-xml/src/Xml.ts");
/* harmony import */ var _HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _HtmlNodeDomRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./HtmlNodeDomRenderer */ "./packages/plugin-html/src/HtmlNodeDomRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderer */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts");








class Html extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsingEngines: [_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlDomParsingEngine"], _HtmlTextParsingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlTextParsingEngine"]],
            renderingEngines: [_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_5__["HtmlDomRenderingEngine"]],
            renderers: [_HtmlNodeDomRenderer__WEBPACK_IMPORTED_MODULE_6__["HtmlHtmlDomRenderer"]],
        };
    }
}
Html.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_dom_object_src_DomObjectRenderer__WEBPACK_IMPORTED_MODULE_7__["DomObjectRenderer"], _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_4__["Xml"]];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlDomParsingEngine.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlDomParsingEngine.ts ***!
  \**********************************************************/
/*! exports provided: HtmlDomParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlDomParsingEngine", function() { return HtmlDomParsingEngine; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");

class HtmlDomParsingEngine extends _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"] {
}
HtmlDomParsingEngine.id = 'dom/html';
HtmlDomParsingEngine.extends = ['dom/xml'];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-html/src/HtmlDomRenderingEngine.ts ***!
  \************************************************************/
/*! exports provided: HtmlDomRenderingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlDomRenderingEngine", function() { return HtmlDomRenderingEngine; });
/* harmony import */ var _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/RenderingEngine */ "./packages/plugin-renderer/src/RenderingEngine.ts");
/* harmony import */ var _DefaultHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultHtmlDomRenderer */ "./packages/plugin-html/src/DefaultHtmlDomRenderer.ts");
/* harmony import */ var _DefaultHtmlDomModifierRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DefaultHtmlDomModifierRenderer */ "./packages/plugin-html/src/DefaultHtmlDomModifierRenderer.ts");



class HtmlDomRenderingEngine extends _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__["RenderingEngine"] {
}
HtmlDomRenderingEngine.id = 'dom/html';
HtmlDomRenderingEngine.defaultRenderer = _DefaultHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_1__["DefaultHtmlDomRenderer"];
HtmlDomRenderingEngine.defaultModifierRenderer = _DefaultHtmlDomModifierRenderer__WEBPACK_IMPORTED_MODULE_2__["DefaultHtmlDomModifierRenderer"];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-html/src/HtmlNode.ts ***!
  \**********************************************/
/*! exports provided: HtmlNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlNode", function() { return HtmlNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class HtmlNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super();
        this.domNode = params.domNode;
    }
}


/***/ }),

/***/ "./packages/plugin-html/src/HtmlNodeDomRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlNodeDomRenderer.ts ***!
  \*********************************************************/
/*! exports provided: HtmlHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlHtmlDomRenderer", function() { return HtmlHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _HtmlNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HtmlNode */ "./packages/plugin-html/src/HtmlNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class HtmlHtmlDomRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _HtmlNode__WEBPACK_IMPORTED_MODULE_1__["HtmlNode"];
    }
    async render(node) {
        const domObject = { dom: [node.domNode()] };
        return domObject;
    }
}
HtmlHtmlDomRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-html/src/HtmlTextParsingEngine.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlTextParsingEngine.ts ***!
  \***********************************************************/
/*! exports provided: HtmlTextParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlTextParsingEngine", function() { return HtmlTextParsingEngine; });
/* harmony import */ var _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/ParsingEngine */ "./packages/plugin-parser/src/ParsingEngine.ts");
/* harmony import */ var _DefaultHtmlTextParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultHtmlTextParser */ "./packages/plugin-html/src/DefaultHtmlTextParser.ts");


class HtmlTextParsingEngine extends _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__["ParsingEngine"] {
}
HtmlTextParsingEngine.id = 'text/html';
HtmlTextParsingEngine.defaultParser = _DefaultHtmlTextParser__WEBPACK_IMPORTED_MODULE_1__["DefaultHtmlTextParser"];


/***/ }),

/***/ "./packages/plugin-iframe/src/Iframe.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-iframe/src/Iframe.ts ***!
  \**********************************************/
/*! exports provided: Iframe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Iframe", function() { return Iframe; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _IframeHtmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./IframeHtmlDomParser */ "./packages/plugin-iframe/src/IframeHtmlDomParser.ts");
/* harmony import */ var _IframeXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./IframeXmlDomParser */ "./packages/plugin-iframe/src/IframeXmlDomParser.ts");
/* harmony import */ var _IframeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./IframeDomObjectRenderer */ "./packages/plugin-iframe/src/IframeDomObjectRenderer.ts");






class Iframe extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_IframeXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["IframeXmlDomParser"], _IframeHtmlDomParser__WEBPACK_IMPORTED_MODULE_3__["IframeHtmlDomParser"]],
            renderers: [_IframeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["IframeDomObjectRenderer"]],
        };
    }
}
Iframe.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"]];


/***/ }),

/***/ "./packages/plugin-iframe/src/IframeDomObjectRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-iframe/src/IframeDomObjectRenderer.ts ***!
  \***************************************************************/
/*! exports provided: IframeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IframeDomObjectRenderer", function() { return IframeDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _IframeNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IframeNode */ "./packages/plugin-iframe/src/IframeNode.ts");
/* harmony import */ var _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-metadata/src/MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





class IframeDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _IframeNode__WEBPACK_IMPORTED_MODULE_2__["IframeNode"];
    }
    async render(iframeNode) {
        let onload;
        const children = [];
        iframeNode.childVNodes.forEach(child => {
            if (child.tangible || child instanceof _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_3__["MetadataNode"]) {
                children.push(child);
            }
        });
        let wrap;
        const domObject = {
            children: [
                {
                    tag: 'JW-IFRAME',
                    shadowRoot: true,
                    children: children,
                },
                {
                    tag: 'IFRAME',
                    attributes: {
                        // Can not use the default href loading in testing mode because the port is
                        // used for the log, and the iframe are never loaded.
                        // Use the window.location.href to keep style, link and meta to load some
                        // data like the font-face. The style are not really used into the shadow
                        // container but we need the real url to load font-face with relative path.
                        src: iframeNode.src || window.location.href,
                        name: 'jw-device',
                    },
                    attach: (iframe) => {
                        const prev = iframe.previousElementSibling;
                        if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(prev) === 'JW-IFRAME') {
                            if (wrap) {
                                wrap.replaceWith(prev);
                            }
                            else {
                                prev.style.display = 'none';
                            }
                            wrap = prev;
                        }
                        if (iframeNode.src) {
                            onload = () => {
                                // Bubbles up the load-iframe event.
                                const customEvent = new CustomEvent('load-iframe', {
                                    bubbles: true,
                                    composed: true,
                                    cancelable: true,
                                });
                                iframe.dispatchEvent(customEvent);
                            };
                            iframe.addEventListener('load', onload);
                        }
                        else {
                            (function loadWithPreloadedMeta() {
                                var _a;
                                // Remove all scripts, keep style, link and meta to load some
                                // data like the font-face. The style are not used into the
                                // shadow container.
                                if (iframe.previousElementSibling !== wrap) {
                                    return;
                                }
                                else {
                                    const doc = (_a = iframe.contentWindow) === null || _a === void 0 ? void 0 : _a.document;
                                    if (doc && (doc.head || doc.body)) {
                                        for (const meta of wrap.shadowRoot.querySelectorAll('style, link, meta')) {
                                            doc.write(meta.outerHTML);
                                        }
                                        doc.write('<body></body>');
                                        doc.write("<script type='application/x-suppress'>");
                                        iframe.contentWindow.close();
                                        setTimeout(() => {
                                            const doc = iframe.contentWindow.document;
                                            // Remove all attribute from the shadow container.
                                            for (const attr of [...wrap.attributes]) {
                                                wrap.removeAttribute(attr.name);
                                            }
                                            doc.body.style.margin = '0px';
                                            doc.body.innerHTML = '';
                                            doc.body.append(wrap);
                                            // Bubbles up the load-iframe event.
                                            const customEvent = new CustomEvent('load-iframe', {
                                                bubbles: true,
                                                composed: true,
                                                cancelable: true,
                                            });
                                            iframe.dispatchEvent(customEvent);
                                        });
                                    }
                                    else {
                                        setTimeout(loadWithPreloadedMeta);
                                    }
                                }
                            })();
                        }
                    },
                    detach: (iframe) => {
                        var _a;
                        if (!iframe.src) {
                            const body = (_a = iframe.contentWindow) === null || _a === void 0 ? void 0 : _a.document.body;
                            if (body) {
                                iframe.append(...body.childNodes);
                            }
                        }
                        iframe.removeEventListener('load', onload);
                    },
                },
            ],
        };
        return domObject;
    }
}
IframeDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-iframe/src/IframeHtmlDomParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-iframe/src/IframeHtmlDomParser.ts ***!
  \***********************************************************/
/*! exports provided: IframeHtmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IframeHtmlDomParser", function() { return IframeHtmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_html_src_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomParsingEngine */ "./packages/plugin-html/src/HtmlDomParsingEngine.ts");
/* harmony import */ var _IframeNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IframeNode */ "./packages/plugin-iframe/src/IframeNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_shadow_src_ShadowNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-shadow/src/ShadowNode */ "./packages/plugin-shadow/src/ShadowNode.ts");





class IframeHtmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof HTMLElement && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'IFRAME';
        };
    }
    /**
     * Parse a shadow node and extract styling from shadow root.
     *
     * @param item
     */
    async parse(item) {
        var _a, _b;
        const iframe = new _IframeNode__WEBPACK_IMPORTED_MODULE_2__["IframeNode"]();
        const childNodes = item.src
            ? []
            : Array.from(((_b = (_a = item.contentWindow) === null || _a === void 0 ? void 0 : _a.document.body) === null || _b === void 0 ? void 0 : _b.childNodes) || []);
        let nodes = await this.engine.parse(...childNodes);
        nodes = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["flat"])(nodes.map(node => (node instanceof _plugin_shadow_src_ShadowNode__WEBPACK_IMPORTED_MODULE_4__["ShadowNode"] ? node.childVNodes : [node])));
        iframe.append(...nodes);
        return [iframe];
    }
}
IframeHtmlDomParser.id = _plugin_html_src_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-iframe/src/IframeNode.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-iframe/src/IframeNode.ts ***!
  \**************************************************/
/*! exports provided: IframeNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IframeNode", function() { return IframeNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class IframeNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super();
        this.editable = false;
        this.breakable = false;
        if (params === null || params === void 0 ? void 0 : params.src) {
            this.src = params.src;
        }
    }
}


/***/ }),

/***/ "./packages/plugin-iframe/src/IframeXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-iframe/src/IframeXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: IframeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IframeXmlDomParser", function() { return IframeXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _IframeNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IframeNode */ "./packages/plugin-iframe/src/IframeNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class IframeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-IFRAME';
        };
    }
    /**
     * Parse a shadow node and extract styling.
     *
     * @param item
     */
    async parse(item) {
        const attributes = this.engine.parseAttributes(item);
        const shadow = new _IframeNode__WEBPACK_IMPORTED_MODULE_2__["IframeNode"]({ src: attributes.get('src') });
        attributes.remove('src');
        if (attributes.length) {
            shadow.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        shadow.append(...nodes);
        return [shadow];
    }
}
IframeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-image/src/Image.ts":
/*!********************************************!*\
  !*** ./packages/plugin-image/src/Image.ts ***!
  \********************************************/
/*! exports provided: Image */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Image", function() { return Image; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ImageXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ImageXmlDomParser */ "./packages/plugin-image/src/ImageXmlDomParser.ts");
/* harmony import */ var _ImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ImageDomObjectRenderer */ "./packages/plugin-image/src/ImageDomObjectRenderer.ts");



class Image extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ImageXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ImageXmlDomParser"]],
            renderers: [_ImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["ImageDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-image/src/ImageDomObjectRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-image/src/ImageDomObjectRenderer.ts ***!
  \*************************************************************/
/*! exports provided: ImageDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageDomObjectRenderer", function() { return ImageDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _ImageNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class ImageDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ImageNode__WEBPACK_IMPORTED_MODULE_1__["ImageNode"];
    }
    async render(node, worker) {
        const select = () => {
            this.engine.editor.execCommand(() => {
                this.engine.editor.selection.select(node, node);
            });
        };
        const image = {
            tag: 'IMG',
            attach: (el) => {
                el.addEventListener('click', select);
            },
            detach: (el) => {
                el.removeEventListener('click', select);
            },
        };
        const isSelected = this.engine.editor.selection.range.selectedNodes(selectedNode => selectedNode === node).length;
        if (isSelected) {
            image.attributes = { class: new Set(['jw_selected_image']) };
        }
        worker.locate([node], image);
        return image;
    }
}
ImageDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-image/src/ImageNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-image/src/ImageNode.ts ***!
  \************************************************/
/*! exports provided: ImageNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageNode", function() { return ImageNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class ImageNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
}
ImageNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-image/src/ImageXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-image/src/ImageXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: ImageXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageXmlDomParser", function() { return ImageXmlDomParser; });
/* harmony import */ var _ImageNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ImageXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'IMG';
        };
    }
    async parse(item) {
        const image = new _ImageNode__WEBPACK_IMPORTED_MODULE_0__["ImageNode"]();
        image.modifiers.append(this.engine.parseAttributes(item));
        return [image];
    }
}
ImageXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-indent/src/Indent.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-indent/src/Indent.ts ***!
  \**********************************************/
/*! exports provided: Indent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Indent", function() { return Indent; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");











class Indent extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            indent: {
                title: 'Indent chars',
                handler: this.indent,
            },
            outdent: {
                title: 'Outdent chars',
                handler: this.outdent,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'TAB',
                    commandId: 'indent',
                },
                {
                    pattern: 'SHIFT+TAB',
                    commandId: 'outdent',
                },
            ],
            components: [
                {
                    id: 'IndentButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__["ActionableNode"]({
                            name: 'indent',
                            label: 'Indent',
                            commandId: 'indent',
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]({ class: 'fa fa-indent fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'OutdentButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__["ActionableNode"]({
                            name: 'outdent',
                            label: 'Outdent',
                            commandId: 'outdent',
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]({ class: 'fa fa-outdent fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [
                ['IndentButton', ['actionables']],
                ['OutdentButton', ['actionables']],
            ],
        };
        this.tab = '\u2003'; // `&emsp;` ("em space")
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Indent text or lines.
     *
     * - If there is more than one line selected in range, indent each lines.
     * - Otherwise, insert 4 spaces.
     */
    async indent(params) {
        const range = params.context.range;
        const segmentBreaks = range.traversedNodes(this._isSegmentBreak);
        // Only indent when there is at leat two lines selected, that is when
        // at least one segment break could be identified in the selection.
        if (range.isCollapsed() || !segmentBreaks.length) {
            await params.context.execCommand('insertText', {
                text: this.tab,
                context: Object.assign(Object.assign({}, params.context), { range }),
            });
        }
        else {
            // The first line of the selection is neither fully selected nor
            // traversed so its segment break was not in `range.traversedNodes`.
            const nextSegmentBreak = range.start.previous(this._isSegmentBreak);
            if (nextSegmentBreak) {
                segmentBreaks.unshift(nextSegmentBreak);
            }
            for (const segmentBreak of segmentBreaks) {
                // Insert 4 spaces at the start of next segment.
                const [node, position] = this._nextSegmentStart(segmentBreak);
                await this.editor.execWithRange(_core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].at(node, position), 'insertText', {
                    text: this.tab,
                });
            }
        }
    }
    /**
     * Outdent lines.
     *
     * If there is more than one line selected, for each of the lines, remove up
     * to 4 spaces in the beggining of the line.
     */
    outdent(params) {
        const range = params.context.range;
        const segmentBreaks = range.traversedNodes(this._isSegmentBreak);
        // The first line of the selection is neither fully selected nor
        // traversed so its segment break was not in `range.traversedNodes`.
        const previousSegmentBreak = range.start.previous(this._isSegmentBreak);
        if (previousSegmentBreak) {
            segmentBreaks.unshift(previousSegmentBreak);
        }
        // Only outdent when there is at leat two lines selected, that is when
        // at least one segment break could be identified in the selection.
        if (segmentBreaks.length) {
            segmentBreaks.forEach(segmentBreak => {
                for (let i = 0; i < this.tab.length; i++) {
                    const space = this._nextIndentationSpace(segmentBreak);
                    if (space) {
                        space.remove();
                    }
                }
            });
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given VNode can be considered to be a segment break.
     *
     * @param params
     */
    _isSegmentBreak(node) {
        return node instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__["ContainerNode"] || node instanceof _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_5__["LineBreakNode"];
    }
    /**
     * Return the next segment start point after the given segment break.
     *
     * @param segmentBreak
     */
    _nextSegmentStart(segmentBreak) {
        let reference = segmentBreak;
        let position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
        if (segmentBreak instanceof _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__["AtomicNode"]) {
            reference = segmentBreak.nextSibling();
        }
        else if (segmentBreak.hasChildren()) {
            reference = segmentBreak.firstChild();
        }
        else {
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE;
        }
        return [reference, position];
    }
    /**
     * Return true if the given VNode is a CharNode containing a space.
     *
     * @param node
     */
    _isSpace(node) {
        return node instanceof _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_3__["CharNode"] && /^\s$/g.test(node.char);
    }
    /**
     * Return true if the given VNode can be considered to be a segment break.
     *
     * @param segmentBreak
     */
    _nextIndentationSpace(segmentBreak) {
        let space;
        if (segmentBreak instanceof _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__["AtomicNode"]) {
            space = segmentBreak.nextSibling();
        }
        else {
            space = segmentBreak.firstChild();
        }
        return space && space.test(this._isSpace) && space;
    }
}
Indent.dependencies = [_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_2__["Char"], _plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__["LineBreak"]];


/***/ }),

/***/ "./packages/plugin-inline/src/FormatXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-inline/src/FormatXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: FormatXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormatXmlDomParser", function() { return FormatXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _InlineNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");



class FormatXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    /**
     * Parse a span node.
     *
     * @param nodes
     */
    applyFormat(format, nodes) {
        for (const node of nodes) {
            if (node instanceof _InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"]) {
                format.clone().applyTo(node);
            }
            else {
                const inlineNodes = node.descendants(_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"]);
                for (const inline of inlineNodes) {
                    format.clone().applyTo(inline);
                }
            }
        }
    }
}
FormatXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-inline/src/Inline.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-inline/src/Inline.ts ***!
  \**********************************************/
/*! exports provided: Inline */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Inline", function() { return Inline; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _InlineNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");







class Inline extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            toggleFormat: {
                handler: this.toggleFormat,
            },
            removeFormat: {
                handler: this.removeFormat,
            },
        };
        this.commandHooks = {
            setSelection: this.resetCache,
        };
        this.loadables = {
            components: [
                {
                    id: 'RemoveFormatButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_5__["ActionableNode"]({
                            name: 'removeFormat',
                            label: 'Remove format',
                            commandId: 'removeFormat',
                            commandArgs: {},
                            selected: () => false,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]({ class: 'fa fa-eraser fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['RemoveFormatButton', ['actionables']]],
        };
        /**
         * When applying a modifier on a collapsed range, cache the calculation of
         * the modifier in the following property. This value is reset each time the
         * range changes in a document.
         */
        this.cache = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_6__["makeVersionable"])({
            modifiers: undefined,
            style: undefined,
        });
    }
    start() {
        this.editor.memory.attach(this.cache);
        this.getCurrentModifiers();
        this.getCurrentStyle();
        return super.start();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Apply the `format` to the range.
     *
     * @param params
     */
    toggleFormat(params) {
        var _a;
        const range = params.context.range;
        const FormatClass = params.FormatClass;
        if (range.isCollapsed()) {
            if (!this.cache.modifiers) {
                this.cache.modifiers = this.getCurrentModifiers(range);
            }
            const format = (_a = this.cache.modifiers) === null || _a === void 0 ? void 0 : _a.find(FormatClass);
            if (format) {
                this.cache.modifiers.remove(format);
            }
            else {
                if (!this.cache.modifiers) {
                    this.cache.modifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_3__["Modifiers"]();
                }
                this.cache.modifiers.append(new FormatClass());
            }
        }
        else {
            const selectedInlines = range.selectedNodes(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]);
            // If every char in the range has the format `FormatClass`, remove
            // the format for all of them.
            const allHaveFormat = selectedInlines.every(inline => {
                return !!inline.modifiers.find(FormatClass);
            });
            if (allHaveFormat) {
                for (const inline of selectedInlines) {
                    const format = inline.modifiers.find(FormatClass);
                    // Apply the attributes of the format we're about to remove
                    // to the inline itself.
                    const attributes = inline.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]);
                    const matchingFormatAttributes = format.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]);
                    if (matchingFormatAttributes) {
                        for (const key of matchingFormatAttributes.keys()) {
                            attributes.set(key, matchingFormatAttributes.get(key));
                        }
                    }
                    // Remove the format.
                    inline.modifiers.remove(format);
                }
            }
            else {
                // If there is at least one char in the range without the format
                // `FormatClass`, set the format for all nodes.
                for (const inline of selectedInlines) {
                    if (!inline.modifiers.find(FormatClass)) {
                        new FormatClass().applyTo(inline);
                    }
                }
            }
        }
    }
    isAllFormat(FormatClass, range = this.editor.selection.range) {
        var _a;
        if (range.isCollapsed()) {
            if (!this.cache.modifiers) {
                return !!((_a = this.getCurrentModifiers(range)) === null || _a === void 0 ? void 0 : _a.find(FormatClass));
            }
            return !!this.cache.modifiers.find(FormatClass);
        }
        else {
            const selectedInlines = range.selectedNodes(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]);
            for (const char of selectedInlines) {
                if (!char.modifiers.find(FormatClass)) {
                    return false;
                }
            }
            return !!selectedInlines.length;
        }
    }
    /**
     * Get the modifiers for the next insertion.
     */
    getCurrentModifiers(range) {
        const storeInCache = !range;
        range = range || this.editor.selection.range;
        if (this.cache.modifiers === undefined || range !== this.editor.selection.range) {
            let inlineToCopyModifiers;
            if (range.isCollapsed()) {
                // TODO: LineBreakNode should have the formats as well.
                inlineToCopyModifiers =
                    range.start.previousSibling(node => !(node instanceof _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_4__["LineBreakNode"])) ||
                        range.start.nextSibling();
            }
            else {
                inlineToCopyModifiers = range.start.nextSibling();
            }
            let modifiers = null;
            if (inlineToCopyModifiers && inlineToCopyModifiers instanceof _InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]) {
                modifiers = inlineToCopyModifiers.modifiers.clone();
            }
            if (storeInCache) {
                this.cache.modifiers = modifiers;
            }
            return modifiers;
        }
        else {
            return this.cache.modifiers;
        }
    }
    /**
     * Get the styles for the next insertion.
     */
    getCurrentStyle(range) {
        var _a;
        const storeInCache = !range;
        range = range || this.editor.selection.range;
        if (this.cache.style === undefined || range !== this.editor.selection.range) {
            let inlineToCopyStyle;
            if (range.isCollapsed()) {
                inlineToCopyStyle = range.start.previousSibling() || range.start.nextSibling();
            }
            else {
                inlineToCopyStyle = range.start.nextSibling();
            }
            let style = null;
            if (inlineToCopyStyle && inlineToCopyStyle instanceof _InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]) {
                style = ((_a = inlineToCopyStyle.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.clone()) || null;
            }
            if (storeInCache) {
                this.cache.style = style;
            }
            return style;
        }
        return this.cache.style;
    }
    /**
     * Each time the selection changes, we reset its format and style.
     */
    resetCache() {
        this.cache.modifiers = undefined;
        this.cache.style = undefined;
    }
    /**
     * Remove the formatting of the nodes in the range.
     *
     * @param params
     */
    removeFormat(params) {
        const nodes = params.context.range.selectedNodes();
        for (const node of nodes) {
            // TODO: some formats might be on the parent...
            node.modifiers.empty();
        }
    }
}


/***/ }),

/***/ "./packages/plugin-inline/src/InlineNode.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-inline/src/InlineNode.ts ***!
  \**************************************************/
/*! exports provided: InlineNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InlineNode", function() { return InlineNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class InlineNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
}


/***/ }),

/***/ "./packages/plugin-input/src/Input.ts":
/*!********************************************!*\
  !*** ./packages/plugin-input/src/Input.ts ***!
  \********************************************/
/*! exports provided: Input */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Input", function() { return Input; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _InputXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InputXmlDomParser */ "./packages/plugin-input/src/InputXmlDomParser.ts");
/* harmony import */ var _InputDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InputDomObjectRenderer */ "./packages/plugin-input/src/InputDomObjectRenderer.ts");



class Input extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_InputXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["InputXmlDomParser"]],
            renderers: [_InputDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["InputDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-input/src/InputDomObjectRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-input/src/InputDomObjectRenderer.ts ***!
  \*************************************************************/
/*! exports provided: InputDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputDomObjectRenderer", function() { return InputDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _InputNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class InputDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _InputNode__WEBPACK_IMPORTED_MODULE_1__["InputNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const input = {
            tag: 'INPUT',
            attributes: {
                type: node.inputType,
                name: node.inputName,
                value: node.value,
            },
        };
        let onCommit;
        let mousedown;
        let changeHandler;
        input.attach = (el) => {
            onCommit = this._onCommit.bind(this, node, el);
            changeHandler = () => {
                this.engine.editor.execCommand(() => {
                    node.value = el.value;
                    node.change(this.engine.editor);
                });
            };
            mousedown = (ev) => {
                ev.stopImmediatePropagation();
                ev.stopPropagation();
            };
            el.addEventListener('change', changeHandler);
            el.addEventListener('mousedown', mousedown);
            this.engine.editor.dispatcher.registerCommandHook('@commit', onCommit);
        };
        input.detach = (el) => {
            el.removeEventListener('change', changeHandler);
            el.removeEventListener('mousedown', mousedown);
            this.engine.editor.dispatcher.removeCommandHook('@commit', onCommit);
        };
        return input;
    }
    /**
     * On input change handler.
     *
     * Meant to be overriden.
     */
    // eslint-disable-next-line @typescript-eslint/no-unused-vars,@typescript-eslint/no-empty-function
    _onCommit(node, el) { }
}
InputDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-input/src/InputNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-input/src/InputNode.ts ***!
  \************************************************/
/*! exports provided: InputNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputNode", function() { return InputNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class InputNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params = {}) {
        super({ htmlTag: 'INPUT' });
        this.inputName = params.inputName || '';
        this.inputType = params.inputType || 'text';
        this.value = params.value || '';
        if (params.change)
            this.change = params.change;
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars,@typescript-eslint/no-empty-function
    change(editor) { }
}


/***/ }),

/***/ "./packages/plugin-input/src/InputXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-input/src/InputXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: InputXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputXmlDomParser", function() { return InputXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _InputNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class InputXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'INPUT';
        };
    }
    async parse(item) {
        const input = new _InputNode__WEBPACK_IMPORTED_MODULE_2__["InputNode"]({
            inputType: item.getAttribute('type'),
            inputName: item.getAttribute('name'),
            value: item.value,
        });
        const attributes = this.engine.parseAttributes(item);
        if (attributes) {
            attributes.remove('type'); // type is on input.inputType
            attributes.remove('name'); // type is on input.inputName
        }
        if (attributes.length) {
            input.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        input.append(...nodes);
        return [input];
    }
}
InputXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-italic/src/Italic.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-italic/src/Italic.ts ***!
  \**********************************************/
/*! exports provided: Italic */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Italic", function() { return Italic; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ItalicFormat */ "./packages/plugin-italic/src/ItalicFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _ItalicXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ItalicXmlDomParser */ "./packages/plugin-italic/src/ItalicXmlDomParser.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");







class Italic extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ItalicXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["ItalicXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+I',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"] },
                },
            ],
            components: [
                {
                    id: 'ItalicButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__["ActionableNode"]({
                            name: 'italic',
                            label: 'Toggle italic',
                            commandId: 'toggleFormat',
                            commandArgs: { FormatClass: _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"] },
                            selected: (editor) => {
                                var _a, _b, _c;
                                const range = editor.selection.range;
                                if (range.isCollapsed()) {
                                    const pluginInline = editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]);
                                    return !!((_a = pluginInline
                                        .getCurrentModifiers(range)) === null || _a === void 0 ? void 0 : _a.find(_ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"]));
                                }
                                else {
                                    const startIsFormated = !!((_b = range.start
                                        .nextSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _b === void 0 ? void 0 : _b.modifiers.find(_ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"]));
                                    if (!startIsFormated || range.isCollapsed()) {
                                        return startIsFormated;
                                    }
                                    else {
                                        return !!((_c = range.end
                                            .previousSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _c === void 0 ? void 0 : _c.modifiers.find(_ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"]));
                                    }
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]({ class: 'fa fa-italic fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['ItalicButton', ['actionables']]],
        };
    }
}
Italic.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-italic/src/ItalicFormat.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-italic/src/ItalicFormat.ts ***!
  \****************************************************/
/*! exports provided: ItalicFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItalicFormat", function() { return ItalicFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class ItalicFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'I') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-italic/src/ItalicXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-italic/src/ItalicXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ItalicXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItalicXmlDomParser", function() { return ItalicXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ItalicFormat */ "./packages/plugin-italic/src/ItalicFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class ItalicXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'I' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'EM');
        };
    }
    /**
     * Parse an italic node.
     *
     * @param item
     */
    async parse(item) {
        const italic = new _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item));
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            italic.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(italic, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-keymap/src/Keymap.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-keymap/src/Keymap.ts ***!
  \**********************************************/
/*! exports provided: Platform, LEVEL, Keymap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Platform", function() { return Platform; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LEVEL", function() { return LEVEL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Keymap", function() { return Keymap; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

var Platform;
(function (Platform) {
    Platform["MAC"] = "mac";
    Platform["PC"] = "pc";
})(Platform || (Platform = {}));
var LEVEL;
(function (LEVEL) {
    LEVEL[LEVEL["DEFAULT"] = 0] = "DEFAULT";
    LEVEL[LEVEL["USER"] = 1] = "USER";
})(LEVEL || (LEVEL = {}));
/**
 * Keymap allow to add and remove shortucts and provide a function to match a
 * keyboard event with the registered shortcuts patterns.
 *
 * ## Adding shortcuts
 * The expression to describe a shortuct is zero or more `modifiers` and one
 * `hotkey` joined with the symbol `+`.
 *
 * ### Modifiers
 * - SHIFT
 * - ALT
 * - CTRL
 * - META
 * - CMD (alias of META)
 *
 * Example:
 * ```typescript
 * // using a modifier and one key
 * keymap.bind('CTRL+A', 'commandIdentifier')
 * // using multiples modifiers and one key
 * keymap.bind('CTRL+ALT+A', 'commandIdentifier')
 * ```
 *
 * ### Hotkeys
 * A hotkey can be wether a `key` or `code`.
 *
 * #### Key
 * The syntax to describe a `key` is to write the `key` as it is. The convention
 * is to write it in uppercase.
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+A', 'commandIdentifier')
 * ```
 * The list of possible `key` values are defined in the following link:
 * https://www.w3.org/TR/uievents/#dom-keyboardevent-key
 *
 * #### Code
 * The syntax to describe a `code` is to write `<code>` (surrounded by "<" and
 * ">").
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+<KeyA>', 'commandIdentifier')
 * ```
 *
 * The list of possible `code` values are defined in the following link:
 * https://www.w3.org/TR/uievents/#dom-keyboardevent-key
 *
 * ## Removing shortucts
 * To remove a shortuct, call `bind` without specifying a commandIdentifier.
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+<KeyA>')
 * ```
 */
class Keymap extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, config) {
        super(editor, config);
        this.editor = editor;
        this.config = config;
        this.loaders = {
            shortcuts: this._loadShortcuts,
        };
        this.mappings = [...new Array(LEVEL.USER + 1)].map(() => []);
        this.defaultMappings = [];
        this.userMappings = [];
        if (!config.platform) {
            const isMac = navigator.platform.match(/Mac/);
            config.platform = isMac ? Platform.MAC : Platform.PC;
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Bind a shortuct.
     *
     * If there is no `command.commandId`, it means that we want nothing to
     * execute, thus replacing the command originally bound on this shortcut.
     *
     * @param pattern
     * @param command
     */
    bind(pattern, command, level = LEVEL.DEFAULT) {
        this.mappings[level].push({
            pattern: this.parsePattern(pattern),
            configuredCommand: command,
        });
    }
    /**
     * Return all configured commands which shortcut match the given `keyEvent`.
     *
     * @param keyEvent
     */
    match(keyEvent) {
        var _a;
        const matchingCommands = [];
        for (let level = LEVEL.USER; level >= 0; level--) {
            for (const shortcut of this.mappings[level]) {
                const modifiers = shortcut.pattern.modifiers;
                let match;
                if ('code' in shortcut.pattern) {
                    match = shortcut.pattern.code === keyEvent.code;
                }
                else {
                    // In rare case the KeyboardEvent `key` is undefined.
                    match = shortcut.pattern.key === ((_a = keyEvent.key) === null || _a === void 0 ? void 0 : _a.toUpperCase());
                }
                match =
                    match &&
                        modifiers.has('CTRL') === keyEvent.ctrlKey &&
                        modifiers.has('SHIFT') === keyEvent.shiftKey &&
                        modifiers.has('META') === keyEvent.metaKey &&
                        modifiers.has('ALT') === keyEvent.altKey;
                if (match) {
                    if (!shortcut.configuredCommand.commandId) {
                        // An `undefined` command unbounds the other commands
                        // previously registered on this shortcut.
                        matchingCommands.length = 0;
                    }
                    matchingCommands.push(shortcut.configuredCommand);
                }
            }
            if (matchingCommands.length) {
                // Matches were found at this level so do not look lower.
                break;
            }
        }
        return matchingCommands;
    }
    /**
     * Parse a string that represents a pattern and return a `ShortuctPattern`.
     * Supported pattern is: [modifier+]*[<code>|key]
     *
     * @param pattern
     */
    parsePattern(pattern) {
        const tokens = pattern
            .replace(/cmd/gi, 'META')
            .split(/[+]/)
            .map(token => token.trim());
        const keyCode = tokens.pop();
        const modifiers = new Set(tokens.map(token => token.toUpperCase()));
        if (!keyCode) {
            throw new Error('You must have at least one key or code.');
        }
        // There are two ways to specify a shortcut hotkey : key or code
        // - "CTRL+1" is the modifier CTRL with the event.key "1".
        // - "CTRL+<Key1>" is the modifier CTRL with the event.code "Key1"
        const codeMatch = keyCode.match(/^<(\w+)>$/);
        if (codeMatch && codeMatch.length > 1) {
            return { code: codeMatch[1], modifiers };
        }
        else {
            return { key: keyCode.toUpperCase(), modifiers };
        }
    }
    /**
     * Take a `ShortuctPattern` and return a string that represents a pattern,
     * in the form [modifier+]*[<code>|key].
     *
     * @param pattern
     */
    stringifyPattern(pattern) {
        const parts = Array.from(pattern.modifiers);
        if ('code' in pattern) {
            parts.push(pattern.code);
        }
        else if ('key' in pattern) {
            parts.push(pattern.key);
        }
        return parts.join('+');
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Load a shortcut in the keymap depending on the platform.
     *
     * - If the shortuct has no platform property; load the shortuct in both
     *   platform ('mac' and 'pc').
     * - If the shortuct has no platform property and the current platform is
     *   mac, modify the ctrl key to meta key.
     * - If the shortuct has a platform property, only load the shortcut for
     *   that platform.
     * - If no `mapping.commandId` is declared, it means removing the shortcut.
     *
     * @param shortcuts The shortuct definitions.
     * @param source The source of the shortcuts.
     */
    _loadShortcuts(shortcuts, source) {
        for (const shortcut of [...shortcuts]) {
            // A shortcut is a configured command on which the properties
            // `pattern`, and optionally `platform`, were set.
            const platform = shortcut.platform;
            if (!platform || platform === this.config.platform) {
                let pattern = shortcut.pattern;
                const command = shortcut;
                // Patterns using the CTRL modifier target CMD instead for Mac.
                if (!platform && this.config.platform === Platform.MAC) {
                    pattern = shortcut.pattern.replace(/ctrl/gi, 'CMD');
                }
                if (source instanceof _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"]) {
                    this.bind(pattern, command, LEVEL.DEFAULT);
                }
                else {
                    this.bind(pattern, command, LEVEL.USER);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/ActionableGroupNode.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-layout/src/ActionableGroupNode.ts ***!
  \***********************************************************/
/*! exports provided: ActionableGroupNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionableGroupNode", function() { return ActionableGroupNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class ActionableGroupNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super(params);
        this.groupName = params === null || params === void 0 ? void 0 : params.name;
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/ActionableNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-layout/src/ActionableNode.ts ***!
  \******************************************************/
/*! exports provided: ActionableNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionableNode", function() { return ActionableNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");


class ActionableNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super(params);
        this.actionName = params.name;
        this.label = params.label;
        this.commandId = params.commandId;
        this.commandArgs = params.commandArgs && Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(params.commandArgs);
        if (params.selected) {
            this.selected = params.selected;
        }
        if (params.enabled) {
            this.enabled = params.enabled;
        }
        if (params.visible) {
            this.visible = params.visible;
        }
    }
    get name() {
        return super.name + ': ' + this.actionName;
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    selected(editor) {
        return false;
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    enabled(editor) {
        return true;
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    visible(editor) {
        return true;
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/LabelNode.ts":
/*!*************************************************!*\
  !*** ./packages/plugin-layout/src/LabelNode.ts ***!
  \*************************************************/
/*! exports provided: LabelNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabelNode", function() { return LabelNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class LabelNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super();
        this.label = params.label;
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/Layout.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-layout/src/Layout.ts ***!
  \**********************************************/
/*! exports provided: Layout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return Layout; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Layout extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.engines = {};
        this.loaders = {
            layoutEngines: this.loadEngines,
            components: this.loadComponents,
            componentZones: this.loadComponentsZones,
        };
        this.commands = {
            show: {
                title: 'Show a layout component',
                handler: this.show.bind(this),
            },
            hide: {
                title: 'Hide a layout component',
                handler: this.hide.bind(this),
            },
        };
    }
    async start() {
        this.loadComponents(this.configuration.components || []);
        this.loadComponentsZones(this.configuration.componentZones || []);
    }
    /**
     * Prepend a Component in a zone.
     *
     * @param componentId
     * @param zoneId
     * @param props
     */
    async prepend(componentId, zoneId = 'default', props) {
        const engines = Object.values(this.engines);
        await Promise.all(engines.map(engine => engine.prepend(componentId, zoneId, props)));
    }
    /**
     * Append a Component in a zone.
     *
     * @param componentId
     * @param zoneId
     */
    async append(componentId, zoneId = 'default', props) {
        const engines = Object.values(this.engines);
        await Promise.all(engines.map(engine => engine.append(componentId, zoneId, props)));
    }
    /**
     * Clear a zone content.
     *
     * @param zoneId
     */
    async clear(zoneId) {
        const engines = Object.values(this.engines);
        await Promise.all(engines.map(engine => engine.clear(zoneId)));
    }
    /**
     * Remove a component (instance or clonse) from the zone.
     *
     * @param componentId
     * @param zoneId specifying a zone if it is necessary to remove the
     *      component from this zone only
     */
    async remove(componentId, zoneId) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.remove(componentId, zoneId));
        }
        await Promise.all(promises);
    }
    /**
     * Show component (instance or clonse) inside the zone.
     *
     * @param params
     */
    async show(params) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.show(params.componentId));
        }
        await Promise.all(promises);
    }
    /**
     * Hide component (instance or clonse) inside the zone.
     *
     * @param params
     */
    async hide(params) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.hide(params.componentId));
        }
        await Promise.all(promises);
    }
    /**
     * Load layout engines.
     *
     * @param layoutEngines
     */
    loadEngines(layoutEngines) {
        for (const EngineClass of layoutEngines) {
            const engine = new EngineClass(this.editor);
            if (this.engines[engine.constructor.id]) {
                throw new Error(`Rendering engine ${EngineClass.name} already registered.`);
            }
            this.engines[engine.constructor.id] = engine;
        }
    }
    /**
     * Load components into all layout engines.
     *
     * @param Components
     */
    loadComponents(Components) {
        for (const Component of Components) {
            for (const layoutEngine of Object.values(this.engines)) {
                layoutEngine.loadComponent(Component);
            }
        }
    }
    /**
     * Load component zones into all layout engines.
     *
     * @param componentsZones
     */
    loadComponentsZones(componentsZones) {
        const zones = {};
        for (const [id, zone] of componentsZones) {
            zones[id] = zone;
        }
        for (const layoutEngine of Object.values(this.engines)) {
            layoutEngine.loadComponentZones(zones);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/LayoutEngine.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-layout/src/LayoutEngine.ts ***!
  \****************************************************/
/*! exports provided: LayoutEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutEngine", function() { return LayoutEngine; });
/* harmony import */ var _ZoneNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");



class LayoutEngine {
    constructor(editor) {
        this.editor = editor;
        this.componentDefinitions = {};
        this.componentZones = {};
        this.root = new _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]({ managedZones: ['root'] });
        this.components = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__["VersionableObject"]();
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Automatically intanciate the components in available zones.
     */
    async start() {
        let allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        await this.fillZones(allZones);
        allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        if (!allZones.find(zone => zone.managedZones.includes('default'))) {
            // Add into the default zone if no valid zone could be found.
            throw new Error('Please define a "default" zone in your template.');
        }
        this.editor.memory.attach(this.root);
        this.editor.memory.attach(this.components);
    }
    /**
     * Hide all components.
     */
    async stop() {
        for (const id in this.components) {
            for (const node of this.components[id]) {
                const zone = node.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
                if (zone) {
                    zone.hide(node);
                }
            }
        }
        this.componentDefinitions = {};
        this.componentZones = {};
        this.components = {};
        this.root.empty();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Load the given Component in this layout engine.
     *
     * @param componentDefinition
     */
    loadComponent(componentDefinition) {
        this.componentDefinitions[componentDefinition.id] = componentDefinition;
    }
    /**
     * Load component zones in this layout engine.
     *
     * @param componentZones
     */
    loadComponentZones(componentZones) {
        Object.assign(this.componentZones, componentZones);
    }
    /**
     * Prepend the given node in the given zone if it exists. Otherwise, add it in
     * the default zone.
     * Return every created instance
     *
     * @param componentId
     * @param zoneId
     * @param props
     */
    async prepend(componentId, zoneId, props) {
        const allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        let matchingZones = allZones.filter(node => node.managedZones.includes(zoneId));
        if (!matchingZones.length) {
            matchingZones = allZones.filter(zone => zone.managedZones.includes('default'));
        }
        const componentDefinition = this.componentDefinitions[componentId];
        const newComponents = await this._instantiateComponent(componentDefinition, matchingZones, props, true);
        return this.fillZones(newComponents);
    }
    /**
     * Append the given node in the given zone if it exists. Otherwise, add it in
     * the default zone.
     * Return every created instance
     *
     * @param componentDefinition
     * @param zoneId
     */
    async append(componentId, zoneId, props) {
        const allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        let matchingZones = allZones.filter(node => node.managedZones.includes(zoneId));
        if (!matchingZones.length) {
            matchingZones = allZones.filter(zone => zone.managedZones.includes('default'));
        }
        const componentDefinition = this.componentDefinitions[componentId];
        const newComponents = await this._instantiateComponent(componentDefinition, matchingZones, props);
        return this.fillZones(newComponents);
    }
    /**
     *
     * Remove the component identified by the given reference from all zones.
     *
     * @param componentId
     * @param zoneId specifying a zone if it is necessary to remove the
     *      component from this zone only
     */
    async remove(componentId, zoneId) {
        const components = [...(this.components[componentId] || [])];
        const zones = [];
        let component;
        while ((component = components.pop())) {
            // filter by zone if needed
            if (!zoneId ||
                component.ancestor(ancestor => ancestor instanceof _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"] && ancestor.managedZones.includes(zoneId))) {
                // Remove all instances in the zone children.
                this._clear(component);
                // Remove the instance.
                const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
                if (zone && !zones.includes(zone)) {
                    zones.push(zone);
                }
                component.remove();
            }
        }
        return zones;
    }
    async clear(zoneId) {
        const zones = this.root
            .descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])
            .filter(zone => zone.managedZones.includes(zoneId));
        for (const zone of zones) {
            this._clear(zone);
        }
        return zones;
    }
    /**
     *
     * Show the components corresponding to given ref. Return the updated zones.
     *
     * @param componentId
     */
    async show(componentId) {
        const components = this.components[componentId];
        if (!(components === null || components === void 0 ? void 0 : components.length)) {
            console.warn('No component to show. Prepend or append it in a zone first.');
        }
        else {
            for (const component of components) {
                const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
                zone.show(component);
            }
        }
        return components || [];
    }
    /**
     *
     * Hide the components corresponding to given ref. Return the updated zones.
     *
     * @param componentId
     */
    async hide(componentId) {
        const components = this.components[componentId];
        if (!(components === null || components === void 0 ? void 0 : components.length)) {
            console.warn('No component to hide. Prepend or append it in a zone first.');
        }
        else {
            for (const component of components) {
                const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
                zone.hide(component);
            }
        }
        return components || [];
    }
    /**
     * Check if the string is a zone id where at leat one component will be
     * automatically added.
     *
     * @param zoneId
     */
    hasConfiguredComponents(zoneId) {
        var _a;
        // Check the zone list.
        for (const componentId in this.componentZones) {
            if ((_a = this.componentZones[componentId]) === null || _a === void 0 ? void 0 : _a.includes(zoneId)) {
                return true;
            }
        }
        // The components all have at least one zone equal to their id.
        return !!this.componentDefinitions[zoneId];
    }
    /**
     * Search into this new nodes if they are some ZoneNode and automatically
     * fill it by the components which match with this zones.
     *
     * @param nodes
     */
    async fillZones(nodes) {
        const newComponents = [];
        const stack = [...nodes];
        while (stack.length) {
            const node = stack.pop();
            const zones = node.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
            if (node instanceof _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]) {
                zones.push(node);
            }
            for (const componentId in this.componentDefinitions) {
                const zoneIds = this.componentZones[componentId];
                const layoutComponent = this.componentDefinitions[componentId];
                // Filter the zones corresponding to the given identifier.
                let matchingZones = zones.filter(zone => (zoneIds && zone.managedZones.find(zoneId => zoneIds.includes(zoneId))) ||
                    zone.managedZones.includes(componentId));
                const components = this.components[componentId];
                if (components) {
                    // Excluding the ones that are contained within the given node.
                    // Avoid loop with child in itself.
                    matchingZones = matchingZones.filter(zone => !zone.closest(ancestor => components.includes(ancestor)));
                }
                if (matchingZones.length) {
                    stack.push(...(await this._instantiateComponent(layoutComponent, matchingZones)));
                }
            }
            newComponents.push(node);
        }
        return newComponents;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    async _instantiateComponent(componentDefinition, zones, props, prepend = false) {
        let components = this.components[componentDefinition.id];
        if (!components) {
            // Set the local reference.
            components = new _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_1__["VersionableArray"]();
            this.components[componentDefinition.id] = components;
        }
        // Add into the container.
        const newComponents = [];
        for (const zone of zones) {
            const nodes = await componentDefinition.render(this.editor, props);
            components.push(...nodes);
            newComponents.push(...nodes);
            if (prepend) {
                zone.prepend(...nodes);
            }
            else {
                zone.append(...nodes);
            }
        }
        // Return the components that were newly created.
        return newComponents;
    }
    _clear(component) {
        const zones = component.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
        if (component instanceof _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]) {
            zones.push(component);
        }
        for (const zone of zones) {
            for (const child of zone.children()) {
                zone.removeChild(child);
                for (const id in this.components) {
                    const nodes = this.components[id];
                    if (nodes.includes(child)) {
                        nodes.splice(nodes.indexOf(child), 1);
                        break;
                    }
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/ZoneNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-layout/src/ZoneNode.ts ***!
  \************************************************/
/*! exports provided: ZoneNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneNode", function() { return ZoneNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");


class ZoneNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super(params);
        this.editable = false;
        this.breakable = false;
        this.managedZones = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(params.managedZones);
    }
    get name() {
        return super.name + ': ' + this.managedZones.join();
    }
    hide(child) {
        if (!this.hidden) {
            this.hidden = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])({});
        }
        this.hidden[child.id] = true;
        return;
    }
    show(child) {
        var _a;
        const id = child.id;
        if ((_a = this.hidden) === null || _a === void 0 ? void 0 : _a[id]) {
            this.hidden[id] = false;
        }
        const parentZone = this.ancestor(ZoneNode);
        if (parentZone) {
            parentZone.show(this);
        }
    }
    _removeAtIndex(index) {
        const child = this.childVNodes[index];
        super._removeAtIndex(index);
        if (this.hidden) {
            delete this.hidden[child.id];
        }
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreak.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreak.ts ***!
  \****************************************************/
/*! exports provided: LineBreak */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreak", function() { return LineBreak; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _LineBreakXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LineBreakXmlDomParser */ "./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts");
/* harmony import */ var _LineBreakDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./LineBreakDomObjectRenderer */ "./packages/plugin-linebreak/src/LineBreakDomObjectRenderer.ts");




class LineBreak extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_LineBreakXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["LineBreakXmlDomParser"]],
            renderers: [_LineBreakDomObjectRenderer__WEBPACK_IMPORTED_MODULE_3__["LineBreakDomObjectRenderer"]],
        };
        this.commands = {
            insertLineBreak: {
                handler: this.insertLineBreak,
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert a line break node at range.
     */
    insertLineBreak(params) {
        return params.context.execCommand('insert', {
            node: new _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__["LineBreakNode"](),
        });
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakDomObjectRenderer.ts":
/*!*********************************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakDomObjectRenderer.ts ***!
  \*********************************************************************/
/*! exports provided: LineBreakDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakDomObjectRenderer", function() { return LineBreakDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class LineBreakDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__["LineBreakNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node, worker) {
        const br = { tag: 'BR' };
        worker.locate([node], br);
        if (!node.nextSibling()) {
            // If a LineBreakNode has no next sibling, it must be rendered
            // as two BRs in order for it to be visible.
            const br2 = { tag: 'BR' };
            const domObject = { children: [br, br2] };
            worker.locate([node], br2);
            return domObject;
        }
        return br;
    }
}
LineBreakDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakNode.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakNode.ts ***!
  \********************************************************/
/*! exports provided: LineBreakNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakNode", function() { return LineBreakNode; });
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");


class LineBreakNode extends _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_1__["SeparatorNode"] {
    get name() {
        return '';
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Transform the given DOM location into its VDocument counterpart.
     *
     * @override
     * @param domNode DOM node corresponding to this VNode
     * @param offset The offset of the location in the given domNode
     */
    locate(domNode, offset) {
        const location = super.locate(domNode, offset);
        // When clicking on a trailing line break, we need to target after the
        // line break. The DOM represents these as 2 <br> so this is a special
        // case.
        if (!this.nextSibling() && !domNode.nextSibling) {
            location[1] = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        }
        return location;
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: LineBreakXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakXmlDomParser", function() { return LineBreakXmlDomParser; });
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





class LineBreakXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(item) === 'BR';
        };
    }
    async parse(item) {
        if (this._isInvisibleBR(item)) {
            return [];
        }
        const lineBreak = new _LineBreakNode__WEBPACK_IMPORTED_MODULE_0__["LineBreakNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            lineBreak.modifiers.append(attributes);
        }
        return [lineBreak];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given <br/> node is invisible. A <br/> at the end edge
     * of a block or before another block is there only to make its parent
     * visible. Consume it since it was just parsed as its parent element node.
     * TODO: account for formatting space.
     *
     * @param node
     */
    _isInvisibleBR(node) {
        // Search for another non-block cousin in the same block parent.
        while (node && !node.nextSibling && node.parentNode && !Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__["isBlock"])(node.parentNode)) {
            node = node.parentNode;
        }
        return !node || !node.nextSibling || Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__["isBlock"])(node.nextSibling);
    }
}
LineBreakXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-link/assets/LinkForm.xml":
/*!**************************************************!*\
  !*** ./packages/plugin-link/assets/LinkForm.xml ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<templates>\n    <div t-name=\"link\">\n        <h2>Insert a link</h2>\n        <table class=\"form-table\">\n            <tr>\n                <td><label for=\"linkUrl\">URL </label></td>\n                <td><input type=\"text\" id=\"linkUrl\" name=\"url\" t-model=\"state.url\"/></td>\n            </tr>\n            <tr>\n                <td><label for=\"linkLabel\">Label </label></td>\n                <td><input type=\"text\" id=\"linkLabel\" name=\"label\" t-model=\"state.label\"/></td>\n            </tr>\n        </table>\n        <br/>\n        <button name=\"save\" t-on-click=\"saveLink()\">Save</button> <button name=\"save\" t-on-click=\"cancel()\">Cancel</button>\n    </div>\n</templates>\n"

/***/ }),

/***/ "./packages/plugin-link/src/Link.ts":
/*!******************************************!*\
  !*** ./packages/plugin-link/src/Link.ts ***!
  \******************************************/
/*! exports provided: Link */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Link", function() { return Link; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _LinkXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LinkXmlDomParser */ "./packages/plugin-link/src/LinkXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _LinkFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../assets/LinkForm.xml */ "./packages/plugin-link/assets/LinkForm.xml");
/* harmony import */ var _assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_owl_src_OwlNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../plugin-owl/src/OwlNode */ "./packages/plugin-owl/src/OwlNode.ts");
/* harmony import */ var _components_LinkComponent__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./components/LinkComponent */ "./packages/plugin-link/src/components/LinkComponent.ts");













class Link extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            link: {
                handler: this.link,
            },
            unlink: {
                handler: this.unlink,
            },
        };
        this.loadables = {
            parsers: [_LinkXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["LinkXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+K',
                    selector: [(node) => !Link.isLink(node)],
                    commandId: 'link',
                },
                {
                    pattern: 'CTRL+K',
                    selector: [Link.isLink],
                    commandId: 'unlink',
                },
            ],
            components: [
                {
                    id: 'link',
                    async render(editor, props) {
                        return [new _plugin_owl_src_OwlNode__WEBPACK_IMPORTED_MODULE_11__["OwlNode"]({ Component: _components_LinkComponent__WEBPACK_IMPORTED_MODULE_12__["LinkComponent"], props: props })];
                    },
                },
                {
                    id: 'LinkButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__["ActionableNode"]({
                            name: 'link',
                            label: 'Insert link',
                            commandId: 'link',
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const node = range.start.nextSibling() || range.start.previousSibling();
                                return (node &&
                                    node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"] &&
                                    !!node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]));
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]({ class: 'fa fa-link fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'UnlinkButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_9__["ActionableNode"]({
                            name: 'unlink',
                            label: 'Remove italic',
                            commandId: 'unlink',
                            enabled: (editor) => {
                                const range = editor.selection.range;
                                const node = range.start.nextSibling() || range.start.previousSibling();
                                return (node &&
                                    node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"] &&
                                    !!node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]));
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]({ class: 'fa fa-unlink fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [
                ['link', ['float']],
                ['LinkButton', ['actionables']],
                ['UnlinkButton', ['actionables']],
            ],
            owlTemplates: [_assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_8___default.a],
        };
    }
    static isLink(link, node) {
        if (link instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__["AbstractNode"]) {
            node = link;
        }
        const format = node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"] && node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]);
        return link instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__["AbstractNode"] ? !!format : link.isSameAs(format);
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    async link(params) {
        // If the url is undefined, ask the user to provide one.
        const range = params.context.range;
        const selectedInlines = range.selectedNodes(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]);
        const label = params.label || selectedInlines.map(node => node.textContent).join('');
        if (!params.url) {
            const firstLink = selectedInlines.find(node => node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]));
            const link = firstLink && firstLink.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]).clone();
            const url = (link === null || link === void 0 ? void 0 : link.url) || '';
            const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_7__["Layout"]);
            await layout.remove('link');
            return layout.append('link', undefined, { label: label, url: url });
        }
        // Otherwise create a link and insert it.
        const link = new _LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"](params.url);
        if (params.target) {
            link.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_10__["Attributes"]).set('target', params.target);
        }
        return params.context.execCommand('insertText', {
            text: label || link.url,
            formats: new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"](link),
            context: params.context,
        });
    }
    unlink(params) {
        const range = params.context.range;
        if (range.isCollapsed()) {
            // If no range is selected and we are in a Link : remove the complete link.
            const previousNode = range.start.previousSibling();
            const nextNode = range.start.nextSibling();
            const node = Link.isLink(previousNode) ? previousNode : nextNode;
            if (!Link.isLink(node))
                return;
            const link = node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]);
            const sameLink = Link.isLink.bind(Link, link);
            this._removeLinkOnNodes([node, ...node.adjacents(sameLink)]);
        }
        else {
            // If a range is selected : remove any link on the selected range.
            const selectedNodes = range.selectedNodes(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]);
            // Remove the format 'LinkFormat' for all nodes.
            this._removeLinkOnNodes(selectedNodes);
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Remove all link modifiers on the provided nodes.
     * This method is mainly use by the unlink function of the editor.
     */
    _removeLinkOnNodes(nodes) {
        for (const node of nodes) {
            node.modifiers.remove(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]);
        }
    }
}
Link.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]];


/***/ }),

/***/ "./packages/plugin-link/src/LinkFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-link/src/LinkFormat.ts ***!
  \************************************************/
/*! exports provided: LinkFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkFormat", function() { return LinkFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");



class LinkFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(url = '#', target = '') {
        super('A');
        this.preserve = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_2__["VersionableObject"]({
            after: true,
            paragraphBreak: false,
            lineBreak: true,
        });
        this.url = url;
        if (target) {
            this.target = target;
        }
    }
    // TODO: Attributes on Link should reactively read the values set on the
    // node itself rather than having to manually synchronize them.
    get url() {
        var _a;
        return (_a = this.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('href');
    }
    set url(url) {
        this.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]).set('href', url);
    }
    get target() {
        var _a;
        return ((_a = this.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('target')) || '';
    }
    set target(target) {
        if (target.length) {
            this.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]).set('target', target);
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    clone() {
        const clone = super.clone();
        clone.url = this.url;
        return clone;
    }
}


/***/ }),

/***/ "./packages/plugin-link/src/LinkXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-link/src/LinkXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: LinkXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkXmlDomParser", function() { return LinkXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _LinkFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");





class LinkXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'A';
        };
    }
    async parse(item) {
        const link = new _LinkFormat__WEBPACK_IMPORTED_MODULE_1__["LinkFormat"](item.getAttribute('href'));
        // TODO: Link should not have an `Attributes` modifier outside of XML.
        // In XML context we need to conserve the order of attributes.
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            link.modifiers.replace(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(link, children);
        // The applyFormat helper only applies the format to InlineNodes.
        for (const node of children) {
            if (node instanceof _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_4__["LineBreakNode"]) {
                link.clone().applyTo(node);
            }
        }
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-link/src/components/LinkComponent.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-link/src/components/LinkComponent.ts ***!
  \**************************************************************/
/*! exports provided: LinkComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkComponent", function() { return LinkComponent; });
/* harmony import */ var _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/OwlComponent */ "./packages/plugin-owl/src/OwlComponent.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_2__);



class LinkComponent extends _plugin_owl_src_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        var _a, _b;
        super(...arguments);
        this.state = Object(_odoo_owl__WEBPACK_IMPORTED_MODULE_2__["useState"])({
            url: ((_a = this.props) === null || _a === void 0 ? void 0 : _a.url) || '',
            label: ((_b = this.props) === null || _b === void 0 ? void 0 : _b.label) || '',
        });
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    async saveLink() {
        await this.env.editor.execCommand(async (context) => {
            const params = {
                url: this.state.url,
                label: this.state.label,
            };
            await context.execCommand('link', params);
            this.env.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_1__["Layout"]).remove('link');
        });
        this.destroy();
    }
    async cancel() {
        await this.env.editor.execCommand(async () => {
            this.env.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_1__["Layout"]).remove('link');
        });
        this.destroy();
    }
}
LinkComponent.components = {};
LinkComponent.template = 'link';


/***/ }),

/***/ "./packages/plugin-list/assets/checklist.css":
/*!***************************************************!*\
  !*** ./packages/plugin-list/assets/checklist.css ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./checklist.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-list/assets/checklist.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-list/src/List.ts":
/*!******************************************!*\
  !*** ./packages/plugin-list/src/List.ts ***!
  \******************************************/
/*! exports provided: List */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "List", function() { return List; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _ListDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ListDomObjectRenderer */ "./packages/plugin-list/src/ListDomObjectRenderer.ts");
/* harmony import */ var _ListItemAttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ListItemAttributesDomObjectModifierRenderer */ "./packages/plugin-list/src/ListItemAttributesDomObjectModifierRenderer.ts");
/* harmony import */ var _ListXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ListXmlDomParser */ "./packages/plugin-list/src/ListXmlDomParser.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Mode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/src/Mode */ "./packages/core/src/Mode.ts");











class List extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            toggleList: {
                title: 'Toggle list',
                handler: this.toggleList,
            },
            indent: {
                title: 'Indent list items',
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]],
                handler: this.indent,
            },
            outdent: {
                title: 'Outdent list items',
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]],
                handler: this.outdent,
            },
            insertParagraphBreak: {
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"], List.isListItem],
                check: (context) => {
                    const [list, listItem] = context.selector;
                    return !listItem.hasChildren() && listItem === list.lastChild();
                },
                handler: this.insertParagraphBreak,
            },
            toggleChecked: {
                title: 'Check or uncheck list items',
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST],
                handler: this.toggleChecked,
            },
        };
        this.commandHooks = {
            // TODO: replace this with `onSiblingsChange` when we introduce events.
            deleteBackward: this.rejoin.bind(this),
            deleteForward: this.rejoin.bind(this),
        };
        this.loadables = {
            parsers: [_ListXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["ListXmlDomParser"], _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemXmlDomParser"]],
            renderers: [_ListDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["ListDomObjectRenderer"], _ListItemAttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_3__["ListItemAttributesDomObjectModifierRenderer"]],
            shortcuts: [
                {
                    pattern: 'CTRL+SHIFT+<Digit7>',
                    commandId: 'toggleList',
                    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED },
                },
                {
                    pattern: 'CTRL+SHIFT+<Digit8>',
                    commandId: 'toggleList',
                    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED },
                },
                {
                    pattern: 'CTRL+SHIFT+<Digit9>',
                    commandId: 'toggleList',
                    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].CHECKLIST },
                },
                {
                    pattern: 'CTRL+<Space>',
                    commandId: 'toggleChecked',
                },
                {
                    pattern: 'Backspace',
                    selector: [List.isListItem],
                    check: (context) => {
                        return !context.range.start.previousSibling();
                    },
                    commandId: 'outdent',
                },
            ],
            components: [
                {
                    id: 'OrderedListButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_8__["ActionableNode"]({
                            name: 'ordered',
                            label: 'Toggle ordered list',
                            commandId: 'toggleList',
                            commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED },
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const startIsList = List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED, range.start);
                                if (!startIsList || range.isCollapsed()) {
                                    return startIsList;
                                }
                                else {
                                    return List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED, range.end);
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_9__["Attributes"]({ class: 'fa fa-list-ol fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'UnorderedListButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_8__["ActionableNode"]({
                            name: 'unordered',
                            label: 'Toggle unordered list',
                            commandId: 'toggleList',
                            commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED },
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const startIsList = List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED, range.start);
                                if (!startIsList || range.isCollapsed()) {
                                    return startIsList;
                                }
                                else {
                                    return List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED, range.end);
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_9__["Attributes"]({ class: 'fa fa-list-ul fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'ChecklistButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_8__["ActionableNode"]({
                            name: 'checkbox',
                            label: 'Toggle checkbox list',
                            commandId: 'toggleList',
                            commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].CHECKLIST },
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const startIsList = List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].CHECKLIST, range.start);
                                if (!startIsList || range.isCollapsed()) {
                                    return startIsList;
                                }
                                else {
                                    return List.isInList(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].CHECKLIST, range.end);
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_9__["Attributes"]({ class: 'fa far fa-check-square fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [
                ['OrderedListButton', ['actionables']],
                ['UnorderedListButton', ['actionables']],
                ['ChecklistButton', ['actionables']],
            ],
        };
    }
    static isListItem(node) {
        return node.parent && node.parent instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"];
    }
    static isInList(type, node) {
        var _a;
        return ((_a = node === null || node === void 0 ? void 0 : node.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) === null || _a === void 0 ? void 0 : _a.listType) === type;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert/remove a list at range.
     *
     * @param params
     */
    toggleList(params) {
        const type = params.type;
        const bounds = _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].clone(params.context.range);
        const range = new _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"](this.editor, bounds);
        // Extend the range to cover the entirety of its containers.
        if (range.startContainer.hasChildren()) {
            range.setStart(range.startContainer.firstChild());
        }
        if (range.endContainer.hasChildren()) {
            range.setEnd(range.endContainer.lastChild());
        }
        // If all targeted nodes are within a list of given type then unlist
        // them. Otherwise, convert them to the given list type.
        const targetedNodes = range.targetedNodes();
        const ancestors = targetedNodes.map(node => node.closest(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
        const targetedLists = ancestors.filter(list => !!list);
        if (targetedLists.length === targetedNodes.length &&
            targetedLists.every(list => list.listType === type)) {
            // Unlist the targeted nodes from all its list ancestors.
            while (range.start.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
                const nodesToUnlist = range.split(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
                for (const list of nodesToUnlist) {
                    for (const child of list.childVNodes) {
                        // TODO: automatically invalidate `li-attributes`.
                        child.modifiers.remove(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemAttributes"]);
                    }
                    list.unwrap();
                }
            }
        }
        else if (targetedLists.length === targetedNodes.length) {
            // If all nodes are in lists, convert the targeted list
            // nodes to the given list type.
            const lists = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_7__["distinct"])(targetedLists);
            const listsToConvert = lists.filter(l => l.listType !== type);
            for (const list of listsToConvert) {
                let newList = new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: type });
                list.replaceWith(newList);
                // If the new list is after or before a list of the same
                // type, merge them. Example:
                // <ol><li>a</li></ol><ol><li>b</li></ol>
                // => <ol><li>a</li><li>b</li></ol>).
                const previousSibling = newList.previousSibling();
                if (previousSibling && _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type](previousSibling)) {
                    newList.mergeWith(previousSibling);
                    newList = previousSibling;
                }
                const nextSibling = newList.nextSibling();
                if (nextSibling && _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type](nextSibling)) {
                    nextSibling.mergeWith(newList);
                }
            }
        }
        else {
            // If only some nodes are in lists and other aren't then only
            // wrap the ones that were not already in a list into a list of
            // the given type.
            let newList = new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: type });
            const nodesToConvert = range.split(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
            for (const node of nodesToConvert) {
                // Merge top-level lists instead of nesting them.
                if (node instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]) {
                    node.mergeWith(newList);
                }
                else {
                    node.wrap(newList);
                }
            }
            // If the new list is after or before a list of the same type,
            // merge them. Example:
            // <ol><li>a</li></ol><ol><li>b</li></ol>
            // => <ol><li>a</li><li>b</li></ol>).
            const previousSibling = newList.previousSibling();
            if (previousSibling && _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type](previousSibling)) {
                newList.mergeWith(previousSibling);
                newList = previousSibling;
            }
            const nextSibling = newList.nextSibling();
            if (nextSibling && _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type](nextSibling)) {
                nextSibling.mergeWith(newList);
            }
        }
        range.remove();
    }
    /**
     * Indent one or more list items.
     *
     * @param params
     */
    indent(params) {
        const range = params.context.range;
        const items = range.targetedNodes(node => node.parent instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        // Do not indent items of a targeted nested list, since they
        // will automatically be indented with their list ancestor.
        const itemsToIndent = items.filter(item => {
            return !items.includes(item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
        });
        for (const item of itemsToIndent) {
            const prev = item.previousSibling();
            const next = item.nextSibling();
            // Indent the item by putting it into a pre-existing list sibling.
            if (prev && prev instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]) {
                prev.append(item);
                // The two list siblings might be rejoinable now that the lower
                // level item breaking them into two different lists is no more.
                const listType = prev.listType;
                if (_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][listType](next) && !itemsToIndent.includes(next)) {
                    next.mergeWith(prev);
                }
            }
            else if (next instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"] && !itemsToIndent.includes(next)) {
                next.prepend(item);
            }
            else {
                // If no other candidate exists then wrap it in a new ListNode.
                const listType = item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]).listType;
                item.wrap(new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: listType }));
            }
        }
    }
    /**
     * Outdent one or more list items.
     *
     * @param params
     */
    outdent(params) {
        const range = params.context.range;
        const items = range.targetedNodes(node => node.parent instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        // Do not outdent items of a targeted nested list, since they
        // will automatically be outdented with their list ancestor.
        const itemsToOutdent = items.filter(item => {
            return !items.includes(item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
        });
        for (const item of itemsToOutdent) {
            const list = item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
            const previousSibling = item.previousSibling();
            const nextSibling = item.nextSibling();
            if (this.editor.mode.is(list, _core_src_Mode__WEBPACK_IMPORTED_MODULE_10__["RuleProperty"].BREAKABLE)) {
                if (previousSibling && nextSibling) {
                    const splitList = item.parent.splitAt(item);
                    splitList.before(item);
                }
                else if (previousSibling) {
                    list.after(item);
                }
                else if (nextSibling) {
                    list.before(item);
                }
                else {
                    for (const child of list.childVNodes) {
                        // TODO: automatically invalidate `li-attributes`.
                        child.modifiers.remove(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemAttributes"]);
                    }
                    list.unwrap();
                }
            }
        }
    }
    /**
     * Insert a paragraph break in the last empty item of a list by unwrapping
     * the list item from the list, thus becoming the new paragraph.
     *
     * @param params
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        const listItem = range.startContainer;
        const listNode = listItem.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        if (listNode.children().length === 1) {
            listNode.unwrap();
        }
        else {
            listNode.after(listItem);
        }
    }
    /**
     * Rejoin same type lists that are now direct siblings after the remove.
     *
     * @param params
     */
    rejoin(params) {
        const range = params.context.range;
        const listAncestors = range.start.ancestors(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        if (listAncestors.length) {
            let list = listAncestors[listAncestors.length - 1];
            let nextSibling = list && list.nextSibling();
            while (list &&
                nextSibling &&
                list instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"] &&
                _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][list.listType](nextSibling)) {
                const nextList = list.lastChild();
                const nextListSibling = nextSibling.firstChild();
                nextSibling.mergeWith(list);
                list = nextList;
                nextSibling = nextListSibling;
            }
        }
    }
    /**
     * Check or uncheck the list items at range.
     *
     * @param params
     */
    toggleChecked(params) {
        const range = params.context.range;
        const items = range.targetedNodes(node => _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST(node.parent));
        const areAllChecked = items.every(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].isChecked);
        for (const item of items) {
            if (areAllChecked) {
                _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].uncheck(item);
            }
            else {
                _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].check(item);
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-list/src/ListDomObjectRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-list/src/ListDomObjectRenderer.ts ***!
  \***********************************************************/
/*! exports provided: ListDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListDomObjectRenderer", function() { return ListDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _assets_checklist_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../assets/checklist.css */ "./packages/plugin-list/assets/checklist.css");
/* harmony import */ var _assets_checklist_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_assets_checklist_css__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");






class ListDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"];
    }
    async render(listNode, worker) {
        const list = {
            tag: listNode.listType === _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED ? 'OL' : 'UL',
            children: [],
        };
        if (_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST(listNode)) {
            list.attributes = { class: new Set(['checklist']) };
        }
        const children = listNode.children();
        const domObjects = await worker.render(children);
        for (const index in children) {
            list.children.push(this._renderLi(listNode, children[index], domObjects[index], worker));
        }
        return list;
    }
    _renderLi(listNode, listItem, rendering, worker) {
        let li;
        // The node was wrapped in a "LI" but needs to be rendered as well.
        if ('tag' in rendering && rendering.tag === 'P' && !rendering.shadowRoot) {
            // Direct ListNode's VElement children "P" are rendered as "LI"
            // while other nodes will be rendered inside the "LI".
            li = rendering;
            li.tag = 'LI';
        }
        else if ('dom' in rendering && rendering.dom[0].nodeName === 'LI') {
            // If there is no child-specific renderer, the default renderer
            // is used. This takes the result of the Dom renderer which
            // itself wrap the children in LI.
            rendering.dom = [...rendering.dom[0].childNodes];
            li = {
                tag: 'LI',
                children: [rendering],
            };
            // Mark as origin. If the listItem or the listNode change, the other are invalidate.
            worker.depends(listItem, li);
            worker.depends(li, listItem);
        }
        else {
            li = {
                tag: 'LI',
                children: [listItem],
            };
            // Mark as dependent. If the listItem change, the listNode are invalidate. But if the
            // list change, the listItem will not invalidate.
            worker.depends(li, listItem);
        }
        worker.depends(li, listNode);
        worker.depends(listNode, li);
        // Render the node's attributes that were stored on the technical key
        // that specifies those attributes belong on the list item.
        this.engine.renderAttributes(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemAttributes"], listItem, li, worker);
        if (listNode.listType === _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED) {
            // Adapt numbering to skip previous list item
            // Source: https://stackoverflow.com/a/12860083
            const previousIdentedList = listItem.previousSibling();
            if (previousIdentedList instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]) {
                const previousLis = previousIdentedList.previousSiblings(sibling => !(sibling instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
                const value = Math.max(previousLis.length, 1) + 1;
                li.attributes.value = value.toString();
            }
        }
        if (listItem instanceof _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]) {
            const style = li.attributes.style || {};
            if (!style['list-style']) {
                style['list-style'] = 'none';
            }
            li.attributes.style = style;
            if (_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST(listItem)) {
                const prev = listItem.previousSibling();
                if (prev && !_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST(prev)) {
                    // Add dependencie to check/uncheck with previous checklist item used as title.
                    worker.depends(prev, listItem);
                    worker.depends(listItem, prev);
                }
            }
        }
        else if (_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].CHECKLIST(listNode)) {
            // Add dependencie because the modifier on the listItem change the li rendering.
            worker.depends(li, listItem);
            worker.depends(listItem, listNode);
            const className = _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"].isChecked(listItem) ? 'checked' : 'unchecked';
            if (li.attributes.class) {
                li.attributes.class.add(className);
            }
            else {
                li.attributes.class = new Set([className]);
            }
            // Handle click in the checkbox.
            const handlerMouseDown = (ev) => {
                if (ev.offsetX < 0) {
                    ev.stopImmediatePropagation();
                    ev.preventDefault();
                    this.engine.editor.execCommand(() => {
                        return this.engine.editor.execWithRange(_core_src_VRange__WEBPACK_IMPORTED_MODULE_4__["VRange"].at(listItem.firstChild() || listItem), 'toggleChecked');
                    });
                }
            };
            li.attach = (el) => {
                el.addEventListener('mousedown', handlerMouseDown);
            };
            li.detach = (el) => {
                el.removeEventListener('mousedown', handlerMouseDown);
            };
        }
        return li;
    }
}
ListDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListItemAttributesDomObjectModifierRenderer.ts":
/*!*********************************************************************************!*\
  !*** ./packages/plugin-list/src/ListItemAttributesDomObjectModifierRenderer.ts ***!
  \*********************************************************************************/
/*! exports provided: ListItemAttributesDomObjectModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemAttributesDomObjectModifierRenderer", function() { return ListItemAttributesDomObjectModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");



class ListItemAttributesDomObjectModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["ListItemAttributes"];
    }
    /**
     * Rendering for ListItemAttributes Modifier.
     *
     * @param format
     * @param contents
     */
    async render(format, contents) {
        return contents;
    }
}
ListItemAttributesDomObjectModifierRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListItemXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-list/src/ListItemXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ListItemAttributes, ListItemXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemAttributes", function() { return ListItemAttributes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemXmlDomParser", function() { return ListItemXmlDomParser; });
/* harmony import */ var _utils_src_isBlock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");






class ListItemAttributes extends _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"] {
}
class ListItemXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(item) === 'LI';
        };
    }
    /**
     * Parse a list element (LI).
     *
     * @param context
     */
    async parse(item) {
        const children = Array.from(item.childNodes);
        const nodes = [];
        let inlinesContainer;
        // Parse the list item's attributes into the node's ListItemAttributes,
        // which will be read only by ListItemDomRenderer.
        const itemModifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            itemModifiers.append(attributes);
        }
        const Container = this.engine.editor.configuration.defaults.Container;
        for (let childIndex = 0; childIndex < children.length; childIndex++) {
            const domChild = children[childIndex];
            const parsedChild = await this.engine.parse(domChild);
            if (parsedChild.length) {
                if (this._isInlineListItem(domChild)) {
                    // Contiguous inline elements in a list item should be
                    // wrapped together in a base container.
                    if (!inlinesContainer) {
                        inlinesContainer = new Container();
                        const attributes = itemModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
                        attributes.remove('value');
                        inlinesContainer.modifiers.append(new ListItemAttributes(attributes));
                        nodes.push(inlinesContainer);
                    }
                    inlinesContainer.append(...parsedChild);
                }
                else {
                    if (inlinesContainer && !['UL', 'OL'].includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(domChild))) {
                        inlinesContainer.append(...parsedChild);
                    }
                    else {
                        inlinesContainer = null; // Close the inlinesContainer.
                        for (const child of parsedChild) {
                            const attributes = itemModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
                            attributes.remove('value');
                            child.modifiers.set(new ListItemAttributes(attributes));
                        }
                        nodes.push(...parsedChild);
                    }
                }
            }
        }
        // A list item with children but whose parsing returned nothing should
        // be parsed as an empty base container. Eg: <li><br/></li>: li has a
        // child so it will not return [] above (and therefore be ignored), but
        // br will parse to nothing because it's a placeholder br, not a real
        // line break. We cannot ignore that li because it does in fact exist so
        // we parse it as an empty base container.
        if (nodes.length) {
            return nodes;
        }
        else {
            const container = new Container();
            container.modifiers.append(new ListItemAttributes(itemModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])));
            return [container];
        }
    }
    /**
     * Return true if the given node is an inline list item.
     *
     * @param item
     */
    _isInlineListItem(item) {
        return item && (!Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_0__["isBlock"])(item) || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(item) === 'BR');
    }
}
ListItemXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-list/src/ListNode.ts ***!
  \**********************************************/
/*! exports provided: ListType, IsChecked, ListNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListType", function() { return ListType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IsChecked", function() { return IsChecked; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListNode", function() { return ListNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");


var ListType;
(function (ListType) {
    ListType["ORDERED"] = "ORDERED";
    ListType["UNORDERED"] = "UNORDERED";
    ListType["CHECKLIST"] = "CHECKLIST";
})(ListType || (ListType = {}));
class IsChecked extends _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__["Modifier"] {
}
class ListNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super(params);
        this.listType = params.listType;
    }
    // Typescript currently doesn't support using enum as keys in interfaces.
    // Source: https://github.com/microsoft/TypeScript/issues/13042
    static ORDERED(node) {
        return node && node instanceof ListNode && node.listType === ListType.ORDERED;
    }
    static UNORDERED(node) {
        return node && node instanceof ListNode && node.listType === ListType.UNORDERED;
    }
    static CHECKLIST(node) {
        return node && node instanceof ListNode && node.listType === ListType.CHECKLIST;
    }
    get name() {
        return super.name + ': ' + this.listType;
    }
    /**
     * Return true if the given node is a checked checklist or checklist item.
     *
     * @param node
     */
    static isChecked(node) {
        if (ListNode.CHECKLIST(node) && node.hasChildren()) {
            // If the node is a populated checklist, it is checked in the case
            // that every one of its children is checked.
            return node.children().every(ListNode.isChecked);
        }
        else {
            const indentedChild = node.nextSibling();
            if (ListNode.CHECKLIST(indentedChild)) {
                // If the next list item is a checklist, this list item is its
                // title, which is checked if said checklist's children are
                // checked.
                return ListNode.isChecked(indentedChild);
            }
            else {
                return !!node.modifiers.find(IsChecked);
            }
        }
    }
    /**
     * Set the given nodes as checked.
     *
     * @param nodes
     */
    static check(...nodes) {
        for (const node of nodes) {
            if (node instanceof ListNode) {
                // Check the list's children.
                ListNode.check(...node.children());
            }
            else {
                // Check the node itself otherwise.
                node.modifiers.set(IsChecked);
                // Propagate to next indented list if any.
                const indentedChild = node.nextSibling();
                if (indentedChild && indentedChild instanceof ListNode) {
                    ListNode.check(indentedChild);
                }
            }
        }
    }
    /**
     * Set the given nodes as unchecked.
     *
     * @param nodes
     */
    static uncheck(...nodes) {
        for (const node of nodes) {
            if (node instanceof ListNode) {
                // Uncheck the list's children.
                ListNode.uncheck(...node.children());
            }
            else {
                // Uncheck the node.
                node.modifiers.remove(IsChecked);
                // Propagate to next indented list.
                const indentedChild = node.nextSibling();
                if (indentedChild && indentedChild instanceof ListNode) {
                    ListNode.uncheck(indentedChild);
                }
            }
        }
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            listType: this.listType,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
}


/***/ }),

/***/ "./packages/plugin-list/src/ListXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-list/src/ListXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: ListXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListXmlDomParser", function() { return ListXmlDomParser; });
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");





const listTags = ['UL', 'OL'];
class ListXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && listTags.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    /**
     * Parse a list (UL, OL) and its children list elements (LI).
     *
     * @param context
     */
    async parse(item) {
        // Get the list's type (ORDERED, UNORDERED, CHECKLIST).
        let type;
        if (item.className.match(/(^| )checklist( |$)/i)) {
            type = _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].CHECKLIST;
        }
        else {
            type = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'UL' ? _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].UNORDERED : _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].ORDERED;
        }
        // Create the list node and parse its children and attributes.
        const list = new _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListNode"]({ listType: type });
        const attributes = this.engine.parseAttributes(item);
        if (type === _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].CHECKLIST) {
            attributes.classList.remove('checklist');
        }
        if (attributes.length) {
            list.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        list.append(...children);
        // In the case of a checklist, parse their checked/unchecked status and
        // ensure vertical propagation.
        if (type === _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].CHECKLIST) {
            for (const child of children) {
                const liAttributes = child.modifiers.find(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["ListItemAttributes"]);
                if (liAttributes) {
                    // Parse the list item's checked status.
                    if (liAttributes.classList.has('checked')) {
                        _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListNode"].check(child);
                    }
                    // Remove the checklist-related classes from `liAttributes`.
                    liAttributes.classList.remove('checklist checked unchecked');
                }
            }
        }
        return [list];
    }
}
ListXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-metadata/src/MetaDataDomObjectRenderer.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-metadata/src/MetaDataDomObjectRenderer.ts ***!
  \*******************************************************************/
/*! exports provided: MetadataDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataDomObjectRenderer", function() { return MetadataDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _MetadataNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");



class MetadataDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _MetadataNode__WEBPACK_IMPORTED_MODULE_2__["MetadataNode"];
    }
    async render(node) {
        const meta = {
            tag: node.htmlTag,
            children: [{ text: node.contents }],
        };
        return meta;
    }
}
MetadataDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-metadata/src/Metadata.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-metadata/src/Metadata.ts ***!
  \**************************************************/
/*! exports provided: Metadata */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Metadata", function() { return Metadata; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _MetadataXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MetadataXmlDomParser */ "./packages/plugin-metadata/src/MetadataXmlDomParser.ts");
/* harmony import */ var _MetaDataDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetaDataDomObjectRenderer */ "./packages/plugin-metadata/src/MetaDataDomObjectRenderer.ts");



class Metadata extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_MetadataXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["MetadataXmlDomParser"]],
            renderers: [_MetaDataDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["MetadataDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-metadata/src/MetadataNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-metadata/src/MetadataNode.ts ***!
  \******************************************************/
/*! exports provided: MetadataNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataNode", function() { return MetadataNode; });
/* harmony import */ var _core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/MarkerNode */ "./packages/core/src/VNodes/MarkerNode.ts");

class MetadataNode extends _core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__["MarkerNode"] {
    constructor(params) {
        super(params);
        this.contents = '';
        this.htmlTag = params.htmlTag;
    }
    get name() {
        return this.constructor.name + ': ' + this.htmlTag;
    }
}
MetadataNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-metadata/src/MetadataXmlDomParser.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-metadata/src/MetadataXmlDomParser.ts ***!
  \**************************************************************/
/*! exports provided: MetadataXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataXmlDomParser", function() { return MetadataXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _MetadataNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




// See https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Metadata_content
const METADATA_NODENAMES = [
    'BASE',
    'COMMAND',
    'LINK',
    'META',
    'NOSCRIPT',
    'SCRIPT',
    'STYLE',
    'TITLE',
];
class MetadataXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && METADATA_NODENAMES.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    async parse(item) {
        const technical = new _MetadataNode__WEBPACK_IMPORTED_MODULE_2__["MetadataNode"]({ htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) });
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            technical.modifiers.append(attributes);
        }
        technical.contents = item.innerHTML;
        return [technical];
    }
}
MetadataXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooField.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooField.ts ***!
  \*****************************************************/
/*! exports provided: fieldValidators, OdooField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fieldValidators", function() { return fieldValidators; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooField", function() { return OdooField; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _OdooFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooFieldDomObjectRenderer */ "./packages/plugin-odoo-field/src/OdooFieldDomObjectRenderer.ts");
/* harmony import */ var _OdooFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooFieldXmlDomParser */ "./packages/plugin-odoo-field/src/OdooFieldXmlDomParser.ts");
/* harmony import */ var _utils_src_ReactiveValue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/ReactiveValue */ "./packages/utils/src/ReactiveValue.ts");
/* harmony import */ var _OdooFieldMap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./OdooFieldMap */ "./packages/plugin-odoo-field/src/OdooFieldMap.ts");
/* harmony import */ var _OdooMonetaryFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./OdooMonetaryFieldXmlDomParser */ "./packages/plugin-odoo-field/src/OdooMonetaryFieldXmlDomParser.ts");
/* harmony import */ var _OdooMonetaryFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./OdooMonetaryFieldDomObjectRenderer */ "./packages/plugin-odoo-field/src/OdooMonetaryFieldDomObjectRenderer.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");








/**
 * Regex used to validate a field.
 */
const fieldValidators = {
    integer: /^[0-9]+$/,
    float: /^[0-9.,]+$/,
    monetary: /^[0-9.,]+$/,
};
class OdooField extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_OdooFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["OdooFieldXmlDomParser"], _OdooMonetaryFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["OdooMonetaryFieldXmlDomParser"]],
            renderers: [_OdooMonetaryFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__["OdooMonetaryFieldDomObjectRenderer"], _OdooFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__["OdooFieldDomObjectRenderer"]],
        };
        this._registry = new _OdooFieldMap__WEBPACK_IMPORTED_MODULE_4__["OdooFieldMap"]();
    }
    /**
     * Register an Odoo record.
     *
     * No need to get the inforation from the network if it is already present
     * in the document when parsed by the editor.
     *
     * Create two `ReactiveValue`. One that represent the actual value of the
     * `recordDefinition` and the other represent the validity of the value.
     *
     * See `get` to retrieve the values from an `OdooFieldInfo`.
     */
    register(field, type, value) {
        if (!this._registry.get(field)) {
            // TODO: Retrieve the field from Odoo through RPC.
            const reactiveValue = new _utils_src_ReactiveValue__WEBPACK_IMPORTED_MODULE_3__["ReactiveValue"]();
            const isValid = new _utils_src_ReactiveValue__WEBPACK_IMPORTED_MODULE_3__["ReactiveValue"](true);
            if (Object.keys(fieldValidators).includes(type)) {
                reactiveValue.on('set', (newValue) => {
                    isValid.set(!!newValue.match(fieldValidators[type]));
                });
            }
            reactiveValue.set(value);
            const reactiveOdooField = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_7__["makeVersionable"])(Object.assign(Object.assign({}, field), { value: reactiveValue, isValid }));
            this._registry.set(field, reactiveOdooField);
        }
        return this._registry.get(field);
    }
    /**
     * Retrieve reactive values by providing an `OdooFieldDefinition`.
     *
     * @param field
     */
    get(field) {
        const reactiveOdooField = this._registry.get(field);
        if (!reactiveOdooField) {
            // TODO: Retrieve the field from Odoo through RPC.
            throw new Error(`Impossible to find the field ${field.fieldName} for model ${field.modelId} with id ${field.modelId}.`);
        }
        return reactiveOdooField;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooFieldDomObjectRenderer.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooFieldDomObjectRenderer.ts ***!
  \**********************************************************************/
/*! exports provided: OdooFieldDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooFieldDomObjectRenderer", function() { return OdooFieldDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _OdooFieldNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooFieldNode */ "./packages/plugin-odoo-field/src/OdooFieldNode.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");




class OdooFieldDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _OdooFieldNode__WEBPACK_IMPORTED_MODULE_1__["OdooFieldNode"];
    }
    async render(node) {
        const domObject = { tag: node.htmlTag };
        await this._renderValue(node, domObject);
        return domObject;
    }
    /**
     * Render the value of the given field node into the given container.
     *
     * @param node
     * @param container
     */
    async _renderValue(node, container) {
        // TODO CHM: not having default values is cumbersome
        const children = container.children || [];
        const renderedChildren = await this.engine.renderChildren(node);
        children.push(...renderedChildren);
        container.children = children;
        // TODO CHM: not having default values is cumbersome
        container.attributes = container.attributes || {};
        const classList = container.attributes.class || new Set();
        // Instances of the field containing the range are artificially focused.
        const focusedField = this.engine.editor.selection.range.start.ancestor(ancestor => ancestor instanceof _OdooFieldNode__WEBPACK_IMPORTED_MODULE_1__["OdooFieldNode"] &&
            ancestor.fieldInfo.value === node.fieldInfo.value);
        if (focusedField) {
            classList.add('jw-focus');
        }
        classList.add('jw-odoo-field');
        if (!node.fieldInfo.isValid.get()) {
            classList.add('jw-odoo-field-invalid');
        }
        if (!node.descendants(_core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_2__["AtomicNode"]).length) {
            classList.add('jw-odoo-field-empty');
        }
        container.attributes.class = classList;
    }
}
OdooFieldDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooFieldMap.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooFieldMap.ts ***!
  \********************************************************/
/*! exports provided: OdooFieldMap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooFieldMap", function() { return OdooFieldMap; });
class OdooFieldMap extends Map {
    static hash(field) {
        return `${field.modelId}-${field.recordId}-${field.fieldName}`;
    }
    get(key) {
        let hashedKey;
        if (typeof key === 'string') {
            hashedKey = key;
        }
        else {
            hashedKey = OdooFieldMap.hash(key);
        }
        return super.get(hashedKey);
    }
    set(key, value) {
        let hashedKey;
        if (typeof key === 'string') {
            hashedKey = key;
        }
        else {
            hashedKey = OdooFieldMap.hash(key);
        }
        super.set(hashedKey, value);
        return this;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooFieldNode.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooFieldNode.ts ***!
  \*********************************************************/
/*! exports provided: OdooFieldNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooFieldNode", function() { return OdooFieldNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");


class OdooFieldNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super(params);
        this.fieldInfo = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(params.fieldInfo);
    }
    /**
     * Return a new VNode with the same type and attributes as this OdooFieldNode.
     */
    clone(deepClone, params) {
        const defaults = {
            htmlTag: this.htmlTag,
            fieldInfo: this.fieldInfo,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooFieldXmlDomParser.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooFieldXmlDomParser.ts ***!
  \*****************************************************************/
/*! exports provided: OdooFieldXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooFieldXmlDomParser", function() { return OdooFieldXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _OdooFieldNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooFieldNode */ "./packages/plugin-odoo-field/src/OdooFieldNode.ts");
/* harmony import */ var _OdooField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./OdooField */ "./packages/plugin-odoo-field/src/OdooField.ts");
/* harmony import */ var _OdooFieldMap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./OdooFieldMap */ "./packages/plugin-odoo-field/src/OdooFieldMap.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");






class OdooFieldXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return (item instanceof Element &&
                item.attributes['data-oe-type'] &&
                item.attributes['data-oe-model'] &&
                (item.attributes['data-oe-type'].value === 'char' ||
                    item.attributes['data-oe-type'].value === 'text' ||
                    item.attributes['data-oe-type'].value === 'html' ||
                    item.attributes['data-oe-type'].value === 'float' ||
                    item.attributes['data-oe-type'].value === 'integer'));
            // TODO: Handle those fields when their dependecies are met.
            // item.attributes['data-oe-type'].value === 'many2one' ||
            // item.attributes['data-oe-type'].value === 'date' ||
            // item.attributes['data-oe-type'].value === 'datetime'
            // item.attributes['data-oe-type'].value === 'image' ||
            // item.attributes['data-oe-type'].value === 'contact'
        };
        this._reactiveChanges = new _OdooFieldMap__WEBPACK_IMPORTED_MODULE_4__["OdooFieldMap"]();
    }
    async parse(element) {
        const field = {
            modelId: element.attributes['data-oe-model'].value,
            recordId: element.attributes['data-oe-id'].value,
            fieldName: element.attributes['data-oe-field'].value,
        };
        // data-oe-type is kind of a widget in Odoo.
        const fieldType = element.attributes['data-oe-type'].value;
        const fieldsRegistry = this.engine.editor.plugins.get(_OdooField__WEBPACK_IMPORTED_MODULE_3__["OdooField"]);
        const value = this._parseValue(element);
        const fieldInfo = fieldsRegistry.register(field, fieldType, value);
        const fieldNode = await this._parseField(element, fieldInfo);
        fieldNode.modifiers.append(this.engine.parseAttributes(element));
        // TODO: Remove the mute mechanism when changes come from memory.
        // This prevent cycling when regenerating children after a value change.
        let mute = false;
        fieldNode.on('childList', async () => {
            if (mute)
                return;
            this._reactiveChanges.set(fieldNode.fieldInfo, fieldNode);
            fieldNode.fieldInfo.value.set(this._parseValue(fieldNode));
        });
        // TODO: Replace this value listening mechanism by mirror nodes.
        fieldNode.fieldInfo.value.on('set', () => {
            // TODO: Retrieving the node that made the change is a slight hack
            // that will be removed when mirror nodes are available.
            const original = this._reactiveChanges.get(fieldNode.fieldInfo);
            if (fieldNode === original)
                return;
            mute = true;
            fieldNode.empty();
            fieldNode.append(...original.children().map(child => child.clone(true)));
            mute = false;
        });
        return [fieldNode];
    }
    /**
     * Get an `OdooFieldNode` from an element and a ReactiveValue.
     *
     * @param element
     * @param fieldInfo
     */
    async _parseField(element, fieldInfo) {
        const fieldNode = new _OdooFieldNode__WEBPACK_IMPORTED_MODULE_2__["OdooFieldNode"]({ htmlTag: element.tagName, fieldInfo });
        const children = await this.engine.parse(...element.childNodes);
        fieldNode.append(...children);
        return fieldNode;
    }
    _parseValue(source) {
        if (source instanceof Element) {
            return source.innerHTML;
        }
        else {
            const chars = source.descendants(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_5__["CharNode"]).map(child => child.char);
            return chars.join('');
        }
    }
}
OdooFieldXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooMonetaryFieldDomObjectRenderer.ts":
/*!******************************************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooMonetaryFieldDomObjectRenderer.ts ***!
  \******************************************************************************/
/*! exports provided: OdooMonetaryFieldDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooMonetaryFieldDomObjectRenderer", function() { return OdooMonetaryFieldDomObjectRenderer; });
/* harmony import */ var _OdooFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OdooFieldDomObjectRenderer */ "./packages/plugin-odoo-field/src/OdooFieldDomObjectRenderer.ts");
/* harmony import */ var _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooMonetaryFieldNode */ "./packages/plugin-odoo-field/src/OdooMonetaryFieldNode.ts");


class OdooMonetaryFieldDomObjectRenderer extends _OdooFieldDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__["OdooFieldDomObjectRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__["OdooMonetaryFieldNode"];
    }
    async _renderValue(node, container) {
        const valueContainer = {
            tag: 'span',
            attributes: {
                class: new Set(['oe_currency_value']),
            },
        };
        // TODO CHM: not having default values is cumbersome
        const children = container.children || [];
        children.push(valueContainer);
        const currency = { text: node.fieldInfo.currencyValue };
        if (node.fieldInfo.currencyPosition === _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__["CurrencyPosition"].BEFORE) {
            children.unshift(currency);
        }
        else {
            children.push(currency);
        }
        container.children = children;
        await super._renderValue(node, valueContainer);
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooMonetaryFieldNode.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooMonetaryFieldNode.ts ***!
  \*****************************************************************/
/*! exports provided: CurrencyPosition, OdooMonetaryFieldNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CurrencyPosition", function() { return CurrencyPosition; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooMonetaryFieldNode", function() { return OdooMonetaryFieldNode; });
/* harmony import */ var _OdooFieldNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OdooFieldNode */ "./packages/plugin-odoo-field/src/OdooFieldNode.ts");

var CurrencyPosition;
(function (CurrencyPosition) {
    CurrencyPosition["BEFORE"] = "BEFORE";
    CurrencyPosition["AFTER"] = "AFTER";
})(CurrencyPosition || (CurrencyPosition = {}));
class OdooMonetaryFieldNode extends _OdooFieldNode__WEBPACK_IMPORTED_MODULE_0__["OdooFieldNode"] {
}


/***/ }),

/***/ "./packages/plugin-odoo-field/src/OdooMonetaryFieldXmlDomParser.ts":
/*!*************************************************************************!*\
  !*** ./packages/plugin-odoo-field/src/OdooMonetaryFieldXmlDomParser.ts ***!
  \*************************************************************************/
/*! exports provided: OdooMonetaryFieldXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooMonetaryFieldXmlDomParser", function() { return OdooMonetaryFieldXmlDomParser; });
/* harmony import */ var _OdooFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OdooFieldXmlDomParser */ "./packages/plugin-odoo-field/src/OdooFieldXmlDomParser.ts");
/* harmony import */ var _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooMonetaryFieldNode */ "./packages/plugin-odoo-field/src/OdooMonetaryFieldNode.ts");


// TODO: retrieve the current decimal of the current lang in odoo
// const localDecimalSeparator = '.';
class OdooMonetaryFieldXmlDomParser extends _OdooFieldXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["OdooFieldXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return (item instanceof Element &&
                item.attributes['data-oe-type'] &&
                item.attributes['data-oe-model'] &&
                item.attributes['data-oe-type'].value === 'monetary');
        };
    }
    async _parseField(element, fieldInfo) {
        const amountElement = element.querySelector('.oe_currency_value');
        const currencyElement = amountElement.previousSibling || amountElement.nextSibling;
        const fieldNode = new _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__["OdooMonetaryFieldNode"]({
            htmlTag: element.tagName,
            fieldInfo: Object.assign(Object.assign({}, fieldInfo), { currencyValue: currencyElement.textContent, currencyPosition: amountElement.previousSibling
                    ? _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__["CurrencyPosition"].BEFORE
                    : _OdooMonetaryFieldNode__WEBPACK_IMPORTED_MODULE_1__["CurrencyPosition"].AFTER }),
        });
        const childNodesToParse = amountElement.childNodes;
        const children = await this.engine.parse(...childNodesToParse);
        fieldNode.append(...children);
        return fieldNode;
    }
    _parseValue(source) {
        if (source instanceof Element) {
            const amountElement = source.querySelector('.oe_currency_value');
            return amountElement.textContent;
        }
        else {
            return super._parseValue(source);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-video/src/OdooVideo.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-odoo-video/src/OdooVideo.ts ***!
  \*****************************************************/
/*! exports provided: OdooVideo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideo", function() { return OdooVideo; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _OdooVideoXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooVideoXmlDomParser */ "./packages/plugin-odoo-video/src/OdooVideoXmlDomParser.ts");
/* harmony import */ var _OdooVideoDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooVideoDomObjectRenderer */ "./packages/plugin-odoo-video/src/OdooVideoDomObjectRenderer.ts");



class OdooVideo extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_OdooVideoXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["OdooVideoXmlDomParser"]],
            renderers: [_OdooVideoDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["OdooVideoHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-video/src/OdooVideoDomObjectRenderer.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-odoo-video/src/OdooVideoDomObjectRenderer.ts ***!
  \**********************************************************************/
/*! exports provided: OdooVideoHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoHtmlDomRenderer", function() { return OdooVideoHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _OdooVideoNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooVideoNode */ "./packages/plugin-odoo-video/src/OdooVideoNode.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");




class OdooVideoHtmlDomRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _OdooVideoNode__WEBPACK_IMPORTED_MODULE_1__["OdooVideoNode"];
    }
    async render(node) {
        const setSelection = () => {
            this.engine.editor.execCommand('setSelection', {
                vSelection: {
                    anchorNode: node,
                    direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD,
                },
            });
        };
        const openMedia = () => {
            this.engine.editor.execCommand('openMedia');
        };
        const wrapper = {
            tag: 'DIV',
            attributes: {
                class: new Set(['media_iframe_video']),
                'data-oe-expression': node.src,
            },
            children: [
                {
                    tag: 'DIV',
                    attributes: { class: new Set(['css_editable_mode_display']) },
                    children: [{ text: '\u00A0' }],
                    attach: (el) => {
                        el.addEventListener('click', setSelection);
                        el.addEventListener('dblclick', openMedia);
                    },
                    detach: (el) => {
                        el.removeEventListener('click', setSelection);
                        el.removeEventListener('dblclick', openMedia);
                    },
                },
                {
                    tag: 'DIV',
                    attributes: { class: new Set(['media_iframe_video_size']) },
                    children: [{ text: '\u00A0' }],
                },
                {
                    tag: 'IFRAME',
                    attributes: {
                        src: node.src,
                        frameborder: '0',
                        allowfullscreen: 'allowfullscreen',
                    },
                },
            ],
        };
        return wrapper;
    }
}
OdooVideoHtmlDomRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-video/src/OdooVideoNode.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-odoo-video/src/OdooVideoNode.ts ***!
  \*********************************************************/
/*! exports provided: OdooVideoNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoNode", function() { return OdooVideoNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class OdooVideoNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super(params);
        this.src = params.src;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-video/src/OdooVideoXmlDomParser.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-odoo-video/src/OdooVideoXmlDomParser.ts ***!
  \*****************************************************************/
/*! exports provided: OdooVideoXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoXmlDomParser", function() { return OdooVideoXmlDomParser; });
/* harmony import */ var _OdooVideoNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OdooVideoNode */ "./packages/plugin-odoo-video/src/OdooVideoNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class OdooVideoXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => {
            const isVideo = node instanceof Element &&
                Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(node) === 'DIV' &&
                node.classList.contains('media_iframe_video') &&
                node.attributes['data-oe-expression'] &&
                node.attributes['data-oe-expression'].value;
            return isVideo;
        };
    }
    async parse(element) {
        const video = new _OdooVideoNode__WEBPACK_IMPORTED_MODULE_0__["OdooVideoNode"]({ src: element.attributes['data-oe-expression'].value });
        video.modifiers.append(this.engine.parseAttributes(element));
        return [video];
    }
}
OdooVideoXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo/src/Odoo.ts":
/*!******************************************!*\
  !*** ./packages/plugin-odoo/src/Odoo.ts ***!
  \******************************************/
/*! exports provided: OdooPaddingClasses, OdooImageClasses, Odoo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooPaddingClasses", function() { return OdooPaddingClasses; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooImageClasses", function() { return OdooImageClasses; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Odoo", function() { return Odoo; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-link/src/LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-link/src/Link */ "./packages/plugin-link/src/Link.ts");
/* harmony import */ var _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-xml/src/Xml */ "./packages/plugin-xml/src/Xml.ts");
/* harmony import */ var _OdooStructureXmlDomParser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./OdooStructureXmlDomParser */ "./packages/plugin-odoo/src/OdooStructureXmlDomParser.ts");
/* harmony import */ var _OdooImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./OdooImageDomObjectRenderer */ "./packages/plugin-odoo/src/OdooImageDomObjectRenderer.ts");
/* harmony import */ var _OdooFontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./OdooFontAwesomeDomObjectRenderer */ "./packages/plugin-odoo/src/OdooFontAwesomeDomObjectRenderer.ts");
/* harmony import */ var _OdooTranslationXmlDomParser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./OdooTranslationXmlDomParser */ "./packages/plugin-odoo/src/OdooTranslationXmlDomParser.ts");
/* harmony import */ var _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../plugin-divider/src/DividerNode */ "./packages/plugin-divider/src/DividerNode.ts");
/* harmony import */ var _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../plugin-image/src/ImageNode */ "./packages/plugin-image/src/ImageNode.ts");














var OdooPaddingClasses;
(function (OdooPaddingClasses) {
    OdooPaddingClasses["NONE"] = "padding-none";
    OdooPaddingClasses["SMALL"] = "padding-small";
    OdooPaddingClasses["MEDIUM"] = "padding-medium";
    OdooPaddingClasses["LARGE"] = "padding-large";
    OdooPaddingClasses["XL"] = "padding-xl";
})(OdooPaddingClasses || (OdooPaddingClasses = {}));
const paddingClassesLabels = {
    [OdooPaddingClasses.NONE]: 'None',
    [OdooPaddingClasses.SMALL]: 'Small',
    [OdooPaddingClasses.MEDIUM]: 'Medium',
    [OdooPaddingClasses.LARGE]: 'Large',
    [OdooPaddingClasses.XL]: 'XL',
};
const paddingClasses = Object.keys(paddingClassesLabels);
var OdooImageClasses;
(function (OdooImageClasses) {
    OdooImageClasses["ROUNDED"] = "rounded";
    OdooImageClasses["ROUNDED_CIRCLE"] = "rounded-circle";
    OdooImageClasses["SHADOW"] = "shadow";
    OdooImageClasses["IMG_THUMBNAIL"] = "img-thumbnail";
})(OdooImageClasses || (OdooImageClasses = {}));
const imageClassesLabels = {
    [OdooImageClasses.ROUNDED]: 'Rounded',
    [OdooImageClasses.ROUNDED_CIRCLE]: 'Circle',
    [OdooImageClasses.SHADOW]: 'Shadow',
    [OdooImageClasses.IMG_THUMBNAIL]: 'Thumbnail',
};
/**
 * Get one image targeted within the range.
 * If more images are within the range, return undefined.
 */
function getSingleImage(range) {
    const next = range.start.nextLeaf();
    if (next instanceof _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_13__["ImageNode"]) {
        const prev = range.end.nextLeaf();
        if (prev === next) {
            return next;
        }
    }
}
/**
 * Check if there is at exactly one image within the editor range
 */
function isImageVisible(editor) {
    return !!getSingleImage(editor.selection.range);
}
class Odoo extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_OdooStructureXmlDomParser__WEBPACK_IMPORTED_MODULE_8__["OdooStructureXmlDomParser"], _OdooTranslationXmlDomParser__WEBPACK_IMPORTED_MODULE_11__["OdooTranslationXmlDomParser"]],
            renderers: [_OdooImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_9__["OdooImageDomObjectRenderer"], _OdooFontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_10__["OdooFontAwesomeDomObjectRenderer"]],
            components: [
                {
                    id: 'OdooLinkButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'link',
                            label: 'Insert link',
                            commandId: 'openLinkDialog',
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const node = range.start.nextSibling() || range.start.previousSibling();
                                return (node &&
                                    node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"] &&
                                    !!node.modifiers.find(_plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_3__["LinkFormat"]));
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-link fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'OdooMediaButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'media',
                            label: 'Media',
                            commandId: 'openMedia',
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-file-image-o fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'OdooTextColorButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'textcolorpicker',
                            label: 'Text Color picker',
                            commandId: 'openTextColorPicker',
                            modifiers: [
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-font fa-fw dropdown-toggle' }),
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ 'data-toggle': 'dropdown' }),
                            ],
                        });
                        const dropdownContent = new _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__["DividerNode"]();
                        dropdownContent.modifiers.append(new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'dropdown-menu' }));
                        const dropdownContainer = new _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__["DividerNode"]();
                        dropdownContainer.modifiers.append(new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'dropdown jw-dropdown jw-dropdown-textcolor' }));
                        dropdownContainer.append(button);
                        dropdownContainer.append(dropdownContent);
                        return [dropdownContainer];
                    },
                },
                {
                    id: 'OdooBackgroundColorButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'backgroundcolorpicker',
                            label: 'Background Color picker',
                            commandId: 'openBackgroundColorPicker',
                            modifiers: [
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-paint-brush fa-fw dropdown-toggle' }),
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ 'data-toggle': 'dropdown' }),
                            ],
                        });
                        const dropdownContent = new _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__["DividerNode"]();
                        dropdownContent.modifiers.append(new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'dropdown-menu' }));
                        const dropdownContainer = new _plugin_divider_src_DividerNode__WEBPACK_IMPORTED_MODULE_12__["DividerNode"]();
                        dropdownContainer.modifiers.append(new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({
                            class: 'dropdown jw-dropdown jw-dropdown-backgroundcolor',
                        }));
                        dropdownContainer.append(button);
                        dropdownContainer.append(dropdownContent);
                        return [dropdownContainer];
                    },
                },
                {
                    id: 'OdooDiscardButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'discard',
                            label: 'Discard',
                            commandId: 'discardOdoo',
                            modifiers: [
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-times fa-fw jw-danger-button' }),
                            ],
                        });
                        return [button];
                    },
                },
                {
                    id: 'OdooSaveButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'save',
                            label: 'Save',
                            commandId: 'saveOdoo',
                            modifiers: [
                                new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-save fa-fw jw-primary-button' }),
                            ],
                        });
                        return [button];
                    },
                },
                this._makeImagePaddingComponent('OdooImagePaddingNoneActionable', OdooPaddingClasses.NONE),
                this._makeImagePaddingComponent('OdooImagePaddingSmallActionable', OdooPaddingClasses.SMALL),
                this._makeImagePaddingComponent('OdooImagePaddingMediumActionable', OdooPaddingClasses.MEDIUM),
                this._makeImagePaddingComponent('OdooImagePaddingLargeActionable', OdooPaddingClasses.LARGE),
                this._makeImagePaddingComponent('OdooImagePaddingXLActionable', OdooPaddingClasses.XL),
                this._makeImageWidthComponent('OdooImageWidthAutoActionable', 'auto'),
                this._makeImageWidthComponent('OdooImageWidth25Actionable', '25'),
                this._makeImageWidthComponent('OdooImageWidth50Actionable', '50'),
                this._makeImageWidthComponent('OdooImageWidth75Actionable', '75'),
                this._makeImageWidthComponent('OdooImageWidth100Actionable', '100'),
                this._makeImageClassComponent('OdooImageRoundedActionable', OdooImageClasses.ROUNDED, 'fa-square'),
                this._makeImageClassComponent('OdooImageRoundedCircleActionable', OdooImageClasses.ROUNDED_CIRCLE, 'fa-circle-o'),
                this._makeImageClassComponent('OdooImageRoundedShadowActionable', OdooImageClasses.SHADOW, 'fa-sun-o'),
                this._makeImageClassComponent('OdooImageRoundedThumbnailActionable', OdooImageClasses.IMG_THUMBNAIL, 'fa-picture-o'),
                {
                    id: 'OdooCropActionable',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'crop-image',
                            label: 'Crop',
                            commandId: 'cropImage',
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-crop fa-fw' })],
                            visible: isImageVisible,
                        });
                        return [button];
                    },
                },
                {
                    id: 'OdooTransformActionable',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                            name: 'transform-image',
                            label: 'Transform',
                            commandId: 'transformImage',
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: 'fa fa-object-ungroup fa-fw' })],
                            visible: isImageVisible,
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [
                ['OdooLinkButton', ['actionables']],
                ['OdooMediaButton', ['actionables']],
                ['OdooDiscardButton', ['actionables']],
                ['OdooSaveButton', ['actionables']],
            ],
        };
        this.commands = {
            setImagePadding: {
                handler: this.setImagePadding,
            },
            setImageWidth: {
                handler: this.setImageWidth,
            },
            setImageClass: {
                handler: this.setImageClass,
            },
        };
    }
    setImagePadding(params) {
        const image = getSingleImage(params.context.range);
        if (image) {
            const classList = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]).classList;
            for (const className of paddingClasses) {
                classList.remove(className);
            }
            if (params.className === 'padding-none')
                return;
            classList.add(params.className);
        }
    }
    setImageWidth(params) {
        const image = getSingleImage(params.context.range);
        if (image) {
            const style = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]).style;
            if (params.width === 'auto') {
                style.remove('width');
            }
            else {
                style.set('width', params.width + '%');
            }
        }
    }
    setImageClass(params) {
        const image = getSingleImage(params.context.range);
        if (image) {
            const classList = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]).classList;
            classList.toggle(params.className);
        }
    }
    _makeImagePaddingComponent(componentId, className) {
        const component = {
            id: componentId,
            async render() {
                const params = {
                    className: className,
                };
                const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                    name: `set-${className}`,
                    label: paddingClassesLabels[className],
                    commandId: 'setImagePadding',
                    commandArgs: params,
                    visible: isImageVisible,
                    selected: (editor) => {
                        const image = getSingleImage(editor.selection.range);
                        if (image) {
                            const imageAttribute = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
                            if (className === OdooPaddingClasses.NONE) {
                                if (paddingClasses.every(className => !imageAttribute.has(className))) {
                                    return true;
                                }
                            }
                            else {
                                imageAttribute.classList.has(className);
                            }
                        }
                        return false;
                    },
                });
                return [button];
            },
        };
        return component;
    }
    _makeImageWidthComponent(componentId, width) {
        const component = {
            id: componentId,
            async render() {
                const params = {
                    width: width,
                };
                const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                    name: `set-image-width-${width}`,
                    label: width === 'auto' ? 'auto' : width + '%',
                    commandId: 'setImageWidth',
                    commandArgs: params,
                    visible: isImageVisible,
                    selected: (editor) => {
                        const image = getSingleImage(editor.selection.range);
                        if (image) {
                            const imageAttribute = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
                            return parseInt(imageAttribute.style.get('width')) === parseInt(width);
                        }
                        return false;
                    },
                });
                return [button];
            },
        };
        return component;
    }
    _makeImageClassComponent(componentId, className, faIcon) {
        const component = {
            id: componentId,
            async render() {
                const params = { className };
                const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_1__["ActionableNode"]({
                    name: `set-image-class-${className}`,
                    label: imageClassesLabels[className],
                    commandId: 'setImageClass',
                    commandArgs: params,
                    modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]({ class: `fa ${faIcon} fa-fw` })],
                    visible: isImageVisible,
                    selected: (editor) => {
                        const image = getSingleImage(editor.selection.range);
                        if (image) {
                            const imageAttribute = image.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
                            return imageAttribute.classList.has(className);
                        }
                        return false;
                    },
                });
                return [button];
            },
        };
        return component;
    }
}
Odoo.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_5__["Inline"], _plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_6__["Link"], _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_7__["Xml"]];


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooFontAwesomeDomObjectRenderer.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooFontAwesomeDomObjectRenderer.ts ***!
  \**********************************************************************/
/*! exports provided: OdooFontAwesomeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooFontAwesomeDomObjectRenderer", function() { return OdooFontAwesomeDomObjectRenderer; });
/* harmony import */ var _plugin_fontawesome_src_FontAwesomeNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-fontawesome/src/FontAwesomeNode */ "./packages/plugin-fontawesome/src/FontAwesomeNode.ts");
/* harmony import */ var _plugin_fontawesome_src_FontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-fontawesome/src/FontAwesomeDomObjectRenderer */ "./packages/plugin-fontawesome/src/FontAwesomeDomObjectRenderer.ts");


class OdooFontAwesomeDomObjectRenderer extends _plugin_fontawesome_src_FontAwesomeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__["FontAwesomeDomObjectRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_fontawesome_src_FontAwesomeNode__WEBPACK_IMPORTED_MODULE_0__["FontAwesomeNode"];
    }
    async render(node, worker) {
        const domObject = await super.render(node, worker);
        if (domObject && 'children' in domObject) {
            const fa = domObject.children[1];
            if ('tag' in fa) {
                const savedAttach = fa.attach;
                fa.attach = (el) => {
                    if (savedAttach) {
                        savedAttach(el);
                    }
                    el.addEventListener('dblclick', () => {
                        const params = { image: node };
                        this.engine.editor.execCommand('openMedia', params);
                    });
                };
            }
        }
        return domObject;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooImageDomObjectRenderer.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooImageDomObjectRenderer.ts ***!
  \****************************************************************/
/*! exports provided: OdooImageDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooImageDomObjectRenderer", function() { return OdooImageDomObjectRenderer; });
/* harmony import */ var _plugin_image_src_ImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-image/src/ImageDomObjectRenderer */ "./packages/plugin-image/src/ImageDomObjectRenderer.ts");
/* harmony import */ var _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-image/src/ImageNode */ "./packages/plugin-image/src/ImageNode.ts");


class OdooImageDomObjectRenderer extends _plugin_image_src_ImageDomObjectRenderer__WEBPACK_IMPORTED_MODULE_0__["ImageDomObjectRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_1__["ImageNode"];
    }
    async render(node, worker) {
        const image = await this.super.render(node, worker);
        if (image && 'tag' in image) {
            const savedAttach = image.attach;
            const savedDetach = image.detach;
            const handleClick = () => {
                const params = { image: node };
                this.engine.editor.execCommand('openMedia', params);
            };
            image.attach = (el) => {
                if (savedAttach) {
                    savedAttach(el);
                }
                el.addEventListener('dblclick', handleClick);
            };
            image.detach = (el) => {
                if (savedDetach) {
                    savedDetach(el);
                }
                el.removeEventListener('dblclick', handleClick);
            };
        }
        return image;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooStructureNode.ts":
/*!*******************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooStructureNode.ts ***!
  \*******************************************************/
/*! exports provided: OdooStructureNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooStructureNode", function() { return OdooStructureNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class OdooStructureNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super(params);
        this.breakable = false;
        this.xpath = params.xpath;
        this.viewId = params.viewId;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooStructureXmlDomParser.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooStructureXmlDomParser.ts ***!
  \***************************************************************/
/*! exports provided: OdooStructureXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooStructureXmlDomParser", function() { return OdooStructureXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _OdooStructureNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooStructureNode */ "./packages/plugin-odoo/src/OdooStructureNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class OdooStructureXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return (item instanceof Element &&
                item.classList.contains('oe_structure') &&
                item.attributes &&
                item.attributes['data-oe-xpath'] &&
                item.attributes['data-oe-id']);
        };
    }
    /**
     * Parse a structure node.
     *
     * @param item
     */
    async parse(item) {
        const odooStructure = new _OdooStructureNode__WEBPACK_IMPORTED_MODULE_2__["OdooStructureNode"]({
            htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item),
            xpath: item.attributes['data-oe-xpath'].value,
            viewId: item.attributes['data-oe-id'].value,
        });
        odooStructure.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        odooStructure.append(...children);
        return [odooStructure];
    }
}
OdooStructureXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooTranslationFormat.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooTranslationFormat.ts ***!
  \***********************************************************/
/*! exports provided: OdooTranslationFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooTranslationFormat", function() { return OdooTranslationFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");


class OdooTranslationFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag, translationId) {
        super(htmlTag);
        this.breakable = false;
        this.translationId = translationId;
    }
    get name() {
        return `OdooTranslation: ${super.name}`;
    }
    // TODO: Attributes on OdooTranslation should reactively read the values set
    // on the node itself rather than having to manually synchronize them.
    get translationId() {
        var _a;
        return (_a = this.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('data-oe-translation-id');
    }
    set translationId(translationId) {
        this.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]).set('data-oe-translation-id', translationId);
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    clone() {
        const clone = super.clone();
        clone.translationId = this.translationId;
        return clone;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo/src/OdooTranslationXmlDomParser.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-odoo/src/OdooTranslationXmlDomParser.ts ***!
  \*****************************************************************/
/*! exports provided: OdooTranslationXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooTranslationXmlDomParser", function() { return OdooTranslationXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _OdooTranslationFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooTranslationFormat */ "./packages/plugin-odoo/src/OdooTranslationFormat.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





class OdooTranslationXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && item.attributes['data-oe-translation-state'];
        };
    }
    /**
     * Parse a translation node.
     *
     * @param item
     */
    async parse(item) {
        const odooTranslation = new _OdooTranslationFormat__WEBPACK_IMPORTED_MODULE_2__["OdooTranslationFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(item), item.getAttribute('data-oe-translation-id'));
        odooTranslation.modifiers.replace(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(odooTranslation, children);
        return children;
    }
}
OdooTranslationXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-owl/src/Owl.ts":
/*!****************************************!*\
  !*** ./packages/plugin-owl/src/Owl.ts ***!
  \****************************************/
/*! exports provided: Owl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Owl", function() { return Owl; });
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _OwlDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OwlDomObjectRenderer */ "./packages/plugin-owl/src/OwlDomObjectRenderer.ts");



// Temporary fix waiting for the `Env` interface of Owl to let the `browser`
// property be optional
const browser = {
    setTimeout: window.setTimeout.bind(window),
    clearTimeout: window.clearTimeout.bind(window),
    setInterval: window.setInterval.bind(window),
    clearInterval: window.clearInterval.bind(window),
    requestAnimationFrame: window.requestAnimationFrame.bind(window),
    random: Math.random,
    Date: window.Date,
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    fetch: (window.fetch || (() => { })).bind(window),
    localStorage: window.localStorage,
};
class Owl extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            renderers: [_OwlDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["OwlDomObjectRenderer"]],
        };
        this.loaders = {
            owlTemplates: this._loadTemplates,
        };
        this.env = {
            qweb: new _odoo_owl__WEBPACK_IMPORTED_MODULE_0__["QWeb"](),
            editor: this.editor,
            browser: browser,
        };
        this.components = new Map();
    }
    async stop() {
        for (const [, component] of this.components) {
            component.destroy();
        }
        this.components.clear();
    }
    _loadTemplates(templates) {
        for (const template of templates) {
            this.env.qweb.addTemplates(template);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-owl/src/OwlComponent.ts":
/*!*************************************************!*\
  !*** ./packages/plugin-owl/src/OwlComponent.ts ***!
  \*************************************************/
/*! exports provided: OwlComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlComponent", function() { return OwlComponent; });
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__);


class OwlComponent extends _odoo_owl__WEBPACK_IMPORTED_MODULE_0__["Component"] {
    constructor() {
        super(...arguments);
        this._storageKeyPrefix = 'OwlUI' + this.constructor.name + ':';
        // State items which names are listed in the localStorage property will be
        // read from the localStorage during the willStart of the component, and
        // wrote back to the localStorage whenever the state changes.
        this.localStorage = [];
    }
    /**
     * Owl hook called exactly once before the initial rendering.
     */
    willStart() {
        if (this.state) {
            this._importStateFromStorage(localStorage, this.localStorage);
            this.state = Object(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__["useState"])(this.state);
        }
        return super.willStart();
    }
    /**
     * Called by the Owl state observer every time the state changes.
     *
     * @param force see Owl Component
     */
    render(force = false) {
        if (this.state) {
            this._exportStateToStorage(localStorage, this.localStorage);
        }
        return super.render(force);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Read the given storable state items from the given `storage` and write
     * the items as the key of the `state` property.
     *
     * @param storage from which to read the state items
     * @param storableItems names of the state items to read from storage
     */
    _importStateFromStorage(storage, storableItems) {
        storableItems.forEach(itemName => {
            const storageKey = this._storageKeyPrefix + itemName;
            const value = storage.getItem(storageKey);
            // The value of items that were not yet set in storage is null.
            if (value !== null) {
                // Otherwise, the value was stored as a string in the storage.
                // Convert it to the type of the default value for the state.
                try {
                    this.state[itemName] = JSON.parse(value);
                }
                catch (e) {
                    // Stored item is not parseable. Keep the default value.
                    console.warn(`Storage: Ignoring state.${itemName} stored value.\n` +
                        `${e.name}: ${e.message}\n` +
                        `Stored value: ${value}`);
                }
            }
        });
    }
    /**
     * For every key in the property `state`, write it back to `storage`
     * Write the given storable state items to the given storage.
     *
     * @param storage to write the state items to
     * @param storableItems names of the state items to write to storage
     */
    _exportStateToStorage(storage, storableItems) {
        storableItems.forEach(itemName => {
            const storageKey = this._storageKeyPrefix + itemName;
            // Storage require items to be stored as strings.
            try {
                const serializedValue = JSON.stringify(this.state[itemName]);
                storage.setItem(storageKey, serializedValue);
            }
            catch (e) {
                // State item is not serializable. Skip storing it.
                console.warn(`Storage: Unserializable state.${itemName} value.\n` +
                    `${e.name}: ${e.message}`);
            }
        });
    }
}


/***/ }),

/***/ "./packages/plugin-owl/src/OwlDomObjectRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-owl/src/OwlDomObjectRenderer.ts ***!
  \*********************************************************/
/*! exports provided: OwlDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlDomObjectRenderer", function() { return OwlDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _OwlNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OwlNode */ "./packages/plugin-owl/src/OwlNode.ts");
/* harmony import */ var _Owl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Owl */ "./packages/plugin-owl/src/Owl.ts");




class OwlDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor(engine) {
        super(engine);
        this.predicate = _OwlNode__WEBPACK_IMPORTED_MODULE_2__["OwlNode"];
        this.env = this.engine.editor.plugins.get(_Owl__WEBPACK_IMPORTED_MODULE_3__["Owl"]).env;
    }
    async render(node) {
        const components = this.engine.editor.plugins.get(_Owl__WEBPACK_IMPORTED_MODULE_3__["Owl"]).components;
        const oldOwlComponent = components.get(node);
        const placeholder = document.createElement('jw-placeholer');
        document.body.appendChild(placeholder);
        node.params.Component.env = this.env;
        const component = new node.params.Component(null, node.params.props);
        components.set(node, component);
        await component.mount(placeholder);
        placeholder.remove();
        const domNodes = [...placeholder.childNodes];
        if (oldOwlComponent) {
            if (oldOwlComponent.el.parentNode) {
                for (const domNode of domNodes) {
                    oldOwlComponent.el.parentNode.insertBefore(domNode, oldOwlComponent.el);
                }
            }
            oldOwlComponent.destroy();
        }
        return {
            dom: domNodes,
        };
    }
}
OwlDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-owl/src/OwlNode.ts":
/*!********************************************!*\
  !*** ./packages/plugin-owl/src/OwlNode.ts ***!
  \********************************************/
/*! exports provided: OwlNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlNode", function() { return OwlNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");


class OwlNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super(params);
        Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["markNotVersionable"])(params);
        this.params = params;
    }
    get name() {
        return super.name + ': ' + this.params.Component.name;
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/Paragraph.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-paragraph/src/Paragraph.ts ***!
  \****************************************************/
/*! exports provided: Paragraph */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Paragraph", function() { return Paragraph; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ParagraphXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ParagraphXmlDomParser */ "./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts");


class Paragraph extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ParagraphXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ParagraphXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/ParagraphNode.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-paragraph/src/ParagraphNode.ts ***!
  \********************************************************/
/*! exports provided: ParagraphNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParagraphNode", function() { return ParagraphNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class ParagraphNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'P' });
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: ParagraphXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParagraphXmlDomParser", function() { return ParagraphXmlDomParser; });
/* harmony import */ var _ParagraphNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ParagraphXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'P';
        };
    }
    async parse(item) {
        const paragraph = new _ParagraphNode__WEBPACK_IMPORTED_MODULE_0__["ParagraphNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            paragraph.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        paragraph.append(...nodes);
        return [paragraph];
    }
}
ParagraphXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-parser/src/AbstractParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-parser/src/AbstractParser.ts ***!
  \******************************************************/
/*! exports provided: AbstractParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractParser", function() { return AbstractParser; });
class AbstractParser {
    constructor(engine) {
        this.engine = engine;
    }
}


/***/ }),

/***/ "./packages/plugin-parser/src/Parser.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-parser/src/Parser.ts ***!
  \**********************************************/
/*! exports provided: Parser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Parser", function() { return Parser; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Parser extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.engines = {};
        this.loaders = {
            parsingEngines: this.loadParsingEngines,
            parsers: this.loadParsers,
        };
    }
    async parse(engineId, ...items) {
        const engine = this.engines[engineId];
        if (!engine) {
            throw new Error(`No parsing engine for ${engineId} installed.`);
        }
        return engine.parse(...items);
    }
    loadParsingEngines(parsingEngines) {
        for (const EngineClass of parsingEngines) {
            const id = EngineClass.id;
            if (this.engines[id]) {
                throw new Error(`Parsing engine ${id} already registered.`);
            }
            const engine = new EngineClass(this.editor);
            this.engines[id] = engine;
        }
    }
    loadParsers(parsers) {
        parsers = [...parsers].reverse();
        for (const ParserClass of parsers) {
            for (const id in this.engines) {
                const parsingEngine = this.engines[id];
                const supportedTypes = [id, ...parsingEngine.constructor.extends];
                if (supportedTypes.includes(ParserClass.id)) {
                    parsingEngine.register(ParserClass);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-parser/src/ParsingEngine.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-parser/src/ParsingEngine.ts ***!
  \*****************************************************/
/*! exports provided: ParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParsingEngine", function() { return ParsingEngine; });
class ParsingEngine {
    constructor(editor) {
        this.parsers = [];
        this.parsingMap = new Map();
        this.editor = editor;
        const defaultParser = new this.constructor.defaultParser(this);
        if (defaultParser.predicate) {
            throw new Error(`Default renderer cannot have a predicate.`);
        }
        else {
            this.parsers.push(defaultParser);
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Register the given parser by instantiating it with this parser engine.
     *
     * @param ParserClass
     */
    register(ParserClass) {
        if (ParserClass.id === this.constructor.id) {
            this.parsers.unshift(new ParserClass(this));
        }
        else {
            const supportedTypes = [this.constructor.id, ...this.constructor.extends];
            const priorParserIds = supportedTypes.slice(0, supportedTypes.indexOf(ParserClass.id));
            const postParserIndex = this.parsers.findIndex(parser => !priorParserIds.includes(parser.constructor.id));
            this.parsers.splice(postParserIndex, 0, new ParserClass(this));
        }
    }
    /**
     * Parse items into the editor's virtual `VNode` representation.
     *
     * @param items the items to parse
     * @returns Promise resolved by the element parsed into the editor virtual
     * VNode representation
     */
    async parse(...items) {
        const nodes = [];
        const childPromises = items.map(node => this._parseItem(node));
        const resList = await Promise.all(childPromises);
        for (const res of resList) {
            nodes.push(...res);
        }
        return nodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Parse an item into the editor's virtual representation.
     *
     */
    async _parseItem(item) {
        let nodes;
        for (const parser of this.parsers) {
            if (!parser.predicate || parser.predicate(item)) {
                nodes = await parser.parse(item);
                break;
            }
        }
        if (nodes.length >= 1) {
            this.parsingMap.set(item, nodes);
        }
        return nodes;
    }
}
ParsingEngine.extends = [];


/***/ }),

/***/ "./packages/plugin-pre/src/Pre.ts":
/*!****************************************!*\
  !*** ./packages/plugin-pre/src/Pre.ts ***!
  \****************************************/
/*! exports provided: Pre */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Pre", function() { return Pre; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _PreXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PreXmlDomParser */ "./packages/plugin-pre/src/PreXmlDomParser.ts");
/* harmony import */ var _PreDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PreDomObjectRenderer */ "./packages/plugin-pre/src/PreDomObjectRenderer.ts");
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _PreCharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./PreCharDomObjectRenderer */ "./packages/plugin-pre/src/PreCharDomObjectRenderer.ts");
/* harmony import */ var _PreSeparatorDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PreSeparatorDomObjectRenderer */ "./packages/plugin-pre/src/PreSeparatorDomObjectRenderer.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");









class Pre extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            applyPreStyle: {
                handler: this.applyPreStyle,
            },
        };
        this.loadables = {
            parsers: [_PreXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["PreXmlDomParser"]],
            renderers: [_PreDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["PreDomObjectRenderer"], _PreSeparatorDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__["PreSeparatorDomObjectRenderer"], _PreCharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["PreCharDomObjectRenderer"]],
            components: [
                {
                    id: 'PreButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_7__["ActionableNode"]({
                            name: 'pre',
                            label: 'Pre',
                            commandId: 'applyPreStyle',
                            selected: (editor) => {
                                const range = editor.selection.range;
                                const startPre = !!range.start.closest(_PreNode__WEBPACK_IMPORTED_MODULE_3__["PreNode"]);
                                if (!startPre || range.isCollapsed()) {
                                    return startPre;
                                }
                                else {
                                    return !!range.end.closest(_PreNode__WEBPACK_IMPORTED_MODULE_3__["PreNode"]);
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_8__["Attributes"]({ class: 'pre' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['PreButton', ['actionables']]],
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Change the formatting of the nodes in given range to Pre.
     *
     * @param params
     */
    applyPreStyle(params) {
        for (const node of params.context.range.targetedNodes(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__["ContainerNode"])) {
            const pre = new _PreNode__WEBPACK_IMPORTED_MODULE_3__["PreNode"]();
            pre.modifiers = node.modifiers.clone();
            node.replaceWith(pre);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-pre/src/PreCharDomObjectRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-pre/src/PreCharDomObjectRenderer.ts ***!
  \*************************************************************/
/*! exports provided: PreCharDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreCharDomObjectRenderer", function() { return PreCharDomObjectRenderer; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_char_src_CharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-char/src/CharDomObjectRenderer */ "./packages/plugin-char/src/CharDomObjectRenderer.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");




class PreCharDomObjectRenderer extends _plugin_char_src_CharDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["CharDomObjectRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => item instanceof _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"] && !!item.ancestor(_PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]);
    }
    async render(charNode, worker) {
        const domObject = await super.render(charNode, worker);
        this._renderInPre([domObject]);
        return domObject;
    }
    /**
     * Render the CharNode and convert unbreakable spaces into normal spaces.
     */
    async renderBatch(charNodes, worker) {
        const domObjects = await super.renderBatch(charNodes, worker);
        this._renderInPre(domObjects);
        return domObjects;
    }
    _renderInPre(domObjects) {
        const stack = [...domObjects];
        for (const domObject of stack) {
            if ('text' in domObject) {
                domObject.text = domObject.text
                    .replace(/\u00A0/g, ' ')
                    .replace(/\u2003/g, '\u0009');
            }
            if ('children' in domObject) {
                for (const child of domObject.children) {
                    if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"])) {
                        stack.push(child);
                    }
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-pre/src/PreDomObjectRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-pre/src/PreDomObjectRenderer.ts ***!
  \*********************************************************/
/*! exports provided: PreDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreDomObjectRenderer", function() { return PreDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");



class PreDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _PreNode__WEBPACK_IMPORTED_MODULE_2__["PreNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const pre = {
            tag: 'PRE',
            children: await this.engine.renderChildren(node),
        };
        return pre;
    }
}
PreDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-pre/src/PreNode.ts":
/*!********************************************!*\
  !*** ./packages/plugin-pre/src/PreNode.ts ***!
  \********************************************/
/*! exports provided: PreNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreNode", function() { return PreNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class PreNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
}


/***/ }),

/***/ "./packages/plugin-pre/src/PreSeparatorDomObjectRenderer.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-pre/src/PreSeparatorDomObjectRenderer.ts ***!
  \******************************************************************/
/*! exports provided: PreSeparatorDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreSeparatorDomObjectRenderer", function() { return PreSeparatorDomObjectRenderer; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class PreSeparatorDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const DefaultSeparator = this.engine.editor.configuration.defaults.Separator;
            return item instanceof DefaultSeparator && !!item.ancestor(_PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]);
        };
    }
    /**
     * Render the VNode.
     */
    async render(node, worker) {
        const separator = (await this.super.render(node, worker));
        let rendering;
        if ('tag' in separator) {
            rendering = { text: '\n' };
        }
        else {
            rendering = { text: '\n\n' };
            worker.locate([node, node], rendering);
        }
        return rendering;
    }
}
PreSeparatorDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-pre/src/PreXmlDomParser.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-pre/src/PreXmlDomParser.ts ***!
  \****************************************************/
/*! exports provided: PreXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreXmlDomParser", function() { return PreXmlDomParser; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class PreXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'PRE';
        };
    }
    async parse(item) {
        const pre = new _PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            pre.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        pre.append(...children);
        return [pre];
    }
}
PreXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-renderer-dom-object/src/DefaultDomObjectModifierRenderer.ts":
/*!*************************************************************************************!*\
  !*** ./packages/plugin-renderer-dom-object/src/DefaultDomObjectModifierRenderer.ts ***!
  \*************************************************************************************/
/*! exports provided: DefaultDomObjectModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultDomObjectModifierRenderer", function() { return DefaultDomObjectModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");

class DefaultDomObjectModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    /**
     * Default rendering for Modifier.
     *
     * @param modifier
     * @param contents
     */
    async render(modifier, contents) {
        return contents;
    }
}
DefaultDomObjectModifierRenderer.id = 'dom/object';


/***/ }),

/***/ "./packages/plugin-renderer-dom-object/src/DefaultDomObjectRenderer.ts":
/*!*****************************************************************************!*\
  !*** ./packages/plugin-renderer-dom-object/src/DefaultDomObjectRenderer.ts ***!
  \*****************************************************************************/
/*! exports provided: DefaultDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultDomObjectRenderer", function() { return DefaultDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _core_src_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/FragmentNode */ "./packages/core/src/VNodes/FragmentNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");




class DefaultDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    async render(node) {
        let domObject;
        if (node.tangible) {
            if (node instanceof _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__["VElement"] && node.htmlTag[0] !== '#') {
                domObject = {
                    tag: node.htmlTag,
                    children: await this.engine.renderChildren(node),
                };
            }
            else if (node instanceof _core_src_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_1__["FragmentNode"]) {
                domObject = {
                    children: await this.engine.renderChildren(node),
                };
            }
            else if (node instanceof _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_3__["AtomicNode"]) {
                domObject = { children: [] };
            }
            else {
                domObject = {
                    tag: node.name,
                    attributes: {
                        id: node.id.toString(),
                    },
                    children: await this.engine.renderChildren(node),
                };
            }
        }
        else {
            domObject = { children: [] };
        }
        return domObject;
    }
}
DefaultDomObjectRenderer.id = 'dom/object';


/***/ }),

/***/ "./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-renderer-dom-object/src/DomObjectRenderer.ts ***!
  \**********************************************************************/
/*! exports provided: DomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomObjectRenderer", function() { return DomObjectRenderer; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Xml */ "./packages/plugin-xml/src/Xml.ts");
/* harmony import */ var _DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _FormatDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./FormatDomObjectModifierRenderer */ "./packages/plugin-renderer-dom-object/src/FormatDomObjectModifierRenderer.ts");






class DomObjectRenderer extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            renderingEngines: [_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_4__["DomObjectRenderingEngine"]],
            renderers: [_FormatDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_5__["FormatDomObjectModifierRenderer"]],
        };
    }
}
DomObjectRenderer.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"], _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_3__["Xml"]];


/***/ }),

/***/ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts":
/*!*****************************************************************************!*\
  !*** ./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts ***!
  \*****************************************************************************/
/*! exports provided: DomObjectRenderingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomObjectRenderingEngine", function() { return DomObjectRenderingEngine; });
/* harmony import */ var _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/RenderingEngine */ "./packages/plugin-renderer/src/RenderingEngine.ts");
/* harmony import */ var _DefaultDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultDomObjectRenderer */ "./packages/plugin-renderer-dom-object/src/DefaultDomObjectRenderer.ts");
/* harmony import */ var _DefaultDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DefaultDomObjectModifierRenderer */ "./packages/plugin-renderer-dom-object/src/DefaultDomObjectModifierRenderer.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _core_src_Mode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/Mode */ "./packages/core/src/Mode.ts");





class DomObjectRenderingEngine extends _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__["RenderingEngine"] {
    /**
     * Render the attributes of the given VNode onto the given DOM Element.
     *
     * @param Class
     * @param node
     * @param element
     */
    renderAttributes(Class, node, item, worker) {
        if ('tag' in item) {
            if (!item.attributes)
                item.attributes = {};
            const attributes = node.modifiers.find(Class);
            if (attributes) {
                const attr = item.attributes;
                for (const name of attributes.keys()) {
                    if (name === 'class') {
                        if (!attr.class)
                            attr.class = new Set();
                        for (const className of attributes.classList.items()) {
                            attr.class.add(className);
                        }
                    }
                    else if (name === 'style') {
                        attr.style = Object.assign({}, attributes.style.toJSON(), attr.style);
                    }
                    else {
                        attr[name] = attributes.get(name);
                    }
                }
                worker.depends(item, attributes);
            }
        }
    }
    /**
     * @overwrite
     */
    async renderChildren(node) {
        const children = node.children();
        if (!children.length && this.editor.mode.is(node, _core_src_Mode__WEBPACK_IMPORTED_MODULE_4__["RuleProperty"].ALLOW_EMPTY) !== true) {
            children.push({ tag: 'BR' });
        }
        return children;
    }
    /**
     * Render a placeholder for the given child node.
     *
     * @param child
     */
    renderPlaceholder(child) {
        const placeholder = document.createElement('jw-domobject-vnode');
        placeholder.id = child.id.toString();
        return placeholder;
    }
    /**
     * Convert every VNode children into domObjects
     *
     * @param domObject
     */
    async resolveChildren(domObject, worker) {
        const stack = [domObject];
        for (const domObject of stack) {
            if ('children' in domObject) {
                const children = [];
                const childNodes = domObject.children.filter(child => child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"]);
                const domObjects = await worker.render(childNodes);
                for (const index in domObject.children) {
                    const child = domObject.children[index];
                    let childObject;
                    if (child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"]) {
                        childObject = domObjects.shift();
                    }
                    else {
                        childObject = child;
                    }
                    if (!stack.includes(childObject)) {
                        children.push(childObject);
                        stack.push(childObject);
                    }
                }
                domObject.children = children;
            }
        }
    }
    /**
     * Group the nodes by renderer, siblings and format.
     *
     * @override
     */
    renderBatched(cache, nodes, rendered) {
        const renderingUnits = this._getRenderingUnits(cache, nodes, rendered);
        return this._renderBatched(cache, renderingUnits);
    }
    /**
     * Group the nodes by format and by renderer and call 'renderBatch' with
     * the different group. Wrap the created domObject into the fromated
     * domObjectElement if needed.
     * Return a list of the rendered vNode and list of DomObjects. The indices
     * of the DomObject list match the indices of the given nodes
     * list.
     *
     * @param renderingUnits
     */
    _renderBatched(cache, renderingUnits) {
        var _a;
        const batchPromises = [];
        for (let unitIndex = 0; unitIndex < renderingUnits.length; unitIndex++) {
            let nextUnitIndex = unitIndex;
            const unit = renderingUnits[unitIndex];
            if (unit && unit[1].length) {
                // Group same formating.
                const modifier = unit[1][0];
                let lastUnit = [unit[0], unit[1].slice(1), unit[2]];
                const newRenderingUnits = [lastUnit];
                let nextUnit;
                while ((nextUnit = renderingUnits[nextUnitIndex + 1]) &&
                    lastUnit[0].parent === nextUnit[0].parent &&
                    nextUnit[1].length &&
                    this._modifierIsSameAs(cache, modifier, (_a = nextUnit[1]) === null || _a === void 0 ? void 0 : _a[0])) {
                    nextUnitIndex++;
                    lastUnit = renderingUnits[nextUnitIndex];
                    newRenderingUnits.push([lastUnit[0], lastUnit[1].slice(1), lastUnit[2]]);
                }
                // Render wrapped nodes.
                const promises = this._renderBatched(cache, newRenderingUnits);
                const nodes = newRenderingUnits.map(u => u[0]);
                const modifierPromise = Promise.all(promises).then(async () => {
                    const domObjects = [];
                    for (const domObject of nodes.map(node => cache.renderings.get(node))) {
                        if (!domObjects.includes(domObject)) {
                            domObjects.push(domObject);
                        }
                    }
                    // Create format.
                    const modifierRenderer = this.getCompatibleModifierRenderer(cache, modifier);
                    const wraps = await modifierRenderer.render(modifier, domObjects, nodes, cache.worker);
                    // Add origins.
                    for (const wrap of wraps) {
                        const stack = [wrap];
                        for (const domObject of stack) {
                            const origins = cache.renderingDependent.get(domObject);
                            if (origins) {
                                for (const origin of origins) {
                                    this._depends(cache, origin, wrap);
                                    this._depends(cache, wrap, origin);
                                }
                            }
                            if ('children' in domObject) {
                                for (const child of domObject.children) {
                                    if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"])) {
                                        stack.push(child);
                                    }
                                }
                            }
                        }
                        this._depends(cache, modifier, wrap);
                        this._depends(cache, wrap, modifier);
                    }
                    // Update the renderings promise.
                    for (const node of nodes) {
                        const wrap = wraps.find(wrap => { var _a; return (_a = cache.renderingDependent.get(wrap)) === null || _a === void 0 ? void 0 : _a.has(node); });
                        cache.renderings.set(node, wrap);
                    }
                });
                for (const node of nodes) {
                    cache.renderingPromises.set(node, modifierPromise);
                }
                batchPromises.push(modifierPromise);
            }
            else {
                // Render each node.
                let currentRenderer;
                let renderingUnit;
                const siblings = [];
                while ((renderingUnit = renderingUnits[nextUnitIndex]) &&
                    (!currentRenderer ||
                        (!renderingUnit[1].length &&
                            currentRenderer === renderingUnit[2] &&
                            (!siblings.length ||
                                siblings[siblings.length - 1].parent === renderingUnit[0].parent)))) {
                    nextUnitIndex++;
                    siblings.push(renderingUnit[0]);
                    currentRenderer = renderingUnit[2];
                }
                if (currentRenderer) {
                    const promise = new Promise(resolve => {
                        Promise.resolve().then(() => {
                            currentRenderer.renderBatch(siblings, cache.worker).then(domObjects => {
                                // Set the value, add origins and locations.
                                for (const index in siblings) {
                                    const node = siblings[index];
                                    const value = domObjects[index];
                                    this._depends(cache, node, value);
                                    this._depends(cache, value, node);
                                    this._addDefaultLocation(cache, node, value);
                                    cache.renderings.set(node, value);
                                }
                                resolve();
                            });
                        });
                    });
                    for (const sibling of siblings) {
                        cache.renderingPromises.set(sibling, promise);
                    }
                    batchPromises.push(promise);
                    nextUnitIndex--;
                }
            }
            unitIndex = nextUnitIndex;
        }
        return batchPromises;
    }
    /**
     * Compute list of nodes, format and rendering.
     * Add the siblings node into the list for future grouping for 'renderBatch'
     * method.
     *
     * @param nodes
     * @param rendered
     */
    _getRenderingUnits(cache, nodes, rendered) {
        // Consecutive char nodes are rendered in same time.
        const renderingUnits = [];
        const setNodes = new Set(nodes); // Use set for perf.
        const selected = new Set();
        for (const node of nodes) {
            if (selected.has(node)) {
                continue;
            }
            const parent = node.parent;
            if (parent) {
                const markers = [];
                parent.childVNodes.forEach(sibling => {
                    // Filter and sort the ndoes.
                    if (setNodes.has(sibling)) {
                        if (sibling.tangible) {
                            renderingUnits.push(this._createUnit(cache, sibling, rendered));
                        }
                        else {
                            // Not tangible node are add after other nodes (don't cut text node).
                            markers.push(sibling);
                        }
                        selected.add(sibling);
                    }
                    else if (sibling.tangible) {
                        renderingUnits.push(null);
                    }
                });
                for (const marker of markers) {
                    renderingUnits.push(this._createUnit(cache, marker, rendered));
                }
            }
            else {
                renderingUnits.push(this._createUnit(cache, node, rendered));
            }
        }
        return renderingUnits;
    }
    _createUnit(cache, node, rendered) {
        const renderer = cache.worker.getCompatibleRenderer(node, rendered);
        // Remove modifier who render nothing.
        const modifiers = node.modifiers.filter(modifer => !this._modifierIsSameAs(cache, modifer, null));
        return [node, modifiers, renderer];
    }
    _addDefaultLocation(cache, node, domObject) {
        let located = false;
        const stack = [domObject];
        for (const object of stack) {
            if (cache.locations.get(object)) {
                located = true;
                break;
            }
            if ('children' in object) {
                for (const child of object.children) {
                    if (!(child instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"])) {
                        if (stack.includes(child)) {
                            throw new Error('Loop in rendering object.');
                        }
                        stack.push(child);
                    }
                }
            }
        }
        if (!located) {
            cache.locations.set(domObject, [node]);
        }
    }
}
DomObjectRenderingEngine.id = 'dom/object';
DomObjectRenderingEngine.defaultRenderer = _DefaultDomObjectRenderer__WEBPACK_IMPORTED_MODULE_1__["DefaultDomObjectRenderer"];
DomObjectRenderingEngine.defaultModifierRenderer = _DefaultDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_2__["DefaultDomObjectModifierRenderer"];


/***/ }),

/***/ "./packages/plugin-renderer-dom-object/src/FormatDomObjectModifierRenderer.ts":
/*!************************************************************************************!*\
  !*** ./packages/plugin-renderer-dom-object/src/FormatDomObjectModifierRenderer.ts ***!
  \************************************************************************************/
/*! exports provided: FormatDomObjectModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormatDomObjectModifierRenderer", function() { return FormatDomObjectModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");
/* harmony import */ var _DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class FormatDomObjectModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _core_src_Format__WEBPACK_IMPORTED_MODULE_2__["Format"];
    }
    /**
     * Rendering for Format Modifier.
     *
     * @param format
     * @param contents
     */
    async render(format, contents) {
        const domObject = {
            tag: format.htmlTag.toUpperCase(),
            children: contents,
        };
        const attributes = format.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]);
        const keys = attributes === null || attributes === void 0 ? void 0 : attributes.keys();
        if (keys === null || keys === void 0 ? void 0 : keys.length) {
            domObject.attributes = {};
            const attr = domObject.attributes;
            for (const name of keys) {
                if (name === 'class') {
                    if (!attr.class)
                        attr.class = new Set();
                    for (const className of attributes.classList.items()) {
                        attr.class.add(className);
                    }
                }
                else if (name === 'style') {
                    attr.style = Object.assign({}, attributes.style.toJSON(), attr.style);
                }
                else {
                    attr[name] = attributes.get(name);
                }
            }
        }
        return [domObject];
    }
}
FormatDomObjectModifierRenderer.id = _DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-renderer/src/ModifierRenderer.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-renderer/src/ModifierRenderer.ts ***!
  \**********************************************************/
/*! exports provided: ModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModifierRenderer", function() { return ModifierRenderer; });
class SuperModifierRenderer {
    constructor(renderer) {
        this.renderer = renderer;
    }
    /**
     * Render the given modifier and return a list of DomObject witch
     * the applied modifier. The list can have an other len of the given
     * list of DomObject.
     *
     * @param modifier
     * @param contents
     * @param batch
     */
    render(modifier, contents, batch, worker) {
        const nextRenderer = worker.getCompatibleModifierRenderer(modifier, this.renderer);
        return nextRenderer === null || nextRenderer === void 0 ? void 0 : nextRenderer.render(modifier, contents, batch, worker);
    }
}
class ModifierRenderer {
    constructor(engine) {
        this.engine = engine;
        this.super = new SuperModifierRenderer(this);
    }
}


/***/ }),

/***/ "./packages/plugin-renderer/src/NodeRenderer.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-renderer/src/NodeRenderer.ts ***!
  \******************************************************/
/*! exports provided: NodeRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NodeRenderer", function() { return NodeRenderer; });
class SuperRenderer {
    constructor(renderer) {
        this.renderer = renderer;
    }
    /**
     * Render the given node.
     *
     * @param node
     */
    render(node, worker) {
        const nextRenderer = worker.getCompatibleRenderer(node, this.renderer);
        return nextRenderer === null || nextRenderer === void 0 ? void 0 : nextRenderer.render(node, worker);
    }
    /**
     * Render the given group of nodes.
     *
     * @param node
     */
    async renderBatch(nodes, worker) {
        await Promise.all(worker.renderBatched(nodes, this.renderer));
        return nodes.map(node => worker.getRendering(node));
    }
}
class NodeRenderer {
    constructor(engine) {
        this.engine = engine;
        this.super = new SuperRenderer(this);
    }
    /**
     * Render the given group of nodes.
     * The indices of the DomObject list match the indices of the given nodes
     * list.
     *
     * @param node
     */
    renderBatch(nodes, worker) {
        return Promise.all(nodes.map(node => this.render(node, worker)));
    }
}


/***/ }),

/***/ "./packages/plugin-renderer/src/Renderer.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-renderer/src/Renderer.ts ***!
  \**************************************************/
/*! exports provided: Renderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Renderer", function() { return Renderer; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Renderer extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loaders = {
            renderingEngines: this.loadRenderingEngines,
            renderers: this.loadRenderers,
        };
        this.engines = {};
    }
    /**
     * @override
     */
    stop() {
        this.engines = {};
        return super.stop();
    }
    async render(renderingId, nodes) {
        const engine = this.engines[renderingId];
        if (!engine) {
            // The caller might want to fallback on another rendering.
            return;
        }
        if (nodes instanceof Array) {
            const cache = await engine.render(nodes);
            nodes.map(node => cache.renderings.get(node));
        }
        else {
            const cache = await engine.render([nodes]);
            return cache.renderings.get(nodes);
        }
    }
    loadRenderingEngines(renderingEngines) {
        for (const EngineClass of renderingEngines) {
            const id = EngineClass.id;
            if (this.engines[id]) {
                throw new Error(`Rendering engine ${id} already registered.`);
            }
            const engine = new EngineClass(this.editor);
            this.engines[id] = engine;
        }
    }
    loadRenderers(renderers) {
        renderers = [...renderers].reverse();
        for (const RendererClass of renderers) {
            for (const id in this.engines) {
                const renderingEngine = this.engines[id];
                const supportedTypes = [id, ...renderingEngine.constructor.extends];
                if (supportedTypes.includes(RendererClass.id)) {
                    renderingEngine.register(RendererClass);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-renderer/src/RenderingEngine.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-renderer/src/RenderingEngine.ts ***!
  \*********************************************************/
/*! exports provided: RenderingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenderingEngine", function() { return RenderingEngine; });
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _NodeRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _RenderingEngineCache__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./RenderingEngineCache */ "./packages/plugin-renderer/src/RenderingEngineCache.ts");





let modifierId = 0;
class RenderingEngine {
    constructor(editor) {
        this.renderers = [];
        this.modifierRenderers = [];
        this.editor = editor;
        const defaultRenderer = new this.constructor.defaultRenderer(this);
        if (defaultRenderer.predicate) {
            throw new Error(`Default renderer cannot have a predicate.`);
        }
        else {
            this.renderers.push(defaultRenderer);
        }
        const defaultModifierRenderer = new this.constructor.defaultModifierRenderer(this);
        if (defaultModifierRenderer.predicate) {
            throw new Error(`Default renderer cannot have a predicate.`);
        }
        else {
            this.modifierRenderers.push(defaultModifierRenderer);
        }
    }
    /**
     * Register the given renderer by instantiating it with this rendering
     * engine. The renderer constructor will receive a special second parameter
     * which is a magic renderer whose `render` method will call the next
     * compatible renderer in line for the given node.
     *
     * @param RendererClass
     */
    register(RendererClass) {
        // Both input parameter types have the same features with respect to
        // what we are doing in this function. However, Typescript requires a
        // stronger typing for inserting them into an array. We chose to use a
        // blind, somewhat wrong, typecast to reduce the scope of the types
        // in order to avoid duplicating the logic of this function.
        const renderers = (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["isConstructor"])(RendererClass, _NodeRenderer__WEBPACK_IMPORTED_MODULE_2__["NodeRenderer"])
            ? this.renderers
            : this.modifierRenderers);
        RendererClass = RendererClass;
        if (RendererClass.id === this.constructor.id) {
            renderers.unshift(new RendererClass(this));
        }
        else {
            const supportedTypes = [this.constructor.id, ...this.constructor.extends];
            const priorRendererIds = supportedTypes.slice(0, supportedTypes.indexOf(RendererClass.id));
            const postRendererIndex = renderers.findIndex(parser => !priorRendererIds.includes(parser.constructor.id));
            renderers.splice(postRendererIndex, 0, new RendererClass(this));
        }
    }
    /**
     * Render the given node. If a prior rendering already exists for this node
     * in this run, return it directly.
     * The cache are automaticaly invalidate if the nodes are not linked to the
     * memory (linked to a layout root for eg)
     *
     * @param nodes
     */
    async render(nodes, cache) {
        if (!cache) {
            cache = new _RenderingEngineCache__WEBPACK_IMPORTED_MODULE_4__["RenderingEngineCache"]();
            cache.worker = {
                depends: this._depends.bind(this, cache),
                renderBatched: this.renderBatched.bind(this, cache),
                getCompatibleRenderer: this.getCompatibleRenderer.bind(this, cache),
                getCompatibleModifierRenderer: this.getCompatibleModifierRenderer.bind(this, cache),
                locate: this.locate.bind(this, cache),
                getRendering: (node) => cache.renderings.get(node),
                render: async (nodes) => {
                    await this.render(nodes, cache);
                    return nodes.map(node => cache.renderings.get(node));
                },
            };
        }
        const promises = this.renderBatched(cache, nodes.filter(node => !cache.renderingPromises.get(node)));
        await Promise.all(promises); // wait the newest promises
        await Promise.all(nodes.map(node => cache.renderingPromises.get(node))); // wait indifidual promise
        return cache;
    }
    /**
     * Indicates the location of the nodes in the rendering performed.
     *
     * For example, if you avec a 2 charNodes (X, Y) seperate by a linebreak
     * but, you want to display one text node, you can have a text node equal
     * to 'x_y' and indicate that it's [charNode, LineBreak, CharNode].
     * Or you want to display the Linebreak twice: 'x_y_' and indicate this
     * [charNode, LineBreak, CharNode, LineBreak]
     *
     * @param nodes
     * @param rendering
     */
    locate(cache, nodes, value) {
        cache.locations.set(value, nodes);
    }
    /**
     * Group the nodes and call the renderer 'renderBatch' method with the
     * different groups of nodes. By default each group is composed with only
     * one node.
     * The indices of the DomObject list match the indices of the given nodes
     * list.
     *
     * @see renderBatch
     *
     * @param nodes
     * @param rendered
     */
    renderBatched(cache, nodes, rendered) {
        const promises = [];
        for (const node of nodes) {
            const renderer = cache.worker.getCompatibleRenderer(node, rendered);
            const renderings = renderer.renderBatch(nodes, cache.worker);
            const promise = renderings.then(values => {
                const value = values[0];
                this._depends(cache, node, value);
                this._depends(cache, value, node);
                this._addDefaultLocation(cache, node, value);
                cache.renderings.set(node, value);
            });
            cache.renderingPromises.set(node, promise);
            promises.push(promise);
        }
        return promises;
    }
    /**
     * Return the first matche Renderer for this VNode, starting from the
     * previous renderer.
     *
     * @param node
     * @param previousRenderer
     */
    getCompatibleRenderer(cache, node, previousRenderer) {
        let cacheCompatible = cache.cachedCompatibleRenderer.get(node);
        if (!cacheCompatible) {
            cacheCompatible = new Map();
            cache.cachedCompatibleRenderer.set(node, cacheCompatible);
        }
        else if (cacheCompatible.get(previousRenderer)) {
            return cacheCompatible.get(previousRenderer);
        }
        let nextRendererIndex = this.renderers.indexOf(previousRenderer) + 1;
        let nextRenderer;
        do {
            nextRenderer = this.renderers[nextRendererIndex];
            nextRendererIndex++;
        } while (nextRenderer && !node.test(nextRenderer.predicate));
        cacheCompatible.set(previousRenderer, nextRenderer);
        return nextRenderer;
    }
    /**
     * Return the first matche Renderer for this VNode, starting from the
     * previous renderer.
     *
     * @param node
     * @param previousRenderer
     */
    getCompatibleModifierRenderer(cache, modifier, previousRenderer) {
        let cacheCompatible = cache.cachedCompatibleModifierRenderer.get(modifier);
        if (!cacheCompatible) {
            cacheCompatible = new Map();
            cache.cachedCompatibleModifierRenderer.set(modifier, cacheCompatible);
        }
        else if (cacheCompatible.get(previousRenderer)) {
            return cacheCompatible.get(previousRenderer);
        }
        let nextRendererIndex = this.modifierRenderers.indexOf(previousRenderer) + 1;
        let nextRenderer;
        do {
            nextRenderer = this.modifierRenderers[nextRendererIndex];
            nextRendererIndex++;
        } while (nextRenderer.predicate &&
            !(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["isConstructor"])(nextRenderer.predicate, _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__["Modifier"])
                ? modifier instanceof nextRenderer.predicate
                : nextRenderer.predicate(modifier)));
        cacheCompatible.set(previousRenderer, nextRenderer);
        return nextRenderer;
    }
    _depends(cache, dependent, dependency) {
        let dNode;
        let dRendering;
        let dyNode;
        let dyRendering;
        if (dependent instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"] || dependent instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__["Modifier"]) {
            dNode = dependent;
        }
        else {
            dRendering = dependent;
        }
        if (dependency instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_3__["AbstractNode"] || dependency instanceof _core_src_Modifier__WEBPACK_IMPORTED_MODULE_1__["Modifier"]) {
            dyNode = dependency;
        }
        else {
            dyRendering = dependency;
        }
        if (dNode) {
            if (dyNode) {
                const linked = cache.linkedNodes.get(dyNode);
                if (linked) {
                    linked.add(dNode);
                }
                else {
                    cache.linkedNodes.set(dyNode, new Set([dNode]));
                }
            }
            else {
                const from = cache.renderingDependent.get(dyRendering);
                if (from) {
                    from.add(dNode);
                }
                else {
                    cache.renderingDependent.set(dyRendering, new Set([dNode]));
                }
            }
        }
        else if (dyNode) {
            const linked = cache.nodeDependent.get(dyNode);
            if (linked) {
                linked.add(dRendering);
            }
            else {
                cache.nodeDependent.set(dyNode, new Set([dRendering]));
            }
        }
    }
    _addDefaultLocation(cache, node, value) {
        cache.locations.set(value, [node]);
    }
    _modifierIsSameAs(cache, modifierA, modifierB) {
        if (modifierA === modifierB) {
            return true;
        }
        let idA = modifierA ? cache.cachedModifierId.get(modifierA) : 'null';
        if (!idA) {
            idA = ++modifierId;
            cache.cachedModifierId.set(modifierA, idA);
        }
        let idB = modifierB ? cache.cachedModifierId.get(modifierB) : 'null';
        if (!idB) {
            idB = ++modifierId;
            cache.cachedModifierId.set(modifierB, idB);
        }
        const key = idA > idB ? idA + '-' + idB : idB + '-' + idA;
        if (key in cache.cachedIsSameAsModifier) {
            return cache.cachedIsSameAsModifier[key];
        }
        const isSame = (!modifierA || modifierA.isSameAs(modifierB)) &&
            (!modifierB || modifierB.isSameAs(modifierA));
        cache.cachedIsSameAsModifier[key] = isSame;
        if (!cache.cachedIsSameAsModifierIds[idA]) {
            cache.cachedIsSameAsModifierIds[idA] = [key];
        }
        else {
            cache.cachedIsSameAsModifierIds[idA].push(key);
        }
        if (!cache.cachedIsSameAsModifierIds[idB]) {
            cache.cachedIsSameAsModifierIds[idB] = [key];
        }
        else {
            cache.cachedIsSameAsModifierIds[idB].push(key);
        }
        return isSame;
    }
}
RenderingEngine.extends = [];


/***/ }),

/***/ "./packages/plugin-renderer/src/RenderingEngineCache.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-renderer/src/RenderingEngineCache.ts ***!
  \**************************************************************/
/*! exports provided: RenderingEngineCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenderingEngineCache", function() { return RenderingEngineCache; });
class RenderingEngineCache {
    constructor() {
        // Rendering created by a VNode.
        this.renderings = new Map();
        // Promise resolved when the renderings is ready. We can have a value in renderings before the
        // promise is resolved but it's not the complete value (for eg: we create the node and an other
        // renderer add the attributes on this node)
        this.renderingPromises = new Map();
        // VNodes locations in a rendering (by default the rendering is equal to the location).
        this.locations = new Map();
        // List of VNode and Modifiers linked to a rendering.
        // When the rendering is invalidated every VNode or Modifier will be invalidated.
        this.renderingDependent = new Map();
        // When the VNode or Modifier is invalidated every rendering will be invalidated.
        this.nodeDependent = new Map();
        // When the dependency is invalidated every dependents will be invalidated.
        this.linkedNodes = new Map();
        // Cache for founded renderer.
        this.cachedCompatibleRenderer = new Map();
        this.cachedCompatibleModifierRenderer = new Map();
        // Cache to compare modifiers.
        this.cachedModifierId = new Map();
        this.cachedIsSameAsModifier = {};
        // Used to invalidate the cachedIsSameAsModifier values.
        this.cachedIsSameAsModifierIds = {};
    }
}


/***/ }),

/***/ "./packages/plugin-shadow/src/Shadow.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-shadow/src/Shadow.ts ***!
  \**********************************************/
/*! exports provided: Shadow */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Shadow", function() { return Shadow; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _ShadowHtmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ShadowHtmlDomParser */ "./packages/plugin-shadow/src/ShadowHtmlDomParser.ts");
/* harmony import */ var _ShadowXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ShadowXmlDomParser */ "./packages/plugin-shadow/src/ShadowXmlDomParser.ts");
/* harmony import */ var _ShadowDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ShadowDomObjectRenderer */ "./packages/plugin-shadow/src/ShadowDomObjectRenderer.ts");






class Shadow extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ShadowXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["ShadowXmlDomParser"], _ShadowHtmlDomParser__WEBPACK_IMPORTED_MODULE_3__["ShadowHtmlDomParser"]],
            renderers: [_ShadowDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["ShadowDomObjectRenderer"]],
        };
    }
}
Shadow.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"]];


/***/ }),

/***/ "./packages/plugin-shadow/src/ShadowDomObjectRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-shadow/src/ShadowDomObjectRenderer.ts ***!
  \***************************************************************/
/*! exports provided: ShadowDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShadowDomObjectRenderer", function() { return ShadowDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _ShadowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ShadowNode */ "./packages/plugin-shadow/src/ShadowNode.ts");
/* harmony import */ var _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-metadata/src/MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");




class ShadowDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ShadowNode__WEBPACK_IMPORTED_MODULE_2__["ShadowNode"];
    }
    async render(shadow) {
        const domObject = {
            tag: 'JW-SHADOW',
            shadowRoot: true,
            children: shadow.childVNodes.filter(child => child.tangible || child instanceof _plugin_metadata_src_MetadataNode__WEBPACK_IMPORTED_MODULE_3__["MetadataNode"]),
        };
        return domObject;
    }
}
ShadowDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-shadow/src/ShadowHtmlDomParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-shadow/src/ShadowHtmlDomParser.ts ***!
  \***********************************************************/
/*! exports provided: ShadowHtmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShadowHtmlDomParser", function() { return ShadowHtmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_html_src_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomParsingEngine */ "./packages/plugin-html/src/HtmlDomParsingEngine.ts");
/* harmony import */ var _ShadowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ShadowNode */ "./packages/plugin-shadow/src/ShadowNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");





class ShadowHtmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof HTMLElement && !!item.shadowRoot;
        };
    }
    /**
     * Parse a shadow node and extract styling from shadow root.
     *
     * @param item
     */
    async parse(item) {
        const shadowRoot = item.shadowRoot;
        const shadow = new _ShadowNode__WEBPACK_IMPORTED_MODULE_2__["ShadowNode"]();
        const childNodes = Array.from(shadowRoot.childNodes);
        const nodes = await this.engine.parse(...childNodes);
        shadow.append(...nodes);
        if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'JW-SHADOW') {
            return [shadow];
        }
        else {
            const element = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_4__["VElement"]({ htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) });
            const attributes = this.engine.parseAttributes(item);
            if (attributes.length) {
                element.modifiers.append(attributes);
            }
            element.append(shadow);
            return [element];
        }
    }
}
ShadowHtmlDomParser.id = _plugin_html_src_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-shadow/src/ShadowNode.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-shadow/src/ShadowNode.ts ***!
  \**************************************************/
/*! exports provided: ShadowNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShadowNode", function() { return ShadowNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class ShadowNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor() {
        super(...arguments);
        this.editable = false;
        this.breakable = false;
    }
}


/***/ }),

/***/ "./packages/plugin-shadow/src/ShadowXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-shadow/src/ShadowXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ShadowXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShadowXmlDomParser", function() { return ShadowXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _ShadowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ShadowNode */ "./packages/plugin-shadow/src/ShadowNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ShadowXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-SHADOW';
        };
    }
    /**
     * Parse a shadow node and extract styling.
     *
     * @param item
     */
    async parse(item) {
        const shadow = new _ShadowNode__WEBPACK_IMPORTED_MODULE_2__["ShadowNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            shadow.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        shadow.append(...nodes);
        return [shadow];
    }
}
ShadowXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-span/src/Span.ts":
/*!******************************************!*\
  !*** ./packages/plugin-span/src/Span.ts ***!
  \******************************************/
/*! exports provided: Span */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Span", function() { return Span; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SpanXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SpanXmlDomParser */ "./packages/plugin-span/src/SpanXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Span extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SpanXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SpanXmlDomParser"]],
        };
    }
}
Span.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-span/src/SpanFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-span/src/SpanFormat.ts ***!
  \************************************************/
/*! exports provided: SpanFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpanFormat", function() { return SpanFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class SpanFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'SPAN') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-span/src/SpanXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-span/src/SpanXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: SpanXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpanXmlDomParser", function() { return SpanXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _SpanFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SpanFormat */ "./packages/plugin-span/src/SpanFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");




class SpanXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'SPAN' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'FONT');
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const span = new _SpanFormat__WEBPACK_IMPORTED_MODULE_1__["SpanFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item));
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            span.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        // Handle empty spans.
        if (!children.length) {
            children.push(new _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]());
        }
        this.applyFormat(span, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-subscript/src/Subscript.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-subscript/src/Subscript.ts ***!
  \****************************************************/
/*! exports provided: Subscript */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subscript", function() { return Subscript; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SubscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubscriptXmlDomParser */ "./packages/plugin-subscript/src/SubscriptXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Subscript extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SubscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SubscriptXmlDomParser"]],
        };
    }
}
Subscript.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-subscript/src/SubscriptFormat.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-subscript/src/SubscriptFormat.ts ***!
  \**********************************************************/
/*! exports provided: SubscriptFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubscriptFormat", function() { return SubscriptFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class SubscriptFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super('SUB');
    }
}


/***/ }),

/***/ "./packages/plugin-subscript/src/SubscriptXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-subscript/src/SubscriptXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: SubscriptXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubscriptXmlDomParser", function() { return SubscriptXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _SubscriptFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubscriptFormat */ "./packages/plugin-subscript/src/SubscriptFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class SubscriptXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'SUB';
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const subscript = new _SubscriptFormat__WEBPACK_IMPORTED_MODULE_1__["SubscriptFormat"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            subscript.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(subscript, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-superscript/src/Superscript.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-superscript/src/Superscript.ts ***!
  \********************************************************/
/*! exports provided: Superscript */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Superscript", function() { return Superscript; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SuperscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SuperscriptXmlDomParser */ "./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Superscript extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SuperscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SuperscriptXmlDomParser"]],
        };
    }
}
Superscript.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-superscript/src/SuperscriptFormat.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-superscript/src/SuperscriptFormat.ts ***!
  \**************************************************************/
/*! exports provided: SuperscriptFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuperscriptFormat", function() { return SuperscriptFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class SuperscriptFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super('SUP');
    }
}


/***/ }),

/***/ "./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts ***!
  \********************************************************************/
/*! exports provided: SuperscriptXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuperscriptXmlDomParser", function() { return SuperscriptXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _SuperscriptFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SuperscriptFormat */ "./packages/plugin-superscript/src/SuperscriptFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class SuperscriptXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'SUP';
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const superscript = new _SuperscriptFormat__WEBPACK_IMPORTED_MODULE_1__["SuperscriptFormat"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            superscript.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(superscript, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-table/assets/tableUI.css":
/*!**************************************************!*\
  !*** ./packages/plugin-table/assets/tableUI.css ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./tableUI.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-table/assets/tableUI.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-table/src/Table.ts":
/*!********************************************!*\
  !*** ./packages/plugin-table/src/Table.ts ***!
  \********************************************/
/*! exports provided: Table */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Table", function() { return Table; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _TableXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableXmlDomParser */ "./packages/plugin-table/src/TableXmlDomParser.ts");
/* harmony import */ var _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowXmlDomParser */ "./packages/plugin-table/src/TableRowXmlDomParser.ts");
/* harmony import */ var _TableCellXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TableCellXmlDomParser */ "./packages/plugin-table/src/TableCellXmlDomParser.ts");
/* harmony import */ var _TableDomObjectRenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableDomObjectRenderer */ "./packages/plugin-table/src/TableDomObjectRenderer.ts");
/* harmony import */ var _TableRowDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TableRowDomObjectRenderer */ "./packages/plugin-table/src/TableRowDomObjectRenderer.ts");
/* harmony import */ var _TableCellDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TableCellDomObjectRenderer */ "./packages/plugin-table/src/TableCellDomObjectRenderer.ts");
/* harmony import */ var _TableSectionAttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./TableSectionAttributesDomObjectModifierRenderer */ "./packages/plugin-table/src/TableSectionAttributesDomObjectModifierRenderer.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _TablePickerDomObjectRenderer__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./TablePickerDomObjectRenderer */ "./packages/plugin-table/src/TablePickerDomObjectRenderer.ts");
/* harmony import */ var _TablePickerCellDomObjectRenderer__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./TablePickerCellDomObjectRenderer */ "./packages/plugin-table/src/TablePickerCellDomObjectRenderer.ts");
/* harmony import */ var _TablePickerNode__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./TablePickerNode */ "./packages/plugin-table/src/TablePickerNode.ts");
/* harmony import */ var _assets_tableUI_css__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../assets/tableUI.css */ "./packages/plugin-table/assets/tableUI.css");
/* harmony import */ var _assets_tableUI_css__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(_assets_tableUI_css__WEBPACK_IMPORTED_MODULE_19__);




















class Table extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, config) {
        super(editor, config);
        this.editor = editor;
        this.config = config;
        this.loadables = {
            parsers: [_TableXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["TableXmlDomParser"], _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["TableRowXmlDomParser"], _TableCellXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["TableCellXmlDomParser"]],
            renderers: [
                _TablePickerDomObjectRenderer__WEBPACK_IMPORTED_MODULE_16__["TablePickerDomObjectRenderer"],
                _TablePickerCellDomObjectRenderer__WEBPACK_IMPORTED_MODULE_17__["TablePickerCellDomObjectRenderer"],
                _TableDomObjectRenderer__WEBPACK_IMPORTED_MODULE_4__["TableDomObjectRenderer"],
                _TableRowDomObjectRenderer__WEBPACK_IMPORTED_MODULE_5__["TableRowDomObjectRenderer"],
                _TableCellDomObjectRenderer__WEBPACK_IMPORTED_MODULE_6__["TableCellDomObjectRenderer"],
                _TableSectionAttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_7__["TableSectionAttributesDomObjectModifierRenderer"],
            ],
            shortcuts: [
                {
                    pattern: 'CTRL+<Slash>',
                    commandId: 'addRowBelow',
                },
                {
                    pattern: 'CTRL+SHIFT+<Slash>',
                    commandId: 'addRowAbove',
                },
                {
                    pattern: 'CTRL+<Equal>',
                    commandId: 'addColumnAfter',
                },
                {
                    pattern: 'CTRL+SHIFT+<Equal>',
                    commandId: 'addColumnBefore',
                },
                {
                    pattern: 'CTRL+SHIFT+DELETE',
                    commandId: 'deleteRow',
                },
                {
                    pattern: 'CTRL+SHIFT+BACKSPACE',
                    commandId: 'deleteColumn',
                },
                {
                    pattern: 'CTRL+ALT+SHIFT+DELETE',
                    commandId: 'deleteTable',
                },
                {
                    pattern: 'CTRL+<Period>',
                    commandId: 'mergeCells',
                },
                {
                    pattern: 'CTRL+SHIFT+<Period>',
                    commandId: 'unmergeCells',
                },
            ],
            components: [
                {
                    id: 'TableButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_13__["ActionableNode"]({
                            name: 'tableButton',
                            label: 'Pick the size of the table you want to insert',
                            commandId: 'insertTable',
                            selected: (editor) => editor.plugins.get(Table).isTablePickerOpen,
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_15__["Attributes"]({ class: 'fa fa-table fa-fw' })],
                        });
                        return [button];
                    },
                },
                {
                    id: 'TablePicker',
                    async render(editor) {
                        const tablePlugin = editor.plugins.get(Table);
                        const table = new _TablePickerNode__WEBPACK_IMPORTED_MODULE_18__["TablePickerNode"]({
                            rowCount: tablePlugin.minRowCount,
                            columnCount: tablePlugin.minColumnCount,
                        });
                        return [table];
                    },
                },
            ],
            componentZones: [['TableButton', ['actionables']]],
        };
        this.commands = {
            insertTable: {
                handler: this.insertTable.bind(this),
            },
            addRowAbove: {
                handler: this.addRowAbove.bind(this),
            },
            addRowBelow: {
                handler: this.addRowBelow.bind(this),
            },
            addColumnBefore: {
                handler: this.addColumnBefore.bind(this),
            },
            addColumnAfter: {
                handler: this.addColumnAfter.bind(this),
            },
            deleteRow: {
                handler: this.deleteRow.bind(this),
            },
            deleteColumn: {
                handler: this.deleteColumn.bind(this),
            },
            deleteTable: {
                handler: this.deleteTable.bind(this),
            },
            mergeCells: {
                handler: this.mergeCells.bind(this),
            },
            unmergeCells: {
                handler: this.unmergeCells.bind(this),
            },
        };
        this.isTablePickerOpen = false;
        /**
         * The minimum row count for the table picker (default: 5).
         */
        this.minRowCount = 5;
        /**
         * The minimum column count for the table picker (default: 5).
         */
        this.minColumnCount = 5;
        /**
         * If true, add UI buttons inline in the table on render to add/remove
         * columns/rows.
         */
        this.inlineUI = false;
        if (config.minRowCount) {
            this.minRowCount = config.minRowCount;
        }
        if (config.minColumnCount) {
            this.minColumnCount = config.minColumnCount;
        }
        this.inlineUI = !!config.inlineUI;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert a table at range. If no dimensions are given for the table, open
     * the table picker in order to ask the user for dimensions.
     *
     * @param params
     */
    async insertTable(params) {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_14__["Layout"]);
        if (this.isTablePickerOpen) {
            await layout.remove('TablePicker');
        }
        if (!params.rowCount || !params.columnCount) {
            this.editor.memoryInfo.uiCommand = true;
            if (!this.isTablePickerOpen) {
                await layout.append('TablePicker', 'TableButton');
            }
        }
        else {
            const range = params.context.range;
            if (range.start.parent) {
                range.start.before(new _TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"](params));
            }
        }
    }
    /**
     * Add a row above the cell at given range start.
     *
     * @param params
     */
    addRowAbove(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"]).addRowAbove(cell);
    }
    /**
     * Add a row below the cell at given range start.
     *
     * @param params
     */
    addRowBelow(params) {
        const range = params.context.range;
        const row = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!row)
            return;
        row.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"]).addRowBelow(row);
    }
    /**
     * Add a column before the cell at given range start.
     *
     * @param params
     */
    addColumnBefore(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"]).addColumnBefore(cell);
    }
    /**
     * Add a column after the cell at given range start.
     *
     * @param params
     */
    addColumnAfter(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"]).addColumnAfter(cell);
    }
    /**
     * Delete the row at given range start.
     *
     * @param params
     */
    deleteRow(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!cell)
            return;
        const row = cell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_11__["TableRowNode"]);
        const nextRow = row.nextSibling(_TableRowNode__WEBPACK_IMPORTED_MODULE_11__["TableRowNode"]) || row.previousSibling(_TableRowNode__WEBPACK_IMPORTED_MODULE_11__["TableRowNode"]);
        const nextCell = nextRow && nextRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"])[cell.columnIndex];
        if (nextCell) {
            const nextRowIndex = nextCell.rowIndex;
            // Handle rowspans.
            const cells = row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
            for (const cell of cells) {
                if (cell.rowspan > 1) {
                    // Cells managed by this cell will now be managed by the
                    // cell below (or above if there is none below) instead.
                    const belowCell = Array.from(cell.managedCells).find(managedCell => managedCell.rowIndex === nextRowIndex);
                    if (belowCell) {
                        belowCell.unmerge();
                        for (const managedCell of cell.managedCells) {
                            if (managedCell !== belowCell) {
                                managedCell.mergeWith(belowCell);
                            }
                        }
                    }
                }
                else if (!cell.isActive()) {
                    // If this cell is inactive, unmerge it so its manager
                    // doesn't believe it still manages it.
                    cell.unmerge();
                }
            }
            // Remove the row.
            row.remove();
            // The place where the range used to live was just demolished. Give
            // it shelter within the next active cell.
            const nextActiveCell = nextCell.managerCell || nextCell;
            range.setStart(nextActiveCell.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_12__["RelativePosition"].BEFORE);
            range.collapse();
        }
        else {
            // If there is no `nextCell`, we're trying to delete the only row in
            // this table so just remove the table.
            this.deleteTable(params);
        }
    }
    /**
     * Delete the column at given range start.
     *
     * @param params
     */
    deleteColumn(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (!cell)
            return;
        const column = cell.column;
        const nextCell = cell.nextSibling(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]) || cell.previousSibling(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (nextCell) {
            const nextColumnIndex = nextCell.columnIndex;
            // Handle colspans and cell removal.
            for (const cell of column) {
                if (cell.colspan > 1) {
                    // Cells managed by this cell will now be managed by the
                    // cell after (or before if there is none after) instead.
                    const afterCell = Array.from(cell.managedCells).find(managedCell => managedCell.columnIndex === nextColumnIndex);
                    if (afterCell) {
                        afterCell.unmerge();
                        for (const managedCell of cell.managedCells) {
                            if (managedCell !== afterCell) {
                                managedCell.mergeWith(afterCell);
                            }
                        }
                    }
                }
                else if (!cell.isActive()) {
                    // If this cell is inactive, unmerge it so its manager
                    // doesn't believe it still manages it.
                    cell.unmerge();
                }
                // Remove the cell.
                cell.remove();
                // The place where the range used to live was just demolished.
                // Give it shelter within the next active cell.
                const nextManagerCell = nextCell.managerCell || nextCell;
                range.setStart(nextManagerCell.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_12__["RelativePosition"].BEFORE);
                range.collapse();
            }
        }
        else {
            // If there is no `nextCell`, we're trying to delete the only column
            // in this table so just remove the table.
            this.deleteTable(params);
        }
    }
    /**
     * Delete the table at given range start.
     *
     * @param params
     */
    deleteTable(params) {
        const range = params.context.range;
        const table = range.start.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_9__["TableNode"]);
        if (!table)
            return;
        const nextSibling = table.nextSibling();
        const previousSibling = table.previousSibling();
        if (nextSibling) {
            range.setStart(nextSibling.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_12__["RelativePosition"].BEFORE);
            range.collapse();
        }
        else if (previousSibling) {
            range.setStart(previousSibling.lastLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_12__["RelativePosition"].AFTER);
            range.collapse();
        }
        table.remove();
    }
    /**
     * Merge the cells at given range into the first cell at given range.
     *
     * @param params
     */
    mergeCells(params) {
        const range = params.context.range;
        const cells = range.targetedNodes(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        if (this._isRectangle(cells)) {
            // Only merge the cells if they would not imply to merge
            // unrelated cells, ie. the selected cells form a rectangle.
            const managerCell = cells.shift();
            const Separator = this.editor.configuration.defaults.Separator;
            for (const cell of cells) {
                if (managerCell.hasChildren()) {
                    managerCell.append(new Separator());
                }
                cell.mergeWith(managerCell);
            }
        }
    }
    /**
     * Unmerge previously merged cells at given range.
     *
     * @param params
     */
    unmergeCells(params) {
        const range = params.context.range;
        const cells = range.targetedNodes(_TableCellNode__WEBPACK_IMPORTED_MODULE_8__["TableCellNode"]);
        for (const cell of cells) {
            for (const managedCell of cell.managedCells) {
                managedCell.unmerge();
            }
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given array of cells forms a rectangle in the table
     * grid.
     *
     * @param cells
     */
    _isRectangle(cells) {
        cells = [...cells];
        // Add managed cells to the list.
        for (const cell of [...cells]) {
            if (cell.managedCells.size) {
                cells.push(...cell.managedCells);
            }
        }
        cells = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_10__["distinct"])(cells);
        // Compute the row/column index extrema.
        const rowIndices = cells.map(cell => cell.rowIndex);
        const columnIndices = cells.map(cell => cell.columnIndex);
        const minRowIndex = Math.min(...rowIndices);
        const minColumnIndex = Math.min(...columnIndices);
        const maxRowIndex = Math.max(...rowIndices);
        const maxColumnIndex = Math.max(...columnIndices);
        // If a cell between the extrema cannot be found in the list, the
        // selected cells do not form a rectangle.
        for (let rowIndex = minRowIndex; rowIndex <= maxRowIndex; rowIndex++) {
            for (let columnIndex = minColumnIndex; columnIndex <= maxColumnIndex; columnIndex++) {
                const cell = cells.find(cell => {
                    return cell.rowIndex === rowIndex && cell.columnIndex === columnIndex;
                });
                if (!cell) {
                    return false;
                }
            }
        }
        return true;
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableCellDomObjectRenderer.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-table/src/TableCellDomObjectRenderer.ts ***!
  \*****************************************************************/
/*! exports provided: TableCellDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellDomObjectRenderer", function() { return TableCellDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _Table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");






class TableCellDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableCellNode__WEBPACK_IMPORTED_MODULE_1__["TableCellNode"];
    }
    async render(cell) {
        // If the cell is not active, do not render it (it means it is
        // represented by its manager cell's colspan or rowspan: it was merged).
        // TODO: remove `TableNode` check: it's a temporary fix for the memory
        // system, which should not try to render the cell if it's not in the
        // VDocument.
        if (!cell.isActive() || !cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_5__["TableNode"]))
            return { children: [] };
        // Render the cell and its contents.
        const domObject = {
            tag: cell.header ? 'TH' : 'TD',
            children: await this.engine.renderChildren(cell),
            attributes: {},
        };
        // Colspan and rowspan are handled differently from other attributes:
        // they are automatically calculated in function of the cell's managed
        // cells. Render them here. If their value is 1 or less, they are
        // insignificant so no need to render them.
        if (cell.colspan > 1) {
            domObject.attributes.colspan = cell.colspan.toString();
        }
        if (cell.rowspan > 1) {
            domObject.attributes.rowspan = cell.rowspan.toString();
        }
        // Add buttons.
        const table = this.engine.editor.plugins.get(_Table__WEBPACK_IMPORTED_MODULE_4__["Table"]);
        if (table.inlineUI && this.engine.editor.selection.range.isIn(cell)) {
            // Add row below.
            const rowBelowObject = this._makeButton('addRowBelow', cell, 'fa-plus-square');
            domObject.children.push(rowBelowObject);
            // Delete row.
            const deleteRowObject = this._makeButton('deleteRow', cell, 'fa-minus-square');
            domObject.children.push(deleteRowObject);
            // Add row above.
            const rowAboveObject = this._makeButton('addRowAbove', cell, 'fa-plus-square');
            domObject.children.push(rowAboveObject);
            // Add column before.
            const columnBeforeObject = this._makeButton('addColumnBefore', cell, 'fa-plus-square');
            domObject.children.push(columnBeforeObject);
            // Delete column.
            const deleteColumnObject = this._makeButton('deleteColumn', cell, 'fa-minus-square');
            domObject.children.push(deleteColumnObject);
            // Add column after.
            const columnAfterObject = this._makeButton('addColumnAfter', cell, 'fa-plus-square');
            domObject.children.push(columnAfterObject);
            // Position the buttons.
            domObject.attach = (domNode) => {
                const box = domNode.getBoundingClientRect();
                const top = window.scrollY + box.top;
                const bottom = window.scrollY + box.top + box.height;
                const middleX = box.left + box.width / 2;
                this._positionButton(rowAboveObject, top, middleX - 9);
                this._positionButton(deleteRowObject, top, middleX + 9);
                this._positionButton(rowBelowObject, bottom, middleX);
                const middleY = window.scrollY + box.top + box.height / 2;
                const left = box.left;
                const right = box.left + box.width;
                this._positionButton(columnBeforeObject, middleY - 9, left);
                this._positionButton(deleteColumnObject, middleY + 9, left);
                this._positionButton(columnAfterObject, middleY, right);
            };
        }
        return domObject;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Create a DomObjectNative representing a button that executes the give
     * command with a range at the given reference cell. If `remove` is true,
     * make a "minus" button. Otherwise, make it a "plus" button.
     *
     * @param commandId
     * @param referenceCell
     * @param faClass
     */
    _makeButton(commandId, referenceCell, faClass) {
        const rowAboveButton = document.createElement('span');
        rowAboveButton.className = 'fa ' + faClass + ' fa-fw table-handler';
        const rowAboveObject = { dom: [rowAboveButton] };
        const callback = async () => this.engine.editor.execWithRange(_core_src_VRange__WEBPACK_IMPORTED_MODULE_3__["VRange"].at(referenceCell), commandId);
        rowAboveObject.attach = (...domNodes) => {
            for (const domNode of domNodes) {
                domNode.addEventListener('click', callback);
            }
        };
        rowAboveObject.detach = (...domNodes) => {
            for (const domNode of domNodes) {
                domNode.removeEventListener('click', callback);
            }
        };
        return rowAboveObject;
    }
    /**
     * Position the button represented by a DomObjectNative at the given top and
     * left coordinates, taking into account the dimensions of the button
     * itself.
     *
     * @param buttonObject
     * @param top
     * @param left
     */
    _positionButton(buttonObject, top, left) {
        const button = buttonObject.dom[0];
        const buttonBox = button.getBoundingClientRect();
        button.style.top = top - buttonBox.height / 2 + 'px';
        button.style.left = left - buttonBox.width / 2 + 'px';
    }
}
TableCellDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableCellNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-table/src/TableCellNode.ts ***!
  \****************************************************/
/*! exports provided: TableCellNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellNode", function() { return TableCellNode; });
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_Memory_VersionableSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/Memory/VersionableSet */ "./packages/core/src/Memory/VersionableSet.ts");




class TableCellNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"] {
    constructor(params) {
        super(params);
        this.breakable = false;
        this.__managedCells = new _core_src_Memory_VersionableSet__WEBPACK_IMPORTED_MODULE_3__["VersionableSet"]();
        this.header = (params === null || params === void 0 ? void 0 : params.header) || false;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            header: this.header,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        let coordinatesRepr = ' <(' + this.rowIndex + ', ' + this.columnIndex + ')';
        if (this.colspan > 1 || this.rowspan > 1) {
            const endRow = this.rowIndex + this.rowspan - 1;
            const endColumn = this.columnIndex + this.colspan - 1;
            coordinatesRepr += ':(' + endRow + ', ' + endColumn + ')';
        }
        coordinatesRepr += '>';
        return (super.name +
            coordinatesRepr +
            (this.header ? ': header' : '') +
            (this.isActive() ? '' : ' (inactive)'));
    }
    /**
     * Return the cell that manages this cell, if any.
     */
    get managerCell() {
        return this.__managerCell;
    }
    /**
     * Return the set of cells that this cell manages.
     */
    get managedCells() {
        return new Set(this.__managedCells);
    }
    /**
     * Return the computed column span of this cell, in function of its managed
     * cells.
     */
    get colspan() {
        const cellsArray = Array.from(this.managedCells);
        const sameRowCells = cellsArray.filter(cell => cell.rowIndex === this.rowIndex);
        return 1 + sameRowCells.length;
    }
    /**
     * Return the computed row span of this cell, in function of its managed
     * cells.
     */
    get rowspan() {
        const cellsArray = Array.from(this.managedCells);
        const sameColumnCells = cellsArray.filter(cell => cell.columnIndex === this.columnIndex);
        return 1 + sameColumnCells.length;
    }
    /**
     * Return the row to which this cell belongs.
     */
    get row() {
        return this.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).children(TableCellNode);
    }
    /**
     * Return the column to which this cell belongs, as an array of cells.
     */
    get column() {
        return this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]).columns[this.columnIndex];
    }
    /**
     * Return the index of the row to which this cell belongs.
     */
    get rowIndex() {
        return this.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).rowIndex;
    }
    /**
     * Return the index of the column to which this cell belongs.
     */
    get columnIndex() {
        return this.parent.children(TableCellNode).indexOf(this);
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if this cell is active (ie not managed by another cell).
     */
    isActive() {
        return !this.managerCell;
    }
    /**
     * Set the given cell as manager of this cell.
     * Note: A cell managed by another cell also copies its manager's attributes
     * and properties and hands over its children to its manager.
     *
     * @override
     */
    mergeWith(newManager) {
        const thisTable = this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]);
        const otherTable = newManager.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]);
        if (!(newManager instanceof TableCellNode) || thisTable !== otherTable)
            return;
        this.__managerCell = newManager;
        newManager.manage(this);
    }
    /**
     * Unmerge this cell from its manager.
     */
    unmerge() {
        const manager = this.__managerCell;
        if (manager) {
            this.__managerCell = null;
            // If we just removed this cell's manager, also remove this cell
            // from the old manager's managed cells.
            manager.unmanage(this);
        }
    }
    /**
     * Set the given cell as managed by this cell.
     * Note: A cell managed by another cell also copies its manager's modifiers
     * and properties and hands over its children to its manager.
     *
     * @param cell
     */
    manage(cell) {
        this.__managedCells.add(cell);
        // Copy the manager's modifiers and properties.
        cell.modifiers = this.modifiers.clone();
        cell.header = this.header;
        // Move the children to the manager.
        this.append(...cell.childVNodes);
        // Hand the managed cells over to the manager.
        for (const managedCell of cell.managedCells) {
            managedCell.mergeWith(this);
            cell.unmanage(managedCell);
        }
        // Copy the manager's row if an entire row was merged
        const row = cell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
        if (row) {
            const cells = row.children(TableCellNode);
            const rowIsMerged = cells.every(rowCell => rowCell.managerCell === this);
            if (rowIsMerged) {
                const managerRow = cell.managerCell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
                row.header = managerRow.header;
                row.modifiers = managerRow.modifiers.clone();
            }
        }
        // Ensure reciprocity.
        if (cell.managerCell !== this) {
            cell.mergeWith(this);
        }
    }
    /**
     * Restore the independence of the given cell.
     *
     * @param cell
     */
    unmanage(cell) {
        this.__managedCells.delete(cell);
        // Ensure reciprocity.
        if (cell.managerCell === this) {
            cell.unmerge();
        }
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableCellXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-table/src/TableCellXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: TableCellXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellXmlDomParser", function() { return TableCellXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class TableCellXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
            return name === 'TD' || name === 'TH';
        };
    }
    /**
     * Parse a table cell node.
     *
     * @param item
     */
    async parse(item) {
        const cell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]({ header: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'TH' });
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            cell.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        cell.append(...children);
        return [cell];
    }
}
TableCellXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableDomObjectRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-table/src/TableDomObjectRenderer.ts ***!
  \*************************************************************/
/*! exports provided: TableDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableDomObjectRenderer", function() { return TableDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableRowXmlDomParser */ "./packages/plugin-table/src/TableRowXmlDomParser.ts");





class TableDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableNode__WEBPACK_IMPORTED_MODULE_1__["TableNode"];
    }
    /**
     * Render the TableNode along with its contents (TableRowNodes).
     */
    async render(table, worker) {
        const objectTable = {
            tag: 'TABLE',
            children: [],
        };
        const objectHead = {
            tag: 'THEAD',
            children: [],
        };
        let objectBody = {
            tag: 'TBODY',
            children: [],
        };
        for (const child of table.children()) {
            if (child instanceof _TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"]) {
                // If the child is a row, append it to its containing section.
                const tableSection = child.header ? objectHead : objectBody;
                tableSection.children.push(child);
                this.engine.renderAttributes(_TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["TableSectionAttributes"], child, tableSection, worker);
                if (!objectTable.children.includes(tableSection)) {
                    objectTable.children.push(tableSection);
                }
            }
            else {
                objectTable.children.push(child);
                // Create a new <tbody> so the rest of the rows, if any, get
                // appended to it, after this element.
                objectBody = {
                    tag: 'TBODY',
                    children: [],
                };
            }
        }
        return objectTable;
    }
}
TableDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-table/src/TableNode.ts ***!
  \************************************************/
/*! exports provided: TableNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableNode", function() { return TableNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");



class TableNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super({ htmlTag: 'TABLE' });
        this.breakable = false;
        if (params && params.rowCount && params.columnCount) {
            this.reset(params.rowCount, params.columnCount);
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        return super.name + ': ' + this.rowCount + 'x' + this.columnCount;
    }
    /**
     * Return an array of rows in this table, as arrays of cells.
     */
    get rows() {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).map(row => row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]));
    }
    /**
     * Return an array of columns in this table, as arrays of cells.
     */
    get columns() {
        const columns = new Array(this.columnCount).fill(undefined);
        return columns.map((_, columnIndex) => this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).map(row => row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])[columnIndex]));
    }
    /**
     * Return the number of rows in this table.
     */
    get rowCount() {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).length;
    }
    /**
     * Return the number of columns in this table.
     */
    get columnCount() {
        return this.firstChild(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]).length;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the cell of this table that can be found at the given coordinates,
     * if any.
     *
     * @param rowIndex
     * @param columnIndex
     */
    getCellAt(rowIndex, columnIndex) {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"])[rowIndex].children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])[columnIndex];
    }
    /**
     * Add a new row above the reference row (the row of the given reference
     * cell). Copy the styles and colspans of the cells of the reference row. If
     * the reference row traverses a rowspan, extend that rowspan.
     * If no `referenceCell` was passed, add a row on top of the table.
     *
     * @param [referenceCell]
     */
    addRowAbove(referenceCell) {
        if (!referenceCell) {
            referenceCell = this.firstDescendant(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]);
        }
        const referenceRow = referenceCell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
        const newRow = referenceRow.clone();
        referenceRow.before(newRow);
        for (const cell of referenceRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])) {
            const clone = cell.clone();
            newRow.append(clone);
            // Handle managers.
            const manager = cell.managerCell;
            if (manager) {
                if (manager.rowIndex === referenceRow.rowIndex) {
                    // If the current cell's manager is in the reference row,
                    // the clone's manager should be that manager's clone.
                    const managerClone = this.getCellAt(newRow.rowIndex, manager.columnIndex);
                    clone.mergeWith(managerClone);
                }
                else {
                    clone.mergeWith(manager);
                }
            }
        }
    }
    /**
     * Add a new row below the reference row (the row of the given reference
     * cell). Copy the styles and colspans of the cells of the reference row. If
     * the reference row traverses a rowspan, extend that rowspan.
     * If no `referenceCell` was passed, add a row at the bottom of the table.
     * Note: a rowspan ending at the reference cell is not extended.
     *
     * @param [referenceCell]
     */
    addRowBelow(referenceCell) {
        if (!referenceCell) {
            referenceCell = this.lastDescendant(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]);
        }
        const rowIndex = referenceCell.rowIndex + referenceCell.rowspan - 1;
        const referenceRow = this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"])[rowIndex];
        const newRow = referenceRow.clone();
        referenceRow.after(newRow);
        for (const cell of referenceRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])) {
            const clone = cell.clone();
            newRow.append(clone);
            // Handle managers.
            if (cell.managerCell) {
                const manager = cell.managerCell;
                const managerEndRow = manager.rowIndex + manager.rowspan - 1;
                if (managerEndRow === rowIndex && manager.columnIndex !== cell.columnIndex) {
                    // Take the new row equivalent of the above cell's manager
                    // (copy colspan).
                    clone.mergeWith(this.getCellAt(newRow.rowIndex, manager.columnIndex));
                }
                else if (managerEndRow !== rowIndex) {
                    // Take the manager cell of the above cell (extend rowspan),
                    // only if said manager's rowspan is not ending with the
                    // above cell.
                    clone.mergeWith(manager);
                }
            }
            else if (cell.rowspan > 1) {
                // If the cell has a rowspan, extend it.
                clone.mergeWith(cell);
            }
        }
    }
    /**
     * Add a new column before the reference column (the column of the given
     * reference cell). Copy the styles and rowspans of the cells of the
     * reference column. If the reference column traverses a colspan, extend
     * that colspan.
     * If no `referenceCell` was passed, add a column to the left of the table.
     *
     * @param [referenceCell]
     */
    addColumnBefore(referenceCell) {
        if (!referenceCell) {
            referenceCell = this.firstDescendant(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]);
        }
        const referenceColumn = referenceCell.column;
        for (const cell of referenceColumn) {
            const clone = cell.clone();
            cell.before(clone);
            // Handle managers.
            const manager = cell.managerCell;
            if (manager) {
                if (manager.columnIndex === referenceCell.columnIndex) {
                    // If the current cell's manager is in the reference column,
                    // the clone's manager should be that manager's clone.
                    const managerClone = this.getCellAt(manager.rowIndex, clone.columnIndex);
                    clone.mergeWith(managerClone);
                }
                else {
                    clone.mergeWith(manager);
                }
            }
        }
    }
    /**
     * Add a new column after the reference column (the column of the given
     * reference cell). Copy the styles and rowspans of the cells of the
     * reference column. If the reference column traverses a colpan, extend that
     * colspan.
     * If no `referenceCell` was passed, add a column to the right of the table.
     * Note: a colspan ending at the reference cell is not extended.
     *
     * @param [referenceCell]
     */
    addColumnAfter(referenceCell) {
        if (!referenceCell) {
            referenceCell = this.lastDescendant(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]);
        }
        const columnIndex = referenceCell.columnIndex + referenceCell.colspan - 1;
        const referenceColumn = this.columns[columnIndex];
        for (const cell of referenceColumn) {
            const clone = cell.clone();
            cell.after(clone);
            // Handle managers.
            if (cell.managerCell) {
                const manager = cell.managerCell;
                const managerEndColumn = manager.columnIndex + manager.colspan - 1;
                if (managerEndColumn === columnIndex && manager.rowIndex !== cell.rowIndex) {
                    // Take the new column equivalent of the previous cell's
                    // manager (copy rowspan).
                    clone.mergeWith(this.getCellAt(manager.rowIndex, clone.columnIndex));
                }
                else if (managerEndColumn !== columnIndex) {
                    // Take the manager cell of the previous cell (extend
                    // colspan), only if said manager's colspan is not ending
                    // with the previous cell.
                    clone.mergeWith(manager);
                }
            }
            else if (cell.colspan > 1) {
                // If the cell has a colspan, extend it.
                clone.mergeWith(cell);
            }
        }
    }
    /**
     * Empty this table and refill it with the given number of rows and columns.
     *
     * @param rowCount
     * @param columnCount
     */
    reset(rowCount, columnCount) {
        this.empty();
        const rows = [];
        for (let rowNumber = 0; rowNumber < rowCount; rowNumber += 1) {
            rows.push(new _TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]());
        }
        for (const row of rows) {
            const cells = [];
            for (let colNumber = 0; colNumber < columnCount; colNumber += 1) {
                cells.push(new _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]());
            }
            row.append(...cells);
        }
        this.append(...rows);
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TablePickerCellDomObjectRenderer.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-table/src/TablePickerCellDomObjectRenderer.ts ***!
  \***********************************************************************/
/*! exports provided: TablePickerCellDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TablePickerCellDomObjectRenderer", function() { return TablePickerCellDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _Table__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _TablePickerNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TablePickerNode */ "./packages/plugin-table/src/TablePickerNode.ts");







class TablePickerCellDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => { var _a; return node instanceof _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"] && ((_a = node.parent) === null || _a === void 0 ? void 0 : _a.parent) instanceof _TablePickerNode__WEBPACK_IMPORTED_MODULE_6__["TablePickerNode"]; };
    }
    async render(tablePickerCell, worker) {
        const domObject = (await this.super.render(tablePickerCell, worker));
        domObject.attributes = Object.assign(Object.assign({}, domObject.attributes), {
            'data-rowCount': '' + (tablePickerCell.rowIndex + 1),
            'data-columnCount': '' + (tablePickerCell.columnIndex + 1),
        });
        const tablePlugin = this.engine.editor.plugins.get(_Table__WEBPACK_IMPORTED_MODULE_5__["Table"]);
        const minRowCount = tablePlugin.minRowCount;
        const minColumnCount = tablePlugin.minColumnCount;
        const onMouseOver = (ev) => {
            const table = ev.target.closest('table.table-picker');
            for (const cell of table.querySelectorAll('td')) {
                const rowIndex = +cell.getAttribute('data-rowCount') - 1;
                const columnIndex = +cell.getAttribute('data-columnCount') - 1;
                if (rowIndex <= tablePickerCell.rowIndex &&
                    columnIndex <= tablePickerCell.columnIndex) {
                    cell.classList.add('highlight');
                }
                else {
                    cell.classList.remove('highlight');
                }
            }
            const tablePicker = tablePickerCell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_3__["TableNode"]);
            if (tablePickerCell.rowIndex >= tablePicker.rowCount - 1 ||
                tablePicker.rowCount > minRowCount ||
                tablePickerCell.columnIndex >= tablePicker.columnCount - 1 ||
                tablePicker.columnCount > minColumnCount) {
                this.engine.editor.execCommand(() => {
                    this.engine.editor.memoryInfo.uiCommand = true;
                    const toRedraw = new Set();
                    // Add/remove rows.
                    if (tablePickerCell.rowIndex >= tablePicker.rowCount - 1) {
                        // Add.
                        const newRow = new _TableRowNode__WEBPACK_IMPORTED_MODULE_4__["TableRowNode"]();
                        toRedraw.add(newRow);
                        tablePicker.append(newRow);
                        for (let cellIndex = 0; cellIndex < tablePicker.columnCount; cellIndex++) {
                            const newCell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]();
                            newRow.append(newCell);
                            toRedraw.add(newCell);
                        }
                    }
                    else if (tablePicker.rowCount > minRowCount) {
                        // Remove.
                        const rows = tablePicker.children(child => child instanceof _TableRowNode__WEBPACK_IMPORTED_MODULE_4__["TableRowNode"] &&
                            child.rowIndex >= minRowCount &&
                            child.rowIndex > tablePickerCell.rowIndex + 1);
                        for (const row of rows) {
                            for (const rowCell of row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])) {
                                rowCell.remove();
                            }
                            row.remove();
                        }
                        if (rows.length)
                            toRedraw.add(tablePicker);
                    }
                    // Add/remove Columns.
                    if (tablePickerCell.columnIndex >= tablePicker.columnCount - 1) {
                        // Add.
                        for (const row of tablePicker.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_4__["TableRowNode"])) {
                            const newCell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]();
                            row.append(newCell);
                            toRedraw.add(newCell);
                        }
                    }
                    else if (tablePicker.columnCount > minColumnCount) {
                        // Remove.
                        const cellsToRemove = tablePicker.descendants(descendant => descendant instanceof _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"] &&
                            descendant.columnIndex >= minColumnCount &&
                            descendant.columnIndex > tablePickerCell.columnIndex + 1);
                        for (const cellToRemove of cellsToRemove) {
                            toRedraw.add(cellToRemove.parent);
                            cellToRemove.remove();
                        }
                        if (cellsToRemove.length)
                            toRedraw.add(tablePicker);
                    }
                });
            }
        };
        const onClick = async (ev) => {
            const cell = ev.target;
            await this.engine.editor.execCommand('insertTable', {
                rowCount: cell.getAttribute('data-rowCount'),
                columnCount: cell.getAttribute('data-columnCount'),
            });
        };
        domObject.attach = (el) => {
            el.addEventListener('mouseover', onMouseOver);
            el.addEventListener('click', onClick);
        };
        domObject.detach = (el) => {
            el.removeEventListener('mouseover', onMouseOver);
            el.removeEventListener('click', onClick);
        };
        return domObject;
    }
}
TablePickerCellDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TablePickerDomObjectRenderer.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-table/src/TablePickerDomObjectRenderer.ts ***!
  \*******************************************************************/
/*! exports provided: TablePickerDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TablePickerDomObjectRenderer", function() { return TablePickerDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _Table__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _TablePickerNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TablePickerNode */ "./packages/plugin-table/src/TablePickerNode.ts");





class TablePickerDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TablePickerNode__WEBPACK_IMPORTED_MODULE_4__["TablePickerNode"];
    }
    async render(tablePicker, worker) {
        const domObject = (await this.super.render(tablePicker, worker));
        const tablePlugin = this.engine.editor.plugins.get(_Table__WEBPACK_IMPORTED_MODULE_2__["Table"]);
        const layout = this.engine.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]).engines.dom;
        let attach;
        const close = async () => {
            this.engine.editor.execCommand(async () => {
                this.engine.editor.memoryInfo.uiCommand = true;
                if (attach &&
                    tablePlugin.isTablePickerOpen &&
                    layout.components.TablePicker.length) {
                    await layout.remove('TablePicker');
                }
            });
        };
        domObject.attach = () => {
            attach = true;
            tablePlugin.isTablePickerOpen = true;
            window.addEventListener('click', close, true);
        };
        domObject.detach = () => {
            attach = false;
            tablePlugin.isTablePickerOpen = false;
            window.removeEventListener('click', close, true);
        };
        return domObject;
    }
}
TablePickerDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TablePickerNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-table/src/TablePickerNode.ts ***!
  \******************************************************/
/*! exports provided: TablePickerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TablePickerNode", function() { return TablePickerNode; });
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");


class TablePickerNode extends _TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"] {
    constructor(params) {
        super(params);
        this.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]).classList.add('table-picker');
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableRowDomObjectRenderer.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-table/src/TableRowDomObjectRenderer.ts ***!
  \****************************************************************/
/*! exports provided: TableRowDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowDomObjectRenderer", function() { return TableRowDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class TableRowDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"];
    }
    /**
     * Render the TableRowNode along with its contents.
     */
    async render(row) {
        const objectRow = {
            tag: 'TR',
            children: row.children(),
        };
        return objectRow;
    }
}
TableRowDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableRowNode.ts":
/*!***************************************************!*\
  !*** ./packages/plugin-table/src/TableRowNode.ts ***!
  \***************************************************/
/*! exports provided: TableRowNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowNode", function() { return TableRowNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");


class TableRowNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super({ htmlTag: 'TR' });
        this.breakable = false;
        this.header = (params === null || params === void 0 ? void 0 : params.header) || false;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            header: this.header,
        };
        return super.clone(deepClone, Object.assign(Object.assign({}, defaults), params));
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        return super.name + (this.header ? ': header' : '');
    }
    /**
     * Return the index of this row in the table.
     */
    get rowIndex() {
        return this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_1__["TableNode"])
            .children(TableRowNode)
            .indexOf(this);
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableRowXmlDomParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-table/src/TableRowXmlDomParser.ts ***!
  \***********************************************************/
/*! exports provided: TableSectionAttributes, TableRowXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableSectionAttributes", function() { return TableSectionAttributes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowXmlDomParser", function() { return TableRowXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");





class TableSectionAttributes extends _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"] {
}
class TableRowXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
            return name === 'THEAD' || name === 'TBODY' || name === 'TR';
        };
    }
    /**
     * Parse a row node or a table section node.
     *
     * @param item
     */
    async parse(item) {
        if (this._isTableSection(item)) {
            return this.parseTableSection(item);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'TR') {
            const row = new _TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"]();
            const attributes = this.engine.parseAttributes(item);
            if (attributes.length) {
                row.modifiers.append(attributes);
            }
            const cells = await this.engine.parse(...item.childNodes);
            row.append(...cells);
            return [row];
        }
    }
    /**
     * Parse a <tbody> or a <thead> into an array of table rows with their
     * `header` property set in function of whether they are contained in a
     * <tbody> or a <thead>.
     *
     * @param tableSection
     */
    async parseTableSection(tableSection) {
        const parsedNodes = [];
        // Parse the section's children.
        for (const child of tableSection.childNodes) {
            parsedNodes.push(...(await this.engine.parse(child)));
        }
        // Parse the <tbody> or <thead>'s modifiers.
        const attributes = this.engine.parseAttributes(tableSection);
        // Apply the attributes, style and `header` property of the container to
        // each row.
        const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(tableSection);
        for (const parsedNode of parsedNodes) {
            if (parsedNode instanceof _TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"]) {
                parsedNode.header = name === 'THEAD';
                parsedNode.modifiers.replace(TableSectionAttributes, new TableSectionAttributes(attributes));
            }
        }
        return parsedNodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given item is a table section element.
     *
     * @param item
     */
    _isTableSection(item) {
        const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
        return name === 'THEAD' || name === 'TBODY';
    }
}
TableRowXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableSectionAttributesDomObjectModifierRenderer.ts":
/*!**************************************************************************************!*\
  !*** ./packages/plugin-table/src/TableSectionAttributesDomObjectModifierRenderer.ts ***!
  \**************************************************************************************/
/*! exports provided: TableSectionAttributesDomObjectModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableSectionAttributesDomObjectModifierRenderer", function() { return TableSectionAttributesDomObjectModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowXmlDomParser */ "./packages/plugin-table/src/TableRowXmlDomParser.ts");



class TableSectionAttributesDomObjectModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["TableSectionAttributes"];
    }
    /**
     * Rendering for TableSectionAttributes Modifier.
     *
     * @param format
     * @param contents
     */
    async render(format, contents) {
        return contents;
    }
}
TableSectionAttributesDomObjectModifierRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-table/src/TableXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: TableXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableXmlDomParser", function() { return TableXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");







class TableXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeName"])(item) === 'TABLE';
        };
    }
    /**
     * Parse a table node.
     *
     * @param item
     */
    async parse(item) {
        // Parse the table itself and its attributes.
        const table = new _TableNode__WEBPACK_IMPORTED_MODULE_2__["TableNode"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            table.modifiers.append(attributes);
        }
        // Parse the contents of the table.
        const children = await this.engine.parse(...item.childNodes);
        // Build the grid.
        const dimensions = this._getTableDimensions(item);
        const parsedRows = children.filter(row => row instanceof _TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"]);
        const grid = this._createTableGrid(dimensions, parsedRows);
        // Append the cells to the rows.
        const rows = new Array(dimensions[0]);
        for (let rowIndex = 0; rowIndex < grid.length; rowIndex += 1) {
            rows[rowIndex] = parsedRows[rowIndex];
            const cells = grid[rowIndex];
            let row = rows[rowIndex];
            if (!row) {
                row = new _TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"]();
            }
            row.append(...cells);
        }
        // Append the rows and other children to the table.
        let rowIndex = 0;
        for (let childIndex = 0; childIndex < children.length; childIndex += 1) {
            const child = children[childIndex];
            if (child instanceof _TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"]) {
                const row = rows[rowIndex];
                table.append(row);
                rowIndex += 1;
            }
            else {
                table.append(children[childIndex]);
            }
        }
        return [table];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a tuple with the row length and the column length of the given DOM
     * table element.
     *
     * @param domTable
     */
    _getTableDimensions(domTable) {
        const domRows = Array.from(domTable.querySelectorAll('tr'));
        const domTableRows = domRows.filter(row => row.closest('table') === domTable);
        let columnCount = 0;
        if (domTableRows.length) {
            const domCells = Array.from(domTableRows[0].querySelectorAll('td, th'));
            const domTableCells = domCells.filter(cell => cell.closest('table') === domTable);
            for (const domChild of domTableCells) {
                columnCount += parseInt(domChild.getAttribute('colSpan') || '1', 10);
            }
        }
        return [domTableRows.length, columnCount];
    }
    /**
     * Build and return the grid (2D array: rows of cells) that will be used to
     * create the table. We want all the rows to have the same number of cells,
     * and all the columns to have the same number of cells.
     *
     * @param dimensions
     * @param rows
     */
    _createTableGrid(dimensions, rows) {
        const [rowCount, columnCount] = dimensions;
        // Initialize the grid (2D array: rows of cells).
        const grid = Array.from(Array(rowCount), () => new Array(columnCount));
        // Move every parsed child row to its place in the grid, and create
        // placeholder cells where there aren't any, accounting for column spans
        // and row spans.
        for (let rowIndex = 0; rowIndex < rowCount; rowIndex += 1) {
            const row = rows[rowIndex];
            const cells = row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_4__["TableCellNode"]).slice();
            for (let domCellIndex = 0; domCellIndex < cells.length; domCellIndex += 1) {
                const cell = cells[domCellIndex];
                // If there is a cell at this grid position already, it means we
                // added it there when handling another cell, ie. it's a
                // placeholder cell, managed by a previously handled cell.
                // The current cell needs to be added at the next available slot
                // instead.
                let columnIndex = domCellIndex;
                while (grid[rowIndex][columnIndex]) {
                    columnIndex += 1;
                }
                // Check traversing colspan and rowspan to insert placeholder
                // cells where necessary. Consume these attributes as they will
                // be replaced with getters.
                const attributes = cell.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]);
                let colspan = 1;
                let rowspan = 1;
                if (attributes) {
                    colspan = parseInt(attributes.get('colspan'), 10) || 1;
                    rowspan = parseInt(attributes.get('rowspan'), 10) || 1;
                    attributes.remove('colspan');
                    attributes.remove('rowspan');
                }
                for (let i = rowIndex; i < rowIndex + rowspan; i += 1) {
                    for (let j = columnIndex; j < columnIndex + colspan; j += 1) {
                        if (i === rowIndex && j === columnIndex) {
                            // Add the current cell to the grid.
                            grid[i][j] = cell;
                        }
                        else {
                            // Add a placeholder cell to the grid.
                            const placeholderCell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_4__["TableCellNode"]();
                            placeholderCell.mergeWith(cell);
                            grid[i][j] = placeholderCell;
                        }
                    }
                }
            }
        }
        // Insert empty cells in every undefined element of the grid.
        return grid.map(row => Array.from(row, cell => cell || new _TableCellNode__WEBPACK_IMPORTED_MODULE_4__["TableCellNode"]()));
    }
}
TableXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-textarea/src/Textarea.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-textarea/src/Textarea.ts ***!
  \**************************************************/
/*! exports provided: Textarea */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Textarea", function() { return Textarea; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _TextareaXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TextareaXmlDomParser */ "./packages/plugin-textarea/src/TextareaXmlDomParser.ts");
/* harmony import */ var _TextareaDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TextareaDomObjectRenderer */ "./packages/plugin-textarea/src/TextareaDomObjectRenderer.ts");



class Textarea extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_TextareaXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["TextareaXmlDomParser"]],
            renderers: [_TextareaDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["TextareaDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-textarea/src/TextareaDomObjectRenderer.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-textarea/src/TextareaDomObjectRenderer.ts ***!
  \*******************************************************************/
/*! exports provided: TextareaDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextareaDomObjectRenderer", function() { return TextareaDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _TextareaNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TextareaNode */ "./packages/plugin-textarea/src/TextareaNode.ts");



class TextareaDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TextareaNode__WEBPACK_IMPORTED_MODULE_2__["TextareaNode"];
    }
    /**
     * Render the TextareaNode.
     */
    async render(node) {
        const text = { text: node.value };
        const textarea = {
            tag: 'TEXTAREA',
            children: [text],
        };
        return textarea;
    }
}
TextareaDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-textarea/src/TextareaNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-textarea/src/TextareaNode.ts ***!
  \******************************************************/
/*! exports provided: TextareaNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextareaNode", function() { return TextareaNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class TextareaNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super();
        this.value = '';
        this.value = (params && params.value) || '';
    }
}


/***/ }),

/***/ "./packages/plugin-textarea/src/TextareaXmlDomParser.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-textarea/src/TextareaXmlDomParser.ts ***!
  \**************************************************************/
/*! exports provided: TextareaXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextareaXmlDomParser", function() { return TextareaXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TextareaNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TextareaNode */ "./packages/plugin-textarea/src/TextareaNode.ts");



class TextareaXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => item instanceof HTMLTextAreaElement;
    }
    /**
     * Parse a list (UL, OL) and its children list elements (LI).
     *
     * @param context
     */
    async parse(item) {
        const textarea = new _TextareaNode__WEBPACK_IMPORTED_MODULE_2__["TextareaNode"]({ value: item.value });
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            textarea.modifiers.append(attributes);
        }
        return [textarea];
    }
}
TextareaXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-textcolor/src/TextColor.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-textcolor/src/TextColor.ts ***!
  \****************************************************/
/*! exports provided: TextColor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextColor", function() { return TextColor; });
/* harmony import */ var _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-color/src/Color */ "./packages/plugin-color/src/Color.ts");

class TextColor extends _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__["Color"] {
    constructor() {
        super(...arguments);
        this.styleName = 'color';
        this.configuration = Object.assign({ defaultColor: 'black' }, this.configuration);
        this.commands = {
            colorText: {
                handler: this.color,
            },
            uncolorText: {
                handler: this.uncolor,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'CTRL+G',
                    commandId: 'colorText',
                    // TODO: use dialog to get params
                    commandArgs: {
                        color: 'red',
                    },
                },
                {
                    pattern: 'CTRL+SHIFT+G',
                    commandId: 'uncolorText',
                },
            ],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-theme/src/Theme.ts":
/*!********************************************!*\
  !*** ./packages/plugin-theme/src/Theme.ts ***!
  \********************************************/
/*! exports provided: Theme */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Theme", function() { return Theme; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ThemeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ThemeXmlDomParser */ "./packages/plugin-theme/src/ThemeXmlDomParser.ts");
/* harmony import */ var _ThemeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ThemeDomObjectRenderer */ "./packages/plugin-theme/src/ThemeDomObjectRenderer.ts");
/* harmony import */ var _ThemeNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ThemeNode */ "./packages/plugin-theme/src/ThemeNode.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableGroupNode */ "./packages/plugin-layout/src/ActionableGroupNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");








class Theme extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, configuration = {}) {
        super(editor, configuration);
        this.loadables = {
            parsers: [_ThemeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ThemeXmlDomParser"]],
            renderers: [_ThemeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["ThemeDomObjectRenderer"]],
            components: [
                {
                    id: 'ThemeButton',
                    async render() {
                        const group = new _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_5__["ActionableGroupNode"]({ name: 'themes' });
                        const zone = new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__["ZoneNode"]({ managedZones: ['themeButtons'] });
                        group.append(zone);
                        return [group];
                    },
                },
            ],
            componentZones: [['ThemeButton', ['actionables']]],
        };
        this.commands = {
            changeTheme: {
                handler: this.changeTheme,
            },
        };
        this.themes = {
            default: {
                id: 'default',
                async render() {
                    return [new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_7__["VElement"]({ htmlTag: 'T-PLACEHOLDER' })];
                },
                label: 'Theme: Default',
            },
        };
        if (this.configuration.components) {
            for (const theme of this.configuration.components) {
                this.addTheme(theme);
            }
        }
    }
    addTheme(theme) {
        this.themes[theme.id] = theme;
        this.loadables.components.push(this._createThemeButton(theme.id));
        this.loadables.componentZones.push(['Theme' + theme.id + 'Button', ['themeButtons']]);
    }
    /**
     * Create a theme button ComponentDefinition.
     *
     * @param name
     */
    _createThemeButton(name) {
        const theme = this.themes[name];
        return {
            id: 'Theme' + name + 'Button',
            async render() {
                const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_6__["ActionableNode"]({
                    name: 'theme-' + name,
                    label: theme.label || 'Theme: ' + name,
                    commandId: 'changeTheme',
                    commandArgs: { theme: name },
                    selected: (editor) => {
                        const ancestor = editor.selection.anchor.ancestor(_ThemeNode__WEBPACK_IMPORTED_MODULE_3__["ThemeNode"]);
                        return (ancestor === null || ancestor === void 0 ? void 0 : ancestor.themeName) === name;
                    },
                    enabled: (editor) => {
                        return !!editor.selection.anchor.ancestor(_ThemeNode__WEBPACK_IMPORTED_MODULE_3__["ThemeNode"]);
                    },
                });
                return [button];
            },
        };
    }
    /**
     * Change the current theme and template.
     *
     * @param params
     */
    async changeTheme(params) {
        const ancestor = this.editor.selection.anchor.ancestor(_ThemeNode__WEBPACK_IMPORTED_MODULE_3__["ThemeNode"]);
        if (ancestor) {
            ancestor.themeName = params.theme;
        }
    }
}
Theme.dependencies = [];


/***/ }),

/***/ "./packages/plugin-theme/src/ThemeDomObjectRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-theme/src/ThemeDomObjectRenderer.ts ***!
  \*************************************************************/
/*! exports provided: ThemeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeDomObjectRenderer", function() { return ThemeDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _ThemeNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ThemeNode */ "./packages/plugin-theme/src/ThemeNode.ts");
/* harmony import */ var _Theme__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Theme */ "./packages/plugin-theme/src/Theme.ts");




class ThemeDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ThemeNode__WEBPACK_IMPORTED_MODULE_2__["ThemeNode"];
    }
    async render(themeNode) {
        const themePlugin = this.engine.editor.plugins.get(_Theme__WEBPACK_IMPORTED_MODULE_3__["Theme"]);
        const component = themePlugin.themes[themeNode.themeName];
        const nodes = await component.render(this.engine.editor);
        const cache = await this.engine.render(nodes);
        const domObjects = nodes.map(node => cache.renderings.get(node));
        for (const domObject of domObjects) {
            await this._resolvePlaceholder(themeNode, domObject, cache.worker);
        }
        return { children: domObjects };
    }
    async _resolvePlaceholder(theme, domObject, worker) {
        await this.engine.resolveChildren(domObject, worker);
        let placeholderFound = false;
        const domObjects = [domObject];
        for (const domObject of domObjects) {
            if ('tag' in domObject && domObject.tag === 'T-PLACEHOLDER') {
                if (!placeholderFound) {
                    delete domObject.tag;
                    domObject.children = theme.children();
                    placeholderFound = true;
                }
            }
            else if ('dom' in domObject) {
                if (!placeholderFound) {
                    for (const domNode of domObject.dom) {
                        const placeholder = domNode instanceof Element && domNode.querySelector('T-PLACEHOLDER');
                        if (placeholder) {
                            for (const child of theme.children()) {
                                placeholder.parentNode.insertBefore(this.engine.renderPlaceholder(child), placeholder);
                            }
                            placeholder.parentNode.removeChild(placeholder);
                            placeholderFound = true;
                        }
                    }
                }
            }
            else if ('children' in domObject) {
                // Recursively apply on children in one stack.
                domObjects.push(...domObject.children);
            }
        }
    }
}
ThemeDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-theme/src/ThemeNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-theme/src/ThemeNode.ts ***!
  \************************************************/
/*! exports provided: ThemeNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeNode", function() { return ThemeNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class ThemeNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super();
        this.editable = false;
        this.breakable = false;
        this.themeName = (params === null || params === void 0 ? void 0 : params.theme) || 'default';
    }
}


/***/ }),

/***/ "./packages/plugin-theme/src/ThemeXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-theme/src/ThemeXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: ThemeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeXmlDomParser", function() { return ThemeXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _ThemeNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ThemeNode */ "./packages/plugin-theme/src/ThemeNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ThemeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-THEME';
        };
    }
    /**
     * Parse a shadow node and extract styling.
     *
     * @param item
     */
    async parse(item) {
        const theme = new _ThemeNode__WEBPACK_IMPORTED_MODULE_2__["ThemeNode"]({ theme: item.getAttribute('name') });
        const attributes = this.engine.parseAttributes(item);
        attributes.remove('name');
        if (attributes.length) {
            theme.modifiers.append(attributes);
        }
        const nodes = await this.engine.parse(...item.childNodes);
        theme.append(...nodes);
        return [theme];
    }
}
ThemeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-toolbar/src/Toolbar.ts":
/*!************************************************!*\
  !*** ./packages/plugin-toolbar/src/Toolbar.ts ***!
  \************************************************/
/*! exports provided: Toolbar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Toolbar", function() { return Toolbar; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ToolbarXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ToolbarXmlDomParser */ "./packages/plugin-toolbar/src/ToolbarXmlDomParser.ts");
/* harmony import */ var _ToolbarDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ToolbarDomObjectRenderer */ "./packages/plugin-toolbar/src/ToolbarDomObjectRenderer.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _ToolbarNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ToolbarNode */ "./packages/plugin-toolbar/src/ToolbarNode.ts");
/* harmony import */ var _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableGroupNode */ "./packages/plugin-layout/src/ActionableGroupNode.ts");
/* harmony import */ var _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-layout/src/LabelNode */ "./packages/plugin-layout/src/LabelNode.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");











class Toolbar extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ToolbarXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ToolbarZoneXmlDomParser"]],
            renderers: [_ToolbarDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["ToolbarZoneDomObjectRenderer"]],
            components: [
                {
                    id: 'toolbar',
                    render: async () => {
                        var _a;
                        const toolbar = new _ToolbarNode__WEBPACK_IMPORTED_MODULE_5__["ToolbarNode"]();
                        this.addToolbarItems(toolbar, ((_a = this.configuration) === null || _a === void 0 ? void 0 : _a.layout) || []);
                        return [toolbar];
                    },
                },
            ],
            componentZones: [['toolbar', ['tools']]],
        };
        this.configuration = Object.assign({ layout: [] }, this.configuration);
    }
    addToolbarItems(node, items) {
        const domEngine = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        for (const item of items) {
            if (typeof item === 'string') {
                if (item === '|') {
                    node.append(new _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_7__["SeparatorNode"]());
                }
                else if (domEngine.hasConfiguredComponents(item)) {
                    node.append(new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_8__["ZoneNode"]({ managedZones: [item] }));
                }
                else {
                    node.append(new _plugin_layout_src_LabelNode__WEBPACK_IMPORTED_MODULE_9__["LabelNode"]({ label: item }));
                }
            }
            else if (item instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_10__["AbstractNode"]) {
                node.append(node);
            }
            else {
                const group = new _plugin_layout_src_ActionableGroupNode__WEBPACK_IMPORTED_MODULE_6__["ActionableGroupNode"]();
                this.addToolbarItems(group, item);
                node.append(group);
            }
        }
    }
}
Toolbar.dependencies = [_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_3__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-toolbar/src/ToolbarDomObjectRenderer.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-toolbar/src/ToolbarDomObjectRenderer.ts ***!
  \*****************************************************************/
/*! exports provided: ToolbarZoneDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolbarZoneDomObjectRenderer", function() { return ToolbarZoneDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _ToolbarNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ToolbarNode */ "./packages/plugin-toolbar/src/ToolbarNode.ts");



class ToolbarZoneDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_1__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ToolbarNode__WEBPACK_IMPORTED_MODULE_2__["ToolbarNode"];
    }
    async render(toolbar) {
        const objectToolbar = {
            tag: 'JW-TOOLBAR',
            children: toolbar.children(),
        };
        return objectToolbar;
    }
}
ToolbarZoneDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-toolbar/src/ToolbarNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-toolbar/src/ToolbarNode.ts ***!
  \****************************************************/
/*! exports provided: ToolbarNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolbarNode", function() { return ToolbarNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class ToolbarNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
}


/***/ }),

/***/ "./packages/plugin-toolbar/src/ToolbarXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-toolbar/src/ToolbarXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: ToolbarZoneXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolbarZoneXmlDomParser", function() { return ToolbarZoneXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _ToolbarNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ToolbarNode */ "./packages/plugin-toolbar/src/ToolbarNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _Toolbar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Toolbar */ "./packages/plugin-toolbar/src/Toolbar.ts");





class ToolbarZoneXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-TOOLBAR';
        };
    }
    async parse(item) {
        var _a;
        const toolbar = new _ToolbarNode__WEBPACK_IMPORTED_MODULE_2__["ToolbarNode"]();
        const nodes = await this.engine.parse(...item.childNodes);
        toolbar.append(...nodes);
        const toolbarPlugin = this.engine.editor.plugins.get(_Toolbar__WEBPACK_IMPORTED_MODULE_4__["Toolbar"]);
        toolbarPlugin.addToolbarItems(toolbar, (_a = toolbarPlugin.configuration) === null || _a === void 0 ? void 0 : _a.layout);
        return [toolbar];
    }
}
ToolbarZoneXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-underline/src/Underline.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-underline/src/Underline.ts ***!
  \****************************************************/
/*! exports provided: Underline */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Underline", function() { return Underline; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UnderlineFormat */ "./packages/plugin-underline/src/UnderlineFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _UnderlineXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./UnderlineXmlDomParser */ "./packages/plugin-underline/src/UnderlineXmlDomParser.ts");
/* harmony import */ var _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/ActionableNode */ "./packages/plugin-layout/src/ActionableNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");







class Underline extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_UnderlineXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["UnderlineXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+U',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"] },
                },
            ],
            components: [
                {
                    id: 'UnderlineButton',
                    async render() {
                        const button = new _plugin_layout_src_ActionableNode__WEBPACK_IMPORTED_MODULE_4__["ActionableNode"]({
                            name: 'underline',
                            label: 'Toggle underline',
                            commandId: 'toggleFormat',
                            commandArgs: { FormatClass: _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"] },
                            selected: (editor) => {
                                var _a, _b, _c;
                                const range = editor.selection.range;
                                if (range.isCollapsed()) {
                                    const pluginInline = editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]);
                                    return !!((_a = pluginInline
                                        .getCurrentModifiers(range)) === null || _a === void 0 ? void 0 : _a.find(_UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"]));
                                }
                                else {
                                    const startIsFormated = !!((_b = range.start
                                        .nextSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _b === void 0 ? void 0 : _b.modifiers.find(_UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"]));
                                    if (!startIsFormated || range.isCollapsed()) {
                                        return startIsFormated;
                                    }
                                    else {
                                        return !!((_c = range.end
                                            .previousSibling(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_6__["InlineNode"])) === null || _c === void 0 ? void 0 : _c.modifiers.find(_UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"]));
                                    }
                                }
                            },
                            modifiers: [new _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]({ class: 'fa fa-underline fa-fw' })],
                        });
                        return [button];
                    },
                },
            ],
            componentZones: [['UnderlineButton', ['actionables']]],
        };
    }
}
Underline.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-underline/src/UnderlineFormat.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-underline/src/UnderlineFormat.ts ***!
  \**********************************************************/
/*! exports provided: UnderlineFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnderlineFormat", function() { return UnderlineFormat; });
/* harmony import */ var _core_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Format */ "./packages/core/src/Format.ts");

class UnderlineFormat extends _core_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super(...arguments);
        this.htmlTag = 'U';
    }
}


/***/ }),

/***/ "./packages/plugin-underline/src/UnderlineXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-underline/src/UnderlineXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: UnderlineXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnderlineXmlDomParser", function() { return UnderlineXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatXmlDomParser */ "./packages/plugin-inline/src/FormatXmlDomParser.ts");
/* harmony import */ var _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UnderlineFormat */ "./packages/plugin-underline/src/UnderlineFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class UnderlineXmlDomParser extends _plugin_inline_src_FormatXmlDomParser__WEBPACK_IMPORTED_MODULE_0__["FormatXmlDomParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) === 'U';
        };
    }
    /**
     * Parse an underline node.
     *
     * @param item
     */
    async parse(item) {
        const underline = new _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"]();
        const attributes = this.engine.parseAttributes(item);
        if (attributes.length) {
            underline.modifiers.append(attributes);
        }
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(underline, children);
        return children;
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/Attributes.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-xml/src/Attributes.ts ***!
  \***********************************************/
/*! exports provided: Attributes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Attributes", function() { return Attributes; });
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _CssStyle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CssStyle */ "./packages/plugin-xml/src/CssStyle.ts");
/* harmony import */ var _ClassList__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ClassList */ "./packages/plugin-xml/src/ClassList.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");





class Attributes extends _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] {
    constructor(attributes) {
        super();
        this.style = new _CssStyle__WEBPACK_IMPORTED_MODULE_1__["CssStyle"]();
        // Avoid copiying FontAwesome classes on paragraph break.
        // TODO : need to be improved to better take care of color classes, etc.
        this.preserve = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_4__["VersionableObject"]({
            after: true,
            paragraphBreak: false,
            lineBreak: true,
        });
        this.classList = new _ClassList__WEBPACK_IMPORTED_MODULE_2__["ClassList"]();
        if (attributes instanceof Attributes) {
            for (const key of attributes.keys()) {
                this.set(key, attributes.get(key));
            }
        }
        else if (attributes instanceof NamedNodeMap) {
            for (const attribute of Array.from(attributes)) {
                this.set(attribute.name, attribute.value);
            }
        }
        else if (attributes) {
            for (const key of Object.keys(attributes)) {
                this.set(key, attributes[key]);
            }
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    get length() {
        return this.keys().length;
    }
    get name() {
        const name = [];
        for (const attributeName of this.keys()) {
            name.push(`${attributeName}: "${this.get(attributeName)}"`);
        }
        return `{${name.join(', ')}}`;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a clone of this record.
     */
    clone() {
        const clone = new this.constructor();
        if (this._record) {
            clone._record = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_3__["makeVersionable"])(Object.assign({}, this._record));
        }
        if (this.style.length) {
            clone.style = this.style.clone();
        }
        if (this.classList.length) {
            clone.classList = this.classList.clone();
        }
        return clone;
    }
    /**
     * Return a string representing the attributes.
     */
    toString() {
        if (!this.length)
            return `${this.constructor.name}: {}`;
        const valueRepr = [];
        for (const key of this.keys()) {
            valueRepr.push(`${key}: "${this.get(key)}"`);
        }
        return `${this.constructor.name}: { ${valueRepr.join(', ')} }`;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the record has the given key, false otherwise.
     *
     * @param key
     */
    has(key) {
        return this.keys().includes(key.toLowerCase());
    }
    /**
     * Return an array containing all the keys in the record.
     */
    keys() {
        const keys = this._record
            ? Object.keys(this._record).filter(key => {
                return ((key !== 'style' || !!this.style.length) &&
                    (key !== 'class' || !!this.classList.length));
            })
            : [];
        if (this.classList.length && !keys.includes('class')) {
            // The node was not parsed with a class attribute, add it in place.
            // Use `get` for its value but record its position in the record.
            keys.push('class');
        }
        if (this.style.length && !keys.includes('style')) {
            // The node was not parsed with a style attribute, keep it always at
            // the end of the attributes list.
            keys.push('style');
        }
        return keys;
    }
    /**
     * Return an array containing all the values in the record.
     */
    values() {
        return this.keys().map(key => this.get(key));
    }
    /**
     * Return the record matching the given name.
     *
     * @param name
     */
    get(name) {
        var _a, _b, _c;
        name = name.toLowerCase();
        if (name === 'style') {
            return (_a = this.style) === null || _a === void 0 ? void 0 : _a.cssText;
        }
        else if (name === 'class') {
            return (_b = this.classList) === null || _b === void 0 ? void 0 : _b.className;
        }
        else {
            return (_c = this._record) === null || _c === void 0 ? void 0 : _c[name];
        }
    }
    /**
     * Set the record with the given name to the given value.
     *
     * @param name
     * @param value
     */
    set(name, value) {
        name = name.toLowerCase();
        if (!this._record) {
            this._record = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_3__["makeVersionable"])({});
        }
        if (name === 'style') {
            if (this.style) {
                this.style.reset(value);
            }
            else {
                this.style = new _CssStyle__WEBPACK_IMPORTED_MODULE_1__["CssStyle"]();
            }
            // Use `get` for its value but record its position in the record.
            this._record.style = null;
        }
        else if (name === 'class') {
            this.classList.reset(value);
            // Use `get` for its value but record its position in the record.
            this._record.class = null;
        }
        else {
            this._record[name] = value;
        }
    }
    /**
     * Remove the records with the given names.
     *
     * @param names
     */
    remove(...names) {
        for (let name of names) {
            name = name.toLowerCase();
            if (name === 'style') {
                this.style.clear();
            }
            else if (name === 'class') {
                this.classList.clear();
            }
            else if (this._record) {
                delete this._record[name];
            }
        }
    }
    clear() {
        delete this._record;
        this.style.clear();
        this.classList.clear();
    }
    /**
     * Return true if the given attributes are the same as the ones in this
     * record.
     *
     * @param otherAttributes
     */
    isSameAs(otherAttributes) {
        if (otherAttributes) {
            return (this.length === otherAttributes.length &&
                this.keys().every(key => {
                    return this.get(key) === otherAttributes.get(key);
                }));
        }
        else {
            return !this.length;
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/AttributesDomObjectModifierRenderer.ts":
/*!************************************************************************!*\
  !*** ./packages/plugin-xml/src/AttributesDomObjectModifierRenderer.ts ***!
  \************************************************************************/
/*! exports provided: AttributesDomObjectModifierRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AttributesDomObjectModifierRenderer", function() { return AttributesDomObjectModifierRenderer; });
/* harmony import */ var _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/ModifierRenderer */ "./packages/plugin-renderer/src/ModifierRenderer.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");
/* harmony import */ var _Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class AttributesDomObjectModifierRenderer extends _plugin_renderer_src_ModifierRenderer__WEBPACK_IMPORTED_MODULE_0__["ModifierRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"];
    }
    /**
     * Rendering for Format Modifier.
     *
     * @param format
     * @param contents
     */
    async render(modifier, contents) {
        const keys = modifier.keys();
        const classHistory = modifier.classList.history();
        if (keys.length || Object.keys(classHistory).length) {
            const attributes = {};
            for (const name of keys) {
                if (name === 'class') {
                    // This is going to use the class history feature anyway.
                    // TODO: This entire file should probably be reorganized to
                    // avoid using a `DomObjectAttributes` object in between.
                    attributes.class = new Set();
                }
                else if (name === 'style') {
                    attributes.style = modifier.style.toJSON();
                }
                else {
                    attributes[name] = modifier.get(name);
                }
            }
            const newContents = [];
            for (let index = 0; index < contents.length; index++) {
                let content = contents[index];
                if ('tag' in content) {
                    this._applyAttributes(content, attributes, classHistory);
                }
                else if ('children' in content &&
                    !content.children.find(domObject => !('tag' in domObject) &&
                        !('text' in domObject && domObject.text === '\u200b'))) {
                    for (const child of content.children) {
                        if ('tag' in child) {
                            this._applyAttributes(child, attributes, classHistory);
                        }
                    }
                }
                else {
                    const children = [];
                    let newIndex = index;
                    while (newIndex <= contents.length &&
                        ('text' in content ||
                            'dom' in content ||
                            ('children' in content && content.children.length))) {
                        if (!children.includes(content)) {
                            children.push(content);
                        }
                        newIndex++;
                    }
                    if (children.length) {
                        content = {
                            tag: 'SPAN',
                            attributes: Object.assign({}, attributes),
                            children: children,
                        };
                    }
                }
                newContents.push(content);
            }
            contents = newContents;
        }
        return contents;
    }
    _applyAttributes(content, attributes, classHistory) {
        if (!content.attributes)
            content.attributes = {};
        const attr = content.attributes;
        for (const name in attributes) {
            if (name === 'class') {
                this._applyClassHistory(content, classHistory);
            }
            else if (name === 'style') {
                attr.style = Object.assign({}, attributes.style, attr.style);
            }
            else {
                attr[name] = attributes[name];
            }
        }
    }
    /**
     * Apply the history of the class attributes stored in the given Record to
     * the given DomObject. Basically, if the DomObject is restoring a class
     * that used to be present in the class history, it will be reordered to
     * match its original position.
     *
     * @param content
     * @param classHistory
     */
    _applyClassHistory(content, classHistory) {
        var _a;
        // Reorganize `class` set to restore order thanks to ClassList history.
        const classNames = new Set();
        if (content.attributes.class) {
            for (const className of content.attributes.class) {
                if (classHistory[className] !== false) {
                    classNames.add(className);
                }
            }
        }
        for (const className in classHistory) {
            if (classHistory[className] || ((_a = content.attributes.class) === null || _a === void 0 ? void 0 : _a.has(className))) {
                classNames.add(className);
            }
        }
        content.attributes.class = classNames;
    }
}
AttributesDomObjectModifierRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-xml/src/ClassList.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-xml/src/ClassList.ts ***!
  \**********************************************/
/*! exports provided: ClassList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClassList", function() { return ClassList; });
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");

class ClassList extends _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"] {
    constructor(...classList) {
        super();
        for (const className of classList) {
            this.add(className);
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the number of classes in the set.
     */
    get length() {
        return this._classList ? this.items().length : 0;
    }
    /**
     * Return a textual representation of the set.
     */
    get className() {
        if (!this.length)
            return;
        return this.items().join(' ');
    }
    /**
     * Reinitialize the set with a new set of classes, from a string to parse.
     */
    set className(className) {
        this.reset(className);
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new set of classes, parsed from a className string.
     *
     * @param className
     */
    parseClassName(className) {
        return new Set(className
            .trim()
            .split(/\s+/)
            .filter(c => c.length));
    }
    /**
     * Return a clone of this list.
     */
    clone() {
        const clone = new ClassList();
        // TODO: Maybe this should copy the entire history rather than only the
        // currently active classes ?
        clone.add(...this.items());
        return clone;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the set has the given class, false otherwise.
     *
     * @param name
     */
    has(name) {
        var _a;
        return ((_a = this._classList) === null || _a === void 0 ? void 0 : _a[name]) || false;
    }
    /**
     * Return an array containing all the items in the list.
     */
    items() {
        return this._classList
            ? Object.keys(this._classList).filter(key => this._classList[key])
            : [];
    }
    /**
     * Return a record containing all the past and current classes. Classes that
     * are not active anymore have their value set to `false`.
     *
     */
    history() {
        return Object.assign(Object.assign({}, this._classList) || {});
    }
    /**
     * Add the given class(es) to the set.
     *
     * @param classNames
     */
    add(...classNames) {
        if (!this._classList) {
            this._classList = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"]();
        }
        for (const className of classNames) {
            if (className) {
                const classes = this.parseClassName(className);
                for (const name of classes) {
                    this._classList[name] = true;
                }
            }
        }
    }
    /**
     * Remove the given class(es) from the set.
     *
     * @param classNames
     */
    remove(...classNames) {
        if (!this._classList)
            return;
        for (const className of classNames) {
            if (className) {
                const classes = this.parseClassName(className);
                for (const name of classes) {
                    this._classList[name] = false;
                }
            }
        }
    }
    /**
     * Clear the set of all its classes.
     */
    clear() {
        delete this._classList;
    }
    /**
     * Reinitialize the set with a new set of classes (empty if no argument is
     * passed). The argument can be a set of classes or a string to parse.
     *
     * @param classList
     */
    reset(...classList) {
        delete this._classList;
        for (const className of classList) {
            this.add(className);
        }
    }
    /**
     * For each given class, add it to the set if it doesn't have it yet,
     * otherwise remove it.
     *
     * @param classes
     */
    toggle(...classes) {
        if (!this._classList) {
            this._classList = new _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"]();
        }
        for (const className of classes) {
            if (className) {
                const parsed = this.parseClassName(className);
                for (const name of parsed) {
                    if (this._classList[name]) {
                        this._classList[name] = false;
                    }
                    else {
                        this._classList[name] = true;
                    }
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/CssStyle.ts":
/*!*********************************************!*\
  !*** ./packages/plugin-xml/src/CssStyle.ts ***!
  \*********************************************/
/*! exports provided: CssStyle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CssStyle", function() { return CssStyle; });
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");


class CssStyle extends _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"] {
    constructor(style) {
        super();
        if (style) {
            this.reset(style);
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the number of styles in the set.
     */
    get length() {
        return this._style ? Object.keys(this._style).length : 0;
    }
    /**
     * Return a textual representation of the CSS declaration block.
     */
    get cssText() {
        if (!this._style) {
            return;
        }
        const keys = Object.keys(this._style);
        if (!Object.keys(this._style).length)
            return;
        const valueRepr = [];
        for (const key of keys) {
            valueRepr.push(`${key}: ${this._style[key]}`);
        }
        let result = valueRepr.join('; ');
        if (valueRepr.length) {
            result += ';';
        }
        return result;
    }
    /**
     * Reinitialize the record with a new record of styles, from a string to
     * parse.
     */
    set cssText(cssText) {
        this.reset(cssText);
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new record of styles, parsed from a cssText string.
     *
     * @param className
     */
    parseCssText(cssText) {
        const style = {};
        return cssText
            .split(';')
            .map(style => style.trim())
            .filter(style => style.length)
            .reduce((accumulator, value) => {
            const [key, v] = value.split(':');
            style[key.trim()] = v.trim();
            return accumulator;
        }, style);
    }
    /**
     * Return a clone of this record.
     */
    clone() {
        const clone = new CssStyle();
        if (this._style) {
            clone._style = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(Object.assign({}, this._style));
        }
        return clone;
    }
    /**
     * Return the style value as record.
     */
    toJSON() {
        return Object.assign({}, this._style);
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the record has the given style, false otherwise.
     *
     * @param key
     */
    has(key) {
        var _a;
        return !!((_a = this._style) === null || _a === void 0 ? void 0 : _a[key]);
    }
    /**
     * Return an array containing all the keys in the record.
     */
    keys() {
        return this._style ? Object.keys(this._style) : [];
    }
    /**
     * Return an array containing all the values in the record.
     */
    values() {
        return this._style ? Object.values(this._style) : [];
    }
    /**
     * Return the record matching the given name.
     *
     * @param name
     */
    get(name) {
        var _a;
        return (_a = this._style) === null || _a === void 0 ? void 0 : _a[name];
    }
    set(pairsOrName, value) {
        if (!this._style) {
            this._style = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])({});
        }
        if (typeof pairsOrName === 'string') {
            this._style[pairsOrName] = value;
        }
        else {
            for (const name of Object.keys(pairsOrName)) {
                this._style[name] = pairsOrName[name];
            }
        }
    }
    /**
     * Remove the record(s) with the given name(s).
     *
     * @param name
     */
    remove(...names) {
        if (this._style) {
            for (const name of names) {
                delete this._style[name];
            }
        }
    }
    /**
     * Clear the record of all its styles.
     */
    clear() {
        delete this._style;
    }
    /**
     * Reinitialize the record with a new record of styles (empty if no argument
     * is passed). The argument can be a record of styles or a string to parse.
     *
     * @param style
     */
    reset(style = '') {
        if (typeof style === 'object') {
            if (Object.keys(style).length) {
                this._style = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(style);
            }
            else {
                delete this._style;
            }
        }
        else if (style.length) {
            this._style = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_1__["makeVersionable"])(this.parseCssText(style));
        }
        else {
            delete this._style;
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/DefaultXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-xml/src/DefaultXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: DefaultXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultXmlDomParser", function() { return DefaultXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class DefaultXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    async parse(item) {
        // If the node could not be parsed, create a generic element node with
        // the HTML tag of the DOM Node. This way we may not support the node
        // but we don't break it either.
        const element = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_1__["VElement"]({ htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) });
        if (item instanceof Element) {
            const attributes = this.engine.parseAttributes(item);
            if (attributes.length) {
                element.modifiers.append(attributes);
            }
        }
        const nodes = await this.engine.parse(...item.childNodes);
        element.append(...nodes);
        return [element];
    }
}
DefaultXmlDomParser.id = 'dom/xml';


/***/ }),

/***/ "./packages/plugin-xml/src/Xml.ts":
/*!****************************************!*\
  !*** ./packages/plugin-xml/src/Xml.ts ***!
  \****************************************/
/*! exports provided: Xml */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Xml", function() { return Xml; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _AttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AttributesDomObjectModifierRenderer */ "./packages/plugin-xml/src/AttributesDomObjectModifierRenderer.ts");





class Xml extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsingEngines: [_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"]],
            renderers: [_AttributesDomObjectModifierRenderer__WEBPACK_IMPORTED_MODULE_4__["AttributesDomObjectModifierRenderer"]],
        };
    }
}
Xml.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"]];


/***/ }),

/***/ "./packages/plugin-xml/src/XmlDomParsingEngine.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-xml/src/XmlDomParsingEngine.ts ***!
  \********************************************************/
/*! exports provided: XmlDomParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XmlDomParsingEngine", function() { return XmlDomParsingEngine; });
/* harmony import */ var _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/ParsingEngine */ "./packages/plugin-parser/src/ParsingEngine.ts");
/* harmony import */ var _DefaultXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultXmlDomParser */ "./packages/plugin-xml/src/DefaultXmlDomParser.ts");
/* harmony import */ var _Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class XmlDomParsingEngine extends _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__["ParsingEngine"] {
    /**
     * Parse a node's attributes and return them.
     *
     * @param node
     */
    parseAttributes(node) {
        return new _Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"](node.attributes);
    }
}
XmlDomParsingEngine.id = 'dom/xml';
XmlDomParsingEngine.defaultParser = _DefaultXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["DefaultXmlDomParser"];


/***/ }),

/***/ "./packages/plugin-youtube/src/Youtube.ts":
/*!************************************************!*\
  !*** ./packages/plugin-youtube/src/Youtube.ts ***!
  \************************************************/
/*! exports provided: Youtube */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Youtube", function() { return Youtube; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _YoutubeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./YoutubeXmlDomParser */ "./packages/plugin-youtube/src/YoutubeXmlDomParser.ts");
/* harmony import */ var _YoutubeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./YoutubeDomObjectRenderer */ "./packages/plugin-youtube/src/YoutubeDomObjectRenderer.ts");



class Youtube extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_YoutubeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["YoutubeXmlDomParser"]],
            renderers: [_YoutubeDomObjectRenderer__WEBPACK_IMPORTED_MODULE_2__["YoutubeDomObjectRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeDomObjectRenderer.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeDomObjectRenderer.ts ***!
  \*****************************************************************/
/*! exports provided: YoutubeDomObjectRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeDomObjectRenderer", function() { return YoutubeDomObjectRenderer; });
/* harmony import */ var _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/NodeRenderer */ "./packages/plugin-renderer/src/NodeRenderer.ts");
/* harmony import */ var _YoutubeNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./YoutubeNode */ "./packages/plugin-youtube/src/YoutubeNode.ts");
/* harmony import */ var _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer-dom-object/src/DomObjectRenderingEngine */ "./packages/plugin-renderer-dom-object/src/DomObjectRenderingEngine.ts");



class YoutubeDomObjectRenderer extends _plugin_renderer_src_NodeRenderer__WEBPACK_IMPORTED_MODULE_0__["NodeRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _YoutubeNode__WEBPACK_IMPORTED_MODULE_1__["YoutubeNode"];
    }
    async render() {
        const youtube = {
            tag: 'IFRAME',
        };
        return youtube;
    }
}
YoutubeDomObjectRenderer.id = _plugin_renderer_dom_object_src_DomObjectRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["DomObjectRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeNode.ts ***!
  \****************************************************/
/*! exports provided: YoutubeNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeNode", function() { return YoutubeNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class YoutubeNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
}
YoutubeNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: YoutubeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeXmlDomParser", function() { return YoutubeXmlDomParser; });
/* harmony import */ var _YoutubeNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./YoutubeNode */ "./packages/plugin-youtube/src/YoutubeNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class YoutubeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const isYoutubeVideo = item instanceof Element &&
                Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'IFRAME' &&
                item.getAttribute('src').includes('youtu');
            return isYoutubeVideo;
        };
    }
    async parse(item) {
        const youtube = new _YoutubeNode__WEBPACK_IMPORTED_MODULE_0__["YoutubeNode"]();
        youtube.modifiers.append(this.engine.parseAttributes(item));
        return [youtube];
    }
}
YoutubeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/utils/src/Dom.ts":
/*!***********************************!*\
  !*** ./packages/utils/src/Dom.ts ***!
  \***********************************/
/*! exports provided: targetDeepest, nodeLength, isTextNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "targetDeepest", function() { return targetDeepest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeLength", function() { return nodeLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTextNode", function() { return isTextNode; });
/**
 * Return the deepest child of a given container at a given offset, and its
 * adapted offset.
 *
 * @param container
 * @param offset
 */
function targetDeepest(container, offset) {
    while (container.hasChildNodes()) {
        let childNodes;
        if (container instanceof Element && container.shadowRoot) {
            childNodes = container.shadowRoot.childNodes;
        }
        else {
            childNodes = container.childNodes;
        }
        if (offset >= childNodes.length) {
            container = container.lastChild;
            // The new container might be a text node, so considering only
            // the `childNodes` property would be wrong.
            offset = nodeLength(container);
        }
        else {
            container = childNodes[offset];
            offset = 0;
        }
    }
    return [container, offset];
}
/**
 * Return the length of a DOM Node.
 *
 * @param node
 */
function nodeLength(node) {
    if (node.nodeType === Node.TEXT_NODE) {
        return node.nodeValue.length;
    }
    else if (node instanceof Element && node.shadowRoot) {
        return node.shadowRoot.childNodes.length;
    }
    else {
        return node.childNodes.length;
    }
}
/**
 * Return if the node is a text node. Don't use instance of to allow iframe
 * uses.
 *
 * @param node
 */
function isTextNode(node) {
    return node.nodeName === '#text';
}


/***/ }),

/***/ "./packages/utils/src/DomMap.ts":
/*!**************************************!*\
  !*** ./packages/utils/src/DomMap.ts ***!
  \**************************************/
/*! exports provided: DomMap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomMap", function() { return DomMap; });
/* harmony import */ var _plugin_dom_layout_src_LayoutContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-dom-layout/src/LayoutContainerNode */ "./packages/plugin-dom-layout/src/LayoutContainerNode.ts");

class DomMap {
    constructor() {
        this._fromDom = new Map();
        this._toDom = new Map();
    }
    /**
     * Map the given VNode to its corresponding DOM Node and its offset in it.
     *
     * @param node
     * @param domNode
     * @param offset
     * @param method
     */
    set(node, domNode, offset = 0, method = 'push') {
        if (node instanceof _plugin_dom_layout_src_LayoutContainerNode__WEBPACK_IMPORTED_MODULE_0__["LayoutContainer"]) {
            return;
        }
        if (this._fromDom.has(domNode)) {
            const matches = this._fromDom.get(domNode);
            if (!matches.some((match) => match.id === node.id)) {
                matches[method](node);
            }
        }
        else {
            this._fromDom.set(domNode, [node]);
        }
        const locations = this._toDom.get(node) || [];
        locations.push([domNode, offset]);
        this._toDom.set(node, locations);
        // Set children.
        for (const renderedChild of domNode.childNodes) {
            const mapping = this.toDomPoint(node);
            if (!mapping) {
                this.set(node, renderedChild, -1, 'unshift');
            }
        }
    }
    /**
     * Return the VNode(s) corresponding to the given DOM Node.
     *
     * @param domNode
     */
    fromDom(domNode) {
        return this._fromDom.get(domNode);
    }
    /**
     * Return the array of tuple (node, number) corresponding to the given VNode.
     *
     * @param node
     */
    toDomPoint(node) {
        return this._toDom.get(node) || [];
    }
    /**
     * Return the DOM Node corresponding to the given VNode.
     *
     * @param node
     */
    toDom(node) {
        const domNodes = [];
        for (const point of this._toDom.get(node) || []) {
            domNodes.push(point[0]);
        }
        return domNodes;
    }
    /**
     * Clear the map of all correspondances.
     *
     * @param [node]
     */
    clear(node) {
        if (node) {
            for (const point of this._toDom.get(node) || []) {
                const nodes = this._fromDom.get(point[0]);
                const index = nodes.indexOf(node);
                if (index !== -1) {
                    nodes.splice(index, 0);
                }
                if (nodes.length === 0) {
                    this._fromDom.delete(point[0]);
                }
            }
            this._toDom.delete(node);
        }
        else {
            this._fromDom.clear();
            this._toDom.clear();
        }
    }
}


/***/ }),

/***/ "./packages/utils/src/EventMixin.ts":
/*!******************************************!*\
  !*** ./packages/utils/src/EventMixin.ts ***!
  \******************************************/
/*! exports provided: EventMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventMixin", function() { return EventMixin; });
/* harmony import */ var _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Memory/VersionableObject */ "./packages/core/src/Memory/VersionableObject.ts");
/* harmony import */ var _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Memory/VersionableArray */ "./packages/core/src/Memory/VersionableArray.ts");
/* harmony import */ var _core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/Memory/Versionable */ "./packages/core/src/Memory/Versionable.ts");
/* harmony import */ var _core_src_Memory_VersionableSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/Memory/VersionableSet */ "./packages/core/src/Memory/VersionableSet.ts");




/**
 * Abstract class to add event mechanism.
 */
class EventMixin extends _core_src_Memory_VersionableObject__WEBPACK_IMPORTED_MODULE_0__["VersionableObject"] {
    /**
     * Subscribe to an event with a callback.
     *
     * @param eventName
     * @param callback
     */
    on(eventName, callback) {
        if (!this._eventCallbacks) {
            this._eventCallbacks = Object(_core_src_Memory_Versionable__WEBPACK_IMPORTED_MODULE_2__["makeVersionable"])({});
        }
        if (!this._eventCallbacks[eventName]) {
            this._eventCallbacks[eventName] = new _core_src_Memory_VersionableArray__WEBPACK_IMPORTED_MODULE_1__["VersionableArray"]();
        }
        this._eventCallbacks[eventName].push(callback);
    }
    /**
     * Fire an event for of this object and all ancestors.
     *
     * @param eventName
     * @param args
     */
    trigger(eventName, args) {
        var _a;
        if ((_a = this._eventCallbacks) === null || _a === void 0 ? void 0 : _a[eventName]) {
            if (!this._callbackWorking) {
                this._callbackWorking = new _core_src_Memory_VersionableSet__WEBPACK_IMPORTED_MODULE_3__["VersionableSet"]();
            }
            for (const callback of this._eventCallbacks[eventName]) {
                if (!this._callbackWorking.has(callback)) {
                    this._callbackWorking.add(callback);
                    callback(args);
                    this._callbackWorking.delete(callback);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/utils/src/ReactiveValue.ts":
/*!*********************************************!*\
  !*** ./packages/utils/src/ReactiveValue.ts ***!
  \*********************************************/
/*! exports provided: ReactiveValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReactiveValue", function() { return ReactiveValue; });
/* harmony import */ var _EventMixin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EventMixin */ "./packages/utils/src/EventMixin.ts");

class ReactiveValue extends _EventMixin__WEBPACK_IMPORTED_MODULE_0__["EventMixin"] {
    constructor(_value) {
        super();
        this._value = _value;
    }
    /**
     * Set the value of this reactiveValue.
     *
     * @param {T} value The value to set.
     * @param {boolean} [fire=true] Fire an event if true.
     * @returns {Promise<void>}
     * @memberof ReactiveValue
     */
    set(value, fire = true) {
        if (value !== this._value) {
            this._value = value;
            if (fire) {
                this.trigger('set', value);
            }
        }
    }
    /**
     * Get the value of this reactiveValue.
     *
     * @returns {T}
     * @memberof ReactiveValue
     */
    get() {
        return this._value;
    }
}


/***/ }),

/***/ "./packages/utils/src/configuration.ts":
/*!*********************************************!*\
  !*** ./packages/utils/src/configuration.ts ***!
  \*********************************************/
/*! exports provided: parseElement, parseEditable, createEditable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseElement", function() { return parseElement; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseEditable", function() { return parseEditable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createEditable", function() { return createEditable; });
/* harmony import */ var _DomMap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DomMap */ "./packages/utils/src/DomMap.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");








async function parseElement(editor, element) {
    const parser = editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__["Parser"]);
    const domParserEngine = parser.engines['dom/html'];
    if (!domParserEngine) {
        throw new Error('To use this parsing utils you must add the Html plugin.');
    }
    const parsedVNodes = await domParserEngine.parse(element);
    const domSelection = element.ownerDocument.getSelection();
    const anchorNode = domSelection.anchorNode;
    if (element === anchorNode || element.contains(anchorNode)) {
        const domMap = new _DomMap__WEBPACK_IMPORTED_MODULE_0__["DomMap"]();
        // Construct DOM map from the parsing in order to parse the selection.
        for (const node of parsedVNodes) {
            domMap.set(node, element);
        }
        for (const [domNode, nodes] of domParserEngine.parsingMap) {
            for (const node of nodes) {
                domMap.set(node, domNode);
            }
        }
        const _locate = (domNode, domOffset) => {
            /**
             * Return a position in the VNodes as a tuple containing a reference
             * node and a relative position with respect to this node ('BEFORE' or
             * 'AFTER'). The position is always given on the leaf.
             *
             * @param container
             * @param offset
             */
            let forceAfter = false;
            let forcePrepend = false;
            let container = domNode.childNodes[domOffset] || domNode;
            let offset = container === domNode ? domOffset : 0;
            if (container === domNode && container.childNodes.length) {
                container = container.childNodes[container.childNodes.length - 1];
                offset = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container);
                forceAfter = true;
            }
            while (!domMap.fromDom(container)) {
                forceAfter = false;
                forcePrepend = false;
                if (container.previousSibling) {
                    forceAfter = true;
                    container = container.previousSibling;
                    offset = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container);
                }
                else {
                    forcePrepend = true;
                    offset = [].indexOf.call(container.parentNode.childNodes, container);
                    container = container.parentNode;
                }
            }
            // When targetting the end of a node, the DOM gives an offset that is
            // equal to the length of the container. In order to retrieve the last
            // descendent, we need to make sure we target an existing node, ie. an
            // existing index.
            const isAfterEnd = offset >= Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container);
            let index = isAfterEnd ? Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container) - 1 : offset;
            // Move to deepest child of container.
            while (container.hasChildNodes()) {
                const child = container.childNodes[index];
                if (!domMap.fromDom(child)) {
                    break;
                }
                container = child;
                index = isAfterEnd ? Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container) - 1 : 0;
                // Adapt the offset to be its equivalent within the new container.
                offset = isAfterEnd ? Object(_utils__WEBPACK_IMPORTED_MODULE_3__["nodeLength"])(container) : index;
            }
            const nodes = domMap.fromDom(container);
            // Get the VNodes matching the container.
            let reference;
            if (container.nodeType === Node.TEXT_NODE) {
                // The reference is the index-th match (eg.: text split into chars).
                reference = forceAfter ? nodes[nodes.length - 1] : nodes[index];
            }
            else {
                reference = nodes[0];
            }
            if (forceAfter) {
                return [reference, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER];
            }
            if (forcePrepend && reference instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__["ContainerNode"]) {
                return [reference, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE];
            }
            return reference.locate(container, offset);
        };
        // Parse the dom selection into the description of a VSelection.
        const start = _locate(domSelection.anchorNode, domSelection.anchorOffset);
        const end = _locate(domSelection.focusNode, domSelection.focusOffset);
        const [startVNode, startPosition] = start;
        const [endVNode, endPosition] = end;
        let direction;
        if (domSelection instanceof Selection) {
            const domRange = domSelection.rangeCount && domSelection.getRangeAt(0);
            if (domRange.startContainer === domSelection.anchorNode &&
                domRange.startOffset === domSelection.anchorOffset) {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_5__["Direction"].FORWARD;
            }
            else {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_5__["Direction"].BACKWARD;
            }
        }
        const selection = {
            anchorNode: startVNode,
            anchorPosition: startPosition,
            focusNode: endVNode,
            focusPosition: endPosition,
            direction: direction,
        };
        editor.selection.set(selection);
        domMap.clear();
    }
    return parsedVNodes;
}
async function parseEditable(editor, element, autofocus = false) {
    const nodes = await parseElement(editor, element);
    nodes[0].editable = false;
    nodes[0].breakable = false;
    nodes[0].modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]).set('contentEditable', 'true');
    if (autofocus && !editor.selection.anchor.parent) {
        if (nodes[0].hasChildren()) {
            editor.selection.setAt(nodes[0].firstChild(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE);
        }
        else {
            editor.selection.setAt(nodes[0], _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE);
        }
    }
    return nodes;
}
async function createEditable(editor, autofocus = false) {
    const root = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_7__["VElement"]({ htmlTag: 'jw-editable' });
    // Semantic elements are inline by default.
    // We need to guarantee it's a block so it can contain
    // other blocks.
    root.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]).set('style', 'display: block;');
    root.editable = false;
    root.breakable = false;
    root.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]).set('contentEditable', 'true');
    if (autofocus && !editor.selection.anchor.parent) {
        editor.selection.setAt(root, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE);
    }
    return [root];
}


/***/ }),

/***/ "./packages/utils/src/errors.ts":
/*!**************************************!*\
  !*** ./packages/utils/src/errors.ts ***!
  \**************************************/
/*! exports provided: CustomError, StageError, ChildError, AtomicityError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomError", function() { return CustomError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StageError", function() { return StageError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChildError", function() { return ChildError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AtomicityError", function() { return AtomicityError; });
/**
 * Creates an instance representing a custom error adapting to the constructor
 * name of the custom error and taking advantage of `captureStackTrace` of V8.
 *
 * Source:
 * http://developer.mozilla.org/docs/JavaScript/Reference/Global_Objects/Error
 */
class CustomError extends Error {
    constructor(...params) {
        super(...params);
        this.name = this.constructor.name;
        // Maintains proper stack trace for where our error was thrown.
        if (Error.captureStackTrace) {
            // This is only available on V8.
            Error.captureStackTrace(this, this.constructor);
        }
    }
}
/**
 * Creates an instance representing an error that occurs when a function only
 * allowed to be called in a specific mode is called in a different mode.
 */
class StageError extends CustomError {
    constructor(stage, ...params) {
        super(...params);
        this.message = `This operation is only allowed in ${stage} stage.`;
    }
}
/**
 * Creates an instance representing an error that occurs when a VNode given as
 * child function parameter is actually not a child of the current VNode.
 */
class ChildError extends CustomError {
    constructor(thisNode, node, ...params) {
        super(...params);
        this.message = `${node.name} is not a child of ${thisNode.name}`;
    }
}
/**
 * Creates an instance representing an error that occurs when an action would
 * violate the atomicity of a VNode.
 */
class AtomicityError extends CustomError {
    constructor(node, ...params) {
        super(...params);
        this.message = `${node.name} is atomic.`;
    }
}


/***/ }),

/***/ "./packages/utils/src/formattingSpace.ts":
/*!***********************************************!*\
  !*** ./packages/utils/src/formattingSpace.ts ***!
  \***********************************************/
/*! exports provided: removeFormattingSpace */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeFormattingSpace", function() { return removeFormattingSpace; });
/* harmony import */ var _isBlock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");


const spaceBeforeNewline = /([ \t])*(\n)/g;
const spaceAfterNewline = /(\n)([ \t])*/g;
const tabs = /\t/g;
const newlines = /\n/g;
const onlyTabsSpacesAndNewLines = /^[\t \n]*$/g;
const consecutiveSpace = /  */g;
const endWithSpace = /[ \t\n]$/g;
const startSpace = /^ */g;
const endSpace = /[ \u3000]*$/g;
/**
 * Return a string with the value of a text node stripped of its formatting
 * space, applying the w3 rules for white space processing
 * TODO: decide what exactly to do with formatting spaces:
 * remove, keep, recompute?
 *
 * @see https://www.w3.org/TR/css-text-3/#white-space-processing
 * @returns {string}
 */
function removeFormattingSpace(node) {
    var _a;
    // TODO: check the value of the `white-space` property
    const text = node.textContent;
    if ((_a = node.parentElement) === null || _a === void 0 ? void 0 : _a.closest('PRE, TEXTAREA')) {
        return text;
    }
    // (Comments refer to the w3 link provided above.)
    // Phase I: Collapsing and Transformation
    let newText = text
        // 1. All spaces and tabs immediately preceding or following a
        //    segment break are removed.
        .replace(spaceBeforeNewline, '$2')
        .replace(spaceAfterNewline, '$1')
        // 2. Segment breaks are transformed for rendering according to the
        //    segment break transformation rules.
        .replace(newlines, ' ')
        // 3. Every tab is converted to a space (U+0020).
        .replace(tabs, ' ')
        // 4. Any space immediately following another collapsible space 
        //    even one outside the boundary of the inline containing that
        //    space, provided both spaces are within the same inline
        //    formatting contextis collapsed to have zero advance width.
        //    (It is invisible, but retains its soft wrap opportunity, if
        //    any.)
        .replace(consecutiveSpace, ' ');
    // Phase II: Trimming and Positioning
    // 1. A sequence of collapsible spaces at the beginning of a line
    //    (ignoring any intervening inline box boundaries) is removed.
    // 1.2. The space at the beginning of the line is collapsed if
    //    a space is present in the previous inline siblings node
    //    see : https://www.w3.org/TR/css-text-3/#collapse
    if (_isAtSegmentBreak(node, 'start') || _followsInlineSpace(node)) {
        newText = newText.replace(startSpace, '');
    }
    // 2. If the tab size is zero, tabs are not rendered. Otherwise, each
    //    tab is rendered as a horizontal shift that lines up the start edge
    //    of the next glyph with the next tab stop. If this distance is less
    //    than 0.5ch, then the subsequent tab stop is used instead. Tab
    //    stops occur at points that are multiples of the tab size from the
    //    blocks starting content edge. The tab size is given by the
    //    tab-size property.
    // TODO
    // 3. A sequence at the end of a line (ignoring any intervening inline
    //    box boundaries) of collapsible spaces (U+0020) and/or ideographic
    //    spaces (U+3000) whose white-space value collapses spaces is
    //    removed.
    if (_isAtSegmentBreak(node, 'end')) {
        newText = newText.replace(endSpace, '');
    }
    return newText;
}
/**
 * Return true if the given node is immediately folowing a space inside the same inline context,
 * to see if its frontal space must be removed.
 *
 * @param {Element} node
 * @returns {boolean}
 */
function _followsInlineSpace(node) {
    let sibling = node && node.previousSibling;
    if (_isTextNode(node) && !sibling) {
        sibling = node.parentElement.previousSibling;
    }
    if (!sibling || Object(_isBlock__WEBPACK_IMPORTED_MODULE_0__["isBlock"])(sibling))
        return false;
    return !!sibling.textContent.match(endWithSpace);
}
/**
 * Return true if the given node is immediately preceding (`side` === 'end')
 * or following (`side` === 'start') a segment break, to see if its edge
 * space must be removed.
 * A segment break is a sort of line break, not considering automatic breaks
 * that are function of the screen size. In this context, a segment is what
 * you see when you triple click in text in the browser.
 * Eg: `<div><p>one</p>two<br>three</div>` where  = segment breaks.
 *
 * @param {Element} node
 * @param {'start'|'end'} side
 * @returns {boolean}
 */
function _isAtSegmentBreak(node, side) {
    const siblingSide = side === 'start' ? 'previousSibling' : 'nextSibling';
    const sibling = node && node[siblingSide];
    const isAgainstAnotherSegment = sibling && _isSegment(sibling);
    const isAtEdgeOfOwnSegment = _isBlockEdge(node, side);
    // In the DOM, a space before a BR is rendered but a space after a BR isn't.
    const isBeforeBR = side === 'end' && sibling && Object(_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(sibling) === 'BR';
    return (isAgainstAnotherSegment && !isBeforeBR) || isAtEdgeOfOwnSegment;
}
/**
 * Return true if the node is a segment according to W3 formatting model.
 *
 * @param node to check
 */
function _isSegment(node) {
    if (node.nodeType !== Node.ELEMENT_NODE) {
        // Only proper elements can be a segment.
        return false;
    }
    else if (Object(_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(node) === 'BR') {
        // Break (BR) tags end a segment.
        return true;
    }
    else {
        // The W3 specification has many specific cases that defines what is
        // or is not a segment. For the moment, we only handle display: block.
        return Object(_isBlock__WEBPACK_IMPORTED_MODULE_0__["isBlock"])(node);
    }
}
/**
 * Return true if the node is at the given edge of a block.
 *
 * @param node to check
 * @param side of the block to check ('start' or 'end')
 */
function _isBlockEdge(node, side) {
    const ancestorsUpToBlock = [];
    // Move up to the first block ancestor
    let ancestor = node;
    while (ancestor && (_isTextNode(ancestor) || !_isSegment(ancestor))) {
        ancestorsUpToBlock.push(ancestor);
        ancestor = ancestor.parentElement;
    }
    // Return true if no ancestor up to the first block ancestor has a
    // sibling on the specified side
    const siblingSide = side === 'start' ? 'previousSibling' : 'nextSibling';
    return ancestorsUpToBlock.every(ancestor => {
        let sibling = ancestor[siblingSide];
        while (sibling &&
            _isTextNode(sibling) &&
            sibling.textContent.match(onlyTabsSpacesAndNewLines)) {
            sibling = sibling[siblingSide];
        }
        return !sibling;
    });
}
/**
 * Return true if the given node is a text node, false otherwise.
 *
 * @param node to check
 */
function _isTextNode(node) {
    return node.nodeType === Node.TEXT_NODE;
}


/***/ }),

/***/ "./packages/utils/src/isBlock.ts":
/*!***************************************!*\
  !*** ./packages/utils/src/isBlock.ts ***!
  \***************************************/
/*! exports provided: isBlock */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isBlock", function() { return isBlock; });
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");

/**
 * The following is a complete list of all HTML "block-level" elements.
 *
 * Source:
 * https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements
 *
 * */
const blockTagNames = [
    'ADDRESS',
    'ARTICLE',
    'ASIDE',
    'BLOCKQUOTE',
    'DETAILS',
    'DIALOG',
    'DD',
    'DIV',
    'DL',
    'DT',
    'FIELDSET',
    'FIGCAPTION',
    'FIGURE',
    'FOOTER',
    'FORM',
    'H1',
    'H2',
    'H3',
    'H4',
    'H5',
    'H6',
    'HEADER',
    'HGROUP',
    'HR',
    'LI',
    'MAIN',
    'NAV',
    'OL',
    'P',
    'PRE',
    'SECTION',
    'TABLE',
    'UL',
    // The following elements are not in the W3C list, for some reason.
    'TR',
    'TD',
    'TBODY',
    'THEAD',
    'TH',
];
const computedStyles = new WeakMap();
/**
 * Return true if the given node is a block-level element, false otherwise.
 *
 * @param node
 */
function isBlock(node) {
    let result;
    if (node instanceof Element) {
        const tagName = Object(_utils__WEBPACK_IMPORTED_MODULE_0__["nodeName"])(node);
        // every custom jw-* node will be considered as blocks
        if (tagName.startsWith('JW-') || tagName === 'T') {
            return true;
        }
        // We won't call `getComputedStyle` more than once per node.
        let style = computedStyles.get(node);
        if (!style) {
            style = window.getComputedStyle(node);
        }
        // The node might not be in the DOM, in which case it has no CSS values.
        if (style.display) {
            result = !style.display.includes('inline') && style.display !== 'contents';
        }
        else {
            result = blockTagNames.includes(tagName);
        }
    }
    else {
        result = false;
    }
    return result;
}


/***/ }),

/***/ "./packages/utils/src/polyfill.ts":
/*!****************************************!*\
  !*** ./packages/utils/src/polyfill.ts ***!
  \****************************************/
/*! exports provided: elementFromPoint, caretPositionFromPoint */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "elementFromPoint", function() { return elementFromPoint; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "caretPositionFromPoint", function() { return caretPositionFromPoint; });
/* harmony import */ var _Dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dom */ "./packages/utils/src/Dom.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");


function elementFromPoint(x, y, root = document) {
    let element = root.elementFromPoint(x, y);
    if (element) {
        root = element.ownerDocument;
        while (element.shadowRoot) {
            root = element.shadowRoot;
            element = root.elementFromPoint(x, y);
            if (element.shadowRoot === root) {
                if (root.firstElementChild) {
                    element = root.lastElementChild;
                    if (element.getBoundingClientRect().x > x) {
                        element = root.firstElementChild;
                    }
                }
                else {
                    break;
                }
            }
        }
        return element;
    }
}
function caretPositionFromPoint(x, y, root = document) {
    if ((!x && x !== 0) || (!y && y !== 0))
        return;
    // There is no cross-browser function for this, but the three functions below
    // cover all modern browsers as well as the shadow DOM.
    let caretPosition;
    const element = elementFromPoint(x, y, root);
    if (!element) {
        return;
    }
    root = Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getDocument"])(element);
    if (root.caretPositionFromPoint) {
        caretPosition = root.caretPositionFromPoint(x, y);
    }
    else if (root instanceof ShadowRoot) {
        // Find the nearest node leaf or char in leaf.
        const position = caretPositionFromPointInShadowDom(x, y, element);
        if (position) {
            caretPosition = {
                offsetNode: position.node,
                offset: position.offset,
            };
        }
    }
    else {
        const caretRange = root.caretRangeFromPoint(x, y);
        caretPosition = caretRange && {
            offsetNode: caretRange.startContainer,
            offset: caretRange.startOffset,
        };
    }
    if (caretPosition) {
        const [offsetNode, offset] = Object(_Dom__WEBPACK_IMPORTED_MODULE_0__["targetDeepest"])(caretPosition.offsetNode, caretPosition.offset);
        return { offsetNode, offset };
    }
}
function caretPositionFromPointInShadowDom(x, y, element) {
    const range = document.createRange();
    let distX = Infinity;
    let distY = Infinity;
    let node;
    let offset;
    const leafs = [];
    const elements = [element];
    while (elements.length) {
        const element = elements.shift();
        if (element.childNodes.length) {
            elements.push(...element.childNodes);
        }
        else {
            leafs.push(element);
        }
    }
    // Find the nearest node leaf.
    for (const leaf of leafs) {
        let box;
        if (leaf instanceof Element) {
            box = leaf.getBoundingClientRect();
        }
        else {
            range.setStart(leaf, 0);
            range.setEnd(leaf, leaf.textContent.length);
            box = range.getBoundingClientRect();
        }
        if (box.y + box.height < y) {
            continue;
        }
        let currentOffset = 0;
        let newDistY;
        if (box.y <= y && box.y + box.height >= y) {
            newDistY = 0;
            if (leaf.nodeType === Node.TEXT_NODE) {
                currentOffset = getNearestCharOffset(x, y, leaf);
                range.setStart(leaf, currentOffset);
                range.setEnd(leaf, currentOffset);
                box = range.getBoundingClientRect();
            }
        }
        else {
            newDistY = Math.abs(box.y + box.height / 2 - y);
        }
        let newDistX;
        if (box.x <= x && box.x + box.width >= x) {
            newDistX = 0;
        }
        else {
            newDistX = Math.abs(box.x + box.width / 2 - x);
        }
        if (newDistY < distY) {
            distY = newDistY;
            distX = newDistX;
            node = leaf;
            offset = currentOffset;
        }
        else if (newDistY === distY &&
            ((newDistY === 0 && newDistX <= distX) || (newDistY !== 0 && newDistX > distX))) {
            distY = newDistY;
            distX = newDistX;
            node = leaf;
            offset = currentOffset;
        }
        if (distX === 0 && distY === 0) {
            break;
        }
    }
    return node && { node, offset };
}
function getNearestCharOffset(x, y, text) {
    // Search with a pseudo dichotomic for performance.
    const range = document.createRange();
    const posToTest = [[0, text.textContent.length]];
    const verticalMatches = [];
    while (posToTest.length) {
        const pos = posToTest.pop();
        range.setStart(text, pos[0]);
        range.setEnd(text, pos[1]);
        const box = range.getBoundingClientRect();
        if (box.y <= y && box.y + box.height >= y) {
            if (box.x <= x && box.x + box.width >= x) {
                if (pos[1] - pos[0] <= 1) {
                    return box.x + box.width / 2 <= x ? pos[1] : pos[0];
                }
                const alf = Math.floor((pos[0] + pos[1]) / 2);
                posToTest.push([pos[0], alf], [alf, pos[1]]);
            }
            else {
                verticalMatches.push(pos);
            }
        }
    }
    // Did not found the char, eg: user click on left above the container like
    // the browser we get the nearest char at the same cursor of the pointer.
    let dist = Infinity;
    let offset = 0;
    for (const pos of verticalMatches.reverse()) {
        for (let i = pos[0]; i < pos[1]; i++) {
            range.setStart(text, i);
            range.setEnd(text, i + 1);
            const box = range.getBoundingClientRect();
            const dx = box.x + box.width / 2;
            const dy = box.y + box.height / 2;
            const delta = Math.pow(dx - x, 2) + Math.pow(dy - y, 4);
            if (delta <= dist) {
                dist = delta;
                offset = i + (dx < x ? 1 : 0);
            }
        }
    }
    return offset;
}


/***/ }),

/***/ "./packages/utils/src/utils.ts":
/*!*************************************!*\
  !*** ./packages/utils/src/utils.ts ***!
  \*************************************/
/*! exports provided: isConstructor, hasContentEditable, isContentEditable, deepEqualObjects, flat, toUnicode, nodeLength, distinct, nodeName, getDocument */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isConstructor", function() { return isConstructor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasContentEditable", function() { return hasContentEditable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isContentEditable", function() { return isContentEditable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deepEqualObjects", function() { return deepEqualObjects; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flat", function() { return flat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toUnicode", function() { return toUnicode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeLength", function() { return nodeLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeName", function() { return nodeName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDocument", function() { return getDocument; });
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");

/**
 * Return whether the given constructor is a constructor of given superClass.
 *
 * @param constructor
 * @param superClass
 */
function isConstructor(constructor, superClass) {
    return constructor.prototype instanceof superClass || constructor === superClass;
}
/**
 * Return true if the node has the `contentEditable` attribute.
 *
 * @param node
 */
function hasContentEditable(node) {
    var _a;
    return ((_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"])) === null || _a === void 0 ? void 0 : _a.has('contentEditable')) || false;
}
/**
 * Return true if the node has the `contentEditable` attribute set to true. This
 * implies that its children are editable but it is not necessarily itself
 * editable.
 *
 * TODO: unbind from `Attributes`.
 */
function isContentEditable(node) {
    var _a;
    const editable = (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('contentEditable');
    return editable === '' || (editable === null || editable === void 0 ? void 0 : editable.toLowerCase()) === 'true' || false;
}
/**
 * Return true if object a is deep equal to object b, false otherwise.
 *
 * @param a
 * @param b
 */
function deepEqualObjects(a, b) {
    const aKeys = Object.keys(a);
    if (aKeys.length !== Object.keys(b).length)
        return false;
    for (const key of aKeys) {
        const aValue = a[key];
        const bValue = b[key];
        if (typeof aValue === 'object') {
            if (!deepEqualObjects(aValue, bValue)) {
                return false;
            }
        }
        else {
            if (aValue !== bValue) {
                return false;
            }
        }
    }
    return true;
}
/**
 * Creates a new array with all sub-array elements concatenated into it.
 */
function flat(arr) {
    return [].concat(...arr);
}
/**
 * Convert certain special characters to unicode.
 */
function toUnicode(string) {
    if (string === ' ') {
        return '\u00A0';
    }
    if (string === '\n') {
        return '\u000d';
    }
    if (string === '\t') {
        return '\u0009';
    }
    return string;
}
/**
 * Return the length of a DOM Node.
 *
 * @param node
 */
function nodeLength(node) {
    const isTextNode = node.nodeType === Node.TEXT_NODE;
    const content = isTextNode ? node.nodeValue : node.childNodes;
    return content.length;
}
/**
 * Return a duplicate-free version of an array.
 *
 * @param array
 */
function distinct(array) {
    return Array.from(new Set(array));
}
/**
 * Return the uppercase name of the given DOM node.
 *
 * @param node
 */
function nodeName(node) {
    return node.nodeName.toUpperCase();
}
function getDocument(node) {
    let root;
    while (node && !root) {
        if (node instanceof Document || node instanceof ShadowRoot) {
            root = node;
        }
        else {
            node = node.parentNode;
        }
    }
    return root || document;
}


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KV0VkaXRvci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL25vZGVfbW9kdWxlcy9Ab2Rvby9vd2wvZGlzdC9vd2wuanMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9idW5kbGUtYmFzaWMtZWRpdG9yL2Jhc2ljTGF5b3V0LmNzcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2J1bmRsZS1vZG9vLXdlYnNpdGUtZWRpdG9yL29kb29MYXlvdXQuY3NzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldmljZS1wcmV2aWV3L2Fzc2V0cy9EZXZpY2VQcmV2aWV3LmNzcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9hc3NldHMvRGV2VG9vbHMuY3NzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRpYWxvZy9hc3NldHMvRGlhbG9nLmNzcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tZm9sbG93LXJhbmdlL2Fzc2V0cy9Gb2xsb3dSYW5nZS5jc3MiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZnVsbHNjcmVlbi9hc3NldHMvRnVsbHNjcmVlbi5jc3MiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGlzdC9hc3NldHMvY2hlY2tsaXN0LmNzcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9hc3NldHMvdGFibGVVSS5jc3MiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzIiwid2VicGFjazovL0pXRWRpdG9yLy4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvYnVuZGxlLWJhc2ljLWVkaXRvci9CYXNpY0VkaXRvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2J1bmRsZS1iYXNpYy1lZGl0b3IvYmFzaWNMYXlvdXQuY3NzPzViOGEiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9idW5kbGUtYmFzaWMtZWRpdG9yL2Jhc2ljTGF5b3V0LnhtbCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2J1bmRsZS1vZG9vLXdlYnNpdGUtZWRpdG9yL09kb29XZWJzaXRlRWRpdG9yLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvYnVuZGxlLW9kb28td2Vic2l0ZS1lZGl0b3Ivb2Rvby1pbnRlZ3JhdGlvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2J1bmRsZS1vZG9vLXdlYnNpdGUtZWRpdG9yL29kb29MYXlvdXQuY3NzPzAwZGIiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9Db250ZXh0TWFuYWdlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL0NvcmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9EaXNwYXRjaGVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvRm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvSldFZGl0b3IudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9KV1BsdWdpbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01lbW9yeS9NZW1vcnkudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGVBcnJheS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZU9iamVjdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZVNldC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01lbW9yeS9jb25zdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9Nb2RpZmllci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL01vZGlmaWVycy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL0ZyYWdtZW50Tm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9NYXJrZXJOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL1NlcGFyYXRvck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvVk5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WUmFuZ2UudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WU2VsZWN0aW9uLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWFsaWduL3NyYy9BbGlnbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1iYWNrZ3JvdW5kY29sb3Ivc3JjL0JhY2tncm91bmRDb2xvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1ibG9ja3F1b3RlL3NyYy9CbG9ja3F1b3RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJsb2NrcXVvdGUvc3JjL0Jsb2NrcXVvdGVOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJsb2NrcXVvdGUvc3JjL0Jsb2NrcXVvdGVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYm9sZC9zcmMvQm9sZC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1ib2xkL3NyYy9Cb2xkRm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJvbGQvc3JjL0JvbGRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYnV0dG9uL3NyYy9CdXR0b24udHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYnV0dG9uL3NyYy9CdXR0b25Gb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYnV0dG9uL3NyYy9CdXR0b25YbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1jaGFyL3NyYy9DaGFyRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhclhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1jb2RlL3NyYy9Db2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWNvZGUvc3JjL0NvZGVWaWV3RG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY29kZS9zcmMvQ29kZVZpZXdOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWNvbG9yL3NyYy9Db2xvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZpY2UtcHJldmlldy9hc3NldHMvRGV2aWNlUHJldmlldy5jc3M/ZmQyZCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZpY2UtcHJldmlldy9zcmMvRGV2aWNlUHJldmlldy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9hc3NldHMvRGV2VG9vbHMuY3NzP2QyYTMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvYXNzZXRzL0RldlRvb2xzLnhtbCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9zcmMvRGV2VG9vbHMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvQ29tbWFuZHNDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvRGV2VG9vbHNDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvSW5mb0NvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9zcmMvY29tcG9uZW50cy9JbnNwZWN0b3JDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvTW9kZXNDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvUGF0aENvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9zcmMvY29tcG9uZW50cy9QbHVnaW5zQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL1Nob3J0Y3V0c0NvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kZXZ0b29scy9zcmMvY29tcG9uZW50cy9UcmVlQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy91dGlscy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaWFsb2cvYXNzZXRzL0RpYWxvZy5jc3M/ZGVkZiIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaWFsb2cvYXNzZXRzL0RpYWxvZy54bWwiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy9EaWFsb2cudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy9EaWFsb2dab25lRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy9EaWFsb2dab25lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaWFsb2cvc3JjL0RpYWxvZ1pvbmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGl2aWRlci9zcmMvRGl2aWRlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1lZGl0YWJsZS9zcmMvRG9tRWRpdGFibGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9FdmVudE5vcm1hbGl6ZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9NdXRhdGlvbk5vcm1hbGl6ZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9hc3NldHMvRm9sbG93UmFuZ2UuY3NzPzZiMTQiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9zcmMvRm9sbG93UmFuZ2UudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9zcmMvRm9sbG93UmFuZ2Vab25lRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9zcmMvRm9sbG93UmFuZ2Vab25lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tZm9sbG93LXJhbmdlL3NyYy9Gb2xsb3dSYW5nZVpvbmVOb2RlWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1oZWxwZXJzL3NyYy9Eb21IZWxwZXJzLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0FjdGlvbmFibGVEb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9BY3Rpb25hYmxlR3JvdXBEb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9BY3Rpb25hYmxlR3JvdXBTZWxlY3RJdGVtRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dEVuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21SZWNvbmNpbGlhdGlvbkVuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9MYWJlbERvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0xheW91dENvbnRhaW5lckRvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0xheW91dENvbnRhaW5lck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvU2VwYXJhdG9yRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvWm9uZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL1pvbmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZm9udC1zaXplL3NyYy9Gb250U2l6ZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1mb250LXNpemUvc3JjL0ZvbnRTaXplRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZm9udGF3ZXNvbWUvc3JjL0ZvbnRBd2Vzb21lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWZvbnRhd2Vzb21lL3NyYy9Gb250QXdlc29tZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWZvbnRhd2Vzb21lL3NyYy9Gb250QXdlc29tZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZm9udGF3ZXNvbWUvc3JjL0ZvbnRBd2Vzb21lWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWZ1bGxzY3JlZW4vYXNzZXRzL0Z1bGxzY3JlZW4uY3NzPzk4NTEiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZnVsbHNjcmVlbi9zcmMvRnVsbHNjcmVlbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1mdWxsc2NyZWVuL3NyYy9GdWxsc2NyZWVuQnV0dG9uRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taGVhZGluZy9zcmMvSGVhZGluZy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1oZWFkaW5nL3NyYy9IZWFkaW5nTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1oZWFkaW5nL3NyYy9IZWFkaW5nWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWhpc3Rvcnkvc3JjL0hpc3RvcnkudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvRGVmYXVsdEh0bWxEb21Nb2RpZmllclJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0RlZmF1bHRIdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvRGVmYXVsdEh0bWxUZXh0UGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0h0bWwudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVBhcnNpbmdFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sTm9kZURvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0h0bWxUZXh0UGFyc2luZ0VuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pZnJhbWUvc3JjL0lmcmFtZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pZnJhbWUvc3JjL0lmcmFtZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlmcmFtZS9zcmMvSWZyYW1lSHRtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pZnJhbWUvc3JjL0lmcmFtZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taWZyYW1lL3NyYy9JZnJhbWVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWltYWdlL3NyYy9JbWFnZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWltYWdlL3NyYy9JbWFnZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWluZGVudC9zcmMvSW5kZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0WG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlubGluZS9zcmMvSW5saW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW5wdXQvc3JjL0lucHV0RG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW5wdXQvc3JjL0lucHV0Tm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWNGb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWNYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlR3JvdXBOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYWJlbE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9ab25lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVhay50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha0RvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha1htbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5rL2Fzc2V0cy9MaW5rRm9ybS54bWwiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGluay9zcmMvTGluay50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5rL3NyYy9MaW5rRm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpbmsvc3JjL0xpbmtYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGluay9zcmMvY29tcG9uZW50cy9MaW5rQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3QvYXNzZXRzL2NoZWNrbGlzdC5jc3M/OThjMiIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3REb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0SXRlbUF0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3RJdGVtWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3ROb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3RYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFEYXRhRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW1ldGFkYXRhL3NyYy9NZXRhZGF0YU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tZmllbGQvc3JjL09kb29GaWVsZC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLWZpZWxkL3NyYy9PZG9vRmllbGREb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLWZpZWxkL3NyYy9PZG9vRmllbGRNYXAudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1maWVsZC9zcmMvT2Rvb0ZpZWxkTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLWZpZWxkL3NyYy9PZG9vRmllbGRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1maWVsZC9zcmMvT2Rvb01vbmV0YXJ5RmllbGREb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLWZpZWxkL3NyYy9PZG9vTW9uZXRhcnlGaWVsZE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1maWVsZC9zcmMvT2Rvb01vbmV0YXJ5RmllbGRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby12aWRlby9zcmMvT2Rvb1ZpZGVvLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tdmlkZW8vc3JjL09kb29WaWRlb0RvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tdmlkZW8vc3JjL09kb29WaWRlb05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby12aWRlby9zcmMvT2Rvb1ZpZGVvWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28vc3JjL09kb28udHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby9zcmMvT2Rvb0ZvbnRBd2Vzb21lRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby9zcmMvT2Rvb0ltYWdlRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby9zcmMvT2Rvb1N0cnVjdHVyZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby9zcmMvT2Rvb1N0cnVjdHVyZVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vL3NyYy9PZG9vVHJhbnNsYXRpb25Gb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby9zcmMvT2Rvb1RyYW5zbGF0aW9uWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW93bC9zcmMvT3dsLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW93bC9zcmMvT3dsQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW93bC9zcmMvT3dsRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb3dsL3NyYy9Pd2xOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wYXJhZ3JhcGgvc3JjL1BhcmFncmFwaFhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcnNlci9zcmMvUGFyc2luZ0VuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZUNoYXJEb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZVNlcGFyYXRvckRvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RlZmF1bHREb21PYmplY3RNb2RpZmllclJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RlZmF1bHREb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRm9ybWF0RG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci9zcmMvTW9kaWZpZXJSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zaGFkb3cvc3JjL1NoYWRvdy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zaGFkb3cvc3JjL1NoYWRvd0RvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXNoYWRvdy9zcmMvU2hhZG93SHRtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zaGFkb3cvc3JjL1NoYWRvd05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc2hhZG93L3NyYy9TaGFkb3dYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3Bhbi9zcmMvU3Bhbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zcGFuL3NyYy9TcGFuRm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXNwYW4vc3JjL1NwYW5YbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3Vic2NyaXB0L3NyYy9TdWJzY3JpcHQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3Vic2NyaXB0L3NyYy9TdWJzY3JpcHRGb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3Vic2NyaXB0L3NyYy9TdWJzY3JpcHRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3VwZXJzY3JpcHQvc3JjL1N1cGVyc2NyaXB0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXN1cGVyc2NyaXB0L3NyYy9TdXBlcnNjcmlwdEZvcm1hdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zdXBlcnNjcmlwdC9zcmMvU3VwZXJzY3JpcHRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvYXNzZXRzL3RhYmxlVUkuY3NzP2JjY2YiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZUNlbGxEb21PYmplY3RSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9zcmMvVGFibGVDZWxsTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9zcmMvVGFibGVDZWxsWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlUGlja2VyQ2VsbERvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZVBpY2tlckRvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZVBpY2tlck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlUm93RG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlUm93Tm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9zcmMvVGFibGVSb3dYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlU2VjdGlvbkF0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10ZXh0YXJlYS9zcmMvVGV4dGFyZWEudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGV4dGFyZWEvc3JjL1RleHRhcmVhRG9tT2JqZWN0UmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGV4dGFyZWEvc3JjL1RleHRhcmVhTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10ZXh0YXJlYS9zcmMvVGV4dGFyZWFYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGV4dGNvbG9yL3NyYy9UZXh0Q29sb3IudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGhlbWUvc3JjL1RoZW1lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRoZW1lL3NyYy9UaGVtZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRoZW1lL3NyYy9UaGVtZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGhlbWUvc3JjL1RoZW1lWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhckRvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXJOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXJYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdW5kZXJsaW5lL3NyYy9VbmRlcmxpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdW5kZXJsaW5lL3NyYy9VbmRlcmxpbmVGb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdW5kZXJsaW5lL3NyYy9VbmRlcmxpbmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlc0RvbU9iamVjdE1vZGlmaWVyUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9DbGFzc0xpc3QudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9Dc3NTdHlsZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi14bWwvc3JjL0RlZmF1bHRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9YbWwudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teW91dHViZS9zcmMvWW91dHViZURvbU9iamVjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmVOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvRG9tLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvdXRpbHMvc3JjL0RvbU1hcC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3V0aWxzL3NyYy9FdmVudE1peGluLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvdXRpbHMvc3JjL1JlYWN0aXZlVmFsdWUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvY29uZmlndXJhdGlvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3V0aWxzL3NyYy9lcnJvcnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvZm9ybWF0dGluZ1NwYWNlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvdXRpbHMvc3JjL2lzQmxvY2sudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvcG9seWZpbGwudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7UUFBQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTs7O1FBR0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDBDQUEwQyxnQ0FBZ0M7UUFDMUU7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSx3REFBd0Qsa0JBQWtCO1FBQzFFO1FBQ0EsaURBQWlELGNBQWM7UUFDL0Q7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLHlDQUF5QyxpQ0FBaUM7UUFDMUUsZ0hBQWdILG1CQUFtQixFQUFFO1FBQ3JJO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMkJBQTJCLDBCQUEwQixFQUFFO1FBQ3ZELGlDQUFpQyxlQUFlO1FBQ2hEO1FBQ0E7UUFDQTs7UUFFQTtRQUNBLHNEQUFzRCwrREFBK0Q7O1FBRXJIO1FBQ0E7OztRQUdBO1FBQ0E7Ozs7Ozs7Ozs7Ozs7QUNsRmE7O0FBRWIsOENBQThDLGNBQWM7O0FBRTVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RkFBeUYsSUFBSSxXQUFXLE9BQU87QUFDL0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELFVBQVU7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7O0FBRXJCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQixzQkFBc0IsYUFBYTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsa0JBQWtCO0FBQ2pDO0FBQ0EsbUJBQW1CLG9CQUFvQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELFVBQVU7QUFDM0Q7QUFDQTtBQUNBLG1EQUFtRCxVQUFVO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb0JBQW9CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsVUFBVTtBQUM1RDtBQUNBO0FBQ0EseURBQXlELFVBQVU7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxvQkFBb0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELFVBQVU7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRDtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxVQUFVO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsVUFBVTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxVQUFVO0FBQy9EO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFVBQVU7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxVQUFVO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGVBQWU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywwQkFBMEIsSUFBSTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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LG9DQUFvQyxFQUFFO0FBQ3RDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLDBCQUEwQixFQUFFO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsSUFBSTtBQUM5QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtCQUFrQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RSxXQUFXLFVBQVUsWUFBWTtBQUN6RyxtQ0FBbUMsS0FBSyxJQUFJLDRCQUE0QjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxlQUFlO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLEtBQUs7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsS0FBSztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxLQUFLO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsVUFBVTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QyxxQ0FBcUMsT0FBTztBQUM1QyxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsWUFBWTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHlCQUF5QjtBQUM5QyxxQ0FBcUMsTUFBTTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix1QkFBdUI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUMsaUNBQWlDLE9BQU8sS0FBSyxzQkFBc0I7QUFDbkUsOENBQThDLE9BQU8sT0FBTyxhQUFhO0FBQ3pFO0FBQ0Esd0NBQXdDLFlBQVksV0FBVztBQUMvRDtBQUNBLG9FQUFvRSxPQUFPLEVBQUU7QUFDN0U7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUIsc0NBQXNDLFdBQVcsYUFBYTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpQkFBaUI7QUFDaEQsaUNBQWlDLE9BQU8sS0FBSyxpQ0FBaUM7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxFQUFFO0FBQ3BDO0FBQ0EsK0JBQStCLGlCQUFpQjtBQUNoRCxtQ0FBbUMsU0FBUyxJQUFJLEVBQUUsV0FBVztBQUM3RDtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MseUNBQXlDO0FBQy9FLDhDQUE4QyxTQUFTO0FBQ3ZEO0FBQ0E7QUFDQSxpREFBaUQsU0FBUyxJQUFJLFNBQVM7QUFDdkU7QUFDQTtBQUNBLG1DQUFtQyxpQkFBaUI7QUFDcEQsdUNBQXVDLFNBQVMsS0FBSyxVQUFVO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQSx1REFBdUQsTUFBTSxLQUFLLFFBQVEsUUFBUTtBQUNsRjtBQUNBLG1EQUFtRCxNQUFNLEtBQUssUUFBUSxFQUFFO0FBQ3hFLGFBQWE7QUFDYjtBQUNBLDREQUE0RCxVQUFVO0FBQ3RFLDREQUE0RCxXQUFXO0FBQ3ZFLHlEQUF5RCxjQUFjLEVBQUUsVUFBVSxFQUFFLGFBQWEsRUFBRTtBQUNwRztBQUNBLDRCQUE0QixZQUFZLEtBQUssWUFBWSx3RUFBd0UsWUFBWSxXQUFXO0FBQ3hKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxHQUFHLE1BQU07QUFDMUMsc0NBQXNDLElBQUk7QUFDMUM7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFlBQVksa0JBQWtCLEVBQUUsU0FBUyxJQUFJLFlBQVksRUFBRTtBQUMvRjtBQUNBO0FBQ0Esb0NBQW9DLFlBQVksSUFBSSxFQUFFLFVBQVU7QUFDaEU7QUFDQSxzQkFBc0IsWUFBWSxPQUFPLFlBQVksNkJBQTZCLFlBQVk7QUFDOUYsd0JBQXdCLFlBQVksV0FBVztBQUMvQyx3QkFBd0IsWUFBWSxTQUFTO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxhQUFhLFVBQVU7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsT0FBTyxZQUFZLHVCQUF1QixRQUFRLEdBQUcsWUFBWSxZQUFZLFlBQVksRUFBRTtBQUMvSDtBQUNBLHdCQUF3QixZQUFZLHNCQUFzQixZQUFZLGlCQUFpQixNQUFNLEdBQUcsV0FBVztBQUMzRyxxQ0FBcUMsWUFBWSxnQkFBZ0I7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZSxjQUFjO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsNEJBQTRCO0FBQ2hFO0FBQ0E7QUFDQSx1Q0FBdUMsWUFBWSxLQUFLLGFBQWE7QUFDckUsNEJBQTRCLFlBQVksZ0RBQWdELFlBQVksbUNBQW1DLFlBQVksR0FBRyxpQkFBaUI7QUFDdks7QUFDQSw2QkFBNkIsWUFBWSxHQUFHLDRFQUE0RSxZQUFZLFFBQVE7QUFDNUksd0JBQXdCLFlBQVksVUFBVSxZQUFZLGdCQUFnQixZQUFZLEVBQUU7QUFDeEY7QUFDQSx3Q0FBd0MsWUFBWSxNQUFNLFlBQVksU0FBUztBQUMvRSw0QkFBNEIsWUFBWSx1QkFBdUIsU0FBUyxZQUFZLFNBQVMsWUFBWSxTQUFTLFFBQVEsWUFBWSw2QkFBNkIsR0FBRyxZQUFZLG1DQUFtQywwQkFBMEIsWUFBWSxtQkFBbUIsV0FBVyxNQUFNO0FBQy9SO0FBQ0EsMkNBQTJDLFlBQVksT0FBTyxZQUFZLFlBQVk7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixZQUFZLG9CQUFvQixRQUFRO0FBQ3BFO0FBQ0EsMERBQTBELFlBQVk7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsSUFBSTtBQUM3RCxrQ0FBa0MsT0FBTyxHQUFHLElBQUk7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixPQUFPO0FBQ3JDO0FBQ0E7QUFDQSxvQ0FBb0MsWUFBWSwwQkFBMEIsTUFBTSxTQUFTLDJCQUEyQix3QkFBd0IsR0FBRyxZQUFZLEVBQUU7QUFDN0o7QUFDQSxrREFBa0QsRUFBRSxTQUFTO0FBQzdELDhDQUE4QyxPQUFPLFlBQVksU0FBUyxFQUFFLFdBQVcsV0FBVyxjQUFjLEVBQUUseUJBQXlCLEVBQUU7QUFDN0k7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZSxjQUFjO0FBQ3pEO0FBQ0Esd0JBQXdCLFlBQVkseUJBQXlCO0FBQzdEO0FBQ0E7QUFDQSw0QkFBNEIsWUFBWSxvQkFBb0IsVUFBVTtBQUN0RTtBQUNBLHdCQUF3QixZQUFZLDRDQUE0QztBQUNoRjtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUIscUNBQXFDO0FBQ3JDLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxRQUFRO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELDJCQUEyQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsNEJBQTRCO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsUUFBUTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLE9BQU87QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELFlBQVksZ0JBQWdCLFlBQVk7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsSUFBSSx3QkFBd0IsWUFBWTtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELFNBQVMsZ0JBQWdCLFlBQVk7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsU0FBUyxpQkFBaUIsWUFBWSxJQUFJLFVBQVU7QUFDakc7QUFDQTtBQUNBO0FBQ0EsaURBQWlELFNBQVMsa0JBQWtCLFlBQVk7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsU0FBUyx3QkFBd0IsWUFBWTtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFVBQVU7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELFNBQVM7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsR0FBRyxFQUFFO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEMsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLEtBQUs7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msc0JBQXNCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxFQUFFO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsc0JBQXNCO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNCQUFzQjtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsT0FBTztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsMkJBQTJCO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGNBQWM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLFlBQVksRUFBRTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixjQUFjO0FBQzNDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUM1QixDQUFDIiwiZmlsZSI6Im9kb28taW50ZWdyYXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3BhY2thZ2VzL2J1bmRsZS1vZG9vLXdlYnNpdGUtZWRpdG9yL29kb28taW50ZWdyYXRpb24udHNcIik7XG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbi8qKlxyXG4gKiBXZSBkZWZpbmUgaGVyZSBhIHNpbXBsZSBldmVudCBidXM6IGl0IGNhblxyXG4gKiAtIGVtaXQgZXZlbnRzXHJcbiAqIC0gYWRkL3JlbW92ZSBsaXN0ZW5lcnMuXHJcbiAqXHJcbiAqIFRoaXMgaXMgYSB1c2VmdWwgcGF0dGVybiBvZiBjb21tdW5pY2F0aW9uIGluIG1hbnkgY2FzZXMuICBGb3IgT1dMLCBlYWNoXHJcbiAqIGNvbXBvbmVudHMgYW5kIHN0b3JlcyBhcmUgZXZlbnQgYnVzZXMuXHJcbiAqL1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFdmVudEJ1c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jbGFzcyBFdmVudEJ1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGEgbGlzdGVuZXIgZm9yIHRoZSAnZXZlbnRUeXBlJyBldmVudHMuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoZSAnb3duZXInIG9mIHRoaXMgZXZlbnQgY2FuIGJlIGFueXRoaW5nLCBidXQgd2lsbCBtb3JlIGxpa2VseVxyXG4gICAgICogYmUgYSBjb21wb25lbnQgb3IgYSBjbGFzcy4gVGhlIGlkZWEgaXMgdGhhdCB0aGUgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2l0aFxyXG4gICAgICogdGhlIHByb3BlciBvd25lciBib3VuZC5cclxuICAgICAqXHJcbiAgICAgKiBBbHNvLCB0aGUgb3duZXIgc2hvdWxkIGJlIGtpbmQgb2YgdW5pcXVlLiBUaGlzIHdpbGwgYmUgdXNlZCB0byByZW1vdmUgdGhlXHJcbiAgICAgKiBsaXN0ZW5lci5cclxuICAgICAqL1xyXG4gICAgb24oZXZlbnRUeXBlLCBvd25lciwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY2FsbGJhY2tcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0pIHtcclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0ucHVzaCh7XHJcbiAgICAgICAgICAgIG93bmVyLFxyXG4gICAgICAgICAgICBjYWxsYmFja1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYSBsaXN0ZW5lclxyXG4gICAgICovXHJcbiAgICBvZmYoZXZlbnRUeXBlLCBvd25lcikge1xyXG4gICAgICAgIGNvbnN0IHN1YnMgPSB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXTtcclxuICAgICAgICBpZiAoc3Vicykge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXSA9IHN1YnMuZmlsdGVyKHMgPT4gcy5vd25lciAhPT0gb3duZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRW1pdCBhbiBldmVudCBvZiB0eXBlICdldmVudFR5cGUnLiAgQW55IGV4dHJhIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZCB0b1xyXG4gICAgICogdGhlIGxpc3RlbmVycyBjYWxsYmFjay5cclxuICAgICAqL1xyXG4gICAgdHJpZ2dlcihldmVudFR5cGUsIC4uLmFyZ3MpIHtcclxuICAgICAgICBjb25zdCBzdWJzID0gdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0gfHwgW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlMZW4gPSBzdWJzLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBzdWIgPSBzdWJzW2ldO1xyXG4gICAgICAgICAgICBzdWIuY2FsbGJhY2suY2FsbChzdWIub3duZXIsIC4uLmFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGFsbCBzdWJzY3JpcHRpb25zLlxyXG4gICAgICovXHJcbiAgICBjbGVhcigpIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogT3dsIE9ic2VydmVyXHJcbiAqXHJcbiAqIFRoaXMgY29kZSBjb250YWlucyB0aGUgbG9naWMgdGhhdCBhbGxvd3MgT3dsIHRvIG9ic2VydmUgYW5kIHJlYWN0IHRvIHN0YXRlXHJcbiAqIGNoYW5nZXMuXHJcbiAqXHJcbiAqIFRoaXMgaXMgYSBPYnNlcnZlciBjbGFzcyB0aGF0IGNhbiBvYnNlcnZlIGFueSBKUyB2YWx1ZXMuICBUaGUgd2F5IGl0IHdvcmtzXHJcbiAqIGNhbiBiZSBzdW1tYXJpemVkIHRodXNseTpcclxuICogLSBwcmltaXRpdmUgdmFsdWVzIGFyZSBub3Qgb2JzZXJ2ZWQgYXQgYWxsXHJcbiAqIC0gT2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBvYnNlcnZlZCBieSByZXBsYWNpbmcgdGhlbSB3aXRoIGEgUHJveHlcclxuICogLSBlYWNoIG9iamVjdC9hcnJheSBtZXRhZGF0YSBhcmUgdHJhY2tlZCBpbiBhIHdlYWttYXAsIGFuZCBrZWVwIGEgcmV2aXNpb25cclxuICogICBudW1iZXJcclxuICpcclxuICogTm90ZSB0aGF0IHRoaXMgY29kZSBpcyBsb29zZWx5IGluc3BpcmVkIGJ5IFZ1ZS5cclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIE9ic2VydmVyXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNsYXNzIE9ic2VydmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMucmV2ID0gMTtcclxuICAgICAgICB0aGlzLmFsbG93TXV0YXRpb25zID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLndlYWtNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG4gICAgfVxyXG4gICAgbm90aWZ5Q0IoKSB7IH1cclxuICAgIG9ic2VydmUodmFsdWUsIHBhcmVudCkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIC8vIGZ1biBmYWN0OiB0eXBlb2YgbnVsbCA9PT0gJ29iamVjdCdcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbWV0YWRhdGEgPSB0aGlzLndlYWtNYXAuZ2V0KHZhbHVlKSB8fCB0aGlzLl9vYnNlcnZlKHZhbHVlLCBwYXJlbnQpO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YS5wcm94eTtcclxuICAgIH1cclxuICAgIHJldk51bWJlcih2YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy53ZWFrTWFwLmdldCh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhID8gbWV0YWRhdGEucmV2IDogMDtcclxuICAgIH1cclxuICAgIF9vYnNlcnZlKHZhbHVlLCBwYXJlbnQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkodmFsdWUsIHtcclxuICAgICAgICAgICAgZ2V0KHRhcmdldCwgaykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSB0YXJnZXRba107XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5vYnNlcnZlKHRhcmdldFZhbHVlLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCh0YXJnZXQsIGtleSwgbmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuYWxsb3dNdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPYnNlcnZlZCBzdGF0ZSBjYW5ub3QgYmUgY2hhbmdlZCBoZXJlISAoa2V5OiBcIiR7a2V5fVwiLCB2YWw6IFwiJHtuZXdWYWx9XCIpYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3VwZGF0ZVJldk51bWJlcih0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gbmV3VmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubm90aWZ5Q0IoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleSBpbiB0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fdXBkYXRlUmV2TnVtYmVyKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub3RpZnlDQigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHtcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIHByb3h5LFxyXG4gICAgICAgICAgICByZXY6IHRoaXMucmV2LFxyXG4gICAgICAgICAgICBwYXJlbnRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMud2Vha01hcC5zZXQodmFsdWUsIG1ldGFkYXRhKTtcclxuICAgICAgICB0aGlzLndlYWtNYXAuc2V0KG1ldGFkYXRhLnByb3h5LCBtZXRhZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xyXG4gICAgfVxyXG4gICAgX3VwZGF0ZVJldk51bWJlcih0YXJnZXQpIHtcclxuICAgICAgICB0aGlzLnJldisrO1xyXG4gICAgICAgIGxldCBtZXRhZGF0YSA9IHRoaXMud2Vha01hcC5nZXQodGFyZ2V0KTtcclxuICAgICAgICBsZXQgcGFyZW50ID0gdGFyZ2V0O1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEgPSB0aGlzLndlYWtNYXAuZ2V0KHBhcmVudCk7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLnJldisrO1xyXG4gICAgICAgIH0gd2hpbGUgKChwYXJlbnQgPSBtZXRhZGF0YS5wYXJlbnQpICYmIHBhcmVudCAhPT0gdGFyZ2V0KTtcclxuICAgIH1cclxufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBtb2R1bGUvcHJvcHMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZnVuY3Rpb24gdXBkYXRlUHJvcHMob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICB2YXIga2V5LCBjdXIsIG9sZCwgZWxtID0gdm5vZGUuZWxtLCBvbGRQcm9wcyA9IG9sZFZub2RlLmRhdGEucHJvcHMsIHByb3BzID0gdm5vZGUuZGF0YS5wcm9wcztcclxuICAgIGlmICghb2xkUHJvcHMgJiYgIXByb3BzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChvbGRQcm9wcyA9PT0gcHJvcHMpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgb2xkUHJvcHMgPSBvbGRQcm9wcyB8fCB7fTtcclxuICAgIHByb3BzID0gcHJvcHMgfHwge307XHJcbiAgICBmb3IgKGtleSBpbiBvbGRQcm9wcykge1xyXG4gICAgICAgIGlmICghcHJvcHNba2V5XSkge1xyXG4gICAgICAgICAgICBkZWxldGUgZWxtW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICBjdXIgPSBwcm9wc1trZXldO1xyXG4gICAgICAgIG9sZCA9IG9sZFByb3BzW2tleV07XHJcbiAgICAgICAgaWYgKG9sZCAhPT0gY3VyICYmIChrZXkgIT09IFwidmFsdWVcIiB8fCBlbG1ba2V5XSAhPT0gY3VyKSkge1xyXG4gICAgICAgICAgICBlbG1ba2V5XSA9IGN1cjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY29uc3QgcHJvcHNNb2R1bGUgPSB7XHJcbiAgICBjcmVhdGU6IHVwZGF0ZVByb3BzLFxyXG4gICAgdXBkYXRlOiB1cGRhdGVQcm9wc1xyXG59O1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBtb2R1bGUvZXZlbnRsaXN0ZW5lcnMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZnVuY3Rpb24gaW52b2tlSGFuZGxlcihoYW5kbGVyLCB2bm9kZSwgZXZlbnQpIHtcclxuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiBoYW5kbGVyXHJcbiAgICAgICAgaGFuZGxlci5jYWxsKHZub2RlLCBldmVudCwgdm5vZGUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAvLyBjYWxsIGhhbmRsZXIgd2l0aCBhcmd1bWVudHNcclxuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXJbMF0gPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIHNpbmdsZSBhcmd1bWVudCBmb3IgcGVyZm9ybWFuY2VcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyWzBdLmNhbGwodm5vZGUsIGhhbmRsZXJbMV0sIGV2ZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGhhbmRsZXIuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJbMF0uYXBwbHkodm5vZGUsIGFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBjYWxsIG11bHRpcGxlIGhhbmRsZXJzXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpTGVuID0gaGFuZGxlci5sZW5ndGg7IGkgPCBpTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGludm9rZUhhbmRsZXIoaGFuZGxlcltpXSwgdm5vZGUsIGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVFdmVudChldmVudCwgdm5vZGUpIHtcclxuICAgIHZhciBuYW1lID0gZXZlbnQudHlwZSwgb24gPSB2bm9kZS5kYXRhLm9uO1xyXG4gICAgLy8gY2FsbCBldmVudCBoYW5kbGVyKHMpIGlmIGV4aXN0c1xyXG4gICAgaWYgKG9uKSB7XHJcbiAgICAgICAgaWYgKG9uW25hbWVdKSB7XHJcbiAgICAgICAgICAgIGludm9rZUhhbmRsZXIob25bbmFtZV0sIHZub2RlLCBldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9uW1wiIVwiICsgbmFtZV0pIHtcclxuICAgICAgICAgICAgaW52b2tlSGFuZGxlcihvbltcIiFcIiArIG5hbWVdLCB2bm9kZSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVMaXN0ZW5lcigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7XHJcbiAgICAgICAgaGFuZGxlRXZlbnQoZXZlbnQsIGhhbmRsZXIudm5vZGUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVFdmVudExpc3RlbmVycyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEub24sIG9sZExpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIsIG9sZEVsbSA9IG9sZFZub2RlLmVsbSwgb24gPSB2bm9kZSAmJiB2bm9kZS5kYXRhLm9uLCBlbG0gPSAodm5vZGUgJiYgdm5vZGUuZWxtKSwgbmFtZTtcclxuICAgIC8vIG9wdGltaXphdGlvbiBmb3IgcmV1c2VkIGltbXV0YWJsZSBoYW5kbGVyc1xyXG4gICAgaWYgKG9sZE9uID09PSBvbikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vIHJlbW92ZSBleGlzdGluZyBsaXN0ZW5lcnMgd2hpY2ggbm8gbG9uZ2VyIHVzZWRcclxuICAgIGlmIChvbGRPbiAmJiBvbGRMaXN0ZW5lcikge1xyXG4gICAgICAgIC8vIGlmIGVsZW1lbnQgY2hhbmdlZCBvciBkZWxldGVkIHdlIHJlbW92ZSBhbGwgZXhpc3RpbmcgbGlzdGVuZXJzIHVuY29uZGl0aW9uYWxseVxyXG4gICAgICAgIGlmICghb24pIHtcclxuICAgICAgICAgICAgZm9yIChuYW1lIGluIG9sZE9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXIgaWYgZWxlbWVudCB3YXMgY2hhbmdlZCBvciBleGlzdGluZyBsaXN0ZW5lcnMgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FwdHVyZSA9IG5hbWUuY2hhckF0KDApID09PSBcIiFcIjtcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBvbGRFbG0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBvbGRMaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbGRPbikge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGxpc3RlbmVyIGlmIGV4aXN0aW5nIGxpc3RlbmVyIHJlbW92ZWRcclxuICAgICAgICAgICAgICAgIGlmICghb25bbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gbmFtZS5jaGFyQXQoMCkgPT09IFwiIVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgb2xkRWxtLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgb2xkTGlzdGVuZXIsIGNhcHR1cmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gYWRkIG5ldyBsaXN0ZW5lcnMgd2hpY2ggaGFzIG5vdCBhbHJlYWR5IGF0dGFjaGVkXHJcbiAgICBpZiAob24pIHtcclxuICAgICAgICAvLyByZXVzZSBleGlzdGluZyBsaXN0ZW5lciBvciBjcmVhdGUgbmV3XHJcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gKHZub2RlLmxpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIgfHwgY3JlYXRlTGlzdGVuZXIoKSk7XHJcbiAgICAgICAgLy8gdXBkYXRlIHZub2RlIGZvciBsaXN0ZW5lclxyXG4gICAgICAgIGxpc3RlbmVyLnZub2RlID0gdm5vZGU7XHJcbiAgICAgICAgLy8gaWYgZWxlbWVudCBjaGFuZ2VkIG9yIGFkZGVkIHdlIGFkZCBhbGwgbmVlZGVkIGxpc3RlbmVycyB1bmNvbmRpdGlvbmFsbHlcclxuICAgICAgICBpZiAoIW9sZE9uKSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIGVsZW1lbnQgd2FzIGNoYW5nZWQgb3IgbmV3IGxpc3RlbmVycyBhZGRlZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FwdHVyZSA9IG5hbWUuY2hhckF0KDApID09PSBcIiFcIjtcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBsaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIG5ldyBsaXN0ZW5lciBhZGRlZFxyXG4gICAgICAgICAgICAgICAgaWYgKCFvbGRPbltuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcHR1cmUgPSBuYW1lLmNoYXJBdCgwKSA9PT0gXCIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGNhcHR1cmUgPyBuYW1lLnNsaWNlKDEpIDogbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBsaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY29uc3QgZXZlbnRMaXN0ZW5lcnNNb2R1bGUgPSB7XHJcbiAgICBjcmVhdGU6IHVwZGF0ZUV2ZW50TGlzdGVuZXJzLFxyXG4gICAgdXBkYXRlOiB1cGRhdGVFdmVudExpc3RlbmVycyxcclxuICAgIGRlc3Ryb3k6IHVwZGF0ZUV2ZW50TGlzdGVuZXJzXHJcbn07XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIGF0dHJpYnV0ZXMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgeGxpbmtOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiO1xyXG5jb25zdCB4bWxOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlXCI7XHJcbmNvbnN0IGNvbG9uQ2hhciA9IDU4O1xyXG5jb25zdCB4Q2hhciA9IDEyMDtcclxuZnVuY3Rpb24gdXBkYXRlQXR0cnMob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICB2YXIga2V5LCBlbG0gPSB2bm9kZS5lbG0sIG9sZEF0dHJzID0gb2xkVm5vZGUuZGF0YS5hdHRycywgYXR0cnMgPSB2bm9kZS5kYXRhLmF0dHJzO1xyXG4gICAgaWYgKCFvbGRBdHRycyAmJiAhYXR0cnMpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKG9sZEF0dHJzID09PSBhdHRycylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBvbGRBdHRycyA9IG9sZEF0dHJzIHx8IHt9O1xyXG4gICAgYXR0cnMgPSBhdHRycyB8fCB7fTtcclxuICAgIC8vIHVwZGF0ZSBtb2RpZmllZCBhdHRyaWJ1dGVzLCBhZGQgbmV3IGF0dHJpYnV0ZXNcclxuICAgIGZvciAoa2V5IGluIGF0dHJzKSB7XHJcbiAgICAgICAgY29uc3QgY3VyID0gYXR0cnNba2V5XTtcclxuICAgICAgICBjb25zdCBvbGQgPSBvbGRBdHRyc1trZXldO1xyXG4gICAgICAgIGlmIChvbGQgIT09IGN1cikge1xyXG4gICAgICAgICAgICBpZiAoY3VyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgXCJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY3VyID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleS5jaGFyQ29kZUF0KDApICE9PSB4Q2hhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGUoa2V5LCBjdXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5LmNoYXJDb2RlQXQoMykgPT09IGNvbG9uQ2hhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc3VtZSB4bWwgbmFtZXNwYWNlXHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZU5TKHhtbE5TLCBrZXksIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrZXkuY2hhckNvZGVBdCg1KSA9PT0gY29sb25DaGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQXNzdW1lIHhsaW5rIG5hbWVzcGFjZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgY3VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHJlbW92ZSByZW1vdmVkIGF0dHJpYnV0ZXNcclxuICAgIC8vIHVzZSBgaW5gIG9wZXJhdG9yIHNpbmNlIHRoZSBwcmV2aW91cyBgZm9yYCBpdGVyYXRpb24gdXNlcyBpdCAoLmkuZS4gYWRkIGV2ZW4gYXR0cmlidXRlcyB3aXRoIHVuZGVmaW5lZCB2YWx1ZSlcclxuICAgIC8vIHRoZSBvdGhlciBvcHRpb24gaXMgdG8gcmVtb3ZlIGFsbCBhdHRyaWJ1dGVzIHdpdGggdmFsdWUgPT0gdW5kZWZpbmVkXHJcbiAgICBmb3IgKGtleSBpbiBvbGRBdHRycykge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBhdHRycykpIHtcclxuICAgICAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb25zdCBhdHRyc01vZHVsZSA9IHtcclxuICAgIGNyZWF0ZTogdXBkYXRlQXR0cnMsXHJcbiAgICB1cGRhdGU6IHVwZGF0ZUF0dHJzXHJcbn07XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIGNsYXNzLnRzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIHVwZGF0ZUNsYXNzKG9sZFZub2RlLCB2bm9kZSkge1xyXG4gICAgdmFyIGN1ciwgbmFtZSwgZWxtLCBvbGRDbGFzcyA9IG9sZFZub2RlLmRhdGEuY2xhc3MsIGtsYXNzID0gdm5vZGUuZGF0YS5jbGFzcztcclxuICAgIGlmICghb2xkQ2xhc3MgJiYgIWtsYXNzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChvbGRDbGFzcyA9PT0ga2xhc3MpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgb2xkQ2xhc3MgPSBvbGRDbGFzcyB8fCB7fTtcclxuICAgIGtsYXNzID0ga2xhc3MgfHwge307XHJcbiAgICBlbG0gPSB2bm9kZS5lbG07XHJcbiAgICBmb3IgKG5hbWUgaW4gb2xkQ2xhc3MpIHtcclxuICAgICAgICBpZiAobmFtZSAmJiAha2xhc3NbbmFtZV0pIHtcclxuICAgICAgICAgICAgZWxtLmNsYXNzTGlzdC5yZW1vdmUobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChuYW1lIGluIGtsYXNzKSB7XHJcbiAgICAgICAgY3VyID0ga2xhc3NbbmFtZV07XHJcbiAgICAgICAgaWYgKGN1ciAhPT0gb2xkQ2xhc3NbbmFtZV0pIHtcclxuICAgICAgICAgICAgZWxtLmNsYXNzTGlzdFtjdXIgPyBcImFkZFwiIDogXCJyZW1vdmVcIl0obmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IGNsYXNzTW9kdWxlID0geyBjcmVhdGU6IHVwZGF0ZUNsYXNzLCB1cGRhdGU6IHVwZGF0ZUNsYXNzIH07XG5cbi8qKlxyXG4gKiBPd2wgVkRPTVxyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgYW4gaW1wbGVtZW50YXRpb24gb2YgYSB2aXJ0dWFsIERPTSwgd2hpY2ggaXMgYSBzeXN0ZW0gdGhhdFxyXG4gKiBjYW4gZ2VuZXJhdGUgaW4tbWVtb3J5IHJlcHJlc2VudGF0aW9ucyBvZiBhIERPTSB0cmVlLCBjb21wYXJlIHRoZW0sIGFuZFxyXG4gKiBldmVudHVhbGx5IGNoYW5nZSBhIGNvbmNyZXRlIERPTSB0cmVlIHRvIG1hdGNoIGl0cyByZXByZXNlbnRhdGlvbiwgaW4gYW5cclxuICogaG9wZWZ1bGx5IGVmZmljaWVudCB3YXkuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGlzIGNvZGUgaXMgYSBmb3JrIG9mIFNuYWJiZG9tLCBzbGlnaHRseSB0d2Vha2VkL29wdGltaXplZCBmb3Igb3VyXHJcbiAqIG5lZWRzIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL3NuYWJiZG9tL3NuYWJiZG9tKS5cclxuICpcclxuICogVGhlIG1haW4gZXhwb3J0ZWQgdmFsdWVzIGFyZTpcclxuICogLSBpbnRlcmZhY2UgVk5vZGVcclxuICogLSBoIGZ1bmN0aW9uIChhIGhlbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBhIHZub2RlKVxyXG4gKiAtIHBhdGNoIGZ1bmN0aW9uICh0byBhcHBseSBhIHZub2RlIHRvIGFuIGFjdHVhbCBET00gbm9kZSlcclxuICovXHJcbmZ1bmN0aW9uIHZub2RlKHNlbCwgZGF0YSwgY2hpbGRyZW4sIHRleHQsIGVsbSkge1xyXG4gICAgbGV0IGtleSA9IGRhdGEgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IGRhdGEua2V5O1xyXG4gICAgcmV0dXJuIHsgc2VsLCBkYXRhLCBjaGlsZHJlbiwgdGV4dCwgZWxtLCBrZXkgfTtcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBzbmFiYmRvbS50c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBpc1VuZGVmKHMpIHtcclxuICAgIHJldHVybiBzID09PSB1bmRlZmluZWQ7XHJcbn1cclxuZnVuY3Rpb24gaXNEZWYocykge1xyXG4gICAgcmV0dXJuIHMgIT09IHVuZGVmaW5lZDtcclxufVxyXG5jb25zdCBlbXB0eU5vZGUgPSB2bm9kZShcIlwiLCB7fSwgW10sIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcclxuZnVuY3Rpb24gc2FtZVZub2RlKHZub2RlMSwgdm5vZGUyKSB7XHJcbiAgICByZXR1cm4gdm5vZGUxLmtleSA9PT0gdm5vZGUyLmtleSAmJiB2bm9kZTEuc2VsID09PSB2bm9kZTIuc2VsO1xyXG59XHJcbmZ1bmN0aW9uIGlzVm5vZGUodm5vZGUpIHtcclxuICAgIHJldHVybiB2bm9kZS5zZWwgIT09IHVuZGVmaW5lZDtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVLZXlUb09sZElkeChjaGlsZHJlbiwgYmVnaW5JZHgsIGVuZElkeCkge1xyXG4gICAgbGV0IGksIG1hcCA9IHt9LCBrZXksIGNoO1xyXG4gICAgZm9yIChpID0gYmVnaW5JZHg7IGkgPD0gZW5kSWR4OyArK2kpIHtcclxuICAgICAgICBjaCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGtleSA9IGNoLmtleTtcclxuICAgICAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgbWFwW2tleV0gPSBpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBtYXA7XHJcbn1cclxuY29uc3QgaG9va3MgPSBbXCJjcmVhdGVcIiwgXCJ1cGRhdGVcIiwgXCJyZW1vdmVcIiwgXCJkZXN0cm95XCIsIFwicHJlXCIsIFwicG9zdFwiXTtcclxuZnVuY3Rpb24gaW5pdChtb2R1bGVzLCBkb21BcGkpIHtcclxuICAgIGxldCBpLCBqLCBjYnMgPSB7fTtcclxuICAgIGNvbnN0IGFwaSA9IGRvbUFwaSAhPT0gdW5kZWZpbmVkID8gZG9tQXBpIDogaHRtbERvbUFwaTtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBob29rcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGNic1tob29rc1tpXV0gPSBbXTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgbW9kdWxlcy5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICBjb25zdCBob29rID0gbW9kdWxlc1tqXVtob29rc1tpXV07XHJcbiAgICAgICAgICAgIGlmIChob29rICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNic1tob29rc1tpXV0ucHVzaChob29rKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGVtcHR5Tm9kZUF0KGVsbSkge1xyXG4gICAgICAgIGNvbnN0IGlkID0gZWxtLmlkID8gXCIjXCIgKyBlbG0uaWQgOiBcIlwiO1xyXG4gICAgICAgIGNvbnN0IGMgPSBlbG0uY2xhc3NOYW1lID8gXCIuXCIgKyBlbG0uY2xhc3NOYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiLlwiKSA6IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIHZub2RlKGFwaS50YWdOYW1lKGVsbSkudG9Mb3dlckNhc2UoKSArIGlkICsgYywge30sIFtdLCB1bmRlZmluZWQsIGVsbSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVSbUNiKGNoaWxkRWxtLCBsaXN0ZW5lcnMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gcm1DYigpIHtcclxuICAgICAgICAgICAgaWYgKC0tbGlzdGVuZXJzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBhcGkucGFyZW50Tm9kZShjaGlsZEVsbSk7XHJcbiAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50LCBjaGlsZEVsbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHtcclxuICAgICAgICBsZXQgaSwgaUxlbiwgZGF0YSA9IHZub2RlLmRhdGE7XHJcbiAgICAgICAgaWYgKGRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoaXNEZWYoKGkgPSBkYXRhLmhvb2spKSAmJiBpc0RlZigoaSA9IGkuaW5pdCkpKSB7XHJcbiAgICAgICAgICAgICAgICBpKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuLCBzZWwgPSB2bm9kZS5zZWw7XHJcbiAgICAgICAgaWYgKHNlbCA9PT0gXCIhXCIpIHtcclxuICAgICAgICAgICAgaWYgKGlzVW5kZWYodm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLnRleHQgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZub2RlLmVsbSA9IGFwaS5jcmVhdGVDb21tZW50KHZub2RlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzZWwgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbG0gPSB2bm9kZS5lbG0gfHxcclxuICAgICAgICAgICAgICAgICh2bm9kZS5lbG0gPVxyXG4gICAgICAgICAgICAgICAgICAgIGlzRGVmKGRhdGEpICYmIGlzRGVmKChpID0gZGF0YS5ucykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYXBpLmNyZWF0ZUVsZW1lbnROUyhpLCBzZWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYXBpLmNyZWF0ZUVsZW1lbnQoc2VsKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjYnMuY3JlYXRlLmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgICAgIGNicy5jcmVhdGVbaV0oZW1wdHlOb2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChhcnJheShjaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpTGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5hcHBlbmRDaGlsZChlbG0sIGNyZWF0ZUVsbShjaCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHByaW1pdGl2ZSh2bm9kZS50ZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmFwcGVuZENoaWxkKGVsbSwgYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpID0gdm5vZGUuZGF0YS5ob29rOyAvLyBSZXVzZSB2YXJpYWJsZVxyXG4gICAgICAgICAgICBpZiAoaXNEZWYoaSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmNyZWF0ZSlcclxuICAgICAgICAgICAgICAgICAgICBpLmNyZWF0ZShlbXB0eU5vZGUsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChpLmluc2VydClcclxuICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZFZub2RlUXVldWUucHVzaCh2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZub2RlLmVsbSA9IGFwaS5jcmVhdGVUZXh0Tm9kZSh2bm9kZS50ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZub2RlLmVsbTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGFkZFZub2RlcyhwYXJlbnRFbG0sIGJlZm9yZSwgdm5vZGVzLCBzdGFydElkeCwgZW5kSWR4LCBpbnNlcnRlZFZub2RlUXVldWUpIHtcclxuICAgICAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoID0gdm5vZGVzW3N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgaWYgKGNoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBjcmVhdGVFbG0oY2gsIGluc2VydGVkVm5vZGVRdWV1ZSksIGJlZm9yZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpbnZva2VEZXN0cm95SG9vayh2bm9kZSkge1xyXG4gICAgICAgIGxldCBpLCBpTGVuLCBqLCBqTGVuLCBkYXRhID0gdm5vZGUuZGF0YTtcclxuICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZigoaSA9IGRhdGEuaG9vaykpICYmIGlzRGVmKChpID0gaS5kZXN0cm95KSkpXHJcbiAgICAgICAgICAgICAgICBpKHZub2RlKTtcclxuICAgICAgICAgICAgZm9yIChpID0gMCwgaUxlbiA9IGNicy5kZXN0cm95Lmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgICAgIGNicy5kZXN0cm95W2ldKHZub2RlKTtcclxuICAgICAgICAgICAgaWYgKHZub2RlLmNoaWxkcmVuICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpMZW4gPSB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7IGogPCBqTGVuOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdm5vZGUuY2hpbGRyZW5bal07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gbnVsbCAmJiB0eXBlb2YgaSAhPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZva2VEZXN0cm95SG9vayhpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZW1vdmVWbm9kZXMocGFyZW50RWxtLCB2bm9kZXMsIHN0YXJ0SWR4LCBlbmRJZHgpIHtcclxuICAgICAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7XHJcbiAgICAgICAgICAgIGxldCBpLCBpTGVuLCBsaXN0ZW5lcnMsIHJtLCBjaCA9IHZub2Rlc1tzdGFydElkeF07XHJcbiAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWYoY2guc2VsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZURlc3Ryb3lIb29rKGNoKTtcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcnMgPSBjYnMucmVtb3ZlLmxlbmd0aCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgcm0gPSBjcmVhdGVSbUNiKGNoLmVsbSwgbGlzdGVuZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnJlbW92ZS5sZW5ndGg7IGkgPCBpTGVuOyArK2kpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNicy5yZW1vdmVbaV0oY2gsIHJtKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZWYoKGkgPSBjaC5kYXRhKSkgJiYgaXNEZWYoKGkgPSBpLmhvb2spKSAmJiBpc0RlZigoaSA9IGkucmVtb3ZlKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaShjaCwgcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUZXh0IG5vZGVcclxuICAgICAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50RWxtLCBjaC5lbG0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlQ2hpbGRyZW4ocGFyZW50RWxtLCBvbGRDaCwgbmV3Q2gsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xyXG4gICAgICAgIGxldCBvbGRTdGFydElkeCA9IDAsIG5ld1N0YXJ0SWR4ID0gMDtcclxuICAgICAgICBsZXQgb2xkRW5kSWR4ID0gb2xkQ2gubGVuZ3RoIC0gMTtcclxuICAgICAgICBsZXQgb2xkU3RhcnRWbm9kZSA9IG9sZENoWzBdO1xyXG4gICAgICAgIGxldCBvbGRFbmRWbm9kZSA9IG9sZENoW29sZEVuZElkeF07XHJcbiAgICAgICAgbGV0IG5ld0VuZElkeCA9IG5ld0NoLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgbGV0IG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFswXTtcclxuICAgICAgICBsZXQgbmV3RW5kVm5vZGUgPSBuZXdDaFtuZXdFbmRJZHhdO1xyXG4gICAgICAgIGxldCBvbGRLZXlUb0lkeDtcclxuICAgICAgICBsZXQgaWR4SW5PbGQ7XHJcbiAgICAgICAgbGV0IGVsbVRvTW92ZTtcclxuICAgICAgICBsZXQgYmVmb3JlO1xyXG4gICAgICAgIHdoaWxlIChvbGRTdGFydElkeCA8PSBvbGRFbmRJZHggJiYgbmV3U3RhcnRJZHggPD0gbmV3RW5kSWR4KSB7XHJcbiAgICAgICAgICAgIGlmIChvbGRTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsgLy8gVm5vZGUgbWlnaHQgaGF2ZSBiZWVuIG1vdmVkIGxlZnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvbGRFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld0VuZFZub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgcGF0Y2hWbm9kZShvbGRFbmRWbm9kZSwgbmV3RW5kVm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdFbmRWbm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFZub2RlIG1vdmVkIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZFN0YXJ0Vm5vZGUsIG5ld0VuZFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtLCBhcGkubmV4dFNpYmxpbmcob2xkRW5kVm5vZGUuZWxtKSk7XHJcbiAgICAgICAgICAgICAgICBvbGRTdGFydFZub2RlID0gb2xkQ2hbKytvbGRTdGFydElkeF07XHJcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld1N0YXJ0Vm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBWbm9kZSBtb3ZlZCBsZWZ0XHJcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZEVuZFZub2RlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgb2xkRW5kVm5vZGUgPSBvbGRDaFstLW9sZEVuZElkeF07XHJcbiAgICAgICAgICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkS2V5VG9JZHggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9sZEtleVRvSWR4ID0gY3JlYXRlS2V5VG9PbGRJZHgob2xkQ2gsIG9sZFN0YXJ0SWR4LCBvbGRFbmRJZHgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWR4SW5PbGQgPSBvbGRLZXlUb0lkeFtuZXdTdGFydFZub2RlLmtleV07XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNVbmRlZihpZHhJbk9sZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBOZXcgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsbVRvTW92ZSA9IG9sZENoW2lkeEluT2xkXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxtVG9Nb3ZlLnNlbCAhPT0gbmV3U3RhcnRWbm9kZS5zZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIGNyZWF0ZUVsbShuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpLCBvbGRTdGFydFZub2RlLmVsbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRjaFZub2RlKGVsbVRvTW92ZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkQ2hbaWR4SW5PbGRdID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudEVsbSwgZWxtVG9Nb3ZlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZFN0YXJ0SWR4IDw9IG9sZEVuZElkeCB8fCBuZXdTdGFydElkeCA8PSBuZXdFbmRJZHgpIHtcclxuICAgICAgICAgICAgaWYgKG9sZFN0YXJ0SWR4ID4gb2xkRW5kSWR4KSB7XHJcbiAgICAgICAgICAgICAgICBiZWZvcmUgPSBuZXdDaFtuZXdFbmRJZHggKyAxXSA9PSBudWxsID8gbnVsbCA6IG5ld0NoW25ld0VuZElkeCArIDFdLmVsbTtcclxuICAgICAgICAgICAgICAgIGFkZFZub2RlcyhwYXJlbnRFbG0sIGJlZm9yZSwgbmV3Q2gsIG5ld1N0YXJ0SWR4LCBuZXdFbmRJZHgsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMocGFyZW50RWxtLCBvbGRDaCwgb2xkU3RhcnRJZHgsIG9sZEVuZElkeCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSB7XHJcbiAgICAgICAgbGV0IGksIGlMZW4sIGhvb2s7XHJcbiAgICAgICAgaWYgKGlzRGVmKChpID0gdm5vZGUuZGF0YSkpICYmIGlzRGVmKChob29rID0gaS5ob29rKSkgJiYgaXNEZWYoKGkgPSBob29rLnByZXBhdGNoKSkpIHtcclxuICAgICAgICAgICAgaShvbGRWbm9kZSwgdm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBlbG0gPSAodm5vZGUuZWxtID0gb2xkVm5vZGUuZWxtKTtcclxuICAgICAgICBsZXQgb2xkQ2ggPSBvbGRWbm9kZS5jaGlsZHJlbjtcclxuICAgICAgICBsZXQgY2ggPSB2bm9kZS5jaGlsZHJlbjtcclxuICAgICAgICBpZiAob2xkVm5vZGUgPT09IHZub2RlKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgaWYgKHZub2RlLmRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnVwZGF0ZS5sZW5ndGg7IGkgPCBpTGVuOyArK2kpXHJcbiAgICAgICAgICAgICAgICBjYnMudXBkYXRlW2ldKG9sZFZub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgIGkgPSB2bm9kZS5kYXRhLmhvb2s7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZihpKSAmJiBpc0RlZigoaSA9IGkudXBkYXRlKSkpXHJcbiAgICAgICAgICAgICAgICBpKG9sZFZub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1VuZGVmKHZub2RlLnRleHQpKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZihvbGRDaCkgJiYgaXNEZWYoY2gpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkQ2ggIT09IGNoKVxyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNoaWxkcmVuKGVsbSwgb2xkQ2gsIGNoLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRGVmKGNoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzRGVmKG9sZFZub2RlLnRleHQpKVxyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgYWRkVm5vZGVzKGVsbSwgbnVsbCwgY2gsIDAsIGNoLmxlbmd0aCAtIDEsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkQ2gpKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMoZWxtLCBvbGRDaCwgMCwgb2xkQ2gubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIFwiXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9sZFZub2RlLnRleHQgIT09IHZub2RlLnRleHQpIHtcclxuICAgICAgICAgICAgaWYgKGlzRGVmKG9sZENoKSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlVm5vZGVzKGVsbSwgb2xkQ2gsIDAsIG9sZENoLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIHZub2RlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNEZWYoaG9vaykgJiYgaXNEZWYoKGkgPSBob29rLnBvc3RwYXRjaCkpKSB7XHJcbiAgICAgICAgICAgIGkob2xkVm5vZGUsIHZub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gcGF0Y2gob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICAgICAgbGV0IGksIGlMZW4sIGVsbSwgcGFyZW50O1xyXG4gICAgICAgIGNvbnN0IGluc2VydGVkVm5vZGVRdWV1ZSA9IFtdO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjYnMucHJlLmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgY2JzLnByZVtpXSgpO1xyXG4gICAgICAgIGlmICghaXNWbm9kZShvbGRWbm9kZSkpIHtcclxuICAgICAgICAgICAgb2xkVm5vZGUgPSBlbXB0eU5vZGVBdChvbGRWbm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzYW1lVm5vZGUob2xkVm5vZGUsIHZub2RlKSkge1xyXG4gICAgICAgICAgICBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVsbSA9IG9sZFZub2RlLmVsbTtcclxuICAgICAgICAgICAgcGFyZW50ID0gYXBpLnBhcmVudE5vZGUoZWxtKTtcclxuICAgICAgICAgICAgY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudCwgdm5vZGUuZWxtLCBhcGkubmV4dFNpYmxpbmcoZWxtKSk7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMocGFyZW50LCBbb2xkVm5vZGVdLCAwLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gaW5zZXJ0ZWRWbm9kZVF1ZXVlLmxlbmd0aDsgaSA8IGlMZW47ICsraSkge1xyXG4gICAgICAgICAgICBpbnNlcnRlZFZub2RlUXVldWVbaV0uZGF0YS5ob29rLmluc2VydChpbnNlcnRlZFZub2RlUXVldWVbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnBvc3QubGVuZ3RoOyBpIDwgaUxlbjsgKytpKVxyXG4gICAgICAgICAgICBjYnMucG9zdFtpXSgpO1xyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH07XHJcbn1cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gaXMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgYXJyYXkgPSBBcnJheS5pc0FycmF5O1xyXG5mdW5jdGlvbiBwcmltaXRpdmUocykge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBzID09PSBcIm51bWJlclwiO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodGFnTmFtZSkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZVVSSSwgcXVhbGlmaWVkTmFtZSkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2VVUkksIHF1YWxpZmllZE5hbWUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVRleHROb2RlKHRleHQpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDb21tZW50KHRleHQpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVDb21tZW50KHRleHQpO1xyXG59XHJcbmZ1bmN0aW9uIGluc2VydEJlZm9yZShwYXJlbnROb2RlLCBuZXdOb2RlLCByZWZlcmVuY2VOb2RlKSB7XHJcbiAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXdOb2RlLCByZWZlcmVuY2VOb2RlKTtcclxufVxyXG5mdW5jdGlvbiByZW1vdmVDaGlsZChub2RlLCBjaGlsZCkge1xyXG4gICAgbm9kZS5yZW1vdmVDaGlsZChjaGlsZCk7XHJcbn1cclxuZnVuY3Rpb24gYXBwZW5kQ2hpbGQobm9kZSwgY2hpbGQpIHtcclxuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG59XHJcbmZ1bmN0aW9uIHBhcmVudE5vZGUobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZTtcclxufVxyXG5mdW5jdGlvbiBuZXh0U2libGluZyhub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcclxufVxyXG5mdW5jdGlvbiB0YWdOYW1lKGVsbSkge1xyXG4gICAgcmV0dXJuIGVsbS50YWdOYW1lO1xyXG59XHJcbmZ1bmN0aW9uIHNldFRleHRDb250ZW50KG5vZGUsIHRleHQpIHtcclxuICAgIG5vZGUudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG59XHJcbmNvbnN0IGh0bWxEb21BcGkgPSB7XHJcbiAgICBjcmVhdGVFbGVtZW50LFxyXG4gICAgY3JlYXRlRWxlbWVudE5TLFxyXG4gICAgY3JlYXRlVGV4dE5vZGUsXHJcbiAgICBjcmVhdGVDb21tZW50LFxyXG4gICAgaW5zZXJ0QmVmb3JlLFxyXG4gICAgcmVtb3ZlQ2hpbGQsXHJcbiAgICBhcHBlbmRDaGlsZCxcclxuICAgIHBhcmVudE5vZGUsXHJcbiAgICBuZXh0U2libGluZyxcclxuICAgIHRhZ05hbWUsXHJcbiAgICBzZXRUZXh0Q29udGVudFxyXG59O1xyXG5mdW5jdGlvbiBhZGROUyhkYXRhLCBjaGlsZHJlbiwgc2VsKSB7XHJcbiAgICBpZiAoc2VsID09PSBcImR1bW15XCIpIHtcclxuICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0byBhZGQgdGhlIG5hbWVzcGFjZSBvbiBkdW1teSBlbGVtZW50cywgdGhleSBjb21lIGZyb20gYVxyXG4gICAgICAgIC8vIHN1YmNvbXBvbmVudCwgd2hpY2ggd2lsbCBoYW5kbGUgdGhlIG5hbWVzcGFjZSBpdHNlbGZcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkYXRhLm5zID0gXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiO1xyXG4gICAgaWYgKHNlbCAhPT0gXCJmb3JlaWduT2JqZWN0XCIgJiYgY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpTGVuID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaUxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgIGxldCBjaGlsZERhdGEgPSBjaGlsZC5kYXRhO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGREYXRhICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGFkZE5TKGNoaWxkRGF0YSwgY2hpbGQuY2hpbGRyZW4sIGNoaWxkLnNlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaChzZWwsIGIsIGMpIHtcclxuICAgIHZhciBkYXRhID0ge30sIGNoaWxkcmVuLCB0ZXh0LCBpLCBpTGVuO1xyXG4gICAgaWYgKGMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGRhdGEgPSBiO1xyXG4gICAgICAgIGlmIChhcnJheShjKSkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByaW1pdGl2ZShjKSkge1xyXG4gICAgICAgICAgICB0ZXh0ID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyAmJiBjLnNlbCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IFtjXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChiICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAoYXJyYXkoYikpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcmltaXRpdmUoYikpIHtcclxuICAgICAgICAgICAgdGV4dCA9IGI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGIgJiYgYi5zZWwpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBbYl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRhID0gYjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpTGVuOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKHByaW1pdGl2ZShjaGlsZHJlbltpXSkpXHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbltpXSA9IHZub2RlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNoaWxkcmVuW2ldLCB1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2bm9kZShzZWwsIGRhdGEsIGNoaWxkcmVuLCB0ZXh0LCB1bmRlZmluZWQpO1xyXG59XG5cbmNvbnN0IHBhdGNoID0gaW5pdChbZXZlbnRMaXN0ZW5lcnNNb2R1bGUsIGF0dHJzTW9kdWxlLCBwcm9wc01vZHVsZSwgY2xhc3NNb2R1bGVdKTtcblxuLyoqXHJcbiAqIE93bCBRV2ViIEV4cHJlc3Npb24gUGFyc2VyXHJcbiAqXHJcbiAqIE93bCBuZWVkcyBpbiB2YXJpb3VzIGNvbnRleHRzIHRvIGJlIGFibGUgdG8gdW5kZXJzdGFuZCB0aGUgc3RydWN0dXJlIG9mIGFcclxuICogc3RyaW5nIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgZXhwcmVzc2lvbi4gIFRoZSB1c3VhbCBnb2FsIGlzIHRvIGJlIGFibGVcclxuICogdG8gcmV3cml0ZSBzb21lIHZhcmlhYmxlcy4gIEZvciBleGFtcGxlLCBpZiBhIHRlbXBsYXRlIGhhc1xyXG4gKlxyXG4gKiAgYGBgeG1sXHJcbiAqICA8dCB0LWlmPVwiY29tcHV0ZVNvbWV0aGluZyh7dmFsOiBzdGF0ZS52YWx9KVwiPi4uLjwvdD5cclxuICogYGBgXHJcbiAqXHJcbiAqIHRoaXMgbmVlZHMgdG8gYmUgdHJhbnNsYXRlZCBpbiBzb21ldGhpbmcgbGlrZSB0aGlzOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiAgIGlmIChjb250ZXh0W1wiY29tcHV0ZVNvbWV0aGluZ1wiXSh7dmFsOiBjb250ZXh0W1wic3RhdGVcIl0udmFsfSkpIHsgLi4uIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBjb250YWlucyB0aGUgaW1wbGVtZW50YXRpb24gb2YgYW4gZXh0cmVtZWx5IG5haXZlIHRva2VuaXplci9wYXJzZXJcclxuICogYW5kIGV2YWx1YXRvciBmb3IgamF2YXNjcmlwdCBleHByZXNzaW9ucy4gIFRoZSBzdXBwb3J0ZWQgZ3JhbW1hciBpcyBiYXNpY2FsbHlcclxuICogb25seSBleHByZXNzaXZlIGVub3VnaCB0byB1bmRlcnN0YW5kIHRoZSBzaGFwZSBvZiBvYmplY3RzLCBvZiBhcnJheXMsIGFuZFxyXG4gKiB2YXJpb3VzIG9wZXJhdG9ycy5cclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIE1pc2MgdHlwZXMsIGNvbnN0YW50cyBhbmQgaGVscGVyc1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBSRVNFUlZFRF9XT1JEUyA9IFwidHJ1ZSxmYWxzZSxOYU4sbnVsbCx1bmRlZmluZWQsZGVidWdnZXIsY29uc29sZSx3aW5kb3csaW4saW5zdGFuY2VvZixuZXcsZnVuY3Rpb24scmV0dXJuLHRoaXMsZXZhbCx2b2lkLE1hdGgsUmVnRXhwLEFycmF5LE9iamVjdCxEYXRlXCIuc3BsaXQoXCIsXCIpO1xyXG5jb25zdCBXT1JEX1JFUExBQ0VNRU5UID0ge1xyXG4gICAgYW5kOiBcIiYmXCIsXHJcbiAgICBvcjogXCJ8fFwiLFxyXG4gICAgZ3Q6IFwiPlwiLFxyXG4gICAgZ3RlOiBcIj49XCIsXHJcbiAgICBsdDogXCI8XCIsXHJcbiAgICBsdGU6IFwiPD1cIlxyXG59O1xyXG5jb25zdCBTVEFUSUNfVE9LRU5fTUFQID0ge1xyXG4gICAgXCJ7XCI6IFwiTEVGVF9CUkFDRVwiLFxyXG4gICAgXCJ9XCI6IFwiUklHSFRfQlJBQ0VcIixcclxuICAgIFwiW1wiOiBcIkxFRlRfQlJBQ0tFVFwiLFxyXG4gICAgXCJdXCI6IFwiUklHSFRfQlJBQ0tFVFwiLFxyXG4gICAgXCI6XCI6IFwiQ09MT05cIixcclxuICAgIFwiLFwiOiBcIkNPTU1BXCIsXHJcbiAgICBcIihcIjogXCJMRUZUX1BBUkVOXCIsXHJcbiAgICBcIilcIjogXCJSSUdIVF9QQVJFTlwiXHJcbn07XHJcbi8vIG5vdGUgdGhhdCB0aGUgc3BhY2UgYWZ0ZXIgdHlwZW9mIGlzIHJlbGV2YW50LiBJdCBtYWtlcyBzdXJlIHRoYXQgdGhlIGZvcm1hdHRlZFxyXG4vLyBleHByZXNzaW9uIGhhcyBhIHNwYWNlIGFmdGVyIHR5cGVvZlxyXG5jb25zdCBPUEVSQVRPUlMgPSBcIi4uLiwuLD09PSw9PSwrLCE9PSwhPSwhLHx8LCYmLD49LD4sPD0sPCw/LC0sKiwvLCUsdHlwZW9mICw9Piw9LDssaW4gXCIuc3BsaXQoXCIsXCIpO1xyXG5sZXQgdG9rZW5pemVTdHJpbmcgPSBmdW5jdGlvbiAoZXhwcikge1xyXG4gICAgbGV0IHMgPSBleHByWzBdO1xyXG4gICAgbGV0IHN0YXJ0ID0gcztcclxuICAgIGlmIChzICE9PSBcIidcIiAmJiBzICE9PSAnXCInKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgbGV0IGkgPSAxO1xyXG4gICAgbGV0IGN1cjtcclxuICAgIHdoaWxlIChleHByW2ldICYmIGV4cHJbaV0gIT09IHN0YXJ0KSB7XHJcbiAgICAgICAgY3VyID0gZXhwcltpXTtcclxuICAgICAgICBzICs9IGN1cjtcclxuICAgICAgICBpZiAoY3VyID09PSBcIlxcXFxcIikge1xyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIGN1ciA9IGV4cHJbaV07XHJcbiAgICAgICAgICAgIGlmICghY3VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGV4cHJlc3Npb25cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcyArPSBjdXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGkrKztcclxuICAgIH1cclxuICAgIGlmIChleHByW2ldICE9PSBzdGFydCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZXhwcmVzc2lvblwiKTtcclxuICAgIH1cclxuICAgIHMgKz0gc3RhcnQ7XHJcbiAgICByZXR1cm4geyB0eXBlOiBcIlZBTFVFXCIsIHZhbHVlOiBzIH07XHJcbn07XHJcbmxldCB0b2tlbml6ZU51bWJlciA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBsZXQgcyA9IGV4cHJbMF07XHJcbiAgICBpZiAocyAmJiBzLm1hdGNoKC9bMC05XS8pKSB7XHJcbiAgICAgICAgbGV0IGkgPSAxO1xyXG4gICAgICAgIHdoaWxlIChleHByW2ldICYmIGV4cHJbaV0ubWF0Y2goL1swLTldfFxcLi8pKSB7XHJcbiAgICAgICAgICAgIHMgKz0gZXhwcltpXTtcclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyB0eXBlOiBcIlZBTFVFXCIsIHZhbHVlOiBzIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbmxldCB0b2tlbml6ZVN5bWJvbCA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBsZXQgcyA9IGV4cHJbMF07XHJcbiAgICBpZiAocyAmJiBzLm1hdGNoKC9bYS16QS1aX1xcJF0vKSkge1xyXG4gICAgICAgIGxldCBpID0gMTtcclxuICAgICAgICB3aGlsZSAoZXhwcltpXSAmJiBleHByW2ldLm1hdGNoKC9cXHcvKSkge1xyXG4gICAgICAgICAgICBzICs9IGV4cHJbaV07XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHMgaW4gV09SRF9SRVBMQUNFTUVOVCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiBcIk9QRVJBVE9SXCIsIHZhbHVlOiBXT1JEX1JFUExBQ0VNRU5UW3NdLCBzaXplOiBzLmxlbmd0aCB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyB0eXBlOiBcIlNZTUJPTFwiLCB2YWx1ZTogcyB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCB0b2tlbml6ZVN0YXRpYyA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBjb25zdCBjaGFyID0gZXhwclswXTtcclxuICAgIGlmIChjaGFyICYmIGNoYXIgaW4gU1RBVElDX1RPS0VOX01BUCkge1xyXG4gICAgICAgIHJldHVybiB7IHR5cGU6IFNUQVRJQ19UT0tFTl9NQVBbY2hhcl0sIHZhbHVlOiBjaGFyIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbmNvbnN0IHRva2VuaXplT3BlcmF0b3IgPSBmdW5jdGlvbiAoZXhwcikge1xyXG4gICAgZm9yIChsZXQgb3Agb2YgT1BFUkFUT1JTKSB7XHJcbiAgICAgICAgaWYgKGV4cHIuc3RhcnRzV2l0aChvcCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogXCJPUEVSQVRPUlwiLCB2YWx1ZTogb3AgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbmNvbnN0IFRPS0VOSVpFUlMgPSBbXHJcbiAgICB0b2tlbml6ZVN0cmluZyxcclxuICAgIHRva2VuaXplTnVtYmVyLFxyXG4gICAgdG9rZW5pemVPcGVyYXRvcixcclxuICAgIHRva2VuaXplU3ltYm9sLFxyXG4gICAgdG9rZW5pemVTdGF0aWNcclxuXTtcclxuLyoqXHJcbiAqIENvbnZlcnQgYSBqYXZhc2NyaXB0IGV4cHJlc3Npb24gKGFzIGEgc3RyaW5nKSBpbnRvIGEgbGlzdCBvZiB0b2tlbnMuIEZvclxyXG4gKiBleGFtcGxlOiBgdG9rZW5pemUoXCIxICsgYlwiKWAgd2lsbCByZXR1cm46XHJcbiAqIGBgYGpzXHJcbiAqICBbXHJcbiAqICAge3R5cGU6IFwiVkFMVUVcIiwgdmFsdWU6IFwiMVwifSxcclxuICogICB7dHlwZTogXCJPUEVSQVRPUlwiLCB2YWx1ZTogXCIrXCJ9LFxyXG4gKiAgIHt0eXBlOiBcIlNZTUJPTFwiLCB2YWx1ZTogXCJiXCJ9XHJcbiAqIF1cclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiB0b2tlbml6ZShleHByKSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGxldCB0b2tlbiA9IHRydWU7XHJcbiAgICB3aGlsZSAodG9rZW4pIHtcclxuICAgICAgICBleHByID0gZXhwci50cmltKCk7XHJcbiAgICAgICAgaWYgKGV4cHIpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgdG9rZW5pemVyIG9mIFRPS0VOSVpFUlMpIHtcclxuICAgICAgICAgICAgICAgIHRva2VuID0gdG9rZW5pemVyKGV4cHIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHIgPSBleHByLnNsaWNlKHRva2VuLnNpemUgfHwgdG9rZW4udmFsdWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdG9rZW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZXhwci5sZW5ndGgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRva2VuaXplciBlcnJvcjogY291bGQgbm90IHRva2VuaXplIFwiJHtleHByfVwiYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEV4cHJlc3Npb24gXCJldmFsdWF0b3JcIlxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vKipcclxuICogVGhpcyBpcyB0aGUgbWFpbiBmdW5jdGlvbiBleHBvcnRlZCBieSB0aGlzIGZpbGUuIFRoaXMgaXMgdGhlIGNvZGUgdGhhdCB3aWxsXHJcbiAqIHByb2Nlc3MgYW4gZXhwcmVzc2lvbiAoZ2l2ZW4gYXMgYSBzdHJpbmcpIGFuZCByZXR1cm5zIGFub3RoZXIgZXhwcmVzc2lvbiB3aXRoXHJcbiAqIHByb3BlciBsb29rdXBzIGluIHRoZSBjb250ZXh0LlxyXG4gKlxyXG4gKiBVc3VhbGx5LCB0aGlzIGtpbmQgb2YgY29kZSB3b3VsZCBiZSB2ZXJ5IHNpbXBsZSB0byBkbyBpZiB3ZSBoYWQgYW4gQVNUIChzbyxcclxuICogaWYgd2UgaGFkIGEgamF2YXNjcmlwdCBwYXJzZXIpLCBzaW5jZSB0aGVuLCB3ZSB3b3VsZCBvbmx5IG5lZWQgdG8gZmluZCB0aGVcclxuICogdmFyaWFibGVzIGFuZCByZXBsYWNlIHRoZW0uICBIb3dldmVyLCBhIHBhcnNlciBpcyBtb3JlIGNvbXBsaWNhdGVkLCBhbmQgdGhlcmVcclxuICogYXJlIG5vIHN0YW5kYXJkIGJ1aWx0aW4gcGFyc2VyIEFQSS5cclxuICpcclxuICogU2luY2UgdGhpcyBtZXRob2QgaXMgYXBwbGllZCB0byBzaW1wbGUgamF2YXNyaXB0IGV4cHJlc3Npb25zLCBhbmQgdGhlIHdvcmsgdG9cclxuICogYmUgZG9uZSBpcyBhY3R1YWxseSBxdWl0ZSBzaW1wbGUsIHdlIGFjdHVhbGx5IGNhbiBnZXQgYXdheSB3aXRoIG5vdCB1c2luZyBhXHJcbiAqIHBhcnNlciwgd2hpY2ggaGVscHMgd2l0aCB0aGUgY29kZSBzaXplLlxyXG4gKlxyXG4gKiBIZXJlIGlzIHRoZSBoZXVyaXN0aWMgdXNlZCBieSB0aGlzIG1ldGhvZCB0byBkZXRlcm1pbmUgaWYgYSB0b2tlbiBpcyBhXHJcbiAqIHZhcmlhYmxlOlxyXG4gKiAtIGJ5IGRlZmF1bHQsIGFsbCBzeW1ib2xzIGFyZSBjb25zaWRlcmVkIGEgdmFyaWFibGVcclxuICogLSB1bmxlc3MgdGhlIHByZXZpb3VzIHRva2VuIGlzIGEgZG90IChpbiB0aGF0IGNhc2UsIHRoaXMgaXMgYSBwcm9wZXJ0eTogYGEuYmApXHJcbiAqIC0gb3IgaWYgdGhlIHByZXZpb3VzIHRva2VuIGlzIGEgbGVmdCBicmFjZSBvciBhIGNvbW1hLCBhbmQgdGhlIG5leHQgdG9rZW4gaXNcclxuICogICBhIGNvbG9uIChpbiB0aGF0IGNhc2UsIHRoaXMgaXMgYW4gb2JqZWN0IGtleTogYHthOiBifWApXHJcbiAqXHJcbiAqIFNvbWUgc3BlY2lmaWMgY29kZSBpcyBhbHNvIHJlcXVpcmVkIHRvIHN1cHBvcnQgYXJyb3cgZnVuY3Rpb25zLiBJZiB3ZSBkZXRlY3RcclxuICogdGhlIGFycm93IG9wZXJhdG9yLCB0aGVuIHdlIGFkZCB0aGUgY3VycmVudCAob3Igc29tZSBwcmV2aW91cyB0b2tlbnMpIHRva2VuIHRvXHJcbiAqIHRoZSBsaXN0IG9mIHZhcmlhYmxlcyBzbyBpdCBkb2VzIG5vdCBnZXQgcmVwbGFjZWQgYnkgYSBsb29rdXAgaW4gdGhlIGNvbnRleHRcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGVFeHByVG9BcnJheShleHByLCBzY29wZSkge1xyXG4gICAgc2NvcGUgPSBPYmplY3QuY3JlYXRlKHNjb3BlKTtcclxuICAgIGNvbnN0IHRva2VucyA9IHRva2VuaXplKGV4cHIpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgdG9rZW4gPSB0b2tlbnNbaV07XHJcbiAgICAgICAgbGV0IHByZXZUb2tlbiA9IHRva2Vuc1tpIC0gMV07XHJcbiAgICAgICAgbGV0IG5leHRUb2tlbiA9IHRva2Vuc1tpICsgMV07XHJcbiAgICAgICAgbGV0IGlzVmFyID0gdG9rZW4udHlwZSA9PT0gXCJTWU1CT0xcIiAmJiAhUkVTRVJWRURfV09SRFMuaW5jbHVkZXModG9rZW4udmFsdWUpO1xyXG4gICAgICAgIGlmICh0b2tlbi50eXBlID09PSBcIlNZTUJPTFwiICYmICFSRVNFUlZFRF9XT1JEUy5pbmNsdWRlcyh0b2tlbi52YWx1ZSkpIHtcclxuICAgICAgICAgICAgaWYgKHByZXZUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHByZXZUb2tlbi50eXBlID09PSBcIk9QRVJBVE9SXCIgJiYgcHJldlRva2VuLnZhbHVlID09PSBcIi5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwcmV2VG9rZW4udHlwZSA9PT0gXCJMRUZUX0JSQUNFXCIgfHwgcHJldlRva2VuLnR5cGUgPT09IFwiQ09NTUFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VG9rZW4gJiYgbmV4dFRva2VuLnR5cGUgPT09IFwiQ09MT05cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZhciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmV4dFRva2VuICYmIG5leHRUb2tlbi50eXBlID09PSBcIk9QRVJBVE9SXCIgJiYgbmV4dFRva2VuLnZhbHVlID09PSBcIj0+XCIpIHtcclxuICAgICAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09IFwiUklHSFRfUEFSRU5cIikge1xyXG4gICAgICAgICAgICAgICAgbGV0IGogPSBpIC0gMTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChqID4gMCAmJiB0b2tlbnNbal0udHlwZSAhPT0gXCJMRUZUX1BBUkVOXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5zW2pdLnR5cGUgPT09IFwiU1lNQk9MXCIgJiYgdG9rZW5zW2pdLm9yaWdpbmFsVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zW2pdLnZhbHVlID0gdG9rZW5zW2pdLm9yaWdpbmFsVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlW3Rva2Vuc1tqXS52YWx1ZV0gPSB7IGlkOiB0b2tlbnNbal0udmFsdWUsIGV4cHI6IHRva2Vuc1tqXS52YWx1ZSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBqLS07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZVt0b2tlbi52YWx1ZV0gPSB7IGlkOiB0b2tlbi52YWx1ZSwgZXhwcjogdG9rZW4udmFsdWUgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNWYXIpIHtcclxuICAgICAgICAgICAgdG9rZW4udmFyTmFtZSA9IHRva2VuLnZhbHVlO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgaW4gc2NvcGUgJiYgXCJpZFwiIGluIHNjb3BlW3Rva2VuLnZhbHVlXSkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW4udmFsdWUgPSBzY29wZVt0b2tlbi52YWx1ZV0uZXhwcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRva2VuLm9yaWdpbmFsVmFsdWUgPSB0b2tlbi52YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRva2VuLnZhbHVlID0gYHNjb3BlWycke3Rva2VuLnZhbHVlfSddYDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0b2tlbnM7XHJcbn1cclxuZnVuY3Rpb24gY29tcGlsZUV4cHIoZXhwciwgc2NvcGUpIHtcclxuICAgIHJldHVybiBjb21waWxlRXhwclRvQXJyYXkoZXhwciwgc2NvcGUpXHJcbiAgICAgICAgLm1hcCh0ID0+IHQudmFsdWUpXHJcbiAgICAgICAgLmpvaW4oXCJcIik7XHJcbn1cblxuY29uc3QgSU5URVJQX1JFR0VYUCA9IC9cXHtcXHsuKj9cXH1cXH0vZztcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQ29tcGlsYXRpb24gQ29udGV4dFxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jbGFzcyBDb21waWxhdGlvbkNvbnRleHQge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMuY29kZSA9IFtdO1xyXG4gICAgICAgIHRoaXMudmFyaWFibGVzID0ge307XHJcbiAgICAgICAgdGhpcy5lc2NhcGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucGFyZW50Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRUZXh0Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yb290Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pbmRlbnRMZXZlbCA9IDA7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVQYXJlbnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNob3VsZERlZmluZVNjb3BlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5wcm90ZWN0ZWRTY29wZU51bWJlciA9IDA7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVRV2ViID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVVdGlscyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkRGVmaW5lUmVmcyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmxvb3BOdW1iZXIgPSAwO1xyXG4gICAgICAgIHRoaXMuaW5QcmVUYWcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsbG93TXVsdGlwbGVSb290cyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzUGFyZW50V2lkZ2V0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNLZXkwID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5rZXlTdGFjayA9IFtdO1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVOYW1lID0gbmFtZSB8fCBcIm5vbmFtZVwiO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShcImxldCBoID0gdGhpcy5oO1wiKTtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlSUQoKSB7XHJcbiAgICAgICAgcmV0dXJuIENvbXBpbGF0aW9uQ29udGV4dC5uZXh0SUQrKztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgZ2VuZXJhdGVzIGEgXCJ0ZW1wbGF0ZSBrZXlcIiwgd2hpY2ggaXMgYmFzaWNhbGx5IGEgdW5pcXVlIGtleVxyXG4gICAgICogd2hpY2ggZGVwZW5kcyBvbiB0aGUgY3VycmVudGx5IHNldCBrZXlzLCBhbmQgb24gdGhlIGl0ZXJhdGlvbiBudW1iZXJzIChpZlxyXG4gICAgICogd2UgYXJlIGluIGEgbG9vcCkuXHJcbiAgICAgKlxyXG4gICAgICogU3VjaCBhIGtleSBpcyBuZWNlc3Nhcnkgd2hlbiB3ZSBuZWVkIHRvIGFzc29jaWF0ZSBhbiBpZCB0byBzb21lIGVsZW1lbnRcclxuICAgICAqIGdlbmVyYXRlZCBieSBhIHRlbXBsYXRlIChmb3IgZXhhbXBsZSwgYSBjb21wb25lbnQpXHJcbiAgICAgKi9cclxuICAgIGdlbmVyYXRlVGVtcGxhdGVLZXkocHJlZml4ID0gXCJcIikge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgaWYgKHRoaXMubG9vcE51bWJlciA9PT0gMCAmJiAhdGhpcy5oYXNLZXkwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgJyR7cHJlZml4fV9fJHtpZH1fXydgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQga2V5ID0gYFxcYCR7cHJlZml4fV9fJHtpZH1fX2A7XHJcbiAgICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5oYXNLZXkwID8gMCA6IDE7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgdGhpcy5sb29wTnVtYmVyICsgMTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGtleSArPSBgXFwke2tleSR7aX19X19gO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZExpbmUoYGxldCBrJHtpZH0gPSAke2tleX1cXGA7YCk7XHJcbiAgICAgICAgcmV0dXJuIGBrJHtpZH1gO1xyXG4gICAgfVxyXG4gICAgZ2VuZXJhdGVDb2RlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvZGUudW5zaGlmdChcIiAgICBsZXQgcmVzdWx0O1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRGVmaW5lU2NvcGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHNjb3BlID0gT2JqZWN0LmNyZWF0ZShjb250ZXh0KTtcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVJlZnMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgY29udGV4dC5fX293bF9fLnJlZnMgPSBjb250ZXh0Ll9fb3dsX18ucmVmcyB8fCB7fTtcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVBhcmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNQYXJlbnRXaWRnZXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29kZS51bnNoaWZ0KFwiICAgIGxldCBwYXJlbnQgPSBleHRyYS5wYXJlbnQ7XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHBhcmVudCA9IGNvbnRleHQ7XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVFXZWIpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IFFXZWIgPSB0aGlzLmNvbnN0cnVjdG9yO1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRGVmaW5lVXRpbHMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHV0aWxzID0gdGhpcy5jb25zdHJ1Y3Rvci51dGlscztcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvZGU7XHJcbiAgICB9XHJcbiAgICB3aXRoUGFyZW50KG5vZGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWxsb3dNdWx0aXBsZVJvb3RzICYmXHJcbiAgICAgICAgICAgIHRoaXMgPT09IHRoaXMucm9vdENvbnRleHQgJiZcclxuICAgICAgICAgICAgKHRoaXMucGFyZW50Tm9kZSB8fCB0aGlzLnBhcmVudFRleHROb2RlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBIHRlbXBsYXRlIHNob3VsZCBub3QgaGF2ZSBtb3JlIHRoYW4gb25lIHJvb3Qgbm9kZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnJvb3RDb250ZXh0LnJvb3ROb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9vdENvbnRleHQucm9vdE5vZGUgPSBub2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMucGFyZW50Tm9kZSAmJiB0aGlzLnJvb3RDb250ZXh0LnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZExpbmUoYHJlc3VsdCA9IHZuJHtub2RlfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3ViQ29udGV4dChcInBhcmVudE5vZGVcIiwgbm9kZSk7XHJcbiAgICB9XHJcbiAgICBzdWJDb250ZXh0KGtleSwgdmFsdWUpIHtcclxuICAgICAgICBjb25zdCBuZXdDb250ZXh0ID0gT2JqZWN0LmNyZWF0ZSh0aGlzKTtcclxuICAgICAgICBuZXdDb250ZXh0W2tleV0gPSB2YWx1ZTtcclxuICAgICAgICByZXR1cm4gbmV3Q29udGV4dDtcclxuICAgIH1cclxuICAgIGluZGVudCgpIHtcclxuICAgICAgICB0aGlzLnJvb3RDb250ZXh0LmluZGVudExldmVsKys7XHJcbiAgICB9XHJcbiAgICBkZWRlbnQoKSB7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5pbmRlbnRMZXZlbC0tO1xyXG4gICAgfVxyXG4gICAgYWRkTGluZShsaW5lKSB7XHJcbiAgICAgICAgY29uc3QgcHJlZml4ID0gbmV3IEFycmF5KHRoaXMuaW5kZW50TGV2ZWwgKyAyKS5qb2luKFwiICAgIFwiKTtcclxuICAgICAgICB0aGlzLmNvZGUucHVzaChwcmVmaXggKyBsaW5lKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb2RlLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcbiAgICBhZGRJZihjb25kaXRpb24pIHtcclxuICAgICAgICB0aGlzLmFkZExpbmUoYGlmICgke2NvbmRpdGlvbn0pIHtgKTtcclxuICAgICAgICB0aGlzLmluZGVudCgpO1xyXG4gICAgfVxyXG4gICAgYWRkRWxzZSgpIHtcclxuICAgICAgICB0aGlzLmRlZGVudCgpO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShcIn0gZWxzZSB7XCIpO1xyXG4gICAgICAgIHRoaXMuaW5kZW50KCk7XHJcbiAgICB9XHJcbiAgICBjbG9zZUlmKCkge1xyXG4gICAgICAgIHRoaXMuZGVkZW50KCk7XHJcbiAgICAgICAgdGhpcy5hZGRMaW5lKFwifVwiKTtcclxuICAgIH1cclxuICAgIGdldFZhbHVlKHZhbCkge1xyXG4gICAgICAgIHJldHVybiB2YWwgaW4gdGhpcy52YXJpYWJsZXMgPyB0aGlzLmdldFZhbHVlKHRoaXMudmFyaWFibGVzW3ZhbF0pIDogdmFsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcmVwYXJlIGFuIGV4cHJlc3Npb24gZm9yIGJlaW5nIGNvbnN1bWVkIGF0IHJlbmRlciB0aW1lLiAgSXRzIG1haW4gam9iXHJcbiAgICAgKiBpcyB0b1xyXG4gICAgICogLSByZXBsYWNlIHVua25vd24gdmFyaWFibGVzIGJ5IGEgbG9va3VwIGluIHRoZSBjb250ZXh0XHJcbiAgICAgKiAtIHJlcGxhY2UgYWxyZWFkeSBkZWZpbmVkIHZhcmlhYmxlcyBieSB0aGVpciBpbnRlcm5hbCBuYW1lXHJcbiAgICAgKi9cclxuICAgIGZvcm1hdEV4cHJlc3Npb24oZXhwcikge1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lU2NvcGUgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiBjb21waWxlRXhwcihleHByLCB0aGlzLnZhcmlhYmxlcyk7XHJcbiAgICB9XHJcbiAgICBjYXB0dXJlRXhwcmVzc2lvbihleHByKSB7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgYXJnSWQgPSB0aGlzLmdlbmVyYXRlSUQoKTtcclxuICAgICAgICBjb25zdCB0b2tlbnMgPSBjb21waWxlRXhwclRvQXJyYXkoZXhwciwgdGhpcy52YXJpYWJsZXMpO1xyXG4gICAgICAgIGNvbnN0IGRvbmUgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIHRva2Vuc1xyXG4gICAgICAgICAgICAubWFwKHRvayA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0b2sudmFyTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkb25lLmhhcyh0b2sudmFyTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb25lLmFkZCh0b2sudmFyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRMaW5lKGBjb25zdCAke3Rvay52YXJOYW1lfV8ke2FyZ0lkfSA9ICR7dG9rLnZhbHVlfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRvay52YWx1ZSA9IGAke3Rvay52YXJOYW1lfV8ke2FyZ0lkfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRvay52YWx1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbihcIlwiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybSBzdHJpbmcgaW50ZXJwb2xhdGlvbiBvbiB0aGUgZ2l2ZW4gc3RyaW5nLiBOb3RlIHRoYXQgaWYgdGhlIHdob2xlXHJcbiAgICAgKiBzdHJpbmcgaXMgYW4gZXhwcmVzc2lvbiwgaXQgc2ltcGx5IHJldHVybnMgaXQgKGZvcm1hdHRlZCBhbmQgZW5jbG9zZWQgaW5cclxuICAgICAqIHBhcmVudGhlc2VzKS5cclxuICAgICAqIEZvciBpbnN0YW5jZTpcclxuICAgICAqICAgJ0hlbGxvIHt7eH19IScgLT4gYEhlbGxvICR7eH1gXHJcbiAgICAgKiAgICd7e3ggPyAnYSc6ICdiJ319JyAtPiAoeCA/ICdhJyA6ICdiJylcclxuICAgICAqL1xyXG4gICAgaW50ZXJwb2xhdGUocykge1xyXG4gICAgICAgIGxldCBtYXRjaGVzID0gcy5tYXRjaChJTlRFUlBfUkVHRVhQKTtcclxuICAgICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzBdLmxlbmd0aCA9PT0gcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGAoJHt0aGlzLmZvcm1hdEV4cHJlc3Npb24ocy5zbGljZSgyLCAtMikpfSlgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgciA9IHMucmVwbGFjZSgvXFx7XFx7Lio/XFx9XFx9L2csIHMgPT4gXCIke1wiICsgdGhpcy5mb3JtYXRFeHByZXNzaW9uKHMuc2xpY2UoMiwgLTIpKSArIFwifVwiKTtcclxuICAgICAgICByZXR1cm4gXCJgXCIgKyByICsgXCJgXCI7XHJcbiAgICB9XHJcbiAgICBzdGFydFByb3RlY3RTY29wZShjb2RlQmxvY2spIHtcclxuICAgICAgICBjb25zdCBwcm90ZWN0SUQgPSB0aGlzLmdlbmVyYXRlSUQoKTtcclxuICAgICAgICB0aGlzLnJvb3RDb250ZXh0LnByb3RlY3RlZFNjb3BlTnVtYmVyKys7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3Qgc2NvcGVFeHByID0gYE9iamVjdC5jcmVhdGUoc2NvcGUpO2A7XHJcbiAgICAgICAgdGhpcy5hZGRMaW5lKGBsZXQgX29yaWdTY29wZSR7cHJvdGVjdElEfSA9IHNjb3BlO2ApO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShgc2NvcGUgPSAke3Njb3BlRXhwcn1gKTtcclxuICAgICAgICBpZiAoIWNvZGVCbG9jaykge1xyXG4gICAgICAgICAgICB0aGlzLmFkZExpbmUoYHNjb3BlLl9fYWNjZXNzX21vZGVfXyA9ICdybyc7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcm90ZWN0SUQ7XHJcbiAgICB9XHJcbiAgICBzdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCkge1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQucHJvdGVjdGVkU2NvcGVOdW1iZXItLTtcclxuICAgICAgICB0aGlzLmFkZExpbmUoYHNjb3BlID0gX29yaWdTY29wZSR7cHJvdGVjdElEfTtgKTtcclxuICAgIH1cclxufVxyXG5Db21waWxhdGlvbkNvbnRleHQubmV4dElEID0gMTtcblxuY29uc3QgYnJvd3NlciA9IHtcclxuICAgIHNldFRpbWVvdXQ6IHdpbmRvdy5zZXRUaW1lb3V0LmJpbmQod2luZG93KSxcclxuICAgIGNsZWFyVGltZW91dDogd2luZG93LmNsZWFyVGltZW91dC5iaW5kKHdpbmRvdyksXHJcbiAgICBzZXRJbnRlcnZhbDogd2luZG93LnNldEludGVydmFsLmJpbmQod2luZG93KSxcclxuICAgIGNsZWFySW50ZXJ2YWw6IHdpbmRvdy5jbGVhckludGVydmFsLmJpbmQod2luZG93KSxcclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZTogd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZS5iaW5kKHdpbmRvdyksXHJcbiAgICByYW5kb206IE1hdGgucmFuZG9tLFxyXG4gICAgRGF0ZTogd2luZG93LkRhdGUsXHJcbiAgICBmZXRjaDogKHdpbmRvdy5mZXRjaCB8fCAoKCkgPT4geyB9KSkuYmluZCh3aW5kb3cpLFxyXG4gICAgbG9jYWxTdG9yYWdlOiB3aW5kb3cubG9jYWxTdG9yYWdlXHJcbn07XG5cbi8qKlxyXG4gKiBPd2wgVXRpbHNcclxuICpcclxuICogV2UgaGF2ZSBoZXJlIGEgc21hbGwgY29sbGVjdGlvbiBvZiB1dGlsaXR5IGZ1bmN0aW9uczpcclxuICpcclxuICogLSB3aGVuUmVhZHlcclxuICogLSBsb2FkSlNcclxuICogLSBsb2FkRmlsZVxyXG4gKiAtIGVzY2FwZVxyXG4gKiAtIGRlYm91bmNlXHJcbiAqL1xyXG5mdW5jdGlvbiB3aGVuUmVhZHkoZm4pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9PSBcImxvYWRpbmdcIikge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCByZXNvbHZlLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkudGhlbihmbiB8fCBmdW5jdGlvbiAoKSB7IH0pO1xyXG59XHJcbmNvbnN0IGxvYWRlZFNjcmlwdHMgPSB7fTtcclxuZnVuY3Rpb24gbG9hZEpTKHVybCkge1xyXG4gICAgaWYgKHVybCBpbiBsb2FkZWRTY3JpcHRzKSB7XHJcbiAgICAgICAgcmV0dXJuIGxvYWRlZFNjcmlwdHNbdXJsXTtcclxuICAgIH1cclxuICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcclxuICAgICAgICBzY3JpcHQudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XHJcbiAgICAgICAgc2NyaXB0LnNyYyA9IHVybDtcclxuICAgICAgICBzY3JpcHQub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBzY3JpcHQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGBFcnJvciBsb2FkaW5nIGZpbGUgJyR7dXJsfSdgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtcclxuICAgICAgICBoZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XHJcbiAgICB9KTtcclxuICAgIGxvYWRlZFNjcmlwdHNbdXJsXSA9IHByb21pc2U7XHJcbiAgICByZXR1cm4gcHJvbWlzZTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBsb2FkRmlsZSh1cmwpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGJyb3dzZXIuZmV0Y2godXJsKTtcclxuICAgIGlmICghcmVzdWx0Lm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXJyb3Igd2hpbGUgZmV0Y2hpbmcgeG1sIHRlbXBsYXRlc1wiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhd2FpdCByZXN1bHQudGV4dCgpO1xyXG59XHJcbmZ1bmN0aW9uIGVzY2FwZShzdHIpIHtcclxuICAgIGlmIChzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBzdHIgPT09IFwibnVtYmVyXCIpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHN0cik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgICBwLnRleHRDb250ZW50ID0gc3RyO1xyXG4gICAgcmV0dXJuIHAuaW5uZXJIVE1MO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XHJcbiAqIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3JcclxuICogTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlXHJcbiAqIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXHJcbiAqXHJcbiAqIEluc3BpcmVkIGJ5IGh0dHBzOi8vZGF2aWR3YWxzaC5uYW1lL2phdmFzY3JpcHQtZGVib3VuY2UtZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xyXG4gICAgbGV0IHRpbWVvdXQ7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgZnVuY3Rpb24gbGF0ZXIoKSB7XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoIWltbWVkaWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xyXG4gICAgICAgIGJyb3dzZXIuY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG4gICAgICAgIHRpbWVvdXQgPSBicm93c2VyLnNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xyXG4gICAgICAgIGlmIChjYWxsTm93KSB7XHJcbiAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBzaGFsbG93RXF1YWwocDEsIHAyKSB7XHJcbiAgICBmb3IgKGxldCBrIGluIHAxKSB7XHJcbiAgICAgICAgaWYgKHAxW2tdICE9PSBwMltrXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cblxudmFyIF91dGlscyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGwsXG4gICAgd2hlblJlYWR5OiB3aGVuUmVhZHksXG4gICAgbG9hZEpTOiBsb2FkSlMsXG4gICAgbG9hZEZpbGU6IGxvYWRGaWxlLFxuICAgIGVzY2FwZTogZXNjYXBlLFxuICAgIGRlYm91bmNlOiBkZWJvdW5jZSxcbiAgICBzaGFsbG93RXF1YWw6IHNoYWxsb3dFcXVhbFxufSk7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENvbnN0L2dsb2JhbCBzdHVmZi9oZWxwZXJzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IERJU0FCTEVEX1RBR1MgPSBbXCJpbnB1dFwiLCBcInRleHRhcmVhXCIsIFwiYnV0dG9uXCIsIFwic2VsZWN0XCIsIFwib3B0aW9uXCIsIFwib3B0Z3JvdXBcIl07XHJcbmNvbnN0IFRSQU5TTEFUQUJMRV9BVFRSUyA9IFtcImxhYmVsXCIsIFwidGl0bGVcIiwgXCJwbGFjZWhvbGRlclwiLCBcImFsdFwiXTtcclxuY29uc3QgbGluZUJyZWFrUkUgPSAvW1xcclxcbl0vO1xyXG5jb25zdCB3aGl0ZXNwYWNlUkUgPSAvXFxzKy9nO1xyXG5jb25zdCBOT0RFX0hPT0tTX1BBUkFNUyA9IHtcclxuICAgIGNyZWF0ZTogXCIoXywgbilcIixcclxuICAgIGluc2VydDogXCJ2blwiLFxyXG4gICAgcmVtb3ZlOiBcIih2biwgcm0pXCIsXHJcbiAgICBkZXN0cm95OiBcIigpXCJcclxufTtcclxuZnVuY3Rpb24gaXNDb21wb25lbnQob2JqKSB7XHJcbiAgICByZXR1cm4gb2JqICYmIG9iai5oYXNPd25Qcm9wZXJ0eShcIl9fb3dsX19cIik7XHJcbn1cclxuY29uc3QgVVRJTFMgPSB7XHJcbiAgICB6ZXJvOiBTeW1ib2woXCJ6ZXJvXCIpLFxyXG4gICAgdG9PYmooZXhwcikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgZXhwciA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBleHByID0gZXhwci50cmltKCk7XHJcbiAgICAgICAgICAgIGlmICghZXhwcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB3b3JkcyA9IGV4cHIuc3BsaXQoL1xccysvKTtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbd29yZHNbaV1dID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZXhwcjtcclxuICAgIH0sXHJcbiAgICBzaGFsbG93RXF1YWwsXHJcbiAgICBhZGROYW1lU3BhY2Uodm5vZGUpIHtcclxuICAgICAgICBhZGROUyh2bm9kZS5kYXRhLCB2bm9kZS5jaGlsZHJlbiwgdm5vZGUuc2VsKTtcclxuICAgIH0sXHJcbiAgICBWRG9tQXJyYXk6IGNsYXNzIFZEb21BcnJheSBleHRlbmRzIEFycmF5IHtcclxuICAgIH0sXHJcbiAgICB2RG9tVG9TdHJpbmc6IGZ1bmN0aW9uICh2ZG9tKSB7XHJcbiAgICAgICAgcmV0dXJuIHZkb21cclxuICAgICAgICAgICAgLm1hcCh2bm9kZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5zZWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLnNlbCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwYXRjaChub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmVsbS5vdXRlckhUTUw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm5vZGUudGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKFwiXCIpO1xyXG4gICAgfSxcclxuICAgIGdldENvbXBvbmVudChvYmopIHtcclxuICAgICAgICB3aGlsZSAob2JqICYmICFpc0NvbXBvbmVudChvYmopKSB7XHJcbiAgICAgICAgICAgIG9iaiA9IG9iai5fX3Byb3RvX187XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvYmo7XHJcbiAgICB9LFxyXG4gICAgZ2V0U2NvcGUob2JqLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgIGNvbnN0IG9iajAgPSBvYmo7XHJcbiAgICAgICAgd2hpbGUgKG9iaiAmJlxyXG4gICAgICAgICAgICAhb2JqLmhhc093blByb3BlcnR5KHByb3BlcnR5KSAmJlxyXG4gICAgICAgICAgICAhKG9iai5oYXNPd25Qcm9wZXJ0eShcIl9fYWNjZXNzX21vZGVfX1wiKSAmJiBvYmouX19hY2Nlc3NfbW9kZV9fID09PSBcInJvXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld09iaiA9IG9iai5fX3Byb3RvX187XHJcbiAgICAgICAgICAgIGlmICghbmV3T2JqIHx8IGlzQ29tcG9uZW50KG5ld09iaikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYmowO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9iaiA9IG5ld09iajtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gcGFyc2VYTUwoeG1sKSB7XHJcbiAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XHJcbiAgICBjb25zdCBkb2MgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHhtbCwgXCJ0ZXh0L3htbFwiKTtcclxuICAgIGlmIChkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwYXJzZXJlcnJvclwiKS5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgbXNnID0gXCJJbnZhbGlkIFhNTCBpbiB0ZW1wbGF0ZS5cIjtcclxuICAgICAgICBjb25zdCBwYXJzZXJlcnJvclRleHQgPSBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwYXJzZXJlcnJvclwiKVswXS50ZXh0Q29udGVudDtcclxuICAgICAgICBpZiAocGFyc2VyZXJyb3JUZXh0KSB7XHJcbiAgICAgICAgICAgIG1zZyArPSBcIlxcblRoZSBwYXJzZXIgaGFzIHByb2R1Y2VkIHRoZSBmb2xsb3dpbmcgZXJyb3IgbWVzc2FnZTpcXG5cIiArIHBhcnNlcmVycm9yVGV4dDtcclxuICAgICAgICAgICAgY29uc3QgcmUgPSAvXFxkKy9nO1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdE1hdGNoID0gcmUuZXhlYyhwYXJzZXJlcnJvclRleHQpO1xyXG4gICAgICAgICAgICBpZiAoZmlyc3RNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IE51bWJlcihmaXJzdE1hdGNoWzBdKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSB4bWwuc3BsaXQoXCJcXG5cIilbbGluZU51bWJlciAtIDFdO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSByZS5leGVjKHBhcnNlcmVycm9yVGV4dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGluZSAmJiBzZWNvbmRNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbkluZGV4ID0gTnVtYmVyKHNlY29uZE1hdGNoWzBdKSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVbY29sdW1uSW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zZyArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFxcblRoZSBlcnJvciBtaWdodCBiZSBsb2NhdGVkIGF0IHhtbCBsaW5lICR7bGluZU51bWJlcn0gY29sdW1uICR7Y29sdW1uSW5kZXh9XFxuYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7bGluZX1cXG4ke1wiLVwiLnJlcGVhdChjb2x1bW5JbmRleCAtIDEpfV5gO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkb2M7XHJcbn1cclxuZnVuY3Rpb24gZXNjYXBlUXVvdGVzKHN0cikge1xyXG4gICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXCcvZywgXCJcXFxcJ1wiKTtcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBRV2ViIHJlbmRlcmluZyBlbmdpbmVcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY2xhc3MgUVdlYiBleHRlbmRzIEV2ZW50QnVzIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgICAgIC8vIHJlY3Vyc2l2ZVRlbXBsYXRlcyBjb250YWlucyBzdWIgdGVtcGxhdGVzIGNhbGxlZCB3aXRoIHQtY2FsbCwgYnV0IHdoaWNoXHJcbiAgICAgICAgLy8gZW5kcyB1cCBpbiByZWN1cnNpdmUgc2l0dWF0aW9ucy4gIFRoaXMgaXMgdmVyeSBzaW1pbGFyIHRvIHRoZSBzbG90IHNpdHVhdGlvbixcclxuICAgICAgICAvLyBhcyBpbiB3ZSBuZWVkIHRvIHByb3BhZ2F0ZSB0aGUgc2NvcGUuXHJcbiAgICAgICAgdGhpcy5zdWJUZW1wbGF0ZXMgPSB7fTtcclxuICAgICAgICB0aGlzLmlzVXBkYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IE9iamVjdC5jcmVhdGUoUVdlYi5URU1QTEFURVMpO1xyXG4gICAgICAgIGlmIChjb25maWcudGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkVGVtcGxhdGVzKGNvbmZpZy50ZW1wbGF0ZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLnRyYW5zbGF0ZUZuKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlRm4gPSBjb25maWcudHJhbnNsYXRlRm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGFkZERpcmVjdGl2ZShkaXJlY3RpdmUpIHtcclxuICAgICAgICBpZiAoZGlyZWN0aXZlLm5hbWUgaW4gUVdlYi5ESVJFQ1RJVkVfTkFNRVMpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEaXJlY3RpdmUgXCIke2RpcmVjdGl2ZS5uYW1lfSBhbHJlYWR5IHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUVdlYi5ESVJFQ1RJVkVTLnB1c2goZGlyZWN0aXZlKTtcclxuICAgICAgICBRV2ViLkRJUkVDVElWRV9OQU1FU1tkaXJlY3RpdmUubmFtZV0gPSAxO1xyXG4gICAgICAgIFFXZWIuRElSRUNUSVZFUy5zb3J0KChkMSwgZDIpID0+IGQxLnByaW9yaXR5IC0gZDIucHJpb3JpdHkpO1xyXG4gICAgICAgIGlmIChkaXJlY3RpdmUuZXh0cmFOYW1lcykge1xyXG4gICAgICAgICAgICBkaXJlY3RpdmUuZXh0cmFOYW1lcy5mb3JFYWNoKG4gPT4gKFFXZWIuRElSRUNUSVZFX05BTUVTW25dID0gMSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyByZWdpc3RlckNvbXBvbmVudChuYW1lLCBDb21wb25lbnQpIHtcclxuICAgICAgICBpZiAoUVdlYi5jb21wb25lbnRzW25hbWVdKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcG9uZW50ICcke25hbWV9JyBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUVdlYi5jb21wb25lbnRzW25hbWVdID0gQ29tcG9uZW50O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciBnbG9iYWxseSBhIHRlbXBsYXRlLiAgQWxsIFFXZWIgaW5zdGFuY2VzIHdpbGwgb2J0YWluIHRoZWlyXHJcbiAgICAgKiB0ZW1wbGF0ZXMgZnJvbSB0aGVpciBvd24gdGVtcGxhdGUgbWFwLCBhbmQgdGhlbiwgZnJvbSB0aGUgZ2xvYmFsIHN0YXRpY1xyXG4gICAgICogVEVNUExBVEVTIHByb3BlcnR5LlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcmVnaXN0ZXJUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSkge1xyXG4gICAgICAgIGlmIChRV2ViLlRFTVBMQVRFU1tuYW1lXSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRlbXBsYXRlICcke25hbWV9JyBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IG5ldyBRV2ViKCk7XHJcbiAgICAgICAgcXdlYi5hZGRUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSk7XHJcbiAgICAgICAgUVdlYi5URU1QTEFURVNbbmFtZV0gPSBxd2ViLnRlbXBsYXRlc1tuYW1lXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGEgdGVtcGxhdGUgdG8gdGhlIGludGVybmFsIHRlbXBsYXRlIG1hcC4gIE5vdGUgdGhhdCBpdCBpcyBub3RcclxuICAgICAqIGltbWVkaWF0ZWx5IGNvbXBpbGVkLlxyXG4gICAgICovXHJcbiAgICBhZGRUZW1wbGF0ZShuYW1lLCB4bWxTdHJpbmcsIGFsbG93RHVwbGljYXRlKSB7XHJcbiAgICAgICAgaWYgKGFsbG93RHVwbGljYXRlICYmIG5hbWUgaW4gdGhpcy50ZW1wbGF0ZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkb2MgPSBwYXJzZVhNTCh4bWxTdHJpbmcpO1xyXG4gICAgICAgIGlmICghZG9jLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0ZW1wbGF0ZSAoc2hvdWxkIG5vdCBiZSBlbXB0eSlcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2FkZFRlbXBsYXRlKG5hbWUsIGRvYy5maXJzdENoaWxkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCB0ZW1wbGF0ZXMgZnJvbSBhIHhtbCAoYXMgYSBzdHJpbmcgb3IgeG1sIGRvY3VtZW50KS4gIFRoaXMgd2lsbCBsb29rIHVwXHJcbiAgICAgKiBmb3IgdGhlIGZpcnN0IDx0ZW1wbGF0ZXM+IHRhZywgYW5kIHdpbGwgY29uc2lkZXIgZWFjaCBjaGlsZCBvZiB0aGlzIGFzIGFcclxuICAgICAqIHRlbXBsYXRlLCB3aXRoIHRoZSBuYW1lIGdpdmVuIGJ5IHRoZSB0LW5hbWUgYXR0cmlidXRlLlxyXG4gICAgICovXHJcbiAgICBhZGRUZW1wbGF0ZXMoeG1sc3RyKSB7XHJcbiAgICAgICAgY29uc3QgZG9jID0gdHlwZW9mIHhtbHN0ciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlWE1MKHhtbHN0cikgOiB4bWxzdHI7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGVzID0gZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGVtcGxhdGVzXCIpWzBdO1xyXG4gICAgICAgIGlmICghdGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgZWxlbSBvZiB0ZW1wbGF0ZXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGVsZW0uZ2V0QXR0cmlidXRlKFwidC1uYW1lXCIpO1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRUZW1wbGF0ZShuYW1lLCBlbGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfYWRkVGVtcGxhdGUobmFtZSwgZWxlbSkge1xyXG4gICAgICAgIGlmIChuYW1lIGluIHRoaXMudGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGVtcGxhdGUgJHtuYW1lfSBhbHJlYWR5IGRlZmluZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcHJvY2Vzc1RlbXBsYXRlKGVsZW0pO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0ge1xyXG4gICAgICAgICAgICBlbGVtLFxyXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKGNvbnRleHQsIGV4dHJhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb21waWxlZEZ1bmN0aW9uID0gdGhpcy5fY29tcGlsZShuYW1lLCBlbGVtKTtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLmZuID0gY29tcGlsZWRGdW5jdGlvbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21waWxlZEZ1bmN0aW9uLmNhbGwodGhpcywgY29udGV4dCwgZXh0cmEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlc1tuYW1lXSA9IHRlbXBsYXRlO1xyXG4gICAgfVxyXG4gICAgX3Byb2Nlc3NUZW1wbGF0ZShlbGVtKSB7XHJcbiAgICAgICAgbGV0IHRicmFuY2ggPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbdC1lbGlmXSwgW3QtZWxzZV1cIik7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsZW4gPSB0YnJhbmNoLmxlbmd0aDsgaSA8IGlsZW47IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgbm9kZSA9IHRicmFuY2hbaV07XHJcbiAgICAgICAgICAgIGxldCBwcmV2RWxlbSA9IG5vZGUucHJldmlvdXNFbGVtZW50U2libGluZztcclxuICAgICAgICAgICAgbGV0IHBhdHRyID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmV2RWxlbS5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGxldCBuYXR0ciA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKyEhbm9kZS5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChwcmV2RWxlbSAmJiAocGF0dHIoXCJ0LWlmXCIpIHx8IHBhdHRyKFwidC1lbGlmXCIpKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhdHRyKFwidC1mb3JlYWNoXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidC1pZiBjYW5ub3Qgc3RheSBhdCB0aGUgc2FtZSBsZXZlbCBhcyB0LWZvcmVhY2ggd2hlbiB1c2luZyB0LWVsaWYgb3IgdC1lbHNlXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKFtcInQtaWZcIiwgXCJ0LWVsaWZcIiwgXCJ0LWVsc2VcIl0ubWFwKG5hdHRyKS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIGI7XHJcbiAgICAgICAgICAgICAgICB9KSA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IG9uZSBjb25kaXRpb25hbCBicmFuY2hpbmcgZGlyZWN0aXZlIGlzIGFsbG93ZWQgcGVyIG5vZGVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBBbGwgdGV4dCAod2l0aCBvbmx5IHNwYWNlcykgYW5kIGNvbW1lbnQgbm9kZXMgKG5vZGVUeXBlIDgpIGJldHdlZW5cclxuICAgICAgICAgICAgICAgIC8vIGJyYW5jaCBub2RlcyBhcmUgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgbGV0IHRleHROb2RlO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKCh0ZXh0Tm9kZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKSAhPT0gcHJldkVsZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGV4dE5vZGUubm9kZVZhbHVlLnRyaW0oKS5sZW5ndGggJiYgdGV4dE5vZGUubm9kZVR5cGUgIT09IDgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGV4dCBpcyBub3QgYWxsb3dlZCBiZXR3ZWVuIGJyYW5jaGluZyBkaXJlY3RpdmVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInQtZWxpZiBhbmQgdC1lbHNlIGRpcmVjdGl2ZXMgbXVzdCBiZSBwcmVjZWRlZCBieSBhIHQtaWYgb3IgdC1lbGlmIGRpcmVjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIGEgdGVtcGxhdGVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSB0aGUgdGVtcGxhdGUgc2hvdWxkIGFscmVhZHkgaGF2ZSBiZWVuIGFkZGVkXHJcbiAgICAgKi9cclxuICAgIHJlbmRlcihuYW1lLCBjb250ZXh0ID0ge30sIGV4dHJhID0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXNbbmFtZV07XHJcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRlbXBsYXRlICR7bmFtZX0gZG9lcyBub3QgZXhpc3RgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmZuLmNhbGwodGhpcywgY29udGV4dCwgZXh0cmEpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgYSB0ZW1wbGF0ZSB0byBhIGh0bWwgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGlzIGlzIG1vcmUgbGltaXRlZCB0aGFuIHRoZSBgcmVuZGVyYCBtZXRob2Q6IGl0IGlzIG5vdCBzdWl0YWJsZVxyXG4gICAgICogdG8gcmVuZGVyIGEgZnVsbCBjb21wb25lbnQgdHJlZSwgc2luY2UgdGhpcyBpcyBhbiBhc3luY2hyb25vdXMgb3BlcmF0aW9uLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2FuIG9ubHkgcmVuZGVyIHRlbXBsYXRlcyB3aXRob3V0IGNvbXBvbmVudHMuXHJcbiAgICAgKi9cclxuICAgIHJlbmRlclRvU3RyaW5nKG5hbWUsIGNvbnRleHQgPSB7fSwgZXh0cmEpIHtcclxuICAgICAgICBjb25zdCB2bm9kZSA9IHRoaXMucmVuZGVyKG5hbWUsIGNvbnRleHQsIGV4dHJhKTtcclxuICAgICAgICBpZiAodm5vZGUuc2VsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZub2RlLnRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLnNlbCk7XHJcbiAgICAgICAgY29uc3QgZWxlbSA9IHBhdGNoKG5vZGUsIHZub2RlKS5lbG07XHJcbiAgICAgICAgZnVuY3Rpb24gZXNjYXBlVGV4dE5vZGVzKG5vZGUpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBlc2NhcGUobm9kZS50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgbiBvZiBub2RlLmNoaWxkTm9kZXMpIHtcclxuICAgICAgICAgICAgICAgIGVzY2FwZVRleHROb2RlcyhuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlc2NhcGVUZXh0Tm9kZXMoZWxlbSk7XHJcbiAgICAgICAgcmV0dXJuIGVsZW0ub3V0ZXJIVE1MO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBGb3JjZSBhbGwgd2lkZ2V0cyBjb25uZWN0ZWQgdG8gdGhpcyBRV2ViIGluc3RhbmNlIHRvIHJlcmVuZGVyIHRoZW1zZWx2ZXMuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgbW9zdGx5IHVzZWZ1bCBmb3IgZXh0ZXJuYWwgY29kZSB0aGF0IHdhbnQgdG8gbW9kaWZ5IHRoZVxyXG4gICAgICogYXBwbGljYXRpb24gaW4gc29tZSBjYXNlcy4gIEZvciBleGFtcGxlLCBhIHJvdXRlciBwbHVnaW4uXHJcbiAgICAgKi9cclxuICAgIGZvcmNlVXBkYXRlKCkge1xyXG4gICAgICAgIHRoaXMuaXNVcGRhdGluZyA9IHRydWU7XHJcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNVcGRhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwidXBkYXRlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfY29tcGlsZShuYW1lLCBlbGVtLCBwYXJlbnRDb250ZXh0LCBkZWZpbmVLZXkpIHtcclxuICAgICAgICBjb25zdCBpc0RlYnVnID0gZWxlbS5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KFwidC1kZWJ1Z1wiKTtcclxuICAgICAgICBjb25zdCBjdHggPSBuZXcgQ29tcGlsYXRpb25Db250ZXh0KG5hbWUpO1xyXG4gICAgICAgIGlmIChlbGVtLnRhZ05hbWUgIT09IFwidFwiKSB7XHJcbiAgICAgICAgICAgIGN0eC5zaG91bGREZWZpbmVSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcmVudENvbnRleHQpIHtcclxuICAgICAgICAgICAgY3R4LnZhcmlhYmxlcyA9IE9iamVjdC5jcmVhdGUocGFyZW50Q29udGV4dC52YXJpYWJsZXMpO1xyXG4gICAgICAgICAgICBjdHgucGFyZW50Tm9kZSA9IHBhcmVudENvbnRleHQucGFyZW50Tm9kZSB8fCBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICBjdHguYWxsb3dNdWx0aXBsZVJvb3RzID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4Lmhhc1BhcmVudFdpZGdldCA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5zaG91bGREZWZpbmVSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBjJHtjdHgucGFyZW50Tm9kZX0gPSBleHRyYS5wYXJlbnROb2RlO2ApO1xyXG4gICAgICAgICAgICBpZiAoZGVmaW5lS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IGtleTAgPSBleHRyYS5rZXkgfHwgXCJcIjtgKTtcclxuICAgICAgICAgICAgICAgIGN0eC5oYXNLZXkwID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jb21waWxlTm9kZShlbGVtLCBjdHgpO1xyXG4gICAgICAgIGlmICghcGFyZW50Q29udGV4dCkge1xyXG4gICAgICAgICAgICBpZiAoY3R4LnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJldHVybiByZXN1bHQ7YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN0eC5yb290Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQSB0ZW1wbGF0ZSBzaG91bGQgaGF2ZSBvbmUgcm9vdCBub2RlICgke2N0eC50ZW1wbGF0ZU5hbWV9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJldHVybiB2biR7Y3R4LnJvb3ROb2RlfTtgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY29kZSA9IGN0eC5nZW5lcmF0ZUNvZGUoKTtcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZU5hbWUgPSBjdHgudGVtcGxhdGVOYW1lLnJlcGxhY2UoL2AvZywgXCInXCIpLnNsaWNlKDAsIDIwMCk7XHJcbiAgICAgICAgY29kZS51bnNoaWZ0KGAgICAgLy8gVGVtcGxhdGUgbmFtZTogXCIke3RlbXBsYXRlTmFtZX1cImApO1xyXG4gICAgICAgIGxldCB0ZW1wbGF0ZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZSA9IG5ldyBGdW5jdGlvbihcImNvbnRleHQsIGV4dHJhXCIsIGNvZGUuam9pbihcIlxcblwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQoYEludmFsaWQgQ29kZSBnZW5lcmF0ZWQgYnkgJHt0ZW1wbGF0ZU5hbWV9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihjb2RlLmpvaW4oXCJcXG5cIikpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBnZW5lcmF0ZWQgY29kZSB3aGlsZSBjb21waWxpbmcgdGVtcGxhdGUgJyR7dGVtcGxhdGVOYW1lfSc6ICR7ZS5tZXNzYWdlfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNEZWJ1Zykge1xyXG4gICAgICAgICAgICBjb25zdCB0cGwgPSB0aGlzLnRlbXBsYXRlc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKHRwbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbXNnID0gYFRlbXBsYXRlOiAke3RwbC5lbGVtLm91dGVySFRNTH1cXG5Db21waWxlZCBjb2RlOlxcbiR7dGVtcGxhdGUudG9TdHJpbmcoKX1gO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIGNvZGUgZnJvbSBhbiB4bWwgbm9kZVxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgX2NvbXBpbGVOb2RlKG5vZGUsIGN0eCkge1xyXG4gICAgICAgIGlmICghKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50KSkge1xyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGEgdGV4dCBub2RlLCB0aGVyZSBhcmUgbm8gZGlyZWN0aXZlIHRvIGFwcGx5XHJcbiAgICAgICAgICAgIGxldCB0ZXh0ID0gbm9kZS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKCFjdHguaW5QcmVUYWcpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsaW5lQnJlYWtSRS50ZXN0KHRleHQpICYmICF0ZXh0LnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2Uod2hpdGVzcGFjZVJFLCBcIiBcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRlRm4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKFwidC10cmFuc2xhdGlvblwiKSAhPT0gXCJvZmZcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSB0aGlzLnRyYW5zbGF0ZUZuKHRleHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goe3RleHQ6IFxcYCR7dGV4dH1cXGB9KTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT09IDgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goaCgnIScsIFxcYCR7dGV4dH1cXGApKTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjdHgucGFyZW50VGV4dE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB2biR7Y3R4LnBhcmVudFRleHROb2RlfS50ZXh0ICs9IFxcYCR7dGV4dH1cXGA7YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGFuIHVudXN1YWwgc2l0dWF0aW9uOiB0aGlzIHRleHQgbm9kZSBpcyB0aGUgcmVzdWx0IG9mIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gdGVtcGxhdGUgcmVuZGVyaW5nLlxyXG4gICAgICAgICAgICAgICAgbGV0IG5vZGVJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHZuJHtub2RlSUR9ID0ge3RleHQ6IFxcYCR7dGV4dH1cXGB9O2ApO1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IHZuJHtub2RlSUR9O2ApO1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnJvb3ROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnBhcmVudFRleHROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmlyc3RMZXR0ZXIgPSBub2RlLnRhZ05hbWVbMF07XHJcbiAgICAgICAgaWYgKGZpcnN0TGV0dGVyID09PSBmaXJzdExldHRlci50b1VwcGVyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBjb21wb25lbnQsIHdlIG1vZGlmeSBpbiBwbGFjZSB0aGUgeG1sIGRvY3VtZW50IHRvIGNoYW5nZVxyXG4gICAgICAgICAgICAvLyA8U29tZUNvbXBvbmVudCAuLi4gLz4gdG8gPHQgdC1jb21wb25lbnQ9XCJTb21lQ29tcG9uZW50XCIgLi4uIC8+XHJcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKFwidC1jb21wb25lbnRcIiwgbm9kZS50YWdOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobm9kZS50YWdOYW1lICE9PSBcInRcIiAmJiBub2RlLmhhc0F0dHJpYnV0ZShcInQtY29tcG9uZW50XCIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGlyZWN0aXZlICd0LWNvbXBvbmVudCcgY2FuIG9ubHkgYmUgdXNlZCBvbiA8dD4gbm9kZXMgKHVzZWQgb24gYSA8JHtub2RlLnRhZ05hbWV9PilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcclxuICAgICAgICBjb25zdCB2YWxpZERpcmVjdGl2ZXMgPSBbXTtcclxuICAgICAgICBjb25zdCBmaW5hbGl6ZXJzID0gW107XHJcbiAgICAgICAgLy8gbWF5YmUgdGhpcyBpcyBub3Qgb3B0aW1hbDogd2UgaXRlcmF0ZSBvbiBhbGwgYXR0cmlidXRlcyBoZXJlLCBhbmQgYWdhaW5cclxuICAgICAgICAvLyBqdXN0IGFmdGVyIGZvciBlYWNoIGRpcmVjdGl2ZS5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGF0dHJOYW1lID0gYXR0cmlidXRlc1tpXS5uYW1lO1xyXG4gICAgICAgICAgICBpZiAoYXR0ck5hbWUuc3RhcnRzV2l0aChcInQtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZE5hbWUgPSBhdHRyTmFtZS5zbGljZSgyKS5zcGxpdCgvLXxcXC4vKVswXTtcclxuICAgICAgICAgICAgICAgIGlmICghKGROYW1lIGluIFFXZWIuRElSRUNUSVZFX05BTUVTKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBRV2ViIGRpcmVjdGl2ZTogJyR7YXR0ck5hbWV9J2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudGFnTmFtZSAhPT0gXCJ0XCIgJiYgKGF0dHJOYW1lID09PSBcInQtZXNjXCIgfHwgYXR0ck5hbWUgPT09IFwidC1yYXdcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHROb2RlLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgbm9kZS5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBBcnJheS5mcm9tKG5vZGUuY2hpbGROb2RlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdE5vZGUuYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKHROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgRElSX04gPSBRV2ViLkRJUkVDVElWRVMubGVuZ3RoO1xyXG4gICAgICAgIGNvbnN0IEFUVFJfTiA9IGF0dHJpYnV0ZXMubGVuZ3RoO1xyXG4gICAgICAgIGxldCB3aXRoSGFuZGxlcnMgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IERJUl9OOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGRpcmVjdGl2ZSA9IFFXZWIuRElSRUNUSVZFU1tpXTtcclxuICAgICAgICAgICAgbGV0IGZ1bGxOYW1lO1xyXG4gICAgICAgICAgICBsZXQgdmFsdWU7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgQVRUUl9OOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGVzW2pdLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgfHxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lLnN0YXJ0c1dpdGgoXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgKyBcIi1cIikgfHxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lLnN0YXJ0c1dpdGgoXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgKyBcIi5cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBmdWxsTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhdHRyaWJ1dGVzW2pdLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkRGlyZWN0aXZlcy5wdXNoKHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGl2ZS5uYW1lID09PSBcIm9uXCIgfHwgZGlyZWN0aXZlLm5hbWUgPT09IFwibW9kZWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aXRoSGFuZGxlcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCB7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0gb2YgdmFsaWREaXJlY3RpdmVzKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuZmluYWxpemUpIHtcclxuICAgICAgICAgICAgICAgIGZpbmFsaXplcnMucHVzaCh7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuYXROb2RlRW5jb3VudGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0RvbmUgPSBkaXJlY3RpdmUuYXROb2RlRW5jb3VudGVyKHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHF3ZWI6IHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChpc0RvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0gb2YgZmluYWxpemVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUuZmluYWxpemUoeyBub2RlLCBxd2ViOiB0aGlzLCBjdHgsIGZ1bGxOYW1lLCB2YWx1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChub2RlLm5vZGVOYW1lICE9PSBcInRcIikge1xyXG4gICAgICAgICAgICBsZXQgbm9kZUlEID0gdGhpcy5fY29tcGlsZUdlbmVyaWNOb2RlKG5vZGUsIGN0eCwgd2l0aEhhbmRsZXJzKTtcclxuICAgICAgICAgICAgY3R4ID0gY3R4LndpdGhQYXJlbnQobm9kZUlEKTtcclxuICAgICAgICAgICAgbGV0IG5vZGVIb29rcyA9IHt9O1xyXG4gICAgICAgICAgICBsZXQgYWRkTm9kZUhvb2sgPSBmdW5jdGlvbiAoaG9vaywgaGFuZGxlcikge1xyXG4gICAgICAgICAgICAgICAgbm9kZUhvb2tzW2hvb2tdID0gbm9kZUhvb2tzW2hvb2tdIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgbm9kZUhvb2tzW2hvb2tdLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGZvciAobGV0IHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSBvZiB2YWxpZERpcmVjdGl2ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuYXROb2RlQ3JlYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUuYXROb2RlQ3JlYXRpb24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxd2ViOiB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlELFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGROb2RlSG9va1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhub2RlSG9va3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0uaG9vayA9IHtgKTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGhvb2sgaW4gbm9kZUhvb2tzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYCAgJHtob29rfTogJHtOT0RFX0hPT0tTX1BBUkFNU1tob29rXX0gPT4ge2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGhhbmRsZXIgb2Ygbm9kZUhvb2tzW2hvb2tdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAgICAgJHtoYW5kbGVyfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgICB9LGApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYH07YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwicHJlXCIpIHtcclxuICAgICAgICAgICAgY3R4ID0gY3R4LnN1YkNvbnRleHQoXCJpblByZVRhZ1wiLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fY29tcGlsZUNoaWxkcmVuKG5vZGUsIGN0eCk7XHJcbiAgICAgICAgLy8gc3ZnIHN1cHBvcnRcclxuICAgICAgICAvLyB3ZSBoYWRkIHN2ZyBuYW1lc3BhY2UgaWYgaXQgaXMgYSBzdmcgb3IgaWYgaXQgaXMgYSBnLCBidXQgb25seSBpZiBpdCBpc1xyXG4gICAgICAgIC8vIHRoZSByb290IG5vZGUuICBUaGlzIGlzIHRoZSBlYXNpZXN0IHdheSB0byBzdXBwb3J0IHN2ZyBzdWIgY29tcG9uZW50czpcclxuICAgICAgICAvLyB0aGV5IG5lZWQgdG8gaGF2ZSBhIGcgdGFnIGFzIHJvb3QuIE90aGVyd2lzZSwgd2Ugd291bGQgbmVlZCBhIGNvbXBsZXRlXHJcbiAgICAgICAgLy8gbGlzdCBvZiBhbGxvd2VkIHN2ZyB0YWdzLlxyXG4gICAgICAgIGNvbnN0IHNob3VsZEFkZE5TID0gbm9kZS5ub2RlTmFtZSA9PT0gXCJzdmdcIiB8fCAobm9kZS5ub2RlTmFtZSA9PT0gXCJnXCIgJiYgY3R4LnJvb3ROb2RlID09PSBjdHgucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgaWYgKHNob3VsZEFkZE5TKSB7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVVdGlscyA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB1dGlscy5hZGROYW1lU3BhY2Uodm4ke2N0eC5wYXJlbnROb2RlfSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSBvZiBmaW5hbGl6ZXJzKSB7XHJcbiAgICAgICAgICAgIGRpcmVjdGl2ZS5maW5hbGl6ZSh7IG5vZGUsIHF3ZWI6IHRoaXMsIGN0eCwgZnVsbE5hbWUsIHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9jb21waWxlR2VuZXJpY05vZGUobm9kZSwgY3R4LCB3aXRoSGFuZGxlcnMgPSB0cnVlKSB7XHJcbiAgICAgICAgLy8gbm9kZVR5cGUgMSBpcyBnZW5lcmljIHRhZ1xyXG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlICE9PSAxKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVuc3VwcG9ydGVkIG5vZGUgdHlwZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcclxuICAgICAgICBjb25zdCBhdHRycyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHByb3BzID0gW107XHJcbiAgICAgICAgY29uc3QgdGF0dHJzID0gW107XHJcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQm9vbGVhblByb3BzKGtleSwgdmFsKSB7XHJcbiAgICAgICAgICAgIGxldCBpc1Byb3AgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwiaW5wdXRcIiAmJiBrZXkgPT09IFwiY2hlY2tlZFwiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdHlwZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidHlwZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcImNoZWNrYm94XCIgfHwgdHlwZSA9PT0gXCJyYWRpb1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gXCJvcHRpb25cIiAmJiBrZXkgPT09IFwic2VsZWN0ZWRcIikge1xyXG4gICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoa2V5ID09PSBcImRpc2FibGVkXCIgJiYgRElTQUJMRURfVEFHUy5pbmRleE9mKG5vZGUubm9kZU5hbWUpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIGlzUHJvcCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKChrZXkgPT09IFwicmVhZG9ubHlcIiAmJiBub2RlLm5vZGVOYW1lID09PSBcImlucHV0XCIpIHx8IG5vZGUubm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIikge1xyXG4gICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNQcm9wKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9wcy5wdXNoKGAke2tleX06IF8ke3ZhbH1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY2xhc3NPYmogPSBcIlwiO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IGF0dHJpYnV0ZXNbaV0ubmFtZTtcclxuICAgICAgICAgICAgbGV0IHZhbHVlID0gYXR0cmlidXRlc1tpXS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRlRm4gJiYgVFJBTlNMQVRBQkxFX0FUVFJTLmluY2x1ZGVzKG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMudHJhbnNsYXRlRm4odmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHJlZ3VsYXIgYXR0cmlidXRlc1xyXG4gICAgICAgICAgICBpZiAoIW5hbWUuc3RhcnRzV2l0aChcInQtXCIpICYmICFub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0Zi1cIiArIG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhdHRJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gXCJjbGFzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSA9IHZhbHVlLnRyaW0oKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNsYXNzRGVmID0gdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGEgPT4gYCcke2VzY2FwZVF1b3RlcyhhKX0nOnRydWVgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc09iaiA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgJHtjbGFzc09ian0gPSB7JHtjbGFzc0RlZn19O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJyR7ZXNjYXBlUXVvdGVzKHZhbHVlKX0nO2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbmFtZS5tYXRjaCgvXlthLXpBLVpdKyQvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgY29udGFpbnMgJ25vbiBsZXR0ZXJzJyA9PiB3ZSB3YW50IHRvIHF1b3RlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAnXCInICsgbmFtZSArICdcIic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzLnB1c2goYCR7bmFtZX06IF8ke2F0dElEfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUJvb2xlYW5Qcm9wcyhuYW1lLCBhdHRJRCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZHluYW1pYyBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoXCJ0LWF0dC1cIikpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhdHROYW1lID0gbmFtZS5zbGljZSg2KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHYgPSBjdHguZ2V0VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHYgPT09IFwic3RyaW5nXCIgPyBjdHguZm9ybWF0RXhwcmVzc2lvbih2KSA6IGBzY29wZS4ke3YuaWR9YDtcclxuICAgICAgICAgICAgICAgIGlmIChhdHROYW1lID09PSBcImNsYXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlID0gYHV0aWxzLnRvT2JqKCR7Zm9ybWF0dGVkVmFsdWV9KWA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBPYmplY3QuYXNzaWduKCR7Y2xhc3NPYmp9LCAke2Zvcm1hdHRlZFZhbHVlfSlgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzT2JqID0gYF8ke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9ICR7Zm9ybWF0dGVkVmFsdWV9O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dElEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWF0dE5hbWUubWF0Y2goL15bYS16QS1aXSskLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIGNvbnRhaW5zICdub24gbGV0dGVycycgPT4gd2Ugd2FudCB0byBxdW90ZSBpdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHROYW1lID0gJ1wiJyArIGF0dE5hbWUgKyAnXCInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGNvbWJpbmUgZHluYW1pYyB3aXRoIG5vbiBkeW5hbWljIGF0dHJpYnV0ZXM6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xhc3M9XCJhXCIgdC1hdHQtY2xhc3M9XCIneW9wJ1wiIHNob3VsZCBiZSByZW5kZXJlZCBhcyBjbGFzcz1cImEgeW9wXCJcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRWYWx1ZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHthdHRWYWx1ZUlEfSA9ICR7Zm9ybWF0dGVkVmFsdWV9O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZSA9IGAnJHthdHRWYWx1ZX0nICsgKF8ke2F0dFZhbHVlSUR9ID8gJyAnICsgXyR7YXR0VmFsdWVJRH0gOiAnJylgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRySW5kZXggPSBhdHRycy5maW5kSW5kZXgoYXR0ID0+IGF0dC5zdGFydHNXaXRoKGF0dE5hbWUgKyBcIjpcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRycy5zcGxpY2UoYXR0ckluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHthdHRJRH0gPSAke2Zvcm1hdHRlZFZhbHVlfTtgKTtcclxuICAgICAgICAgICAgICAgICAgICBhdHRycy5wdXNoKGAke2F0dE5hbWV9OiBfJHthdHRJRH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVCb29sZWFuUHJvcHMoYXR0TmFtZSwgYXR0SUQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoXCJ0LWF0dGYtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXR0TmFtZSA9IG5hbWUuc2xpY2UoNyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWF0dE5hbWUubWF0Y2goL15bYS16QS1aXSskLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgY29udGFpbnMgJ25vbiBsZXR0ZXJzJyA9PiB3ZSB3YW50IHRvIHF1b3RlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0TmFtZSA9ICdcIicgKyBhdHROYW1lICsgJ1wiJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEV4cHIgPSBjdHguaW50ZXJwb2xhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYXR0SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHN0YXRpY1ZhbCA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRpY1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJyR7c3RhdGljVmFsfSAnICsgJHtmb3JtYXR0ZWRFeHByfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJHtmb3JtYXR0ZWRFeHByfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF0dHJzLnB1c2goYCR7YXR0TmFtZX06IF8ke2F0dElEfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHQtYXR0PSBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgIGlmIChuYW1lID09PSBcInQtYXR0XCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpZCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IF8ke2lkfSA9ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpfTtgKTtcclxuICAgICAgICAgICAgICAgIHRhdHRycy5wdXNoKGlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbm9kZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICBsZXQga2V5ID0gY3R4Lmxvb3BOdW1iZXIgfHwgY3R4Lmhhc0tleTAgPyBgXFxgXFwke2tleSR7Y3R4Lmxvb3BOdW1iZXJ9fV8ke25vZGVJRH1cXGBgIDogbm9kZUlEO1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gW2BrZXk6JHtrZXl9YF07XHJcbiAgICAgICAgaWYgKGF0dHJzLmxlbmd0aCArIHRhdHRycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2goYGF0dHJzOnske2F0dHJzLmpvaW4oXCIsXCIpfX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChgcHJvcHM6eyR7cHJvcHMuam9pbihcIixcIil9fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2xhc3NPYmopIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChgY2xhc3M6JHtjbGFzc09ian1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdpdGhIYW5kbGVycykge1xyXG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGBvbjp7fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGMke25vZGVJRH0gPSBbXSwgcCR7bm9kZUlEfSA9IHske3BhcnRzLmpvaW4oXCIsXCIpfX07YCk7XHJcbiAgICAgICAgZm9yIChsZXQgaWQgb2YgdGF0dHJzKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRJZihgXyR7aWR9IGluc3RhbmNlb2YgQXJyYXlgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0uYXR0cnNbXyR7aWR9WzBdXSA9IF8ke2lkfVsxXTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZEVsc2UoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGZvciAobGV0IGtleSBpbiBfJHtpZH0pIHtgKTtcclxuICAgICAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5hdHRyc1trZXldID0gXyR7aWR9W2tleV07YCk7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCB2biR7bm9kZUlEfSA9IGgoJyR7bm9kZS5ub2RlTmFtZX0nLCBwJHtub2RlSUR9LCBjJHtub2RlSUR9KTtgKTtcclxuICAgICAgICBpZiAoY3R4LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKHZuJHtub2RlSUR9KTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY3R4Lmxvb3BOdW1iZXIgfHwgY3R4Lmhhc0tleTApIHtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB2biR7bm9kZUlEfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGVJRDtcclxuICAgIH1cclxuICAgIF9jb21waWxlQ2hpbGRyZW4obm9kZSwgY3R4KSB7XHJcbiAgICAgICAgaWYgKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGNoaWxkIG9mIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcGlsZU5vZGUoY2hpbGQsIGN0eCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuUVdlYi51dGlscyA9IFVUSUxTO1xyXG5RV2ViLmNvbXBvbmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5RV2ViLkRJUkVDVElWRV9OQU1FUyA9IHtcclxuICAgIG5hbWU6IDEsXHJcbiAgICBhdHQ6IDEsXHJcbiAgICBhdHRmOiAxLFxyXG4gICAgdHJhbnNsYXRpb246IDFcclxufTtcclxuUVdlYi5ESVJFQ1RJVkVTID0gW107XHJcblFXZWIuVEVNUExBVEVTID0ge307XHJcblFXZWIubmV4dElkID0gMTtcclxuLy8gZGV2IG1vZGUgZW5hYmxlcyBiZXR0ZXIgZXJyb3IgbWVzc2FnZXMgb3IgbW9yZSBjb3N0bHkgdmFsaWRhdGlvbnNcclxuUVdlYi5kZXYgPSBmYWxzZTtcclxuLy8gc2xvdHMgY29udGFpbnMgc3ViIHRlbXBsYXRlcyBkZWZpbmVkIHdpdGggdC1zZXQgaW5zaWRlIHQtY29tcG9uZW50IG5vZGVzLCBhbmRcclxuLy8gYXJlIG1lYW50IHRvIGJlIHVzZWQgYnkgdGhlIHQtc2xvdCBkaXJlY3RpdmUuXHJcblFXZWIuc2xvdHMgPSB7fTtcclxuUVdlYi5uZXh0U2xvdElkID0gMTtcblxuY29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG5mdW5jdGlvbiBodG1sVG9WRE9NKGh0bWwpIHtcclxuICAgIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGZvciAobGV0IGNoaWxkIG9mIGRvYy5ib2R5LmNoaWxkTm9kZXMpIHtcclxuICAgICAgICByZXN1bHQucHVzaChodG1sVG9WTm9kZShjaGlsZCkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBodG1sVG9WTm9kZShub2RlKSB7XHJcbiAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgRWxlbWVudCkpIHtcclxuICAgICAgICByZXR1cm4geyB0ZXh0OiBub2RlLnRleHRDb250ZW50IH07XHJcbiAgICB9XHJcbiAgICBjb25zdCBhdHRycyA9IHt9O1xyXG4gICAgZm9yIChsZXQgYXR0ciBvZiBub2RlLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICBhdHRyc1thdHRyLm5hbWVdID0gYXR0ci50ZXh0Q29udGVudDtcclxuICAgIH1cclxuICAgIGNvbnN0IGNoaWxkcmVuID0gW107XHJcbiAgICBmb3IgKGxldCBjIG9mIG5vZGUuY2hpbGROb2Rlcykge1xyXG4gICAgICAgIGNoaWxkcmVuLnB1c2goaHRtbFRvVk5vZGUoYykpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGgobm9kZS50YWdOYW1lLCB7IGF0dHJzIH0sIGNoaWxkcmVuKTtcclxufVxuXG4vKipcclxuICogT3dsIFFXZWIgRGlyZWN0aXZlc1xyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgdGhlIGltcGxlbWVudGF0aW9uIG9mIG1vc3Qgc3RhbmRhcmQgUVdlYiBkaXJlY3RpdmVzOlxyXG4gKiAtIHQtZXNjXHJcbiAqIC0gdC1yYXdcclxuICogLSB0LXNldC90LXZhbHVlXHJcbiAqIC0gdC1pZi90LWVsaWYvdC1lbHNlXHJcbiAqIC0gdC1jYWxsXHJcbiAqIC0gdC1mb3JlYWNoL3QtYXNcclxuICogLSB0LWRlYnVnXHJcbiAqIC0gdC1sb2dcclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtZXNjIGFuZCB0LXJhd1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLnV0aWxzLmh0bWxUb1ZET00gPSBodG1sVG9WRE9NO1xyXG5mdW5jdGlvbiBjb21waWxlVmFsdWVOb2RlKHZhbHVlLCBub2RlLCBxd2ViLCBjdHgpIHtcclxuICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICBpZiAodmFsdWUgPT09IFwiMFwiKSB7XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoZSAnemVybycgbWFnaWNhbCBzeW1ib2wgaXMgd2hlcmUgd2UgY2FuIGZpbmQgdGhlIHJlc3VsdCBvZiB0aGUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIC8vIG9mICB0aGUgYm9keSBvZiB0aGUgdC1jYWxsLlxyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCB6ZXJvQXJncyA9IGN0eC5lc2NhcGluZ1xyXG4gICAgICAgICAgICAgICAgPyBge3RleHQ6IHV0aWxzLnZEb21Ub1N0cmluZyhzY29wZVt1dGlscy56ZXJvXSl9YFxyXG4gICAgICAgICAgICAgICAgOiBgLi4uc2NvcGVbdXRpbHMuemVyb11gO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goJHt6ZXJvQXJnc30pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgZXhwcklEO1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIGV4cHJJRCA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2V4cHJJRH0gPSAke2N0eC5mb3JtYXRFeHByZXNzaW9uKHZhbHVlKX07YCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBleHBySUQgPSBgc2NvcGUuJHt2YWx1ZS5pZH1gO1xyXG4gICAgfVxyXG4gICAgY3R4LmFkZElmKGAke2V4cHJJRH0gIT0gbnVsbGApO1xyXG4gICAgaWYgKGN0eC5lc2NhcGluZykge1xyXG4gICAgICAgIGxldCBwcm90ZWN0SUQ7XHJcbiAgICAgICAgaWYgKHZhbHVlLmhhc0JvZHkpIHtcclxuICAgICAgICAgICAgcHJvdGVjdElEID0gY3R4LnN0YXJ0UHJvdGVjdFNjb3BlKCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke2V4cHJJRH0gPSAke2V4cHJJRH0gaW5zdGFuY2VvZiB1dGlscy5WRG9tQXJyYXkgPyB1dGlscy52RG9tVG9TdHJpbmcoJHtleHBySUR9KSA6ICR7ZXhwcklEfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnRUZXh0Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgdm4ke2N0eC5wYXJlbnRUZXh0Tm9kZX0udGV4dCArPSAke2V4cHJJRH07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjJHtjdHgucGFyZW50Tm9kZX0ucHVzaCh7dGV4dDogJHtleHBySUR9fSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgbm9kZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnJvb3ROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQucGFyZW50VGV4dE5vZGUgPSBub2RlSUQ7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgdm4ke25vZGVJRH0gPSB7dGV4dDogJHtleHBySUR9fTtgKTtcclxuICAgICAgICAgICAgaWYgKGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB2biR7bm9kZUlEfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZS5oYXNCb2R5KSB7XHJcbiAgICAgICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICBpZiAodmFsdWUuaGFzQm9keSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgY29uc3Qgdm5vZGVBcnJheSA9ICR7ZXhwcklEfSBpbnN0YW5jZW9mIHV0aWxzLlZEb21BcnJheSA/ICR7ZXhwcklEfSA6IHV0aWxzLmh0bWxUb1ZET00oJHtleHBySUR9KTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKC4uLnZub2RlQXJyYXkpO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKC4uLnV0aWxzLmh0bWxUb1ZET00oJHtleHBySUR9KSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICBjdHguYWRkRWxzZSgpO1xyXG4gICAgICAgIHF3ZWIuX2NvbXBpbGVDaGlsZHJlbihub2RlLCBjdHgpO1xyXG4gICAgfVxyXG4gICAgY3R4LmNsb3NlSWYoKTtcclxufVxyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImVzY1wiLFxyXG4gICAgcHJpb3JpdHk6IDcwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgcXdlYiwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWVzY1wiKSk7XHJcbiAgICAgICAgY29tcGlsZVZhbHVlTm9kZSh2YWx1ZSwgbm9kZSwgcXdlYiwgY3R4LnN1YkNvbnRleHQoXCJlc2NhcGluZ1wiLCB0cnVlKSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcInJhd1wiLFxyXG4gICAgcHJpb3JpdHk6IDgwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgcXdlYiwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXJhd1wiKSk7XHJcbiAgICAgICAgY29tcGlsZVZhbHVlTm9kZSh2YWx1ZSwgbm9kZSwgcXdlYiwgY3R4KTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtc2V0XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwic2V0XCIsXHJcbiAgICBleHRyYU5hbWVzOiBbXCJ2YWx1ZVwiXSxcclxuICAgIHByaW9yaXR5OiA2MCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1zZXRcIik7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXZhbHVlXCIpO1xyXG4gICAgICAgIGN0eC52YXJpYWJsZXNbdmFyaWFibGVdID0gY3R4LnZhcmlhYmxlc1t2YXJpYWJsZV0gfHwge307XHJcbiAgICAgICAgbGV0IHF3ZWJ2YXIgPSBjdHgudmFyaWFibGVzW3ZhcmlhYmxlXTtcclxuICAgICAgICBjb25zdCBoYXNCb2R5ID0gbm9kZS5oYXNDaGlsZE5vZGVzKCk7XHJcbiAgICAgICAgcXdlYnZhci5pZCA9IHZhcmlhYmxlO1xyXG4gICAgICAgIHF3ZWJ2YXIuZXhwciA9IGBzY29wZS4ke3ZhcmlhYmxlfWA7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpO1xyXG4gICAgICAgICAgICBsZXQgc2NvcGVFeHByID0gYHNjb3BlYDtcclxuICAgICAgICAgICAgaWYgKGN0eC5wcm90ZWN0ZWRTY29wZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNjb3BlRXhwciA9IGB1dGlscy5nZXRTY29wZShzY29wZSwgJyR7dmFyaWFibGV9JylgO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke3Njb3BlRXhwcn0uJHt2YXJpYWJsZX0gPSAke2Zvcm1hdHRlZFZhbHVlfTtgKTtcclxuICAgICAgICAgICAgcXdlYnZhci52YWx1ZSA9IGZvcm1hdHRlZFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaGFzQm9keSkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRJZihgISgke3F3ZWJ2YXIuZXhwcn0pYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdGVtcFBhcmVudE5vZGVJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IF9wYXJlbnROb2RlID0gY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5wYXJlbnROb2RlID0gdGVtcFBhcmVudE5vZGVJRDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBjJHt0ZW1wUGFyZW50Tm9kZUlEfSA9IG5ldyB1dGlscy5WRG9tQXJyYXkoKTtgKTtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgYXR0ciBvZiBbXCJ0LXNldFwiLCBcInQtdmFsdWVcIiwgXCJ0LWlmXCIsIFwidC1lbHNlXCIsIFwidC1lbGlmXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlQ29weS5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcXdlYi5fY29tcGlsZU5vZGUobm9kZUNvcHksIGN0eCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke3F3ZWJ2YXIuZXhwcn0gPSBjJHt0ZW1wUGFyZW50Tm9kZUlEfWApO1xyXG4gICAgICAgICAgICBxd2VidmFyLnZhbHVlID0gYGMke3RlbXBQYXJlbnROb2RlSUR9YDtcclxuICAgICAgICAgICAgcXdlYnZhci5oYXNCb2R5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LnBhcmVudE5vZGUgPSBfcGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VJZigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1pZiwgdC1lbGlmLCB0LWVsc2VcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJpZlwiLFxyXG4gICAgcHJpb3JpdHk6IDIwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgY29uZCA9IGN0eC5nZXRWYWx1ZShub2RlLmdldEF0dHJpYnV0ZShcInQtaWZcIikpO1xyXG4gICAgICAgIGN0eC5hZGRJZih0eXBlb2YgY29uZCA9PT0gXCJzdHJpbmdcIiA/IGN0eC5mb3JtYXRFeHByZXNzaW9uKGNvbmQpIDogYHNjb3BlLiR7Y29uZC5pZH1gKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZmluYWxpemUoeyBjdHggfSkge1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICB9XHJcbn0pO1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImVsaWZcIixcclxuICAgIHByaW9yaXR5OiAzMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIGN0eCB9KSB7XHJcbiAgICAgICAgbGV0IGNvbmQgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWVsaWZcIikpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBlbHNlIGlmICgke3R5cGVvZiBjb25kID09PSBcInN0cmluZ1wiID8gY3R4LmZvcm1hdEV4cHJlc3Npb24oY29uZCkgOiBgc2NvcGUuJHtjb25kLmlkfWB9KSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBmaW5hbGl6ZSh7IGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgIH1cclxufSk7XHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwiZWxzZVwiLFxyXG4gICAgcHJpb3JpdHk6IDQwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguYWRkTGluZShgZWxzZSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBmaW5hbGl6ZSh7IGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtY2FsbFxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImNhbGxcIixcclxuICAgIHByaW9yaXR5OiA1MCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgLy8gU3RlcCAxOiBzYW5pdHkgY2hlY2tzXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGlmIChub2RlLm5vZGVOYW1lICE9PSBcInRcIikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRhZyBmb3IgdC1jYWxsIGRpcmVjdGl2ZSAoc2hvdWxkIGJlICd0JylcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHN1YlRlbXBsYXRlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWNhbGxcIik7XHJcbiAgICAgICAgY29uc3Qgbm9kZVRlbXBsYXRlID0gcXdlYi50ZW1wbGF0ZXNbc3ViVGVtcGxhdGVdO1xyXG4gICAgICAgIGlmICghbm9kZVRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGZpbmQgdGVtcGxhdGUgXCIke3N1YlRlbXBsYXRlfVwiICh0LWNhbGwpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFN0ZXAgMjogY29tcGlsZSB0YXJnZXQgdGVtcGxhdGUgaW4gc3ViIHRlbXBsYXRlc1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGlmICghcXdlYi5zdWJUZW1wbGF0ZXNbc3ViVGVtcGxhdGVdKSB7XHJcbiAgICAgICAgICAgIHF3ZWIuc3ViVGVtcGxhdGVzW3N1YlRlbXBsYXRlXSA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHN1YlRlbXBsYXRlRm4gPSBxd2ViLl9jb21waWxlKHN1YlRlbXBsYXRlLCBub2RlVGVtcGxhdGUuZWxlbSwgY3R4LCB0cnVlKTtcclxuICAgICAgICAgICAgcXdlYi5zdWJUZW1wbGF0ZXNbc3ViVGVtcGxhdGVdID0gc3ViVGVtcGxhdGVGbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU3RlcCAzOiBjb21waWxlIHQtY2FsbCBib2R5IGlmIG5lY2Vzc2FyeVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGxldCBoYXNCb2R5ID0gbm9kZS5oYXNDaGlsZE5vZGVzKCk7XHJcbiAgICAgICAgbGV0IHByb3RlY3RJRDtcclxuICAgICAgICBpZiAoaGFzQm9keSkge1xyXG4gICAgICAgICAgICAvLyB3ZSBhZGQgYSBzdWIgc2NvcGUgdG8gcHJvdGVjdCB0aGUgYW1iaWVudCBzY29wZVxyXG4gICAgICAgICAgICBjdHguYWRkTGluZShge2ApO1xyXG4gICAgICAgICAgICBjdHguaW5kZW50KCk7XHJcbiAgICAgICAgICAgIHByb3RlY3RJRCA9IGN0eC5zdGFydFByb3RlY3RTY29wZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBub2RlQ29weSA9IG5vZGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIFtcInQtaWZcIiwgXCJ0LWVsc2VcIiwgXCJ0LWVsaWZcIiwgXCJ0LWNhbGxcIl0pIHtcclxuICAgICAgICAgICAgICAgIG5vZGVDb3B5LnJlbW92ZUF0dHJpYnV0ZShhdHRyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5wYXJlbnROb2RlID0gXCJfXzBcIjtcclxuICAgICAgICAgICAgLy8gdGhpcyBsb2NhbCBzY29wZSBpcyBpbnRlbmRlZCB0byB0cmFwIGNfXzBcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHtgKTtcclxuICAgICAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShcImxldCBjX18wID0gW107XCIpO1xyXG4gICAgICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoXCJzY29wZVt1dGlscy56ZXJvXSA9IGNfXzA7XCIpO1xyXG4gICAgICAgICAgICBjdHgucGFyZW50Tm9kZSA9IHBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU3RlcCA0OiBhZGQgdGhlIGFwcHJvcHJpYXRlIGZ1bmN0aW9uIGNhbGwgdG8gY3VycmVudCBjb21wb25lbnRcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBjb25zdCBjYWxsaW5nU2NvcGUgPSBoYXNCb2R5ID8gXCJzY29wZVwiIDogXCJPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoY29udGV4dCksIHNjb3BlKVwiO1xyXG4gICAgICAgIGNvbnN0IHBhcmVudENvbXBvbmVudCA9IGB1dGlscy5nZXRDb21wb25lbnQoY29udGV4dClgO1xyXG4gICAgICAgIGNvbnN0IGtleSA9IGN0eC5nZW5lcmF0ZVRlbXBsYXRlS2V5KCk7XHJcbiAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGN0eC5wYXJlbnROb2RlID8gYGMke2N0eC5wYXJlbnROb2RlfWAgOiBcInJlc3VsdFwiO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhID0gYE9iamVjdC5hc3NpZ24oe30sIGV4dHJhLCB7cGFyZW50Tm9kZTogJHtwYXJlbnROb2RlfSwgcGFyZW50OiAke3BhcmVudENvbXBvbmVudH0sIGtleTogJHtrZXl9fSlgO1xyXG4gICAgICAgIGlmIChjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgdGhpcy5zdWJUZW1wbGF0ZXNbJyR7c3ViVGVtcGxhdGV9J10uY2FsbCh0aGlzLCAke2NhbGxpbmdTY29wZX0sICR7ZXh0cmF9KTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSB0LWNhbGwgd2l0aCBubyBwYXJlbnRub2RlLCB3ZSBuZWVkIHRvIGV4dHJhY3QgdGhlIHJlc3VsdFxyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IFtdYCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB0aGlzLnN1YlRlbXBsYXRlc1snJHtzdWJUZW1wbGF0ZX0nXS5jYWxsKHRoaXMsICR7Y2FsbGluZ1Njb3BlfSwgJHtleHRyYX0pO2ApO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcmVzdWx0ID0gcmVzdWx0WzBdYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFN0ZXAgNTogcmVzdG9yZSBwcmV2aW91cyBzY29wZVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGlmIChoYXNCb2R5KSB7XHJcbiAgICAgICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCk7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0LWZvcmVhY2hcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJmb3JlYWNoXCIsXHJcbiAgICBleHRyYU5hbWVzOiBbXCJhc1wiXSxcclxuICAgIHByaW9yaXR5OiAxMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjdHggPSBjdHguc3ViQ29udGV4dChcImxvb3BOdW1iZXJcIiwgY3R4Lmxvb3BOdW1iZXIgKyAxKTtcclxuICAgICAgICBjb25zdCBlbGVtcyA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1mb3JlYWNoXCIpO1xyXG4gICAgICAgIGNvbnN0IG5hbWUgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXNcIik7XHJcbiAgICAgICAgbGV0IGFycmF5SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXJyYXlJRH0gPSAke2N0eC5mb3JtYXRFeHByZXNzaW9uKGVsZW1zKX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGlmICghXyR7YXJyYXlJRH0pIHsgdGhyb3cgbmV3IEVycm9yKCdRV2ViIGVycm9yOiBJbnZhbGlkIGxvb3AgZXhwcmVzc2lvbicpfWApO1xyXG4gICAgICAgIGxldCBrZXlzSUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGxldCB2YWx1ZXNJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHtrZXlzSUR9ID0gXyR7dmFsdWVzSUR9ID0gXyR7YXJyYXlJRH07YCk7XHJcbiAgICAgICAgY3R4LmFkZElmKGAhKF8ke2FycmF5SUR9IGluc3RhbmNlb2YgQXJyYXkpYCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYF8ke2tleXNJRH0gPSBPYmplY3Qua2V5cyhfJHthcnJheUlEfSk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYF8ke3ZhbHVlc0lEfSA9IE9iamVjdC52YWx1ZXMoXyR7YXJyYXlJRH0pO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfbGVuZ3RoJHtrZXlzSUR9ID0gXyR7a2V5c0lEfS5sZW5ndGg7YCk7XHJcbiAgICAgICAgbGV0IHZhcnNJRCA9IGN0eC5zdGFydFByb3RlY3RTY29wZSh0cnVlKTtcclxuICAgICAgICBjb25zdCBsb29wVmFyID0gYGkke2N0eC5sb29wTnVtYmVyfWA7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGZvciAobGV0ICR7bG9vcFZhcn0gPSAwOyAke2xvb3BWYXJ9IDwgX2xlbmd0aCR7a2V5c0lEfTsgJHtsb29wVmFyfSsrKSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2ZpcnN0ID0gJHtsb29wVmFyfSA9PT0gMGApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2xhc3QgPSAke2xvb3BWYXJ9ID09PSBfbGVuZ3RoJHtrZXlzSUR9IC0gMWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2luZGV4ID0gJHtsb29wVmFyfWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9ID0gXyR7a2V5c0lEfVske2xvb3BWYXJ9XWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X3ZhbHVlID0gXyR7dmFsdWVzSUR9WyR7bG9vcFZhcn1dYCk7XHJcbiAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICBsZXQgc2hvdWxkV2FybiA9ICFub2RlQ29weS5oYXNBdHRyaWJ1dGUoXCJ0LWtleVwiKSAmJlxyXG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJlxyXG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuWzBdLnRhZ05hbWUgIT09IFwidFwiICYmXHJcbiAgICAgICAgICAgICFub2RlLmNoaWxkcmVuWzBdLmhhc0F0dHJpYnV0ZShcInQta2V5XCIpO1xyXG4gICAgICAgIGlmIChzaG91bGRXYXJuKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgRGlyZWN0aXZlIHQtZm9yZWFjaCBzaG91bGQgYWx3YXlzIGJlIHVzZWQgd2l0aCBhIHQta2V5ISAoaW4gdGVtcGxhdGU6ICcke2N0eC50ZW1wbGF0ZU5hbWV9JylgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5vZGVDb3B5Lmhhc0F0dHJpYnV0ZShcInQta2V5XCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cHIgPSBjdHguZm9ybWF0RXhwcmVzc2lvbihub2RlQ29weS5nZXRBdHRyaWJ1dGUoXCJ0LWtleVwiKSk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQga2V5JHtjdHgubG9vcE51bWJlcn0gPSAke2V4cHJ9O2ApO1xyXG4gICAgICAgICAgICBub2RlQ29weS5yZW1vdmVBdHRyaWJ1dGUoXCJ0LWtleVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQga2V5JHtjdHgubG9vcE51bWJlcn0gPSBpJHtjdHgubG9vcE51bWJlcn07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5vZGVDb3B5LnJlbW92ZUF0dHJpYnV0ZShcInQtZm9yZWFjaFwiKTtcclxuICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICBjdHguZGVkZW50KCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ9XCIpO1xyXG4gICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHZhcnNJRCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0LWRlYnVnXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwiZGVidWdcIixcclxuICAgIHByaW9yaXR5OiAxLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguYWRkTGluZShcImRlYnVnZ2VyO1wiKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtbG9nXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwibG9nXCIsXHJcbiAgICBwcmlvcml0eTogMSxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUgfSkge1xyXG4gICAgICAgIGNvbnN0IGV4cHIgPSBjdHguZm9ybWF0RXhwcmVzc2lvbih2YWx1ZSk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGNvbnNvbGUubG9nKCR7ZXhwcn0pYCk7XHJcbiAgICB9XHJcbn0pO1xuXG4vKipcclxuICogT3dsIFFXZWIgRXh0ZW5zaW9uc1xyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgdGhlIGltcGxlbWVudGF0aW9uIG9mIG5vbiBzdGFuZGFyZCBRV2ViIGRpcmVjdGl2ZXMsIGFkZGVkXHJcbiAqIGJ5IE93bCBhbmQgdGhhdCB3aWxsIG9ubHkgd29yayBvbiBPd2wgcHJvamVjdHM6XHJcbiAqXHJcbiAqIC0gdC1vblxyXG4gKiAtIHQtcmVmXHJcbiAqIC0gdC10cmFuc2l0aW9uXHJcbiAqIC0gdC1tb3VudGVkXHJcbiAqIC0gdC1zbG90XHJcbiAqIC0gdC1tb2RlbFxyXG4gKi9cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1vblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0aGVzZSBhcmUgcGllY2VzIG9mIGNvZGUgdGhhdCB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGV2ZW50IGhhbmRsZXIgaWZcclxuLy8gbW9kaWZpZXJzIGFyZSBzcGVjaWZpZWRcclxuY29uc3QgTU9EU19DT0RFID0ge1xyXG4gICAgcHJldmVudDogXCJlLnByZXZlbnREZWZhdWx0KCk7XCIsXHJcbiAgICBzZWxmOiBcImlmIChlLnRhcmdldCAhPT0gdGhpcy5lbG0pIHtyZXR1cm59XCIsXHJcbiAgICBzdG9wOiBcImUuc3RvcFByb3BhZ2F0aW9uKCk7XCJcclxufTtcclxuY29uc3QgRk5BTUVSRUdFWFAgPSAvXlskQS1aX11bMC05QS1aXyRdKiQvaTtcclxuZnVuY3Rpb24gbWFrZUhhbmRsZXJDb2RlKGN0eCwgZnVsbE5hbWUsIHZhbHVlLCBwdXRJbkNhY2hlLCBtb2Rjb2RlcyA9IE1PRFNfQ09ERSkge1xyXG4gICAgbGV0IFtldmVudCwgLi4ubW9kc10gPSBmdWxsTmFtZS5zbGljZSg1KS5zcGxpdChcIi5cIik7XHJcbiAgICBpZiAobW9kcy5pbmNsdWRlcyhcImNhcHR1cmVcIikpIHtcclxuICAgICAgICBldmVudCA9IFwiIVwiICsgZXZlbnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoIWV2ZW50KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBldmVudCBuYW1lIHdpdGggdC1vbiBkaXJlY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICBsZXQgY29kZTtcclxuICAgIC8vIGNoZWNrIGlmIGl0IGlzIGEgbWV0aG9kIHdpdGggbm8gYXJncywgYSBtZXRob2Qgd2l0aCBhcmdzIG9yIGFuIGV4cHJlc3Npb25cclxuICAgIGxldCBhcmdzID0gXCJcIjtcclxuICAgIGNvbnN0IG5hbWUgPSB2YWx1ZS5yZXBsYWNlKC9cXCguKlxcKS8sIGZ1bmN0aW9uIChfYXJncykge1xyXG4gICAgICAgIGFyZ3MgPSBfYXJncy5zbGljZSgxLCAtMSk7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGlzTWV0aG9kQ2FsbCA9IG5hbWUubWF0Y2goRk5BTUVSRUdFWFApO1xyXG4gICAgLy8gdGhlbiBnZW5lcmF0ZSBjb2RlXHJcbiAgICBpZiAoaXNNZXRob2RDYWxsKSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCBjb21wID0gYHV0aWxzLmdldENvbXBvbmVudChjb250ZXh0KWA7XHJcbiAgICAgICAgaWYgKGFyZ3MpIHtcclxuICAgICAgICAgICAgY29uc3QgYXJnSWQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IGFyZ3Mke2FyZ0lkfSA9IFske2N0eC5mb3JtYXRFeHByZXNzaW9uKGFyZ3MpfV07YCk7XHJcbiAgICAgICAgICAgIGNvZGUgPSBgJHtjb21wfVsnJHtuYW1lfSddKC4uLmFyZ3Mke2FyZ0lkfSwgZSk7YDtcclxuICAgICAgICAgICAgcHV0SW5DYWNoZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29kZSA9IGAke2NvbXB9Wycke25hbWV9J10oZSk7YDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBpZiB3ZSBnZXQgaGVyZSwgdGhlbiBpdCBpcyBhbiBleHByZXNzaW9uXHJcbiAgICAgICAgLy8gd2UgbmVlZCB0byBjYXB0dXJlIGV2ZXJ5IHZhcmlhYmxlIGluIGl0XHJcbiAgICAgICAgcHV0SW5DYWNoZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvZGUgPSBjdHguY2FwdHVyZUV4cHJlc3Npb24odmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbW9kQ29kZSA9IG1vZHMubWFwKG1vZCA9PiBtb2Rjb2Rlc1ttb2RdKS5qb2luKFwiXCIpO1xyXG4gICAgbGV0IGhhbmRsZXIgPSBgZnVuY3Rpb24gKGUpIHtpZiAoIWNvbnRleHQuX19vd2xfXy5pc01vdW50ZWQpe3JldHVybn0ke21vZENvZGV9JHtjb2RlfX1gO1xyXG4gICAgaWYgKHB1dEluQ2FjaGUpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBjdHguZ2VuZXJhdGVUZW1wbGF0ZUtleShldmVudCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGV4dHJhLmhhbmRsZXJzWyR7a2V5fV0gPSBleHRyYS5oYW5kbGVyc1ske2tleX1dIHx8ICR7aGFuZGxlcn07YCk7XHJcbiAgICAgICAgaGFuZGxlciA9IGBleHRyYS5oYW5kbGVyc1ske2tleX1dYDtcclxuICAgIH1cclxuICAgIHJldHVybiB7IGV2ZW50LCBoYW5kbGVyIH07XHJcbn1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJvblwiLFxyXG4gICAgcHJpb3JpdHk6IDkwLFxyXG4gICAgYXROb2RlQ3JlYXRpb24oeyBjdHgsIGZ1bGxOYW1lLCB2YWx1ZSwgbm9kZUlEIH0pIHtcclxuICAgICAgICBjb25zdCB7IGV2ZW50LCBoYW5kbGVyIH0gPSBtYWtlSGFuZGxlckNvZGUoY3R4LCBmdWxsTmFtZSwgdmFsdWUsIHRydWUpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9Lm9uWycke2V2ZW50fSddID0gJHtoYW5kbGVyfTtgKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtcmVmXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwicmVmXCIsXHJcbiAgICBwcmlvcml0eTogOTUsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgdmFsdWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVmcyA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgcmVmS2V5ID0gYHJlZiR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBjb25zdCAke3JlZktleX0gPSAke2N0eC5pbnRlcnBvbGF0ZSh2YWx1ZSl9O2ApO1xyXG4gICAgICAgIGFkZE5vZGVIb29rKFwiY3JlYXRlXCIsIGBjb250ZXh0Ll9fb3dsX18ucmVmc1ske3JlZktleX1dID0gbi5lbG07YCk7XHJcbiAgICAgICAgYWRkTm9kZUhvb2soXCJkZXN0cm95XCIsIGBkZWxldGUgY29udGV4dC5fX293bF9fLnJlZnNbJHtyZWZLZXl9XTtgKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtdHJhbnNpdGlvblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLnV0aWxzLm5leHRGcmFtZSA9IGZ1bmN0aW9uIChjYikge1xyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShjYikpO1xyXG59O1xyXG5RV2ViLnV0aWxzLnRyYW5zaXRpb25JbnNlcnQgPSBmdW5jdGlvbiAodm4sIG5hbWUpIHtcclxuICAgIGNvbnN0IGVsbSA9IHZuLmVsbTtcclxuICAgIC8vIHJlbW92ZSBwb3RlbnRpYWwgZHVwbGljYXRlZCB2bm9kZSB0aGF0IGlzIGN1cnJlbnRseSBiZWluZyByZW1vdmVkLCB0b1xyXG4gICAgLy8gcHJldmVudCBmcm9tIGhhdmluZyB0d2ljZSB0aGUgc2FtZSBub2RlIGluIHRoZSBET00gZHVyaW5nIGFuIGFuaW1hdGlvblxyXG4gICAgY29uc3QgZHVwID0gZWxtLnBhcmVudEVsZW1lbnQgJiYgZWxtLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihgKltkYXRhLW93bC1rZXk9JyR7dm4ua2V5fSddYCk7XHJcbiAgICBpZiAoZHVwKSB7XHJcbiAgICAgICAgZHVwLnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWVudGVyXCIpO1xyXG4gICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWVudGVyLWFjdGl2ZVwiKTtcclxuICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1sZWF2ZS1hY3RpdmVcIik7XHJcbiAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmUtdG9cIik7XHJcbiAgICBjb25zdCBmaW5hbGl6ZSA9ICgpID0+IHtcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItZW50ZXItYWN0aXZlXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1lbnRlci10b1wiKTtcclxuICAgIH07XHJcbiAgICB0aGlzLm5leHRGcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgZWxtLmNsYXNzTGlzdC5yZW1vdmUobmFtZSArIFwiLWVudGVyXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QuYWRkKG5hbWUgKyBcIi1lbnRlci10b1wiKTtcclxuICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZChlbG0sIGZpbmFsaXplKTtcclxuICAgIH0pO1xyXG59O1xyXG5RV2ViLnV0aWxzLnRyYW5zaXRpb25SZW1vdmUgPSBmdW5jdGlvbiAodm4sIG5hbWUsIHJtKSB7XHJcbiAgICBjb25zdCBlbG0gPSB2bi5lbG07XHJcbiAgICBlbG0uc2V0QXR0cmlidXRlKFwiZGF0YS1vd2wta2V5XCIsIHZuLmtleSk7XHJcbiAgICBlbG0uY2xhc3NMaXN0LmFkZChuYW1lICsgXCItbGVhdmVcIik7XHJcbiAgICBlbG0uY2xhc3NMaXN0LmFkZChuYW1lICsgXCItbGVhdmUtYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgZmluYWxpemUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFlbG0uY2xhc3NMaXN0LmNvbnRhaW5zKG5hbWUgKyBcIi1sZWF2ZS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmUtYWN0aXZlXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1sZWF2ZS10b1wiKTtcclxuICAgICAgICBybSgpO1xyXG4gICAgfTtcclxuICAgIHRoaXMubmV4dEZyYW1lKCgpID0+IHtcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmVcIik7XHJcbiAgICAgICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWxlYXZlLXRvXCIpO1xyXG4gICAgICAgIHdoZW5UcmFuc2l0aW9uRW5kKGVsbSwgZmluYWxpemUpO1xyXG4gICAgfSk7XHJcbn07XHJcbmZ1bmN0aW9uIGdldFRpbWVvdXQoZGVsYXlzLCBkdXJhdGlvbnMpIHtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbiAgICB3aGlsZSAoZGVsYXlzLmxlbmd0aCA8IGR1cmF0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICBkZWxheXMgPSBkZWxheXMuY29uY2F0KGRlbGF5cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkobnVsbCwgZHVyYXRpb25zLm1hcCgoZCwgaSkgPT4ge1xyXG4gICAgICAgIHJldHVybiB0b01zKGQpICsgdG9NcyhkZWxheXNbaV0pO1xyXG4gICAgfSkpO1xyXG59XHJcbi8vIE9sZCB2ZXJzaW9ucyBvZiBDaHJvbWl1bSAoYmVsb3cgNjEuMC4zMTYzLjEwMCkgZm9ybWF0cyBmbG9hdGluZyBwb2ludGVyIG51bWJlcnNcclxuLy8gaW4gYSBsb2NhbGUtZGVwZW5kZW50IHdheSwgdXNpbmcgYSBjb21tYSBpbnN0ZWFkIG9mIGEgZG90LlxyXG4vLyBJZiBjb21tYSBpcyBub3QgcmVwbGFjZWQgd2l0aCBhIGRvdCwgdGhlIGlucHV0IHdpbGwgYmUgcm91bmRlZCBkb3duIChpLmUuIGFjdGluZ1xyXG4vLyBhcyBhIGZsb29yIGZ1bmN0aW9uKSBjYXVzaW5nIHVuZXhwZWN0ZWQgYmVoYXZpb3JzXHJcbmZ1bmN0aW9uIHRvTXMocykge1xyXG4gICAgcmV0dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKS5yZXBsYWNlKFwiLFwiLCBcIi5cIikpICogMTAwMDtcclxufVxyXG5mdW5jdGlvbiB3aGVuVHJhbnNpdGlvbkVuZChlbG0sIGNiKSB7XHJcbiAgICBpZiAoIWVsbS5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgLy8gaWYgd2UgZ2V0IGhlcmUsIHRoaXMgbWVhbnMgdGhhdCB0aGUgZWxlbWVudCB3YXMgcmVtb3ZlZCBmb3Igc29tZSBvdGhlclxyXG4gICAgICAgIC8vIHJlYXNvbnMsIGFuZCBpbiB0aGF0IGNhc2UsIHdlIGRvbid0IHdhbnQgdG8gd29yayBvbiBhbmltYXRpb24gc2luY2Ugbm90aGluZ1xyXG4gICAgICAgIC8vIHdpbGwgYmUgZGlzcGxheWVkIGFueXdheS5cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbG0pO1xyXG4gICAgY29uc3QgZGVsYXlzID0gKHN0eWxlcy50cmFuc2l0aW9uRGVsYXkgfHwgXCJcIikuc3BsaXQoXCIsIFwiKTtcclxuICAgIGNvbnN0IGR1cmF0aW9ucyA9IChzdHlsZXMudHJhbnNpdGlvbkR1cmF0aW9uIHx8IFwiXCIpLnNwbGl0KFwiLCBcIik7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gZ2V0VGltZW91dChkZWxheXMsIGR1cmF0aW9ucyk7XHJcbiAgICBpZiAodGltZW91dCA+IDApIHtcclxuICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgY2IsIHsgb25jZTogdHJ1ZSB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNiKCk7XHJcbiAgICB9XHJcbn1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJ0cmFuc2l0aW9uXCIsXHJcbiAgICBwcmlvcml0eTogOTYsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgdmFsdWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGxldCBuYW1lID0gdmFsdWU7XHJcbiAgICAgICAgY29uc3QgaG9va3MgPSB7XHJcbiAgICAgICAgICAgIGluc2VydDogYHV0aWxzLnRyYW5zaXRpb25JbnNlcnQodm4sICcke25hbWV9Jyk7YCxcclxuICAgICAgICAgICAgcmVtb3ZlOiBgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgJyR7bmFtZX0nLCBybSk7YFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yIChsZXQgaG9va05hbWUgaW4gaG9va3MpIHtcclxuICAgICAgICAgICAgYWRkTm9kZUhvb2soaG9va05hbWUsIGhvb2tzW2hvb2tOYW1lXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1zbG90XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwic2xvdFwiLFxyXG4gICAgcHJpb3JpdHk6IDgwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4LCB2YWx1ZSwgbm9kZSwgcXdlYiB9KSB7XHJcbiAgICAgICAgY29uc3Qgc2xvdEtleSA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0IHNsb3Qke3Nsb3RLZXl9ID0gdGhpcy5jb25zdHJ1Y3Rvci5zbG90c1tjb250ZXh0Ll9fb3dsX18uc2xvdElkICsgJ18nICsgJyR7dmFsdWV9J107YCk7XHJcbiAgICAgICAgY3R4LmFkZElmKGBzbG90JHtzbG90S2V5fWApO1xyXG4gICAgICAgIGxldCBwYXJlbnROb2RlID0gYGMke2N0eC5wYXJlbnROb2RlfWA7XHJcbiAgICAgICAgaWYgKCFjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGBjaGlsZHJlbiR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0ICR7cGFyZW50Tm9kZX09IFtdYCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB7fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgc2xvdCR7c2xvdEtleX0uY2FsbCh0aGlzLCBjb250ZXh0Ll9fb3dsX18uc2NvcGUsIE9iamVjdC5hc3NpZ24oe30sIGV4dHJhLCB7cGFyZW50Tm9kZTogJHtwYXJlbnROb2RlfSwgcGFyZW50OiBleHRyYS5wYXJlbnQgfHwgY29udGV4dH0pKTtgKTtcclxuICAgICAgICBpZiAoIWN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB1dGlscy5kZWZpbmVQcm94eShyZXN1bHQsICR7cGFyZW50Tm9kZX1bMF0pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobm9kZS5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgICAgICAgY3R4LmFkZEVsc2UoKTtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgbm9kZUNvcHkucmVtb3ZlQXR0cmlidXRlKFwidC1zbG90XCIpO1xyXG4gICAgICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtbW9kZWxcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi51dGlscy50b051bWJlciA9IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHZhbCk7XHJcbiAgICByZXR1cm4gaXNOYU4obikgPyB2YWwgOiBuO1xyXG59O1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcIm1vZGVsXCIsXHJcbiAgICBwcmlvcml0eTogNDIsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgbm9kZUlELCB2YWx1ZSwgbm9kZSwgZnVsbE5hbWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjb25zdCB0eXBlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpO1xyXG4gICAgICAgIGxldCBoYW5kbGVyO1xyXG4gICAgICAgIGxldCBldmVudCA9IGZ1bGxOYW1lLmluY2x1ZGVzKFwiLmxhenlcIikgPyBcImNoYW5nZVwiIDogXCJpbnB1dFwiO1xyXG4gICAgICAgIC8vIHdlIGtlZXAgaGVyZSBhIHJlZmVyZW5jZSB0byB0aGUgXCJiYXNlIGV4cHJlc3Npb25cIiAoaWYgdGhlIGV4cHJlc3Npb25cclxuICAgICAgICAvLyBpcyBgdC1tb2RlbD1cInNvbWUuZXhwci52YWx1ZVwiLCB0aGVuIHRoZSBiYXNlIGV4cHJlc3Npb24gaXMgXCJzb21lLmV4cHJcIikuXHJcbiAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3Nhcnkgc28gd2UgY2FuIGNhcHR1cmUgaXQgaW4gdGhlIGhhbmRsZXIgY2xvc3VyZS5cclxuICAgICAgICBsZXQgZXhwciA9IGN0eC5mb3JtYXRFeHByZXNzaW9uKHZhbHVlKTtcclxuICAgICAgICBjb25zdCBpbmRleCA9IGV4cHIubGFzdEluZGV4T2YoXCIuXCIpO1xyXG4gICAgICAgIGNvbnN0IGJhc2VFeHByID0gZXhwci5zbGljZSgwLCBpbmRleCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBleHByJHtub2RlSUR9ID0gJHtiYXNlRXhwcn07YCk7XHJcbiAgICAgICAgZXhwciA9IGBleHByJHtub2RlSUR9LiR7ZXhwci5zbGljZShpbmRleCArIDEpfWA7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gY3R4LmdlbmVyYXRlVGVtcGxhdGVLZXkoKTtcclxuICAgICAgICBpZiAobm9kZS50YWdOYW1lID09PSBcInNlbGVjdFwiKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9LnByb3BzID0ge3ZhbHVlOiAke2V4cHJ9fTtgKTtcclxuICAgICAgICAgICAgYWRkTm9kZUhvb2soXCJjcmVhdGVcIiwgYG4uZWxtLnZhbHVlPSR7ZXhwcn07YCk7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gXCJjaGFuZ2VcIjtcclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gZXYudGFyZ2V0LnZhbHVlfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IFwiY2hlY2tib3hcIikge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5wcm9wcyA9IHtjaGVja2VkOiAke2V4cHJ9fTtgKTtcclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gZXYudGFyZ2V0LmNoZWNrZWR9YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gXCJyYWRpb1wiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9LnByb3BzID0ge2NoZWNrZWQ6JHtleHByfSA9PT0gJyR7bm9kZVZhbHVlfSd9O2ApO1xyXG4gICAgICAgICAgICBoYW5kbGVyID0gYChldikgPT4geyR7ZXhwcn0gPSBldi50YXJnZXQudmFsdWV9YDtcclxuICAgICAgICAgICAgZXZlbnQgPSBcImNsaWNrXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5wcm9wcyA9IHt2YWx1ZTogJHtleHByfX07YCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyaW1Db2RlID0gZnVsbE5hbWUuaW5jbHVkZXMoXCIudHJpbVwiKSA/IFwiLnRyaW0oKVwiIDogXCJcIjtcclxuICAgICAgICAgICAgbGV0IHZhbHVlQ29kZSA9IGBldi50YXJnZXQudmFsdWUke3RyaW1Db2RlfWA7XHJcbiAgICAgICAgICAgIGlmIChmdWxsTmFtZS5pbmNsdWRlcyhcIi5udW1iZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVVdGlscyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZUNvZGUgPSBgdXRpbHMudG9OdW1iZXIoJHt2YWx1ZUNvZGV9KWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gJHt2YWx1ZUNvZGV9fWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBleHRyYS5oYW5kbGVyc1ske2tleX1dID0gZXh0cmEuaGFuZGxlcnNbJHtrZXl9XSB8fCAoJHtoYW5kbGVyfSk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0ub25bJyR7ZXZlbnR9J10gPSBleHRyYS5oYW5kbGVyc1ske2tleX1dO2ApO1xyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1rZXlcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJrZXlcIixcclxuICAgIHByaW9yaXR5OiA0NSxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUsIG5vZGUgfSkge1xyXG4gICAgICAgIGlmIChjdHgubG9vcE51bWJlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBjdHgua2V5U3RhY2sucHVzaChjdHgucm9vdENvbnRleHQuaGFzS2V5MCk7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5oYXNLZXkwID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ7XCIpO1xyXG4gICAgICAgIGN0eC5pbmRlbnQoKTtcclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGtleSR7Y3R4Lmxvb3BOdW1iZXJ9ID0gJHtjdHguZm9ybWF0RXhwcmVzc2lvbih2YWx1ZSl9O2ApO1xyXG4gICAgfSxcclxuICAgIGZpbmFsaXplKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguZGVkZW50KCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ9XCIpO1xyXG4gICAgICAgIGlmIChjdHgubG9vcE51bWJlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuaGFzS2V5MCA9IGN0eC5rZXlTdGFjay5wb3AoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xuXG5jb25zdCBjb25maWcgPSB7fTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvbmZpZywgXCJtb2RlXCIsIHtcclxuICAgIGdldCgpIHtcclxuICAgICAgICByZXR1cm4gUVdlYi5kZXYgPyBcImRldlwiIDogXCJwcm9kXCI7XHJcbiAgICB9LFxyXG4gICAgc2V0KG1vZGUpIHtcclxuICAgICAgICBRV2ViLmRldiA9IG1vZGUgPT09IFwiZGV2XCI7XHJcbiAgICAgICAgaWYgKFFXZWIuZGV2KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL2dpdGh1Yi5jb20vb2Rvby9vd2wvYmxvYi9tYXN0ZXIvZG9jL3JlZmVyZW5jZS9jb25maWcubWQjbW9kZWA7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgT3dsIGlzIHJ1bm5pbmcgaW4gJ2RldicgbW9kZS4gIFRoaXMgaXMgbm90IHN1aXRhYmxlIGZvciBwcm9kdWN0aW9uIHVzZS4gU2VlICR7dXJsfSBmb3IgbW9yZSBpbmZvcm1hdGlvbi5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBPd2wgaXMgbm93IHJ1bm5pbmcgaW4gJ3Byb2QnIG1vZGUuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcblxuLyoqXHJcbiAqIFdlIGRlZmluZSBoZXJlIE93bEV2ZW50LCBhIHN1YmNsYXNzIG9mIEN1c3RvbUV2ZW50LCB3aXRoIGFuIGFkZGl0aW9uYWxcclxuICogYXR0cmlidXRlOlxyXG4gKiAgLSBvcmlnaW5hbENvbXBvbmVudDogdGhlIGNvbXBvbmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnRcclxuICovXHJcbmNsYXNzIE93bEV2ZW50IGV4dGVuZHMgQ3VzdG9tRXZlbnQge1xyXG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBldmVudFR5cGUsIG9wdGlvbnMpIHtcclxuICAgICAgICBzdXBlcihldmVudFR5cGUsIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxDb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICB9XHJcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1jb21wb25lbnRcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgVF9DT01QT05FTlRfTU9EU19DT0RFID0gT2JqZWN0LmFzc2lnbih7fSwgTU9EU19DT0RFLCB7XHJcbiAgICBzZWxmOiBcImlmIChlLnRhcmdldCAhPT0gdm4uZWxtKSB7cmV0dXJufVwiXHJcbn0pO1xyXG5RV2ViLnV0aWxzLmRlZmluZVByb3h5ID0gZnVuY3Rpb24gZGVmaW5lUHJveHkodGFyZ2V0LCBzb3VyY2UpIHtcclxuICAgIGZvciAobGV0IGsgaW4gc291cmNlKSB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgaywge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlW2tdO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQodmFsKSB7XHJcbiAgICAgICAgICAgICAgICBzb3VyY2Vba10gPSB2YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufTtcclxuUVdlYi51dGlscy5hc3NpZ25Ib29rcyA9IGZ1bmN0aW9uIGFzc2lnbkhvb2tzKGRhdGFPYmosIGhvb2tzKSB7XHJcbiAgICBpZiAoXCJob29rXCIgaW4gZGF0YU9iaikge1xyXG4gICAgICAgIGNvbnN0IGhvb2tPYmplY3QgPSBkYXRhT2JqLmhvb2s7XHJcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiBob29rcykge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gaG9va09iamVjdFtuYW1lXTtcclxuICAgICAgICAgICAgY29uc3QgZm4gPSBob29rc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGhvb2tPYmplY3RbbmFtZV0gPSAoLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQoLi4uYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4oLi4uYXJncyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaG9va09iamVjdFtuYW1lXSA9IGZuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgZGF0YU9iai5ob29rID0gaG9va3M7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgdC1jb21wb25lbnQgZGlyZWN0aXZlIGlzIGNlcnRhaW5seSBhIGNvbXBsaWNhdGVkIGFuZCBoYXJkIHRvIG1haW50YWluIHBpZWNlXHJcbiAqIG9mIGNvZGUuICBUbyBoZWxwIHlvdSwgZmVsbG93IGRldmVsb3BlciwgaWYgeW91IGhhdmUgdG8gbWFpbnRhaW4gaXQsIEkgb2ZmZXJcclxuICogeW91IHRoaXMgYWR2aWNlOiBHb29kIGx1Y2suLi5cclxuICpcclxuICogU2luY2UgaXQgaXMgbm90ICdkaXJlY3QnIGNvZGUsIGJ1dCByYXRoZXIgY29kZSB0aGF0IGdlbmVyYXRlcyBvdGhlciBjb2RlLCBpdFxyXG4gKiBpcyBub3QgZWFzeSB0byB1bmRlcnN0YW5kLiAgVG8gaGVscCB5b3UsIGhlcmUgIGlzIGEgZGV0YWlsZWQgYW5kIGNvbW1lbnRlZFxyXG4gKiBleHBsYW5hdGlvbiBvZiB0aGUgY29kZSBnZW5lcmF0ZWQgYnkgdGhlIHQtY29tcG9uZW50IGRpcmVjdGl2ZSBmb3IgdGhlIGZvbGxvd2luZ1xyXG4gKiBzaXR1YXRpb246XHJcbiAqIGBgYHhtbFxyXG4gKiAgIDxDaGlsZFxyXG4gKiAgICAgIHQta2V5PVwiJ3NvbWVzdHJpbmcnXCJcclxuICogICAgICBmbGFnPVwic3RhdGUuZmxhZ1wiXHJcbiAqICAgICAgdC10cmFuc2l0aW9uPVwiZmFkZVwiLz5cclxuICogYGBgXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIC8vIHdlIGFzc2lnbiB1dGlscyBvbiB0b3Agb2YgdGhlIGZ1bmN0aW9uIGJlY2F1c2UgaXQgd2lsbCBiZSB1c2VmdWwgZm9yXHJcbiAqIC8vIGVhY2ggY29tcG9uZW50c1xyXG4gKiBsZXQgdXRpbHMgPSB0aGlzLnV0aWxzO1xyXG4gKlxyXG4gKiAvLyB0aGlzIGlzIHRoZSB2aXJ0dWFsIG5vZGUgcmVwcmVzZW50aW5nIHRoZSBwYXJlbnQgZGl2XHJcbiAqIGxldCBjMSA9IFtdLCBwMSA9IHsga2V5OiAxIH07XHJcbiAqIHZhciB2bjEgPSBoKFwiZGl2XCIsIHAxLCBjMSk7XHJcbiAqXHJcbiAqIC8vIHQtY29tcG9uZW50IGRpcmVjdGl2ZTogd2Ugc3RhcnQgYnkgZXZhbHVhdGluZyB0aGUgZXhwcmVzc2lvbiBnaXZlbiBieSB0LWtleTpcclxuICogbGV0IGtleTUgPSBcInNvbWVzdHJpbmdcIjtcclxuICpcclxuICogLy8gZGVmMyBpcyB0aGUgcHJvbWlzZSB0aGF0IHdpbGwgY29udGFpbiBsYXRlciBlaXRoZXIgdGhlIG5ldyBjb21wb25lbnRcclxuICogLy8gY3JlYXRpb24sIG9yIHRoZSBwcm9wcyB1cGRhdGUuLi5cclxuICogbGV0IGRlZjM7XHJcbiAqXHJcbiAqIC8vIHRoaXMgaXMga2luZCBvZiB0cmlja3k6IHdlIG5lZWQgaGVyZSB0byBmaW5kIGlmIHRoZSBjb21wb25lbnQgd2FzIGFscmVhZHlcclxuICogLy8gY3JlYXRlZCBieSBhIHByZXZpb3VzIHJlbmRlcmluZy4gIFRoaXMgaXMgZG9uZSBieSBjaGVja2luZyB0aGUgaW50ZXJuYWxcclxuICogLy8gYGNtYXBgIChjaGlsZHJlbiBtYXApIG9mIHRoZSBwYXJlbnQgY29tcG9uZW50OiBpdCBtYXBzIGtleXMgdG8gY29tcG9uZW50IGlkcyxcclxuICogLy8gYW5kLCB0aGVuLCBpZiB0aGVyZSBpcyBhbiBpZCwgd2UgbG9vayBpbnRvIHRoZSBjaGlsZHJlbiBsaXN0IHRvIGdldCB0aGVcclxuICogLy8gaW5zdGFuY2VcclxuICogbGV0IHc0ID1cclxuICogICBrZXk1IGluIGNvbnRleHQuX19vd2xfXy5jbWFwXHJcbiAqICAgPyBjb250ZXh0Ll9fb3dsX18uY2hpbGRyZW5bY29udGV4dC5fX293bF9fLmNtYXBba2V5NV1dXHJcbiAqICAgOiBmYWxzZTtcclxuICpcclxuICogLy8gV2Uga2VlcCB0aGUgaW5kZXggb2YgdGhlIHBvc2l0aW9uIG9mIHRoZSBjb21wb25lbnQgaW4gdGhlIGNsb3N1cmUuICBXZSBwdXNoXHJcbiAqIC8vIG51bGwgdG8gcmVzZXJ2ZSB0aGUgc2xvdCwgYW5kIHdpbGwgcmVwbGFjZSBpdCBsYXRlciBieSB0aGUgY29tcG9uZW50IHZub2RlLFxyXG4gKiAvLyB3aGVuIGl0IHdpbGwgYmUgcmVhZHkgKGRvIG5vdCBmb3JnZXQgdGhhdCBwcmVwYXJpbmcvcmVuZGVyaW5nIGEgY29tcG9uZW50IGlzXHJcbiAqIC8vIGFzeW5jaHJvbm91cylcclxuICogbGV0IF8yX2luZGV4ID0gYzEubGVuZ3RoO1xyXG4gKiBjMS5wdXNoKG51bGwpO1xyXG4gKlxyXG4gKiAvLyB3ZSBldmFsdWF0ZSBoZXJlIHRoZSBwcm9wcyBnaXZlbiB0byB0aGUgY29tcG9uZW50LiBJdCBpcyBkb25lIGhlcmUgdG8gYmVcclxuICogLy8gYWJsZSB0byBlYXNpbHkgcmVmZXJlbmNlIGl0IGxhdGVyLCBhbmQgYWxzbywgaXQgbWlnaHQgYmUgYW4gZXhwZW5zaXZlXHJcbiAqIC8vIGNvbXB1dGF0aW9uLCBzbyBpdCBpcyBjZXJ0YWlubHkgYmV0dGVyIHRvIGRvIGl0IG9ubHkgb25jZVxyXG4gKiBsZXQgcHJvcHM0ID0geyBmbGFnOiBjb250ZXh0W1wic3RhdGVcIl0uZmxhZyB9O1xyXG4gKlxyXG4gKiAvLyBJZiB3ZSBoYXZlIGEgY29tcG9uZW50LCBjdXJyZW50bHkgcmVuZGVyaW5nLCBidXQgbm90IHJlYWR5IHlldCwgd2UgZG8gbm90IHdhbnRcclxuICogLy8gdG8gd2FpdCBmb3IgaXQgdG8gYmUgcmVhZHkgaWYgd2UgY2FuIGF2b2lkIGl0XHJcbiAqIGlmICh3NCAmJiB3NC5fX293bF9fLnJlbmRlclByb21pc2UgJiYgIXc0Ll9fb3dsX18udm5vZGUpIHtcclxuICogICAvLyB3ZSBjaGVjayBpZiB0aGUgcHJvcHMgYXJlIHRoZSBzYW1lLiAgSW4gdGhhdCBjYXNlLCB3ZSBjYW4gc2ltcGx5IHJldXNlXHJcbiAqICAgLy8gdGhlIHByZXZpb3VzIHJlbmRlcmluZyBhbmQgc2tpcCBhbGwgdXNlbGVzcyB3b3JrXHJcbiAqICAgaWYgKHV0aWxzLnNoYWxsb3dFcXVhbChwcm9wczQsIHc0Ll9fb3dsX18ucmVuZGVyUHJvcHMpKSB7XHJcbiAqICAgICBkZWYzID0gdzQuX19vd2xfXy5yZW5kZXJQcm9taXNlO1xyXG4gKiAgIH0gZWxzZSB7XHJcbiAqICAgICAvLyBpZiB0aGUgcHJvcHMgYXJlIG5vdCB0aGUgc2FtZSwgd2UgZGVzdHJveSB0aGUgY29tcG9uZW50IGFuZCBzdGFydHMgYW5ldy5cclxuICogICAgIC8vIHRoaXMgd2lsbCBiZSBmYXN0ZXIgdGhhbiB3YWl0aW5nIGZvciBpdHMgcmVuZGVyaW5nLCB0aGVuIHVwZGF0aW5nIGl0XHJcbiAqICAgICB3NC5kZXN0cm95KCk7XHJcbiAqICAgICB3NCA9IGZhbHNlO1xyXG4gKiAgIH1cclxuICogfVxyXG4gKlxyXG4gKiBpZiAoIXc0KSB7XHJcbiAqICAgLy8gaW4gdGhpcyBzaXR1YXRpb24sIHdlIG5lZWQgdG8gY3JlYXRlIGEgbmV3IGNvbXBvbmVudC4gIEZpcnN0IHN0ZXAgaXNcclxuICogICAvLyB0byBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGNsYXNzLCB0aGVuIGNyZWF0ZSBhbiBpbnN0YW5jZSB3aXRoXHJcbiAqICAgLy8gY3VycmVudCBjb250ZXh0IGFzIHBhcmVudCwgYW5kIHRoZSBwcm9wcy5cclxuICogICBsZXQgVzQgPSBjb250ZXh0LmNvbXBvbmVudCAmJiBjb250ZXh0LmNvbXBvbmVudHNbY29tcG9uZW50S2V5NF0gfHwgUVdlYi5jb21wb25lbnRbY29tcG9uZW50S2V5NF07XHJcblxyXG4gKiAgIGlmICghVzQpIHtcclxuICogICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIHRoZSBkZWZpbml0aW9uIG9mIGNvbXBvbmVudCAnY2hpbGQnXCIpO1xyXG4gKiAgIH1cclxuICogICB3NCA9IG5ldyBXNChvd25lciwgcHJvcHM0KTtcclxuICpcclxuICogICAvLyBXaGVuZXZlciB3ZSByZXJlbmRlciB0aGUgcGFyZW50IGNvbXBvbmVudCwgd2UgbmVlZCB0byBiZSBzdXJlIHRoYXQgd2VcclxuICogICAvLyBhcmUgYWJsZSB0byBmaW5kIHRoZSBjb21wb25lbnQgaW5zdGFuY2UuIFRvIGRvIHRoYXQsIHdlIHJlZ2lzdGVyIGl0IHRvXHJcbiAqICAgLy8gdGhlIHBhcmVudCBjbWFwIChjaGlsZHJlbiBtYXApLiAgTm90ZSB0aGF0IHRoZSAndGVtcGxhdGUnIGtleSBpc1xyXG4gKiAgIC8vIHVzZWQgaGVyZSwgc2luY2UgdGhpcyBpcyB3aGF0IGlkZW50aWZ5IHRoZSBjb21wb25lbnQgZnJvbSB0aGUgdGVtcGxhdGVcclxuICogICAvLyBwZXJzcGVjdGl2ZS5cclxuICogICBjb250ZXh0Ll9fb3dsX18uY21hcFtrZXk1XSA9IHc0Ll9fb3dsX18uaWQ7XHJcbiAqXHJcbiAqICAgLy8gX19wcmVwYXJlIGlzIGNhbGxlZCwgdG8gYmFzaWNhbGx5IGNhbGwgd2lsbFN0YXJ0LCB0aGVuIHJlbmRlciB0aGVcclxuICogICAvLyBjb21wb25lbnRcclxuICogICBkZWYzID0gdzQuX19wcmVwYXJlKCk7XHJcbiAqXHJcbiAqICAgZGVmMyA9IGRlZjMudGhlbih2bm9kZSA9PiB7XHJcbiAqICAgICAvLyB3ZSBjcmVhdGUgaGVyZSBhIHZpcnR1YWwgbm9kZSBmb3IgdGhlIHBhcmVudCAoTk9UIHRoZSBjb21wb25lbnQpLiBUaGlzXHJcbiAqICAgICAvLyBtZWFucyB0aGF0IHRoZSB2ZG9tIG9mIHRoZSBwYXJlbnQgd2lsbCBiZSBzdG9wcGVkIGhlcmUsIGFuZCBmcm9tXHJcbiAqICAgICAvLyB0aGUgcGFyZW50J3MgcGVyc3BlY3RpdmUsIGl0IHNpbXBseSBpcyBhIHZub2RlIHdpdGggbm8gY2hpbGRyZW4uXHJcbiAqICAgICAvLyBIb3dldmVyLCBpdCBzaGFyZXMgdGhlIHNhbWUgZG9tIGVsZW1lbnQgd2l0aCB0aGUgY29tcG9uZW50IHJvb3RcclxuICogICAgIC8vIHZub2RlLlxyXG4gKiAgICAgbGV0IHB2bm9kZSA9IGgodm5vZGUuc2VsLCB7IGtleToga2V5NSB9KTtcclxuICpcclxuICogICAgIC8vIHdlIGFkZCBob29rcyB0byB0aGUgcGFyZW50IHZub2RlIHNvIHdlIGNhbiBpbnRlcmFjdCB3aXRoIHRoZSBuZXdcclxuICogICAgIC8vIGNvbXBvbmVudCBhdCB0aGUgcHJvcGVyIHRpbWVcclxuICogICAgIHB2bm9kZS5kYXRhLmhvb2sgPSB7XHJcbiAqICAgICAgIGluc2VydCh2bikge1xyXG4gKiAgICAgICAgIC8vIHRoZSBfX21vdW50IG1ldGhvZCB3aWxsIHBhdGNoIHRoZSBjb21wb25lbnQgdmRvbSBpbnRvIHRoZSBlbG0gdm4uZWxtLFxyXG4gKiAgICAgICAgIC8vIHRoZW4gY2FsbCB0aGUgbW91bnRlZCBob29rcy4gSG93ZXZlciwgc3VwcmlzaW5nbHksIHRoZSBzbmFiYmRvbVxyXG4gKiAgICAgICAgIC8vIHBhdGNoIG1ldGhvZCBhY3R1YWxseSByZXBsYWNlIHRoZSBlbG0gYnkgYSBuZXcgZWxtLCBzbyB3ZSBuZWVkXHJcbiAqICAgICAgICAgLy8gdG8gc3luY2hyb25pc2UgdGhlIHB2bm9kZSBlbG0gd2l0aCB0aGUgcmVzdWx0aW5nIGVsbVxyXG4gKiAgICAgICAgIGxldCBudm4gPSB3NC5fX21vdW50KHZub2RlLCB2bi5lbG0pO1xyXG4gKiAgICAgICAgIHB2bm9kZS5lbG0gPSBudm4uZWxtO1xyXG4gKiAgICAgICAgIC8vIHdoYXQgZm9sbG93cyBpcyBvbmx5IHByZXNlbnQgaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMgb24gdGhlIGNvbXBvbmVudFxyXG4gKiAgICAgICAgIHV0aWxzLnRyYW5zaXRpb25JbnNlcnQodm4sIFwiZmFkZVwiKTtcclxuICogICAgICAgfSxcclxuICogICAgICAgcmVtb3ZlKCkge1xyXG4gKiAgICAgICAgIC8vIG92ZXJyaWRlIHdpdGggZW1wdHkgZnVuY3Rpb24gdG8gcHJldmVudCBmcm9tIHJlbW92aW5nIHRoZSBub2RlXHJcbiAqICAgICAgICAgLy8gZGlyZWN0bHkuIEl0IHdpbGwgYmUgcmVtb3ZlZCB3aGVuIGRlc3Ryb3kgaXMgY2FsbGVkIGFueXdheSwgd2hpY2hcclxuICogICAgICAgICAvLyBkZWxheXMgdGhlIHJlbW92YWwgaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMuXHJcbiAqICAgICAgIH0sXHJcbiAqICAgICAgIGRlc3Ryb3koKSB7XHJcbiAqICAgICAgICAgLy8gaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMsIHdlIGRlbGF5IHRoZSBjYWxsIHRvIGRlc3Ryb3kgb24gdGhlXHJcbiAqICAgICAgICAgLy8gY29tcG9uZW50LCBpZiBub3QsIHdlIGNhbGwgaXQgZGlyZWN0bHkuXHJcbiAqICAgICAgICAgbGV0IGZpbmFsaXplID0gKCkgPT4ge1xyXG4gKiAgICAgICAgICAgdzQuZGVzdHJveSgpO1xyXG4gKiAgICAgICAgIH07XHJcbiAqICAgICAgICAgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgXCJmYWRlXCIsIGZpbmFsaXplKTtcclxuICogICAgICAgfVxyXG4gKiAgICAgfTtcclxuICogICAgIC8vIHRoZSBwdm5vZGUgaXMgaW5zZXJ0ZWQgYXQgdGhlIGNvcnJlY3QgcG9zaXRpb24gaW4gdGhlIGRpdidzIGNoaWxkcmVuXHJcbiAqICAgICBjMVtfMl9pbmRleF0gPSBwdm5vZGU7XHJcbiAqXHJcbiAqICAgICAvLyB3ZSBrZWVwIGhlcmUgYSByZWZlcmVuY2UgdG8gdGhlIHBhcmVudCB2bm9kZSAocmVwcmVzZW50aW5nIHRoZVxyXG4gKiAgICAgLy8gY29tcG9uZW50LCBzbyB3ZSBjYW4gcmV1c2UgaXQgbGF0ZXIgd2hlbmV2ZXIgd2UgdXBkYXRlIHRoZSBjb21wb25lbnRcclxuICogICAgIHc0Ll9fb3dsX18ucHZub2RlID0gcHZub2RlO1xyXG4gKiAgIH0pO1xyXG4gKiB9IGVsc2Uge1xyXG4gKiAgIC8vIHRoaXMgaXMgdGhlICd1cGRhdGUnIHBhdGggb2YgdGhlIGRpcmVjdGl2ZS5cclxuICogICAvLyB0aGUgY2FsbCB0byBfX3VwZGF0ZVByb3BzIGlzIHRoZSBhY3R1YWwgY29tcG9uZW50IHVwZGF0ZVxyXG4gKiAgIC8vIE5vdGUgdGhhdCB3ZSBvbmx5IHVwZGF0ZSB0aGUgcHJvcHMgaWYgd2UgY2Fubm90IHJldXNlIHRoZSBwcmV2aW91c1xyXG4gKiAgIC8vIHJlbmRlcmluZyB3b3JrIChpbiB0aGUgY2FzZSBpdCB3YXMgcmVuZGVyZWQgd2l0aCB0aGUgc2FtZSBwcm9wcylcclxuICogICBkZWYzID0gZGVmMyB8fCB3NC5fX3VwZGF0ZVByb3BzKHByb3BzNCwgZXh0cmEuZm9yY2VVcGRhdGUsIGV4dHJhLnBhdGNoUXVldWUpO1xyXG4gKiAgIGRlZjMgPSBkZWYzLnRoZW4oKCkgPT4ge1xyXG4gKiAgICAgLy8gaWYgY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW4gdGhlIG1lYW50aW1lLCB3ZSBkbyBub3RoaW5nIChzbywgdGhpc1xyXG4gKiAgICAgLy8gbWVhbnMgdGhhdCB0aGUgcGFyZW50J3MgZWxlbWVudCBjaGlsZHJlbiBsaXN0IHdpbGwgaGF2ZSBhIG51bGwgaW5cclxuICogICAgIC8vIHRoZSBjb21wb25lbnQncyBwb3NpdGlvbiwgd2hpY2ggd2lsbCBjYXVzZSB0aGUgcHZub2RlIHRvIGJlIHJlbW92ZWRcclxuICogICAgIC8vIHdoZW4gaXQgaXMgcGF0Y2hlZC5cclxuICogICAgIGlmICh3NC5fX293bF9fLmlzRGVzdHJveWVkKSB7XHJcbiAqICAgICAgIHJldHVybjtcclxuICogICAgIH1cclxuICogICAgIC8vIGxpa2UgYWJvdmUsIHdlIHJlZ2lzdGVyIHRoZSBwdm5vZGUgdG8gdGhlIGNoaWxkcmVuIGxpc3QsIHNvIGl0XHJcbiAqICAgICAvLyB3aWxsIG5vdCBiZSBwYXRjaGVkIG91dCBvZiB0aGUgZG9tLlxyXG4gKiAgICAgbGV0IHB2bm9kZSA9IHc0Ll9fb3dsX18ucHZub2RlO1xyXG4gKiAgICAgYzFbXzJfaW5kZXhdID0gcHZub2RlO1xyXG4gKiAgIH0pO1xyXG4gKiB9XHJcbiAqXHJcbiAqIC8vIHdlIHJlZ2lzdGVyIHRoZSBkZWZlcnJlZCBoZXJlIHNvIHRoZSBwYXJlbnQgY2FuIGNvb3JkaW5hdGUgaXRzIHBhdGNoIG9wZXJhdGlvblxyXG4gKiAvLyB3aXRoIGFsbCB0aGUgY2hpbGRyZW4uXHJcbiAqIGV4dHJhLnByb21pc2VzLnB1c2goZGVmMyk7XHJcbiAqIHJldHVybiB2bjE7XHJcbiAqIGBgYFxyXG4gKi9cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJjb21wb25lbnRcIixcclxuICAgIGV4dHJhTmFtZXM6IFtcInByb3BzXCJdLFxyXG4gICAgcHJpb3JpdHk6IDEwMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUsIG5vZGUsIHF3ZWIgfSkge1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGAvLyBDb21wb25lbnQgJyR7dmFsdWV9J2ApO1xyXG4gICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVRV2ViID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUGFyZW50ID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IGhhc0R5bmFtaWNQcm9wcyA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1wcm9wc1wiKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAvLyB0LW9uLSBldmVudHMgYW5kIHQtdHJhbnNpdGlvblxyXG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IFtdO1xyXG4gICAgICAgIGxldCB0cmFuc2l0aW9uID0gXCJcIjtcclxuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZS5hdHRyaWJ1dGVzO1xyXG4gICAgICAgIGNvbnN0IHByb3BzID0ge307XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGVzW2ldLm5hbWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tpXS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0aChcInQtb24tXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudHMucHVzaChbbmFtZSwgdmFsdWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuYW1lID09PSBcInQtdHJhbnNpdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIW5hbWUuc3RhcnRzV2l0aChcInQtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSAhPT0gXCJjbGFzc1wiICYmIG5hbWUgIT09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBwcm9wIVxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzW25hbWVdID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpIHx8IFwidW5kZWZpbmVkXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY29tcHV0aW5nIHRoZSBwcm9wcyBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwcm9wcyBvYmplY3RcclxuICAgICAgICBsZXQgcHJvcFN0ciA9IE9iamVjdC5rZXlzKHByb3BzKVxyXG4gICAgICAgICAgICAubWFwKGsgPT4gayArIFwiOlwiICsgcHJvcHNba10pXHJcbiAgICAgICAgICAgIC5qb2luKFwiLFwiKTtcclxuICAgICAgICBsZXQgY29tcG9uZW50SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlS2V5ID0gY3R4LmdlbmVyYXRlVGVtcGxhdGVLZXkoKTtcclxuICAgICAgICBsZXQgcmVmID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXJlZlwiKTtcclxuICAgICAgICBsZXQgcmVmRXhwciA9IFwiXCI7XHJcbiAgICAgICAgbGV0IHJlZktleSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHJlZikge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVmcyA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlZktleSA9IGByZWYke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0ICR7cmVmS2V5fSA9ICR7Y3R4LmludGVycG9sYXRlKHJlZil9O2ApO1xyXG4gICAgICAgICAgICByZWZFeHByID0gYGNvbnRleHQuX19vd2xfXy5yZWZzWyR7cmVmS2V5fV0gPSB3JHtjb21wb25lbnRJRH07YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGZpbmFsaXplQ29tcG9uZW50Q29kZSA9IGB3JHtjb21wb25lbnRJRH0uZGVzdHJveSgpO2A7XHJcbiAgICAgICAgaWYgKHJlZikge1xyXG4gICAgICAgICAgICBmaW5hbGl6ZUNvbXBvbmVudENvZGUgKz0gYGRlbGV0ZSBjb250ZXh0Ll9fb3dsX18ucmVmc1ske3JlZktleX1dO2A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGZpbmFsaXplQ29tcG9uZW50Q29kZSA9IGBsZXQgZmluYWxpemUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAke2ZpbmFsaXplQ29tcG9uZW50Q29kZX1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGRlbGV0ZSB3JHtjb21wb25lbnRJRH0uX19vd2xfXy50cmFuc2l0aW9uSW5zZXJ0ZWQ7XHJcbiAgICAgICAgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgJyR7dHJhbnNpdGlvbn0nLCBmaW5hbGl6ZSk7YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNyZWF0ZUhvb2sgPSBcIlwiO1xyXG4gICAgICAgIGxldCBjbGFzc0F0dHIgPSBub2RlLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xyXG4gICAgICAgIGxldCB0YXR0Q2xhc3MgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0LWNsYXNzXCIpO1xyXG4gICAgICAgIGxldCBzdHlsZUF0dHIgPSBub2RlLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xyXG4gICAgICAgIGxldCB0YXR0U3R5bGUgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0LXN0eWxlXCIpO1xyXG4gICAgICAgIGlmICh0YXR0U3R5bGUpIHtcclxuICAgICAgICAgICAgY29uc3QgYXR0VmFyID0gYF8ke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0ICR7YXR0VmFyfSA9ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odGF0dFN0eWxlKX07YCk7XHJcbiAgICAgICAgICAgIHRhdHRTdHlsZSA9IGF0dFZhcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNsYXNzT2JqID0gXCJcIjtcclxuICAgICAgICBpZiAoY2xhc3NBdHRyIHx8IHRhdHRDbGFzcyB8fCBzdHlsZUF0dHIgfHwgdGF0dFN0eWxlIHx8IGV2ZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKGNsYXNzQXR0cikge1xyXG4gICAgICAgICAgICAgICAgbGV0IGNsYXNzRGVmID0gY2xhc3NBdHRyXHJcbiAgICAgICAgICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcChhID0+IGAnJHthfSc6dHJ1ZWApXHJcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgY2xhc3NPYmogPSBgXyR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9IHske2NsYXNzRGVmfX07YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRhdHRDbGFzcykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRhdHRFeHByID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odGF0dENsYXNzKTtcclxuICAgICAgICAgICAgICAgIGlmICh0YXR0RXhwclswXSAhPT0gXCJ7XCIgfHwgdGF0dEV4cHJbdGF0dEV4cHIubGVuZ3RoIC0gMV0gIT09IFwifVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGF0dEV4cHIgPSBgdXRpbHMudG9PYmooJHt0YXR0RXhwcn0pYDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjbGFzc0F0dHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgT2JqZWN0LmFzc2lnbigke2NsYXNzT2JqfSwgJHt0YXR0RXhwcn0pYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc09iaiA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9ICR7dGF0dEV4cHJ9O2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBldmVudHNDb2RlID0gZXZlbnRzXHJcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChbbmFtZSwgdmFsdWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gbmFtZS5tYXRjaCgvXFwuY2FwdHVyZS8pO1xyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGNhcHR1cmUgPyBuYW1lLnJlcGxhY2UoL1xcLmNhcHR1cmUvLCBcIlwiKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGV2ZW50LCBoYW5kbGVyIH0gPSBtYWtlSGFuZGxlckNvZGUoY3R4LCBuYW1lLCB2YWx1ZSwgZmFsc2UsIFRfQ09NUE9ORU5UX01PRFNfQ09ERSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FwdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgdm4uZWxtLmFkZEV2ZW50TGlzdGVuZXIoJyR7ZXZlbnR9JywgJHtoYW5kbGVyfSwgdHJ1ZSk7YDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBgdm4uZWxtLmFkZEV2ZW50TGlzdGVuZXIoJyR7ZXZlbnR9JywgJHtoYW5kbGVyfSk7YDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBzdHlsZUV4cHIgPSB0YXR0U3R5bGUgfHwgKHN0eWxlQXR0ciA/IGAnJHtzdHlsZUF0dHJ9J2AgOiBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlQ29kZSA9IHN0eWxlRXhwciA/IGB2bi5lbG0uc3R5bGUgPSAke3N0eWxlRXhwcn07YCA6IFwiXCI7XHJcbiAgICAgICAgICAgIGNyZWF0ZUhvb2sgPSBgdXRpbHMuYXNzaWduSG9va3Modm5vZGUuZGF0YSwge2NyZWF0ZShfLCB2bil7JHtzdHlsZUNvZGV9JHtldmVudHNDb2RlfX19KTtgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IHcke2NvbXBvbmVudElEfSA9ICR7dGVtcGxhdGVLZXl9IGluIHBhcmVudC5fX293bF9fLmNtYXAgPyBwYXJlbnQuX19vd2xfXy5jaGlsZHJlbltwYXJlbnQuX19vd2xfXy5jbWFwWyR7dGVtcGxhdGVLZXl9XV0gOiBmYWxzZTtgKTtcclxuICAgICAgICBsZXQgc2hvdWxkUHJveHkgPSAhY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKHNob3VsZFByb3h5KSB7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5yb290Tm9kZSA9IGlkO1xyXG4gICAgICAgICAgICBzaG91bGRQcm94eSA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVSZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHZuJHtpZH0gPSB7fTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IHZuJHtpZH07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoYXNEeW5hbWljUHJvcHMpIHtcclxuICAgICAgICAgICAgY29uc3QgZHluYW1pY1Byb3AgPSBjdHguZm9ybWF0RXhwcmVzc2lvbihub2RlLmdldEF0dHJpYnV0ZShcInQtcHJvcHNcIikpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHByb3BzJHtjb21wb25lbnRJRH0gPSBPYmplY3QuYXNzaWduKHske3Byb3BTdHJ9fSwgJHtkeW5hbWljUHJvcH0pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwcm9wcyR7Y29tcG9uZW50SUR9ID0geyR7cHJvcFN0cn19O2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkSWYoYHcke2NvbXBvbmVudElEfSAmJiB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5jdXJyZW50RmliZXIgJiYgIXcke2NvbXBvbmVudElEfS5fX293bF9fLnZub2RlYCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5kZXN0cm95KCk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfSA9IGZhbHNlO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgbGV0IHJlZ2lzdGVyQ29kZSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHNob3VsZFByb3h5KSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyQ29kZSA9IGB1dGlscy5kZWZpbmVQcm94eSh2biR7Y3R4LnJvb3ROb2RlfSwgcHZub2RlKTtgO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTTE9UU1xyXG4gICAgICAgIGNvbnN0IGhhc1Nsb3RzID0gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aDtcclxuICAgICAgICBsZXQgc2NvcGUgPSBoYXNTbG90cyA/IGBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoY29udGV4dCksIHNjb3BlKWAgOiBcInVuZGVmaW5lZFwiO1xyXG4gICAgICAgIGN0eC5hZGRJZihgdyR7Y29tcG9uZW50SUR9YCk7XHJcbiAgICAgICAgLy8gbmVlZCB0byB1cGRhdGUgY29tcG9uZW50XHJcbiAgICAgICAgbGV0IHN0eWxlQ29kZSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHRhdHRTdHlsZSkge1xyXG4gICAgICAgICAgICBzdHlsZUNvZGUgPSBgLnRoZW4oKCk9PntpZiAodyR7Y29tcG9uZW50SUR9Ll9fb3dsX18uaXNEZXN0cm95ZWQpIHtyZXR1cm59O3cke2NvbXBvbmVudElEfS5lbC5zdHlsZT0ke3RhdHRTdHlsZX07fSk7YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX3VwZGF0ZVByb3BzKHByb3BzJHtjb21wb25lbnRJRH0sIGV4dHJhLmZpYmVyLCAke3Njb3BlfSkke3N0eWxlQ29kZX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwdm5vZGUgPSB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5wdm5vZGU7YCk7XHJcbiAgICAgICAgaWYgKHJlZ2lzdGVyQ29kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShyZWdpc3RlckNvZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3R4LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKHB2bm9kZSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5hZGRFbHNlKCk7XHJcbiAgICAgICAgLy8gbmV3IGNvbXBvbmVudFxyXG4gICAgICAgIGxldCBkeW5hbWljRmFsbGJhY2sgPSBcIlwiO1xyXG4gICAgICAgIGlmICghdmFsdWUubWF0Y2goSU5URVJQX1JFR0VYUCkpIHtcclxuICAgICAgICAgICAgZHluYW1pY0ZhbGxiYWNrID0gYHx8ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGludGVycFZhbHVlID0gY3R4LmludGVycG9sYXRlKHZhbHVlKTtcclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGNvbXBvbmVudEtleSR7Y29tcG9uZW50SUR9ID0gJHtpbnRlcnBWYWx1ZX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBXJHtjb21wb25lbnRJRH0gPSBjb250ZXh0LmNvbnN0cnVjdG9yLmNvbXBvbmVudHNbY29tcG9uZW50S2V5JHtjb21wb25lbnRJRH1dIHx8IFFXZWIuY29tcG9uZW50c1tjb21wb25lbnRLZXkke2NvbXBvbmVudElEfV0ke2R5bmFtaWNGYWxsYmFja307YCk7XHJcbiAgICAgICAgLy8gbWF5YmUgb25seSBkbyB0aGlzIGluIGRldiBtb2RlLi4uXHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGlmICghVyR7Y29tcG9uZW50SUR9KSB7dGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZmluZCB0aGUgZGVmaW5pdGlvbiBvZiBjb21wb25lbnQgXCInICsgY29tcG9uZW50S2V5JHtjb21wb25lbnRJRH0gKyAnXCInKX1gKTtcclxuICAgICAgICBjdHguYWRkTGluZShgdyR7Y29tcG9uZW50SUR9ID0gbmV3IFcke2NvbXBvbmVudElEfShwYXJlbnQsIHByb3BzJHtjb21wb25lbnRJRH0pO2ApO1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjb25zdCBfX3BhdGNoJHtjb21wb25lbnRJRH0gPSB3JHtjb21wb25lbnRJRH0uX19wYXRjaDtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX3BhdGNoID0gKHQsIHZuKSA9PiB7X19wYXRjaCR7Y29tcG9uZW50SUR9LmNhbGwodyR7Y29tcG9uZW50SUR9LCB0LCB2bik7IGlmKCF3JHtjb21wb25lbnRJRH0uX19vd2xfXy50cmFuc2l0aW9uSW5zZXJ0ZWQpe3cke2NvbXBvbmVudElEfS5fX293bF9fLnRyYW5zaXRpb25JbnNlcnRlZCA9IHRydWU7dXRpbHMudHJhbnNpdGlvbkluc2VydCh3JHtjb21wb25lbnRJRH0uX19vd2xfXy52bm9kZSwgJyR7dHJhbnNpdGlvbn0nKTt9fTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHBhcmVudC5fX293bF9fLmNtYXBbJHt0ZW1wbGF0ZUtleX1dID0gdyR7Y29tcG9uZW50SUR9Ll9fb3dsX18uaWQ7YCk7XHJcbiAgICAgICAgaWYgKGhhc1Nsb3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsb25lID0gbm9kZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNsb3ROb2RlcyA9IEFycmF5LmZyb20oY2xvbmUucXVlcnlTZWxlY3RvckFsbChcIlt0LXNldC1zbG90XVwiKSk7XHJcbiAgICAgICAgICAgIC8vIFRoZSBuZXh0IGNvZGUgaXMgYSBmYWxsYmFjayBmb3IgY29tcGF0aWJpbGl0eSByZWFzb24uIEl0IGFjY2VwdHMgdC1zZXRcclxuICAgICAgICAgICAgLy8gZWxlbWVudHMgdGhhdCBhcmUgZGlyZWN0IGNoaWxkcmVuIHdpdGggYSBub24gZW1wdHkgYm9keSBhcyBub2RlcyBkZWZpbmluZ1xyXG4gICAgICAgICAgICAvLyB0aGUgY29udGVudCBvZiBhIHNsb3QuXHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgd3JvbmcsIGJ1dCBpcyBuZWNlc3NhcnkgdG8gcHJldmVudCBicmVha2luZyBhbGwgZXhpc3RpbmcgT3dsXHJcbiAgICAgICAgICAgIC8vIGNvZGUgdXNpbmcgc2xvdHMuIFRoaXMgd2lsbCBiZSByZW1vdmVkIGluIHYyLjAgc29tZWRheS4gTWVhbndoaWxlLFxyXG4gICAgICAgICAgICAvLyBwbGVhc2UgdXNlIHQtc2V0LXNsb3QgZXZlcnl3aGVyZSB5b3UgbmVlZCB0byBzZXQgdGhlIGNvbnRlbnQgb2YgYVxyXG4gICAgICAgICAgICAvLyBzbG90LlxyXG4gICAgICAgICAgICBmb3IgKGxldCBlbCBvZiBjbG9uZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZShcInQtc2V0XCIpICYmIGVsLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNsb3ROb2Rlcy5wdXNoKGVsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzbG90SWQgPSBRV2ViLm5leHRTbG90SWQrKztcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX293bF9fLnNsb3RJZCA9ICR7c2xvdElkfTtgKTtcclxuICAgICAgICAgICAgaWYgKHNsb3ROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBzbG90Tm9kZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbG90Tm9kZSA9IHNsb3ROb2Rlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBzbG90Tm9kZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHNsb3ROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gc2xvdE5vZGUuZ2V0QXR0cmlidXRlKFwidC1zZXQtc2xvdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzbG90Tm9kZS5yZW1vdmVBdHRyaWJ1dGUoXCJ0LXNldC1zbG90XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgYWdhaW4sIHRoaXMgY29kZSBzaG91bGQgYmUgcmVtb3ZlZCB3aGVuIHdlIHN0b3Agc3VwcG9ydGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nIHQtc2V0IHRvIGRlZmluZSB0aGUgY29udGVudCBvZiBuYW1lZCBzbG90cy5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBzbG90Tm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXNldFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdE5vZGUucmVtb3ZlQXR0cmlidXRlKFwidC1zZXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNsb3RGbiA9IHF3ZWIuX2NvbXBpbGUoYHNsb3RfJHtrZXl9X3RlbXBsYXRlYCwgc2xvdE5vZGUsIGN0eCk7XHJcbiAgICAgICAgICAgICAgICAgICAgUVdlYi5zbG90c1tgJHtzbG90SWR9XyR7a2V5fWBdID0gc2xvdEZuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjbG9uZS5jaGlsZE5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGNsb25lLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRcIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBPYmplY3QudmFsdWVzKGNsb25lLmNoaWxkTm9kZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hcHBlbmRDaGlsZChjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzbG90Rm4gPSBxd2ViLl9jb21waWxlKGBzbG90X2RlZmF1bHRfdGVtcGxhdGVgLCB0LCBjdHgpO1xyXG4gICAgICAgICAgICAgICAgUVdlYi5zbG90c1tgJHtzbG90SWR9X2RlZmF1bHRgXSA9IHNsb3RGbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGZpYmVyID0gdyR7Y29tcG9uZW50SUR9Ll9fcHJlcGFyZShleHRyYS5maWJlciwgJHtzY29wZX0sICgpID0+IHsgY29uc3Qgdm5vZGUgPSBmaWJlci52bm9kZTsgcHZub2RlLnNlbCA9IHZub2RlLnNlbDsgJHtjcmVhdGVIb29rfX0pO2ApO1xyXG4gICAgICAgIC8vIGhhY2s6IHNwZWNpZnkgZW1wdHkgcmVtb3ZlIGhvb2sgdG8gcHJldmVudCB0aGUgbm9kZSBmcm9tIGJlaW5nIHJlbW92ZWQgZnJvbSB0aGUgRE9NXHJcbiAgICAgICAgY29uc3QgaW5zZXJ0SG9vayA9IHJlZkV4cHIgPyBgaW5zZXJ0KHZuKSB7JHtyZWZFeHByfX0sYCA6IFwiXCI7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwdm5vZGUgPSBoKCdkdW1teScsIHtrZXk6ICR7dGVtcGxhdGVLZXl9LCBob29rOiB7JHtpbnNlcnRIb29rfXJlbW92ZSgpIHt9LGRlc3Ryb3kodm4pIHske2ZpbmFsaXplQ29tcG9uZW50Q29kZX19fX0pO2ApO1xyXG4gICAgICAgIGlmIChyZWdpc3RlckNvZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUocmVnaXN0ZXJDb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjJHtjdHgucGFyZW50Tm9kZX0ucHVzaChwdm5vZGUpO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgdyR7Y29tcG9uZW50SUR9Ll9fb3dsX18ucHZub2RlID0gcHZub2RlO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgaWYgKGNsYXNzT2JqKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5jbGFzc09iaj0ke2NsYXNzT2JqfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX293bF9fLnBhcmVudExhc3RGaWJlcklkID0gZXh0cmEuZmliZXIuaWQ7YCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xuXG5jbGFzcyBTY2hlZHVsZXIge1xyXG4gICAgY29uc3RydWN0b3IocmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XHJcbiAgICB9XHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZVRhc2tzKCk7XHJcbiAgICB9XHJcbiAgICBzdG9wKCkge1xyXG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBhZGRGaWJlcihmaWJlcikge1xyXG4gICAgICAgIC8vIGlmIHRoZSBmaWJlciB3YXMgcmVtYXBwZWQgaW50byBhIGxhcmdlciByZW5kZXJpbmcgZmliZXIsIGl0IG1heSBub3QgYmUgYVxyXG4gICAgICAgIC8vIHJvb3QgZmliZXIuICBCdXQgd2Ugb25seSB3YW50IHRvIHJlZ2lzdGVyIHJvb3QgZmliZXJzXHJcbiAgICAgICAgZmliZXIgPSBmaWJlci5yb290O1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWJlci5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChmaWJlci5lcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50YXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpYmVyLFxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmliZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChmaWJlci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmVqZWN0RmliZXIoZmliZXIsIHJlYXNvbikge1xyXG4gICAgICAgIGZpYmVyID0gZmliZXIucm9vdDtcclxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMudGFza3MuZmluZEluZGV4KHQgPT4gdC5maWJlciA9PT0gZmliZXIpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFt0YXNrXSA9IHRoaXMudGFza3Muc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgZmliZXIuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIGZpYmVyLmVycm9yID0gbmV3IEVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICAgIHRhc2suY2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgYWxsIGN1cnJlbnQgdGFza3MuIFRoaXMgb25seSBhcHBsaWVzIHRvIHRoZSBmaWJlcnMgdGhhdCBhcmUgcmVhZHkuXHJcbiAgICAgKiBPdGhlciB0YXNrcyBhcmUgbGVmdCB1bmNoYW5nZWQuXHJcbiAgICAgKi9cclxuICAgIGZsdXNoKCkge1xyXG4gICAgICAgIGxldCB0YXNrcyA9IHRoaXMudGFza3M7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgIHRhc2tzID0gdGFza3MuZmlsdGVyKHRhc2sgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGFzay5maWJlci5pc0NvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgdGFzay5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0YXNrLmZpYmVyLmNvdW50ZXIgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGFzay5maWJlci5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suZmliZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5maWJlci5oYW5kbGVFcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0YXNrLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IHRhc2tzLmNvbmNhdCh0aGlzLnRhc2tzKTtcclxuICAgICAgICBpZiAodGhpcy50YXNrcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2NoZWR1bGVUYXNrcygpIHtcclxuICAgICAgICB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlVGFza3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IHNjaGVkdWxlciA9IG5ldyBTY2hlZHVsZXIoYnJvd3Nlci5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpO1xuXG4vKipcclxuICogT3dsIEZpYmVyIENsYXNzXHJcbiAqXHJcbiAqIEZpYmVycyBhcmUgc21hbGwgYWJzdHJhY3Rpb25zIGRlc2lnbmVkIHRvIGNvbnRhaW4gYWxsIHRoZSBpbnRlcm5hbCBzdGF0ZVxyXG4gKiBhc3NvY2lhdGVkIHdpdGggYSBcInJlbmRlcmluZyB3b3JrIHVuaXRcIiwgcmVsYXRpdmUgdG8gYSBzcGVjaWZpYyBjb21wb25lbnQuXHJcbiAqXHJcbiAqIEEgcmVuZGVyaW5nIHdpbGwgY2F1c2UgdGhlIGNyZWF0aW9uIG9mIGEgZmliZXIgZm9yIGVhY2ggaW1wYWN0ZWQgY29tcG9uZW50cy5cclxuICpcclxuICogRmliZXJzIGNhcHR1cmUgYWxsIHRoYXQgbmVjZXNzYXJ5IGluZm9ybWF0aW9uLCB3aGljaCBpcyBjcml0aWNhbCB0byBvd2xcclxuICogYXN5bmNocm9ub3VzIHJlbmRlcmluZyBwaXBlbGluZS4gRmliZXJzIGNhbiBiZSBjYW5jZWxsZWQsIGNhbiBiZSBpbiBkaWZmZXJlbnRcclxuICogc3RhdGVzIGFuZCBpbiBnZW5lcmFsIGRldGVybWluZSB0aGUgc3RhdGUgb2YgdGhlIHJlbmRlcmluZy5cclxuICovXHJcbmNsYXNzIEZpYmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmVudCwgY29tcG9uZW50LCBmb3JjZSwgdGFyZ2V0LCBwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuaWQgPSBGaWJlci5uZXh0SWQrKztcclxuICAgICAgICAvLyBpc0NvbXBsZXRlZCBtZWFucyB0aGF0IHRoZSByZW5kZXJpbmcgY29ycmVzcG9uZGluZyB0byB0aGlzIGZpYmVyJ3Mgd29yayBpc1xyXG4gICAgICAgIC8vIGRvbmUsIGVpdGhlciBiZWNhdXNlIHRoZSBjb21wb25lbnQgaGFzIGJlZW4gbW91bnRlZCBvciBwYXRjaGVkLCBvciBiZWNhdXNlXHJcbiAgICAgICAgLy8gZmliZXIgaGFzIGJlZW4gY2FuY2VsbGVkLlxyXG4gICAgICAgIHRoaXMuaXNDb21wbGV0ZWQgPSBmYWxzZTtcclxuICAgICAgICAvLyB0aGUgZmliZXJzIGNvcnJlc3BvbmRpbmcgdG8gY29tcG9uZW50IHVwZGF0ZXMgKHVwZGF0ZVByb3BzKSBuZWVkIHRvIGNhbGxcclxuICAgICAgICAvLyB0aGUgd2lsbFBhdGNoIGFuZCBwYXRjaGVkIGhvb2tzIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgY29tcG9uZW50LiBIb3dldmVyLFxyXG4gICAgICAgIC8vIGZpYmVycyBjb3JyZXNwb25kaW5nIHRvIGEgbmV3IGNvbXBvbmVudCBkbyBub3QgbmVlZCB0byBkbyB0aGF0LiBTbywgdGhlXHJcbiAgICAgICAgLy8gc2hvdWxkUGF0Y2ggaG9vayBpcyB0aGUgYm9vbGVhbiB0aGF0IHdlIGNoZWNrIHdoZW5ldmVyIHdlIG5lZWQgdG8gYXBwbHlcclxuICAgICAgICAvLyBhIHBhdGNoLlxyXG4gICAgICAgIHRoaXMuc2hvdWxkUGF0Y2ggPSB0cnVlO1xyXG4gICAgICAgIC8vIGlzUmVuZGVyZWQgaXMgdGhlIGxhc3Qgc3RhdGUgb2YgYSBmaWJlci4gSWYgdHJ1ZSwgdGhpcyBtZWFucyB0aGF0IGl0IGhhc1xyXG4gICAgICAgIC8vIGJlZW4gcmVuZGVyZWQgYW5kIGlzIGluZXJ0IChzbywgaXQgc2hvdWxkIG5vdCBiZSB0YWtlbiBpbnRvIGFjY291bnQgd2hlblxyXG4gICAgICAgIC8vIGNvdW50aW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIGZpYmVycykuXHJcbiAgICAgICAgdGhpcy5pc1JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICAgICAgLy8gdGhlIGNvdW50ZXIgbnVtYmVyIGlzIGEgY3JpdGljYWwgaW5mb3JtYXRpb24uIEl0IGlzIG9ubHkgbmVjZXNzYXJ5IGZvciBhXHJcbiAgICAgICAgLy8gcm9vdCBmaWJlci4gIEZvciB0aGF0IGZpYmVyLCB0aGlzIG51bWJlciBjb3VudHMgdGhlIG51bWJlciBvZiBhY3RpdmUgc3ViXHJcbiAgICAgICAgLy8gZmliZXJzLiAgV2hlbiB0aGF0IG51bWJlciByZWFjaGVzIDAsIHRoZSBmaWJlciBjYW4gYmUgYXBwbGllZCBieSB0aGVcclxuICAgICAgICAvLyBzY2hlZHVsZXIuXHJcbiAgICAgICAgdGhpcy5jb3VudGVyID0gMDtcclxuICAgICAgICB0aGlzLnZub2RlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNpYmxpbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGFzdENoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy5mb3JjZSA9IGZvcmNlO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gY29tcG9uZW50Ll9fb3dsX187XHJcbiAgICAgICAgdGhpcy5zY29wZSA9IF9fb3dsX18uc2NvcGU7XHJcbiAgICAgICAgdGhpcy5yb290ID0gcGFyZW50ID8gcGFyZW50LnJvb3QgOiB0aGlzO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIGxldCBvbGRGaWJlciA9IF9fb3dsX18uY3VycmVudEZpYmVyO1xyXG4gICAgICAgIGlmIChvbGRGaWJlciAmJiAhb2xkRmliZXIuaXNDb21wbGV0ZWQpIHtcclxuICAgICAgICAgICAgaWYgKG9sZEZpYmVyLnJvb3QgPT09IG9sZEZpYmVyICYmICFwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIGJvdGggb2xkRmliZXIgYW5kIHRoaXMgZmliZXIgYXJlIHJvb3QgZmliZXJzXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXVzZUZpYmVyKG9sZEZpYmVyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvbGRGaWJlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbWFwRmliZXIob2xkRmliZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucm9vdC5jb3VudGVyKys7XHJcbiAgICAgICAgX19vd2xfXy5jdXJyZW50RmliZXIgPSB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGVuIHRoZSBvbGRGaWJlciBpcyBub3QgY29tcGxldGVkIHlldCwgYW5kIGJvdGggb2xkRmliZXIgYW5kIHRoaXMgZmliZXJcclxuICAgICAqIGFyZSByb290IGZpYmVycywgd2Ugd2FudCB0byByZXVzZSB0aGUgb2xkRmliZXIgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ld1xyXG4gICAgICogb25lLiBEb2luZyBzbyB3aWxsIGd1YXJhbnRlZSB0aGF0IHRoZSBpbml0aWF0b3Iocykgb2YgdGhvc2UgcmVuZGVyaW5ncyB3aWxsXHJcbiAgICAgKiBiZSBub3RpZmllZCAodGhlIHByb21pc2Ugd2lsbCByZXNvbHZlKSB3aGVuIHRoZSBsYXN0IHJlbmRlcmluZyB3aWxsIGJlIGRvbmUuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB0aHVzIGFzc3VtZXMgdGhhdCBvbGRGaWJlciBpcyBhIHJvb3QgZmliZXIuXHJcbiAgICAgKi9cclxuICAgIF9yZXVzZUZpYmVyKG9sZEZpYmVyKSB7XHJcbiAgICAgICAgb2xkRmliZXIuY2FuY2VsKCk7IC8vIGNhbmNlbCBjaGlsZHJlbiBmaWJlcnNcclxuICAgICAgICBvbGRGaWJlci5pc0NvbXBsZXRlZCA9IGZhbHNlOyAvLyBrZWVwIHRoZSByb290IGZpYmVyIGFsaXZlXHJcbiAgICAgICAgb2xkRmliZXIuaXNSZW5kZXJlZCA9IGZhbHNlOyAvLyB0aGUgZmliZXIgaGFzIHRvIGJlIHJlLXJlbmRlcmVkXHJcbiAgICAgICAgaWYgKG9sZEZpYmVyLmNoaWxkKSB7XHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSByZWxhdGlvbiB0byBjaGlsZHJlblxyXG4gICAgICAgICAgICBvbGRGaWJlci5jaGlsZC5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICBvbGRGaWJlci5jaGlsZCA9IG51bGw7XHJcbiAgICAgICAgICAgIG9sZEZpYmVyLmxhc3RDaGlsZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG9sZEZpYmVyLmNvdW50ZXIgPSAxOyAvLyByZS1pbml0aWFsaXplIGNvdW50ZXJcclxuICAgICAgICBvbGRGaWJlci5pZCA9IEZpYmVyLm5leHRJZCsrO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbiBzb21lIGNhc2VzLCBhIHJlbmRlcmluZyBpbml0aWF0ZWQgYXQgc29tZSBjb21wb25lbnQgY2FuIGRldGVjdCB0aGF0IGl0XHJcbiAgICAgKiBzaG91bGQgYmUgcGFydCBvZiBhIGxhcmdlciByZW5kZXJpbmcgaW5pdGlhdGVkIHNvbWV3aGVyZSB1cCB0aGUgY29tcG9uZW50XHJcbiAgICAgKiB0cmVlLiAgSW4gdGhhdCBjYXNlLCBpdCBuZWVkcyB0byBjYW5jZWwgdGhlIHByZXZpb3VzIHJlbmRlcmluZyBhbmRcclxuICAgICAqIHJlbWFwIGl0c2VsZiBhcyBhIHBhcnQgb2YgdGhlIGN1cnJlbnQgcGFyZW50IHJlbmRlcmluZy5cclxuICAgICAqL1xyXG4gICAgX3JlbWFwRmliZXIob2xkRmliZXIpIHtcclxuICAgICAgICBvbGRGaWJlci5jYW5jZWwoKTtcclxuICAgICAgICB0aGlzLnNob3VsZFBhdGNoID0gb2xkRmliZXIuc2hvdWxkUGF0Y2g7XHJcbiAgICAgICAgaWYgKG9sZEZpYmVyID09PSBvbGRGaWJlci5yb290KSB7XHJcbiAgICAgICAgICAgIG9sZEZpYmVyLmNvdW50ZXIrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZEZpYmVyLnBhcmVudCAmJiAhdGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgLy8gcmUtbWFwIGxpbmtzXHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gb2xkRmliZXIucGFyZW50O1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QgPSB0aGlzLnBhcmVudC5yb290O1xyXG4gICAgICAgICAgICB0aGlzLnNpYmxpbmcgPSBvbGRGaWJlci5zaWJsaW5nO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQubGFzdENoaWxkID09PSBvbGRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubGFzdENoaWxkID0gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY2hpbGQgPT09IG9sZEZpYmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZCA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucGFyZW50LmNoaWxkO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5zaWJsaW5nID09PSBvbGRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnNpYmxpbmcgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuc2libGluZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBoYXMgYmVlbiB0YWtlbiBmcm9tXHJcbiAgICAgKiBodHRwczovL21lZGl1bS5jb20vcmVhY3QtaW4tZGVwdGgvdGhlLWhvdy1hbmQtd2h5LW9uLXJlYWN0cy11c2FnZS1vZi1saW5rZWQtbGlzdC1pbi1maWJlci02N2YxMDE0ZDBlYjdcclxuICAgICAqL1xyXG4gICAgX3dhbGsoZG9Xb3JrKSB7XHJcbiAgICAgICAgbGV0IHJvb3QgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcztcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGRvV29yayhjdXJyZW50KTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY2hpbGQ7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY3VycmVudCA9PT0gcm9vdCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdoaWxlICghY3VycmVudC5zaWJsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnQucGFyZW50IHx8IGN1cnJlbnQucGFyZW50ID09PSByb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnNpYmxpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWNjZXNzZnVsbHkgY29tcGxldGUgdGhlIHdvcmsgb2YgdGhlIGZpYmVyOiBjYWxsIHRoZSBtb3VudCBvciBwYXRjaCBob29rc1xyXG4gICAgICogYW5kIHBhdGNoIHRoZSBET00uIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIG9uY2UgdGhlIGZpYmVyIGFuZCBpdHMgY2hpbGRyZW5cclxuICAgICAqIGFyZSByZWFkeSwgYW5kIHRoZSBzY2hlZHVsZXIgZGVjaWRlcyB0byBwcm9jZXNzIGl0LlxyXG4gICAgICovXHJcbiAgICBjb21wbGV0ZSgpIHtcclxuICAgICAgICBsZXQgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy5pc0NvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldCAmJiAhY29tcG9uZW50Ll9fb3dsX18uaXNNb3VudGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYnVpbGQgcGF0Y2hRdWV1ZVxyXG4gICAgICAgIGNvbnN0IHBhdGNoUXVldWUgPSBbXTtcclxuICAgICAgICBjb25zdCBkb1dvcmsgPSBmdW5jdGlvbiAoZikge1xyXG4gICAgICAgICAgICBwYXRjaFF1ZXVlLnB1c2goZik7XHJcbiAgICAgICAgICAgIHJldHVybiBmLmNoaWxkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fd2Fsayhkb1dvcmspO1xyXG4gICAgICAgIGNvbnN0IHBhdGNoTGVuID0gcGF0Y2hRdWV1ZS5sZW5ndGg7XHJcbiAgICAgICAgLy8gY2FsbCB3aWxsUGF0Y2ggaG9vayBvbiBlYWNoIGZpYmVyIG9mIHBhdGNoUXVldWVcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGNoTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZmliZXIgPSBwYXRjaFF1ZXVlW2ldO1xyXG4gICAgICAgICAgICBpZiAoZmliZXIuc2hvdWxkUGF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudCA9IGZpYmVyLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfXy53aWxsUGF0Y2hDQikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX293bF9fLndpbGxQYXRjaENCKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQud2lsbFBhdGNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2FsbCBfX3BhdGNoIG9uIGVhY2ggZmliZXIgb2YgKHJldmVyc2VkKSBwYXRjaFF1ZXVlXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHBhdGNoTGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgY29uc3QgZmliZXIgPSBwYXRjaFF1ZXVlW2ldO1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBmaWJlci5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGlmIChmaWJlci50YXJnZXQgJiYgaSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRhcmdldDtcclxuICAgICAgICAgICAgICAgIGlmIChmaWJlci5wb3NpdGlvbiA9PT0gXCJzZWxmXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBmaWJlci50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IGZpYmVyLnZub2RlLnNlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBhdHRhY2ggJyR7Y29tcG9uZW50LmNvbnN0cnVjdG9yLm5hbWV9JyB0byB0YXJnZXQgbm9kZSAobm90IHNhbWUgdGFnIG5hbWUpYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEluIHNlbGYgbW9kZSwgd2UgKmtub3cqIHdlIGFyZSB0byB0YWtlIHBvc3Nlc3Npb24gb2YgdGhlIHRhcmdldFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEhlbmNlIHdlIG1hbnVhbGx5IGNyZWF0ZSB0aGUgY29ycmVzcG9uZGluZyBWTm9kZSBhbmQgY29weSB0aGUgXCJrZXlcIiBpbiBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZlZub2RlRGF0YSA9IGZpYmVyLnZub2RlLmRhdGEgPyB7IGtleTogZmliZXIudm5vZGUuZGF0YS5rZXkgfSA6IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGZWbm9kZSA9IGgoZmliZXIudm5vZGUuc2VsLCBzZWxmVm5vZGVEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmVm5vZGUuZWxtID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHNlbGZWbm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IGNvbXBvbmVudC5fX293bF9fLnZub2RlIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZmliZXIudm5vZGUuc2VsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX3BhdGNoKHRhcmdldCwgZmliZXIudm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpYmVyLnNob3VsZFBhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fcGF0Y2goY29tcG9uZW50Ll9fb3dsX18udm5vZGUsIGZpYmVyLnZub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX3BhdGNoKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZmliZXIudm5vZGUuc2VsKSwgZmliZXIudm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX293bF9fLnB2bm9kZS5lbG0gPSBjb21wb25lbnQuX19vd2xfXy52bm9kZS5lbG07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX18uY3VycmVudEZpYmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW5zZXJ0IGludG8gdGhlIERPTSAobW91bnQgY2FzZSlcclxuICAgICAgICBsZXQgaW5ET00gPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy50YXJnZXQpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZmlyc3QtY2hpbGRcIjpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldC5wcmVwZW5kKHRoaXMuY29tcG9uZW50LmVsKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJsYXN0LWNoaWxkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQuYXBwZW5kQ2hpbGQodGhpcy5jb21wb25lbnQuZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGluRE9NID0gZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmNvbXBvbmVudC5lbCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50LmVudi5xd2ViLnRyaWdnZXIoXCJkb20tYXBwZW5kZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNhbGwgcGF0Y2hlZC9tb3VudGVkIGhvb2sgb24gZWFjaCBmaWJlciBvZiAocmV2ZXJzZWQpIHBhdGNoUXVldWVcclxuICAgICAgICBmb3IgKGxldCBpID0gcGF0Y2hMZW4gLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBjb25zdCBmaWJlciA9IHBhdGNoUXVldWVbaV07XHJcbiAgICAgICAgICAgIGNvbXBvbmVudCA9IGZpYmVyLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgaWYgKGZpYmVyLnNob3VsZFBhdGNoICYmICF0aGlzLnRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnBhdGNoZWQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfXy5wYXRjaGVkQ0IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfXy5wYXRjaGVkQ0IoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnRhcmdldCA/IGluRE9NIDogdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fY2FsbE1vdW50ZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FuY2VsIGEgZmliZXIgYW5kIGFsbCBpdHMgY2hpbGRyZW4uXHJcbiAgICAgKi9cclxuICAgIGNhbmNlbCgpIHtcclxuICAgICAgICB0aGlzLl93YWxrKGYgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWYuaXNSZW5kZXJlZCkge1xyXG4gICAgICAgICAgICAgICAgZi5yb290LmNvdW50ZXItLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmLmlzQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIGYuY2hpbGQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgaXMgdGhlIGdsb2JhbCBlcnJvciBoYW5kbGVyIGZvciBlcnJvcnMgb2NjdXJyaW5nIGluIE93bCBtYWluIGxpZmVjeWNsZVxyXG4gICAgICogbWV0aG9kcy4gIENhdWdodCBlcnJvcnMgYXJlIHRyaWdnZXJlZCBvbiB0aGUgUVdlYiBpbnN0YW5jZSwgYW5kIGFyZVxyXG4gICAgICogcG90ZW50aWFsbHkgZ2l2ZW4gdG8gc29tZSBwYXJlbnQgY29tcG9uZW50IHdoaWNoIGltcGxlbWVudHMgYGNhdGNoRXJyb3JgLlxyXG4gICAgICpcclxuICAgICAqIElmIHRoZXJlIGFyZSBubyBzdWNoIGNvbXBvbmVudCwgd2UgZGVzdHJveSBldmVyeXRoaW5nLiBUaGlzIGlzIGJldHRlciB0aGFuXHJcbiAgICAgKiBiZWluZyBpbiBhIGNvcnJ1cHRlZCBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgaGFuZGxlRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICBsZXQgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy52bm9kZSA9IGNvbXBvbmVudC5fX293bF9fLnZub2RlIHx8IGgoXCJkaXZcIik7XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IGNvbXBvbmVudC5lbnYucXdlYjtcclxuICAgICAgICBsZXQgcm9vdCA9IGNvbXBvbmVudDtcclxuICAgICAgICBsZXQgY2FuQ2F0Y2ggPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSAoY29tcG9uZW50ICYmICEoY2FuQ2F0Y2ggPSAhIWNvbXBvbmVudC5jYXRjaEVycm9yKSkge1xyXG4gICAgICAgICAgICByb290ID0gY29tcG9uZW50O1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnQuX19vd2xfXy5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF3ZWIudHJpZ2dlcihcImVycm9yXCIsIGVycm9yKTtcclxuICAgICAgICBpZiAoY2FuQ2F0Y2gpIHtcclxuICAgICAgICAgICAgY29tcG9uZW50LmNhdGNoRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhlIDMgbmV4dCBsaW5lcyBhaW0gdG8gbWFyayB0aGUgcm9vdCBmaWJlciBhcyBiZWluZyBpbiBlcnJvciwgYW5kXHJcbiAgICAgICAgICAgIC8vIHRvIGZvcmNlIGl0IHRvIGVuZCwgd2l0aG91dCB3YWl0aW5nIGZvciBpdHMgY2hpbGRyZW5cclxuICAgICAgICAgICAgdGhpcy5yb290LmNvdW50ZXIgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgc2NoZWR1bGVyLmZsdXNoKCk7XHJcbiAgICAgICAgICAgIHJvb3QuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5GaWJlci5uZXh0SWQgPSAxO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBQcm9wIHZhbGlkYXRpb24gaGVscGVyXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB0aGUgY29tcG9uZW50IHByb3BzIChvciBuZXh0IHByb3BzKSBhZ2FpbnN0IHRoZSAoc3RhdGljKSBwcm9wc1xyXG4gKiBkZXNjcmlwdGlvbi4gIFRoaXMgaXMgcG90ZW50aWFsbHkgYW4gZXhwZW5zaXZlIG9wZXJhdGlvbjogaXQgbWF5IG5lZWRzIHRvXHJcbiAqIHZpc2l0IHJlY3Vyc2l2ZWx5IHRoZSBwcm9wcyBhbmQgYWxsIHRoZSBjaGlsZHJlbiB0byBjaGVjayBpZiB0aGV5IGFyZSB2YWxpZC5cclxuICogVGhpcyBpcyB3aHkgaXQgaXMgb25seSBkb25lIGluICdkZXYnIG1vZGUuXHJcbiAqL1xyXG5RV2ViLnV0aWxzLnZhbGlkYXRlUHJvcHMgPSBmdW5jdGlvbiAoV2lkZ2V0LCBwcm9wcykge1xyXG4gICAgY29uc3QgcHJvcHNEZWYgPSBXaWRnZXQucHJvcHM7XHJcbiAgICBpZiAocHJvcHNEZWYgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIC8vIGxpc3Qgb2Ygc3RyaW5ncyAocHJvcCBuYW1lcylcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHByb3BzRGVmLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wTmFtZSA9IHByb3BzRGVmW2ldO1xyXG4gICAgICAgICAgICBpZiAocHJvcE5hbWVbcHJvcE5hbWUubGVuZ3RoIC0gMV0gPT09IFwiP1wiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBvcHRpb25hbCBwcm9wXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIShwcm9wTmFtZSBpbiBwcm9wcykpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBwcm9wcyAnJHtwcm9wc0RlZltpXX0nIChjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9JylgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgaWYgKCFwcm9wc0RlZi5pbmNsdWRlcyhrZXkpICYmICFwcm9wc0RlZi5pbmNsdWRlcyhrZXkgKyBcIj9cIikpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBwcm9wICcke2tleX0nIGdpdmVuIHRvIGNvbXBvbmVudCAnJHtXaWRnZXQubmFtZX0nYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChwcm9wc0RlZikge1xyXG4gICAgICAgIC8vIHByb3BzRGVmIGlzIGFuIG9iamVjdCBub3dcclxuICAgICAgICBmb3IgKGxldCBwcm9wTmFtZSBpbiBwcm9wc0RlZikge1xyXG4gICAgICAgICAgICBpZiAocHJvcHNbcHJvcE5hbWVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wc0RlZltwcm9wTmFtZV0gJiYgIXByb3BzRGVmW3Byb3BOYW1lXS5vcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBwcm9wcyAnJHtwcm9wTmFtZX0nIChjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9JylgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBpc1ZhbGlkO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWRQcm9wKHByb3BzW3Byb3BOYW1lXSwgcHJvcHNEZWZbcHJvcE5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5tZXNzYWdlID0gYEludmFsaWQgcHJvcCAnJHtwcm9wTmFtZX0nIGluIGNvbXBvbmVudCAke1dpZGdldC5uYW1lfSAoJHtlLm1lc3NhZ2V9KWA7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIFByb3AgJyR7cHJvcE5hbWV9JyBpbiBjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9J2ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHByb3BOYW1lIGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgIGlmICghKHByb3BOYW1lIGluIHByb3BzRGVmKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHByb3AgJyR7cHJvcE5hbWV9JyBnaXZlbiB0byBjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9J2ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogQ2hlY2sgaWYgYW4gaW52aWR1YWwgcHJvcCB2YWx1ZSBtYXRjaGVzIGl0cyAoc3RhdGljKSBwcm9wIGRlZmluaXRpb25cclxuICovXHJcbmZ1bmN0aW9uIGlzVmFsaWRQcm9wKHByb3AsIHByb3BEZWYpIHtcclxuICAgIGlmIChwcm9wRGVmID09PSB0cnVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHByb3BEZWYgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGEgdmFsdWUgaXMgY29uc3RydWN0ZWQgYnkgc29tZSBDb25zdHJ1Y3Rvci4gIE5vdGUgdGhhdCB0aGVyZSBpcyBhXHJcbiAgICAgICAgLy8gc2xpZ2h0IGFidXNlIG9mIGxhbmd1YWdlOiB3ZSB3YW50IHRvIGNvbnNpZGVyIHByaW1pdGl2ZSB2YWx1ZXMgYXMgd2VsbC5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFNvLCBldmVuIHRob3VnaCAxIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBOdW1iZXIsIHdlIHdhbnQgdG8gY29uc2lkZXIgdGhhdFxyXG4gICAgICAgIC8vIGl0IGlzIHZhbGlkLlxyXG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvcCBpbnN0YW5jZW9mIHByb3BEZWY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlb2YgcHJvcCA9PT0gcHJvcERlZi5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChwcm9wRGVmIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAvLyBJZiB0aGlzIGNvZGUgaXMgZXhlY3V0ZWQsIHRoaXMgbWVhbnMgdGhhdCB3ZSB3YW50IHRvIGNoZWNrIGlmIGEgcHJvcFxyXG4gICAgICAgIC8vIG1hdGNoZXMgYXQgbGVhc3Qgb25lIG9mIGl0cyBkZXNjcmlwdG9yLlxyXG4gICAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaUxlbiA9IHByb3BEZWYubGVuZ3RoOyBpIDwgaUxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCB8fCBpc1ZhbGlkUHJvcChwcm9wLCBwcm9wRGVmW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8vIHByb3BzRGVmIGlzIGFuIG9iamVjdFxyXG4gICAgaWYgKHByb3BEZWYub3B0aW9uYWwgJiYgcHJvcCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBsZXQgcmVzdWx0ID0gcHJvcERlZi50eXBlID8gaXNWYWxpZFByb3AocHJvcCwgcHJvcERlZi50eXBlKSA6IHRydWU7XHJcbiAgICBpZiAocHJvcERlZi52YWxpZGF0ZSkge1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBwcm9wRGVmLnZhbGlkYXRlKHByb3ApO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3BEZWYudHlwZSA9PT0gQXJyYXkgJiYgcHJvcERlZi5lbGVtZW50KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlMZW4gPSBwcm9wLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgaXNWYWxpZFByb3AocHJvcFtpXSwgcHJvcERlZi5lbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAocHJvcERlZi50eXBlID09PSBPYmplY3QgJiYgcHJvcERlZi5zaGFwZSkge1xyXG4gICAgICAgIGNvbnN0IHNoYXBlID0gcHJvcERlZi5zaGFwZTtcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gc2hhcGUpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGlzVmFsaWRQcm9wKHByb3Bba2V5XSwgc2hhcGVba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgcHJvcE5hbWUgaW4gcHJvcCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEocHJvcE5hbWUgaW4gc2hhcGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIHByb3AgJyR7cHJvcE5hbWV9J2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxuXG4vKipcclxuICogT3dsIFN0eWxlIFN5c3RlbVxyXG4gKlxyXG4gKiBUaGlzIGZpbGVzIGNvbnRhaW5zIHRoZSBPd2wgY29kZSByZWxhdGVkIHRvIHByb2Nlc3NpbmcgKGV4dGVuZGVkKSBjc3Mgc3RyaW5nc1xyXG4gKiBhbmQgY3JlYXRpbmcvYWRkaW5nIDxzdHlsZT4gdGFncyB0byB0aGUgZG9jdW1lbnQgaGVhZC5cclxuICovXHJcbmNvbnN0IFNUWUxFU0hFRVRTID0ge307XHJcbmZ1bmN0aW9uIHByb2Nlc3NTaGVldChzdHIpIHtcclxuICAgIGNvbnN0IHRva2VucyA9IHN0ci5zcGxpdCgvKFxce3xcXH18OykvKS5tYXAocyA9PiBzLnRyaW0oKSk7XHJcbiAgICBjb25zdCBzZWxlY3RvclN0YWNrID0gW107XHJcbiAgICBjb25zdCBwYXJ0cyA9IFtdO1xyXG4gICAgbGV0IHJ1bGVzID0gW107XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVNlbGVjdG9yKHN0YWNrSW5kZXgsIHBhcmVudFNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdG9yIG9mIHNlbGVjdG9yU3RhY2tbc3RhY2tJbmRleF0pIHtcclxuICAgICAgICAgICAgbGV0IHBhcnQgPSAocGFyZW50U2VsZWN0b3IgJiYgcGFyZW50U2VsZWN0b3IgKyBcIiBcIiArIHNlbGVjdG9yKSB8fCBzZWxlY3RvcjtcclxuICAgICAgICAgICAgaWYgKHBhcnQuaW5jbHVkZXMoXCImXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJ0ID0gc2VsZWN0b3IucmVwbGFjZSgvJi9nLCBwYXJlbnRTZWxlY3RvciB8fCBcIlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3RhY2tJbmRleCA8IHNlbGVjdG9yU3RhY2subGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgcGFydCA9IGdlbmVyYXRlU2VsZWN0b3Ioc3RhY2tJbmRleCArIDEsIHBhcnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2gocGFydCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKFwiLCBcIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVJ1bGVzKCkge1xyXG4gICAgICAgIGlmIChydWxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChnZW5lcmF0ZVNlbGVjdG9yKDApICsgXCIge1wiKTtcclxuICAgICAgICAgICAgcGFydHMucHVzaCguLi5ydWxlcyk7XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgICAgICBydWxlcyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHdoaWxlICh0b2tlbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgbGV0IHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XHJcbiAgICAgICAgaWYgKHRva2VuID09PSBcIn1cIikge1xyXG4gICAgICAgICAgICBnZW5lcmF0ZVJ1bGVzKCk7XHJcbiAgICAgICAgICAgIHNlbGVjdG9yU3RhY2sucG9wKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodG9rZW5zWzBdID09PSBcIntcIikge1xyXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVSdWxlcygpO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JTdGFjay5wdXNoKHRva2VuLnNwbGl0KC9cXHMqLFxccyovKSk7XHJcbiAgICAgICAgICAgICAgICB0b2tlbnMuc2hpZnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9rZW5zWzBdID09PSBcIjtcIikge1xyXG4gICAgICAgICAgICAgICAgcnVsZXMucHVzaChcIiAgXCIgKyB0b2tlbiArIFwiO1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJ0cy5qb2luKFwiXFxuXCIpO1xyXG59XHJcbmZ1bmN0aW9uIHJlZ2lzdGVyU2hlZXQoaWQsIGNzcykge1xyXG4gICAgY29uc3Qgc2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcbiAgICBzaGVldC5pbm5lckhUTUwgPSBwcm9jZXNzU2hlZXQoY3NzKTtcclxuICAgIFNUWUxFU0hFRVRTW2lkXSA9IHNoZWV0O1xyXG59XHJcbmZ1bmN0aW9uIGFjdGl2YXRlU2hlZXQoaWQsIG5hbWUpIHtcclxuICAgIGNvbnN0IHNoZWV0ID0gU1RZTEVTSEVFVFNbaWRdO1xyXG4gICAgaWYgKCFzaGVldCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBjc3Mgc3R5bGVzaGVldCBmb3IgY29tcG9uZW50ICcke25hbWV9Jy4gRGlkIHlvdSBmb3JnZXQgdG8gdXNlIHRoZSAnY3NzJyB0YWcgaGVscGVyP2ApO1xyXG4gICAgfVxyXG4gICAgc2hlZXQuc2V0QXR0cmlidXRlKFwiY29tcG9uZW50XCIsIG5hbWUpO1xyXG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzaGVldCk7XHJcbn1cblxuY29uc3QgcG9ydGFsU3ltYm9sID0gU3ltYm9sKFwicG9ydGFsXCIpOyAvLyBGSVhNRVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb21wb25lbnRcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxubGV0IG5leHRJZCA9IDE7XHJcbmNsYXNzIENvbXBvbmVudCB7XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBMaWZlY3ljbGVcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBDb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IG1vc3Qgb2YgdGhlIHRpbWUsIG9ubHkgdGhlIHJvb3QgY29tcG9uZW50IG5lZWRzIHRvIGJlIGNyZWF0ZWQgYnlcclxuICAgICAqIGhhbmQuICBPdGhlciBjb21wb25lbnRzIHNob3VsZCBiZSBjcmVhdGVkIGF1dG9tYXRpY2FsbHkgYnkgdGhlIGZyYW1ld29yayAod2l0aFxyXG4gICAgICogdGhlIHQtY29tcG9uZW50IGRpcmVjdGl2ZSBpbiBhIHRlbXBsYXRlKVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQsIHByb3BzKSB7XHJcbiAgICAgICAgQ29tcG9uZW50LmN1cnJlbnQgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjb25zdHIgPSB0aGlzLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9wcyA9IGNvbnN0ci5kZWZhdWx0UHJvcHM7XHJcbiAgICAgICAgaWYgKGRlZmF1bHRQcm9wcykge1xyXG4gICAgICAgICAgICBwcm9wcyA9IHByb3BzIHx8IHt9O1xyXG4gICAgICAgICAgICB0aGlzLl9fYXBwbHlEZWZhdWx0UHJvcHMocHJvcHMsIGRlZmF1bHRQcm9wcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJvcHMgPSBwcm9wcztcclxuICAgICAgICBpZiAoUVdlYi5kZXYpIHtcclxuICAgICAgICAgICAgUVdlYi51dGlscy52YWxpZGF0ZVByb3BzKGNvbnN0ciwgdGhpcy5wcm9wcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGlkID0gbmV4dElkKys7XHJcbiAgICAgICAgbGV0IGRlcHRoO1xyXG4gICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbnYgPSBwYXJlbnQuZW52O1xyXG4gICAgICAgICAgICBjb25zdCBfX3Bvd2xfXyA9IHBhcmVudC5fX293bF9fO1xyXG4gICAgICAgICAgICBfX3Bvd2xfXy5jaGlsZHJlbltpZF0gPSB0aGlzO1xyXG4gICAgICAgICAgICBkZXB0aCA9IF9fcG93bF9fLmRlcHRoICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHdlIGFyZSB0aGUgcm9vdCBjb21wb25lbnRcclxuICAgICAgICAgICAgdGhpcy5lbnYgPSB0aGlzLmNvbnN0cnVjdG9yLmVudjtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmVudi5xd2ViKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViID0gbmV3IFFXZWIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZW52LmJyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW52LmJyb3dzZXIgPSBicm93c2VyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZW52LnF3ZWIub24oXCJ1cGRhdGVcIiwgdGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX19vd2xfXy5pc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9fb3dsX18uaXNEZXN0cm95ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIHVubGlrZWx5IHRvIGhhcHBlbiwgYnV0IGlmIGEgcm9vdCB3aWRnZXQgaXMgZGVzdHJveWVkLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIHdhbnQgdG8gcmVtb3ZlIG91ciBzdWJzY3JpcHRpb24uICBUaGUgdXN1YWwgd2F5IHRvIGRvIHRoYXRcclxuICAgICAgICAgICAgICAgICAgICAvLyB3b3VsZCBiZSB0byBwZXJmb3JtIHNvbWUgY2hlY2sgaW4gdGhlIGRlc3Ryb3kgbWV0aG9kLCBidXQgc2luY2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBpdCBpcyB2ZXJ5IHBlcmZvcm1hbmNlIHNlbnNpdGl2ZSwgYW5kIHNpbmNlIHRoaXMgaXMgYSByYXJlIGV2ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIHNpbXBseSBkbyBpdCBsYXppbHlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViLm9mZihcInVwZGF0ZVwiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRlcHRoID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IHRoaXMuZW52LnF3ZWI7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBjb25zdHIudGVtcGxhdGUgfHwgdGhpcy5fX2dldFRlbXBsYXRlKHF3ZWIpO1xyXG4gICAgICAgIHRoaXMuX19vd2xfXyA9IHtcclxuICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICBkZXB0aDogZGVwdGgsXHJcbiAgICAgICAgICAgIHZub2RlOiBudWxsLFxyXG4gICAgICAgICAgICBwdm5vZGU6IG51bGwsXHJcbiAgICAgICAgICAgIGlzTW91bnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGlzRGVzdHJveWVkOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQgfHwgbnVsbCxcclxuICAgICAgICAgICAgY2hpbGRyZW46IHt9LFxyXG4gICAgICAgICAgICBjbWFwOiB7fSxcclxuICAgICAgICAgICAgY3VycmVudEZpYmVyOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJlbnRMYXN0RmliZXJJZDogMCxcclxuICAgICAgICAgICAgYm91bmRIYW5kbGVyczoge30sXHJcbiAgICAgICAgICAgIG1vdW50ZWRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFVubW91bnRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFBhdGNoQ0I6IG51bGwsXHJcbiAgICAgICAgICAgIHBhdGNoZWRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFN0YXJ0Q0I6IG51bGwsXHJcbiAgICAgICAgICAgIHdpbGxVcGRhdGVQcm9wc0NCOiBudWxsLFxyXG4gICAgICAgICAgICBvYnNlcnZlcjogbnVsbCxcclxuICAgICAgICAgICAgcmVuZGVyRm46IHF3ZWIucmVuZGVyLmJpbmQocXdlYiwgdGVtcGxhdGUpLFxyXG4gICAgICAgICAgICBjbGFzc09iajogbnVsbCxcclxuICAgICAgICAgICAgcmVmczogbnVsbCxcclxuICAgICAgICAgICAgc2NvcGU6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChjb25zdHIuc3R5bGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fX2FwcGx5U3R5bGVzKGNvbnN0cik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgYGVsYCBpcyB0aGUgcm9vdCBlbGVtZW50IG9mIHRoZSBjb21wb25lbnQuICBOb3RlIHRoYXQgaXQgY291bGQgYmUgbnVsbDpcclxuICAgICAqIHRoaXMgaXMgdGhlIGNhc2UgaWYgdGhlIGNvbXBvbmVudCBpcyBub3QgbW91bnRlZCB5ZXQsIG9yIGlzIGRlc3Ryb3llZC5cclxuICAgICAqL1xyXG4gICAgZ2V0IGVsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9fb3dsX18udm5vZGUgPyB0aGlzLl9fb3dsX18udm5vZGUuZWxtIDogbnVsbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogd2lsbFN0YXJ0IGlzIGFuIGFzeW5jaHJvbm91cyBob29rIHRoYXQgY2FuIGJlIGltcGxlbWVudGVkIHRvIHBlcmZvcm0gc29tZVxyXG4gICAgICogYWN0aW9uIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcgb2YgYSBjb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogSXQgd2lsbCBiZSBjYWxsZWQgZXhhY3RseSBvbmNlIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcuIEl0IGlzIHVzZWZ1bFxyXG4gICAgICogaW4gc29tZSBjYXNlcywgZm9yIGV4YW1wbGUsIHRvIGxvYWQgZXh0ZXJuYWwgYXNzZXRzIChzdWNoIGFzIGEgSlMgbGlicmFyeSlcclxuICAgICAqIGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIHJlbmRlcmVkLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCBhIHNsb3cgd2lsbFN0YXJ0IG1ldGhvZCB3aWxsIHNsb3cgZG93biB0aGUgcmVuZGVyaW5nIG9mIHRoZSB1c2VyXHJcbiAgICAgKiBpbnRlcmZhY2UuICBUaGVyZWZvcmUsIHNvbWUgZWZmb3J0IHNob3VsZCBiZSBtYWRlIHRvIG1ha2UgdGhpcyBtZXRob2QgYXNcclxuICAgICAqIGZhc3QgYXMgcG9zc2libGUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZTogdGhpcyBtZXRob2Qgc2hvdWxkIG5vdCBiZSBjYWxsZWQgbWFudWFsbHkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHdpbGxTdGFydCgpIHsgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBtb3VudGVkIGlzIGEgaG9vayB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYSBjb21wb25lbnQgaXMgYXR0YWNoZWQgdG8gdGhlXHJcbiAgICAgKiBET00uIFRoaXMgaXMgYSBnb29kIHBsYWNlIHRvIGFkZCBzb21lIGxpc3RlbmVycywgb3IgdG8gaW50ZXJhY3Qgd2l0aCB0aGVcclxuICAgICAqIERPTSwgaWYgdGhlIGNvbXBvbmVudCBuZWVkcyB0byBwZXJmb3JtIHNvbWUgbWVhc3VyZSBmb3IgZXhhbXBsZS5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlOiB0aGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGNhbGxlZCBtYW51YWxseS5cclxuICAgICAqXHJcbiAgICAgKiBAc2VlIHdpbGxVbm1vdW50XHJcbiAgICAgKi9cclxuICAgIG1vdW50ZWQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHdpbGxVcGRhdGVQcm9wcyBpcyBhbiBhc3luY2hyb25vdXMgaG9vaywgY2FsbGVkIGp1c3QgYmVmb3JlIG5ldyBwcm9wc1xyXG4gICAgICogYXJlIHNldC4gVGhpcyBpcyB1c2VmdWwgaWYgdGhlIGNvbXBvbmVudCBuZWVkcyBzb21lIGFzeW5jaHJvbm91cyB0YXNrXHJcbiAgICAgKiBwZXJmb3JtZWQsIGRlcGVuZGluZyBvbiB0aGUgcHJvcHMgKGZvciBleGFtcGxlLCBhc3N1bWluZyB0aGF0IHRoZSBwcm9wcyBhcmVcclxuICAgICAqIHNvbWUgcmVjb3JkIElkLCBmZXRjaGluZyB0aGUgcmVjb3JkIGRhdGEpLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaG9vayBpcyBub3QgY2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgcmVuZGVyIChidXQgd2lsbFN0YXJ0IGlzIGNhbGxlZFxyXG4gICAgICogYW5kIHBlcmZvcm1zIGEgc2ltaWxhciBqb2IpLlxyXG4gICAgICovXHJcbiAgICBhc3luYyB3aWxsVXBkYXRlUHJvcHMobmV4dFByb3BzKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHdpbGxQYXRjaCBob29rIGlzIGNhbGxlZCBqdXN0IGJlZm9yZSB0aGUgRE9NIHBhdGNoaW5nIHByb2Nlc3Mgc3RhcnRzLlxyXG4gICAgICogSXQgaXMgbm90IGNhbGxlZCBvbiB0aGUgaW5pdGlhbCByZW5kZXIuICBUaGlzIGlzIHVzZWZ1bCB0byBnZXQgc29tZVxyXG4gICAgICogaW5mb3JtYXRpb24gd2hpY2ggYXJlIGluIHRoZSBET00uICBGb3IgZXhhbXBsZSwgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlXHJcbiAgICAgKiBzY3JvbGxiYXJcclxuICAgICAqL1xyXG4gICAgd2lsbFBhdGNoKCkgeyB9XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgaG9vayBpcyBjYWxsZWQgd2hlbmV2ZXIgYSBjb21wb25lbnQgZGlkIGFjdHVhbGx5IHVwZGF0ZSBpdHMgcHJvcHMsXHJcbiAgICAgKiBzdGF0ZSBvciBlbnYuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgbm90IGNhbGxlZCBvbiB0aGUgaW5pdGlhbCByZW5kZXIuIEl0IGlzIHVzZWZ1bCB0byBpbnRlcmFjdFxyXG4gICAgICogd2l0aCB0aGUgRE9NIChmb3IgZXhhbXBsZSwgdGhyb3VnaCBhbiBleHRlcm5hbCBsaWJyYXJ5KSB3aGVuZXZlciB0aGVcclxuICAgICAqIGNvbXBvbmVudCB3YXMgdXBkYXRlZC5cclxuICAgICAqXHJcbiAgICAgKiBVcGRhdGluZyB0aGUgY29tcG9uZW50IHN0YXRlIGluIHRoaXMgaG9vayBpcyBwb3NzaWJsZSwgYnV0IG5vdCBlbmNvdXJhZ2VkLlxyXG4gICAgICogT25lIG5lZWQgdG8gYmUgY2FyZWZ1bCwgYmVjYXVzZSB1cGRhdGVzIGhlcmUgd2lsbCBjYXVzZSByZXJlbmRlciwgd2hpY2ggaW5cclxuICAgICAqIHR1cm4gd2lsbCBjYXVzZSBvdGhlciBjYWxscyB0byB1cGRhdGVkLiBTbywgd2UgbmVlZCB0byBiZSBwYXJ0aWN1bGFybHlcclxuICAgICAqIGNhcmVmdWwgYXQgYXZvaWRpbmcgZW5kbGVzcyBjeWNsZXMuXHJcbiAgICAgKi9cclxuICAgIHBhdGNoZWQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogd2lsbFVubW91bnQgaXMgYSBob29rIHRoYXQgaXMgY2FsbGVkIGVhY2ggdGltZSBqdXN0IGJlZm9yZSBhIGNvbXBvbmVudCBpc1xyXG4gICAgICogdW5tb3VudGVkIGZyb20gdGhlIERPTS4gVGhpcyBpcyBhIGdvb2QgcGxhY2UgdG8gcmVtb3ZlIHNvbWUgbGlzdGVuZXJzLCBmb3JcclxuICAgICAqIGV4YW1wbGUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZTogdGhpcyBtZXRob2Qgc2hvdWxkIG5vdCBiZSBjYWxsZWQgbWFudWFsbHkuXHJcbiAgICAgKlxyXG4gICAgICogQHNlZSBtb3VudGVkXHJcbiAgICAgKi9cclxuICAgIHdpbGxVbm1vdW50KCkgeyB9XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQdWJsaWNcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8qKlxyXG4gICAgICogTW91bnQgdGhlIGNvbXBvbmVudCB0byBhIHRhcmdldCBlbGVtZW50LlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgc2hvdWxkIG9ubHkgYmUgZG9uZSBpZiB0aGUgY29tcG9uZW50IHdhcyBjcmVhdGVkIG1hbnVhbGx5LiBDb21wb25lbnRzXHJcbiAgICAgKiBjcmVhdGVkIGRlY2xhcmF0aXZlbHkgaW4gdGVtcGxhdGVzIGFyZSBtYW5hZ2VkIGJ5IHRoZSBPd2wgc3lzdGVtLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCBhIGNvbXBvbmVudCBjYW4gYmUgbW91bnRlZCBhbiB1bm1vdW50ZWQgc2V2ZXJhbCB0aW1lc1xyXG4gICAgICovXHJcbiAgICBhc3luYyBtb3VudCh0YXJnZXQsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gb3B0aW9ucy5wb3NpdGlvbiB8fCBcImxhc3QtY2hpbGRcIjtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmIChfX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICBpZiAocG9zaXRpb24gIT09IFwic2VsZlwiICYmIHRoaXMuZWwucGFyZW50Tm9kZSAhPT0gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbiB0aGlzIHNpdHVhdGlvbiwgd2UgYXJlIHRyeWluZyB0byBtb3VudCBhIGNvbXBvbmVudCBvbiBhIGRpZmZlcmVudFxyXG4gICAgICAgICAgICAgICAgLy8gdGFyZ2V0LiBJbiB0aGlzIGNhc2UsIHdlIG5lZWQgdG8gdW5tb3VudCBmaXJzdCwgb3RoZXJ3aXNlIGl0IHdpbGxcclxuICAgICAgICAgICAgICAgIC8vIG5vdCB3b3JrLlxyXG4gICAgICAgICAgICAgICAgdGhpcy51bm1vdW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWJlciA9IF9fb3dsX18uY3VycmVudEZpYmVyO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudEZpYmVyLnRhcmdldCA9PT0gdGFyZ2V0ICYmIGN1cnJlbnRGaWJlci5wb3NpdGlvbiA9PT0gcG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY2hlZHVsZXIuYWRkRmliZXIoY3VycmVudEZpYmVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNjaGVkdWxlci5yZWplY3RGaWJlcihjdXJyZW50RmliZXIsIFwiTW91bnRpbmcgb3BlcmF0aW9uIGNhbmNlbGxlZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCB8fCB0YXJnZXQgaW5zdGFuY2VvZiBEb2N1bWVudEZyYWdtZW50KSkge1xyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9IGBDb21wb25lbnQgJyR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfScgY2Fubm90IGJlIG1vdW50ZWQ6IHRoZSB0YXJnZXQgaXMgbm90IGEgdmFsaWQgRE9NIG5vZGUuYDtcclxuICAgICAgICAgICAgbWVzc2FnZSArPSBgXFxuTWF5YmUgdGhlIERPTSBpcyBub3QgcmVhZHkgeWV0PyAoaW4gdGhhdCBjYXNlLCB5b3UgY2FuIHVzZSBvd2wudXRpbHMud2hlblJlYWR5KWA7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIobnVsbCwgdGhpcywgZmFsc2UsIHRhcmdldCwgcG9zaXRpb24pO1xyXG4gICAgICAgIGZpYmVyLnNob3VsZFBhdGNoID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKCFfX293bF9fLnZub2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19wcmVwYXJlQW5kUmVuZGVyKGZpYmVyLCAoKSA9PiB7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fX3JlbmRlcihmaWJlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuYWRkRmliZXIoZmliZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdW5tb3VudCBtZXRob2QgaXMgdGhlIG9wcG9zaXRlIG9mIHRoZSBtb3VudCBtZXRob2QuICBJdCBpcyB1c2VmdWxcclxuICAgICAqIHRvIGNhbGwgd2lsbFVubW91bnQgY2FsbHMgYW5kIHJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTS5cclxuICAgICAqL1xyXG4gICAgdW5tb3VudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5fX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9fY2FsbFdpbGxVbm1vdW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcmVuZGVyIG1ldGhvZCBpcyB0aGUgbWFpbiBlbnRyeSBwb2ludCB0byByZW5kZXIgYSBjb21wb25lbnQgKG9uY2UgaXRcclxuICAgICAqIGlzIHJlYWR5LiBUaGlzIG1ldGhvZCBpcyBub3QgaW5pdGlhbGx5IGNhbGxlZCB3aGVuIHRoZSBjb21wb25lbnQgaXNcclxuICAgICAqIHJlbmRlcmVkIHRoZSBmaXJzdCB0aW1lKS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGNhdXNlIGFsbCBpdHMgc3ViIGNvbXBvbmVudHMgdG8gcG90ZW50aWFsbHkgcmVyZW5kZXJcclxuICAgICAqIHRoZW1zZWx2ZXMuICBOb3RlIHRoYXQgYHJlbmRlcmAgaXMgbm90IGNhbGxlZCBpZiBhIGNvbXBvbmVudCBpcyB1cGRhdGVkIHZpYVxyXG4gICAgICogaXRzIHByb3BzLlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZW5kZXIoZm9yY2UgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgY29uc3QgY3VycmVudEZpYmVyID0gX19vd2xfXy5jdXJyZW50RmliZXI7XHJcbiAgICAgICAgaWYgKCFfX293bF9fLmlzTW91bnRlZCAmJiAhY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHdlIGdldCBoZXJlLCB0aGlzIG1lYW5zIHRoYXQgdGhlIGNvbXBvbmVudCB3YXMgZWl0aGVyIG5ldmVyIG1vdW50ZWQsXHJcbiAgICAgICAgICAgIC8vIG9yIHdhcyB1bm1vdW50ZWQgYW5kIHNvbWUgc3RhdGUgY2hhbmdlICB0cmlnZ2VyZWQgYSByZW5kZXIuIEVpdGhlciB3YXksXHJcbiAgICAgICAgICAgIC8vIHdlIGRvIG5vdCB3YW50IHRvIGFjdHVhbGx5IHJlbmRlciBhbnl0aGluZyBpbiB0aGlzIGNhc2UuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnJlbnRGaWJlciAmJiAhY3VycmVudEZpYmVyLmlzUmVuZGVyZWQgJiYgIWN1cnJlbnRGaWJlci5pc0NvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLmFkZEZpYmVyKGN1cnJlbnRGaWJlci5yb290KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IG1vdW50ZWQgYXQgdGhpcyBwb2ludCwgaXQgaW1wbGllcyB0aGF0IHRoZXJlIGlzIGFcclxuICAgICAgICAvLyBjdXJyZW50RmliZXIgdGhhdCBpcyBhbHJlYWR5IHJlbmRlcmVkIChpc1JlbmRlcmVkIGlzIHRydWUpLCBzbyB3ZSBhcmVcclxuICAgICAgICAvLyBhYm91dCB0byBiZSBtb3VudGVkXHJcbiAgICAgICAgY29uc3QgaXNNb3VudGVkID0gX19vd2xfXy5pc01vdW50ZWQ7XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIobnVsbCwgdGhpcywgZm9yY2UsIG51bGwsIG51bGwpO1xyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoX19vd2xfXy5pc01vdW50ZWQgfHwgIWlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gd2UgYXJlIG1vdW50ZWQgKF9fb3dsX18uaXNNb3VudGVkKSwgb3IgaWYgd2UgYXJlIGN1cnJlbnRseSBiZWluZ1xyXG4gICAgICAgICAgICAgICAgLy8gbW91bnRlZCAoIWlzTW91bnRlZCksIHNvIHdlIGNhbGwgX19yZW5kZXJcclxuICAgICAgICAgICAgICAgIHRoaXMuX19yZW5kZXIoZmliZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gd2Ugd2VyZSBtb3VudGVkIHdoZW4gcmVuZGVyIHdhcyBjYWxsZWQsIGJ1dCB3ZSBhcmVuJ3QgYW55bW9yZSwgc28gd2VcclxuICAgICAgICAgICAgICAgIC8vIHdlcmUgYWN0dWFsbHkgYWJvdXQgdG8gYmUgdW5tb3VudGVkIDsgd2UgY2FuIHRodXMgZm9yZ2V0IGFib3V0IHRoaXNcclxuICAgICAgICAgICAgICAgIC8vIGZpYmVyXHJcbiAgICAgICAgICAgICAgICBmaWJlci5pc0NvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBfX293bF9fLmN1cnJlbnRGaWJlciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLmFkZEZpYmVyKGZpYmVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRGVzdHJveSB0aGUgY29tcG9uZW50LiAgVGhpcyBvcGVyYXRpb24gaXMgcXVpdGUgY29tcGxleDpcclxuICAgICAqICAtIGl0IHJlY3Vyc2l2ZWx5IGRlc3Ryb3kgYWxsIGNoaWxkcmVuXHJcbiAgICAgKiAgLSBjYWxsIHRoZSB3aWxsVW5tb3VudCBob29rcyBpZiBuZWNlc3NhcnlcclxuICAgICAqICAtIHJlbW92ZSB0aGUgZG9tIG5vZGUgZnJvbSB0aGUgZG9tXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBzaG91bGQgb25seSBiZSBjYWxsZWQgbWFudWFsbHkgaWYgeW91IGNyZWF0ZWQgdGhlIGNvbXBvbmVudC4gIE1vc3RcclxuICAgICAqIGNvbXBvbmVudHMgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGRlc3Ryb3llZC5cclxuICAgICAqL1xyXG4gICAgZGVzdHJveSgpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmICghX19vd2xfXy5pc0Rlc3Ryb3llZCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IHRoaXMuZWw7XHJcbiAgICAgICAgICAgIHRoaXMuX19kZXN0cm95KF9fb3dsX18ucGFyZW50KTtcclxuICAgICAgICAgICAgaWYgKGVsKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIGJ5IHRoZSBjb21wb25lbnQgc3lzdGVtIHdoZW5ldmVyIGl0cyBwcm9wcyBhcmVcclxuICAgICAqIHVwZGF0ZWQuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlbiB0aGUgY29tcG9uZW50IHdpbGwgYmUgcmVuZGVyZWQuXHJcbiAgICAgKiBPdGhlcndpc2UsIGl0IHdpbGwgc2tpcCB0aGUgcmVuZGVyaW5nIChhbHNvLCBpdHMgcHJvcHMgd2lsbCBub3QgYmUgdXBkYXRlZClcclxuICAgICAqL1xyXG4gICAgc2hvdWxkVXBkYXRlKG5leHRQcm9wcykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBFbWl0IGEgY3VzdG9tIGV2ZW50IG9mIHR5cGUgJ2V2ZW50VHlwZScgd2l0aCB0aGUgZ2l2ZW4gJ3BheWxvYWQnIG9uIHRoZVxyXG4gICAgICogY29tcG9uZW50J3MgZWwsIGlmIGl0IGV4aXN0cy4gSG93ZXZlciwgbm90ZSB0aGF0IHRoZSBldmVudCB3aWxsIG9ubHkgYnViYmxlXHJcbiAgICAgKiB1cCB0byB0aGUgcGFyZW50IERPTSBub2Rlcy4gVGh1cywgaXQgbXVzdCBiZSBjYWxsZWQgYmV0d2VlbiBtb3VudGVkKCkgYW5kXHJcbiAgICAgKiB3aWxsVW5tb3VudCgpLlxyXG4gICAgICovXHJcbiAgICB0cmlnZ2VyKGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIHRoaXMuX190cmlnZ2VyKHRoaXMsIGV2ZW50VHlwZSwgcGF5bG9hZCk7XHJcbiAgICB9XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQcml2YXRlXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGUgaGVscGVyIHRvIHBlcmZvcm0gYSBmdWxsIGRlc3Ryb3ksIGZyb20gdGhlIHBvaW50IG9mIHZpZXcgb2YgYW4gT3dsXHJcbiAgICAgKiBjb21wb25lbnQuIEl0IGRvZXMgbm90IHJlbW92ZSB0aGUgZWwgKHRoaXMgaXMgZG9uZSBvbmx5IG9uY2Ugb24gdGhlIHRvcFxyXG4gICAgICogbGV2ZWwgZGVzdHJveWVkIGNvbXBvbmVudCwgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMpLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBqb2Igb2YgdGhpcyBtZXRob2QgaXMgbW9zdGx5IHRvIGNhbGwgd2lsbFVubW91bnQgaG9va3MsIGFuZCB0byBwZXJmb3JtXHJcbiAgICAgKiBhbGwgbmVjZXNzYXJ5IGludGVybmFsIGNsZWFudXAuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IGl0IGRvZXMgbm90IGNhbGwgdGhlIF9fY2FsbFdpbGxVbm1vdW50IG1ldGhvZCB0byBhdm9pZCB2aXNpdGluZ1xyXG4gICAgICogYWxsIGNoaWxkcmVuIG1hbnkgdGltZXMuXHJcbiAgICAgKi9cclxuICAgIF9fZGVzdHJveShwYXJlbnQpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGNvbnN0IGlzTW91bnRlZCA9IF9fb3dsX18uaXNNb3VudGVkO1xyXG4gICAgICAgIGlmIChpc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgaWYgKF9fb3dsX18ud2lsbFVubW91bnRDQikge1xyXG4gICAgICAgICAgICAgICAgX19vd2xfXy53aWxsVW5tb3VudENCKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy53aWxsVW5tb3VudCgpO1xyXG4gICAgICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IF9fb3dsX18uY2hpbGRyZW47XHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuW2tleV0uX19kZXN0cm95KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IF9fb3dsX18uaWQ7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBwYXJlbnQuX19vd2xfXy5jaGlsZHJlbltpZF07XHJcbiAgICAgICAgICAgIF9fb3dsX18ucGFyZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19vd2xfXy5pc0Rlc3Ryb3llZCA9IHRydWU7XHJcbiAgICAgICAgZGVsZXRlIF9fb3dsX18udm5vZGU7XHJcbiAgICAgICAgaWYgKF9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIF9fb3dsX18uY3VycmVudEZpYmVyLmlzQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfX2NhbGxNb3VudGVkKCkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgX19vd2xfXy5pc01vdW50ZWQgPSB0cnVlO1xyXG4gICAgICAgIF9fb3dsX18uY3VycmVudEZpYmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1vdW50ZWQoKTtcclxuICAgICAgICBpZiAoX19vd2xfXy5tb3VudGVkQ0IpIHtcclxuICAgICAgICAgICAgX19vd2xfXy5tb3VudGVkQ0IoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfX2NhbGxXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmIChfX293bF9fLndpbGxVbm1vdW50Q0IpIHtcclxuICAgICAgICAgICAgX19vd2xfXy53aWxsVW5tb3VudENCKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2lsbFVubW91bnQoKTtcclxuICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19vd2xfXy5jdXJyZW50RmliZXIuaXNDb21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9fb3dsX18uY3VycmVudEZpYmVyLnJvb3QuY291bnRlciA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gX19vd2xfXy5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKGxldCBpZCBpbiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBjb25zdCBjb21wID0gY2hpbGRyZW5baWRdO1xyXG4gICAgICAgICAgICBpZiAoY29tcC5fX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgY29tcC5fX2NhbGxXaWxsVW5tb3VudCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlIHRyaWdnZXIgbWV0aG9kLCBhbGxvd3MgdG8gY2hvb3NlIHRoZSBjb21wb25lbnQgd2hpY2ggdHJpZ2dlcmVkXHJcbiAgICAgKiB0aGUgZXZlbnQgaW4gdGhlIGZpcnN0IHBsYWNlXHJcbiAgICAgKi9cclxuICAgIF9fdHJpZ2dlcihjb21wb25lbnQsIGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IE93bEV2ZW50KGNvbXBvbmVudCwgZXZlbnRUeXBlLCB7XHJcbiAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRldGFpbDogcGF5bG9hZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgdHJpZ2dlckhvb2sgPSB0aGlzLmVudltwb3J0YWxTeW1ib2xdO1xyXG4gICAgICAgICAgICBpZiAodHJpZ2dlckhvb2spIHtcclxuICAgICAgICAgICAgICAgIHRyaWdnZXJIb29rKGV2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoZXYpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIF9fdXBkYXRlUHJvcHMgbWV0aG9kIGlzIGNhbGxlZCBieSB0aGUgdC1jb21wb25lbnQgZGlyZWN0aXZlIHdoZW5ldmVyXHJcbiAgICAgKiBpdCB1cGRhdGVzIGEgY29tcG9uZW50IChzbywgd2hlbiB0aGUgcGFyZW50IHRlbXBsYXRlIGlzIHJlcmVuZGVyZWQpLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBfX3VwZGF0ZVByb3BzKG5leHRQcm9wcywgcGFyZW50RmliZXIsIHNjb3BlKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnNjb3BlID0gc2NvcGU7XHJcbiAgICAgICAgY29uc3Qgc2hvdWxkVXBkYXRlID0gcGFyZW50RmliZXIuZm9yY2UgfHwgdGhpcy5zaG91bGRVcGRhdGUobmV4dFByb3BzKTtcclxuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgICAgIGNvbnN0IGZpYmVyID0gbmV3IEZpYmVyKHBhcmVudEZpYmVyLCB0aGlzLCBwYXJlbnRGaWJlci5mb3JjZSwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgICAgIGlmICghcGFyZW50RmliZXIuY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudEZpYmVyLmNoaWxkID0gZmliZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnRGaWJlci5sYXN0Q2hpbGQuc2libGluZyA9IGZpYmVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZCA9IGZpYmVyO1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0UHJvcHMgPSB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRQcm9wcztcclxuICAgICAgICAgICAgaWYgKGRlZmF1bHRQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fX2FwcGx5RGVmYXVsdFByb3BzKG5leHRQcm9wcywgZGVmYXVsdFByb3BzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoUVdlYi5kZXYpIHtcclxuICAgICAgICAgICAgICAgIFFXZWIudXRpbHMudmFsaWRhdGVQcm9wcyh0aGlzLmNvbnN0cnVjdG9yLCBuZXh0UHJvcHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lsbFVwZGF0ZVByb3BzKG5leHRQcm9wcyksXHJcbiAgICAgICAgICAgICAgICBfX293bF9fLndpbGxVcGRhdGVQcm9wc0NCICYmIF9fb3dsX18ud2lsbFVwZGF0ZVByb3BzQ0IobmV4dFByb3BzKVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgaWYgKGZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wcm9wcyA9IG5leHRQcm9wcztcclxuICAgICAgICAgICAgdGhpcy5fX3JlbmRlcihmaWJlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBNYWluIHBhdGNoaW5nIG1ldGhvZC4gV2UgY2FsbCB0aGUgdmlydHVhbCBkb20gcGF0Y2ggbWV0aG9kIGhlcmUgdG8gY29udmVydFxyXG4gICAgICogYSB2aXJ0dWFsIGRvbSB2bm9kZSBpbnRvIHNvbWUgYWN0dWFsIGRvbS5cclxuICAgICAqL1xyXG4gICAgX19wYXRjaCh0YXJnZXQsIHZub2RlKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnZub2RlID0gcGF0Y2godGFyZ2V0LCB2bm9kZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBfX3ByZXBhcmUgbWV0aG9kIGlzIG9ubHkgY2FsbGVkIGJ5IHRoZSB0LWNvbXBvbmVudCBkaXJlY3RpdmUsIHdoZW4gYVxyXG4gICAgICogc3ViY29tcG9uZW50IGlzIGNyZWF0ZWQuIEl0IGdldHMgaXRzIHNjb3BlLCBpZiBhbnksIGZyb20gdGhlXHJcbiAgICAgKiBwYXJlbnQgdGVtcGxhdGUuXHJcbiAgICAgKi9cclxuICAgIF9fcHJlcGFyZShwYXJlbnRGaWJlciwgc2NvcGUsIGNiKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnNjb3BlID0gc2NvcGU7XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIocGFyZW50RmliZXIsIHRoaXMsIHBhcmVudEZpYmVyLmZvcmNlLCBudWxsLCBudWxsKTtcclxuICAgICAgICBmaWJlci5zaG91bGRQYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICghcGFyZW50RmliZXIuY2hpbGQpIHtcclxuICAgICAgICAgICAgcGFyZW50RmliZXIuY2hpbGQgPSBmaWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZC5zaWJsaW5nID0gZmliZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZCA9IGZpYmVyO1xyXG4gICAgICAgIHRoaXMuX19wcmVwYXJlQW5kUmVuZGVyKGZpYmVyLCBjYik7XHJcbiAgICAgICAgcmV0dXJuIGZpYmVyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBseSB0aGUgc3R5bGVzaGVldHMgZGVmaW5lZCBieSB0aGUgY29tcG9uZW50LiBOb3RlIHRoYXQgd2UgbmVlZCB0byBtYWtlXHJcbiAgICAgKiBzdXJlIGFsbCBpbmhlcml0ZWQgc3R5bGVzaGVldHMgYXJlIGFwcGxpZWQgYXMgd2VsbC4gIFdlIHRoZW4gZGVsZXRlIHRoZVxyXG4gICAgICogYHN0eWxlYCBrZXkgZnJvbSB0aGUgY29uc3RydWN0b3IgdG8gbWFrZSBzdXJlIHdlIGRvIG5vdCBhcHBseSBpdCBhZ2Fpbi5cclxuICAgICAqL1xyXG4gICAgX19hcHBseVN0eWxlcyhjb25zdHIpIHtcclxuICAgICAgICB3aGlsZSAoY29uc3RyICYmIGNvbnN0ci5zdHlsZSkge1xyXG4gICAgICAgICAgICBpZiAoY29uc3RyLmhhc093blByb3BlcnR5KFwic3R5bGVcIikpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2YXRlU2hlZXQoY29uc3RyLnN0eWxlLCBjb25zdHIubmFtZSk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgY29uc3RyLnN0eWxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0ciA9IGNvbnN0ci5fX3Byb3RvX187XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX19nZXRUZW1wbGF0ZShxd2ViKSB7XHJcbiAgICAgICAgbGV0IHAgPSB0aGlzLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgIGlmICghcC5oYXNPd25Qcm9wZXJ0eShcIl90ZW1wbGF0ZVwiKSkge1xyXG4gICAgICAgICAgICAvLyBoZXJlLCB0aGUgY29tcG9uZW50IGFuZCBub25lIG9mIGl0cyBzdXBlcmNsYXNzZXMgZGVmaW5lcyBhIHN0YXRpYyBgdGVtcGxhdGVgXHJcbiAgICAgICAgICAgIC8vIGtleS4gU28gd2UgZmFsbCBiYWNrIG9uIGxvb2tpbmcgZm9yIGEgdGVtcGxhdGUgbWF0Y2hpbmcgaXRzIG5hbWUgKG9yXHJcbiAgICAgICAgICAgIC8vIG9uZSBvZiBpdHMgc3ViY2xhc3MpLlxyXG4gICAgICAgICAgICBsZXQgdGVtcGxhdGUgPSBwLm5hbWU7XHJcbiAgICAgICAgICAgIHdoaWxlICghKHRlbXBsYXRlIGluIHF3ZWIudGVtcGxhdGVzKSAmJiBwICE9PSBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHAgPSBwLl9fcHJvdG9fXztcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gcC5uYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwID09PSBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgdGVtcGxhdGUgZm9yIGNvbXBvbmVudCBcIiR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfVwiYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwLl90ZW1wbGF0ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9fcHJlcGFyZUFuZFJlbmRlcihmaWJlciwgY2IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy53aWxsU3RhcnQoKSwgdGhpcy5fX293bF9fLndpbGxTdGFydENCICYmIHRoaXMuX19vd2xfXy53aWxsU3RhcnRDQigpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGZpYmVyLmhhbmRsZUVycm9yKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9fb3dsX18uaXNEZXN0cm95ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19yZW5kZXIoZmliZXIpO1xyXG4gICAgICAgICAgICBjYigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9fcmVuZGVyKGZpYmVyKSB7XHJcbiAgICAgICAgY29uc3QgX19vd2xfXyA9IHRoaXMuX19vd2xfXztcclxuICAgICAgICBpZiAoX19vd2xfXy5vYnNlcnZlcikge1xyXG4gICAgICAgICAgICBfX293bF9fLm9ic2VydmVyLmFsbG93TXV0YXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBlcnJvcjtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgdm5vZGUgPSBfX293bF9fLnJlbmRlckZuKHRoaXMsIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJzOiBfX293bF9fLmJvdW5kSGFuZGxlcnMsXHJcbiAgICAgICAgICAgICAgICBmaWJlcjogZmliZXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIHdlIGl0ZXJhdGUgb3ZlciB0aGUgY2hpbGRyZW4gdG8gZGV0ZWN0IHRob3NlIHRoYXQgbm8gbG9uZ2VyIGJlbG9uZyB0byB0aGVcclxuICAgICAgICAgICAgLy8gY3VycmVudCByZW5kZXJpbmc6IHRob3NlIG9uZXMsIGlmIG5vdCBtb3VudGVkIHlldCwgY2FuIChhbmQgaGF2ZSB0bykgYmVcclxuICAgICAgICAgICAgLy8gZGVzdHJveWVkIHJpZ2h0IG5vdywgYmVjYXVzZSB0aGV5IGFyZSBub3QgaW4gdGhlIERPTSwgYW5kIHRodXMgd2Ugd29uJ3RcclxuICAgICAgICAgICAgLy8gYmUgbm90aWZpZWQgbGF0ZXIgb24gKHdoZW4gcGF0Y2hpbmcpLCB0aGF0IHRoZXkgYXJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXHJcbiAgICAgICAgICAgIGZvciAobGV0IGNoaWxkS2V5IGluIF9fb3dsX18uY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGxldCBjaGlsZCA9IF9fb3dsX18uY2hpbGRyZW5bY2hpbGRLZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjaGlsZC5fX293bF9fLmlzTW91bnRlZCAmJiBjaGlsZC5fX293bF9fLnBhcmVudExhc3RGaWJlcklkIDwgZmliZXIuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF2bm9kZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJpbmcgJyR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfScgZGlkIG5vdCByZXR1cm4gYW55dGhpbmdgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaWJlci52bm9kZSA9IHZub2RlO1xyXG4gICAgICAgICAgICAvLyB3ZSBhcHBseSBoZXJlIHRoZSBjbGFzcyBpbmZvcm1hdGlvbiBkZXNjcmliZWQgb24gdGhlIGNvbXBvbmVudCBieSB0aGVcclxuICAgICAgICAgICAgLy8gdGVtcGxhdGUgKHNvLCBzb21ldGhpbmcgbGlrZSA8TXlDb21wb25lbnQgY2xhc3M9XCIuLi5cIi8+KSB0byB0aGUgYWN0dWFsXHJcbiAgICAgICAgICAgIC8vIHJvb3Qgdm5vZGVcclxuICAgICAgICAgICAgaWYgKF9fb3dsX18uY2xhc3NPYmopIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgZGF0YS5jbGFzcyA9IE9iamVjdC5hc3NpZ24oZGF0YS5jbGFzcyB8fCB7fSwgX19vd2xfXy5jbGFzc09iaik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgZXJyb3IgPSBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX19vd2xfXy5vYnNlcnZlcikge1xyXG4gICAgICAgICAgICBfX293bF9fLm9ic2VydmVyLmFsbG93TXV0YXRpb25zID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmliZXIucm9vdC5jb3VudGVyLS07XHJcbiAgICAgICAgZmliZXIuaXNSZW5kZXJlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGZpYmVyLmhhbmRsZUVycm9yKGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE9ubHkgY2FsbGVkIGJ5IHF3ZWIgdC1jb21wb25lbnQgZGlyZWN0aXZlICh3aGVuIHQta2VlcGFsaXZlIGlzIHNldClcclxuICAgICAqL1xyXG4gICAgX19yZW1vdW50KCkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgaWYgKCFfX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubW91bnRlZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXBwbHkgZGVmYXVsdCBwcm9wcyAob25seSB0b3AgbGV2ZWwpLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzIG1vZGlmeSBpbiBwbGFjZSB0aGUgcHJvcHNcclxuICAgICAqL1xyXG4gICAgX19hcHBseURlZmF1bHRQcm9wcyhwcm9wcywgZGVmYXVsdFByb3BzKSB7XHJcbiAgICAgICAgZm9yIChsZXQgcHJvcE5hbWUgaW4gZGVmYXVsdFByb3BzKSB7XHJcbiAgICAgICAgICAgIGlmIChwcm9wc1twcm9wTmFtZV0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcHJvcHNbcHJvcE5hbWVdID0gZGVmYXVsdFByb3BzW3Byb3BOYW1lXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5Db21wb25lbnQudGVtcGxhdGUgPSBudWxsO1xyXG5Db21wb25lbnQuX3RlbXBsYXRlID0gbnVsbDtcclxuQ29tcG9uZW50LmN1cnJlbnQgPSBudWxsO1xyXG5Db21wb25lbnQuY29tcG9uZW50cyA9IHt9O1xyXG5Db21wb25lbnQuZW52ID0ge307XHJcbi8vIGV4cG9zZSBzY2hlZHVsZXIgcy50LiBpdCBjYW4gYmUgbW9ja2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzXHJcbkNvbXBvbmVudC5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cbi8qKlxyXG4gKiBUaGUgYENvbnRleHRgIG9iamVjdCBwcm92aWRlcyBhIHdheSB0byBzaGFyZSBkYXRhIGJldHdlZW4gYW4gYXJiaXRyYXJ5IG51bWJlclxyXG4gKiBvZiBjb21wb25lbnQuIFVzdWFsbHksIGRhdGEgaXMgcGFzc2VkIGZyb20gYSBwYXJlbnQgdG8gaXRzIGNoaWxkcmVuIGNvbXBvbmVudCxcclxuICogYnV0IHdoZW4gd2UgaGF2ZSB0byBkZWFsIHdpdGggc29tZSBtb3N0bHkgZ2xvYmFsIGluZm9ybWF0aW9uLCB0aGlzIGNhbiBiZVxyXG4gKiBhbm5veWluZywgc2luY2UgZWFjaCBjb21wb25lbnQgd2lsbCBuZWVkIHRvIHBhc3MgdGhlIGluZm9ybWF0aW9uIHRvIGVhY2hcclxuICogY2hpbGRyZW4sIGV2ZW4gdGhvdWdoIHNvbWUgb3IgbW9zdCBvZiB0aGVtIHdpbGwgbm90IHVzZSB0aGUgaW5mb3JtYXRpb24uXHJcbiAqXHJcbiAqIFdpdGggYSBgQ29udGV4dGAgb2JqZWN0LCBlYWNoIGNvbXBvbmVudCBjYW4gc3Vic2NyaWJlICh3aXRoIHRoZSBgdXNlQ29udGV4dGBcclxuICogaG9vaykgdG8gaXRzIHN0YXRlLCBhbmQgd2lsbCBiZSB1cGRhdGVkIHdoZW5ldmVyIHRoZSBjb250ZXh0IHN0YXRlIGlzIHVwZGF0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBwYXJ0aXRpb25CeShhcnIsIGZuKSB7XHJcbiAgICBsZXQgbGFzdEdyb3VwID0gZmFsc2U7XHJcbiAgICBsZXQgbGFzdFZhbHVlO1xyXG4gICAgcmV0dXJuIGFyci5yZWR1Y2UoKGFjYywgY3VyKSA9PiB7XHJcbiAgICAgICAgbGV0IGN1clZhbCA9IGZuKGN1cik7XHJcbiAgICAgICAgaWYgKGxhc3RHcm91cCkge1xyXG4gICAgICAgICAgICBpZiAoY3VyVmFsID09PSBsYXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGxhc3RHcm91cC5wdXNoKGN1cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXN0R3JvdXAgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWxhc3RHcm91cCkge1xyXG4gICAgICAgICAgICBsYXN0R3JvdXAgPSBbY3VyXTtcclxuICAgICAgICAgICAgYWNjLnB1c2gobGFzdEdyb3VwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdFZhbHVlID0gY3VyVmFsO1xyXG4gICAgICAgIHJldHVybiBhY2M7XHJcbiAgICB9LCBbXSk7XHJcbn1cclxuY2xhc3MgQ29udGV4dCBleHRlbmRzIEV2ZW50QnVzIHtcclxuICAgIGNvbnN0cnVjdG9yKHN0YXRlID0ge30pIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMucmV2ID0gMTtcclxuICAgICAgICAvLyBtYXBwaW5nIGZyb20gY29tcG9uZW50IGlkIHRvIGxhc3Qgb2JzZXJ2ZWQgY29udGV4dCBpZFxyXG4gICAgICAgIHRoaXMubWFwcGluZyA9IHt9O1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgT2JzZXJ2ZXIoKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyLm5vdGlmeUNCID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBub3RpZnkgY29tcG9uZW50cyBpbiB0aGUgbmV4dCBtaWNyb3Rhc2sgdGljayB0byBlbnN1cmUgdGhhdCBzdWJzY3JpYmVyc1xyXG4gICAgICAgICAgICAvLyBhcmUgbm90aWZpZWQgb25seSBvbmNlIGZvciBhbGwgY2hhbmdlcyB0aGF0IG9jY3VyIGluIHRoZSBzYW1lIG1pY3JvIHRpY2tcclxuICAgICAgICAgICAgbGV0IHJldiA9IHRoaXMucmV2O1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmV2ID09PSB0aGlzLnJldikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX19ub3RpZnlDb21wb25lbnRzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZShzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnVwZGF0ZSA9IFtdO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnN0ZWFkIG9mIHVzaW5nIHRyaWdnZXIgdG8gZW1pdCBhbiB1cGRhdGUgZXZlbnQsIHdlIGFjdHVhbGx5IGltcGxlbWVudFxyXG4gICAgICogb3VyIG93biBmdW5jdGlvbiB0byBkbyB0aGF0LiAgVGhlIHJlYXNvbiBpcyB0aGF0IHdlIG5lZWQgdG8gYmUgc21hcnRlciB0aGFuXHJcbiAgICAgKiBhIHNpbXBsZSB0cmlnZ2VyIGZ1bmN0aW9uOiB3ZSBuZWVkIHRvIHdhaXQgZm9yIHBhcmVudCBjb21wb25lbnRzIHRvIGJlXHJcbiAgICAgKiBkb25lIGJlZm9yZSBkb2luZyBjaGlsZHJlbiBjb21wb25lbnRzLiAgTW9yZSBwcmVjaXNlbHksIGlmIGFuIHVwZGF0ZVxyXG4gICAgICogYXMgYW4gZWZmZWN0IG9mIGRlc3Ryb3lpbmcgYSBjaGlsZHJlbiwgd2UgZG8gbm90IHdhbnQgdG8gY2FsbCBhbnkgY29kZVxyXG4gICAgICogZnJvbSB0aGUgY2hpbGQsIGFuZCBjZXJ0YWlubHkgbm90IHJlbmRlciBpdC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpbXBsZW1lbnRzIGEgc2ltcGxlIGdyb3VwaW5nIGFsZ29yaXRobSBieSBkZXB0aC4gSWYgd2UgaGF2ZVxyXG4gICAgICogY29ubmVjdGVkIGNvbXBvbmVudHMgb2YgZGVwdGhzIFsyLCA0LDQsNCw0LCAzLDgsOF0sIHRoZSBDb250ZXh0IHdpbGwgbm90aWZ5XHJcbiAgICAgKiB0aGVtIGluIHRoZSBmb2xsb3dpbmcgZ3JvdXBzOiBbMl0sIFs0LDQsNCw0XSwgWzNdLCBbOCw4XS4gRWFjaCBncm91cCB3aWxsXHJcbiAgICAgKiBiZSB1cGRhdGVkIHNlcXVlbnRpYWxseSwgYnV0IGVhY2ggY29tcG9uZW50cyBpbiBhIGdpdmVuIGdyb3VwIHdpbGwgYmUgZG9uZSBpblxyXG4gICAgICogcGFyYWxsZWwuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyBhIHZlcnkgc2ltcGxlIGFsZ29yaXRobSwgYnV0IGl0IGF2b2lkcyBjaGVja2luZyBpZiBhIGdpdmVuXHJcbiAgICAgKiBjb21wb25lbnQgaXMgYSBjaGlsZCBvZiBhbm90aGVyLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBfX25vdGlmeUNvbXBvbmVudHMoKSB7XHJcbiAgICAgICAgY29uc3QgcmV2ID0gKyt0aGlzLnJldjtcclxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gdGhpcy5zdWJzY3JpcHRpb25zLnVwZGF0ZTtcclxuICAgICAgICBjb25zdCBncm91cHMgPSBwYXJ0aXRpb25CeShzdWJzY3JpcHRpb25zLCBzID0+IChzLm93bmVyID8gcy5vd25lci5fX293bF9fLmRlcHRoIDogLTEpKTtcclxuICAgICAgICBmb3IgKGxldCBncm91cCBvZiBncm91cHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvbXMgPSBncm91cC5tYXAoc3ViID0+IHN1Yi5jYWxsYmFjay5jYWxsKHN1Yi5vd25lciwgcmV2KSk7XHJcbiAgICAgICAgICAgIC8vIGF0IHRoaXMgcG9pbnQsIGVhY2ggY29tcG9uZW50IGluIHRoZSBjdXJyZW50IGdyb3VwIGhhcyByZWdpc3RlcmVkIGFcclxuICAgICAgICAgICAgLy8gdG9wIGxldmVsIGZpYmVyIGluIHRoZSBzY2hlZHVsZXIuIEl0IGNvdWxkIGhhcHBlbiB0aGF0IHJlbmRlcmluZyB0aGVzZVxyXG4gICAgICAgICAgICAvLyBjb21wb25lbnRzIGlzIGRvbmUgKGlmIHRoZXkgaGF2ZSBubyBjaGlsZHJlbikuICBUaGlzIGlzIHdoeSB3ZSBtYW51YWxseVxyXG4gICAgICAgICAgICAvLyBmbHVzaCB0aGUgc2NoZWR1bGVyLiAgVGhpcyB3aWxsIGZvcmNlIHRoZSBzY2hlZHVsZXIgdG8gY2hlY2tcclxuICAgICAgICAgICAgLy8gaW1tZWRpYXRlbHkgaWYgdGhleSBhcmUgZG9uZSwgd2hpY2ggd2lsbCBjYXVzZSB0aGVpciByZW5kZXJpbmdcclxuICAgICAgICAgICAgLy8gcHJvbWlzZSB0byByZXNvbHZlIGVhcmxpZXIsIHdoaWNoIG1lYW5zIHRoYXQgdGhlcmUgaXMgYSBjaGFuY2Ugb2ZcclxuICAgICAgICAgICAgLy8gcHJvY2Vzc2luZyB0aGUgbmV4dCBncm91cCBpbiB0aGUgc2FtZSBmcmFtZS5cclxuICAgICAgICAgICAgc2NoZWR1bGVyLmZsdXNoKCk7XHJcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFRoZWB1c2VDb250ZXh0YCBob29rIGlzIHRoZSBub3JtYWwgd2F5IGZvciBhIGNvbXBvbmVudCB0byByZWdpc3RlciB0aGVtc2VsdmVcclxuICogdG8gY29udGV4dCBzdGF0ZSBjaGFuZ2VzLiBUaGUgYHVzZUNvbnRleHRgIG1ldGhvZCByZXR1cm5zIHRoZSBjb250ZXh0IHN0YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VDb250ZXh0KGN0eCkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICByZXR1cm4gdXNlQ29udGV4dFdpdGhDQihjdHgsIGNvbXBvbmVudCwgY29tcG9uZW50LnJlbmRlci5iaW5kKGNvbXBvbmVudCkpO1xyXG59XHJcbmZ1bmN0aW9uIHVzZUNvbnRleHRXaXRoQ0IoY3R4LCBjb21wb25lbnQsIG1ldGhvZCkge1xyXG4gICAgY29uc3QgX19vd2xfXyA9IGNvbXBvbmVudC5fX293bF9fO1xyXG4gICAgY29uc3QgaWQgPSBfX293bF9fLmlkO1xyXG4gICAgY29uc3QgbWFwcGluZyA9IGN0eC5tYXBwaW5nO1xyXG4gICAgaWYgKGlkIGluIG1hcHBpbmcpIHtcclxuICAgICAgICByZXR1cm4gY3R4LnN0YXRlO1xyXG4gICAgfVxyXG4gICAgaWYgKCFfX293bF9fLm9ic2VydmVyKSB7XHJcbiAgICAgICAgX19vd2xfXy5vYnNlcnZlciA9IG5ldyBPYnNlcnZlcigpO1xyXG4gICAgICAgIF9fb3dsX18ub2JzZXJ2ZXIubm90aWZ5Q0IgPSBjb21wb25lbnQucmVuZGVyLmJpbmQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNvbnN0IGN1cnJlbnRDQiA9IF9fb3dsX18ub2JzZXJ2ZXIubm90aWZ5Q0I7XHJcbiAgICBfX293bF9fLm9ic2VydmVyLm5vdGlmeUNCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjdHgucmV2ID4gbWFwcGluZ1tpZF0pIHtcclxuICAgICAgICAgICAgLy8gaW4gdGhpcyBjYXNlLCB0aGUgY29udGV4dCBoYXMgYmVlbiB1cGRhdGVkIHNpbmNlIHdlIHdlcmUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIC8vIGxhc3QsIGFuZCB3ZSBkbyBub3QgbmVlZCB0byByZW5kZXIgaGVyZSB3aXRoIHRoZSBvYnNlcnZlci4gQVxyXG4gICAgICAgICAgICAvLyByZW5kZXJpbmcgaXMgY29taW5nIGFueXdheSwgd2l0aCB0aGUgY29ycmVjdCBwcm9wcy5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdXJyZW50Q0IoKTtcclxuICAgIH07XHJcbiAgICBtYXBwaW5nW2lkXSA9IDA7XHJcbiAgICBjb25zdCByZW5kZXJGbiA9IF9fb3dsX18ucmVuZGVyRm47XHJcbiAgICBfX293bF9fLnJlbmRlckZuID0gZnVuY3Rpb24gKGNvbXAsIHBhcmFtcykge1xyXG4gICAgICAgIG1hcHBpbmdbaWRdID0gY3R4LnJldjtcclxuICAgICAgICByZXR1cm4gcmVuZGVyRm4oY29tcCwgcGFyYW1zKTtcclxuICAgIH07XHJcbiAgICBjdHgub24oXCJ1cGRhdGVcIiwgY29tcG9uZW50LCBhc3luYyAoY29udGV4dFJldikgPT4ge1xyXG4gICAgICAgIGlmIChtYXBwaW5nW2lkXSA8IGNvbnRleHRSZXYpIHtcclxuICAgICAgICAgICAgbWFwcGluZ1tpZF0gPSBjb250ZXh0UmV2O1xyXG4gICAgICAgICAgICBhd2FpdCBtZXRob2QoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IF9fZGVzdHJveSA9IGNvbXBvbmVudC5fX2Rlc3Ryb3k7XHJcbiAgICBjb21wb25lbnQuX19kZXN0cm95ID0gcGFyZW50ID0+IHtcclxuICAgICAgICBjdHgub2ZmKFwidXBkYXRlXCIsIGNvbXBvbmVudCk7XHJcbiAgICAgICAgZGVsZXRlIG1hcHBpbmdbaWRdO1xyXG4gICAgICAgIF9fZGVzdHJveS5jYWxsKGNvbXBvbmVudCwgcGFyZW50KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gY3R4LnN0YXRlO1xyXG59XG5cbi8qKlxyXG4gKiBPd2wgSG9vayBTeXN0ZW1cclxuICpcclxuICogVGhpcyBmaWxlIGludHJvZHVjZXMgdGhlIGNvbmNlcHQgb2YgaG9va3MsIHNpbWlsYXIgdG8gUmVhY3Qgb3IgVnVlIGhvb2tzLlxyXG4gKiBXZSBoYXZlIGN1cnJlbnRseSBhbiBpbXBsZW1lbnRhdGlvbiBvZjpcclxuICogLSB1c2VTdGF0ZSAocmVhY3RpdmUgc3RhdGUpXHJcbiAqIC0gb25Nb3VudGVkXHJcbiAqIC0gb25XaWxsVW5tb3VudFxyXG4gKiAtIHVzZVJlZlxyXG4gKi9cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdXNlU3RhdGVcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIFRoaXMgaXMgdGhlIG1haW4gd2F5IGEgY29tcG9uZW50IGNhbiBiZSBtYWRlIHJlYWN0aXZlLiAgVGhlIHVzZVN0YXRlIGhvb2tcclxuICogd2lsbCByZXR1cm4gYW4gb2JzZXJ2ZWQgb2JqZWN0IChvciBhcnJheSkuICBDaGFuZ2VzIHRvIHRoYXQgdmFsdWUgd2lsbCB0aGVuXHJcbiAqIHRyaWdnZXIgYSByZXJlbmRlcmluZyBvZiB0aGUgY3VycmVudCBjb21wb25lbnQuXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VTdGF0ZShzdGF0ZSkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICBjb25zdCBfX293bF9fID0gY29tcG9uZW50Ll9fb3dsX187XHJcbiAgICBpZiAoIV9fb3dsX18ub2JzZXJ2ZXIpIHtcclxuICAgICAgICBfX293bF9fLm9ic2VydmVyID0gbmV3IE9ic2VydmVyKCk7XHJcbiAgICAgICAgX19vd2xfXy5vYnNlcnZlci5ub3RpZnlDQiA9IGNvbXBvbmVudC5yZW5kZXIuYmluZChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fb3dsX18ub2JzZXJ2ZXIub2JzZXJ2ZShzdGF0ZSk7XHJcbn1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTGlmZSBjeWNsZSBob29rc1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBtYWtlTGlmZWN5Y2xlSG9vayhtZXRob2QsIHJldmVyc2UgPSBmYWxzZSkge1xyXG4gICAgaWYgKHJldmVyc2UpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgICAgICAgICBpZiAoY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGNvbXBvbmVudC5fX293bF9fW21ldGhvZF07XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuY2FsbChjb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNiLmNhbGwoY29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gY2I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBDb21wb25lbnQuY3VycmVudDtcclxuICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5fX293bF9fW21ldGhvZF0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYi5jYWxsKGNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jYWxsKGNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGNiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQXN5bmNIb29rKG1ldGhvZCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfX1ttZXRob2RdKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbY3VycmVudC5jYWxsKGNvbXBvbmVudCwgLi4uYXJncyksIGNiLmNhbGwoY29tcG9uZW50LCAuLi5hcmdzKV0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGNiO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuY29uc3Qgb25Nb3VudGVkID0gbWFrZUxpZmVjeWNsZUhvb2soXCJtb3VudGVkQ0JcIiwgdHJ1ZSk7XHJcbmNvbnN0IG9uV2lsbFVubW91bnQgPSBtYWtlTGlmZWN5Y2xlSG9vayhcIndpbGxVbm1vdW50Q0JcIik7XHJcbmNvbnN0IG9uV2lsbFBhdGNoID0gbWFrZUxpZmVjeWNsZUhvb2soXCJ3aWxsUGF0Y2hDQlwiKTtcclxuY29uc3Qgb25QYXRjaGVkID0gbWFrZUxpZmVjeWNsZUhvb2soXCJwYXRjaGVkQ0JcIiwgdHJ1ZSk7XHJcbmNvbnN0IG9uV2lsbFN0YXJ0ID0gbWFrZUFzeW5jSG9vayhcIndpbGxTdGFydENCXCIpO1xyXG5jb25zdCBvbldpbGxVcGRhdGVQcm9wcyA9IG1ha2VBc3luY0hvb2soXCJ3aWxsVXBkYXRlUHJvcHNDQlwiKTtcclxuZnVuY3Rpb24gdXNlUmVmKG5hbWUpIHtcclxuICAgIGNvbnN0IF9fb3dsX18gPSBDb21wb25lbnQuY3VycmVudC5fX293bF9fO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBnZXQgZWwoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IF9fb3dsX18ucmVmcyAmJiBfX293bF9fLnJlZnNbbmFtZV07XHJcbiAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWwuZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgY29tcCgpIHtcclxuICAgICAgICAgICAgY29uc3QgdmFsID0gX19vd2xfXy5yZWZzICYmIF9fb3dsX18ucmVmc1tuYW1lXTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbCBpbnN0YW5jZW9mIENvbXBvbmVudCA/IHZhbCA6IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB1c2VTdWJFbnZcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIFRoaXMgaG9vayBpcyBhIHNpbXBsZSB3YXkgdG8gbGV0IGNvbXBvbmVudHMgdXNlIGEgc3ViIGVudmlyb25tZW50LiAgTm90ZSB0aGF0XHJcbiAqIGxpa2UgZm9yIGFsbCBob29rcywgaXQgaXMgaW1wb3J0YW50IHRoYXQgdGhpcyBpcyBvbmx5IGNhbGxlZCBpbiB0aGVcclxuICogY29uc3RydWN0b3IgbWV0aG9kLlxyXG4gKi9cclxuZnVuY3Rpb24gdXNlU3ViRW52KG5leHRFbnYpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgY29tcG9uZW50LmVudiA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShjb21wb25lbnQuZW52KSwgbmV4dEVudik7XHJcbn1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdXNlRXh0ZXJuYWxMaXN0ZW5lclxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vKipcclxuICogV2hlbiBhIGNvbXBvbmVudCBuZWVkcyB0byBsaXN0ZW4gdG8gRE9NIEV2ZW50cyBvbiBlbGVtZW50KHMpIHRoYXQgYXJlIG5vdFxyXG4gKiBwYXJ0IG9mIGhpcyBoaWVyYXJjaHksIHdlIGNhbiB1c2UgdGhlIGB1c2VFeHRlcm5hbExpc3RlbmVyYCBob29rLlxyXG4gKiBJdCB3aWxsIGNvcnJlY3RseSBhZGQgYW5kIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIsIHdoZW5ldmVyIHRoZVxyXG4gKiBjb21wb25lbnQgaXMgbW91bnRlZCBhbmQgdW5tb3VudGVkLlxyXG4gKlxyXG4gKiBFeGFtcGxlOlxyXG4gKiAgYSBtZW51IG5lZWRzIHRvIGxpc3RlbiB0byB0aGUgY2xpY2sgb24gd2luZG93IHRvIGJlIGNsb3NlZCBhdXRvbWF0aWNhbGx5XHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgaW4gdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBPV0wgY29tcG9uZW50IHRoYXQgbmVlZHMgdG8gYmUgbm90aWZpZWQsXHJcbiAqICBgdXNlRXh0ZXJuYWxMaXN0ZW5lcih3aW5kb3csICdjbGljaycsIHRoaXMuX2RvU29tZXRoaW5nKTtgXHJcbiAqICovXHJcbmZ1bmN0aW9uIHVzZUV4dGVybmFsTGlzdGVuZXIodGFyZ2V0LCBldmVudE5hbWUsIGhhbmRsZXIsIGV2ZW50UGFyYW1zKSB7XHJcbiAgICBjb25zdCBib3VuZEhhbmRsZXIgPSBoYW5kbGVyLmJpbmQoQ29tcG9uZW50LmN1cnJlbnQpO1xyXG4gICAgb25Nb3VudGVkKCgpID0+IHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgYm91bmRIYW5kbGVyLCBldmVudFBhcmFtcykpO1xyXG4gICAgb25XaWxsVW5tb3VudCgoKSA9PiB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGJvdW5kSGFuZGxlciwgZXZlbnRQYXJhbXMpKTtcclxufVxuXG52YXIgX2hvb2tzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbCxcbiAgICB1c2VTdGF0ZTogdXNlU3RhdGUsXG4gICAgb25Nb3VudGVkOiBvbk1vdW50ZWQsXG4gICAgb25XaWxsVW5tb3VudDogb25XaWxsVW5tb3VudCxcbiAgICBvbldpbGxQYXRjaDogb25XaWxsUGF0Y2gsXG4gICAgb25QYXRjaGVkOiBvblBhdGNoZWQsXG4gICAgb25XaWxsU3RhcnQ6IG9uV2lsbFN0YXJ0LFxuICAgIG9uV2lsbFVwZGF0ZVByb3BzOiBvbldpbGxVcGRhdGVQcm9wcyxcbiAgICB1c2VSZWY6IHVzZVJlZixcbiAgICB1c2VTdWJFbnY6IHVzZVN1YkVudixcbiAgICB1c2VFeHRlcm5hbExpc3RlbmVyOiB1c2VFeHRlcm5hbExpc3RlbmVyXG59KTtcblxuY2xhc3MgU3RvcmUgZXh0ZW5kcyBDb250ZXh0IHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgICAgIHN1cGVyKGNvbmZpZy5zdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gY29uZmlnLmFjdGlvbnM7XHJcbiAgICAgICAgdGhpcy5lbnYgPSBjb25maWcuZW52O1xyXG4gICAgICAgIHRoaXMuZ2V0dGVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMudXBkYXRlRnVuY3Rpb25zID0gW107XHJcbiAgICAgICAgaWYgKGNvbmZpZy5nZXR0ZXJzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0QXJnID0ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICBnZXR0ZXJzOiB0aGlzLmdldHRlcnNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgZm9yIChsZXQgZyBpbiBjb25maWcuZ2V0dGVycykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXR0ZXJzW2ddID0gY29uZmlnLmdldHRlcnNbZ10uYmluZCh0aGlzLCBmaXJzdEFyZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkaXNwYXRjaChhY3Rpb24sIC4uLnBheWxvYWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWN0aW9uc1thY3Rpb25dKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0Vycm9yXSBhY3Rpb24gJHthY3Rpb259IGlzIHVuZGVmaW5lZGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmFjdGlvbnNbYWN0aW9uXSh7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoOiB0aGlzLmRpc3BhdGNoLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIGVudjogdGhpcy5lbnYsXHJcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxyXG4gICAgICAgICAgICBnZXR0ZXJzOiB0aGlzLmdldHRlcnNcclxuICAgICAgICB9LCAuLi5wYXlsb2FkKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGlzU3RyaWN0RXF1YWwgPSAoYSwgYikgPT4gYSA9PT0gYjtcclxuZnVuY3Rpb24gdXNlU3RvcmUoc2VsZWN0b3IsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICBjb25zdCBjb21wb25lbnRJZCA9IGNvbXBvbmVudC5fX293bF9fLmlkO1xyXG4gICAgY29uc3Qgc3RvcmUgPSBvcHRpb25zLnN0b3JlIHx8IGNvbXBvbmVudC5lbnYuc3RvcmU7XHJcbiAgICBpZiAoIShzdG9yZSBpbnN0YW5jZW9mIFN0b3JlKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc3RvcmUgZm91bmQgd2hlbiBjb25uZWN0aW5nICcke2NvbXBvbmVudC5jb25zdHJ1Y3Rvci5uYW1lfSdgKTtcclxuICAgIH1cclxuICAgIGxldCByZXN1bHQgPSBzZWxlY3RvcihzdG9yZS5zdGF0ZSwgY29tcG9uZW50LnByb3BzKTtcclxuICAgIGNvbnN0IGhhc2hGbiA9IHN0b3JlLm9ic2VydmVyLnJldk51bWJlci5iaW5kKHN0b3JlLm9ic2VydmVyKTtcclxuICAgIGxldCByZXZOdW1iZXIgPSBoYXNoRm4ocmVzdWx0KTtcclxuICAgIGNvbnN0IGlzRXF1YWwgPSBvcHRpb25zLmlzRXF1YWwgfHwgaXNTdHJpY3RFcXVhbDtcclxuICAgIGlmICghc3RvcmUudXBkYXRlRnVuY3Rpb25zW2NvbXBvbmVudElkXSkge1xyXG4gICAgICAgIHN0b3JlLnVwZGF0ZUZ1bmN0aW9uc1tjb21wb25lbnRJZF0gPSBbXTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHNlbGVjdENvbXBhcmVVcGRhdGUoc3RhdGUsIHByb3BzKSB7XHJcbiAgICAgICAgY29uc3Qgb2xkUmVzdWx0ID0gcmVzdWx0O1xyXG4gICAgICAgIHJlc3VsdCA9IHNlbGVjdG9yKHN0YXRlLCBwcm9wcyk7XHJcbiAgICAgICAgY29uc3QgbmV3UmV2TnVtYmVyID0gaGFzaEZuKHJlc3VsdCk7XHJcbiAgICAgICAgaWYgKChuZXdSZXZOdW1iZXIgPiAwICYmIHJldk51bWJlciAhPT0gbmV3UmV2TnVtYmVyKSB8fCAhaXNFcXVhbChvbGRSZXN1bHQsIHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgcmV2TnVtYmVyID0gbmV3UmV2TnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5vblVwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5vblVwZGF0ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBzdG9yZS51cGRhdGVGdW5jdGlvbnNbY29tcG9uZW50SWRdLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBzZWxlY3RDb21wYXJlVXBkYXRlKHN0b3JlLnN0YXRlLCBjb21wb25lbnQucHJvcHMpO1xyXG4gICAgfSk7XHJcbiAgICB1c2VDb250ZXh0V2l0aENCKHN0b3JlLCBjb21wb25lbnQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2hvdWxkUmVuZGVyID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgZm4gb2Ygc3RvcmUudXBkYXRlRnVuY3Rpb25zW2NvbXBvbmVudElkXSkge1xyXG4gICAgICAgICAgICBzaG91bGRSZW5kZXIgPSBmbigpIHx8IHNob3VsZFJlbmRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNob3VsZFJlbmRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LnJlbmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgb25XaWxsVXBkYXRlUHJvcHMocHJvcHMgPT4ge1xyXG4gICAgICAgIHNlbGVjdENvbXBhcmVVcGRhdGUoc3RvcmUuc3RhdGUsIHByb3BzKTtcclxuICAgIH0pO1xyXG4gICAgY29uc3QgX19kZXN0cm95ID0gY29tcG9uZW50Ll9fZGVzdHJveTtcclxuICAgIGNvbXBvbmVudC5fX2Rlc3Ryb3kgPSBwYXJlbnQgPT4ge1xyXG4gICAgICAgIGRlbGV0ZSBzdG9yZS51cGRhdGVGdW5jdGlvbnNbY29tcG9uZW50SWRdO1xyXG4gICAgICAgIF9fZGVzdHJveS5jYWxsKGNvbXBvbmVudCwgcGFyZW50KTtcclxuICAgIH07XHJcbiAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIiB8fCByZXN1bHQgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm94eShyZXN1bHQsIHtcclxuICAgICAgICBnZXQodGFyZ2V0LCBrKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRba107XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQodGFyZ2V0LCBrLCB2KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0b3JlIHN0YXRlIHNob3VsZCBvbmx5IGJlIG1vZGlmaWVkIHRocm91Z2ggYWN0aW9uc1wiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhcyh0YXJnZXQsIGspIHtcclxuICAgICAgICAgICAgcmV0dXJuIGsgaW4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHVzZURpc3BhdGNoKHN0b3JlKSB7XHJcbiAgICBzdG9yZSA9IHN0b3JlIHx8IENvbXBvbmVudC5jdXJyZW50LmVudi5zdG9yZTtcclxuICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaC5iaW5kKHN0b3JlKTtcclxufVxyXG5mdW5jdGlvbiB1c2VHZXR0ZXJzKHN0b3JlKSB7XHJcbiAgICBzdG9yZSA9IHN0b3JlIHx8IENvbXBvbmVudC5jdXJyZW50LmVudi5zdG9yZTtcclxuICAgIHJldHVybiBzdG9yZS5nZXR0ZXJzO1xyXG59XG5cbi8qKlxyXG4gKiBPd2wgVGFnc1xyXG4gKlxyXG4gKiBXZSBoYXZlIGhlcmUgYSAodmVyeSkgc21hbGwgY29sbGVjdGlvbiBvZiB0YWcgZnVuY3Rpb25zOlxyXG4gKlxyXG4gKiAtIHhtbFxyXG4gKlxyXG4gKiBUaGUgcGxhbiBpcyB0byBhZGQgYSBmZXcgb3RoZXIgdGFncyBzdWNoIGFzIGNzcywgZ2xvYmFsY3NzLlxyXG4gKi9cclxuLyoqXHJcbiAqIFhNTCB0YWcgaGVscGVyIGZvciBkZWZpbmluZyB0ZW1wbGF0ZXMuICBXaXRoIHRoaXMsIG9uZSBjYW4gc2ltcGx5IGRlZmluZVxyXG4gKiBhbiBpbmxpbmUgdGVtcGxhdGUgd2l0aCBqdXN0IHRoZSB0ZW1wbGF0ZSB4bWw6XHJcbiAqIGBgYGpzXHJcbiAqICAgY2xhc3MgQSBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAqICAgICBzdGF0aWMgdGVtcGxhdGUgPSB4bWxgPGRpdj5zb21lIHRlbXBsYXRlPC9kaXY+YDtcclxuICogICB9XHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24geG1sKHN0cmluZ3MsIC4uLmFyZ3MpIHtcclxuICAgIGNvbnN0IG5hbWUgPSBgX190ZW1wbGF0ZV9fJHtRV2ViLm5leHRJZCsrfWA7XHJcbiAgICBjb25zdCB2YWx1ZSA9IFN0cmluZy5yYXcoc3RyaW5ncywgLi4uYXJncyk7XHJcbiAgICBRV2ViLnJlZ2lzdGVyVGVtcGxhdGUobmFtZSwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbn1cclxuLyoqXHJcbiAqIENTUyB0YWcgaGVscGVyIGZvciBkZWZpbmluZyBpbmxpbmUgc3R5bGVzaGVldHMuICBXaXRoIHRoaXMsIG9uZSBjYW4gc2ltcGx5IGRlZmluZVxyXG4gKiBhbiBpbmxpbmUgc3R5bGVzaGVldCB3aXRoIGp1c3QgdGhlIGZvbGxvd2luZyBjb2RlOlxyXG4gKiBgYGBqc1xyXG4gKiAgIGNsYXNzIEEgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gKiAgICAgc3RhdGljIHN0eWxlID0gY3NzYC5jb21wb25lbnQtYSB7IGNvbG9yOiByZWQ7IH1gO1xyXG4gKiAgIH1cclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjc3Moc3RyaW5ncywgLi4uYXJncykge1xyXG4gICAgY29uc3QgbmFtZSA9IGBfX3NoZWV0X18ke1FXZWIubmV4dElkKyt9YDtcclxuICAgIGNvbnN0IHZhbHVlID0gU3RyaW5nLnJhdyhzdHJpbmdzLCAuLi5hcmdzKTtcclxuICAgIHJlZ2lzdGVyU2hlZXQobmFtZSwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbn1cblxudmFyIF90YWdzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbCxcbiAgICB4bWw6IHhtbCxcbiAgICBjc3M6IGNzc1xufSk7XG5cbi8qKlxyXG4gKiBBc3luY1Jvb3RcclxuICpcclxuICogT3dsIGlzIGJ5IGRlZmF1bHQgYXN5bmNocm9ub3VzLCBhbmQgdGhlIHVzZXIgaW50ZXJmYWNlIHdpbGwgd2FpdCBmb3IgYWxsIGl0c1xyXG4gKiBzdWJjb21wb25lbnRzIHRvIGJlIHJlbmRlcmVkIGJlZm9yZSB1cGRhdGluZyB0aGUgRE9NLiBUaGlzIGlzIG1vc3Qgb2YgdGhlXHJcbiAqIHRpbWUgd2hhdCB3ZSB3YW50LCBidXQgaW4gc29tZSBjYXNlcywgaXQgbWFrZXMgc2Vuc2UgdG8gXCJkZXRhY2hcIiBhIGNvbXBvbmVudFxyXG4gKiBmcm9tIHRoaXMgY29vcmRpbmF0aW9uLiAgVGhpcyBpcyB0aGUgZ29hbCBvZiB0aGUgQXN5bmNSb290IGNvbXBvbmVudC5cclxuICovXHJcbmNsYXNzIEFzeW5jUm9vdCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBhc3luYyBfX3VwZGF0ZVByb3BzKG5leHRQcm9wcywgcGFyZW50RmliZXIpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcihwYXJlbnRGaWJlci5mb3JjZSk7XHJcbiAgICB9XHJcbn1cclxuQXN5bmNSb290LnRlbXBsYXRlID0geG1sIGA8dCB0LXNsb3Q9XCJkZWZhdWx0XCIvPmA7XG5cbmNsYXNzIFBvcnRhbCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQsIHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocGFyZW50LCBwcm9wcyk7XHJcbiAgICAgICAgLy8gYm9vbGVhbiB0byBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB3ZSBtdXN0IGxpc3RlbiB0byAnZG9tLWFwcGVuZGVkJyBldmVudFxyXG4gICAgICAgIC8vIHRvIGhvb2sgb24gdGhlIG1vbWVudCB3aGVuIHRoZSB0YXJnZXQgaXMgaW5zZXJ0ZWQgaW50byB0aGUgRE9NIChiZWNhdXNlIGl0XHJcbiAgICAgICAgLy8gaXMgbm90IHdoZW4gdGhlIHBvcnRhbCBpcyByZW5kZXJlZClcclxuICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gdHJ1ZTtcclxuICAgICAgICAvLyBzZXQgb2YgZW5jb3VudGVyZWQgZXZlbnRzIHRoYXQgbmVlZCB0byBiZSByZWRpcmVjdGVkXHJcbiAgICAgICAgdGhpcy5faGFuZGxlZEV2ZW50cyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAvLyBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdGhlIGV2ZW50J3MgdHVubmVsIChuZWVkcyB0byBiZSBhbiBhcnJvdyBmdW5jdGlvbiB0b1xyXG4gICAgICAgIC8vIGF2b2lkIGhhdmluZyB0byByZWJpbmQgYHRoaXNgKVxyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJUdW5uZWwgPSAoZXYpID0+IHtcclxuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX190cmlnZ2VyKGV2Lm9yaWdpbmFsQ29tcG9uZW50LCBldi50eXBlLCBldi5kZXRhaWwpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gU3RvcmluZyB0aGUgcGFyZW50J3MgZW52XHJcbiAgICAgICAgdGhpcy5wYXJlbnRFbnYgPSBudWxsO1xyXG4gICAgICAgIC8vIHJlcHJlc2VudHMgdGhlIGVsZW1lbnQgdGhhdCBpcyBtb3ZlZCBzb21ld2hlcmUgZWxzZVxyXG4gICAgICAgIHRoaXMucG9ydGFsID0gbnVsbDtcclxuICAgICAgICAvLyB0aGUgdGFyZ2V0IHdoZXJlIHdlIHdpbGwgbW92ZSBgcG9ydGFsYFxyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhcmVudEVudiA9IHBhcmVudCA/IHBhcmVudC5lbnYgOiB7fTtcclxuICAgICAgICAvLyBwdXQgYSBjYWxsYmFjayBpbiB0aGUgZW52IHRoYXQgaXMgcHJvcGFnYXRlZCB0byBjaGlsZHJlbiBzLnQuIHBvcnRhbCBjYW5cclxuICAgICAgICAvLyByZWdpc3RlciBhbiBoYW5kbGVyIHRvIHRob3NlIGV2ZW50cyBqdXN0IGJlZm9yZSBjaGlsZHJlbiB3aWxsIHRyaWdnZXIgdGhlbVxyXG4gICAgICAgIHVzZVN1YkVudih7XHJcbiAgICAgICAgICAgIFtwb3J0YWxTeW1ib2xdOiBldiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2hhbmRsZWRFdmVudHMuaGFzKGV2LnR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3J0YWwuZWxtLmFkZEV2ZW50TGlzdGVuZXIoZXYudHlwZSwgdGhpcy5faGFuZGxlclR1bm5lbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlZEV2ZW50cy5hZGQoZXYudHlwZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3ZlcnJpZGUgdG8gcmV2ZXJ0IGJhY2sgdG8gYSBjbGFzc2ljIENvbXBvbmVudCdzIHN0cnVjdHVyZVxyXG4gICAgICpcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfX2NhbGxXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBzdXBlci5fX2NhbGxXaWxsVW5tb3VudCgpO1xyXG4gICAgICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5wb3J0YWwuZWxtKTtcclxuICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXQgZWFjaCBET00gY2hhbmdlLCB3ZSBtdXN0IGVuc3VyZSB0aGF0IHRoZSBwb3J0YWwgY29udGFpbnMgZXhhY3RseSBvbmVcclxuICAgICAqIGNoaWxkXHJcbiAgICAgKi9cclxuICAgIF9fY2hlY2tWTm9kZVN0cnVjdHVyZSh2bm9kZSkge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgbGV0IGNvdW50UmVhbE5vZGVzID0gMDtcclxuICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuc2VsKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudFJlYWxOb2RlcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb3VudFJlYWxOb2RlcyAhPT0gMSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBvcnRhbCBtdXN0IGhhdmUgZXhhY3RseSBvbmUgbm9uLXRleHQgY2hpbGQgKGhhcyAke2NvdW50UmVhbE5vZGVzfSlgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEVuc3VyZSB0aGUgdGFyZ2V0IGlzIHN0aWxsIHRoZXJlIGF0IHdoaWNoZXZlciB0aW1lIHdlIHJlbmRlclxyXG4gICAgICovXHJcbiAgICBfX2NoZWNrVGFyZ2V0UHJlc2VuY2UoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldCB8fCAhZG9jdW1lbnQuY29udGFpbnModGhpcy50YXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgYW55IG1hdGNoIGZvciBcIiR7dGhpcy5wcm9wcy50YXJnZXR9XCJgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE1vdmUgdGhlIHBvcnRhbCdzIGVsZW1lbnQgdG8gdGhlIHRhcmdldFxyXG4gICAgICovXHJcbiAgICBfX2RlcGxveVBvcnRhbCgpIHtcclxuICAgICAgICB0aGlzLl9fY2hlY2tUYXJnZXRQcmVzZW5jZSgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0LmFwcGVuZENoaWxkKHRoaXMucG9ydGFsLmVsbSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlIHRvIHJlbW92ZSBmcm9tIHRoZSBET00gdGhlIGVsZW1lbnQgd2UgaGF2ZSB0ZWxlcG9ydGVkXHJcbiAgICAgKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIF9fZGVzdHJveShwYXJlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5wb3J0YWwgJiYgdGhpcy5wb3J0YWwuZWxtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYWNlZEVsbSA9IHRoaXMucG9ydGFsLmVsbTtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gZGlzcGxhY2VkRWxtLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChkaXNwbGFjZWRFbG0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN1cGVyLl9fZGVzdHJveShwYXJlbnQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZSB0byBwYXRjaCB0aGUgZWxlbWVudCB0aGF0IGhhcyBiZWVuIHRlbGVwb3J0ZWRcclxuICAgICAqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgX19wYXRjaCh0YXJnZXQsIHZub2RlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9UYXJnZXRMb29rVXApIHtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnByb3BzLnRhcmdldCk7XHJcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViLm9uKFwiZG9tLWFwcGVuZGVkXCIsIHRoaXMsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnYucXdlYi5vZmYoXCJkb20tYXBwZW5kZWRcIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMucHJvcHMudGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9fZGVwbG95UG9ydGFsKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9UYXJnZXRMb29rVXAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX19jaGVja1ZOb2RlU3RydWN0dXJlKHZub2RlKTtcclxuICAgICAgICBjb25zdCBzaG91bGREZXBsb3kgPSAoIXRoaXMucG9ydGFsIHx8IHRoaXMuZWwuY29udGFpbnModGhpcy5wb3J0YWwuZWxtKSkgJiYgIXRoaXMuZG9UYXJnZXRMb29rVXA7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRvVGFyZ2V0TG9va1VwICYmICFzaG91bGREZXBsb3kpIHtcclxuICAgICAgICAgICAgLy8gT25seSBvbiBwdXJlIHBhdGNoaW5nLCBwcm92aWRlZCB0aGVcclxuICAgICAgICAgICAgLy8gdGhpcy50YXJnZXQncyBwYXJlbnQgaGFzIG5vdCBiZWVuIHVubW91bnRlZFxyXG4gICAgICAgICAgICB0aGlzLl9fY2hlY2tUYXJnZXRQcmVzZW5jZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwb3J0YWxQYXRjaCA9IHRoaXMucG9ydGFsID8gdGhpcy5wb3J0YWwgOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLmNoaWxkcmVuWzBdLnNlbCk7XHJcbiAgICAgICAgdGhpcy5wb3J0YWwgPSBwYXRjaChwb3J0YWxQYXRjaCwgdm5vZGUuY2hpbGRyZW5bMF0pO1xyXG4gICAgICAgIHZub2RlLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgc3VwZXIuX19wYXRjaCh0YXJnZXQsIHZub2RlKTtcclxuICAgICAgICBpZiAoc2hvdWxkRGVwbG95KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19kZXBsb3lQb3J0YWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlIHRvIHNldCB0aGUgZW52XHJcbiAgICAgKi9cclxuICAgIF9fdHJpZ2dlcihjb21wb25lbnQsIGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIGNvbnN0IGVudiA9IHRoaXMuZW52O1xyXG4gICAgICAgIHRoaXMuZW52ID0gdGhpcy5wYXJlbnRFbnY7XHJcbiAgICAgICAgc3VwZXIuX190cmlnZ2VyKGNvbXBvbmVudCwgZXZlbnRUeXBlLCBwYXlsb2FkKTtcclxuICAgICAgICB0aGlzLmVudiA9IGVudjtcclxuICAgIH1cclxufVxyXG5Qb3J0YWwudGVtcGxhdGUgPSB4bWwgYDxwb3J0YWw+PHQgdC1zbG90PVwiZGVmYXVsdFwiLz48L3BvcnRhbD5gO1xyXG5Qb3J0YWwucHJvcHMgPSB7XHJcbiAgICB0YXJnZXQ6IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmdcclxuICAgIH1cclxufTtcblxuY2xhc3MgTGluayBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuaHJlZiA9IHRoaXMuZW52LnJvdXRlci5kZXN0VG9QYXRoKHRoaXMucHJvcHMpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgd2lsbFVwZGF0ZVByb3BzKG5leHRQcm9wcykge1xyXG4gICAgICAgIHRoaXMuaHJlZiA9IHRoaXMuZW52LnJvdXRlci5kZXN0VG9QYXRoKG5leHRQcm9wcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNBY3RpdmUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW52LnJvdXRlci5tb2RlID09PSBcImhhc2hcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQubG9jYXRpb24uaGFzaCA9PT0gdGhpcy5ocmVmO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT09IHRoaXMuaHJlZjtcclxuICAgIH1cclxuICAgIG5hdmlnYXRlKGV2KSB7XHJcbiAgICAgICAgLy8gZG9uJ3QgcmVkaXJlY3Qgd2l0aCBjb250cm9sIGtleXNcclxuICAgICAgICBpZiAoZXYubWV0YUtleSB8fCBldi5hbHRLZXkgfHwgZXYuY3RybEtleSB8fCBldi5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRvbid0IHJlZGlyZWN0IG9uIHJpZ2h0IGNsaWNrXHJcbiAgICAgICAgaWYgKGV2LmJ1dHRvbiAhPT0gdW5kZWZpbmVkICYmIGV2LmJ1dHRvbiAhPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRvbid0IHJlZGlyZWN0IGlmIGB0YXJnZXQ9XCJfYmxhbmtcImBcclxuICAgICAgICBpZiAoZXYuY3VycmVudFRhcmdldCAmJiBldi5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldi5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShcInRhcmdldFwiKTtcclxuICAgICAgICAgICAgaWYgKC9cXGJfYmxhbmtcXGIvaS50ZXN0KHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuZW52LnJvdXRlci5uYXZpZ2F0ZSh0aGlzLnByb3BzKTtcclxuICAgIH1cclxufVxyXG5MaW5rLnRlbXBsYXRlID0geG1sIGBcclxuICAgIDxhICB0LWF0dC1jbGFzcz1cInsncm91dGVyLWxpbmstYWN0aXZlJzogaXNBY3RpdmUgfVwiXHJcbiAgICAgICAgdC1hdHQtaHJlZj1cImhyZWZcIlxyXG4gICAgICAgIHQtb24tY2xpY2s9XCJuYXZpZ2F0ZVwiPlxyXG4gICAgICAgIDx0IHQtc2xvdD1cImRlZmF1bHRcIi8+XHJcbiAgICA8L2E+XHJcbiAgYDtcblxuY2xhc3MgUm91dGVDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgZ2V0IHJvdXRlQ29tcG9uZW50KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVudi5yb3V0ZXIuY3VycmVudFJvdXRlICYmIHRoaXMuZW52LnJvdXRlci5jdXJyZW50Um91dGUuY29tcG9uZW50O1xyXG4gICAgfVxyXG59XHJcblJvdXRlQ29tcG9uZW50LnRlbXBsYXRlID0geG1sIGBcclxuICAgIDx0PlxyXG4gICAgICAgIDx0XHJcbiAgICAgICAgICAgIHQtaWY9XCJyb3V0ZUNvbXBvbmVudFwiXHJcbiAgICAgICAgICAgIHQtY29tcG9uZW50PVwicm91dGVDb21wb25lbnRcIlxyXG4gICAgICAgICAgICB0LWtleT1cImVudi5yb3V0ZXIuY3VycmVudFJvdXRlTmFtZVwiXHJcbiAgICAgICAgICAgIHQtcHJvcHM9XCJlbnYucm91dGVyLmN1cnJlbnRQYXJhbXNcIiAvPlxyXG4gICAgPC90PlxyXG4gIGA7XG5cbmNvbnN0IHBhcmFtUmVnZXhwID0gL1xce1xceyguKj8pXFx9XFx9LztcclxuY2xhc3MgUm91dGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKGVudiwgcm91dGVzLCBvcHRpb25zID0geyBtb2RlOiBcImhpc3RvcnlcIiB9KSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um91dGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFBhcmFtcyA9IG51bGw7XHJcbiAgICAgICAgZW52LnJvdXRlciA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlO1xyXG4gICAgICAgIHRoaXMuZW52ID0gZW52O1xyXG4gICAgICAgIHRoaXMucm91dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5yb3V0ZUlkcyA9IFtdO1xyXG4gICAgICAgIGxldCBuZXh0SWQgPSAxO1xyXG4gICAgICAgIGZvciAobGV0IHBhcnRpYWxSb3V0ZSBvZiByb3V0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKCFwYXJ0aWFsUm91dGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcGFydGlhbFJvdXRlLm5hbWUgPSBcIl9fcm91dGVfX1wiICsgbmV4dElkKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcnRpYWxSb3V0ZS5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIFFXZWIucmVnaXN0ZXJDb21wb25lbnQoXCJfX2NvbXBvbmVudF9fXCIgKyBwYXJ0aWFsUm91dGUubmFtZSwgcGFydGlhbFJvdXRlLmNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcnRpYWxSb3V0ZS5yZWRpcmVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZURlc3RpbmF0aW9uKHBhcnRpYWxSb3V0ZS5yZWRpcmVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFydGlhbFJvdXRlLnBhcmFtcyA9IHBhcnRpYWxSb3V0ZS5wYXRoID8gZmluZFBhcmFtcyhwYXJ0aWFsUm91dGUucGF0aCkgOiBbXTtcclxuICAgICAgICAgICAgdGhpcy5yb3V0ZXNbcGFydGlhbFJvdXRlLm5hbWVdID0gcGFydGlhbFJvdXRlO1xyXG4gICAgICAgICAgICB0aGlzLnJvdXRlSWRzLnB1c2gocGFydGlhbFJvdXRlLm5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFB1YmxpYyBBUElcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGFzeW5jIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyID0gZXYgPT4gdGhpcy5fbmF2aWdhdGUodGhpcy5jdXJyZW50UGF0aCgpLCBldik7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCB0aGlzLl9saXN0ZW5lcik7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gXCJoYXNoXCIpIHtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJoYXNoY2hhbmdlXCIsIHRoaXMuX2xpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tYXRjaEFuZEFwcGx5UnVsZXModGhpcy5jdXJyZW50UGF0aCgpKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZSA9IHJlc3VsdC5yb3V0ZTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gcmVzdWx0LnBhcmFtcztcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudFBhdGggPSB0aGlzLnJvdXRlVG9QYXRoKHJlc3VsdC5yb3V0ZSwgcmVzdWx0LnBhcmFtcyk7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50UGF0aCAhPT0gdGhpcy5jdXJyZW50UGF0aCgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybEZyb21QYXRoKGN1cnJlbnRQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIG5hdmlnYXRlKHRvKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZGVzdFRvUGF0aCh0byk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hdmlnYXRlKHBhdGgpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX25hdmlnYXRlKHBhdGgsIGV2KSB7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbE5hbWUgPSB0aGlzLmN1cnJlbnRSb3V0ZU5hbWU7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbFBhcmFtcyA9IHRoaXMuY3VycmVudFBhcmFtcztcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICBjb25zdCBmaW5hbFBhdGggPSB0aGlzLnJvdXRlVG9QYXRoKHJlc3VsdC5yb3V0ZSwgcmVzdWx0LnBhcmFtcyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzUG9wU3RhdGVFdmVudCA9IGV2ICYmIGV2IGluc3RhbmNlb2YgUG9wU3RhdGVFdmVudDtcclxuICAgICAgICAgICAgaWYgKCFpc1BvcFN0YXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXJsRnJvbVBhdGgoZmluYWxQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZSA9IHJlc3VsdC5yb3V0ZTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gcmVzdWx0LnBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVzdWx0LnR5cGUgPT09IFwibm9tYXRjaFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdXRlID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGlkQ2hhbmdlID0gdGhpcy5jdXJyZW50Um91dGVOYW1lICE9PSBpbml0aWFsTmFtZSB8fCAhc2hhbGxvd0VxdWFsKHRoaXMuY3VycmVudFBhcmFtcywgaW5pdGlhbFBhcmFtcyk7XHJcbiAgICAgICAgaWYgKGRpZENoYW5nZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVudi5xd2ViLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBkZXN0VG9QYXRoKGRlc3QpIHtcclxuICAgICAgICB0aGlzLnZhbGlkYXRlRGVzdGluYXRpb24oZGVzdCk7XHJcbiAgICAgICAgcmV0dXJuIGRlc3QucGF0aCB8fCB0aGlzLnJvdXRlVG9QYXRoKHRoaXMucm91dGVzW2Rlc3QudG9dLCBkZXN0LnBhcmFtcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgY3VycmVudFJvdXRlTmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50Um91dGUgJiYgdGhpcy5jdXJyZW50Um91dGUubmFtZTtcclxuICAgIH1cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFByaXZhdGUgaGVscGVyc1xyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgc2V0VXJsRnJvbVBhdGgocGF0aCkge1xyXG4gICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IHRoaXMubW9kZSA9PT0gXCJoYXNoXCIgPyBsb2NhdGlvbi5wYXRobmFtZSA6IFwiXCI7XHJcbiAgICAgICAgY29uc3QgdXJsID0gbG9jYXRpb24ub3JpZ2luICsgc2VwYXJhdG9yICsgcGF0aDtcclxuICAgICAgICBpZiAodXJsICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZikge1xyXG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIHBhdGgsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFsaWRhdGVEZXN0aW5hdGlvbihkZXN0KSB7XHJcbiAgICAgICAgaWYgKCghZGVzdC5wYXRoICYmICFkZXN0LnRvKSB8fCAoZGVzdC5wYXRoICYmIGRlc3QudG8pKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBkZXN0aW5hdGlvbjogJHtKU09OLnN0cmluZ2lmeShkZXN0KX1gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByb3V0ZVRvUGF0aChyb3V0ZSwgcGFyYW1zKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IHJvdXRlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICBjb25zdCBsID0gcGFydHMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTtcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBwYXJ0Lm1hdGNoKHBhcmFtUmVnZXhwKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS5zcGxpdChcIi5cIilbMF07XHJcbiAgICAgICAgICAgICAgICBwYXJ0c1tpXSA9IHBhcmFtc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByZWZpeCA9IHRoaXMubW9kZSA9PT0gXCJoYXNoXCIgPyBcIiNcIiA6IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIHByZWZpeCArIHBhcnRzLmpvaW4oXCIvXCIpO1xyXG4gICAgfVxyXG4gICAgY3VycmVudFBhdGgoKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMubW9kZSA9PT0gXCJoaXN0b3J5XCIgPyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgOiB3aW5kb3cubG9jYXRpb24uaGFzaC5zbGljZSgxKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IFwiL1wiO1xyXG4gICAgfVxyXG4gICAgbWF0Y2gocGF0aCkge1xyXG4gICAgICAgIGZvciAobGV0IHJvdXRlSWQgb2YgdGhpcy5yb3V0ZUlkcykge1xyXG4gICAgICAgICAgICBsZXQgcm91dGUgPSB0aGlzLnJvdXRlc1tyb3V0ZUlkXTtcclxuICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHRoaXMuZ2V0Um91dGVQYXJhbXMocm91dGUsIHBhdGgpO1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWF0Y2hcIixcclxuICAgICAgICAgICAgICAgICAgICByb3V0ZTogcm91dGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogXCJub21hdGNoXCIgfTtcclxuICAgIH1cclxuICAgIGFzeW5jIG1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5tYXRjaChwYXRoKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVJ1bGVzKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBhc3luYyBhcHBseVJ1bGVzKG1hdGNoUmVzdWx0KSB7XHJcbiAgICAgICAgY29uc3Qgcm91dGUgPSBtYXRjaFJlc3VsdC5yb3V0ZTtcclxuICAgICAgICBpZiAocm91dGUucmVkaXJlY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZGVzdFRvUGF0aChyb3V0ZS5yZWRpcmVjdCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJvdXRlLmJlZm9yZVJvdXRlRW50ZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcm91dGUuYmVmb3JlUm91dGVFbnRlcih7XHJcbiAgICAgICAgICAgICAgICBlbnY6IHRoaXMuZW52LFxyXG4gICAgICAgICAgICAgICAgZnJvbTogdGhpcy5jdXJyZW50Um91dGUsXHJcbiAgICAgICAgICAgICAgICB0bzogcm91dGVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiBcImNhbmNlbGxlZFwiIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAocmVzdWx0ICE9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3ZSB3YW50IHRvIG5hdmlnYXRlIHRvIGFub3RoZXIgZGVzdGluYXRpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmRlc3RUb1BhdGgocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF0Y2hSZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBnZXRSb3V0ZVBhcmFtcyhyb3V0ZSwgcGF0aCkge1xyXG4gICAgICAgIGlmIChyb3V0ZS5wYXRoID09PSBcIipcIikge1xyXG4gICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZXNjclBhcnRzID0gcm91dGUucGF0aC5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0UGFydHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICBjb25zdCBsID0gZGVzY3JQYXJ0cy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGwgIT09IHRhcmdldFBhcnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyID0gZGVzY3JQYXJ0c1tpXTtcclxuICAgICAgICAgICAgbGV0IHRhcmdldCA9IHRhcmdldFBhcnRzW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IGRlc2NyLm1hdGNoKHBhcmFtUmVnZXhwKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBba2V5LCBzdWZmaXhdID0gbWF0Y2hbMV0uc3BsaXQoXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1ZmZpeCA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHBhcnNlSW50KHRhcmdldCwgMTApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZGVzY3IgIT09IHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmluZFBhcmFtcyhzdHIpIHtcclxuICAgIGNvbnN0IGdsb2JhbFBhcmFtUmVnZXhwID0gL1xce1xceyguKj8pXFx9XFx9L2c7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGxldCBtO1xyXG4gICAgZG8ge1xyXG4gICAgICAgIG0gPSBnbG9iYWxQYXJhbVJlZ2V4cC5leGVjKHN0cik7XHJcbiAgICAgICAgaWYgKG0pIHtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2gobVsxXS5zcGxpdChcIi5cIilbMF0pO1xyXG4gICAgICAgIH1cclxuICAgIH0gd2hpbGUgKG0pO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxuXG4vKipcclxuICogVGhpcyBmaWxlIGlzIHRoZSBtYWluIGZpbGUgcGFja2FnZWQgYnkgcm9sbHVwIChzZWUgcm9sbHVwLmNvbmZpZy5qcykuICBGcm9tXHJcbiAqIHRoaXMgZmlsZSwgd2UgZXhwb3J0IGFsbCBwdWJsaWMgb3dsIGVsZW1lbnRzLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgZHluYW1pYyB2YWx1ZXMsIHN1Y2ggYXMgYSBkYXRlIG9yIGEgY29tbWl0IGhhc2ggYXJlIGFkZGVkIGJ5IHJvbGx1cFxyXG4gKi9cclxuY29uc3QgQ29udGV4dCQxID0gQ29udGV4dDtcclxuY29uc3QgdXNlU3RhdGUkMSA9IHVzZVN0YXRlO1xyXG5jb25zdCBjb3JlID0geyBFdmVudEJ1cywgT2JzZXJ2ZXIgfTtcclxuY29uc3Qgcm91dGVyID0geyBSb3V0ZXIsIFJvdXRlQ29tcG9uZW50LCBMaW5rIH07XHJcbmNvbnN0IFN0b3JlJDEgPSBTdG9yZTtcclxuY29uc3QgdXRpbHMgPSBfdXRpbHM7XHJcbmNvbnN0IHRhZ3MgPSBfdGFncztcclxuY29uc3QgbWlzYyA9IHsgQXN5bmNSb290LCBQb3J0YWwgfTtcclxuY29uc3QgaG9va3MkMSA9IE9iamVjdC5hc3NpZ24oe30sIF9ob29rcywge1xyXG4gICAgdXNlQ29udGV4dDogdXNlQ29udGV4dCxcclxuICAgIHVzZURpc3BhdGNoOiB1c2VEaXNwYXRjaCxcclxuICAgIHVzZUdldHRlcnM6IHVzZUdldHRlcnMsXHJcbiAgICB1c2VTdG9yZTogdXNlU3RvcmVcclxufSk7XHJcbmNvbnN0IF9faW5mb19fID0ge307XG5cbmV4cG9ydHMuQ29tcG9uZW50ID0gQ29tcG9uZW50O1xuZXhwb3J0cy5Db250ZXh0ID0gQ29udGV4dCQxO1xuZXhwb3J0cy5RV2ViID0gUVdlYjtcbmV4cG9ydHMuU3RvcmUgPSBTdG9yZSQxO1xuZXhwb3J0cy5fX2luZm9fXyA9IF9faW5mb19fO1xuZXhwb3J0cy5jb25maWcgPSBjb25maWc7XG5leHBvcnRzLmNvcmUgPSBjb3JlO1xuZXhwb3J0cy5ob29rcyA9IGhvb2tzJDE7XG5leHBvcnRzLm1pc2MgPSBtaXNjO1xuZXhwb3J0cy5yb3V0ZXIgPSByb3V0ZXI7XG5leHBvcnRzLnRhZ3MgPSB0YWdzO1xuZXhwb3J0cy51c2VTdGF0ZSA9IHVzZVN0YXRlJDE7XG5leHBvcnRzLnV0aWxzID0gdXRpbHM7XG5cbmV4cG9ydHMuX19pbmZvX18udmVyc2lvbiA9ICcxLjAuNyc7XG5leHBvcnRzLl9faW5mb19fLmRhdGUgPSAnMjAyMC0wNC0xN1QxMzo1Mzo1Ny41MDdaJztcbmV4cG9ydHMuX19pbmZvX18uaGFzaCA9ICcyM2NlMTllJztcbmV4cG9ydHMuX19pbmZvX18udXJsID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9vZG9vL293bCc7XG4iLCIvLyBJbXBvcnRzXG52YXIgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fID0gcmVxdWlyZShcIi4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG5leHBvcnRzID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKGZhbHNlKTtcbi8vIE1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwianctZWRpdG9yIHtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cIiwgXCJcIl0pO1xuLy8gRXhwb3J0c1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzO1xuIiwiLy8gSW1wb3J0c1xudmFyIF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyA9IHJlcXVpcmUoXCIuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuZXhwb3J0cyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhmYWxzZSk7XG4vLyBNb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcImp3LWVkaXRvciB7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxufVxcblxcbi5qdy1kcm9wZG93biB7XFxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG59XFxuLmp3LWRyb3Bkb3duIC5kcm9wZG93bi1tZW51IHtcXG4gICAgbWluLXdpZHRoOiAyNTBweDtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzAwMDtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzE0MTIxNztcXG59XFxuXFxuanctdG9vbGJhciBpbnB1dCB7XFxuICAgIGNvbG9yOiAjQzZDNkM2O1xcbn1cXG5cIiwgXCJcIl0pO1xuLy8gRXhwb3J0c1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzO1xuIiwiLy8gSW1wb3J0c1xudmFyIF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuZXhwb3J0cyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhmYWxzZSk7XG4vLyBNb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIiNqdy1kZXZpY2UtcHJldmlldyB7XFxuICAgIGJvcmRlci13aWR0aDogODBweCAxNHB4IDQwcHg7XFxuICAgIGJvcmRlci1yYWRpdXM6IDE2cHg7XFxuICAgIGJvcmRlci1zdHlsZTogc29saWQ7XFxuICAgIGJvcmRlci1jb2xvcjogIzAwMDtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XFxuICAgIHdpZHRoOiA0MDBweDtcXG4gICAgaGVpZ2h0OiA3MDBweDtcXG4gICAgbWFyZ2luOiBhdXRvO1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIi8vIEltcG9ydHNcbnZhciBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gPSByZXF1aXJlKFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbmV4cG9ydHMgPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKiBHTE9CQUwgKi9cXG5cXG5qdy1kZXZ0b29scyB7XFxuICAgIHBvc2l0aW9uOiBzdGlja3k7XFxuICAgIHBvc2l0aW9uOiAtd2Via2l0LXN0aWNreTtcXG4gICAgYm90dG9tOiAwO1xcbiAgICBtaW4taGVpZ2h0OiAzMHB4O1xcbiAgICBtYXgtaGVpZ2h0OiAxMDAlO1xcbiAgICB0b3A6IGF1dG87XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2QwZDBkMDtcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG4gICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7XFxuICAgIHVzZXItc2VsZWN0OiBub25lO1xcbiAgICBvdXRsaW5lOiBub25lO1xcbn1cXG5cXG5kZXZ0b29scy10YWJsZSB7XFxuICAgIGRpc3BsYXk6IHRhYmxlO1xcbiAgICB3aWR0aDogMTAwJVxcbn1cXG5kZXZ0b29scy10Ym9keSB7XFxuICAgIGRpc3BsYXk6IHRhYmxlLXJvdy1ncm91cDtcXG59XFxuZGV2dG9vbHMtdHIge1xcbiAgICBkaXNwbGF5OiB0YWJsZS1yb3c7XFxufVxcbmRldnRvb2xzLXRkIHtcXG4gICAgZGlzcGxheTogdGFibGUtY2VsbDtcXG4gICAgcGFkZGluZy1yaWdodDogMjVweDtcXG59XFxuZGV2dG9vbHMtYnV0dG9uIHtcXG4gICAgZGlzcGxheTogaW5saW5lO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBsaW5lLWhlaWdodDogMmVtO1xcbiAgICBmb250LWZhbWlseTogaW5pdGlhbDtcXG59XFxuZGV2dG9vbHMtbGlzdCB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBsaXN0LXN0eWxlOiBub25lO1xcbn1cXG5kZXZ0b29scy1saXN0aXRlbSB7XFxuICAgIGRpc3BsYXk6IGxpc3QtaXRlbTtcXG59XFxuXFxuanctZGV2dG9vbHMuY2xvc2VkIHtcXG4gICAgbWF4LWhlaWdodDogMzFweDtcXG59XFxuXFxuanctZGV2dG9vbHMgLmJvbGQge1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG59XFxuXFxuanctZGV2dG9vbHMgLml0YWxpYyB7XFxuICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcXG59XFxuXFxuanctZGV2dG9vbHMgLnVuZGVybGluZSB7XFxuICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xcbn1cXG5cXG5qdy1kZXZ0b29scyAubGluayB7XFxuICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xcbiAgICBjb2xvcjogYmx1ZTtcXG59XFxuXFxuanctZGV2dG9vbHMgLnN1YnNjcmlwdCB7XFxuICAgIHZlcnRpY2FsLWFsaWduOiBzdWI7XFxuICAgIGZvbnQtc2l6ZTogMC43ZW07XFxufVxcblxcbmp3LWRldnRvb2xzIC5zdXBlcnNjcmlwdCB7XFxuICAgIHZlcnRpY2FsLWFsaWduOiBzdXBlcjtcXG4gICAgZm9udC1zaXplOiAwLjdlbTtcXG59XFxuXFxuanctZGV2dG9vbHMgLm1hcmtlci1ub2RlIHtcXG4gICAgY29sb3I6IHJlZDtcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWwge1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBvdmVyZmxvdzogYXV0bztcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWw6bm90KC5hY3RpdmUpIHtcXG4gICAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWwgLnNlbGVjdGFibGUtbGluZTpob3ZlciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMTE4LCA4MiwgMTA4LCAwLjIpO1xcbn1cXG5cXG5kZXZ0b29scy1wYW5lbCAuc2VsZWN0YWJsZS1saW5lLnNlbGVjdGVkIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxMTgsIDgyLCAxMDgsIDAuMyk7XFxufVxcblxcbmRldnRvb2xzLXBhbmVsIGRldnRvb2xzLWJ1dHRvbi5sb2dnZXIge1xcbiAgICBmbG9hdDogcmlnaHQ7XFxuICAgIGJvcmRlcjogbm9uZTtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICAgIGNvbG9yOiAjNjY2NjY2O1xcbiAgICBwYWRkaW5nOiAwO1xcbiAgICBtYXJnaW46IDA7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIGxpbmUtaGVpZ2h0OiAwLjdlbTtcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWwgZGV2dG9vbHMtYWJvdXQgPiBkZXZ0b29scy1idXR0b24ubG9nZ2VyIHtcXG4gICAgZGlzcGxheTogaW5saW5lO1xcbiAgICBtYXJnaW4tbGVmdDogMWVtO1xcbn1cXG5cXG5kZXZ0b29scy1wYW5lbCAuc2VsZWN0YWJsZS1saW5lOmhvdmVyIGRldnRvb2xzLWJ1dHRvbi5sb2dnZXIsIGRldnRvb2xzLXBhbmVsIC5zZWxlY3RlZCBkZXZ0b29scy1idXR0b24ubG9nZ2VyIHtcXG4gICAgZGlzcGxheTogaW5saW5lO1xcbn1cXG5cXG4vKiBOQVZCQVIgKi9cXG5cXG5qdy1kZXZ0b29sczpub3QoLmNsb3NlZCkgPiBkZXZ0b29scy1uYXZiYXIge1xcbiAgICBjdXJzb3I6IHJvdy1yZXNpemU7XFxufVxcblxcbmRldnRvb2xzLW5hdmJhciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmM2YzZjM7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcXG4gICAgZmxleC13cmFwOiBub3dyYXA7XFxuICAgIGhlaWdodDogMzBweDtcXG4gICAgbWluLWhlaWdodDogMzBweDtcXG4gICAgd2lkdGg6IDEwMCU7XFxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxuICAgIGJvcmRlcjogMDtcXG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkMGQwZDA7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICAgIHZlcnRpY2FsLWFsaWduOiBiYXNlbGluZTtcXG59XFxuXFxuZGV2dG9vbHMtbmF2YmFyID4gZGV2dG9vbHMtYnV0dG9uIHtcXG4gICAgcGFkZGluZzogMCAxMHB4IDAgMTBweDtcXG4gICAgYmFja2dyb3VuZDogbm9uZTtcXG4gICAgYm9yZGVyOiAwO1xcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xcbiAgICBvdXRsaW5lOiBub25lO1xcbiAgICBjdXJzb3I6IGF1dG87XFxufVxcblxcbmRldnRvb2xzLW5hdmJhciA+IGRldnRvb2xzLWJ1dHRvbjpob3ZlciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNkNmQ2ZDY7XFxufVxcblxcbmRldnRvb2xzLW5hdmJhciA+IGRldnRvb2xzLWJ1dHRvbi5zZWxlY3RlZCB7XFxuICAgIGJvcmRlci1ib3R0b206IHNvbGlkIDJweCAjNzY1MjZjO1xcbn1cXG5cXG4vKiBDT05URU5UUyAqL1xcblxcbmRldnRvb2xzLWNvbnRlbnRzIHtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcXG4gICAgZmxleDogMTtcXG4gICAgb3ZlcmZsb3c6IGF1dG87XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIENvdXJpZXIsIG1vbm9zcGFjZTtcXG59XFxuXFxuLyogbWFpbnBhbmUgKi9cXG5cXG5kZXZ0b29scy1tYWlucGFuZSB7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIG92ZXJmbG93OiBhdXRvO1xcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xcbiAgICB3aWR0aDogMTAwJTtcXG59XFxuXFxubWFpbnBhbmUtY29udGVudHMge1xcbiAgICBvdmVyZmxvdzogYXV0bztcXG4gICAgZmxleDogMTtcXG4gICAgcGFkZGluZzogMWVtO1xcbn1cXG5cXG5kZXZ0b29scy1jb21tYW5kIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbmRldnRvb2xzLXRkLm51bWJlcmluZyB7XFxuICAgIGNvbG9yOiBncmV5O1xcbn1cXG5cXG5cXG4vKiB0cmVlICovXFxuXFxuZGV2dG9vbHMtdHJlZSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBmbGV4LWdyb3c6IDE7XFxuICAgIHdpZHRoOiAxMDAlO1xcbn1cXG5cXG5kZXZ0b29scy10cmVlIGRldnRvb2xzLWNoaWxkcmVuIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgcGFkZGluZzogMXB4IDAgMXB4IDEuNWVtO1xcbiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNkMGQwZDA7XFxufVxcblxcbmRldnRvb2xzLXRyZWUgZGl2IHtcXG4gICAgd2lkdGg6IDEwMCU7XFxufVxcblxcbmRldnRvb2xzLXRyZWUgPiBkZXZ0b29scy1ub2RlLnJvb3QgPiBkZXZ0b29scy1ub2RlbmFtZSB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICM3NjUyNmM7XFxuICAgIGNvbG9yOiB3aGl0ZTtcXG4gICAgcGFkZGluZy1sZWZ0OiA1cHg7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxufVxcblxcbmp3LWRldnRvb2xzIGRldnRvb2xzLW5vZGVuYW1lLmlubGluZSB7XFxuICAgIGRpc3BsYXk6IGlubGluZTtcXG59XFxuXFxuZGV2dG9vbHMtdHJlZSBkZXZ0b29scy1ub2RlbmFtZS5ibG9jayB7XFxuICAgIGNvbG9yOiAjNzY1MjZjO1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbn1cXG5cXG5kZXZ0b29scy10cmVlIGRldnRvb2xzLW5vZGVuYW1lLmxpbmUtYnJlYWs6YWZ0ZXIge1xcbiAgICBjb250ZW50OiAnXFxcXEEnO1xcbiAgICB3aGl0ZS1zcGFjZTogcHJlO1xcbn1cXG5cXG5kZXZ0b29scy1ub2RlIHtcXG4gICAgb3V0bGluZTogbm9uZTtcXG59XFxuXFxuZGV2dG9vbHMtbm9kZTpub3QoLmZvbGRlZCk6bm90KC5zZWxmLWNsb3NpbmcpOm5vdCgucm9vdCkgPiBkZXZ0b29scy1ub2RlbmFtZS5ibG9jazpiZWZvcmUge1xcbiAgICBjb250ZW50OiAn4oyEICc7XFxufVxcblxcbmRldnRvb2xzLW5vZGUuZm9sZGVkOm5vdCguc2VsZi1jbG9zaW5nKSA+IGRldnRvb2xzLW5vZGVuYW1lLmJsb2NrOmJlZm9yZSB7XFxuICAgIGNvbnRlbnQ6ICfigLogJztcXG59XFxuXFxuZGV2dG9vbHMtbm9kZS5mb2xkZWQgZGV2dG9vbHMtY2hpbGRyZW4ge1xcbiAgICBkaXNwbGF5OiBub25lO1xcbn1cXG5cXG5kZXZ0b29scy1wYXRoIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZDBkMGQwO1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGRkZGRkO1xcbiAgICBib3R0b206IDA7XFxuICAgIGxlZnQ6IDA7XFxuICAgIHJpZ2h0OiAwO1xcbn1cXG5cXG5kZXZ0b29scy1wYXRobm9kZSB7XFxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gICAgcGFkZGluZzogLjJlbSAxZW0gLjJlbSAxZW07XFxuICAgIGNvbG9yOiAjNjk2OTY5O1xcbiAgICBmb250LXNpemU6IDEzcHg7XFxufVxcblxcbmRldnRvb2xzLXBhdGhub2RlOmhvdmVyIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2Q2ZDZkNjtcXG59XFxuXFxuZGV2dG9vbHMtcGF0aG5vZGUuc2VsZWN0ZWQge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDBkMGQwO1xcbn1cXG5cXG4vKiBzaWRlcGFuZSAqL1xcblxcbmRldnRvb2xzLXNpZGVwYW5lIHtcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBvdmVyZmxvdzogYXV0bztcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGZvbnQtc2l6ZTogMTVweDtcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgd2lkdGg6IDMwJTtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XFxuICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2QwZDBkMDtcXG59XFxuXFxuZGV2dG9vbHMtc2lkZXBhbmUgZGV2dG9vbHMtYWJvdXQge1xcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2QwZDBkMDtcXG4gICAgcGFkZGluZzogMTBweDtcXG59XFxuXFxuZGV2dG9vbHMtc2lkZXBhbmUgZGV2dG9vbHMtYWJvdXQgZGV2dG9vbHMtdHlwZSB7XFxuICAgIGZvbnQtZmFtaWx5OiBpbml0aWFsO1xcbiAgICBmb250LXN0eWxlOiBpdGFsaWM7XFxuICAgIGZvbnQtc2l6ZTogc21hbGxlcjtcXG4gICAgY29sb3I6ICM3NjUyNmM7XFxuICAgIHBhZGRpbmctcmlnaHQ6IC41ZW07XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMge1xcbiAgICBmb250LXNpemU6IDEycHg7XFxuICAgIHBhZGRpbmc6IDEwcHg7XFxuICAgIG92ZXJmbG93OiBhdXRvO1xcbiAgICBtYXJnaW4tYm90dG9tOiAzMHB4O1xcbn1cXG5cXG5kZXZ0b29scy1pbmZvdGl0bGUge1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG59XFxuXFxuZGV2dG9vbHMtc2lkZXBhbmUgZGV2dG9vbHMtcHJvcGVydGllcyBkZXZ0b29scy1pbmZvdGl0bGUge1xcbiAgICBwYWRkaW5nOiAxZW07XFxuICAgIGZvbnQtZmFtaWx5OiBpbml0aWFsO1xcbiAgICBmb250LXNpemU6IGxhcmdlcjtcXG4gICAgY29sb3I6ICMzODIwMzQ7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtaW5mb3RpdGxlOmZpcnN0LWNoaWxkIHtcXG4gICAgcGFkZGluZy10b3A6IDBlbTtcXG59XFxuXFxuZGV2dG9vbHMtc2lkZXBhbmUgZGV2dG9vbHMtcHJvcGVydGllcyBkZXZ0b29scy10YWJsZSB7XFxuICAgIHdpZHRoOiAxMDAlO1xcbiAgICBmb250LXNpemU6IGluaGVyaXQ7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtdGFibGUgZGV2dG9vbHMtdGJvZHl7XFxuICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtdGFibGUgZGV2dG9vbHMtdGQge1xcbiAgICBwYWRkaW5nOiAwLjNlbTtcXG59XFxuXFxuZGV2dG9vbHMtc2lkZXBhbmUgZGV2dG9vbHMtcHJvcGVydGllcyBkZXZ0b29scy10YWJsZSBkZXZ0b29scy10ZDpudGgtY2hpbGQoMSkge1xcbiAgICB3aWR0aDogMTAwcHg7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtdGFibGUgZGV2dG9vbHMtbGlzdCB7XFxuICAgIGxpc3Qtc3R5bGUtcG9zaXRpb246IGluc2lkZTtcXG4gICAgcGFkZGluZy1sZWZ0OiAwO1xcbiAgICBtYXJnaW46IDA7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgPiBkZXZ0b29scy10YWJsZSA+IGRldnRvb2xzLXRib2R5ID4gZGV2dG9vbHMtdHI6bnRoLWNoaWxkKGV2ZW4pIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2Y0ZjRmNDtcXG59XFxuXFxuZGV2dG9vbHMtaW5mbyB7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxufVxcblxcbmRldnRvb2xzLWluZm8gZGV2dG9vbHMtYWJvdXQgZGV2dG9vbHMtaWQge1xcbiAgICBmbG9hdDogcmlnaHQ7XFxuICAgIGNvbG9yOiAjNzY1MjZjO1xcbiAgICBmb250LXNpemU6IHNtYWxsZXI7XFxufVxcblwiLCBcIlwiXSk7XG4vLyBFeHBvcnRzXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHM7XG4iLCIvLyBJbXBvcnRzXG52YXIgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fID0gcmVxdWlyZShcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG5leHBvcnRzID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKGZhbHNlKTtcbi8vIE1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwianctZGlhbG9nLWNvbnRhaW5lciB7XFxuICAgIHBvc2l0aW9uOiBmaXhlZDtcXG4gICAgdG9wOiAwO1xcbiAgICBsZWZ0OiAwO1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgaGVpZ2h0OiAxMDAlO1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXG59XFxuanctZGlhbG9nLWNvbnRhaW5lciBqdy1iYWNrZHJvcCB7XFxuICAgIHBvc2l0aW9uOiBmaXhlZDtcXG4gICAgdG9wOiAwO1xcbiAgICBsZWZ0OiAwO1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgaGVpZ2h0OiAxMDAlO1xcbiAgICBvcGFjaXR5OiAwLjU7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDAwMDA7XFxufVxcbmp3LWRpYWxvZy1jb250YWluZXIganctZGlhbG9nIHtcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBtYXgtd2lkdGg6IDgwJTtcXG59XFxuanctZGlhbG9nLWNvbnRhaW5lciBqdy1kaWFsb2cgPiBqdy1jb250ZW50IHtcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjdGN0Y3O1xcbiAgICBwYWRkaW5nOiAxMHB4O1xcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xcbn1cXG5qdy1kaWFsb2ctY29udGFpbmVyIGp3LWRpYWxvZyA+IGp3LWNvbnRlbnQgPiBqdy1idXR0b24uY2xvc2Uge1xcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgIHJpZ2h0OiAxMHB4O1xcbiAgICB0b3A6IDRweDtcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcbn1cXG5qdy1kaWFsb2ctY29udGFpbmVyIGp3LWRpYWxvZyB0YWJsZS5mb3JtLXRhYmxlIHtcXG4gICAgYm9yZGVyOiBub25lO1xcbn1cXG5qdy1kaWFsb2ctY29udGFpbmVyIGp3LWRpYWxvZyB0YWJsZS5mb3JtLXRhYmxlIHRkIHtcXG4gICAgYm9yZGVyOiBub25lO1xcbn1cXG5cIiwgXCJcIl0pO1xuLy8gRXhwb3J0c1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzO1xuIiwiLy8gSW1wb3J0c1xudmFyIF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuZXhwb3J0cyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhmYWxzZSk7XG4vLyBNb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcImp3LWZvbGxvdy1yYW5nZSB7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIi8vIEltcG9ydHNcbnZhciBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gPSByZXF1aXJlKFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbmV4cG9ydHMgPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIuanctZnVsbHNjcmVlbiAuanctZnVsbHNjcmVlbiB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBwb3NpdGlvbjogZml4ZWQ7XFxuICAgIHRyYW5zZm9ybTogbm9uZTtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gICAgbGVmdDogMDtcXG4gICAgcmlnaHQ6IDA7XFxuICAgIHRvcDogMDtcXG4gICAgYm90dG9tOiAwO1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgbWluLWhlaWdodDogMTAwJTtcXG4gICAgYmFja2dyb3VuZDogI2ZmZmZmZjtcXG59XFxuLmp3LWZ1bGxzY3JlZW4ganctZm9sbG93LXJhbmdlIHtcXG4gICAgei1pbmRleDogMTtcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIi8vIEltcG9ydHNcbnZhciBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gPSByZXF1aXJlKFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbmV4cG9ydHMgPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJ1bC5jaGVja2xpc3QgPiBsaSB7XFxuICAgIGxpc3Qtc3R5bGU6IG5vbmU7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxudWwuY2hlY2tsaXN0ID4gbGkudW5jaGVja2VkOmJlZm9yZSwgdWwuY2hlY2tsaXN0ID4gbGkuY2hlY2tlZDpiZWZvcmUge1xcbiAgICBjb250ZW50OiAnJztcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICBsZWZ0OiAtMjBweDtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGhlaWdodDogMTNweDtcXG4gICAgd2lkdGg6IDEzcHg7XFxuICAgIGJvcmRlcjogMXB4IHNvbGlkO1xcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxufVxcbnVsLmNoZWNrbGlzdCA+IGxpOmFmdGVyIHtcXG4gICAgY29udGVudDogJyc7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgbGVmdDogLTE3cHg7XFxuICAgIHRvcDogLTFweDtcXG4gICAgZm9udC1zaXplOiAxM3B4O1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxufVxcbnVsLmNoZWNrbGlzdCA+IGxpLmNoZWNrZWQ6YWZ0ZXIge1xcbiAgICBjb250ZW50OiBcXFwi4pyTXFxcIjtcXG4gICAgdHJhbnNpdGlvbjogb3BhY2l0eSAuNXM7XFxuICAgIG9wYWNpdHk6IDE7XFxufVxcblwiLCBcIlwiXSk7XG4vLyBFeHBvcnRzXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHM7XG4iLCIvLyBJbXBvcnRzXG52YXIgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fID0gcmVxdWlyZShcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG5leHBvcnRzID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKGZhbHNlKTtcbi8vIE1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwidGFibGUudGFibGUtcGlja2VyIHtcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XFxuICAgIC13ZWJraXQtYm94LXNoYWRvdzogMnB4IDJweCA1cHggMHB4IHJnYmEoMCwwLDAsLjQpO1xcbiAgICAtbW96LWJveC1zaGFkb3c6IDJweCAycHggNXB4IDBweCByZ2JhKDAsMCwwLC40KTtcXG4gICAgYm94LXNoYWRvdzogMnB4IDJweCA1cHggMHB4IHJnYmEoMCwwLDAsLjQpO1xcbn1cXG50YWJsZS50YWJsZS1waWNrZXIgdHIge1xcbiAgICBoZWlnaHQ6IDFlbTtcXG4gICAgcGFkZGluZzogMDtcXG59XFxudGFibGUudGFibGUtcGlja2VyIHRkIHtcXG4gICAgd2lkdGg6IDFlbTtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XFxuICAgIHBhZGRpbmc6IDA7XFxufVxcbnRhYmxlLnRhYmxlLXBpY2tlciB0ZC5oaWdobGlnaHQge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjODc1QTdCO1xcbn1cXG5cXG5zcGFuLnRhYmxlLWhhbmRsZXIuZmEtcGx1cy1zcXVhcmUge1xcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XFxuICAgIHdpZHRoOiAxZW07XFxuICAgIGNvbG9yOiAjMDBGRjAwO1xcbn1cXG5zcGFuLnRhYmxlLWhhbmRsZXIuZmEtbWludXMtc3F1YXJlIHtcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xcbiAgICB3aWR0aDogMWVtO1xcbiAgICBjb2xvcjogI0ZGMDAwMDtcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIlwidXNlIHN0cmljdFwiO1xuXG4vKlxuICBNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuICBBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuLy8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh1c2VTb3VyY2VNYXApIHtcbiAgdmFyIGxpc3QgPSBbXTsgLy8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xuXG4gIGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHZhciBjb250ZW50ID0gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApO1xuXG4gICAgICBpZiAoaXRlbVsyXSkge1xuICAgICAgICByZXR1cm4gXCJAbWVkaWEgXCIuY29uY2F0KGl0ZW1bMl0sIFwiIHtcIikuY29uY2F0KGNvbnRlbnQsIFwifVwiKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfSkuam9pbignJyk7XG4gIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG5cblxuICBsaXN0LmkgPSBmdW5jdGlvbiAobW9kdWxlcywgbWVkaWFRdWVyeSwgZGVkdXBlKSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGVzID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICBtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCAnJ11dO1xuICAgIH1cblxuICAgIHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XG5cbiAgICBpZiAoZGVkdXBlKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG4gICAgICAgIHZhciBpZCA9IHRoaXNbaV1bMF07XG5cbiAgICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgICBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2lkXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgbW9kdWxlcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBpdGVtID0gW10uY29uY2F0KG1vZHVsZXNbX2ldKTtcblxuICAgICAgaWYgKGRlZHVwZSAmJiBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb250aW51ZVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1lZGlhUXVlcnkpIHtcbiAgICAgICAgaWYgKCFpdGVtWzJdKSB7XG4gICAgICAgICAgaXRlbVsyXSA9IG1lZGlhUXVlcnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbVsyXSA9IFwiXCIuY29uY2F0KG1lZGlhUXVlcnksIFwiIGFuZCBcIikuY29uY2F0KGl0ZW1bMl0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIGxpc3Q7XG59O1xuXG5mdW5jdGlvbiBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0sIHVzZVNvdXJjZU1hcCkge1xuICB2YXIgY29udGVudCA9IGl0ZW1bMV0gfHwgJyc7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuXG4gIHZhciBjc3NNYXBwaW5nID0gaXRlbVszXTtcblxuICBpZiAoIWNzc01hcHBpbmcpIHtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxuXG4gIGlmICh1c2VTb3VyY2VNYXAgJiYgdHlwZW9mIGJ0b2EgPT09ICdmdW5jdGlvbicpIHtcbiAgICB2YXIgc291cmNlTWFwcGluZyA9IHRvQ29tbWVudChjc3NNYXBwaW5nKTtcbiAgICB2YXIgc291cmNlVVJMcyA9IGNzc01hcHBpbmcuc291cmNlcy5tYXAoZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgcmV0dXJuIFwiLyojIHNvdXJjZVVSTD1cIi5jb25jYXQoY3NzTWFwcGluZy5zb3VyY2VSb290IHx8ICcnKS5jb25jYXQoc291cmNlLCBcIiAqL1wiKTtcbiAgICB9KTtcbiAgICByZXR1cm4gW2NvbnRlbnRdLmNvbmNhdChzb3VyY2VVUkxzKS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIHJldHVybiBbY29udGVudF0uam9pbignXFxuJyk7XG59IC8vIEFkYXB0ZWQgZnJvbSBjb252ZXJ0LXNvdXJjZS1tYXAgKE1JVClcblxuXG5mdW5jdGlvbiB0b0NvbW1lbnQoc291cmNlTWFwKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuICB2YXIgYmFzZTY0ID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKTtcbiAgdmFyIGRhdGEgPSBcInNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTg7YmFzZTY0LFwiLmNvbmNhdChiYXNlNjQpO1xuICByZXR1cm4gXCIvKiMgXCIuY29uY2F0KGRhdGEsIFwiICovXCIpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgaXNPbGRJRSA9IGZ1bmN0aW9uIGlzT2xkSUUoKSB7XG4gIHZhciBtZW1vO1xuICByZXR1cm4gZnVuY3Rpb24gbWVtb3JpemUoKSB7XG4gICAgaWYgKHR5cGVvZiBtZW1vID09PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gVGVzdCBmb3IgSUUgPD0gOSBhcyBwcm9wb3NlZCBieSBCcm93c2VyaGFja3NcbiAgICAgIC8vIEBzZWUgaHR0cDovL2Jyb3dzZXJoYWNrcy5jb20vI2hhY2stZTcxZDg2OTJmNjUzMzQxNzNmZWU3MTVjMjIyY2I4MDVcbiAgICAgIC8vIFRlc3RzIGZvciBleGlzdGVuY2Ugb2Ygc3RhbmRhcmQgZ2xvYmFscyBpcyB0byBhbGxvdyBzdHlsZS1sb2FkZXJcbiAgICAgIC8vIHRvIG9wZXJhdGUgY29ycmVjdGx5IGludG8gbm9uLXN0YW5kYXJkIGVudmlyb25tZW50c1xuICAgICAgLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlci9pc3N1ZXMvMTc3XG4gICAgICBtZW1vID0gQm9vbGVhbih3aW5kb3cgJiYgZG9jdW1lbnQgJiYgZG9jdW1lbnQuYWxsICYmICF3aW5kb3cuYXRvYik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1lbW87XG4gIH07XG59KCk7XG5cbnZhciBnZXRUYXJnZXQgPSBmdW5jdGlvbiBnZXRUYXJnZXQoKSB7XG4gIHZhciBtZW1vID0ge307XG4gIHJldHVybiBmdW5jdGlvbiBtZW1vcml6ZSh0YXJnZXQpIHtcbiAgICBpZiAodHlwZW9mIG1lbW9bdGFyZ2V0XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHZhciBzdHlsZVRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KTsgLy8gU3BlY2lhbCBjYXNlIHRvIHJldHVybiBoZWFkIG9mIGlmcmFtZSBpbnN0ZWFkIG9mIGlmcmFtZSBpdHNlbGZcblxuICAgICAgaWYgKHdpbmRvdy5IVE1MSUZyYW1lRWxlbWVudCAmJiBzdHlsZVRhcmdldCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MSUZyYW1lRWxlbWVudCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIFRoaXMgd2lsbCB0aHJvdyBhbiBleGNlcHRpb24gaWYgYWNjZXNzIHRvIGlmcmFtZSBpcyBibG9ja2VkXG4gICAgICAgICAgLy8gZHVlIHRvIGNyb3NzLW9yaWdpbiByZXN0cmljdGlvbnNcbiAgICAgICAgICBzdHlsZVRhcmdldCA9IHN0eWxlVGFyZ2V0LmNvbnRlbnREb2N1bWVudC5oZWFkO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgLy8gaXN0YW5idWwgaWdub3JlIG5leHRcbiAgICAgICAgICBzdHlsZVRhcmdldCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbWVtb1t0YXJnZXRdID0gc3R5bGVUYXJnZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1lbW9bdGFyZ2V0XTtcbiAgfTtcbn0oKTtcblxudmFyIHN0eWxlc0luRG9tID0gW107XG5cbmZ1bmN0aW9uIGdldEluZGV4QnlJZGVudGlmaWVyKGlkZW50aWZpZXIpIHtcbiAgdmFyIHJlc3VsdCA9IC0xO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzSW5Eb20ubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3R5bGVzSW5Eb21baV0uaWRlbnRpZmllciA9PT0gaWRlbnRpZmllcikge1xuICAgICAgcmVzdWx0ID0gaTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIG1vZHVsZXNUb0RvbShsaXN0LCBvcHRpb25zKSB7XG4gIHZhciBpZENvdW50TWFwID0ge307XG4gIHZhciBpZGVudGlmaWVycyA9IFtdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICB2YXIgaWQgPSBvcHRpb25zLmJhc2UgPyBpdGVtWzBdICsgb3B0aW9ucy5iYXNlIDogaXRlbVswXTtcbiAgICB2YXIgY291bnQgPSBpZENvdW50TWFwW2lkXSB8fCAwO1xuICAgIHZhciBpZGVudGlmaWVyID0gXCJcIi5jb25jYXQoaWQsIFwiIFwiKS5jb25jYXQoY291bnQpO1xuICAgIGlkQ291bnRNYXBbaWRdID0gY291bnQgKyAxO1xuICAgIHZhciBpbmRleCA9IGdldEluZGV4QnlJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xuICAgIHZhciBvYmogPSB7XG4gICAgICBjc3M6IGl0ZW1bMV0sXG4gICAgICBtZWRpYTogaXRlbVsyXSxcbiAgICAgIHNvdXJjZU1hcDogaXRlbVszXVxuICAgIH07XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICBzdHlsZXNJbkRvbVtpbmRleF0ucmVmZXJlbmNlcysrO1xuICAgICAgc3R5bGVzSW5Eb21baW5kZXhdLnVwZGF0ZXIob2JqKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3R5bGVzSW5Eb20ucHVzaCh7XG4gICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIsXG4gICAgICAgIHVwZGF0ZXI6IGFkZFN0eWxlKG9iaiwgb3B0aW9ucyksXG4gICAgICAgIHJlZmVyZW5jZXM6IDFcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlkZW50aWZpZXJzLnB1c2goaWRlbnRpZmllcik7XG4gIH1cblxuICByZXR1cm4gaWRlbnRpZmllcnM7XG59XG5cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSB7XG4gIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gIHZhciBhdHRyaWJ1dGVzID0gb3B0aW9ucy5hdHRyaWJ1dGVzIHx8IHt9O1xuXG4gIGlmICh0eXBlb2YgYXR0cmlidXRlcy5ub25jZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB2YXIgbm9uY2UgPSB0eXBlb2YgX193ZWJwYWNrX25vbmNlX18gIT09ICd1bmRlZmluZWQnID8gX193ZWJwYWNrX25vbmNlX18gOiBudWxsO1xuXG4gICAgaWYgKG5vbmNlKSB7XG4gICAgICBhdHRyaWJ1dGVzLm5vbmNlID0gbm9uY2U7XG4gICAgfVxuICB9XG5cbiAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgc3R5bGUuc2V0QXR0cmlidXRlKGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgfSk7XG5cbiAgaWYgKHR5cGVvZiBvcHRpb25zLmluc2VydCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIG9wdGlvbnMuaW5zZXJ0KHN0eWxlKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgdGFyZ2V0ID0gZ2V0VGFyZ2V0KG9wdGlvbnMuaW5zZXJ0IHx8ICdoZWFkJyk7XG5cbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3QgZmluZCBhIHN0eWxlIHRhcmdldC4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0IHRoZSB2YWx1ZSBmb3IgdGhlICdpbnNlcnQnIHBhcmFtZXRlciBpcyBpbnZhbGlkLlwiKTtcbiAgICB9XG5cbiAgICB0YXJnZXQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICB9XG5cbiAgcmV0dXJuIHN0eWxlO1xufVxuXG5mdW5jdGlvbiByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGUpIHtcbiAgLy8gaXN0YW5idWwgaWdub3JlIGlmXG4gIGlmIChzdHlsZS5wYXJlbnROb2RlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc3R5bGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZSk7XG59XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAgKi9cblxuXG52YXIgcmVwbGFjZVRleHQgPSBmdW5jdGlvbiByZXBsYWNlVGV4dCgpIHtcbiAgdmFyIHRleHRTdG9yZSA9IFtdO1xuICByZXR1cm4gZnVuY3Rpb24gcmVwbGFjZShpbmRleCwgcmVwbGFjZW1lbnQpIHtcbiAgICB0ZXh0U3RvcmVbaW5kZXhdID0gcmVwbGFjZW1lbnQ7XG4gICAgcmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG4gIH07XG59KCk7XG5cbmZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGUsIGluZGV4LCByZW1vdmUsIG9iaikge1xuICB2YXIgY3NzID0gcmVtb3ZlID8gJycgOiBvYmoubWVkaWEgPyBcIkBtZWRpYSBcIi5jb25jYXQob2JqLm1lZGlhLCBcIiB7XCIpLmNvbmNhdChvYmouY3NzLCBcIn1cIikgOiBvYmouY3NzOyAvLyBGb3Igb2xkIElFXG5cbiAgLyogaXN0YW5idWwgaWdub3JlIGlmICAqL1xuXG4gIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgc3R5bGUuc3R5bGVTaGVldC5jc3NUZXh0ID0gcmVwbGFjZVRleHQoaW5kZXgsIGNzcyk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpO1xuICAgIHZhciBjaGlsZE5vZGVzID0gc3R5bGUuY2hpbGROb2RlcztcblxuICAgIGlmIChjaGlsZE5vZGVzW2luZGV4XSkge1xuICAgICAgc3R5bGUucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xuICAgIH1cblxuICAgIGlmIChjaGlsZE5vZGVzLmxlbmd0aCkge1xuICAgICAgc3R5bGUuaW5zZXJ0QmVmb3JlKGNzc05vZGUsIGNoaWxkTm9kZXNbaW5kZXhdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGFwcGx5VG9UYWcoc3R5bGUsIG9wdGlvbnMsIG9iaikge1xuICB2YXIgY3NzID0gb2JqLmNzcztcbiAgdmFyIG1lZGlhID0gb2JqLm1lZGlhO1xuICB2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcblxuICBpZiAobWVkaWEpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgbWVkaWEpO1xuICB9IGVsc2Uge1xuICAgIHN0eWxlLnJlbW92ZUF0dHJpYnV0ZSgnbWVkaWEnKTtcbiAgfVxuXG4gIGlmIChzb3VyY2VNYXAgJiYgYnRvYSkge1xuICAgIGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIuY29uY2F0KGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSksIFwiICovXCIpO1xuICB9IC8vIEZvciBvbGQgSUVcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cblxuICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcbiAgfSBlbHNlIHtcbiAgICB3aGlsZSAoc3R5bGUuZmlyc3RDaGlsZCkge1xuICAgICAgc3R5bGUucmVtb3ZlQ2hpbGQoc3R5bGUuZmlyc3RDaGlsZCk7XG4gICAgfVxuXG4gICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG4gIH1cbn1cblxudmFyIHNpbmdsZXRvbiA9IG51bGw7XG52YXIgc2luZ2xldG9uQ291bnRlciA9IDA7XG5cbmZ1bmN0aW9uIGFkZFN0eWxlKG9iaiwgb3B0aW9ucykge1xuICB2YXIgc3R5bGU7XG4gIHZhciB1cGRhdGU7XG4gIHZhciByZW1vdmU7XG5cbiAgaWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG4gICAgdmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XG4gICAgc3R5bGUgPSBzaW5nbGV0b24gfHwgKHNpbmdsZXRvbiA9IGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSk7XG4gICAgdXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlLCBzdHlsZUluZGV4LCBmYWxzZSk7XG4gICAgcmVtb3ZlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlLCBzdHlsZUluZGV4LCB0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICBzdHlsZSA9IGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKTtcbiAgICB1cGRhdGUgPSBhcHBseVRvVGFnLmJpbmQobnVsbCwgc3R5bGUsIG9wdGlvbnMpO1xuXG4gICAgcmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgcmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcbiAgICB9O1xuICB9XG5cbiAgdXBkYXRlKG9iaik7XG4gIHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcbiAgICBpZiAobmV3T2JqKSB7XG4gICAgICBpZiAobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlKG9iaiA9IG5ld09iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbW92ZSgpO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobGlzdCwgb3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsgLy8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XG4gIC8vIHRhZ3MgaXQgd2lsbCBhbGxvdyBvbiBhIHBhZ2VcblxuICBpZiAoIW9wdGlvbnMuc2luZ2xldG9uICYmIHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XG4gIH1cblxuICBsaXN0ID0gbGlzdCB8fCBbXTtcbiAgdmFyIGxhc3RJZGVudGlmaWVycyA9IG1vZHVsZXNUb0RvbShsaXN0LCBvcHRpb25zKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7XG4gICAgbmV3TGlzdCA9IG5ld0xpc3QgfHwgW107XG5cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG5ld0xpc3QpICE9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0SWRlbnRpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBpZGVudGlmaWVyID0gbGFzdElkZW50aWZpZXJzW2ldO1xuICAgICAgdmFyIGluZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgICBzdHlsZXNJbkRvbVtpbmRleF0ucmVmZXJlbmNlcy0tO1xuICAgIH1cblxuICAgIHZhciBuZXdMYXN0SWRlbnRpZmllcnMgPSBtb2R1bGVzVG9Eb20obmV3TGlzdCwgb3B0aW9ucyk7XG5cbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgbGFzdElkZW50aWZpZXJzLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIF9pZGVudGlmaWVyID0gbGFzdElkZW50aWZpZXJzW19pXTtcblxuICAgICAgdmFyIF9pbmRleCA9IGdldEluZGV4QnlJZGVudGlmaWVyKF9pZGVudGlmaWVyKTtcblxuICAgICAgaWYgKHN0eWxlc0luRG9tW19pbmRleF0ucmVmZXJlbmNlcyA9PT0gMCkge1xuICAgICAgICBzdHlsZXNJbkRvbVtfaW5kZXhdLnVwZGF0ZXIoKTtcblxuICAgICAgICBzdHlsZXNJbkRvbS5zcGxpY2UoX2luZGV4LCAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsYXN0SWRlbnRpZmllcnMgPSBuZXdMYXN0SWRlbnRpZmllcnM7XG4gIH07XG59OyIsImltcG9ydCBKV0VkaXRvciwgeyBKV0VkaXRvckNvbmZpZywgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IEh0bWwgfSBmcm9tICcuLi9wbHVnaW4taHRtbC9zcmMvSHRtbCc7XG5pbXBvcnQgeyBDaGFyIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWNoYXIvc3JjL0NoYXInO1xuaW1wb3J0IHsgTGluZUJyZWFrIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrJztcbmltcG9ydCB7IEhlYWRpbmcgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4taGVhZGluZy9zcmMvSGVhZGluZyc7XG5pbXBvcnQgeyBQYXJhZ3JhcGggfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tcGFyYWdyYXBoL3NyYy9QYXJhZ3JhcGgnO1xuaW1wb3J0IHsgTGlzdCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0JztcbmltcG9ydCB7IEluZGVudCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1pbmRlbnQvc3JjL0luZGVudCc7XG5pbXBvcnQgeyBQYXJhZ3JhcGhOb2RlIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoTm9kZSc7XG5pbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrTm9kZSc7XG5pbXBvcnQgeyBTcGFuIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLXNwYW4vc3JjL1NwYW4nO1xuaW1wb3J0IHsgQm9sZCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1ib2xkL3NyYy9Cb2xkJztcbmltcG9ydCB7IEl0YWxpYyB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1pdGFsaWMvc3JjL0l0YWxpYyc7XG5pbXBvcnQgeyBVbmRlcmxpbmUgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tdW5kZXJsaW5lL3NyYy9VbmRlcmxpbmUnO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExpbmsgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tbGluay9zcmMvTGluayc7XG5pbXBvcnQgeyBEaXZpZGVyIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWRpdmlkZXIvc3JjL0RpdmlkZXInO1xuaW1wb3J0IHsgSW1hZ2UgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlJztcbmltcG9ydCB7IFN1YnNjcmlwdCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1zdWJzY3JpcHQvc3JjL1N1YnNjcmlwdCc7XG5pbXBvcnQgeyBTdXBlcnNjcmlwdCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1zdXBlcnNjcmlwdC9zcmMvU3VwZXJzY3JpcHQnO1xuaW1wb3J0IHsgQmxvY2txdW90ZSB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1ibG9ja3F1b3RlL3NyYy9CbG9ja3F1b3RlJztcbmltcG9ydCB7IFlvdXR1YmUgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4teW91dHViZS9zcmMvWW91dHViZSc7XG5pbXBvcnQgeyBUYWJsZSB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9zcmMvVGFibGUnO1xuaW1wb3J0IHsgTWV0YWRhdGEgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgQWxpZ24gfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tYWxpZ24vc3JjL0FsaWduJztcbmltcG9ydCB7IFByZSB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZSc7XG5pbXBvcnQgeyBUZXh0Q29sb3IgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tdGV4dGNvbG9yL3NyYy9UZXh0Q29sb3InO1xuaW1wb3J0IHsgQmFja2dyb3VuZENvbG9yIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWJhY2tncm91bmRjb2xvci9zcmMvQmFja2dyb3VuZENvbG9yJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBEb21MYXlvdXQgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0JztcbmltcG9ydCB7IERvbUVkaXRhYmxlIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWRvbS1lZGl0YWJsZS9zcmMvRG9tRWRpdGFibGUnO1xuaW1wb3J0IHsgSGlzdG9yeSB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1oaXN0b3J5L3NyYy9IaXN0b3J5JztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWlucHV0L3NyYy9JbnB1dCc7XG5pbXBvcnQgeyBEaWFsb2cgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy9EaWFsb2cnO1xuaW1wb3J0IHsgRm9sbG93UmFuZ2UgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9zcmMvRm9sbG93UmFuZ2UnO1xuaW1wb3J0IHsgVG9vbGJhciB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi10b29sYmFyL3NyYy9Ub29sYmFyJztcbmltcG9ydCB7IFRleHRhcmVhIH0gZnJvbSAnLi4vcGx1Z2luLXRleHRhcmVhL3NyYy9UZXh0YXJlYSc7XG5cbmltcG9ydCB0ZW1wbGF0ZSBmcm9tICcuL2Jhc2ljTGF5b3V0LnhtbCc7XG5pbXBvcnQgJy4vYmFzaWNMYXlvdXQuY3NzJztcbmltcG9ydCB7IE9kb29GaWVsZCB9IGZyb20gJy4uLy4uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLWZpZWxkL3NyYy9PZG9vRmllbGQnO1xuaW1wb3J0IHsgcGFyc2VFZGl0YWJsZSwgY3JlYXRlRWRpdGFibGUgfSBmcm9tICcuLi8uLi9wYWNrYWdlcy91dGlscy9zcmMvY29uZmlndXJhdGlvbic7XG5pbXBvcnQgeyBGdWxsc2NyZWVuIH0gZnJvbSAnLi4vLi4vcGFja2FnZXMvcGx1Z2luLWZ1bGxzY3JlZW4vc3JjL0Z1bGxzY3JlZW4nO1xuaW1wb3J0IHsgQ29kZSB9IGZyb20gJy4uL3BsdWdpbi1jb2RlL3NyYy9Db2RlJztcbmltcG9ydCB7IEZvbnRTaXplIH0gZnJvbSAnLi4vcGx1Z2luLWZvbnQtc2l6ZS9zcmMvRm9udFNpemUnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vcGx1Z2luLWJ1dHRvbi9zcmMvQnV0dG9uJztcblxuZXhwb3J0IGNsYXNzIEJhc2ljRWRpdG9yIGV4dGVuZHMgSldFZGl0b3Ige1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcz86IHsgZWRpdGFibGU/OiBIVE1MRWxlbWVudCB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUoe1xuICAgICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgICAgICBDb250YWluZXI6IFBhcmFncmFwaE5vZGUsXG4gICAgICAgICAgICAgICAgU2VwYXJhdG9yOiBMaW5lQnJlYWtOb2RlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBsdWdpbnM6IFtcbiAgICAgICAgICAgICAgICBbUGFyc2VyXSxcbiAgICAgICAgICAgICAgICBbUmVuZGVyZXJdLFxuICAgICAgICAgICAgICAgIFtMYXlvdXRdLFxuICAgICAgICAgICAgICAgIFtLZXltYXBdLFxuICAgICAgICAgICAgICAgIFtEb21PYmplY3RSZW5kZXJlcl0sXG4gICAgICAgICAgICAgICAgW0h0bWxdLFxuICAgICAgICAgICAgICAgIFtEb21MYXlvdXRdLFxuICAgICAgICAgICAgICAgIFtEb21FZGl0YWJsZV0sXG4gICAgICAgICAgICAgICAgW0hpc3RvcnldLFxuICAgICAgICAgICAgICAgIFtJbmxpbmVdLFxuICAgICAgICAgICAgICAgIFtDaGFyXSxcbiAgICAgICAgICAgICAgICBbTGluZUJyZWFrXSxcbiAgICAgICAgICAgICAgICBbSGVhZGluZ10sXG4gICAgICAgICAgICAgICAgW1BhcmFncmFwaF0sXG4gICAgICAgICAgICAgICAgW1RleHRhcmVhXSxcbiAgICAgICAgICAgICAgICBbTGlzdF0sXG4gICAgICAgICAgICAgICAgW0luZGVudF0sXG4gICAgICAgICAgICAgICAgW0ZvbnRTaXplXSxcbiAgICAgICAgICAgICAgICBbU3Bhbl0sXG4gICAgICAgICAgICAgICAgW0JvbGRdLFxuICAgICAgICAgICAgICAgIFtJdGFsaWNdLFxuICAgICAgICAgICAgICAgIFtVbmRlcmxpbmVdLFxuICAgICAgICAgICAgICAgIFtMaW5rXSxcbiAgICAgICAgICAgICAgICBbRGl2aWRlcl0sXG4gICAgICAgICAgICAgICAgW0ltYWdlXSxcbiAgICAgICAgICAgICAgICBbU3Vic2NyaXB0XSxcbiAgICAgICAgICAgICAgICBbU3VwZXJzY3JpcHRdLFxuICAgICAgICAgICAgICAgIFtCbG9ja3F1b3RlXSxcbiAgICAgICAgICAgICAgICBbWW91dHViZV0sXG4gICAgICAgICAgICAgICAgW1RhYmxlXSxcbiAgICAgICAgICAgICAgICBbTWV0YWRhdGFdLFxuICAgICAgICAgICAgICAgIFtBbGlnbl0sXG4gICAgICAgICAgICAgICAgW1ByZV0sXG4gICAgICAgICAgICAgICAgW1RleHRDb2xvcl0sXG4gICAgICAgICAgICAgICAgW0JhY2tncm91bmRDb2xvcl0sXG4gICAgICAgICAgICAgICAgW0lucHV0XSxcbiAgICAgICAgICAgICAgICBbRGlhbG9nXSxcbiAgICAgICAgICAgICAgICBbRm9sbG93UmFuZ2VdLFxuICAgICAgICAgICAgICAgIFtGdWxsc2NyZWVuLCB7IGNvbXBvbmVudDogJ2VkaXRvcicgfV0sXG4gICAgICAgICAgICAgICAgW09kb29GaWVsZF0sXG4gICAgICAgICAgICAgICAgW0NvZGVdLFxuICAgICAgICAgICAgICAgIFtCdXR0b25dLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgY29uZmlnOiBKV0VkaXRvckNvbmZpZyAmIHsgbG9hZGFibGVzOiBMb2FkYWJsZXM8TGF5b3V0PiB9ID0ge1xuICAgICAgICAgICAgbG9hZGFibGVzOiB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2VkaXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXIoZWRpdG9yOiBKV0VkaXRvcik6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlZGl0b3IucGx1Z2lucy5nZXQoUGFyc2VyKS5wYXJzZSgndGV4dC9odG1sJywgdGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydlZGl0b3InLCBbJ3Jvb3QnXV1dLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoY29uZmlnKTtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoRG9tTGF5b3V0LCB7XG4gICAgICAgICAgICBsb2NhdGlvbjogcGFyYW1zPy5lZGl0YWJsZSA/IFtwYXJhbXMuZWRpdGFibGUsICdyZXBsYWNlJ10gOiBudWxsLFxuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdlZGl0YWJsZScsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcjogYXN5bmMgKGVkaXRvcjogSldFZGl0b3IpOiBQcm9taXNlPFZOb2RlW10+ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXM/LmVkaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRWRpdGFibGUoZWRpdG9yLCBwYXJhbXMuZWRpdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlRWRpdGFibGUoZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydlZGl0YWJsZScsIFsnbWFpbiddXV0sXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZShUb29sYmFyLCB7XG4gICAgICAgICAgICBsYXlvdXQ6IFtcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICdQYXJhZ3JhcGhCdXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ0hlYWRpbmcxQnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdIZWFkaW5nMkJ1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGVhZGluZzNCdXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ0hlYWRpbmc0QnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdIZWFkaW5nNUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGVhZGluZzZCdXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1ByZUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBbJ0ZvbnRTaXplSW5wdXQnXSxcbiAgICAgICAgICAgICAgICBbJ0JvbGRCdXR0b24nLCAnSXRhbGljQnV0dG9uJywgJ1VuZGVybGluZUJ1dHRvbicsICdSZW1vdmVGb3JtYXRCdXR0b24nXSxcbiAgICAgICAgICAgICAgICBbJ0FsaWduTGVmdEJ1dHRvbicsICdBbGlnbkNlbnRlckJ1dHRvbicsICdBbGlnblJpZ2h0QnV0dG9uJywgJ0FsaWduSnVzdGlmeUJ1dHRvbiddLFxuICAgICAgICAgICAgICAgIFsnT3JkZXJlZExpc3RCdXR0b24nLCAnVW5vcmRlcmVkTGlzdEJ1dHRvbicsICdDaGVja2xpc3RCdXR0b24nXSxcbiAgICAgICAgICAgICAgICBbJ0luZGVudEJ1dHRvbicsICdPdXRkZW50QnV0dG9uJ10sXG4gICAgICAgICAgICAgICAgWydMaW5rQnV0dG9uJywgJ1VubGlua0J1dHRvbiddLFxuICAgICAgICAgICAgICAgIFsnVGFibGVCdXR0b24nXSxcbiAgICAgICAgICAgICAgICBbJ0NvZGVCdXR0b24nXSxcbiAgICAgICAgICAgICAgICBbJ1VuZG9CdXR0b24nLCAnUmVkb0J1dHRvbiddLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwidmFyIGFwaSA9IHJlcXVpcmUoXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL2Jhc2ljTGF5b3V0LmNzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxudmFyIGV4cG9ydGVkID0gY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHt9O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRlZDsiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPGp3LWVkaXRvcj5cXG4gICAgPGp3LWhlYWRlcj48dCB0LXpvbmU9XFxcInRvb2xzXFxcIi8+PC9qdy1oZWFkZXI+XFxuICAgIDxqdy1ib2R5Pjx0IHQtem9uZT1cXFwibWFpblxcXCIvPjwvanctYm9keT5cXG4gICAgPGp3LWZvb3Rlcj5cXG4gICAgICAgIDx0IHQtem9uZT1cXFwic3RhdHVzXFxcIi8+XFxuICAgICAgICA8dCB0LXpvbmU9XFxcInJlc2l6ZXJcXFwiLz5cXG4gICAgPC9qdy1mb290ZXI+XFxuICAgIDx0LWRpYWxvZz5cXG4gICAgICAgIDx0IHQtem9uZT1cXFwiZGlhbG9nXFxcIi8+XFxuICAgICAgICA8dCB0LXpvbmU9XFxcImRlZmF1bHRcXFwiLz5cXG4gICAgPC90LWRpYWxvZz5cXG4gICAgPHQgdC16b25lPVxcXCJkZWJ1Z1xcXCIvPlxcbjwvanctZWRpdG9yPlxcblwiIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBIdG1sIH0gZnJvbSAnLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWwnO1xuaW1wb3J0IHsgQ2hhciB9IGZyb20gJy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IExpbmVCcmVhayB9IGZyb20gJy4uL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVhayc7XG5pbXBvcnQgeyBIZWFkaW5nIH0gZnJvbSAnLi4vcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmcnO1xuaW1wb3J0IHsgUGFyYWdyYXBoIH0gZnJvbSAnLi4vcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoJztcbmltcG9ydCB7IExpc3QgfSBmcm9tICcuLi9wbHVnaW4tbGlzdC9zcmMvTGlzdCc7XG5pbXBvcnQgeyBJbmRlbnQgfSBmcm9tICcuLi9wbHVnaW4taW5kZW50L3NyYy9JbmRlbnQnO1xuaW1wb3J0IHsgUGFyYWdyYXBoTm9kZSB9IGZyb20gJy4uL3BsdWdpbi1wYXJhZ3JhcGgvc3JjL1BhcmFncmFwaE5vZGUnO1xuaW1wb3J0IHsgTGluZUJyZWFrTm9kZSB9IGZyb20gJy4uL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha05vZGUnO1xuaW1wb3J0IHsgU3BhbiB9IGZyb20gJy4uL3BsdWdpbi1zcGFuL3NyYy9TcGFuJztcbmltcG9ydCB7IEJvbGQgfSBmcm9tICcuLi9wbHVnaW4tYm9sZC9zcmMvQm9sZCc7XG5pbXBvcnQgeyBJdGFsaWMgfSBmcm9tICcuLi9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWMnO1xuaW1wb3J0IHsgVW5kZXJsaW5lIH0gZnJvbSAnLi4vcGx1Z2luLXVuZGVybGluZS9zcmMvVW5kZXJsaW5lJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAnLi4vcGx1Z2luLWxpbmsvc3JjL0xpbmsnO1xuaW1wb3J0IHsgRGl2aWRlciB9IGZyb20gJy4uL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyJztcbmltcG9ydCB7IEltYWdlIH0gZnJvbSAnLi4vcGx1Z2luLWltYWdlL3NyYy9JbWFnZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHQgfSBmcm9tICcuLi9wbHVnaW4tc3Vic2NyaXB0L3NyYy9TdWJzY3JpcHQnO1xuaW1wb3J0IHsgU3VwZXJzY3JpcHQgfSBmcm9tICcuLi9wbHVnaW4tc3VwZXJzY3JpcHQvc3JjL1N1cGVyc2NyaXB0JztcbmltcG9ydCB7IEJsb2NrcXVvdGUgfSBmcm9tICcuLi9wbHVnaW4tYmxvY2txdW90ZS9zcmMvQmxvY2txdW90ZSc7XG5pbXBvcnQgeyBZb3V0dWJlIH0gZnJvbSAnLi4vcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmUnO1xuaW1wb3J0IHsgVGFibGUgfSBmcm9tICcuLi9wbHVnaW4tdGFibGUvc3JjL1RhYmxlJztcbmltcG9ydCB7IE1ldGFkYXRhIH0gZnJvbSAnLi4vcGx1Z2luLW1ldGFkYXRhL3NyYy9NZXRhZGF0YSc7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IEFsaWduIH0gZnJvbSAnLi4vcGx1Z2luLWFsaWduL3NyYy9BbGlnbic7XG5pbXBvcnQgeyBQcmUgfSBmcm9tICcuLi9wbHVnaW4tcHJlL3NyYy9QcmUnO1xuaW1wb3J0IHsgVGV4dENvbG9yIH0gZnJvbSAnLi4vcGx1Z2luLXRleHRjb2xvci9zcmMvVGV4dENvbG9yJztcbmltcG9ydCB7IEJhY2tncm91bmRDb2xvciB9IGZyb20gJy4uL3BsdWdpbi1iYWNrZ3JvdW5kY29sb3Ivc3JjL0JhY2tncm91bmRDb2xvcic7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgRG9tTGF5b3V0IH0gZnJvbSAnLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dCc7XG5pbXBvcnQgeyBEb21FZGl0YWJsZSB9IGZyb20gJy4uL3BsdWdpbi1kb20tZWRpdGFibGUvc3JjL0RvbUVkaXRhYmxlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFRvb2xiYXIsIFRvb2xiYXJMYXlvdXQgfSBmcm9tICcuLi9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhcic7XG5pbXBvcnQgeyBIdG1sTm9kZSB9IGZyb20gJy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sTm9kZSc7XG5pbXBvcnQgeyBDb21tYW5kSW1wbGVtZW50YXRpb24sIENvbW1hbmRJZGVudGlmaWVyIH0gZnJvbSAnLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBPZG9vVmlkZW8gfSBmcm9tICcuLi9wbHVnaW4tb2Rvby12aWRlby9zcmMvT2Rvb1ZpZGVvJztcbmltcG9ydCB7IERvbVpvbmVQb3NpdGlvbiB9IGZyb20gJy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBEb21IZWxwZXJzIH0gZnJvbSAnLi4vcGx1Z2luLWRvbS1oZWxwZXJzL3NyYy9Eb21IZWxwZXJzJztcbmltcG9ydCB7IE9kb28gfSBmcm9tICcuLi9wbHVnaW4tb2Rvby9zcmMvT2Rvbyc7XG5pbXBvcnQgeyBwYXJzZUVkaXRhYmxlIH0gZnJvbSAnLi4vdXRpbHMvc3JjL2NvbmZpZ3VyYXRpb24nO1xuaW1wb3J0IHsgRGlhbG9nIH0gZnJvbSAnLi4vcGx1Z2luLWRpYWxvZy9zcmMvRGlhbG9nJztcbmltcG9ydCB7IFNoYWRvdyB9IGZyb20gJy4uL3BsdWdpbi1zaGFkb3cvc3JjL1NoYWRvdyc7XG5pbXBvcnQgeyBGb250QXdlc29tZSB9IGZyb20gJy4uL3BsdWdpbi1mb250YXdlc29tZS9zcmMvRm9udEF3ZXNvbWUnO1xuaW1wb3J0IHsgTW9kZURlZmluaXRpb24gfSBmcm9tICcuLi9jb3JlL3NyYy9Nb2RlJztcbmltcG9ydCAnLi9vZG9vTGF5b3V0LmNzcyc7XG5pbXBvcnQgeyBUZXh0YXJlYSB9IGZyb20gJy4uL3BsdWdpbi10ZXh0YXJlYS9zcmMvVGV4dGFyZWEnO1xuaW1wb3J0IHsgRm9sbG93UmFuZ2UgfSBmcm9tICcuLi9wbHVnaW4tZG9tLWZvbGxvdy1yYW5nZS9zcmMvRm9sbG93UmFuZ2UnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICcuLi9wbHVnaW4taW5wdXQvc3JjL0lucHV0JztcbmltcG9ydCB7IEZvbnRTaXplIH0gZnJvbSAnLi4vcGx1Z2luLWZvbnQtc2l6ZS9zcmMvRm9udFNpemUnO1xuaW1wb3J0IHsgSGlzdG9yeSB9IGZyb20gJy4uL3BsdWdpbi1oaXN0b3J5L3NyYy9IaXN0b3J5JztcbmltcG9ydCB7IElmcmFtZSB9IGZyb20gJy4uL3BsdWdpbi1pZnJhbWUvc3JjL0lmcmFtZSc7XG5pbXBvcnQgeyBUaGVtZSB9IGZyb20gJy4uL3BsdWdpbi10aGVtZS9zcmMvVGhlbWUnO1xuaW1wb3J0IHsgVGhlbWVOb2RlIH0gZnJvbSAnLi4vcGx1Z2luLXRoZW1lL3NyYy9UaGVtZU5vZGUnO1xuaW1wb3J0IHsgRGV2aWNlUHJldmlldyB9IGZyb20gJy4uL3BsdWdpbi1kZXZpY2UtcHJldmlldy9zcmMvRGV2aWNlUHJldmlldyc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuLi9wbHVnaW4tYnV0dG9uL3NyYy9CdXR0b24nO1xuXG5pbnRlcmZhY2UgT2Rvb1dlYnNpdGVFZGl0b3JPcHRpb25zIHtcbiAgICBzb3VyY2U6IEhUTUxFbGVtZW50O1xuICAgIGxvY2F0aW9uOiBbTm9kZSwgRG9tWm9uZVBvc2l0aW9uXTtcbiAgICBjdXN0b21Db21tYW5kczogUmVjb3JkPENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSW1wbGVtZW50YXRpb24+O1xuICAgIGFmdGVyUmVuZGVyPzogRnVuY3Rpb247XG4gICAgc25pcHBldE1lbnVFbGVtZW50PzogSFRNTEVsZW1lbnQ7XG4gICAgc25pcHBldE1hbmlwdWxhdG9ycz86IEhUTUxFbGVtZW50O1xuICAgIHRlbXBsYXRlPzogc3RyaW5nO1xuICAgIHRvb2xiYXJMYXlvdXQ/OiBUb29sYmFyTGF5b3V0O1xuICAgIG1vZGU/OiBNb2RlRGVmaW5pdGlvbjtcbiAgICBwbHVnaW5zPzogW3R5cGVvZiBKV1BsdWdpbiwgSldQbHVnaW5Db25maWc/XVtdO1xufVxuXG5jb25zdCBkZWZhdWx0VG9vbGJhckxheW91dCA9IFtcbiAgICBbXG4gICAgICAgIFtcbiAgICAgICAgICAgICdQYXJhZ3JhcGhCdXR0b24nLFxuICAgICAgICAgICAgJ0hlYWRpbmcxQnV0dG9uJyxcbiAgICAgICAgICAgICdIZWFkaW5nMkJ1dHRvbicsXG4gICAgICAgICAgICAnSGVhZGluZzNCdXR0b24nLFxuICAgICAgICAgICAgJ0hlYWRpbmc0QnV0dG9uJyxcbiAgICAgICAgICAgICdIZWFkaW5nNUJ1dHRvbicsXG4gICAgICAgICAgICAnSGVhZGluZzZCdXR0b24nLFxuICAgICAgICAgICAgJ1ByZUJ1dHRvbicsXG4gICAgICAgIF0sXG4gICAgXSxcbiAgICBbJ0ZvbnRTaXplSW5wdXQnXSxcbiAgICBbXG4gICAgICAgICdCb2xkQnV0dG9uJyxcbiAgICAgICAgJ0l0YWxpY0J1dHRvbicsXG4gICAgICAgICdVbmRlcmxpbmVCdXR0b24nLFxuICAgICAgICAnT2Rvb1RleHRDb2xvckJ1dHRvbicsXG4gICAgICAgICdPZG9vQmFja2dyb3VuZENvbG9yQnV0dG9uJyxcbiAgICAgICAgJ1JlbW92ZUZvcm1hdEJ1dHRvbicsXG4gICAgXSxcbiAgICBbJ0FsaWduTGVmdEJ1dHRvbicsICdBbGlnbkNlbnRlckJ1dHRvbicsICdBbGlnblJpZ2h0QnV0dG9uJywgJ0FsaWduSnVzdGlmeUJ1dHRvbiddLFxuICAgIFsnT3JkZXJlZExpc3RCdXR0b24nLCAnVW5vcmRlcmVkTGlzdEJ1dHRvbicsICdDaGVja2xpc3RCdXR0b24nXSxcbiAgICBbJ0luZGVudEJ1dHRvbicsICdPdXRkZW50QnV0dG9uJ10sXG4gICAgWydPZG9vTGlua0J1dHRvbiddLFxuICAgIFsnT2Rvb01lZGlhQnV0dG9uJ10sXG5dO1xuZXhwb3J0IGNsYXNzIE9kb29XZWJzaXRlRWRpdG9yIGV4dGVuZHMgSldFZGl0b3Ige1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6IE9kb29XZWJzaXRlRWRpdG9yT3B0aW9ucykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBjbGFzcyBDdXN0b21QbHVnaW4gZXh0ZW5kcyBKV1BsdWdpbiB7XG4gICAgICAgICAgICBjb21tYW5kcyA9IE9iamVjdC5hc3NpZ24ob3B0aW9ucy5jdXN0b21Db21tYW5kcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSh7XG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIENvbnRhaW5lcjogUGFyYWdyYXBoTm9kZSxcbiAgICAgICAgICAgICAgICBTZXBhcmF0b3I6IExpbmVCcmVha05vZGUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGx1Z2luczogW1xuICAgICAgICAgICAgICAgIFtQYXJzZXJdLFxuICAgICAgICAgICAgICAgIFtSZW5kZXJlcl0sXG4gICAgICAgICAgICAgICAgW0xheW91dF0sXG4gICAgICAgICAgICAgICAgW0tleW1hcF0sXG4gICAgICAgICAgICAgICAgW0h0bWxdLFxuICAgICAgICAgICAgICAgIFtJbmxpbmVdLFxuICAgICAgICAgICAgICAgIFtDaGFyXSxcbiAgICAgICAgICAgICAgICBbTGluZUJyZWFrXSxcbiAgICAgICAgICAgICAgICBbSGVhZGluZ10sXG4gICAgICAgICAgICAgICAgW1BhcmFncmFwaF0sXG4gICAgICAgICAgICAgICAgW0xpc3RdLFxuICAgICAgICAgICAgICAgIFtUZXh0YXJlYV0sXG4gICAgICAgICAgICAgICAgW0luZGVudF0sXG4gICAgICAgICAgICAgICAgW1NwYW5dLFxuICAgICAgICAgICAgICAgIFtCb2xkXSxcbiAgICAgICAgICAgICAgICBbSXRhbGljXSxcbiAgICAgICAgICAgICAgICBbVW5kZXJsaW5lXSxcbiAgICAgICAgICAgICAgICBbSW5wdXRdLFxuICAgICAgICAgICAgICAgIFtGb250U2l6ZV0sXG4gICAgICAgICAgICAgICAgW0xpbmtdLFxuICAgICAgICAgICAgICAgIFtGb250QXdlc29tZV0sXG4gICAgICAgICAgICAgICAgW0RpdmlkZXJdLFxuICAgICAgICAgICAgICAgIFtJbWFnZV0sXG4gICAgICAgICAgICAgICAgW1N1YnNjcmlwdF0sXG4gICAgICAgICAgICAgICAgW1N1cGVyc2NyaXB0XSxcbiAgICAgICAgICAgICAgICBbQmxvY2txdW90ZV0sXG4gICAgICAgICAgICAgICAgW1lvdXR1YmVdLFxuICAgICAgICAgICAgICAgIFtUYWJsZV0sXG4gICAgICAgICAgICAgICAgW01ldGFkYXRhXSxcbiAgICAgICAgICAgICAgICBbQWxpZ25dLFxuICAgICAgICAgICAgICAgIFtQcmVdLFxuICAgICAgICAgICAgICAgIFtUZXh0Q29sb3JdLFxuICAgICAgICAgICAgICAgIFtCYWNrZ3JvdW5kQ29sb3JdLFxuICAgICAgICAgICAgICAgIFtEaWFsb2ddLFxuICAgICAgICAgICAgICAgIFtTaGFkb3ddLFxuICAgICAgICAgICAgICAgIFtEb21IZWxwZXJzXSxcbiAgICAgICAgICAgICAgICBbT2Rvb10sXG4gICAgICAgICAgICAgICAgW09kb29WaWRlb10sXG4gICAgICAgICAgICAgICAgW0N1c3RvbVBsdWdpbl0sXG4gICAgICAgICAgICAgICAgW0ZvbGxvd1JhbmdlXSxcbiAgICAgICAgICAgICAgICBbSGlzdG9yeV0sXG4gICAgICAgICAgICAgICAgW0lmcmFtZV0sXG4gICAgICAgICAgICAgICAgW0J1dHRvbl0sXG4gICAgICAgICAgICAgICAgLi4uKG9wdGlvbnMucGx1Z2lucyB8fCBbXSksXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoVG9vbGJhciwge1xuICAgICAgICAgICAgbGF5b3V0OiBbLi4uKG9wdGlvbnMudG9vbGJhckxheW91dCB8fCBkZWZhdWx0VG9vbGJhckxheW91dCldLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBkZWZhdWx0VGVtcGxhdGUgPSBgXG4gICAgICAgIDx0LWRpYWxvZz48dCB0LXpvbmU9XCJkZWZhdWx0XCIvPjwvdC1kaWFsb2c+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ3cmFwX2VkaXRvciBkLWZsZXggZmxleC1jb2x1bW5cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkLWZsZXggZmxleC1ncm93LTEgZmxleC1yb3cgb3ZlcmZsb3ctYXV0b1wiPlxuICAgICAgICAgICAgICAgIDx0IHQtem9uZT1cIm1haW5fc2lkZWJhclwiLz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZC1mbGV4IGZsZXgtY29sdW1uIG9fZWRpdG9yX2NlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwib190b29sYmFyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LXpvbmU9XCJ0b29sc1wiLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkLWZsZXggZmxleC1ncm93LTEgb3ZlcmZsb3ctYXV0b1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC16b25lPVwic25pcHBldE1hbmlwdWxhdG9yc1wiLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtem9uZT1cIm1haW5cIi8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib19kZWJ1Z196b25lXCI+XG4gICAgICAgICAgICAgICAgPHQgdC16b25lPVwiZGVidWdcIi8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYDtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoRG9tTGF5b3V0LCB7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDogJ21haW5fdGVtcGxhdGUnLFxuICAgICAgICAgICAgICAgICAgICByZW5kZXIoZWRpdG9yOiBKV0VkaXRvcik6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5wbHVnaW5zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChQYXJzZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhcnNlKCd0ZXh0L2h0bWwnLCBvcHRpb25zLnRlbXBsYXRlIHx8IGRlZmF1bHRUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnc25pcHBldF9tZW51JyxcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyKCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZTogVk5vZGUgPSBvcHRpb25zLnNuaXBwZXRNZW51RWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IEh0bWxOb2RlKHsgZG9tTm9kZTogKCk6IE5vZGUgPT4gb3B0aW9ucy5zbmlwcGV0TWVudUVsZW1lbnQgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG5ldyBMaW5lQnJlYWtOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtub2RlXSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnc25pcHBldE1hbmlwdWxhdG9ycycsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcigpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGU6IFZOb2RlID0gb3B0aW9ucy5zbmlwcGV0TWVudUVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG5ldyBIdG1sTm9kZSh7IGRvbU5vZGU6ICgpOiBOb2RlID0+IG9wdGlvbnMuc25pcHBldE1hbmlwdWxhdG9ycyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbmV3IExpbmVCcmVha05vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW25vZGVdKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdlZGl0YWJsZScsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcjogYXN5bmMgKGVkaXRvcjogSldFZGl0b3IpOiBQcm9taXNlPFZOb2RlW10+ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRoZW1lID0gbmV3IFRoZW1lTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudHMgPSBhd2FpdCBwYXJzZUVkaXRhYmxlKGVkaXRvciwgb3B0aW9ucy5zb3VyY2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWUuYXBwZW5kKC4uLmNvbnRlbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbdGhlbWVdO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtcbiAgICAgICAgICAgICAgICBbJ21haW5fdGVtcGxhdGUnLCBbJ3Jvb3QnXV0sXG4gICAgICAgICAgICAgICAgWydzbmlwcGV0X21lbnUnLCBbJ21haW5fc2lkZWJhciddXSxcbiAgICAgICAgICAgICAgICBbJ3NuaXBwZXRNYW5pcHVsYXRvcnMnLCBbJ3NuaXBwZXRNYW5pcHVsYXRvcnMnXV0sXG4gICAgICAgICAgICAgICAgWydlZGl0YWJsZScsIFsnbWFpbiddXSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBsb2NhdGlvbjogb3B0aW9ucy5sb2NhdGlvbixcbiAgICAgICAgICAgIHByZXNzZWRBY3Rpb25hYmxlc0NsYXNzTmFtZTogJ2FjdGl2ZScsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZShEb21FZGl0YWJsZSwge1xuICAgICAgICAgICAgYXV0b0ZvY3VzOiB0cnVlLFxuICAgICAgICAgICAgc291cmNlOiBvcHRpb25zLnNvdXJjZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29uZmlndXJlKFRhYmxlLCB7XG4gICAgICAgICAgICBpbmxpbmVVSTogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUoRGV2aWNlUHJldmlldywge1xuICAgICAgICAgICAgZ2V0VGhlbWUoZWRpdG9yOiBKV0VkaXRvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxheW91dCA9IGVkaXRvci5wbHVnaW5zLmdldChMYXlvdXQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbUxheW91dCA9IGxheW91dC5lbmdpbmVzLmRvbTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9tTGF5b3V0LmNvbXBvbmVudHMuZWRpdGFibGVbMF0gYXMgVGhlbWVOb2RlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMubW9kZSkge1xuICAgICAgICAgICAgdGhpcy5jb25maWd1cmUoe1xuICAgICAgICAgICAgICAgIG1vZGVzOiBbb3B0aW9ucy5tb2RlXSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jb25maWd1cmUoeyBtb2RlOiBvcHRpb25zLm1vZGUuaWQgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZhbHVlIGJ5IHJlbmRlcmluZyB0aGUgXCJlZGl0YWJsZVwiIGNvbXBvbmVudCBvZiB0aGUgZWRpdG9yLlxuICAgICAqL1xuICAgIGFzeW5jIGdldFZhbHVlKCk6IFByb21pc2U8Tm9kZT4ge1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IHRoaXMucGx1Z2lucy5nZXQoUmVuZGVyZXIpO1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLnBsdWdpbnMuZ2V0KExheW91dCk7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dCA9IGxheW91dC5lbmdpbmVzLmRvbTtcbiAgICAgICAgY29uc3QgZWRpdGFibGUgPSBkb21MYXlvdXQuY29tcG9uZW50cy5lZGl0YWJsZVswXTtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCByZW5kZXJlci5yZW5kZXI8Tm9kZVtdPignZG9tL2h0bWwnLCBlZGl0YWJsZSk7XG4gICAgICAgIHJldHVybiBub2RlcyAmJiBub2Rlc1swXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBCYXNpY0VkaXRvciB9IGZyb20gJy4uL2J1bmRsZS1iYXNpYy1lZGl0b3IvQmFzaWNFZGl0b3InO1xuaW1wb3J0IHsgRGV2VG9vbHMgfSBmcm9tICcuLi9wbHVnaW4tZGV2dG9vbHMvc3JjL0RldlRvb2xzJztcbmltcG9ydCB7IE9kb29XZWJzaXRlRWRpdG9yIH0gZnJvbSAnLi9PZG9vV2Vic2l0ZUVkaXRvcic7XG5pbXBvcnQgeyBWUmFuZ2UgfSBmcm9tICcuLi9jb3JlL3NyYy9WUmFuZ2UnO1xuaW1wb3J0IHsgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEltYWdlTm9kZSB9IGZyb20gJy4uL3BsdWdpbi1pbWFnZS9zcmMvSW1hZ2VOb2RlJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcbmltcG9ydCB7IExpbmtGb3JtYXQgfSBmcm9tICcuLi9wbHVnaW4tbGluay9zcmMvTGlua0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgRGl2aWRlck5vZGUgfSBmcm9tICcuLi9wbHVnaW4tZGl2aWRlci9zcmMvRGl2aWRlck5vZGUnO1xuaW1wb3J0IHsgT2Rvb1N0cnVjdHVyZU5vZGUgfSBmcm9tICcuLi9wbHVnaW4tb2Rvby9zcmMvT2Rvb1N0cnVjdHVyZU5vZGUnO1xuaW1wb3J0IHsgT2Rvb1RyYW5zbGF0aW9uRm9ybWF0IH0gZnJvbSAnLi4vcGx1Z2luLW9kb28vc3JjL09kb29UcmFuc2xhdGlvbkZvcm1hdCc7XG5pbXBvcnQgeyBJbmxpbmUgfSBmcm9tICcuLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgRG9tSGVscGVycyB9IGZyb20gJy4uL3BsdWdpbi1kb20taGVscGVycy9zcmMvRG9tSGVscGVycyc7XG5pbXBvcnQgeyBPZG9vRmllbGQgfSBmcm9tICcuLi9wbHVnaW4tb2Rvby1maWVsZC9zcmMvT2Rvb0ZpZWxkJztcbmltcG9ydCB7IE9kb29GaWVsZE5vZGUgfSBmcm9tICcuLi9wbHVnaW4tb2Rvby1maWVsZC9zcmMvT2Rvb0ZpZWxkTm9kZSc7XG5pbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCB7XG4gICAgT2Rvb1dlYnNpdGVFZGl0b3IsXG4gICAgQmFzaWNFZGl0b3IsXG4gICAgRGV2VG9vbHMsXG4gICAgTGF5b3V0LFxuICAgIERvbUxheW91dEVuZ2luZSxcbiAgICBSZW5kZXJlcixcbiAgICBJbWFnZU5vZGUsXG4gICAgVlJhbmdlLFxuICAgIElubGluZU5vZGUsXG4gICAgTGlua0Zvcm1hdCxcbiAgICBBdHRyaWJ1dGVzLFxuICAgIENvbnRhaW5lck5vZGUsXG4gICAgVkVsZW1lbnQsXG4gICAgRGl2aWRlck5vZGUsXG4gICAgT2Rvb1N0cnVjdHVyZU5vZGUsXG4gICAgT2Rvb0ZpZWxkLFxuICAgIE9kb29GaWVsZE5vZGUsXG4gICAgT2Rvb1RyYW5zbGF0aW9uRm9ybWF0LFxuICAgIElubGluZSxcbiAgICBEb21IZWxwZXJzLFxufTtcbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9vZG9vTGF5b3V0LmNzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxudmFyIGV4cG9ydGVkID0gY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHt9O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRlZDsiLCJpbXBvcnQgSldFZGl0b3IsIHsgQ29tbWFuZHMsIENvbW1hbmRQYXJhbXNUeXBlIH0gZnJvbSAnLi9KV0VkaXRvcic7XG5pbXBvcnQgeyBWUmFuZ2UgfSBmcm9tICcuL1ZSYW5nZSc7XG5pbXBvcnQgeyBQcmVkaWNhdGUsIFZOb2RlIH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgSldQbHVnaW4gfSBmcm9tICcuL0pXUGx1Z2luJztcblxuZXhwb3J0IGludGVyZmFjZSBDb250ZXh0IHtcbiAgICByYW5nZT86IFZSYW5nZTtcbiAgICBleGVjQ29tbWFuZDogPFAgZXh0ZW5kcyBKV1BsdWdpbiwgQyBleHRlbmRzIENvbW1hbmRzPFA+ID0gQ29tbWFuZHM8UD4+KFxuICAgICAgICBjb21tYW5kTmFtZTogQyB8ICgoKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCksXG4gICAgICAgIHBhcmFtcz86IENvbW1hbmRQYXJhbXNUeXBlPFAsIEM+LFxuICAgICkgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGVja2luZ0NvbnRleHQgZXh0ZW5kcyBDb250ZXh0IHtcbiAgICBzZWxlY3Rvcj86IFZOb2RlW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udGV4dHVhbCB7XG4gICAgY29udGV4dD86IENvbnRleHQ7XG4gICAgc2VsZWN0b3I/OiBQcmVkaWNhdGVbXTtcbiAgICAvLyBJZiB0aGUgc2VsZWN0b3IgbWF0Y2ggYW5kIGEgYGNoZWNrYCBjYWxsYmFjayBoYXMgYmVlbiBwcm92aWRlZCwgY2FsbFxuICAgIC8vIGl0IHdpdGggdGhlIGN1cnJlbnQgY29udGV4dCB0byBwZXJmb3JtIGFuIGFkZGl0aW9uYWwgY2hlY2tpbmcuXG4gICAgY2hlY2s/OiAoY29udGV4dDogQ2hlY2tpbmdDb250ZXh0KSA9PiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRleHR1YWxFbnRyeTxUPiBleHRlbmRzIENvbnRleHR1YWwge1xuICAgIHNlbGVjdG9yOiBQcmVkaWNhdGVbXTtcbiAgICB2YWx1ZTogVDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSYW5rZWRSZXN1bHQ8VD4ge1xuICAgIGx2bDFTY29yZTogbnVtYmVyO1xuICAgIGx2bDJTY29yZTogbnVtYmVyO1xuICAgIGluZGV4OiBudW1iZXI7XG4gICAgbWF0Y2hlZDogVk5vZGVbXTtcbiAgICBlbnRyeTogQ29udGV4dHVhbEVudHJ5PFQ+O1xufVxuXG4vKipcbiAqIENsYXNzIHRoYXQgcmFuayBhIGhpZXJhcmNoeSBvZiB2bm9kZSB0aHJvdWdoIGEgXCJzcGVjaWZpY2l0eVwiIGFsZ29yaXRobS5cbiAqXG4gKiBTcGVjaWZpY2l0eSBsZXZlbCBpcyBkZWZpbmVkIHdpdGg6XG4gKiAtIGBsdmwyYDogaWYgdGhlIGxhc3QgcHJlZGljYXRlIG9mIGFuIGl0ZW0gc2VsZWN0b3IgaXMgZGVlcGVyIGluIHRoZSB0cmVlXG4gKiAgIHRoYW4gdGhlIGxhc3QgcHJlZGljYXRlIG9mIGFub3RoZXIgaXRlbSBzZWxlY3RvcjsgdGhlIGZpcnN0IGl0ZW0gaGF2ZVxuICogICBtb3JlIHNwZWNpZmljaXR5XG4gKiAtIGBsdmwxYDogaWYgdHdvIG9yIG1vcmUgaXRlbXMgaGF2ZSB0aGUgc2FtZSBgbHZsMmAgc3BlY2lmaWNpdHk7IHRoZVxuICogICBjb21tYW5kIHdpdGggdGhlIGxvbmdlc3Qgc2VsZWN0b3Igd2lsbCBoYXZlIG1vcmUgc3BlY2lmaWNpdHlcbiAqIC0gYGx2bDBgOiBpZiB0aGUgaXRlbSBoYXMgbm8gc2VsZWN0b3IgKGFuIGVtcHR5IGxpc3QpLCB0aGVyZSBpcyBub1xuICogICBzcGVjaWZpY2l0eVxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0TWFuYWdlciB7XG4gICAgZWRpdG9yOiBKV0VkaXRvcjtcbiAgICBkZWZhdWx0Q29udGV4dDogQ29udGV4dDtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IsIGV4ZWNDb21tYW5kOiBDb250ZXh0WydleGVjQ29tbWFuZCddKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yO1xuICAgICAgICB0aGlzLmRlZmF1bHRDb250ZXh0ID0ge1xuICAgICAgICAgICAgcmFuZ2U6IHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5yYW5nZSxcbiAgICAgICAgICAgIGV4ZWNDb21tYW5kOiBleGVjQ29tbWFuZCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogVGVzdCBhbGwgY29udGV4dHVhbHMgYWdhaW5zdCBhIGhpZXJhcmNoeSBvZiBWTm9kZXMgYW5kIHJldHVybiB0aGUgcmVzdWx0XG4gICAgICogb3JkZXJlZCBieSBzcGVjaWZpY2l0eS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0UmFua2VkTWF0Y2hlczxUPihcbiAgICAgICAgaGllcmFyY2h5OiBWTm9kZVtdLFxuICAgICAgICBjb250ZXh0dWFsczogQ29udGV4dHVhbEVudHJ5PFQ+W10sXG4gICAgKTogUmFua2VkUmVzdWx0PFQ+W10ge1xuICAgICAgICBjb25zdCBtYXRjaGVzOiBSYW5rZWRSZXN1bHQ8VD5bXSA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBjb250ZXh0dWFscy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWwgPSBjb250ZXh0dWFsc1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IENvbnRleHRNYW5hZ2VyLl9tYXRjaE5vZGVzKGhpZXJhcmNoeSwgY29udGV4dHVhbC5zZWxlY3Rvcik7XG5cbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGx2bDFTY29yZTogbWF0Y2hbMV0ubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBsdmwyU2NvcmU6IG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkOiBtYXRjaFsxXSxcbiAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICBlbnRyeTogY29udGV4dHVhbCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNvcnQgdGhlIG1hdGNoZXM6XG4gICAgICAgIC8vIC0gZnJvbSBoaWdoZXN0IHRvIGxvd2VzdCBzY29yZVxuICAgICAgICAvLyAtIHdoZW4gdGhlIHNjb3JlIGlzIHRoZSBzYW1lLCBmcm9tIGhpZ2hlc3QgdG8gbG93ZXN0IGluZGV4XG4gICAgICAgIGNvbnN0IHJhbmtlZE1hdGNoID0gbWF0Y2hlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIGlmIChiLmx2bDJTY29yZSA9PT0gYS5sdmwyU2NvcmUgJiYgYi5sdmwxU2NvcmUgPT09IGEubHZsMVNjb3JlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIuaW5kZXggLSBhLmluZGV4O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChiLmx2bDJTY29yZSA9PT0gYS5sdmwyU2NvcmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYi5sdmwxU2NvcmUgLSBhLmx2bDFTY29yZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIubHZsMlNjb3JlIC0gYS5sdmwyU2NvcmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmFua2VkTWF0Y2g7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1hdGNoIGl0ZW1zIHNlbGVjdG9yIGRlcGVuZGluZyBvbiB0aGUgZWRpdG9yIGN1cnJlbnQgY29udGV4dCByYW5nZSBhbmRcbiAgICAgKiByZXR1cm4gdGhlIG1vc3Qgc3BlY2lmaWMgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtc1xuICAgICAqIEBwYXJhbSBwYXJhbXNDb250ZXh0XG4gICAgICovXG4gICAgbWF0Y2g8VCBleHRlbmRzIENvbnRleHR1YWw+KGl0ZW1zOiBUW10sIHBhcmFtc0NvbnRleHQ/OiBDb250ZXh0KTogW1QsIENvbnRleHRdIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHsgLi4udGhpcy5kZWZhdWx0Q29udGV4dCwgLi4ucGFyYW1zQ29udGV4dCB9O1xuICAgICAgICBjb25zdCBzdGFydCA9IGNvbnRleHQucmFuZ2Uuc3RhcnQ7XG4gICAgICAgIGNvbnN0IGhpZXJhcmNoeSA9IHN0YXJ0LmFuY2VzdG9ycygpO1xuICAgICAgICBjb25zdCBub2RlID0gc3RhcnQucHJldmlvdXNTaWJsaW5nKCkgfHwgc3RhcnQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgaWYgKG5vZGUpIHtcbiAgICAgICAgICAgIGhpZXJhcmNoeS51bnNoaWZ0KG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVudHJpZXM6IENvbnRleHR1YWxFbnRyeTxUPltdID0gaXRlbXMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgY29uc3QgZW50cnk6IENvbnRleHR1YWxFbnRyeTxUPiA9IHtcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogaXRlbS5zZWxlY3RvciB8fCBbXSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBDb250ZXh0TWFuYWdlci5nZXRSYW5rZWRNYXRjaGVzKGhpZXJhcmNoeSwgZW50cmllcyk7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gbWF0Y2hlcy5maW5kKG1hdGNoID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgIW1hdGNoLmVudHJ5LnZhbHVlLmNoZWNrIHx8XG4gICAgICAgICAgICAgICAgbWF0Y2guZW50cnkudmFsdWUuY2hlY2soeyAuLi5jb250ZXh0LCBzZWxlY3RvcjogbWF0Y2gubWF0Y2hlZCB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbbWF0Y2g/LmVudHJ5LnZhbHVlLCBjb250ZXh0XTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHdoZXRoZXIgYSBoaWVyYXJjaHkgb2YgYFZOb2RlYCBtYXRjaCB3aXRoIGBzZWxlY3RvcmAuXG4gICAgICpcbiAgICAgKiBUaGUgYGhpZXJhcmNoeWAgaXMgYW4gYXJyYXkgZnJvbSB0aGUgZGVlcGVzdCBub2RlIGluIGEgdHJlZSB0byB0aGVcbiAgICAgKiBzaGFsbG93ZXN0LlxuICAgICAqXG4gICAgICogUmV0dXJuIGEgdHVwbGUgd2l0aCB0aGUgZmlyc3QgdmFsdWUgYmVpbmcgbGV2ZWwgb2Ygc3BlY2lmaWNpdHkgbHZsMiBhbmRcbiAgICAgKiB0aGUgc2Vjb25kIHZhbHVlIGJlaW5nIHRoZSBWTm5vZGUgdGhhdCBtYXRjaGVkIHdpdGggYSBzZWxlY3RvclxuICAgICAqIChzcGVjaWZpY2l0eSBsdmwxKS5cbiAgICAgKi9cbiAgICBzdGF0aWMgX21hdGNoTm9kZXMoaGllcmFyY2h5OiBWTm9kZVtdLCBzZWxlY3RvcjogUHJlZGljYXRlW10pOiBbbnVtYmVyLCBWTm9kZVtdXSB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgY29uc3QgbWF4aW11bURlcHRoID0gaGllcmFyY2h5Lmxlbmd0aCAtIDE7XG4gICAgICAgIGxldCBmaXJzdE1hdGNoRGVwdGggPSAtMTtcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBwcmVkaWNhdGUgb2YgWy4uLnNlbGVjdG9yXS5yZXZlcnNlKCkpIHtcbiAgICAgICAgICAgIGxldCBtYXRjaEZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB3aGlsZSAoIW1hdGNoRm91bmQgJiYgaW5kZXggPCBoaWVyYXJjaHkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhpZXJhcmNoeVtpbmRleF0udGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVzLnVuc2hpZnQoaGllcmFyY2h5W2luZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdE1hdGNoRGVwdGggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWVwZXIgbWF0Y2ggaGFzIGhpZ2hlciBzcGVjaWZpY2l0eS4gU28gbG93ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluZGV4IGluIGFuY2VzdG9ycywgbWVhbnMgaGlnaGVyIHNwZWNpZmljaXR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RNYXRjaERlcHRoID0gbWF4aW11bURlcHRoIC0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFN0b3AgY2hlY2tpbmcgdGhlIHByZWRpY2F0ZXMgb2YgdGhpcyBwYXJ0aWN1bGFyIGNvbW1hbmRcbiAgICAgICAgICAgIC8vIHNpbmNlIGF0IGxlYXN0IG9uZSBvZiB0aGVtIGRvbid0IG1hdGNoIHRoZSBjb250ZXh0LlxuICAgICAgICAgICAgaWYgKCFtYXRjaEZvdW5kKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0Y2hlcy5sZW5ndGggPT09IHNlbGVjdG9yLmxlbmd0aCAmJiBbZmlyc3RNYXRjaERlcHRoLCBtYXRjaGVzXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuL0pXUGx1Z2luJztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuL0pXRWRpdG9yJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVlNlbGVjdGlvbkRlc2NyaXB0aW9uIH0gZnJvbSAnLi9WU2VsZWN0aW9uJztcbmltcG9ydCB7IFZOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgUnVsZVByb3BlcnR5IH0gZnJvbSAnLi9Nb2RlJztcbmltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuL1ZOb2Rlcy9BdG9taWNOb2RlJztcblxuZXhwb3J0IHR5cGUgSW5zZXJ0UGFyYWdyYXBoQnJlYWtQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuZXhwb3J0IHR5cGUgRGVsZXRlQmFja3dhcmRQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuZXhwb3J0IHR5cGUgRGVsZXRlRm9yd2FyZFBhcmFtcyA9IENvbW1hbmRQYXJhbXM7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5zZXJ0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgbm9kZTogVk5vZGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVlNlbGVjdGlvblBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIHZTZWxlY3Rpb246IFZTZWxlY3Rpb25EZXNjcmlwdGlvbjtcbn1cblxuZXhwb3J0IGNsYXNzIENvcmU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIGVkaXRvcjogSldFZGl0b3I7XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGluc2VydDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5pbnNlcnQsXG4gICAgICAgIH0sXG4gICAgICAgIGluc2VydFBhcmFncmFwaEJyZWFrOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluc2VydFBhcmFncmFwaEJyZWFrLFxuICAgICAgICB9LFxuICAgICAgICBzZXRTZWxlY3Rpb246IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuc2V0U2VsZWN0aW9uLFxuICAgICAgICB9LFxuICAgICAgICBkZWxldGVCYWNrd2FyZDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5kZWxldGVCYWNrd2FyZCxcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlRm9yd2FyZDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5kZWxldGVGb3J3YXJkLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgcGFyYWdyYXBoIGJyZWFrLlxuICAgICAqL1xuICAgIGluc2VydFBhcmFncmFwaEJyZWFrKHBhcmFtczogSW5zZXJ0UGFyYWdyYXBoQnJlYWtQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBjb250ZW50cyBvZiB0aGUgcmFuZ2UgaWYgbmVlZGVkLlxuICAgICAgICBpZiAoIXJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIHJhbmdlLmVtcHR5KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhbmdlLm1vZGUuaXMocmFuZ2Uuc3RhcnRDb250YWluZXIsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpKSB7XG4gICAgICAgICAgICByYW5nZS5zdGFydENvbnRhaW5lci5zcGxpdEF0KHJhbmdlLnN0YXJ0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFVzZSBhIHNlcGFyYXRvciB0byBicmVhayBwYXJhZ3JhcGhzIGluIGFuIHVuYnJlYWthYmxlLlxuICAgICAgICAgICAgY29uc3QgU2VwYXJhdG9yID0gdGhpcy5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5TZXBhcmF0b3I7XG4gICAgICAgICAgICByYW5nZS5zdGFydC5iZWZvcmUobmV3IFNlcGFyYXRvcigpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgYSBWTm9kZSBhdCB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGluc2VydChwYXJhbXM6IEluc2VydFBhcmFtcyk6IHZvaWQge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRlbnRzIG9mIHRoZSByYW5nZSBpZiBuZWVkZWQuXG4gICAgICAgIGlmICghcGFyYW1zLmNvbnRleHQucmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgcGFyYW1zLmNvbnRleHQucmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJhbXMuY29udGV4dC5yYW5nZS5zdGFydC5iZWZvcmUocGFyYW1zLm5vZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgaW4gdGhlIGJhY2t3YXJkIGRpcmVjdGlvbiAoYmFja3NwYWNlIGtleSBleHBlY3RlZCBiZWhhdmlvcikuXG4gICAgICovXG4gICAgZGVsZXRlQmFja3dhcmQocGFyYW1zOiBEZWxldGVGb3J3YXJkUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAvLyBCYXNpYyBjYXNlOiByZW1vdmUgdGhlIG5vZGUgZGlyZWN0bHkgcHJlY2VkaW5nIHRoZSByYW5nZS5cbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzU2libGluZyA9IHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgaWYgKHByZXZpb3VzU2libGluZyAmJiByYW5nZS5tb2RlLmlzKHByZXZpb3VzU2libGluZywgUnVsZVByb3BlcnR5LkVESVRBQkxFKSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZy5yZW1vdmVCYWNrd2FyZCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICByYW5nZS5tb2RlLmlzKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSAmJlxuICAgICAgICAgICAgICAgIHJhbmdlLm1vZGUuaXMocmFuZ2Uuc3RhcnRDb250YWluZXIsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBzZXQgcmFuZ2Ugc3RhcnQgYXQgcHJldmlvdXMgdmFsaWQgbGVhZi5cbiAgICAgICAgICAgICAgICBsZXQgYW5jZXN0b3I6IFZOb2RlID0gcmFuZ2Uuc3RhcnQucGFyZW50O1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSkgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkVESVRBQkxFKSAmJlxuICAgICAgICAgICAgICAgICAgICAhYW5jZXN0b3IucHJldmlvdXNTaWJsaW5nKClcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSkgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkVESVRBQkxFKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSBhbmNlc3Rvci5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzU2libGluZyBpbnN0YW5jZW9mIEF0b21pY05vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yLm1lcmdlV2l0aChwcmV2aW91c1NpYmxpbmcucGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzTGVhZiA9IHByZXZpb3VzU2libGluZy5sYXN0TGVhZigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzU2libGluZyAmJiAhcHJldmlvdXNTaWJsaW5nLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcHJldmlvdXMgc2libGluZyBpcyBlbXB0eSwgcmVtb3ZlIGl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZy5yZW1vdmVCYWNrd2FyZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2aW91c0xlYWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChwcmV2aW91c0xlYWYsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBpbiB0aGUgZm9yd2FyZCBkaXJlY3Rpb24gKGRlbGV0ZSBrZXkgZXhwZWN0ZWQgYmVoYXZpb3IpLlxuICAgICAqL1xuICAgIGRlbGV0ZUZvcndhcmQocGFyYW1zOiBEZWxldGVGb3J3YXJkUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAvLyBCYXNpYyBjYXNlOiByZW1vdmUgdGhlIG5vZGUgZGlyZWN0bHkgZm9sbG93aW5nIHRoZSByYW5nZS5cbiAgICAgICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gcmFuZ2UuZW5kLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBpZiAobmV4dFNpYmxpbmcgJiYgcmFuZ2UubW9kZS5pcyhuZXh0U2libGluZywgUnVsZVByb3BlcnR5LkVESVRBQkxFKSkge1xuICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nLnJlbW92ZUZvcndhcmQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhyYW5nZS5lbmRDb250YWluZXIsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpICYmXG4gICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhyYW5nZS5lbmRDb250YWluZXIsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBzZXQgcmFuZ2UgZW5kIGF0IG5leHQgdmFsaWQgbGVhZi5cbiAgICAgICAgICAgICAgICBsZXQgYW5jZXN0b3I6IFZOb2RlID0gcmFuZ2UuZW5kLnBhcmVudDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yICYmXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vZGUuaXMoYW5jZXN0b3IsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpICYmXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vZGUuaXMoYW5jZXN0b3IsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSkgJiZcbiAgICAgICAgICAgICAgICAgICAgIWFuY2VzdG9yLm5leHRTaWJsaW5nKClcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSkgJiZcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkVESVRBQkxFKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0U2libGluZyA9IGFuY2VzdG9yLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0U2libGluZyBpbnN0YW5jZW9mIEF0b21pY05vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXh0OiBWTm9kZSA9IG5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG5leHQgJiYgbmV4dCBpbnN0YW5jZW9mIEF0b21pY05vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3Rvci5hcHBlbmQobmV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGFuY2VzdG9yLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV4dFNpYmxpbmcuZmlyc3RMZWFmKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCAmJiAhcmFuZ2UuZW5kQ29udGFpbmVyLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBjb250YWluZXIgaXMgZW1wdHksIHJlbW92ZSBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5lbmRDb250YWluZXIucmVtb3ZlRm9yd2FyZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5leHQsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQobmV4dCwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKG5leHQsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBOYXZpZ2F0ZSB0byBhIGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHNldFNlbGVjdGlvbihwYXJhbXM6IFZTZWxlY3Rpb25QYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnNldChwYXJhbXMudlNlbGVjdGlvbik7XG4gICAgfVxufVxuIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4vSldFZGl0b3InO1xuaW1wb3J0IHsgQ29udGV4dCwgQ29udGV4dHVhbCB9IGZyb20gJy4vQ29udGV4dE1hbmFnZXInO1xuXG5leHBvcnQgdHlwZSBDb21tYW5kSWRlbnRpZmllciA9IHN0cmluZztcbmV4cG9ydCBpbnRlcmZhY2UgQ29tbWFuZEltcGxlbWVudGF0aW9uIGV4dGVuZHMgQ29udGV4dHVhbCB7XG4gICAgdGl0bGU/OiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgaGFuZGxlcjogQ29tbWFuZEhhbmRsZXI7XG59XG5leHBvcnQgaW50ZXJmYWNlIENvbW1hbmRQYXJhbXMge1xuICAgIGNvbnRleHQ/OiBDb250ZXh0O1xufVxuZXhwb3J0IHR5cGUgQ29tbWFuZEhhbmRsZXIgPSAoYXJncykgPT4gdm9pZDtcbmV4cG9ydCB0eXBlIENvbW1hbmRIb29rID0gKHBhcmFtczogQ29tbWFuZFBhcmFtcywgY29tbWFuZElkOiBzdHJpbmcpID0+IHZvaWQ7XG5cbmV4cG9ydCBjbGFzcyBEaXNwYXRjaGVyIHtcbiAgICBfX25leHRIYW5kbGVyVG9rZW5JRCA9IDA7XG4gICAgZWRpdG9yOiBKV0VkaXRvcjtcbiAgICBjb21tYW5kczogUmVjb3JkPENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSW1wbGVtZW50YXRpb25bXT4gPSB7fTtcbiAgICBjb21tYW5kSG9va3M6IFJlY29yZDxDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZEhvb2tbXT4gPSB7fTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENhbGwgYWxsIGhvb2tzIHJlZ2lzdHJlZCBmb3IgdGhlIGNvbW1hbmQgYGlkYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21tYW5kSWQgVGhlIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQuXG4gICAgICogQHBhcmFtIHBhcmFtcyBUaGUgcGFyYW1ldGVycyBvZiB0aGUgY29tbWFuZC5cbiAgICAgKi9cbiAgICBhc3luYyBkaXNwYXRjaChjb21tYW5kSWQ6IENvbW1hbmRJZGVudGlmaWVyLCBwYXJhbXM6IENvbW1hbmRQYXJhbXMgPSB7fSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb21tYW5kcyA9IHRoaXMuY29tbWFuZHNbY29tbWFuZElkXTtcbiAgICAgICAgaWYgKCFjb21tYW5kcykge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBDb21tYW5kICcke2NvbW1hbmRJZH0nIG5vdCBmb3VuZC5gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IFtjb21tYW5kLCBjb250ZXh0XSA9IHRoaXMuZWRpdG9yLmNvbnRleHRNYW5hZ2VyLm1hdGNoKGNvbW1hbmRzLCBwYXJhbXMuY29udGV4dCk7XG4gICAgICAgIGlmIChjb21tYW5kKSB7XG4gICAgICAgICAgICAvLyBVcGRhdGUgY29tbWFuZCBhcmd1bWVudHMgd2l0aCB0aGUgY29tcHV0ZWQgZXhlY3V0aW9uIGNvbnRleHQuXG4gICAgICAgICAgICBjb25zdCBhcmdzID0geyAuLi5wYXJhbXMsIGNvbnRleHQgfTtcblxuICAgICAgICAgICAgLy8gQ2FsbCBjb21tYW5kIGhhbmRsZXIuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21tYW5kLmhhbmRsZXIoYXJncyk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzcGF0Y2hIb29rcyhjb21tYW5kSWQsIGFyZ3MpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgYWxsIGhhbmRsZXJzIGRlY2xhcmVkIGluIGEgcGx1Z2luLCBhbmQgbWF0Y2ggdGhlbSB3aXRoIHRoZWlyXG4gICAgICogY29ycmVzcG9uZGluZyBjb21tYW5kLlxuICAgICAqXG4gICAgICovXG4gICAgcmVnaXN0ZXJDb21tYW5kKGlkOiBDb21tYW5kSWRlbnRpZmllciwgaW1wbDogQ29tbWFuZEltcGxlbWVudGF0aW9uKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5jb21tYW5kc1tpZF0pIHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZHNbaWRdID0gW2ltcGxdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kc1tpZF0ucHVzaChpbXBsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGEgY2FsbGJhY2sgdGhhdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGBleGVjQ29tbWFuZGAgY2FsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZCBUaGUgaWRlbnRpZmllciBvZiB0aGUgY29tbWFuZCB0byBob29rLlxuICAgICAqIEBwYXJhbSBob29rIFRoZSBjYWxsYmFjayB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQuXG4gICAgICovXG4gICAgcmVnaXN0ZXJDb21tYW5kSG9vayhpZDogQ29tbWFuZElkZW50aWZpZXIsIGhvb2s6IENvbW1hbmRIb29rKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5jb21tYW5kSG9va3NbaWRdKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRIb29rc1tpZF0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbW1hbmRIb29rc1tpZF0ucHVzaChob29rKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBjYWxsYmFjayB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgZm9yIGVhY2ggYGV4ZWNDb21tYW5kYCBjYWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlkIFRoZSBpZGVudGlmaWVyIG9mIHRoZSBjb21tYW5kIHRvIGhvb2suXG4gICAgICogQHBhcmFtIGhvb2sgVGhlIGNhbGxiYWNrIHRoYXQgd2lsbCBiZSByZW1vdmVkLlxuICAgICAqL1xuICAgIHJlbW92ZUNvbW1hbmRIb29rKGlkOiBDb21tYW5kSWRlbnRpZmllciwgaG9vazogQ29tbWFuZEhvb2spOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY29tbWFuZEhvb2tzW2lkXSkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNvbW1hbmRIb29rc1tpZF0uaW5kZXhPZihob29rKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRIb29rc1tpZF0uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3BhdGNoIHRvIGFsbCByZWdpc3RyZWQgYGNvbW1hbmRIb29rc2AuXG4gICAgICovXG4gICAgYXN5bmMgZGlzcGF0Y2hIb29rcyhzaWduYWw6IHN0cmluZywgYXJncz8pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgaG9va3MgPSB0aGlzLmNvbW1hbmRIb29rc1tzaWduYWxdIHx8IFtdO1xuICAgICAgICBjb25zdCBnbG9iYWxIb29rcyA9IHRoaXMuY29tbWFuZEhvb2tzWycqJ10gfHwgW107XG4gICAgICAgIGZvciAoY29uc3QgaG9va0NhbGxiYWNrIG9mIFsuLi5ob29rcywgLi4uZ2xvYmFsSG9va3NdKSB7XG4gICAgICAgICAgICBhd2FpdCBob29rQ2FsbGJhY2soYXJncywgc2lnbmFsKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi9Nb2RpZmllcic7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuL01vZGlmaWVycyc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBGb3JtYXQgZXh0ZW5kcyBNb2RpZmllciB7XG4gICAgaHRtbFRhZzogc3RyaW5nOyAvLyBUT0RPOiByZW1vdmUgdGhpcyByZWZlcmVuY2UgdG8gRE9NLlxuICAgIG1vZGlmaWVycyA9IG5ldyBNb2RpZmllcnMoKTtcbiAgICBjb25zdHJ1Y3RvcihodG1sVGFnPzogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaHRtbFRhZyA9IGh0bWxUYWc7XG4gICAgfVxuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmh0bWxUYWcudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgbm9uRW1wdHlBdHRyaWJ1dGVzID0gdGhpcy5tb2RpZmllcnMuZmlsdGVyKFxuICAgICAgICAgICAgbW9kaWZpZXIgPT4gIShtb2RpZmllciBpbnN0YW5jZW9mIEF0dHJpYnV0ZXMpIHx8ICEhbW9kaWZpZXIubGVuZ3RoLFxuICAgICAgICApO1xuICAgICAgICBpZiAobm9uRW1wdHlBdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbW9kaWZpZXJzUmVwciA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiBub25FbXB0eUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBtb2RpZmllcnNSZXByLnB1c2gobW9kaWZpZXIudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5uYW1lfVske21vZGlmaWVyc1JlcHIuam9pbignLCAnKX1dYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgY2xvbmUoKTogdGhpcyB7XG4gICAgICAgIGNvbnN0IGNsb25lID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICAgICAgY2xvbmUuaHRtbFRhZyA9IHRoaXMuaHRtbFRhZztcbiAgICAgICAgY2xvbmUubW9kaWZpZXJzID0gdGhpcy5tb2RpZmllcnMuY2xvbmUoKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbiAgICBpc1NhbWVBcyhvdGhlckZvcm1hdDogRm9ybWF0KTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGFNb2RpZmllcnMgPSB0aGlzLm1vZGlmaWVycztcbiAgICAgICAgY29uc3QgYk1vZGlmaWVycyA9IG90aGVyRm9ybWF0Py5tb2RpZmllcnM7XG4gICAgICAgIHJldHVybiBvdGhlckZvcm1hdCBpbnN0YW5jZW9mIHRoaXMuY29uc3RydWN0b3IgJiYgYU1vZGlmaWVycy5hcmVTYW1lQXMoYk1vZGlmaWVycyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRGlzcGF0Y2hlciwgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4vRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuL0pXUGx1Z2luJztcbmltcG9ydCB7IENvcmUgfSBmcm9tICcuL0NvcmUnO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIsIENvbnRleHQgfSBmcm9tICcuL0NvbnRleHRNYW5hZ2VyJztcbmltcG9ydCB7IFZTZWxlY3Rpb24gfSBmcm9tICcuL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgVlJhbmdlIH0gZnJvbSAnLi9WUmFuZ2UnO1xuaW1wb3J0IHsgaXNDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgU3RhZ2VFcnJvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9lcnJvcnMnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4vVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4vVk5vZGVzL0F0b21pY05vZGUnO1xuaW1wb3J0IHsgU2VwYXJhdG9yTm9kZSB9IGZyb20gJy4vVk5vZGVzL1NlcGFyYXRvck5vZGUnO1xuaW1wb3J0IHsgTW9kZUlkZW50aWZpZXIsIE1vZGVEZWZpbml0aW9uLCBNb2RlIH0gZnJvbSAnLi9Nb2RlJztcbmltcG9ydCB7IE1lbW9yeSwgQ2hhbmdlc0xvY2F0aW9ucyB9IGZyb20gJy4vTWVtb3J5L01lbW9yeSc7XG5pbXBvcnQgeyBtYWtlVmVyc2lvbmFibGUgfSBmcm9tICcuL01lbW9yeS9WZXJzaW9uYWJsZSc7XG5pbXBvcnQgeyBWZXJzaW9uYWJsZUFycmF5IH0gZnJvbSAnLi9NZW1vcnkvVmVyc2lvbmFibGVBcnJheSc7XG5pbXBvcnQgeyBQb2ludCB9IGZyb20gJy4vVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IGVudW0gRWRpdG9yU3RhZ2Uge1xuICAgIENPTkZJR1VSQVRJT04gPSAnY29uZmlndXJhdGlvbicsXG4gICAgU1RBUlRJTkcgPSAnc3RhcnRpbmcnLFxuICAgIEVESVRJT04gPSAnZWRpdGlvbicsXG59XG5cbmV4cG9ydCB0eXBlIExvYWRhYmxlID0ge307XG5leHBvcnQgdHlwZSBMb2FkZXI8TCBleHRlbmRzIExvYWRhYmxlID0gTG9hZGFibGU+ID0gKFxuICAgIGxvYWRhYmxlczogTFtdLFxuICAgIHNvdXJjZT86IEpXUGx1Z2luIHwge30sXG4pID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBMb2FkYWJsZXM8VCBleHRlbmRzIEpXUGx1Z2luID0gSldQbHVnaW4+ID0ge1xuICAgIFtrZXkgaW4ga2V5b2YgVFsnbG9hZGVycyddXT86IFBhcmFtZXRlcnM8VFsnbG9hZGVycyddW2tleV0+WzBdO1xufTtcblxuZXhwb3J0IHR5cGUgQ29tbWFuZHM8VCBleHRlbmRzIEpXUGx1Z2luPiA9IEV4dHJhY3Q8a2V5b2YgVFsnY29tbWFuZHMnXSwgc3RyaW5nPjtcbmV4cG9ydCB0eXBlIENvbW1hbmRQYXJhbXNUeXBlPFQgZXh0ZW5kcyBKV1BsdWdpbiwgSyBleHRlbmRzIHN0cmluZz4gPSBLIGV4dGVuZHMgQ29tbWFuZHM8VD5cbiAgICA/IFBhcmFtZXRlcnM8VFsnY29tbWFuZHMnXVtLXVsnaGFuZGxlciddPlswXVxuICAgIDogbmV2ZXI7XG5leHBvcnQgaW50ZXJmYWNlIENvbW1pdFBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGNoYW5nZXNMb2NhdGlvbnM6IENoYW5nZXNMb2NhdGlvbnM7XG4gICAgY29tbWFuZE5hbWVzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKV0VkaXRvckNvbmZpZyB7XG4gICAgLyoqXG4gICAgICogVGhlIG1vZGVzIHRoYXQgdGhlIGVkaXRvciB3aWxsIHN1cHBvcnQuXG4gICAgICogQHNlZSBjbGFzcyBgTW9kZWBcbiAgICAgKi9cbiAgICBtb2Rlcz86IE1vZGVEZWZpbml0aW9uW107XG4gICAgLyoqXG4gICAgICogVGhlIG1vZGUgd2l0aCB3aGljaCB0aGUgZWRpdG9yIGdldHMgc3RhcnRlZC5cbiAgICAgKiBAc2VlIGNsYXNzIGBNb2RlYFxuICAgICAqL1xuICAgIG1vZGU/OiBNb2RlSWRlbnRpZmllcjtcbiAgICBkZWZhdWx0cz86IHtcbiAgICAgICAgQ29udGFpbmVyPzogbmV3ICgpID0+IENvbnRhaW5lck5vZGU7XG4gICAgICAgIEF0b21pYz86IG5ldyAoKSA9PiBBdG9taWNOb2RlO1xuICAgICAgICBTZXBhcmF0b3I/OiBuZXcgKCkgPT4gU2VwYXJhdG9yTm9kZTtcbiAgICB9O1xuICAgIHBsdWdpbnM/OiBbdHlwZW9mIEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZz9dW107XG4gICAgbG9hZGFibGVzPzogTG9hZGFibGVzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBsdWdpbk1hcCBleHRlbmRzIE1hcDx0eXBlb2YgSldQbHVnaW4sIEpXUGx1Z2luPiB7XG4gICAgZ2V0PFQgZXh0ZW5kcyB0eXBlb2YgSldQbHVnaW4+KGNvbnN0cnVjdG9yOiBUKTogSW5zdGFuY2VUeXBlPFQ+O1xufVxuXG5leHBvcnQgY2xhc3MgSldFZGl0b3Ige1xuICAgIHByaXZhdGUgX3N0YWdlOiBFZGl0b3JTdGFnZSA9IEVkaXRvclN0YWdlLkNPTkZJR1VSQVRJT047XG4gICAgZGlzcGF0Y2hlcjogRGlzcGF0Y2hlcjtcbiAgICBjb250ZXh0TWFuYWdlcjogQ29udGV4dE1hbmFnZXI7XG4gICAgcGx1Z2luczogUGx1Z2luTWFwID0gbmV3IE1hcCgpO1xuICAgIGNvbmZpZ3VyYXRpb246IEpXRWRpdG9yQ29uZmlnID0ge1xuICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgQ29udGFpbmVyOiBDb250YWluZXJOb2RlLFxuICAgICAgICAgICAgQXRvbWljOiBBdG9taWNOb2RlLFxuICAgICAgICAgICAgU2VwYXJhdG9yOiBTZXBhcmF0b3JOb2RlLFxuICAgICAgICB9LFxuICAgICAgICBwbHVnaW5zOiBbXSxcbiAgICAgICAgbG9hZGFibGVzOiB7fSxcbiAgICB9O1xuICAgIG1lbW9yeTogTWVtb3J5O1xuICAgIG1lbW9yeUluZm86IHsgY29tbWFuZE5hbWVzOiBzdHJpbmdbXTsgdWlDb21tYW5kOiBib29sZWFuIH07XG4gICAgcHJpdmF0ZSBfbWVtb3J5SUQgPSAwO1xuICAgIHNlbGVjdGlvbjogVlNlbGVjdGlvbjtcbiAgICBsb2FkZXJzOiBSZWNvcmQ8c3RyaW5nLCBMb2FkZXI+ID0ge307XG4gICAgcHJpdmF0ZSBfbXV0ZXggPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAvLyBVc2UgYSBzZXQgc28gdGhhdCB3aGVuIGFzeW5jaHJvbm91cyBmdW5jdGlvbnMgYXJlIGNhbGxlZCB3ZSBlbnN1cmUgdGhhdFxuICAgIC8vIGVhY2ggY29tbWFuZCBiYXRjaCBpcyB3YWl0ZWQgZm9yLlxuICAgIHByZXZlbnRSZW5kZXJzOiBTZXQ8RnVuY3Rpb24+ID0gbmV3IFNldCgpO1xuICAgIGVuYWJsZVJlbmRlciA9IHRydWU7XG4gICAgbW9kZXM6IFJlY29yZDxNb2RlSWRlbnRpZmllciwgTW9kZT4gPSB7XG4gICAgICAgIGRlZmF1bHQ6IG5ldyBNb2RlKHtcbiAgICAgICAgICAgIGlkOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICBydWxlczogW10sXG4gICAgICAgIH0pLFxuICAgIH07XG4gICAgbW9kZTogTW9kZSA9IHRoaXMubW9kZXMuZGVmYXVsdDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih0aGlzKTtcbiAgICAgICAgdGhpcy5wbHVnaW5zID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IG5ldyBWU2VsZWN0aW9uKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRleHRNYW5hZ2VyID0gbmV3IENvbnRleHRNYW5hZ2VyKHRoaXMsIHRoaXMuX2V4ZWNTdWJDb21tYW5kLmJpbmQodGhpcykpO1xuXG4gICAgICAgIC8vIENvcmUgaXMgYSBzcGVjaWFsIG1hbmRhdG9yeSBwbHVnaW4gdGhhdCBoYW5kbGVzIHRoZSBtYXRjaGluZyBiZXR3ZWVuXG4gICAgICAgIC8vIHRoZSBjb21tYW5kcyBzdXBwb3J0ZWQgaW4gdGhlIGNvcmUgb2YgdGhlIGVkaXRvciBhbmQgdGhlIFZEb2N1bWVudC5cbiAgICAgICAgdGhpcy5sb2FkKENvcmUpO1xuICAgICAgICB0aGlzLmxvYWQoS2V5bWFwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGN1cnJlbnQgbW9kZSBvZiB0aGUgZWRpdG9yLlxuICAgICAqL1xuICAgIHNldE1vZGUobW9kZUlkZW50aWZpZXI6IE1vZGVJZGVudGlmaWVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMubW9kZSA9IHRoaXMubW9kZXNbbW9kZUlkZW50aWZpZXJdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHRoZSBlZGl0b3Igb24gdGhlIGVkaXRhYmxlIERPTSBub2RlIHNldCBvbiB0aGlzIGVkaXRvciBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5fc3RhZ2UgPSBFZGl0b3JTdGFnZS5TVEFSVElORztcbiAgICAgICAgdGhpcy5fbG9hZFBsdWdpbnMoKTtcblxuICAgICAgICAvLyBMb2FkIGVkaXRvci1sZXZlbCBsb2FkYWJsZXMuXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24ubG9hZGFibGVzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxvYWRhYmxlSWQgb2YgT2JqZWN0LmtleXModGhpcy5sb2FkZXJzKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRhYmxlID0gdGhpcy5jb25maWd1cmF0aW9uLmxvYWRhYmxlc1tsb2FkYWJsZUlkXTtcbiAgICAgICAgICAgICAgICBpZiAobG9hZGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzW2xvYWRhYmxlSWRdKGxvYWRhYmxlLCB0aGlzLmNvbmZpZ3VyYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgbW9kZSBvZiB0aGlzLmNvbmZpZ3VyYXRpb24ubW9kZXMgfHwgW10pIHtcbiAgICAgICAgICAgIHRoaXMubW9kZXNbbW9kZS5pZF0gPSBuZXcgTW9kZShtb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uLm1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TW9kZSh0aGlzLmNvbmZpZ3VyYXRpb24ubW9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjcmVhdGUgbWVtb3J5XG4gICAgICAgIHRoaXMubWVtb3J5SW5mbyA9IG1ha2VWZXJzaW9uYWJsZSh7IGNvbW1hbmROYW1lczogW10sIHVpQ29tbWFuZDogZmFsc2UgfSk7XG4gICAgICAgIHRoaXMubWVtb3J5ID0gbmV3IE1lbW9yeSgpO1xuICAgICAgICB0aGlzLm1lbW9yeS5hdHRhY2godGhpcy5tZW1vcnlJbmZvKTtcbiAgICAgICAgdGhpcy5tZW1vcnkuY3JlYXRlKHRoaXMuX21lbW9yeUlELnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIC8vIFN0YXJ0IGFsbCBwbHVnaW5zIGluIHRoZSBmaXJzdCBtZW1vcnkgc2xpY2UuXG4gICAgICAgIGF3YWl0IHRoaXMuZXhlY0NvbW1hbmQoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgdGhpcy5wbHVnaW5zLnZhbHVlcygpKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zdGFnZSA9IEVkaXRvclN0YWdlLkVESVRJT047XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIExvYWQgdGhlIGdpdmVuIHBsdWdpbiB3aXRoIGdpdmVuIGNvbmZpZ3VyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gUGx1Z2luXG4gICAgICogQHBhcmFtIGNvbmZpZ1xuICAgICAqL1xuICAgIGxvYWQobG9hZGFibGVzOiBMb2FkYWJsZXMpOiB2b2lkO1xuICAgIGxvYWQ8UCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oUGx1Z2luOiBQLCBjb25maWc/OiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8UD5bMV0pOiB2b2lkO1xuICAgIGxvYWQ8UCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oXG4gICAgICAgIFBsdWdpbk9yTG9hZGFibGVzOiBQIHwgTG9hZGFibGVzLFxuICAgICAgICBjb25maWc/OiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8UD5bMV0sXG4gICAgKTogdm9pZCB7XG4gICAgICAgIC8vIEFjdHVhbCBsb2FkaW5nIGlzIGRlZmVycmVkIHRvIGBzdGFydGAuXG4gICAgICAgIGlmICh0aGlzLl9zdGFnZSAhPT0gRWRpdG9yU3RhZ2UuQ09ORklHVVJBVElPTikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFN0YWdlRXJyb3IoRWRpdG9yU3RhZ2UuQ09ORklHVVJBVElPTik7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNDb25zdHJ1Y3RvcihQbHVnaW5PckxvYWRhYmxlcywgSldQbHVnaW4pKSB7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIHBsdWdpbiB0byB0aGUgY29uZmlndXJhdGlvbi5cbiAgICAgICAgICAgIGNvbnN0IFBsdWdpbiA9IFBsdWdpbk9yTG9hZGFibGVzO1xuICAgICAgICAgICAgY29uc3QgcGx1Z2lucyA9IHRoaXMuY29uZmlndXJhdGlvbi5wbHVnaW5zO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwbHVnaW5zLmZpbmRJbmRleCgoW3BdKSA9PiBwID09PSBQbHVnaW4pO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGlzIG1vZHVsZSBmcm9tIHRoZSBjb25maWcgdG8gYXZvaWQgbG9hZGluZyBpdCB0d2ljZS5cbiAgICAgICAgICAgICAgICBwbHVnaW5zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwbHVnaW5zLnB1c2goW1BsdWdpbiwgY29uZmlnIHx8IHt9XSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIGxvYWRhYmxlcyB0byB0aGUgY29uZmlndXJhdGlvbi5cbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZ3VyZWRMb2FkYWJsZXMgPSB0aGlzLmNvbmZpZ3VyYXRpb24ubG9hZGFibGVzO1xuICAgICAgICAgICAgZm9yIChjb25zdCBsb2FkYWJsZUlkZW50aWZpZXIgb2YgT2JqZWN0LmtleXMoUGx1Z2luT3JMb2FkYWJsZXMpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGFibGVzID0gUGx1Z2luT3JMb2FkYWJsZXNbbG9hZGFibGVJZGVudGlmaWVyXTtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJlZExvYWRhYmxlc1tsb2FkYWJsZUlkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyZWRMb2FkYWJsZXNbbG9hZGFibGVJZGVudGlmaWVyXS5wdXNoKC4uLmxvYWRhYmxlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJlZExvYWRhYmxlc1tsb2FkYWJsZUlkZW50aWZpZXJdID0gWy4uLmxvYWRhYmxlc107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCB0aGUgcGx1Z2lucyBzcGVjaWZpZWQgaW4gdGhlIGVkaXRvciBjb25maWd1cmF0aW9uLlxuICAgICAqXG4gICAgICovXG4gICAgcHJpdmF0ZSBfbG9hZFBsdWdpbnMoKTogdm9pZCB7XG4gICAgICAgIC8vIFJlc29sdmUgZGVwZW5kZW5jaWVzLlxuICAgICAgICBjb25zdCBQbHVnaW5zID0gWy4uLnRoaXMuY29uZmlndXJhdGlvbi5wbHVnaW5zXTtcbiAgICAgICAgZm9yIChsZXQgb2Zmc2V0ID0gMTsgb2Zmc2V0IDw9IFBsdWdpbnMubGVuZ3RoOyBvZmZzZXQrKykge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBQbHVnaW5zLmxlbmd0aCAtIG9mZnNldDtcbiAgICAgICAgICAgIGNvbnN0IFtQbHVnaW5dID0gUGx1Z2luc1tpbmRleF07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IERlcGVuZGVuY3kgb2YgWy4uLlBsdWdpbi5kZXBlbmRlbmNpZXNdLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlcEluZGV4ID0gUGx1Z2lucy5maW5kSW5kZXgoKFtQXSkgPT4gUCA9PT0gRGVwZW5kZW5jeSk7XG4gICAgICAgICAgICAgICAgaWYgKGRlcEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBtaXNzaW5nIGRlcGVuZGVuY3kgd2l0aCBubyBjb25maWcgcGFyYW1ldGVycy5cbiAgICAgICAgICAgICAgICAgICAgUGx1Z2lucy5zcGxpY2UoaW5kZXgsIDAsIFtEZXBlbmRlbmN5LCB7fV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwSW5kZXggPiBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBkZXBlbmRlbmN5IGJlZm9yZSB0aGUgcGx1Z2luIGRlcGVuZGluZyBvbiBpdC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW1tEZXAsIGNvbmZpZ11dID0gUGx1Z2lucy5zcGxpY2UoZGVwSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICBQbHVnaW5zLnNwbGljZShpbmRleCwgMCwgW0RlcCwgY29uZmlnXSk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvYWQgcGx1Z2lucy5cbiAgICAgICAgZm9yIChjb25zdCBbUGx1Z2luQ2xhc3MsIGNvbmZpZ3VyYXRpb25dIG9mIFBsdWdpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IG5ldyBQbHVnaW5DbGFzcyh0aGlzLCBjb25maWd1cmF0aW9uKTtcblxuICAgICAgICAgICAgdGhpcy5wbHVnaW5zLnNldChQbHVnaW5DbGFzcywgcGx1Z2luKTtcblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGNvbW1hbmRzIG9mIHRoaXMgcGx1Z2luLlxuICAgICAgICAgICAgT2JqZWN0LmtleXMocGx1Z2luLmNvbW1hbmRzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW1wbGVtZW50YXRpb24gPSB7IC4uLnBsdWdpbi5jb21tYW5kc1trZXldIH07XG4gICAgICAgICAgICAgICAgLy8gQmluZCBoYW5kbGVycyB0byB0aGUgcGx1Z2luIGl0c2VsZi4gVGhpcyBwcmVzZXJ2ZXMgdGhlXG4gICAgICAgICAgICAgICAgLy8gdHlwaW5nIG9mIHRoZSBoYW5kbGVyIHBhcmFtZXRlcnMgd2hpY2ggd291bGQgYmUgbG9zdCBpZlxuICAgICAgICAgICAgICAgIC8vIHRoZSBiaW5kaW5nIHdhcyBkb25lIGluIHRoZSBwbHVnaW4gZGVmaW5pdGlvbi5cbiAgICAgICAgICAgICAgICBpbXBsZW1lbnRhdGlvbi5oYW5kbGVyID0gaW1wbGVtZW50YXRpb24uaGFuZGxlci5iaW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZChrZXksIGltcGxlbWVudGF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGhvb2tzIG9mIHRoaXMgcGx1Z2luLlxuICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIGhvb2tdIG9mIE9iamVjdC5lbnRyaWVzKHBsdWdpbi5jb21tYW5kSG9va3MpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZEhvb2soaWQsIGhvb2suYmluZChwbHVnaW4pKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9hZCBsb2FkZXJzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBsb2FkYWJsZUlkIG9mIE9iamVjdC5rZXlzKHBsdWdpbi5sb2FkZXJzKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvYWRlcnNbbG9hZGFibGVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNdWx0aXBsZSBsb2FkZXJzIGZvciAnJHtsb2FkYWJsZUlkfScuYCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQmluZCBsb2FkZXJzIHRvIHRoZSBwbHVnaW4gaXRzZWxmLiBUaGlzIHByZXNlcnZlcyB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gdHlwaW5nIG9mIHRoZSBsb2FkZXIgcGFyYW1ldGVycyB3aGljaCB3b3VsZCBiZSBsb3N0IGlmXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBiaW5kaW5nIHdhcyBkb25lIGluIHRoZSBwbHVnaW4gZGVmaW5pdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGVyID0gcGx1Z2luLmxvYWRlcnNbbG9hZGFibGVJZF07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVyc1tsb2FkYWJsZUlkXSA9IGxvYWRlci5iaW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9hZCBsb2FkYWJsZXMuXG4gICAgICAgIGZvciAoY29uc3QgbG9hZGFibGVJZGVudGlmaWVyIG9mIE9iamVjdC5rZXlzKHRoaXMubG9hZGVycykpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIHRoaXMucGx1Z2lucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRhYmxlQXJyYXkgPSBwbHVnaW4ubG9hZGFibGVzW2xvYWRhYmxlSWRlbnRpZmllcl07XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRhYmxlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzW2xvYWRhYmxlSWRlbnRpZmllcl0obG9hZGFibGVBcnJheSwgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgdGhpcyBlZGl0b3IgaW5zdGFuY2Ugd2l0aCB0aGUgZ2l2ZW4gYGNvbmZpZ2Agb2JqZWN0LCBvclxuICAgICAqIGNvbmZpZ3VyZSB0aGUgZ2l2ZW4gcGx1Z2luIHdpdGggdGhlIGdpdmVuIGNvbmZpZ3VyYXRpb24gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGVkaXRvckNvbmZpZyB8IFBsdWdpblxuICAgICAqIEBwYXJhbSBbUGx1Z2luQ29uZmlnXVxuICAgICAqL1xuICAgIGNvbmZpZ3VyZShlZGl0b3JDb25maWc6IEpXRWRpdG9yQ29uZmlnKTogdm9pZDtcbiAgICBjb25maWd1cmU8VCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oXG4gICAgICAgIFBsdWdpbjogVCxcbiAgICAgICAgcGx1Z2luQ29uZmlnOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8VD5bMV0sXG4gICAgKTogdm9pZDtcbiAgICBjb25maWd1cmU8VCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oXG4gICAgICAgIFBsdWdpbk9yRWRpdG9yQ29uZmlnOiBKV0VkaXRvckNvbmZpZyB8IFQsXG4gICAgICAgIHBsdWdpbkNvbmZpZz86IENvbnN0cnVjdG9yUGFyYW1ldGVyczxUPlsxXSxcbiAgICApOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YWdlICE9PSBFZGl0b3JTdGFnZS5DT05GSUdVUkFUSU9OKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgU3RhZ2VFcnJvcihFZGl0b3JTdGFnZS5DT05GSUdVUkFUSU9OKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0NvbnN0cnVjdG9yKFBsdWdpbk9yRWRpdG9yQ29uZmlnLCBKV1BsdWdpbikpIHtcbiAgICAgICAgICAgIC8vIENvbmZpZ3VyZSB0aGUgcGx1Z2luLlxuICAgICAgICAgICAgY29uc3QgUGx1Z2luID0gUGx1Z2luT3JFZGl0b3JDb25maWc7XG4gICAgICAgICAgICBjb25zdCBjb25mID0gdGhpcy5jb25maWd1cmF0aW9uLnBsdWdpbnMuZmluZCgoW1BdKSA9PiBQID09PSBQbHVnaW4pO1xuICAgICAgICAgICAgaWYgKGNvbmYpIHtcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHByZXZpb3VzIGNvbmZpZyBpZiB0aGUgcGx1Z2luIHdhcyBhbHJlYWR5IGFkZGVkLlxuICAgICAgICAgICAgICAgIGNvbmZbMV0gPSB7IC4uLmNvbmZbMV0sIC4uLnBsdWdpbkNvbmZpZyB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5ldyBwbHVnaW4gY29uc3RydWN0b3IgYW5kIGhpcyBjb25maWd1cmF0aW9uLlxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdGlvbi5wbHVnaW5zLnB1c2goW1BsdWdpbiwgcGx1Z2luQ29uZmlnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBDb25maWd1cmUgdGhlIGVkaXRvci5cbiAgICAgICAgICAgIGNvbnN0IHByZWNvbmYgPSB0aGlzLmNvbmZpZ3VyYXRpb247XG4gICAgICAgICAgICBjb25zdCBjb25mID0gUGx1Z2luT3JFZGl0b3JDb25maWc7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSB7IC4uLnByZWNvbmYsIC4uLmNvbmYgfTtcbiAgICAgICAgICAgIC8vIE1lcmdlIHNwZWNpYWwgYGRlZmF1bHRzYCBjb25maWd1cmF0aW9uIGtleS5cbiAgICAgICAgICAgIGlmIChjb25mLmRlZmF1bHRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLmRlZmF1bHRzID0ge1xuICAgICAgICAgICAgICAgICAgICAuLi5wcmVjb25mLmRlZmF1bHRzLFxuICAgICAgICAgICAgICAgICAgICAuLi5jb25mLmRlZmF1bHRzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBIYW5kbGUgc3BlY2lhbCBgcGx1Z2luc2AgY29uZmlndXJhdGlvbiBrZXkgdGhyb3VnaCBgbG9hZGAuXG4gICAgICAgICAgICBpZiAoY29uZi5wbHVnaW5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLnBsdWdpbnMgPSBbLi4ucHJlY29uZi5wbHVnaW5zXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtQbHVnaW4sIHBsdWdpbkNvbmZpZ3VyYXRpb25dIG9mIGNvbmYucGx1Z2lucykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoUGx1Z2luLCBwbHVnaW5Db25maWd1cmF0aW9uIHx8IHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBIYW5kbGUgc3BlY2lhbCBgbG9hZGFibGVzYCBjb25maWd1cmF0aW9uIGtleSB0aHJvdWdoIGBsb2FkYC5cbiAgICAgICAgICAgIGlmIChjb25mLmxvYWRhYmxlcykge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdGlvbi5sb2FkYWJsZXMgPSB7IC4uLnByZWNvbmYubG9hZGFibGVzIH07XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkKGNvbmYubG9hZGFibGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgaW4gYGNhbGxiYWNrYCwgdGhlbiBkaXNwYXRjaCB0aGUgY29tbWl0IGV2ZW50LlxuICAgICAqIFRoZSBjYWxsYmFjayByZWNlaXZlcyBhbiBgZXhlY0NvbW1hbmRgIHBhcmFtZXRlciB3aGljaCBpdCBjYW4gdXNlIHRvXG4gICAgICogbWFrZSBmdXJ0aGVyIGNhbGxzIHRvIGBleGVjQ29tbWFuZGAgZnJvbSAqaW5zaWRlKiBpdHMgY3VycmVudCBjb21tYW5kLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICovXG4gICAgYXN5bmMgZXhlY0NvbW1hbmQoY2FsbGJhY2s6IChjb250ZXh0OiBDb250ZXh0KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCk6IFByb21pc2U8dm9pZD47XG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4gY29tbWFuZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZCBuYW1lIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZVxuICAgICAqIEBwYXJhbSBwYXJhbXMgYXJndW1lbnRzIG9iamVjdCBvZiB0aGUgY29tbWFuZCB0byBleGVjdXRlXG4gICAgICovXG4gICAgYXN5bmMgZXhlY0NvbW1hbmQ8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGNvbW1hbmROYW1lOiBDLFxuICAgICAgICBwYXJhbXM/OiBDb21tYW5kUGFyYW1zVHlwZTxQLCBDPixcbiAgICApOiBQcm9taXNlPHZvaWQ+O1xuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgdGhlIGNvbW1hbmQgb3IgYXJiaXRyYXJ5IGNvZGUgaW4gYGNhbGxiYWNrYCBpbiBtZW1vcnkuXG4gICAgICogVGhlIGNhbGwgdG8gZXhlY0NvbW1hbmQgYXJlIGV4ZWN1dGVkIGludG8gYSBtdXRleC4gRXZlcnkgcGx1Z2luIGNhblxuICAgICAqIGxhdW5jaCBzdWJjb21tYW5kcyB3aXRoIHRoZSAnSldQbHVnaW4uZXhlY0NvbW1hbmQnIG1ldGhvZCBpbnN0ZWFkLlxuICAgICAqXG4gICAgICogVE9ETzogY3JlYXRlIG1lbW9yeSBmb3IgZWFjaCBwbHVnaW4gd2hvIHVzZSB0aGUgY29tbWFuZCB0aGVuIHVzZVxuICAgICAqIHNxdWFzaEludG8od2lubmVyU2xpY2VLZXksIHdpbm5lclNsaWNlS2V5LCBuZXdNYXN0ZXJTbGljZUtleSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21tYW5kTmFtZSBuYW1lIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSBvciBjYWxsYmFja1xuICAgICAqIEBwYXJhbSBwYXJhbXMgYXJndW1lbnRzIG9iamVjdCBvZiB0aGUgY29tbWFuZCB0byBleGVjdXRlXG4gICAgICovXG4gICAgYXN5bmMgZXhlY0NvbW1hbmQ8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGNvbW1hbmROYW1lOiBDIHwgKChjb250ZXh0OiBDb250ZXh0KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCksXG4gICAgICAgIHBhcmFtcz86IENvbW1hbmRQYXJhbXNUeXBlPFAsIEM+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLl9tdXRleCA9IHRoaXMuX211dGV4LnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1lbW9yeS5pc0Zyb3plbigpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICAgICAgICAgICAgJ1lvdSBhcmUgdHJ5aW5nIHRvIGNhbGwgdGhlIGV4dGVybmFsIGVkaXRvcicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJyBleGVjQ29tbWFuZCBtZXRob2QgZnJvbSB3aXRoaW4gYW4gZXhlY0NvbW1hbmQuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1VzZSB0aGUgYGV4ZWNDb21tYW5kYCBtZXRob2Qgb2YgeW91ciBwbHVnaW4gaW5zdGVhZC4nLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgICAgICAgICAgJ0FuIGV4ZWNDb21tYW5kIGNhbGwgaXMgdGFraW5nIG1vcmUgdGhhbiAxMCBzZWNvbmRzIHRvIGZpbmlzaC4gSXQgbWlnaHQgYmUgY2F1c2VkIGJ5IGEgZGVhZGxvY2suXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnVmVyaWZ5IHRoYXQgeW91IGRvIG5vdCBjYWxsIGVkaXRvci5leGVjQ29tbWFuZCBpbnNpZGUgYW5vdGhlciBlZGl0b3IuZXhlY0NvbW1hbmQuJyxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSwgMTAwMDApO1xuXG4gICAgICAgICAgICAvLyBTd2l0Y2ggdG8gdGhlIG5leHQgbWVtb3J5IHNsaWNlICh1bmZyZWV6ZSB0aGUgbWVtb3J5KS5cbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbiA9IHRoaXMubWVtb3J5LnNsaWNlS2V5O1xuICAgICAgICAgICAgY29uc3QgbWVtb3J5U2xpY2UgPSB0aGlzLl9tZW1vcnlJRC50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5tZW1vcnkuc3dpdGNoVG8obWVtb3J5U2xpY2UpO1xuICAgICAgICAgICAgdGhpcy5tZW1vcnlJbmZvLmNvbW1hbmROYW1lcyA9IG5ldyBWZXJzaW9uYWJsZUFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLm1lbW9yeUluZm8udWlDb21tYW5kID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgY29tbWFuZE5hbWVzID0gdGhpcy5tZW1vcnlJbmZvLmNvbW1hbmROYW1lcztcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGNvbW1hbmQuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb21tYW5kTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gJ0BjdXN0b20nICsgKGNvbW1hbmROYW1lLm5hbWUgPyAnOicgKyBjb21tYW5kTmFtZS5uYW1lIDogJycpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeUluZm8uY29tbWFuZE5hbWVzLnB1c2gobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvbW1hbmROYW1lKHRoaXMuY29udGV4dE1hbmFnZXIuZGVmYXVsdENvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW1vcnkuc2xpY2VLZXkgIT09IG1lbW9yeVNsaWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPdmVycmlkZSBieSB0aGUgY3VycmVudCBjb21tYW5kTmFtZSBpZiB0aGUgc2xpY2UgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmROYW1lcyA9IFtuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5SW5mby5jb21tYW5kTmFtZXMucHVzaChjb21tYW5kTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzcGF0Y2hlci5kaXNwYXRjaChjb21tYW5kTmFtZSwgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWVtb3J5LnNsaWNlS2V5ICE9PSBtZW1vcnlTbGljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3ZlcnJpZGUgYnkgdGhlIGN1cnJlbnQgY29tbWFuZE5hbWUgaWYgdGhlIHNsaWNlIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZXMgPSBbY29tbWFuZE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gUHJlcGFyZSBuZXggc2xpY2UgYW5kIGZyZWV6ZSB0aGUgbWVtb3J5LlxuICAgICAgICAgICAgICAgIHRoaXMuX21lbW9yeUlEKys7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dE1lbW9yeVNsaWNlID0gdGhpcy5fbWVtb3J5SUQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeS5jcmVhdGUobmV4dE1lbW9yeVNsaWNlKTtcblxuICAgICAgICAgICAgICAgIC8vIFNlbmQgdGhlIGNvbW1pdCBtZXNzYWdlIHdpdGggYSBmcm96ZW4gbWVtb3J5LlxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZXNMb2NhdGlvbnMgPSB0aGlzLm1lbW9yeS5nZXRDaGFuZ2VzTG9jYXRpb25zKFxuICAgICAgICAgICAgICAgICAgICBtZW1vcnlTbGljZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vcnkuc2xpY2VLZXksXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRpc3BhdGNoZXIuZGlzcGF0Y2hIb29rcygnQGNvbW1pdCcsIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlc0xvY2F0aW9uczogY2hhbmdlc0xvY2F0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE5hbWVzOiBjb21tYW5kTmFtZXMsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YWdlICE9PSBFZGl0b3JTdGFnZS5FRElUSU9OKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmYWlsZWRTbGljZSA9IHRoaXMubWVtb3J5LnNsaWNlS2V5O1xuXG4gICAgICAgICAgICAgICAgLy8gV2hlbiBhbiBlcnJvciBvY2N1cnMsIHdlIGdvIGJhY2sgdG8gcGFydCBvZiB0aGUgZnVuY3Rpb25hbCBtZW1vcnkuXG4gICAgICAgICAgICAgICAgdGhpcy5tZW1vcnkuc3dpdGNoVG8ob3JpZ2luKTtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNlbmQgdGhlIGNvbW1pdCBtZXNzYWdlIHdpdGggYSBmcm96ZW4gbWVtb3J5LlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VzTG9jYXRpb25zID0gdGhpcy5tZW1vcnkuZ2V0Q2hhbmdlc0xvY2F0aW9ucyhmYWlsZWRTbGljZSwgb3JpZ2luKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kaXNwYXRjaGVyLmRpc3BhdGNoSG9va3MoJ0Bjb21taXQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzTG9jYXRpb25zOiBjaGFuZ2VzTG9jYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZE5hbWVzOiBjb21tYW5kTmFtZXMsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHJldmVydEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFnZSAhPT0gRWRpdG9yU3RhZ2UuRURJVElPTikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgcmV2ZXJ0RXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZXZlcnRFcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX211dGV4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBjb21tYW5kIG9uIGEgdGVtcG9yYXJ5IHJhbmdlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuXG4gICAgICogYm91bmRhcnkgcG9pbnRzLiBUaGUgcmFuZ2UgaXMgYXV0b21hdGljYWxseSBkZXN0cm95ZWQgYWZ0ZXJ3YXJkcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBib3VuZHMgVGhlIHBvaW50cyBjb3JyZXNwb25kaW5nIHRvIHRoZSByYW5nZSBib3VuZGFyaWVzLlxuICAgICAqIEBwYXJhbSBjb21tYW5kTmFtZSBuYW1lIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSBvciBjYWxsYmFja1xuICAgICAqIEBwYXJhbSBwYXJhbXMgYXJndW1lbnRzIG9iamVjdCBvZiB0aGUgY29tbWFuZCB0byBleGVjdXRlXG4gICAgICogQHBhcmFtIG1vZGVcbiAgICAgKi9cbiAgICBhc3luYyBleGVjV2l0aFJhbmdlPFAgZXh0ZW5kcyBKV1BsdWdpbiwgQyBleHRlbmRzIENvbW1hbmRzPFA+ID0gQ29tbWFuZHM8UD4+KFxuICAgICAgICBib3VuZHM6IFtQb2ludCwgUG9pbnRdLFxuICAgICAgICBjb21tYW5kTmFtZTogQyB8ICgoY29udGV4dDogQ29udGV4dCkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQpLFxuICAgICAgICBwYXJhbXM/OiBDb21tYW5kUGFyYW1zVHlwZTxQLCBDPixcbiAgICAgICAgbW9kZT86IE1vZGUsXG4gICAgKTogUHJvbWlzZTx2b2lkPjtcbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGEgY29tbWFuZCBvbiBhIHRlbXBvcmFyeSByYW5nZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlblxuICAgICAqIGJvdW5kYXJ5IHBvaW50cy4gVGhlIHJhbmdlIGlzIGF1dG9tYXRpY2FsbHkgZGVzdHJveWVkIGFmdGVyd2FyZHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYm91bmRzIFRoZSBwb2ludHMgY29ycmVzcG9uZGluZyB0byB0aGUgcmFuZ2UgYm91bmRhcmllcy5cbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIGNhbGwgd2l0aCB0aGUgbmV3bHkgY3JlYXRlZCByYW5nZS5cbiAgICAgKiBAcGFyYW0gbW9kZVxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWNXaXRoUmFuZ2U8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGJvdW5kczogW1BvaW50LCBQb2ludF0sXG4gICAgICAgIGNhbGxiYWNrOiAoY29udGV4dDogQ29udGV4dCkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQsXG4gICAgICAgIG1vZGU/OiBNb2RlLFxuICAgICk6IFByb21pc2U8dm9pZD47XG4gICAgYXN5bmMgZXhlY1dpdGhSYW5nZTxQIGV4dGVuZHMgSldQbHVnaW4sIEMgZXh0ZW5kcyBDb21tYW5kczxQPiA9IENvbW1hbmRzPFA+PihcbiAgICAgICAgYm91bmRzOiBbUG9pbnQsIFBvaW50XSxcbiAgICAgICAgY29tbWFuZE5hbWU6IEMgfCAoKGNvbnRleHQ6IENvbnRleHQpID0+IFByb21pc2U8dm9pZD4gfCB2b2lkKSxcbiAgICAgICAgcGFyYW1zPzogQ29tbWFuZFBhcmFtc1R5cGU8UCwgQz4gfCBNb2RlLFxuICAgICAgICBtb2RlPzogTW9kZSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgICB0aGlzLm1lbW9yeUluZm8uY29tbWFuZE5hbWVzLnB1c2goJ0B3aXRoUmFuZ2UnKTtcbiAgICAgICAgICAgIGxldCByYW5nZTogVlJhbmdlO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb21tYW5kTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gbmV3IFZSYW5nZSh0aGlzLCBib3VuZHMsIHBhcmFtcyBhcyBNb2RlKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeUluZm8uY29tbWFuZE5hbWVzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICdAY3VzdG9tJyArIChjb21tYW5kTmFtZS5uYW1lID8gJzonICsgY29tbWFuZE5hbWUubmFtZSA6ICcnKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGF3YWl0IGNvbW1hbmROYW1lKHsgLi4udGhpcy5jb250ZXh0TWFuYWdlci5kZWZhdWx0Q29udGV4dCwgcmFuZ2UgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gbmV3IFZSYW5nZSh0aGlzLCBib3VuZHMsIG1vZGUpO1xuICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5SW5mby5jb21tYW5kTmFtZXMucHVzaChjb21tYW5kTmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UGFyYW0gPSBPYmplY3QuYXNzaWduKHsgY29udGV4dDoge30gfSwgcGFyYW1zIGFzIENvbW1hbmRQYXJhbXNUeXBlPFAsIEM+KTtcbiAgICAgICAgICAgICAgICBuZXdQYXJhbS5jb250ZXh0LnJhbmdlID0gcmFuZ2U7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kaXNwYXRjaGVyLmRpc3BhdGNoKGNvbW1hbmROYW1lLCBuZXdQYXJhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByYW5nZS5yZW1vdmUoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGhpcy5tZW1vcnkuaXNGcm96ZW4oKSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjQ29tbWFuZChjYWxsYmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCB0aGlzIGVkaXRvciBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5tZW1vcnkpIHtcbiAgICAgICAgICAgIHRoaXMubWVtb3J5LmNyZWF0ZSgnc3RvcCcpO1xuICAgICAgICAgICAgdGhpcy5tZW1vcnkuc3dpdGNoVG8oJ3N0b3AnKTsgLy8gVW5mcmVlemUgdGhlIG1lbW9yeS5cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiB0aGlzLnBsdWdpbnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWVtb3J5KSB7XG4gICAgICAgICAgICB0aGlzLm1lbW9yeS5jcmVhdGUoJ3N0b3BwZWQnKTsgLy8gRnJlZXplIHRoZSBtZW1vcnkuXG4gICAgICAgICAgICB0aGlzLm1lbW9yeSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wbHVnaW5zLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IG5ldyBWU2VsZWN0aW9uKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRleHRNYW5hZ2VyID0gbmV3IENvbnRleHRNYW5hZ2VyKHRoaXMsIHRoaXMuX2V4ZWNTdWJDb21tYW5kKTtcbiAgICAgICAgLy8gQ2xlYXIgbG9hZGVycy5cbiAgICAgICAgdGhpcy5sb2FkZXJzID0ge307XG4gICAgICAgIHRoaXMuX3N0YWdlID0gRWRpdG9yU3RhZ2UuQ09ORklHVVJBVElPTjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIHRoZSBjb21tYW5kIG9yIGFyYml0cmFyeSBjb2RlIGluIGBjYWxsYmFja2AgaW4gbWVtb3J5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbW1hbmROYW1lIG5hbWUgaWRlbnRpZmllciBvZiB0aGUgY29tbWFuZCB0byBleGVjdXRlIG9yIGNhbGxiYWNrXG4gICAgICogQHBhcmFtIHBhcmFtcyBhcmd1bWVudHMgb2JqZWN0IG9mIHRoZSBjb21tYW5kIHRvIGV4ZWN1dGVcbiAgICAgKi9cbiAgICBhc3luYyBfZXhlY1N1YkNvbW1hbmQ8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGNvbW1hbmROYW1lOiBDIHwgKChjb250ZXh0OiBDb250ZXh0KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCksXG4gICAgICAgIHBhcmFtcz86IENvbW1hbmRQYXJhbXNUeXBlPFAsIEM+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodHlwZW9mIGNvbW1hbmROYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLm1lbW9yeUluZm8uY29tbWFuZE5hbWVzLnB1c2goXG4gICAgICAgICAgICAgICAgJ0BjdXN0b20nICsgKGNvbW1hbmROYW1lLm5hbWUgPyAnOicgKyBjb21tYW5kTmFtZS5uYW1lIDogJycpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbW1hbmROYW1lKHRoaXMuY29udGV4dE1hbmFnZXIuZGVmYXVsdENvbnRleHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tZW1vcnlJbmZvLmNvbW1hbmROYW1lcy5wdXNoKGNvbW1hbmROYW1lKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzcGF0Y2hlci5kaXNwYXRjaChjb21tYW5kTmFtZSwgcGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgSldFZGl0b3I7XG4iLCJpbXBvcnQgeyBKV0VkaXRvciwgTG9hZGVyLCBQbHVnaW5NYXAsIExvYWRhYmxlcyB9IGZyb20gJy4vSldFZGl0b3InO1xuaW1wb3J0IHsgQ29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRJbXBsZW1lbnRhdGlvbiwgQ29tbWFuZEhvb2sgfSBmcm9tICcuL0Rpc3BhdGNoZXInO1xuXG5leHBvcnQgdHlwZSBKV1BsdWdpbkNvbmZpZyA9IHt9O1xuXG5leHBvcnQgY2xhc3MgSldQbHVnaW48VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0ge30+IHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVwZW5kZW5jaWVzOiBBcnJheTx0eXBlb2YgSldQbHVnaW4+ID0gW107XG4gICAgcmVhZG9ubHkgZGVwZW5kZW5jaWVzOiBQbHVnaW5NYXAgPSBuZXcgTWFwKCk7XG4gICAgcmVhZG9ubHkgbG9hZGVyczogUmVjb3JkPHN0cmluZywgTG9hZGVyPiA9IHt9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzID0ge307XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvbW1hbmRzOiBSZWNvcmQ8Q29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRJbXBsZW1lbnRhdGlvbj4gPSB7fTtcbiAgICBjb21tYW5kSG9va3M6IFJlY29yZDxDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZEhvb2s+ID0ge307XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZWRpdG9yOiBKV0VkaXRvciwgcHVibGljIGNvbmZpZ3VyYXRpb246IFBhcnRpYWw8VD4gPSB7fSkge1xuICAgICAgICAvLyBQb3B1bGF0ZSBpbnN0YW50aWF0ZWQgZGVwZW5kZW5jaWVzLlxuICAgICAgICBmb3IgKGNvbnN0IERlcGVuZGVuY3kgb2YgdGhpcy5jb25zdHJ1Y3Rvci5kZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzLnNldChEZXBlbmRlbmN5LCBlZGl0b3IucGx1Z2lucy5nZXQoRGVwZW5kZW5jeSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgdGhlIHBsdWdpbi4gQ2FsbGVkIHdoZW4gdGhlIGVkaXRvciBzdGFydHMuXG4gICAgICovXG4gICAgYXN5bmMgc3RhcnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIFRoaXMgaXMgd2hlcmUgcGx1Z2lucyBjYW4gZG8gYXN5bmNocm9ub3VzIHdvcmsgd2hlbiB0aGUgZWRpdG9yIGlzXG4gICAgICAgIC8vIHN0YXJ0aW5nIChlLmcuIHJldHJpZXZlIGRhdGEgZnJvbSBhIHNlcnZlciwgcmVuZGVyIHN0dWZmLCBldGMpLlxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3AgdGhlIHBsdWdpbi4gQ2FsbGVkIHdoZW4gdGhlIGVkaXRvciBzdG9wcy5cbiAgICAgKi9cbiAgICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBUaGlzIGlzIHdoZXJlIHBsdWdpbnMgY2FuIGRvIGFzeW5jaHJvbm91cyB3b3JrIHdoZW4gdGhlIGVkaXRvciBpc1xuICAgICAgICAvLyBzdG9wcGluZyAoZS5nLiBzYXZlIG9uIGEgc2VydmVyLCBjbG9zZSBjb25uZWN0aW9ucywgZXRjKS5cbiAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBudWxsO1xuICAgIH1cbn1cbmV4cG9ydCBpbnRlcmZhY2UgSldQbHVnaW4ge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgIG5ldyAoLi4uYXJnczogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBKV1BsdWdpbj4pOiBKV1BsdWdpbjtcbiAgICAgICAgZGVwZW5kZW5jaWVzOiBBcnJheTx0eXBlb2YgSldQbHVnaW4+O1xuICAgIH07XG59XG4iLCJpbXBvcnQgeyBWZXJzaW9uYWJsZUlELCBWZXJzaW9uYWJsZVBhcmFtcyB9IGZyb20gJy4vVmVyc2lvbmFibGUnO1xuaW1wb3J0IHsgQXJyYXlQYXJhbXMgfSBmcm9tICcuL1ZlcnNpb25hYmxlQXJyYXknO1xuaW1wb3J0IHtcbiAgICByZW1vdmVkSXRlbSxcbiAgICBtZW1vcnlQcm94eVByYW1zS2V5LFxuICAgIE5vdFZlcnNpb25hYmxlRXJyb3IsXG4gICAgVmVyc2lvbmFibGVBbGxyZWFkeVZlcnNpb25hYmxlRXJyb3IsXG4gICAgTWVtb3J5RXJyb3IsXG4gICAgRnJvemVuRXJyb3IsXG59IGZyb20gJy4vY29uc3QnO1xuXG50eXBlIFNsaWNlS2V5ID0gc3RyaW5nO1xudHlwZSBWZXJzaW9uYWJsZU1lbW9yeUlEID0gbnVtYmVyO1xuZXhwb3J0IHR5cGUgTWVtb3J5QWxsb3dlZFR5cGUgPSBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMgfCBNZW1vcnlBbGxvd2VkT2JqZWN0VHlwZTtcbmV4cG9ydCB0eXBlIE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlID0gTG9vcE9iamVjdCB8IExvb3BBcnJheSB8IExvb3BTZXQgfCBvYmplY3Q7XG5pbnRlcmZhY2UgTG9vcE9iamVjdCB7XG4gICAgW3g6IHN0cmluZ106IE1lbW9yeUFsbG93ZWRUeXBlO1xufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1pbnRlcmZhY2VcbnR5cGUgTG9vcEFycmF5ID0gTWVtb3J5QWxsb3dlZFR5cGVbXTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktaW50ZXJmYWNlXG50eXBlIExvb3BTZXQgPSBTZXQ8TWVtb3J5QWxsb3dlZFR5cGU+O1xuZXhwb3J0IHR5cGUgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzID1cbiAgICB8IHN0cmluZ1xuICAgIHwgbnVtYmVyXG4gICAgfCBib29sZWFuXG4gICAgfCBWZXJzaW9uYWJsZUlEXG4gICAgfCBvYmplY3RcbiAgICB8IEZ1bmN0aW9uXG4gICAgfCBzeW1ib2w7IC8vIG9iamVjdCBtdXN0IHRvIGJlIFByb3h5VW5pcUlEXG5cbi8vIE1lbW9yeVR5cGVcbi8vIE1lbW9yeVR5cGUgZm9yIE9iamVjdFxuXG4vLyBUeXBlIHRoYXQgdGhlIG1lbW9yeSBoYW5kbGVzIGluIHByYWN0aWNlLiBUaGlzIGlzIGhvdyBpdCBpcyBzdG9yZWQgaW4gbWVtb3J5LlxuZXhwb3J0IGNsYXNzIE1lbW9yeVR5cGVPYmplY3Qge1xuICAgIHByb3BzOiBSZWNvcmQ8c3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sLCBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMgfCBGdW5jdGlvbj4gPSB7fTtcbn1cblxuLy8gTWVtb3J5VHlwZSBmb3IgQXJyYXlcblxuLy8gVHlwZSB0aGF0IHRoZSBtZW1vcnkgaGFuZGxlcyBpbiBwcmFjdGljZS4gVGhpcyBpcyBob3cgaXQgaXMgc3RvcmVkIGluIG1lbW9yeS5cbmV4cG9ydCBjbGFzcyBNZW1vcnlUeXBlQXJyYXkgZXh0ZW5kcyBNZW1vcnlUeXBlT2JqZWN0IHtcbiAgICBwYXRjaDogUmVjb3JkPHN0cmluZywgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzPiA9IHt9O1xufVxuXG4vLyBPdXRwdXQgb2YgbWVtb3J5IGdpdmVuIHRvIHByb3h5IHRvIG9wZXJhdGVcbmV4cG9ydCBjbGFzcyBNZW1vcnlBcnJheUNvbXBpbGVkV2l0aFBhdGNoIHtcbiAgICAvLyB0aGUgcHJveHkgaGFzIHRvIGRpZmZlcmVudGlhdGUgYmV0d2VlbiB3aGF0IHdhcyBhbHJlYWR5IHRoZXJlIGFuZCB3aGF0IGlzXG4gICAgLy8gYmVpbmcgZG9uZSBpbiB0aGUgY3VycmVudCBzbGljZSBiZWNhdXNlIGRlbGV0aW5nIGEga2V5IGRvZXMgbm90IHlpZWxkIHRoZVxuICAgIC8vIHNhbWUgcmVzdWx0IGlmIHRoZSBrZXkgd2FzIGFscmVhZHkgdGhlcmUgYmVmb3JlIHRoaXMgc2xpY2Ugb3Igbm90IChpdFxuICAgIC8vIHdvdWxkIGJlIG1hcmtlZCBhcyBcInJlbW92ZWRcIiBvciBpZ25vcmVkIGlmIHdhc24ndCBhbHJlYWR5IHRoZXJlLilcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgLy8gYXJyYXkgYXMgaXQgYXBwZWFycyBpbiB0aGUgc2xpY2UgcmlnaHQgYmVmb3JlIHRoZSBjdXJyZW50IG9uZSBcImFycmF5IGFzIG9mIHQtMVwiXG4gICAgICAgIHB1YmxpYyBjb21waWxlZFZhbHVlczogUmVjb3JkPHN0cmluZywgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzPixcbiAgICAgICAgLy8gdmVyeSBsYXN0IHBhdGNoIGF0IGN1cnJlbnQgdGltZSB0XG4gICAgICAgIHB1YmxpYyBuZXdWYWx1ZXM6IE1lbW9yeVR5cGVBcnJheSxcbiAgICAgICAgLy8gbmV3IHByb3BlcnRpZXMgb24gdGhlIGFycmF5IGF0IGN1cnJlbnQgdGltZSB0XG4gICAgICAgIHB1YmxpYyBwcm9wczogUmVjb3JkPHN0cmluZywgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzPixcbiAgICApIHt9XG59XG5cbi8vIE1lbW9yeVR5cGUgZm9yIFNldFxuXG4vLyBUeXBlIHRoYXQgdGhlIG1lbW9yeSBoYW5kbGVzIGluIHByYWN0aWNlLiBUaGlzIGlzIGhvdyBpdCBpcyBzdG9yZWQgaW4gbWVtb3J5LlxuZXhwb3J0IGNsYXNzIE1lbW9yeVR5cGVTZXQge1xuICAgIGFkZDogU2V0PE1lbW9yeUFsbG93ZWRQcmltaXRpdmVUeXBlcz4gPSBuZXcgU2V0KCk7XG4gICAgZGVsZXRlOiBTZXQ8TWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzPiA9IG5ldyBTZXQoKTtcbn1cbi8vIE91dHB1dCBvZiBtZW1vcnkgZ2l2ZW4gdG8gcHJveHkgdG8gb3BlcmF0ZSAobm90IHN1cmUgaXQgaXMgdXNlZnVsIHRvIHJlbmFtZVxuLy8gdGhlIHR5cGUuIHNlbWFudGljIHZhbHVlIG9mIFwiY29tcGlsZWRcIilcbmV4cG9ydCB0eXBlIE1lbW9yeUNvbXBpbGVkU2V0ID0gU2V0PE1lbW9yeUFsbG93ZWRQcmltaXRpdmVUeXBlcz47XG5cbmV4cG9ydCB0eXBlIE1lbW9yeVR5cGUgPSBNZW1vcnlUeXBlT2JqZWN0IHwgTWVtb3J5VHlwZUFycmF5IHwgTWVtb3J5VHlwZVNldDtcblxuLy8gTWVtb3J5VHlwZSBlbmRcblxuZXhwb3J0IHR5cGUgTWVtb3J5Q29tcGlsZWQgPSBNZW1vcnlUeXBlT2JqZWN0IHwgTWVtb3J5QXJyYXlDb21waWxlZFdpdGhQYXRjaCB8IE1lbW9yeUNvbXBpbGVkU2V0O1xuXG4vLyBMaXN0IG9mIG1lbW9yeSBhY2Nlc3NvcnMgdXNhYmxlIGJ5IHZlcnNpb25hYmxlICh3ZSBkb24ndCB3YW50IHRvIGdpdmUgdGhlbVxuLy8gYWNjZXNzIHRvIHRoZSB0cnVlIG1lbW9yeSBvYmplY3QgISlcbmV4cG9ydCBpbnRlcmZhY2UgTWVtb3J5V29ya2VyIHtcbiAgICBJRDogbnVtYmVyO1xuICAgIGdldFByb3h5OiAoSUQ6IFZlcnNpb25hYmxlSUQpID0+IG9iamVjdDtcbiAgICBnZXRTbGljZTogKCkgPT4gUmVjb3JkPG51bWJlciwgTWVtb3J5VHlwZT47XG4gICAgZ2V0U2xpY2VWYWx1ZTogKElEOiBWZXJzaW9uYWJsZUlEKSA9PiBNZW1vcnlDb21waWxlZDtcbiAgICBpc0Zyb3plbjogKCkgPT4gYm9vbGVhbjtcbiAgICBtYXJrRGlydHk6IChJRDogVmVyc2lvbmFibGVJRCkgPT4gdm9pZDtcbiAgICBhZGRTbGljZVByb3h5UGFyZW50OiAoXG4gICAgICAgIElEOiBWZXJzaW9uYWJsZUlELFxuICAgICAgICBwYXJlbnRJRDogVmVyc2lvbmFibGVJRCxcbiAgICAgICAgYXR0cmlidXRlTmFtZTogc3RyaW5nLFxuICAgICkgPT4gYm9vbGVhbjtcbiAgICBkZWxldGVTbGljZVByb3h5UGFyZW50OiAoXG4gICAgICAgIElEOiBWZXJzaW9uYWJsZUlELFxuICAgICAgICBwYXJlbnRJRDogVmVyc2lvbmFibGVJRCxcbiAgICAgICAgYXR0cmlidXRlTmFtZTogc3RyaW5nLFxuICAgICkgPT4gYm9vbGVhbjtcbiAgICBsaW5rVG9NZW1vcnk6IChvYmo6IE1lbW9yeUFsbG93ZWRUeXBlKSA9PiBNZW1vcnlBbGxvd2VkVHlwZTtcbn1cblxuZXhwb3J0IHR5cGUgcGF0Y2hlcyA9IHsgc2xpY2VLZXk6IFNsaWNlS2V5OyB2YWx1ZTogTWVtb3J5VHlwZSB9W107XG50eXBlIHByb3h5QXR0cmlidXRlUGF0aCA9IHN0cmluZ1tdO1xuXG5leHBvcnQgaW50ZXJmYWNlIENoYW5nZXNMb2NhdGlvbnMge1xuICAgIGFkZDogb2JqZWN0W107IC8vIFRoZSBhZGRlZCB2ZXJzaW9uYWJsZXNcbiAgICBtb3ZlOiBvYmplY3RbXTsgLy8gVGhlIHZlcnNpb25hYmxlcyB0aGF0IGNoYW5nZWQgcGFyZW50c1xuICAgIHJlbW92ZTogb2JqZWN0W107IC8vIFZlcnNpb25hYmxlcyB0aGF0IGhhZCBvbmUgb3IgbW9yZSBwYXJlbnRzIGFuZCBubyBsb25nZXIgaGF2ZSBhbnkuXG4gICAgdXBkYXRlOiBbXG4gICAgICAgIG9iamVjdCwgLy8gVGhlIHZlcnNpb25hYmxlcyB0aGF0IGNoYW5nZWRcbiAgICAgICAgKFxuICAgICAgICAgICAgfCBzdHJpbmdbXSAvLyBUaGUgdXBkYXRlZCBvYmplY3Qga2V5c1xuICAgICAgICAgICAgfCBudW1iZXJbXSAvLyB0aGUgdXBkYXRlZCBpbmRleGVzIGZvciB2ZXJzaW9uYWJsZSBhcnJheVxuICAgICAgICAgICAgfCB2b2lkXG4gICAgICAgICksIC8vIE5vdGhpbmcgZm9yIHRoZSB2ZXJzaW9uYWJsZSBzZXRcbiAgICBdW107XG59XG5cbmV4cG9ydCBjb25zdCBwYXJlbnRlZFBhdGhTZXBhcmF0b3IgPSAn4oCiJztcblxuZXhwb3J0IGZ1bmN0aW9uIG1hcmtBc0RpZmZSb290KG9iajogTWVtb3J5QWxsb3dlZE9iamVjdFR5cGUpOiB2b2lkIHtcbiAgICBvYmpbbWVtb3J5UHJveHlQcmFtc0tleV0uaXNEaWZmUm9vdCA9IHRydWU7XG59XG5cbmxldCBtZW1vcnlJRCA9IDA7XG5jb25zdCBtZW1vcnlSb290U2xpY2VOYW1lID0gJyc7XG5cbmV4cG9ydCBjbGFzcyBNZW1vcnlTbGljZSB7XG4gICAgbmFtZTogU2xpY2VLZXk7XG4gICAgcGFyZW50OiBNZW1vcnlTbGljZTtcbiAgICBjaGlsZHJlbjogTWVtb3J5U2xpY2VbXSA9IFtdO1xuICAgIHNuYXBzaG90T3JpZ2luPzogTWVtb3J5U2xpY2U7XG4gICAgc25hcHNob3Q/OiBNZW1vcnlTbGljZTtcbiAgICBkYXRhOiBSZWNvcmQ8bnVtYmVyLCBNZW1vcnlUeXBlPiA9IHt9OyAvLyByZWdpc3RyeSBvZiB2YWx1ZXNcbiAgICBsaW5rZWRQYXJlbnRPZlByb3h5OiBSZWNvcmQ8bnVtYmVyLCBwcm94eUF0dHJpYnV0ZVBhdGg+ID0ge307XG4gICAgaW52YWxpZENhY2hlOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPiA9IHt9OyAvLyBwYXRocyB0aGF0IGhhdmUgYmVlbiBjaGFuZ2VkIGluIGdpdmVuIG1lbW9yeSBzbGljZSAod2hlbiBzd2l0Y2hpbmcgc2xpY2UsIHRoaXMgc2V0IGlzIGxvYWRlZCBpbiBfaW52YWxpZGF0ZUNhY2hlKVxuICAgIGlkczogU2V0PG51bWJlcj4gPSBuZXcgU2V0KCk7XG4gICAgY29uc3RydWN0b3IobmFtZTogU2xpY2VLZXksIHBhcmVudD86IE1lbW9yeVNsaWNlKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIH1cbiAgICBnZXRQcmV2aW91cygpOiBNZW1vcnlTbGljZSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNuYXBzaG90T3JpZ2luID8gdGhpcy5zbmFwc2hvdE9yaWdpbi5wYXJlbnQgOiB0aGlzLnBhcmVudDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNZW1vcnkge1xuICAgIF9pZDogbnVtYmVyO1xuICAgIF9zbGljZUtleTogU2xpY2VLZXk7IC8vIGlkZW50aWZpZXIgb3IgY3VycmVudCBtZW1vcnkgc2xpY2VcbiAgICBfc2xpY2VzOiBSZWNvcmQ8U2xpY2VLZXksIE1lbW9yeVNsaWNlPiA9IHt9OyAvLyBSZWNvcmQ8Y2hpbGRyZW4sIHBhcmVudD5cbiAgICBfY3VycmVudFNsaWNlOiBNZW1vcnlTbGljZTsgLy8gUmVjb3JkPGNoaWxkcmVuLCBwYXJlbnQ+XG4gICAgX3Byb3hpZXM6IFJlY29yZDxWZXJzaW9uYWJsZU1lbW9yeUlELCBvYmplY3Q+ID0ge307XG4gICAgX3Jvb3RQcm94aWVzOiBSZWNvcmQ8VmVyc2lvbmFibGVNZW1vcnlJRCwgYm9vbGVhbj4gPSB7fTtcbiAgICBfbWVtb3J5V29ya2VyOiBNZW1vcnlXb3JrZXI7XG4gICAgX251bWJlck9mRmxhdFNsaWNlcyA9IDQwO1xuICAgIF9udW1iZXJPZlNsaWNlUGVyU25hcHNob3QgPSA4O1xuICAgIF9hdXRvU25hcHNob3RDaGVjayA9IDA7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5faWQgPSArK21lbW9yeUlEO1xuICAgICAgICB0aGlzLmNyZWF0ZShtZW1vcnlSb290U2xpY2VOYW1lKTtcbiAgICAgICAgdGhpcy5zd2l0Y2hUbyhtZW1vcnlSb290U2xpY2VOYW1lKTtcbiAgICAgICAgdGhpcy5fbWVtb3J5V29ya2VyID0ge1xuICAgICAgICAgICAgSUQ6IHRoaXMuX2lkLFxuICAgICAgICAgICAgZ2V0UHJveHk6IChJRDogVmVyc2lvbmFibGVJRCk6IG9iamVjdCA9PiB0aGlzLl9wcm94aWVzW0lEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdLFxuICAgICAgICAgICAgZ2V0U2xpY2U6ICgpOiBSZWNvcmQ8bnVtYmVyLCBNZW1vcnlUeXBlPiA9PiB0aGlzLl9jdXJyZW50U2xpY2UuZGF0YSxcbiAgICAgICAgICAgIGdldFNsaWNlVmFsdWU6IChJRDogVmVyc2lvbmFibGVJRCk6IE1lbW9yeUNvbXBpbGVkID0+XG4gICAgICAgICAgICAgICAgdGhpcy5fZ2V0VmFsdWUodGhpcy5fc2xpY2VLZXksIElEKSxcbiAgICAgICAgICAgIGlzRnJvemVuOiB0aGlzLmlzRnJvemVuLmJpbmQodGhpcyksXG4gICAgICAgICAgICAvLyBNYXJrIGFzIFwibW9kaWZpZWRcIiBpbiB0aGlzIHNsaWNlXG4gICAgICAgICAgICBtYXJrRGlydHk6IChJRDogVmVyc2lvbmFibGVJRCk6IGJvb2xlYW4gPT5cbiAgICAgICAgICAgICAgICAodGhpcy5fY3VycmVudFNsaWNlLmludmFsaWRDYWNoZVtJRCBhcyBWZXJzaW9uYWJsZU1lbW9yeUlEXSA9IHRydWUpLFxuICAgICAgICAgICAgLy8gSSBhbSB0aGUgcHJveHksIEkgdGVsbCB5b3UgSSBzeW5jaG9ybml6ZWQgdGhlIHZhbHVlXG4gICAgICAgICAgICBkZWxldGVTbGljZVByb3h5UGFyZW50OiB0aGlzLl9kZWxldGVTbGljZVByb3h5UGFyZW50LmJpbmQodGhpcyksXG4gICAgICAgICAgICBhZGRTbGljZVByb3h5UGFyZW50OiB0aGlzLl9hZGRTbGljZVByb3h5UGFyZW50LmJpbmQodGhpcyksXG4gICAgICAgICAgICBsaW5rVG9NZW1vcnk6IHRoaXMuX2xpbmtUb01lbW9yeS5iaW5kKHRoaXMpLFxuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMuX21lbW9yeVdvcmtlcik7XG4gICAgfVxuXG4gICAgZ2V0IHNsaWNlS2V5KCk6IFNsaWNlS2V5IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NsaWNlS2V5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG1lbW9yeSBzbGljZS5cbiAgICAgKiBNb2RpZmljYXRpb25zIGFuZCBjaGFuZ2VzIChvZiBvYmplY3RzIGJvdW5kIHRvIG1lbW9yeSkgYXJlIGFsbCByZWNvcmRlZFxuICAgICAqIGluIHRoZXNlIHNsaWNlcy4gVGhlIG5ldyBzbGljZSBjcmVhdGVkIHdpbGwgYmUgbm90ZWQgYXMgYmVpbmcgdGhlXG4gICAgICogY29udGludWF0aW9uIChvciB0aGUgY2hpbGQpIG9mIHRoZSBjdXJyZW50IG9uZS5cbiAgICAgKlxuICAgICAqIEEgc2xpY2Ugd2l0aCBcImNoaWxkcmVuXCIgaXMgaW1tdXRhYmxlLiBUaGUgbW9kaWZpY2F0aW9ucyBhcmUgdGhlcmVmb3JlXG4gICAgICogYmxvY2tlZCBhbmQgYW4gZXJyb3Igd2lsbCBiZSB0cmlnZ2VyZWQgaWYgYSBjb2RlIHRyaWVzIHRvIG1vZGlmeSBvbmUgb2ZcbiAgICAgKiB0aGVzZSBvYmplY3RzLiBUbyBiZSBhYmxlIHRvIGVkaXQgYWdhaW4sIHlvdSBtdXN0IGRlc3Ryb3kgdGhlIFwiY2hpbGRcIlxuICAgICAqIHNsaWNlcyBvciBjaGFuZ2UgdGhlIG1lbW9yeSBzbGljZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzbGljZUtleVxuICAgICAqL1xuICAgIGNyZWF0ZShzbGljZUtleTogU2xpY2VLZXkpOiB0aGlzIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlKHNsaWNlS2V5LCB0aGlzLl9zbGljZUtleSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIHdvcmtpbmcgbWVtb3J5IHNsaWNlICh0aGlzIG11c3QgYmUgY3JlYXRlZCBiZWZvcmVoYW5kKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzbGljZUtleVxuICAgICAqL1xuICAgIHN3aXRjaFRvKHNsaWNlS2V5OiBTbGljZUtleSk6IHRoaXMge1xuICAgICAgICBpZiAoIShzbGljZUtleSBpbiB0aGlzLl9zbGljZXMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTWVtb3J5RXJyb3IoXG4gICAgICAgICAgICAgICAgJ1lvdSBtdXN0IGNyZWF0ZSB0aGUgXCInICsgc2xpY2VLZXkgKyAnXCIgc2xpY2UgYmVmb3JlIHN3aXRjaCBvbiBpdCcsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzbGljZUtleSA9PT0gdGhpcy5fc2xpY2VLZXkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbnZhbGlkQ2FjaGUgPSB0aGlzLl9hZ2dyZWdhdGVJbnZhbGlkQ2FjaGVzKHRoaXMuX3NsaWNlS2V5LCBzbGljZUtleSk7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRTbGljZSA9IHRoaXMuX3NsaWNlc1tzbGljZUtleV07XG4gICAgICAgIHRoaXMuX3NsaWNlS2V5ID0gc2xpY2VLZXk7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGludmFsaWRDYWNoZSkge1xuICAgICAgICAgICAgY29uc3QgcHJveHkgPSB0aGlzLl9wcm94aWVzW2tleV07XG4gICAgICAgICAgICBjb25zdCBwYXJhbXMgPSBwcm94eVttZW1vcnlQcm94eVByYW1zS2V5XSBhcyBWZXJzaW9uYWJsZVBhcmFtcztcbiAgICAgICAgICAgIHBhcmFtcy5zeW5jaHJvbml6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2F1dG9TbmFwc2hvdENoZWNrKys7XG4gICAgICAgIGlmICghKHRoaXMuX2F1dG9TbmFwc2hvdENoZWNrICUgdGhpcy5fbnVtYmVyT2ZTbGljZVBlclNuYXBzaG90KSkge1xuICAgICAgICAgICAgdGhpcy5fYXV0b1NuYXBzaG90KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGFjaCBhIHZlcnNpb25hYmxlIHRvIG1lbW9yeS5cbiAgICAgKiBUaGUgdmVyc2lvbmFibGUgd2lsbCB0aGVuIGJlIHZlcnNpb25lZCBhbmQgaXRzIG1vZGlmaWNhdGlvbnMgd2lsbCBiZVxuICAgICAqIHJlY29yZGVkIGluIHRoZSBjb3JyZXNwb25kaW5nIG1lbW9yeSBzbG90cy5cbiAgICAgKiBBbGwgb3RoZXIgdmVyc2lvbmFibGVzIGxpbmtlZCB0byBnaXZlbiB2ZXJzaW9uYWJsZSBhdHRhY2hlZCB0byBtZW1vcnlcbiAgICAgKiBhcmUgYXV0b21hdGljYWxseSBsaW5rZWQgdG8gbWVtb3J5LlxuICAgICAqXG4gICAgICogKEl0ZW1zIGJvdW5kIHRvIG1lbW9yeSBieSB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgbm90ZWQgYXMgcGFydCBvZiB0aGVcbiAgICAgKiByb290IG9mIGNoYW5nZXMgQHNlZSBnZXRSb290cyApXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdmVyc2lvbmFibGVcbiAgICAgKi9cbiAgICBhdHRhY2godmVyc2lvbmFibGU6IE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHZlcnNpb25hYmxlW21lbW9yeVByb3h5UHJhbXNLZXldIGFzIFZlcnNpb25hYmxlUGFyYW1zO1xuICAgICAgICBpZiAoIXBhcmFtcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE5vdFZlcnNpb25hYmxlRXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1zLm9iamVjdCA9PT0gdmVyc2lvbmFibGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBWZXJzaW9uYWJsZUFsbHJlYWR5VmVyc2lvbmFibGVFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1zLnZlcmlmeSh2ZXJzaW9uYWJsZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBOb3RWZXJzaW9uYWJsZUVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNGcm96ZW4oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEZyb3plbkVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJhbXMubWVtb3J5IHx8IHBhcmFtcy5tZW1vcnkgIT09IHRoaXMuX21lbW9yeVdvcmtlcikge1xuICAgICAgICAgICAgcGFyYW1zLmlzRGlmZlJvb3QgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fbGlua1RvTWVtb3J5KHZlcnNpb25hYmxlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yb290UHJveGllc1twYXJhbXMuSUQgYXMgVmVyc2lvbmFibGVNZW1vcnlJRF0gPSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwYXJlbnRzIG9mIHRoZSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBFeGFtcGxlOiBwID0ge307IHYgPSB7cG9pbnQ6IHB9IGF4aXMgPSB7b3JpZ2luOiBwfVxuICAgICAqIFRoZSBwYXJlbnRzIG9mIHAgYXJlIFtbdiwgWydwb2ludCddXSwgW2F4aXMsIFsnb3JpZ2luJ11dXVxuICAgICAqXG4gICAgICogQHBhcmFtIHZlcnNpb25hYmxlXG4gICAgICovXG4gICAgZ2V0UGFyZW50cyh2ZXJzaW9uYWJsZTogTWVtb3J5QWxsb3dlZE9iamVjdFR5cGUpOiBNYXA8TWVtb3J5QWxsb3dlZE9iamVjdFR5cGUsIHN0cmluZ1tdW10+IHtcbiAgICAgICAgY29uc3QgcGF0aENoYW5nZXMgPSBuZXcgTWFwPE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlLCBzdHJpbmdbXVtdPigpO1xuICAgICAgICBjb25zdCBub2RlSUQgPSB2ZXJzaW9uYWJsZVttZW1vcnlQcm94eVByYW1zS2V5XS5JRDtcbiAgICAgICAgY29uc3QgcGF0aExpc3Q6IFtWZXJzaW9uYWJsZUlELCBzdHJpbmdbXV1bXSA9IFtbbm9kZUlELCBbXV1dO1xuICAgICAgICB3aGlsZSAocGF0aExpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gcGF0aExpc3QucG9wKCk7XG4gICAgICAgICAgICBjb25zdCBbbm9kZUlELCBwYXRoVG9Ob2RlXSA9IHBhdGg7XG5cbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFByb3h5OiBNZW1vcnlBbGxvd2VkT2JqZWN0VHlwZSA9IHRoaXMuX3Byb3hpZXNbXG4gICAgICAgICAgICAgICAgbm9kZUlEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBsZXQgcGF0aHM6IHN0cmluZ1tdW10gPSBwYXRoQ2hhbmdlcy5nZXQocGFyZW50UHJveHkpO1xuICAgICAgICAgICAgaWYgKCFwYXRocykge1xuICAgICAgICAgICAgICAgIHBhdGhzID0gW107XG4gICAgICAgICAgICAgICAgcGF0aENoYW5nZXMuc2V0KHBhcmVudFByb3h5LCBwYXRocyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXRocy5wdXNoKHBhdGhbMV0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcm9vdFByb3hpZXNbbm9kZUlEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9nZXRQcm94eVBhcmVudGVkUGF0aCh0aGlzLl9zbGljZUtleSwgbm9kZUlEKS5mb3JFYWNoKHBhdGggPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGVJRCA9IHBhdGguc3BsaXQocGFyZW50ZWRQYXRoU2VwYXJhdG9yLCAxKVswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0UGF0aCA9IHBhdGguc2xpY2UocGFyZW50Tm9kZUlELmxlbmd0aCArIDEpO1xuICAgICAgICAgICAgICAgIHBhdGhMaXN0LnB1c2goWytwYXJlbnROb2RlSUQsIFtwYXJ0UGF0aF0uY29uY2F0KHBhdGhUb05vZGUpXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGF0aENoYW5nZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbG9jYXRpb24gb2YgdGhlIGNoYW5nZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZnJvbVxuICAgICAqIEBwYXJhbSB0b1xuICAgICAqL1xuICAgIGdldENoYW5nZXNMb2NhdGlvbnMoZnJvbTogU2xpY2VLZXksIHRvOiBTbGljZUtleSk6IENoYW5nZXNMb2NhdGlvbnMge1xuICAgICAgICBjb25zdCBkaWZmOiBDaGFuZ2VzTG9jYXRpb25zID0ge1xuICAgICAgICAgICAgYWRkOiBbXSxcbiAgICAgICAgICAgIG1vdmU6IFtdLFxuICAgICAgICAgICAgcmVtb3ZlOiBbXSxcbiAgICAgICAgICAgIHVwZGF0ZTogW10sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYW5jZXN0b3JLZXkgPSB0aGlzLl9nZXRDb21tb25BbmNlc3Rvcihmcm9tLCB0byk7XG4gICAgICAgIGNvbnN0IHJlZnMgPSB0aGlzLl9nZXRDaGFuZ2VzUGF0aChmcm9tLCB0bywgYW5jZXN0b3JLZXkpO1xuICAgICAgICBpZiAoZnJvbSA9PT0gYW5jZXN0b3JLZXkgJiYgZnJvbSAhPT0gdG8pIHtcbiAgICAgICAgICAgIHJlZnMuc2hpZnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlbW92ZUZyb21VcGRhdGUgPSBuZXcgU2V0PE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlPigpO1xuXG4gICAgICAgIGxldCBwcmV2aW91czogTWVtb3J5U2xpY2U7XG4gICAgICAgIGxldCByZWY6IE1lbW9yeVNsaWNlO1xuICAgICAgICB3aGlsZSAoKHJlZiA9IHJlZnMucG9wKCkpKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5rZWRQYXJlbnRPZlByb3h5ID0gcmVmLmxpbmtlZFBhcmVudE9mUHJveHk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IElEIGluIGxpbmtlZFBhcmVudE9mUHJveHkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm94eSA9IHRoaXMuX3Byb3hpZXNbSURdO1xuICAgICAgICAgICAgICAgIGlmIChsaW5rZWRQYXJlbnRPZlByb3h5W0lEXS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZi5pZHMuaGFzKCtJRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWYucGFyZW50ID09PSBwcmV2aW91cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYucmVtb3ZlLnB1c2gocHJveHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmLmFkZC5wdXNoKHByb3h5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21VcGRhdGUuYWRkKHByb3h5KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYubW92ZS5wdXNoKHByb3h5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWYucGFyZW50ID09PSBwcmV2aW91cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZi5hZGQucHVzaChwcm94eSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaWZmLnJlbW92ZS5wdXNoKHByb3h5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVGcm9tVXBkYXRlLmFkZChwcm94eSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVmLnBhcmVudCA9PT0gcHJldmlvdXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IElEIG9mIHByZXZpb3VzLmlkcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm94eSA9IHRoaXMuX3Byb3hpZXNbSURdO1xuICAgICAgICAgICAgICAgICAgICBkaWZmLnJlbW92ZS5wdXNoKHByb3h5KTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRnJvbVVwZGF0ZS5hZGQocHJveHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc2xpY2UgPSByZWYuZGF0YTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHNsaWNlKS5mb3JFYWNoKElEID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9ICtJRDtcbiAgICAgICAgICAgICAgICBjb25zdCBtZW1vcnlJdGVtID0gc2xpY2VbaWRdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb3h5ID0gdGhpcy5fcHJveGllc1tJRF07XG4gICAgICAgICAgICAgICAgaWYgKHJlbW92ZUZyb21VcGRhdGUuaGFzKHByb3h5KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZW1vcnlJdGVtIGluc3RhbmNlb2YgTWVtb3J5VHlwZUFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhtZW1vcnlJdGVtLnByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaWZmLnVwZGF0ZS5wdXNoKFtwcm94eSwga2V5c10pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHByb3h5W21lbW9yeVByb3h5UHJhbXNLZXldIGFzIEFycmF5UGFyYW1zO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmlxSURzID0gcGFyYW1zLnVuaXFJRHM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlbiA9IHVuaXFJRHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoYWxmID0gbGVuO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleGVzOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgaW4gbWVtb3J5SXRlbS5wYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gaGFsZjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGVwID0gaW5kZXggKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0ZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHVuaXFJRHNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCAtPSBzdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCArPSBzdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gbGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGxlbiAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCA9IChzdGVwIC8gMikgfCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwID09PSAwICYmIHZhbHVlID4gaSAmJiB1bmlxSURzW2luZGV4XSA8IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluZGV4ZXMuaW5jbHVkZXMoaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhlcy5wdXNoKGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYudXBkYXRlLnB1c2goW3Byb3h5LCBpbmRleGVzXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1lbW9yeUl0ZW0gaW5zdGFuY2VvZiBNZW1vcnlUeXBlU2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRpZmYudXBkYXRlLnB1c2goW3Byb3h5LCBudWxsXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKG1lbW9yeUl0ZW0ucHJvcHMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYudXBkYXRlLnB1c2goW3Byb3h5LCBrZXlzXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcHJldmlvdXMgPSByZWY7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpZmY7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBpZiB0aGUgY3VycmVudCBtZW1vcnkgc2xpY2UgYXJlIGltdXRhYmxlIG9yIG5vdC5cbiAgICAgKlxuICAgICAqL1xuICAgIGlzRnJvemVuKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFNsaWNlLmNoaWxkcmVuLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIG1lbW9yeSBzbGljZS5cbiAgICAgKiBUaGUgY3VycmVudCBzbGljZSBjYW5ub3QgYmUgdGhlIG9uZSBiZWluZyBkZWxldGVkIG9yIG9uZSBvZiBpdHMgY2hpbGRyZW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2xpY2VLZXlcbiAgICAgKi9cbiAgICByZW1vdmUoc2xpY2VLZXk6IFNsaWNlS2V5KTogdGhpcyB7XG4gICAgICAgIGlmICghKHNsaWNlS2V5IGluIHRoaXMuX3NsaWNlcykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzbGljZUtleSA9PT0gbWVtb3J5Um9vdFNsaWNlTmFtZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE1lbW9yeUVycm9yKCdZb3Ugc2hvdWxkIG5vdCByZW1vdmUgdGhlIG9yaWdpbmFsIG1lbW9yeSBzbGljZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlZiA9IHRoaXMuX3NsaWNlc1t0aGlzLl9zbGljZUtleV07XG4gICAgICAgIHdoaWxlIChyZWYpIHtcbiAgICAgICAgICAgIGlmIChyZWYubmFtZSA9PT0gc2xpY2VLZXkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWVtb3J5RXJyb3IoJ1BsZWFzZSBzd2l0Y2ggdG8gYSBub24tY2hpbGRyZW4gc2xpY2UgYmVmb3JlIHJlbW92ZSBpdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVmID0gcmVmLnBhcmVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IElEcyA9IHRoaXMuX3JlbW92ZShzbGljZUtleSk7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBJRHMgYXJlIGxpbmtlZCBldnJ5d2VyZVxuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuX3NsaWNlcykuZm9yRWFjaChyZWZlcmVuY2UgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGlua2VkUGFyZW50T2ZQcm94eSA9IHJlZmVyZW5jZS5saW5rZWRQYXJlbnRPZlByb3h5O1xuICAgICAgICAgICAgSURzLmZvckVhY2goSUQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChJRCBpbiBsaW5rZWRQYXJlbnRPZlByb3h5KSB7XG4gICAgICAgICAgICAgICAgICAgIElEcy5kZWxldGUoSUQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gcmVtb3ZlIHVubGlua2VkIGl0ZW1zXG4gICAgICAgIElEcy5mb3JFYWNoKElEID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9wcm94aWVzW0lEXTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yb290UHJveGllc1tJRF07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuY2VzdG9yIHZlcnNpb25hYmxlcyBub3RlZCBhcyByb290cy5cbiAgICAgKlxuICAgICAqIFRoZXJlIGFyZSB0d28gd2F5cyBmb3IgYSB2ZXJzaW9uYWJsZSB0byBiZSByb290LCBlaXRoZXIgdmlhIHRoZVxuICAgICAqICdsaW5rVG9NZW1vcnknIG1ldGhvZCwgb3Igd2l0aCB0aGUgJ21hcmtBc0RpZmZSb290JyB1dGlsaXR5IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHByb3h5XG4gICAgICovXG4gICAgZ2V0Um9vdHMocHJveHk6IE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlKTogU2V0PE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlPiB7XG4gICAgICAgIGNvbnN0IHJvb3RzOiBTZXQ8TWVtb3J5QWxsb3dlZE9iamVjdFR5cGU+ID0gbmV3IFNldCgpO1xuXG4gICAgICAgIGNvbnN0IG5vZGVJRCA9IHByb3h5W21lbW9yeVByb3h5UHJhbXNLZXldLklEO1xuICAgICAgICBjb25zdCBwYXRoTGlzdDogW1ZlcnNpb25hYmxlSUQsIHN0cmluZ1tdXVtdID0gW1tub2RlSUQsIFtdXV07XG4gICAgICAgIHdoaWxlIChwYXRoTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhdGggPSBwYXRoTGlzdC5wb3AoKTtcbiAgICAgICAgICAgIGNvbnN0IFtub2RlSUQsIHBhdGhUb05vZGVdID0gcGF0aDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yb290UHJveGllc1tub2RlSUQgYXMgVmVyc2lvbmFibGVNZW1vcnlJRF0pIHtcbiAgICAgICAgICAgICAgICByb290cy5hZGQodGhpcy5fcHJveGllc1tub2RlSUQgYXMgVmVyc2lvbmFibGVNZW1vcnlJRF0pO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZ2V0UHJveHlQYXJlbnRlZFBhdGgodGhpcy5fc2xpY2VLZXksIG5vZGVJRCkuZm9yRWFjaChwYXRoID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlSUQgPSBwYXRoLnNwbGl0KHBhcmVudGVkUGF0aFNlcGFyYXRvciwgMSlbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgcGFydFBhdGggPSBwYXRoLnNsaWNlKHBhcmVudE5vZGVJRC5sZW5ndGggKyAxKTtcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKFsrcGFyZW50Tm9kZUlELCBbcGFydFBhdGhdLmNvbmNhdChwYXRoVG9Ob2RlKV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJvb3RzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxpc3Qgb2YgbmFtZXMgb2YgYWxsIHByZXZpb3VzIG1lbW9yeSBzbGljZSBvZiB0aGUgZ2l2ZW5cbiAgICAgKiBtZW1vcnkgc2xpY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2xpY2VLZXlcbiAgICAgKiBAcGFyYW0gd2l0aG91dFNuYXBzaG90XG4gICAgICovXG4gICAgZ2V0UGF0aChzbGljZUtleTogU2xpY2VLZXksIHdpdGhvdXRTbmFwc2hvdD86IGJvb2xlYW4pOiBTbGljZUtleVtdIHtcbiAgICAgICAgY29uc3Qgc2xpY2VLZXlzID0gW107XG4gICAgICAgIGxldCByZWYgPSB0aGlzLl9zbGljZXNbc2xpY2VLZXldO1xuICAgICAgICB3aGlsZSAocmVmICYmIHJlZi5uYW1lKSB7XG4gICAgICAgICAgICBzbGljZUtleXMucHVzaChyZWYubmFtZSk7XG4gICAgICAgICAgICByZWYgPSB3aXRob3V0U25hcHNob3QgPyByZWYuZ2V0UHJldmlvdXMoKSA6IHJlZi5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNsaWNlS2V5cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBzbmFwc2hvdCBvZiBkaWZmZXJlbnQgbWVtb3J5IHNsaWNlcyAodXNlIHRoZSBwYXRoIGJldHdlZW4gdGhlXG4gICAgICogbWVtb3J5IHNsaWNlIHRvIGdldCBhbGwgY2hhbmdlcykgYW5kIG1lcmdlIHRoZSBjaGFuZ2VzIGludG8gYSBuZXdcbiAgICAgKiBkZXN0aW5hdGlvbiBzbGljZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmcm9tU2xpY2VLZXlcbiAgICAgKiBAcGFyYW0gdW5pdFNsaWNlS2V5XG4gICAgICogQHBhcmFtIG5ld1NsaWNlS2V5XG4gICAgICovXG4gICAgc25hcHNob3QoZnJvbVNsaWNlS2V5OiBTbGljZUtleSwgdW5pdFNsaWNlS2V5OiBTbGljZUtleSwgbmV3U2xpY2VLZXk6IFNsaWNlS2V5KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlZnMgPSB0aGlzLl9zbGljZXM7XG4gICAgICAgIGNvbnN0IGZyb21ScmVmID0gcmVmc1tmcm9tU2xpY2VLZXldO1xuICAgICAgICBjb25zdCB1bnRpbFJyZWYgPSByZWZzW3VuaXRTbGljZUtleV07XG5cbiAgICAgICAgY29uc3QgbmV3UmVmID0gdGhpcy5fY3JlYXRlKG5ld1NsaWNlS2V5LCBmcm9tUnJlZi5wYXJlbnQgJiYgZnJvbVJyZWYucGFyZW50Lm5hbWUpO1xuICAgICAgICB0aGlzLl9zcXVhc2hJbnRvKGZyb21TbGljZUtleSwgdW5pdFNsaWNlS2V5LCBuZXdSZWYubmFtZSk7XG5cbiAgICAgICAgdW50aWxScmVmLmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4ge1xuICAgICAgICAgICAgY2hpbGQucGFyZW50ID0gbmV3UmVmO1xuICAgICAgICB9KTtcbiAgICAgICAgbmV3UmVmLmNoaWxkcmVuID0gdW50aWxScmVmLmNoaWxkcmVuO1xuICAgICAgICB1bnRpbFJyZWYuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdW50aWxScmVmLnNuYXBzaG90ID0gbmV3UmVmO1xuICAgICAgICBuZXdSZWYuc25hcHNob3RPcmlnaW4gPSB1bnRpbFJyZWY7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXByZXNzIGFsbCBjaGFuZ2VzIGJldHdlZW4gdHdvIHBhcmVudGVkIG1lbW9yeSBzbGljZXMgYW5kIHJlbW92ZSBhbGxcbiAgICAgKiBjaGlsZHJlbiBtZW1vcnkgc2xpY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZnJvbVNsaWNlS2V5XG4gICAgICogQHBhcmFtIHVuaXRTbGljZUtleVxuICAgICAqL1xuICAgIGNvbXByZXNzKGZyb21TbGljZUtleTogU2xpY2VLZXksIHVuaXRTbGljZUtleTogU2xpY2VLZXkpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgcmVmcyA9IHRoaXMuX3NsaWNlcztcbiAgICAgICAgY29uc3QgZnJvbVJyZWYgPSByZWZzW2Zyb21TbGljZUtleV07XG4gICAgICAgIGNvbnN0IHVudGlsUnJlZiA9IHJlZnNbdW5pdFNsaWNlS2V5XTtcbiAgICAgICAgY29uc3QgdG9SZW1vdmUgPSBmcm9tUnJlZi5jaGlsZHJlbi5zbGljZSgpLm1hcChyZWYgPT4gcmVmLm5hbWUpO1xuICAgICAgICBmcm9tUnJlZi5jaGlsZHJlbiA9IHVudGlsUnJlZi5jaGlsZHJlbi5zcGxpY2UoMCk7XG4gICAgICAgIHRoaXMuX3NxdWFzaEludG8oZnJvbVNsaWNlS2V5LCB1bml0U2xpY2VLZXksIGZyb21TbGljZUtleSk7XG4gICAgICAgIGxldCBrZXk6IFNsaWNlS2V5O1xuICAgICAgICB3aGlsZSAoKGtleSA9IHRvUmVtb3ZlLnBvcCgpKSkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLyBwcml2YXRlXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIHByaXZhdGUgX2FkZFNsaWNlUHJveHlQYXJlbnQoXG4gICAgICAgIElEOiBWZXJzaW9uYWJsZUlELFxuICAgICAgICBwYXJlbnRJRDogVmVyc2lvbmFibGVJRCxcbiAgICAgICAgYXR0cmlidXRlTmFtZTogc3RyaW5nLFxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBzbGljZUtleSA9IHRoaXMuX3NsaWNlS2V5O1xuICAgICAgICBjb25zdCBzbGljZUxpbmtlZFBhcmVudE9mUHJveHkgPSB0aGlzLl9zbGljZXNbc2xpY2VLZXldLmxpbmtlZFBhcmVudE9mUHJveHk7XG4gICAgICAgIGNvbnN0IHBhdGggPVxuICAgICAgICAgICAgcGFyZW50SUQgK1xuICAgICAgICAgICAgKGF0dHJpYnV0ZU5hbWUgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gbWVtb3J5Um9vdFNsaWNlTmFtZVxuICAgICAgICAgICAgICAgIDogcGFyZW50ZWRQYXRoU2VwYXJhdG9yICsgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIGxldCBwYXJlbnRzID0gc2xpY2VMaW5rZWRQYXJlbnRPZlByb3h5W0lEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdO1xuICAgICAgICBpZiAoIXBhcmVudHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudGVkID0gdGhpcy5fZ2V0UHJveHlQYXJlbnRlZFBhdGgoc2xpY2VLZXksIElEKTtcbiAgICAgICAgICAgIHBhcmVudHMgPSBzbGljZUxpbmtlZFBhcmVudE9mUHJveHlbSUQgYXMgVmVyc2lvbmFibGVNZW1vcnlJRF0gPSBwYXJlbnRlZFxuICAgICAgICAgICAgICAgID8gcGFyZW50ZWQuc2xpY2UoKVxuICAgICAgICAgICAgICAgIDogW107XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50cy5wdXNoKHBhdGgpO1xuICAgIH1cbiAgICBwcml2YXRlIF9kZWxldGVTbGljZVByb3h5UGFyZW50KFxuICAgICAgICBJRDogVmVyc2lvbmFibGVJRCxcbiAgICAgICAgcGFyZW50SUQ6IFZlcnNpb25hYmxlSUQsXG4gICAgICAgIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyxcbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2xpY2VLZXkgPSB0aGlzLl9zbGljZUtleTtcbiAgICAgICAgY29uc3Qgc2xpY2VMaW5rZWRQYXJlbnRPZlByb3h5ID0gdGhpcy5fc2xpY2VzW3NsaWNlS2V5XS5saW5rZWRQYXJlbnRPZlByb3h5O1xuICAgICAgICBjb25zdCBwYXRoID1cbiAgICAgICAgICAgIHBhcmVudElEICtcbiAgICAgICAgICAgIChhdHRyaWJ1dGVOYW1lID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICA/IG1lbW9yeVJvb3RTbGljZU5hbWVcbiAgICAgICAgICAgICAgICA6IHBhcmVudGVkUGF0aFNlcGFyYXRvciArIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBsZXQgcGFyZW50cyA9IHRoaXMuX2dldFByb3h5UGFyZW50ZWRQYXRoKHNsaWNlS2V5LCBJRCk7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gcGFyZW50cy5pbmRleE9mKHBhdGgpO1xuICAgICAgICBpZiAoIXNsaWNlTGlua2VkUGFyZW50T2ZQcm94eVtJRCBhcyBWZXJzaW9uYWJsZU1lbW9yeUlEXSkge1xuICAgICAgICAgICAgcGFyZW50cyA9IHNsaWNlTGlua2VkUGFyZW50T2ZQcm94eVtJRCBhcyBWZXJzaW9uYWJsZU1lbW9yeUlEXSA9IHBhcmVudHMuc2xpY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIHByaXZhdGUgX2NvbXBpbGVkQXJyYXlQYXRjaGVzKHBhdGNoZXM6IHBhdGNoZXMpOiBNZW1vcnlUeXBlQXJyYXkge1xuICAgICAgICBjb25zdCBwcm9wcyA9IHt9O1xuICAgICAgICBjb25zdCB2YWx1ZUJ5U2VxID0ge307XG4gICAgICAgIHdoaWxlIChwYXRjaGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcGF0Y2ggPSBwYXRjaGVzLnBvcCgpO1xuICAgICAgICAgICAgY29uc3Qgc3RlcCA9IHBhdGNoLnZhbHVlIGFzIE1lbW9yeVR5cGVBcnJheTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocHJvcHMsIHN0ZXAucHJvcHMpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih2YWx1ZUJ5U2VxLCBzdGVwLnBhdGNoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcGF0Y2g6IHZhbHVlQnlTZXEsXG4gICAgICAgICAgICBwcm9wczogcHJvcHMsXG4gICAgICAgIH07XG4gICAgfVxuICAgIHByaXZhdGUgX2NvbXBpbGVkU2V0UGF0Y2hlcyhwYXRjaGVzOiBwYXRjaGVzKTogTWVtb3J5Q29tcGlsZWRTZXQge1xuICAgICAgICBjb25zdCBvYmogPSBuZXcgU2V0KCkgYXMgTWVtb3J5Q29tcGlsZWRTZXQ7XG4gICAgICAgIHdoaWxlIChwYXRjaGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcGF0Y2ggPSBwYXRjaGVzLnBvcCgpO1xuICAgICAgICAgICAgY29uc3Qgc3RlcCA9IHBhdGNoLnZhbHVlIGFzIE1lbW9yeVR5cGVTZXQ7XG4gICAgICAgICAgICBzdGVwLmFkZC5mb3JFYWNoKChpdGVtOiBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMpID0+XG4gICAgICAgICAgICAgICAgKG9iaiBhcyBNZW1vcnlDb21waWxlZFNldCkuYWRkKGl0ZW0pLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHN0ZXAuZGVsZXRlLmZvckVhY2goKGl0ZW06IE1lbW9yeUFsbG93ZWRQcmltaXRpdmVUeXBlcykgPT5cbiAgICAgICAgICAgICAgICAob2JqIGFzIE1lbW9yeUNvbXBpbGVkU2V0KS5kZWxldGUoaXRlbSksXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIHByaXZhdGUgX2NvbXBpbGVkT2JqZWN0UGF0Y2hlcyhwYXRjaGVzOiBwYXRjaGVzKTogTWVtb3J5VHlwZU9iamVjdCB7XG4gICAgICAgIGNvbnN0IG9iaiA9IG5ldyBNZW1vcnlUeXBlT2JqZWN0KCk7XG4gICAgICAgIGNvbnN0IHByb3BzID0gb2JqLnByb3BzO1xuICAgICAgICB3aGlsZSAocGF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhdGNoID0gcGF0Y2hlcy5wb3AoKTtcbiAgICAgICAgICAgIGNvbnN0IHN0ZXAgPSBwYXRjaC52YWx1ZSBhcyBNZW1vcnlUeXBlT2JqZWN0O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwcm9wcywgc3RlcC5wcm9wcyk7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmtleXMocHJvcHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGlmIChwcm9wc1trZXldID09PSByZW1vdmVkSXRlbSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgcHJpdmF0ZSBfY3JlYXRlKHNsaWNlS2V5OiBTbGljZUtleSwgZnJvbVNsaWNlS2V5OiBTbGljZUtleSk6IE1lbW9yeVNsaWNlIHtcbiAgICAgICAgY29uc3QgcmVmcyA9IHRoaXMuX3NsaWNlcztcbiAgICAgICAgaWYgKHJlZnNbc2xpY2VLZXldKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBtZW1vcnkgc2xpY2UgXCInICsgc2xpY2VLZXkgKyAnXCIgYWxyZWFkeSBleGlzdHMnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYXJlbnQgPSByZWZzW2Zyb21TbGljZUtleV07XG4gICAgICAgIGNvbnN0IHJlZiA9IChyZWZzW3NsaWNlS2V5XSA9IG5ldyBNZW1vcnlTbGljZShzbGljZUtleSwgcGFyZW50KSk7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5jaGlsZHJlbi5wdXNoKHJlZik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZjtcbiAgICB9XG4gICAgcHJpdmF0ZSBfZ2V0Q2hhbmdlc1BhdGgoXG4gICAgICAgIGZyb21TbGljZUtleTogU2xpY2VLZXksXG4gICAgICAgIHRvU2xpY2VLZXk6IFNsaWNlS2V5LFxuICAgICAgICBhbmNlc3RvcktleTogU2xpY2VLZXksXG4gICAgKTogTWVtb3J5U2xpY2VbXSB7XG4gICAgICAgIGNvbnN0IGZyb21QYXRoID0gW107XG4gICAgICAgIGxldCByZWYgPSB0aGlzLl9zbGljZXNbZnJvbVNsaWNlS2V5XTtcbiAgICAgICAgd2hpbGUgKHJlZikge1xuICAgICAgICAgICAgZnJvbVBhdGgucHVzaChyZWYpO1xuICAgICAgICAgICAgaWYgKHJlZi5uYW1lID09PSBhbmNlc3RvcktleSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVmID0gcmVmLmdldFByZXZpb3VzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0b1BhdGggPSBbXTtcbiAgICAgICAgcmVmID0gdGhpcy5fc2xpY2VzW3RvU2xpY2VLZXldO1xuICAgICAgICB3aGlsZSAocmVmKSB7XG4gICAgICAgICAgICBpZiAocmVmLm5hbWUgPT09IGFuY2VzdG9yS2V5KSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b1BhdGgucHVzaChyZWYpO1xuICAgICAgICAgICAgcmVmID0gcmVmLmdldFByZXZpb3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdG9QYXRoLnJldmVyc2UoKTtcbiAgICAgICAgcmV0dXJuIGZyb21QYXRoLmNvbmNhdCh0b1BhdGgpO1xuICAgIH1cbiAgICBwcml2YXRlIF9nZXRDb21tb25BbmNlc3RvcihzbGljZUtleUE6IFNsaWNlS2V5LCBzbGljZUtleUI6IFNsaWNlS2V5KTogU2xpY2VLZXkge1xuICAgICAgICBjb25zdCByb290QiA9IHRoaXMuX3NsaWNlc1tzbGljZUtleUJdO1xuICAgICAgICBsZXQgcmVmQSA9IHRoaXMuX3NsaWNlc1tzbGljZUtleUFdO1xuICAgICAgICB3aGlsZSAocmVmQSkge1xuICAgICAgICAgICAgbGV0IHJlZkIgPSByb290QjtcbiAgICAgICAgICAgIHdoaWxlIChyZWZCKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZkEubmFtZSA9PT0gcmVmQi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWZBLm5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlZkIgPSByZWZCLmdldFByZXZpb3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWZBID0gcmVmQS5nZXRQcmV2aW91cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgX2dldFByb3h5UGFyZW50ZWRQYXRoKHNsaWNlS2V5OiBTbGljZUtleSwgSUQ6IFZlcnNpb25hYmxlSUQpOiBwcm94eUF0dHJpYnV0ZVBhdGgge1xuICAgICAgICAvLyBidWJibGluZyB1cCBtYWdpYyBmb3IgcHJveHlQYXJlbnRzXG4gICAgICAgIGxldCByZWYgPSB0aGlzLl9zbGljZXNbc2xpY2VLZXldO1xuICAgICAgICB3aGlsZSAocmVmKSB7XG4gICAgICAgICAgICBjb25zdCBzbGljZSA9IHJlZi5saW5rZWRQYXJlbnRPZlByb3h5O1xuICAgICAgICAgICAgY29uc3QgcGF0aCA9IHNsaWNlICYmIHNsaWNlW0lEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdO1xuICAgICAgICAgICAgaWYgKHBhdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlZiA9IHJlZi5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBwcml2YXRlIF9nZXRWYWx1ZShzbGljZUtleTogc3RyaW5nLCBJRDogVmVyc2lvbmFibGVJRCk6IE1lbW9yeUNvbXBpbGVkIHtcbiAgICAgICAgY29uc3QgcGF0Y2ggPSB0aGlzLl9nZXRQYXRjaGVzKHVuZGVmaW5lZCwgc2xpY2VLZXksIElEKTtcbiAgICAgICAgaWYgKCFwYXRjaCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXRjaC50eXBlID09PSAnc2V0Jykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBpbGVkU2V0UGF0Y2hlcyhwYXRjaC5wYXRjaGVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRjaC50eXBlID09PSAnYXJyYXknKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VmFsdWVBcnJheShzbGljZUtleSwgSUQsIHBhdGNoLnBhdGNoZXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBpbGVkT2JqZWN0UGF0Y2hlcyhwYXRjaC5wYXRjaGVzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIF9nZXRWYWx1ZUFycmF5KHNsaWNlS2V5OiBzdHJpbmcsIElEOiBWZXJzaW9uYWJsZUlELCBwYXRjaGVzOiBwYXRjaGVzKTogTWVtb3J5Q29tcGlsZWQge1xuICAgICAgICBjb25zdCByZWYgPSB0aGlzLl9zbGljZXNbc2xpY2VLZXldO1xuICAgICAgICBsZXQgb3duZXI6IE1lbW9yeVR5cGVBcnJheTtcbiAgICAgICAgaWYgKHJlZi5kYXRhW0lEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdKSB7XG4gICAgICAgICAgICBvd25lciA9IHBhdGNoZXMuc2hpZnQoKS52YWx1ZSBhcyBNZW1vcnlUeXBlQXJyYXk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9jb21waWxlZEFycmF5UGF0Y2hlcyhwYXRjaGVzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNZW1vcnlBcnJheUNvbXBpbGVkV2l0aFBhdGNoKFxuICAgICAgICAgICAgdmFsdWUucGF0Y2gsXG4gICAgICAgICAgICBvd25lciB8fCBuZXcgTWVtb3J5VHlwZUFycmF5KCksXG4gICAgICAgICAgICB2YWx1ZS5wcm9wcyxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgcHJpdmF0ZSBfZ2V0UGF0Y2hlcyhcbiAgICAgICAgZnJvbVNsaWNlS2V5OiBTbGljZUtleSxcbiAgICAgICAgdG9TbGljZUtleTogc3RyaW5nLFxuICAgICAgICBJRDogVmVyc2lvbmFibGVJRCxcbiAgICApOiB7IHBhdGNoZXM6IHBhdGNoZXM7IHR5cGU6IHN0cmluZyB9IHtcbiAgICAgICAgbGV0IHJlZiA9IHRoaXMuX3NsaWNlc1t0b1NsaWNlS2V5XTtcbiAgICAgICAgbGV0IHR5cGU6IHN0cmluZztcbiAgICAgICAgY29uc3QgcGF0Y2hlcyA9IFtdO1xuICAgICAgICB3aGlsZSAocmVmICYmIHJlZi5uYW1lICE9PSBmcm9tU2xpY2VLZXkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNsaWNlID0gcmVmLmRhdGE7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNsaWNlICYmIHNsaWNlW0lEIGFzIFZlcnNpb25hYmxlTWVtb3J5SURdO1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJlZiA9IHJlZi5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXR5cGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBNZW1vcnlUeXBlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdhcnJheSc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE1lbW9yeVR5cGVTZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdzZXQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnb2JqZWN0JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIHNsaWNlS2V5OiByZWYubmFtZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlZiA9IHJlZi5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0eXBlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBhdGNoZXM6IHBhdGNoZXMsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBwcml2YXRlIF9hZ2dyZWdhdGVJbnZhbGlkQ2FjaGVzKGZyb206IFNsaWNlS2V5LCB0bzogU2xpY2VLZXkpOiBTZXQ8VmVyc2lvbmFibGVNZW1vcnlJRD4ge1xuICAgICAgICBjb25zdCBpbnZhbGlkQ2FjaGUgPSBuZXcgU2V0PG51bWJlcj4oKTtcbiAgICAgICAgaWYgKGZyb20gPT09IHRvKSB7XG4gICAgICAgICAgICByZXR1cm4gaW52YWxpZENhY2hlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFuY2VzdG9yS2V5ID0gdGhpcy5fZ2V0Q29tbW9uQW5jZXN0b3IoZnJvbSwgdG8pO1xuICAgICAgICBjb25zdCByZWZzID0gdGhpcy5fZ2V0Q2hhbmdlc1BhdGgoZnJvbSwgdG8sIGFuY2VzdG9yS2V5KTtcbiAgICAgICAgaWYgKHRoaXMuX3NsaWNlS2V5ID09PSBhbmNlc3RvcktleSkge1xuICAgICAgICAgICAgcmVmcy5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChyZWZzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcmVmID0gcmVmcy5wb3AoKTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlZi5pbnZhbGlkQ2FjaGUpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICAvLyBJdCB3YXMgaW52YWxpZCBiZWZvcmUsIGl0IGlzIHN0aWxsIGludmFsaWQgbm93IHNpbmNlIGl0IHdhc24ndCB5ZXQgcmVhZFxuICAgICAgICAgICAgICAgIGludmFsaWRDYWNoZS5hZGQoK2tleSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW52YWxpZENhY2hlO1xuICAgIH1cbiAgICBwcml2YXRlIF9saW5rVG9NZW1vcnkocHJveHk6IE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHBhcmFtczogVmVyc2lvbmFibGVQYXJhbXMgPSBwcm94eVttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgaWYgKHBhcmFtcy5tZW1vcnkpIHtcbiAgICAgICAgICAgIGlmIChwYXJhbXMubWVtb3J5ICE9PSB0aGlzLl9tZW1vcnlXb3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWVtb3J5RXJyb3IoJ1RoaXMgb2JqZWN0IGlzIGFscmVhZHkgbGlua2VkIHRvIGEgb3RoZXIgbWVtb3J5Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBJRCA9IHBhcmFtcy5JRCBhcyBWZXJzaW9uYWJsZU1lbW9yeUlEO1xuICAgICAgICBwYXJhbXMubWVtb3J5ID0gdGhpcy5fbWVtb3J5V29ya2VyO1xuICAgICAgICBwYXJhbXMubGlua0NhbGxiYWNrKHRoaXMuX21lbW9yeVdvcmtlcik7XG4gICAgICAgIHRoaXMuX3Byb3hpZXNbSURdID0gcHJveHk7XG5cbiAgICAgICAgaWYgKHBhcmFtcy5pc0RpZmZSb290KSB7XG4gICAgICAgICAgICB0aGlzLl9yb290UHJveGllc1tJRF0gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY3VycmVudFNsaWNlLmlkcy5hZGQoK0lEKTtcbiAgICB9XG4gICAgcHJpdmF0ZSBfcmVtb3ZlKHNsaWNlS2V5OiBTbGljZUtleSk6IFNldDxWZXJzaW9uYWJsZU1lbW9yeUlEPiB7XG4gICAgICAgIGNvbnN0IElEcyA9IFtdO1xuICAgICAgICBsZXQgcmVmID0gdGhpcy5fc2xpY2VzW3NsaWNlS2V5XTtcbiAgICAgICAgY29uc3QgaW5kZXggPSByZWYucGFyZW50LmNoaWxkcmVuLmluZGV4T2YocmVmKTtcbiAgICAgICAgcmVmLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgIGNvbnN0IHJlZnMgPSBbcmVmXTtcbiAgICAgICAgd2hpbGUgKChyZWYgPSByZWZzLnBvcCgpKSkge1xuICAgICAgICAgICAgY29uc3Qgc2xpY2VLZXkgPSByZWYubmFtZTtcbiAgICAgICAgICAgIHJlZi5jaGlsZHJlbi5mb3JFYWNoKHJlZiA9PiByZWZzLnB1c2gocmVmKSk7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhyZWYubGlua2VkUGFyZW50T2ZQcm94eSkuZm9yRWFjaChJRCA9PiBJRHMucHVzaCgrSUQpKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9zbGljZXNbc2xpY2VLZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU2V0KElEcyk7XG4gICAgfVxuICAgIHByaXZhdGUgX3NxdWFzaEludG8oXG4gICAgICAgIGZyb21TbGljZUtleTogU2xpY2VLZXksXG4gICAgICAgIHVuaXRTbGljZUtleTogU2xpY2VLZXksXG4gICAgICAgIGludG9TbGljZUtleTogU2xpY2VLZXksXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlZnMgPSB0aGlzLl9zbGljZXM7XG4gICAgICAgIGNvbnN0IGZyb21ScmVmID0gcmVmc1tmcm9tU2xpY2VLZXldO1xuICAgICAgICBjb25zdCB1bnRpbFJyZWYgPSByZWZzW3VuaXRTbGljZUtleV07XG4gICAgICAgIGNvbnN0IGludG9SZWYgPSByZWZzW2ludG9TbGljZUtleV07XG5cbiAgICAgICAgY29uc3QgcmVmZXJlbmNlcyA9IFtdO1xuICAgICAgICBsZXQgcmVmID0gdW50aWxScmVmO1xuICAgICAgICB3aGlsZSAocmVmKSB7XG4gICAgICAgICAgICByZWZlcmVuY2VzLnB1c2gocmVmKTtcbiAgICAgICAgICAgIGlmIChyZWYgPT09IGZyb21ScmVmKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWYgPSByZWYucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVmKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbiBub3QgbWVyZ2UgdGhlIHNsaWNlcycpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaW50b0xpbmtlZFBhcmVudE9mUHJveHkgPSByZWZzW2ludG9TbGljZUtleV0ubGlua2VkUGFyZW50T2ZQcm94eTtcbiAgICAgICAgY29uc3QgaW50b0ludmFsaWRDYWNoZSA9IHJlZnNbaW50b1NsaWNlS2V5XS5pbnZhbGlkQ2FjaGU7XG4gICAgICAgIGNvbnN0IGludG9TbGljZXMgPSBpbnRvUmVmLmRhdGE7XG5cbiAgICAgICAgd2hpbGUgKChyZWYgPSByZWZlcmVuY2VzLnBvcCgpKSkge1xuICAgICAgICAgICAgY29uc3QgTGlua2VkUGFyZW50T2ZQcm94eSA9IHJlZi5saW5rZWRQYXJlbnRPZlByb3h5O1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoTGlua2VkUGFyZW50T2ZQcm94eSkuZm9yRWFjaChJRCA9PiB7XG4gICAgICAgICAgICAgICAgaW50b0xpbmtlZFBhcmVudE9mUHJveHlbSURdID0gTGlua2VkUGFyZW50T2ZQcm94eVtJRF0uc2xpY2UoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhyZWYuaW52YWxpZENhY2hlKS5mb3JFYWNoKGxpbmsgPT4ge1xuICAgICAgICAgICAgICAgIGludG9JbnZhbGlkQ2FjaGVbbGlua10gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHNsaWNlID0gcmVmLmRhdGE7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhzbGljZSkuZm9yRWFjaChJRCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSArSUQ7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVtb3J5SXRlbSA9IHNsaWNlW2lkXTtcbiAgICAgICAgICAgICAgICBpZiAoIWludG9TbGljZXNbaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGludG9TbGljZXNbaWRdID0gbWVtb3J5SXRlbTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWVtb3J5SXRlbSBpbnN0YW5jZW9mIE1lbW9yeVR5cGVBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRvSXRlbSA9IGludG9TbGljZXNbaWRdIGFzIE1lbW9yeVR5cGVBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpbnRvSXRlbS5wYXRjaCwgbWVtb3J5SXRlbS5wYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oaW50b0l0ZW0ucHJvcHMsIG1lbW9yeUl0ZW0ucHJvcHMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtb3J5SXRlbSBpbnN0YW5jZW9mIE1lbW9yeVR5cGVTZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW50b0l0ZW0gPSBpbnRvU2xpY2VzW2lkXSBhcyBNZW1vcnlUeXBlU2V0O1xuICAgICAgICAgICAgICAgICAgICBtZW1vcnlJdGVtLmFkZC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbnRvSXRlbS5kZWxldGUuaGFzKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50b0l0ZW0uYWRkLmFkZChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50b0l0ZW0uZGVsZXRlLmRlbGV0ZShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG1lbW9yeUl0ZW0uZGVsZXRlLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWludG9JdGVtLmFkZC5oYXMoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRvSXRlbS5kZWxldGUuYWRkKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRvSXRlbS5hZGQuZGVsZXRlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRvSXRlbSA9IGludG9TbGljZXNbaWRdIGFzIE1lbW9yeVR5cGVPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oaW50b0l0ZW0ucHJvcHMsIG1lbW9yeUl0ZW0ucHJvcHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgX2F1dG9TbmFwc2hvdCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmVmcyA9IFtdO1xuICAgICAgICBsZXQgcmVmID0gdGhpcy5fY3VycmVudFNsaWNlO1xuICAgICAgICB3aGlsZSAocmVmICYmIHJlZi5uYW1lKSB7XG4gICAgICAgICAgICByZWZzLnB1c2gocmVmKTtcbiAgICAgICAgICAgIHJlZiA9IHJlZi5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlZnMubGVuZ3RoID4gdGhpcy5fbnVtYmVyT2ZGbGF0U2xpY2VzICsgdGhpcy5fbnVtYmVyT2ZTbGljZVBlclNuYXBzaG90KSB7XG4gICAgICAgICAgICBjb25zdCBmcm9tU2xpY2VLZXkgPSByZWZzW3JlZnMubGVuZ3RoIC0gMV0ubmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHVuaXRTbGljZUtleSA9IHJlZnNbcmVmcy5sZW5ndGggLSAxIC0gdGhpcy5fbnVtYmVyT2ZTbGljZVBlclNuYXBzaG90XS5uYW1lO1xuICAgICAgICAgICAgY29uc3QgbmV3U2xpY2VLZXkgPSB1bml0U2xpY2VLZXkgKyAnW3NuYXBzaG90IGZyb20gJyArIGZyb21TbGljZUtleSArICddJztcbiAgICAgICAgICAgIHRoaXMuc25hcHNob3QoZnJvbVNsaWNlS2V5LCB1bml0U2xpY2VLZXksIG5ld1NsaWNlS2V5KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgTWVtb3J5QWxsb3dlZFR5cGUsXG4gICAgTWVtb3J5QWxsb3dlZE9iamVjdFR5cGUsXG4gICAgTWVtb3J5V29ya2VyLFxuICAgIE1lbW9yeVR5cGVBcnJheSxcbiAgICBNZW1vcnlUeXBlT2JqZWN0LFxuICAgIE1lbW9yeVR5cGVTZXQsXG59IGZyb20gJy4vTWVtb3J5JztcbmltcG9ydCB7IF9wcm94aWZ5T2JqZWN0IH0gZnJvbSAnLi9WZXJzaW9uYWJsZU9iamVjdCc7XG5pbXBvcnQgeyBfcHJveGlmeUFycmF5IH0gZnJvbSAnLi9WZXJzaW9uYWJsZUFycmF5JztcbmltcG9ydCB7IF9wcm94aWZ5U2V0IH0gZnJvbSAnLi9WZXJzaW9uYWJsZVNldCc7XG5pbXBvcnQge1xuICAgIG1lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXksXG4gICAgTm90VmVyc2lvbmFibGVFcnJvcixcbiAgICBWZXJzaW9uYWJsZUFsbHJlYWR5VmVyc2lvbmFibGVFcnJvcixcbiAgICBtZW1vcnlQcm94eVByYW1zS2V5LFxufSBmcm9tICcuL2NvbnN0JztcblxuZXhwb3J0IGNsYXNzIFZlcnNpb25hYmxlSUQgZXh0ZW5kcyBOdW1iZXIge31cblZlcnNpb25hYmxlSUQucHJvdG90eXBlW21lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXldID0gdHJ1ZTtcblxubGV0IE1lbW9yeUlEID0gMDtcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVZlcnNpb25hYmxlSUQoKTogVmVyc2lvbmFibGVJRCB7XG4gICAgcmV0dXJuIG5ldyBWZXJzaW9uYWJsZUlEKCsrTWVtb3J5SUQpO1xufVxuXG4vLyBNYWdpYyBtZW1vcnkga2V5IHRoYXQgaXMgc2V0IG9uIHRoZSBvYmplY3QgdGhyb3VnaCBhIHN5bWJvbCAoaW5hY2Nlc3NpYmxlIGZvclxuLy8gb3RoZXJzKS4gSXQgc3RvcmVzIGV2ZXJ5dGhpbmcgdGhhdCBpcyB1c2VmdWwgZm9yIHRoZSBtZW1vcnkgdG8gaGFuZGxlIHRoaXMgb2JqZWN0LlxuZXhwb3J0IGludGVyZmFjZSBWZXJzaW9uYWJsZVBhcmFtcyB7XG4gICAgSUQ6IFZlcnNpb25hYmxlSUQ7IC8vIHByb3h5IGlkIGluIG1lbW9yeS5cbiAgICBtZW1vcnk/OiBNZW1vcnlXb3JrZXI7IC8vIGludGVyZmFjZSBmb3IgdmVyc2lvbmFsZSB0byBhY2Nlc3MgbWVtb3J5IChzaW5jZSB3ZSBkb24ndCB3YW50IHRvIGdpdmUgdGhlbSB0aGUgdHJ1ZSBtZW1vcnkgb2JqZWN0ICEpXG4gICAgcHJveHk6IE1lbW9yeUFsbG93ZWRPYmplY3RUeXBlOyAvLyBwcm94eSBpdHNlbGYgKHdoYXQgd2UgcmV0dXJuLCB3aGF0IHBlb3BsZSBhY3R1YWxseSBtYW5pcHVsYXRlKVxuICAgIG9iamVjdDogTWVtb3J5QWxsb3dlZE9iamVjdFR5cGU7IC8vIE9iamVjdCB0aGF0IGlzIHByb3hpZmllZCAoaXQgaXMgc3luY2hyb25pemVkIHdpdGggdGhlIHByb3h5IGJlY2F1c2UgdGhlIHByb3h5IHVwZGF0ZXMgaXQgYXQgc29tZSBwb2ludHMgLi4uIC0tIG5vdCB0aGUgU2V0ICEpXG4gICAgbGlua0NhbGxiYWNrOiAobWVtb3J5OiBNZW1vcnlXb3JrZXIpID0+IHZvaWQ7IC8vIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGlzIHZlcnNpb25hYmxlIGlzIGxpbmtlZCB0byBhIG1lbW9yeVxuICAgIHN5bmNocm9uaXplOiAoKSA9PiB2b2lkOyAvLyBTeW5jaHJvbml6ZSB0aGUgdmVyc2lvbmFibGUgb2JqZWN0IHdpdGggdGhlIG1lbW9yeSBpbmZvcm1hdGlvbi5cbiAgICB2ZXJpZnk6IChvYmo6IE1lbW9yeUFsbG93ZWRUeXBlKSA9PiBib29sZWFuOyAvLyBWZXJpZnkgaWYgdGhlIGdpdmVuIHByb3h5IG1hdGNoZXMgdGhlIHZlcnNpb25hYmxlIG9iamVjdC5cbiAgICBNZW1vcnlUeXBlOiB0eXBlb2YgTWVtb3J5VHlwZU9iamVjdCB8IHR5cGVvZiBNZW1vcnlUeXBlQXJyYXkgfCB0eXBlb2YgTWVtb3J5VHlwZVNldDtcbiAgICBpc0RpZmZSb290PzogdHJ1ZTsgLy8gaXMgaXQgYSBzdGFuZGFsb25lIG9iamVjdCBvciBkb2VzIGl0IG9ubHkgbWFrZXMgc2Vuc2UgYXMgcGFydCBvZiBhbiBvdGhlciBvYmplY3QncyBzdHJ1Y3R1cmUgP1xufVxuXG4vLyBxdWV1ZSBvZiBzdHVmZiB0byBwcm94aWZ5XG5jb25zdCB0b1Byb3hpZnkgPSBuZXcgTWFwPE1lbW9yeUFsbG93ZWRUeXBlLCBBcnJheTwocHJveHk6IE1lbW9yeUFsbG93ZWRUeXBlKSA9PiB2b2lkPj4oKTtcblxuLyoqXG4gKiBUYWtlIGFuIG9iamVjdCBhbmQgcmV0dXJuIGEgdmVyc2lvbmFibGUgcHJveHkgdG8gdGhpcyBvYmplY3QuXG4gKlxuICogQHBhcmFtIG9iamVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZVZlcnNpb25hYmxlPFQgZXh0ZW5kcyBNZW1vcnlBbGxvd2VkVHlwZT4ob2JqZWN0OiBUKTogVCB7XG4gICAgY29uc3QgcGFyYW1zID0gb2JqZWN0W21lbW9yeVByb3h5UHJhbXNLZXldIGFzIFZlcnNpb25hYmxlUGFyYW1zO1xuICAgIGlmIChwYXJhbXMpIHtcbiAgICAgICAgaWYgKHBhcmFtcy5vYmplY3QgPT09IG9iamVjdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFZlcnNpb25hYmxlQWxscmVhZHlWZXJzaW9uYWJsZUVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMudmVyaWZ5KG9iamVjdCkpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcHJveHkgPSBfcHJveGlmeShvYmplY3QpO1xuICAgIHRvUHJveGlmeS5mb3JFYWNoKChjYWxsYmFja3MsIHRvcm90b3RvKSA9PiB7XG4gICAgICAgIHRvUHJveGlmeS5kZWxldGUodG9yb3RvdG8pO1xuICAgICAgICBjb25zdCBwcm94eSA9IF9wcm94aWZ5KHRvcm90b3RvKTtcbiAgICAgICAgY2FsbGJhY2tzLmZvckVhY2goY2FsbGJhY2sgPT4gY2FsbGJhY2socHJveHkpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcHJveHk7XG59XG4vKipcbiAqIENyZWF0ZSBhIHByb3h5IGZyb20gYSB2ZXJzaW9uYWJsZSB3aXRoIGdpdmVuIGhhbmRsZXIuXG4gKlxuICogQHBhcmFtIHZlcnNpb25hYmxlXG4gKiBAcGFyYW0gaGFuZGxlclxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJveGlmeVZlcnNpb25hYmxlPFQgZXh0ZW5kcyBNZW1vcnlBbGxvd2VkVHlwZT4oXG4gICAgdmVyc2lvbmFibGU6IFQsXG4gICAgaGFuZGxlcjogUHJveHlIYW5kbGVyPG9iamVjdD4sXG4pOiBUIHtcbiAgICBjb25zdCBuZXdQcm94eSA9IG5ldyBQcm94eSh2ZXJzaW9uYWJsZSBhcyBvYmplY3QsIGhhbmRsZXIpO1xuICAgIHZlcnNpb25hYmxlW21lbW9yeVByb3h5UHJhbXNLZXldLnByb3h5ID0gbmV3UHJveHk7XG4gICAgcmV0dXJuIG5ld1Byb3h5IGFzIFQ7XG59XG4vKipcbiAqIE1hcmsgdGhlIGN1cnJlbnQgb2JqZWN0IGFzIG5vdCB2ZXJzaW9uYWJsZSBpbiBtZW1vcnkuXG4gKiBBIG5vbiB2ZXJzaW9uYWJsZSBvYmplY3QgaXMgbm90IGxpbmtlZCB0byB0aGUgbWVtb3J5LiBUaGUgbWVtb3J5IGRvZXMgbm90XG4gKiB0YWtlIGNhcmUgb2YgdGhlIGNoYW5nZSBpbnNpZGUgdGhpcyBvYmplY3QsIGFuZCB0aGlzIG9iamVjdCBpcyBuZXJ2ZXJcbiAqIGltbXV0YWJsZS5cbiAqXG4gKiBAcGFyYW0gb2JqZWN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXJrTm90VmVyc2lvbmFibGUob2JqZWN0OiBNZW1vcnlBbGxvd2VkVHlwZSk6IHZvaWQge1xuICAgIG9iamVjdFttZW1vcnlQcm94eU5vdFZlcnNpb25hYmxlS2V5XSA9IHRydWU7XG59XG4vKipcbiAqIFRocm93IGFuIGVycm9yIGlmIHRoZSBnaXZlbiBvYmplY3QgaXMgbm90IGEgdmVyc2lvbmFibGUuXG4gKlxuICogQHBhcmFtIG9iamVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gX2NoZWNrVmVyc2lvbmFibGU8VCBleHRlbmRzIE1lbW9yeUFsbG93ZWRUeXBlPihvYmplY3Q6IFQpOiB2b2lkIHtcbiAgICBpZiAoXG4gICAgICAgIHR5cGVvZiBvYmplY3QgIT09ICdvYmplY3QnIHx8XG4gICAgICAgIG9iamVjdCA9PT0gbnVsbCB8fFxuICAgICAgICBvYmplY3RbbWVtb3J5UHJveHlOb3RWZXJzaW9uYWJsZUtleV0gLy8gdGhpcyBpcyBzZXQgYnkgdGhlIHVzZXJcbiAgICApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtcyA9IG9iamVjdFttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgIGlmIChwYXJhbXMub2JqZWN0ID09PSBvYmplY3QpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBWZXJzaW9uYWJsZUFsbHJlYWR5VmVyc2lvbmFibGVFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMudmVyaWZ5KG9iamVjdCkpIHtcbiAgICAgICAgICAgIC8vIEFscmVhZHkgdmVyc2lvbmVkICEgKHdlIGNvdWxkIGhhdmUgaW5oZXJpdGVkIGZyb20gdGhlIGBwYXJhbXNgIG9mXG4gICAgICAgICAgICAvLyBhbm90aGVyLCBhbHJlYWR5IHZlcnNpb25lZCBvYmplY3QsIGJ1dCB3ZSBtaWdodCBub3QpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgTm90VmVyc2lvbmFibGVFcnJvcigpO1xufVxuLy8gUmVjdXJzaXZlIHByb3hpZmljYXRpb24gaXMgdmVyeSBsaW1pdGVkIGJlY2F1c2Ugb2YgY2FsbGJhY2sgZGVwdGguIFRvXG4vLyBjaXJjdW12ZW50IHRoaXMgaXNzdWUsIHdlIHF1ZXVlIHRoZSBwcm94aWZpY2F0aW9uIG9mIGNoaWxkcmVuLlxuZXhwb3J0IGZ1bmN0aW9uIF9zdGFja2VkUHJveGlmeTxUIGV4dGVuZHMgTWVtb3J5QWxsb3dlZFR5cGU+KFxuICAgIGN1c3RvbUNsYXNzOiBULFxuICAgIGNhbGxiYWNrOiAocHJveHk6IFQpID0+IHZvaWQsXG4pOiB2b2lkIHtcbiAgICBpZiAoXG4gICAgICAgICFjdXN0b21DbGFzcyB8fFxuICAgICAgICB0eXBlb2YgY3VzdG9tQ2xhc3MgIT09ICdvYmplY3QnIHx8XG4gICAgICAgIGN1c3RvbUNsYXNzW21lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXldXG4gICAgKSB7XG4gICAgICAgIGNhbGxiYWNrKGN1c3RvbUNsYXNzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBwYXJhbXMgPSBjdXN0b21DbGFzc1ttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgIGNhbGxiYWNrKHBhcmFtcy5wcm94eSk7XG4gICAgfVxuICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRvUHJveGlmeS5nZXQoY3VzdG9tQ2xhc3MpIHx8IFtdO1xuICAgIHRvUHJveGlmeS5zZXQoY3VzdG9tQ2xhc3MsIGNhbGxiYWNrcyk7XG4gICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xufVxuXG5mdW5jdGlvbiBfcHJveGlmeTxUIGV4dGVuZHMgTWVtb3J5QWxsb3dlZFR5cGU+KGN1c3RvbUNsYXNzOiBUKTogVCB7XG4gICAgY29uc3QgcGFyYW1zID0gY3VzdG9tQ2xhc3NbbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMudmVyaWZ5KGN1c3RvbUNsYXNzKSkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLnByb3h5O1xuICAgIH1cbiAgICBsZXQgcHJveHk6IFQ7XG4gICAgaWYgKGN1c3RvbUNsYXNzIGluc3RhbmNlb2YgU2V0KSB7XG4gICAgICAgIHByb3h5ID0gX3Byb3hpZnlTZXQoY3VzdG9tQ2xhc3MpIGFzIFQ7XG4gICAgfSBlbHNlIGlmIChjdXN0b21DbGFzcyBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHByb3h5ID0gX3Byb3hpZnlBcnJheShjdXN0b21DbGFzcykgYXMgVDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm94eSA9IF9wcm94aWZ5T2JqZWN0KGN1c3RvbUNsYXNzIGFzIFJlY29yZDxzdHJpbmcsIE1lbW9yeUFsbG93ZWRUeXBlPikgYXMgVDtcbiAgICB9XG4gICAgcmV0dXJuIHByb3h5O1xufVxuIiwiaW1wb3J0IHtcbiAgICBNZW1vcnlBbGxvd2VkVHlwZSxcbiAgICBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMsXG4gICAgTWVtb3J5V29ya2VyLFxuICAgIE1lbW9yeVR5cGUsXG4gICAgTWVtb3J5VHlwZUFycmF5LFxuICAgIE1lbW9yeUFycmF5Q29tcGlsZWRXaXRoUGF0Y2gsXG59IGZyb20gJy4vTWVtb3J5JztcbmltcG9ydCB7IFZlcnNpb25hYmxlSUQsIF9jaGVja1ZlcnNpb25hYmxlLCBWZXJzaW9uYWJsZVBhcmFtcyB9IGZyb20gJy4vVmVyc2lvbmFibGUnO1xuaW1wb3J0IHtcbiAgICByZW1vdmVkSXRlbSxcbiAgICBtZW1vcnlQcm94eVByYW1zS2V5LFxuICAgIG1lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXksXG4gICAgRnJvemVuRXJyb3IsXG59IGZyb20gJy4vY29uc3QnO1xuaW1wb3J0IHtcbiAgICBfcHJveGlmeU9iamVjdCxcbiAgICBHZXR0ZXJzU2V0dGVycyxcbiAgICBQcm94eU9iamVjdEhhbmRsZXIsXG4gICAgcHJveHlPYmplY3RIYW5kbGVyLFxuICAgIGtleVR5cGUsXG59IGZyb20gJy4vVmVyc2lvbmFibGVPYmplY3QnO1xuXG50eXBlIHVuaXFTZWMgPSBudW1iZXJbXTtcbnR5cGUgdW5pcUlEID0gc3RyaW5nO1xudHlwZSB1bmlxSURNZW1vcnlUeXBlVmFsdWVzID0gUmVjb3JkPHVuaXFJRCwgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzPjtcblxuY29uc3QgVW5kZWZpbmVkID0gU3ltYm9sKCdqYWJiZXJ3b2NrTWVtb3J5VW5kZWZpbmVkJyk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXJyYXlQYXJhbXMgZXh0ZW5kcyBWZXJzaW9uYWJsZVBhcmFtcyB7XG4gICAgdW5pcUlEczogdW5pcUlEW107XG4gICAgc2VxdWVuY2VzOiB1bmlxSURbXTtcbiAgICBwcm94eTogTWVtb3J5QWxsb3dlZFR5cGVbXTtcbiAgICBvYmplY3Q6IE1lbW9yeUFsbG93ZWRUeXBlW107XG4gICAgbWFwOiBNYXA8TWVtb3J5QWxsb3dlZFR5cGUsIHVuaXFJRD47XG4gICAgc3luY1NsaWNlPzogUmVjb3JkPG51bWJlciwgTWVtb3J5VHlwZT47XG4gICAgcHJldmlvdXNTbGljZVZhbHVlcz86IHVuaXFJRE1lbW9yeVR5cGVWYWx1ZXM7XG4gICAgcHJvdG86IEdldHRlcnNTZXR0ZXJzO1xufVxuXG5jb25zdCBwcm94eUFycmF5SGFuZGxlciA9IHtcbiAgICBnZXQoYXJyYXk6IE1lbW9yeUFsbG93ZWRUeXBlW10sIHByb3A6IGtleVR5cGUsIHByb3h5OiBvYmplY3QpOiBNZW1vcnlBbGxvd2VkVHlwZSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N5bWJvbCcgfHwgIWlzTmFOKHByb3AgYXMgbnVtYmVyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGFycmF5W3Byb3BdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IGFycmF5W21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICBpZiAoIXBhcmFtcy5tZW1vcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBhcnJheVtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHByb3ApIHtcbiAgICAgICAgICAgIGNhc2UgJ2luZGV4T2YnOlxuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleE9mLmJpbmQocHJveHksIHBhcmFtcyk7XG4gICAgICAgICAgICBjYXNlICdpbmNsdWRlcyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluY2x1ZGVzLmJpbmQocHJveHksIHBhcmFtcyk7XG4gICAgICAgICAgICBjYXNlICdzcGxpY2UnOlxuICAgICAgICAgICAgICAgIHJldHVybiBzcGxpY2UuYmluZChwcm94eSwgcGFyYW1zKTtcbiAgICAgICAgICAgIGNhc2UgJ3B1c2gnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheVtwcm9wXTtcbiAgICAgICAgICAgIGNhc2UgJ3Vuc2hpZnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB1bnNoaWZ0LmJpbmQocHJveHksIHBhcmFtcyk7XG4gICAgICAgICAgICBjYXNlICdzaGlmdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNoaWZ0LmJpbmQocHJveHksIHBhcmFtcyk7XG4gICAgICAgICAgICBjYXNlICdwb3AnOlxuICAgICAgICAgICAgICAgIHJldHVybiBwb3AuYmluZChwcm94eSwgcGFyYW1zKTtcbiAgICAgICAgICAgIGNhc2UgJ2ZvckVhY2gnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JFYWNoLmJpbmQocHJveHksIHBhcmFtcyk7XG4gICAgICAgICAgICBjYXNlICdtYXAnOlxuICAgICAgICAgICAgICAgIHJldHVybiBtYXAuYmluZChwcm94eSwgcGFyYW1zKTtcbiAgICAgICAgICAgIGNhc2UgJ2ZpbHRlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlci5iaW5kKHByb3h5LCBwYXJhbXMpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXlbcHJvcF07XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHNldChcbiAgICAgICAgcHJveHlPYmplY3Q6IE1lbW9yeUFsbG93ZWRUeXBlW10sXG4gICAgICAgIHByb3A6IGtleVR5cGUsXG4gICAgICAgIHZhbHVlOiBNZW1vcnlBbGxvd2VkVHlwZSxcbiAgICAgICAgcHJveHk6IG9iamVjdCxcbiAgICApOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgcGFyYW1zOiBBcnJheVBhcmFtcyA9IHByb3h5T2JqZWN0W21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICBjb25zdCBhcnJheSA9IHBhcmFtcy5vYmplY3Q7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHR5cGVvZiBwcm9wID09PSAnc3ltYm9sJyB8fFxuICAgICAgICAgICAgIXBhcmFtcy5tZW1vcnkgfHxcbiAgICAgICAgICAgIChwcm9wICE9PSAnbGVuZ3RoJyAmJiBpc05hTihwcm9wIGFzIG51bWJlcikpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIHByb3h5T2JqZWN0SGFuZGxlci5zZXQoYXJyYXksIHByb3AsIHZhbHVlLCBwcm94eSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpbmRleCA9ICtwcm9wO1xuICAgICAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuICAgICAgICBpZiAobWVtb3J5LmlzRnJvemVuKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBGcm96ZW5FcnJvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSBhcnJheVtwcm9wXTtcbiAgICAgICAgaWYgKG9sZFZhbHVlID09PSB2YWx1ZSB8fCAodmFsdWUgPT09IHJlbW92ZWRJdGVtICYmICEocHJvcCBpbiBhcnJheSkpKSB7XG4gICAgICAgICAgICAvLyBubyBjaGFuZ2VcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2xpY2UgPSBtZW1vcnkuZ2V0U2xpY2UoKTtcbiAgICAgICAgbGV0IG1lbW9yeUFycmF5ID0gc2xpY2VbcGFyYW1zLklEIGFzIG51bWJlcl0gYXMgTWVtb3J5VHlwZUFycmF5O1xuICAgICAgICBpZiAoIW1lbW9yeUFycmF5KSB7XG4gICAgICAgICAgICBzbGljZVtwYXJhbXMuSUQgYXMgbnVtYmVyXSA9IG1lbW9yeUFycmF5ID0gbmV3IHBhcmFtcy5NZW1vcnlUeXBlKCkgYXMgTWVtb3J5VHlwZUFycmF5O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzbGljZSAhPT0gcGFyYW1zLnN5bmNTbGljZSkge1xuICAgICAgICAgICAgLy8gYWxscmVhZHkgc3luYywgdGhlIGN1cnJlbnQgdmFsdWUgKGJlZm9yZSB1cGRhdGUpIGlzIHRoZSBwcmV2aW91cyB2YWx1ZVxuICAgICAgICAgICAgcGFyYW1zLnN5bmNTbGljZSA9IHNsaWNlO1xuICAgICAgICAgICAgcGFyYW1zLnByZXZpb3VzU2xpY2VWYWx1ZXMgPSB7fTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goKHZhbHVlOiBNZW1vcnlBbGxvd2VkVHlwZSwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgIHBhcmFtcy5wcmV2aW91c1NsaWNlVmFsdWVzW3BhcmFtcy51bmlxSURzW2luZGV4XV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByb3AgPT09ICdsZW5ndGgnKSB7XG4gICAgICAgICAgICBjb25zdCBsZW5ndGggPSArKHZhbHVlIGFzIG51bWJlcik7XG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IGxlbmd0aDsgaW5kZXggPCBhcnJheS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBhcnJheVtpbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkUGFyYW1zID0gdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgJiYgdmFsW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICAgICAgICAgIGlmIChvbGRQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5LmRlbGV0ZVNsaWNlUHJveHlQYXJlbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRQYXJhbXMuSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnwrQnICsgcGFyYW1zLnVuaXFJRHNbaW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB1aWQgPSBwYXJhbXMudW5pcUlEc1tpbmRleF07XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMucHJldmlvdXNTbGljZVZhbHVlc1t1aWRdID09PSByZW1vdmVkSXRlbSB8fFxuICAgICAgICAgICAgICAgICAgICAhKHVpZCBpbiBwYXJhbXMucHJldmlvdXNTbGljZVZhbHVlcylcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG1lbW9yeUFycmF5LnBhdGNoW3VpZF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5QXJyYXkucGF0Y2hbdWlkXSA9IHJlbW92ZWRJdGVtO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFycmF5Lmxlbmd0aCA9IGxlbmd0aDtcbiAgICAgICAgICAgIG1lbW9yeS5tYXJrRGlydHkocGFyYW1zLklEKTsgLy8gbWFyayB0aGUgY2FjaGUgYXMgaW52YWxpZCB3aGVuIGNoYW5nZSB0aGUgc2xpZGUgbWVtb3J5XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBuZXdQYXJhbXM6IFZlcnNpb25hYmxlUGFyYW1zO1xuICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAhdmFsdWVbbWVtb3J5UHJveHlOb3RWZXJzaW9uYWJsZUtleV0pIHtcbiAgICAgICAgICAgIF9jaGVja1ZlcnNpb25hYmxlKHZhbHVlKTtcbiAgICAgICAgICAgIG1lbW9yeS5saW5rVG9NZW1vcnkodmFsdWUgYXMgb2JqZWN0KTtcbiAgICAgICAgICAgIG5ld1BhcmFtcyA9IHZhbHVlW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICB9XG5cbiAgICAgICAgYXJyYXlbcHJvcF0gPSB2YWx1ZTtcblxuICAgICAgICBpZiAob2xkVmFsdWUgPT09IFVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgdWlkID0gcGFyYW1zLnVuaXFJRHNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKG5ld1BhcmFtcykge1xuICAgICAgICAgICAgICAgIG1lbW9yeUFycmF5LnBhdGNoW3VpZF0gPSBuZXdQYXJhbXMuSUQ7XG4gICAgICAgICAgICAgICAgbWVtb3J5LmFkZFNsaWNlUHJveHlQYXJlbnQobmV3UGFyYW1zLklELCBwYXJhbXMuSUQsICfCtCcgKyB1aWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZW1vcnlBcnJheS5wYXRjaFt1aWRdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJhbXMubWFwLnNldCh2YWx1ZSwgdWlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHVuaXFJRHMgPSBwYXJhbXMudW5pcUlEcztcbiAgICAgICAgICAgIGNvbnN0IHVpZCA9IHVuaXFJRHNbaW5kZXhdO1xuXG4gICAgICAgICAgICAvLyBiZWdpbiB3aXRoIHJlbW92ZSBwcmV2aW91c1xuXG4gICAgICAgICAgICBpZiAodWlkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFwVUlEID0gcGFyYW1zLm1hcC5nZXQob2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChtYXBVSUQgPT09IHVpZCkge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMubWFwLmRlbGV0ZShvbGRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG90aGVySW5kZXggPSBhcnJheS5pbmRleE9mKG9sZFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG90aGVySW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubWFwLnNldChvbGRWYWx1ZSwgdW5pcUlEc1tvdGhlckluZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMucHJldmlvdXNTbGljZVZhbHVlc1t1aWRdID09PSByZW1vdmVkSXRlbSB8fFxuICAgICAgICAgICAgICAgICAgICAhKHVpZCBpbiBwYXJhbXMucHJldmlvdXNTbGljZVZhbHVlcylcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG1lbW9yeUFycmF5LnBhdGNoW3VpZF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5QXJyYXkucGF0Y2hbdWlkXSA9IHJlbW92ZWRJdGVtO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IG9sZFBhcmFtcyA9XG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlICYmIHR5cGVvZiBvbGRWYWx1ZSA9PT0gJ29iamVjdCcgJiYgb2xkVmFsdWVbbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgICAgICAgICAgICAgaWYgKG9sZFBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICBtZW1vcnkuZGVsZXRlU2xpY2VQcm94eVBhcmVudChvbGRQYXJhbXMuSUQsIHBhcmFtcy5JRCwgJ8K0JyArIHVpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IHJlbW92ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgbWVtb3J5Lm1hcmtEaXJ0eShwYXJhbXMuSUQpOyAvLyBtYXJrIHRoZSBjYWNoZSBhcyBpbnZhbGlkIHdoZW4gY2hhbmdlIHRoZSBzbGlkZSBtZW1vcnlcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYW5kIHRoZW4gd2UgYWRkIGl0ZW1cblxuICAgICAgICAgICAgaWYgKCF1aWQgJiYgaW5kZXggPiB1bmlxSURzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIGFkZCBmYWtlIHVuZGVmaW5lZCB2YWx1ZXMgKGRvbid0IGFkZCB1bmRlZmluZWQgaW4gYXJyYXkpXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IHVuaXFJRHMubGVuZ3RoOyBrIDwgaW5kZXg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdVbmlxSUQgPSBnZW5lcmF0ZVVpZChwYXJhbXMuc2VxdWVuY2VzLCB1bmlxSURzW2sgLSAxXSk7XG4gICAgICAgICAgICAgICAgICAgIHVuaXFJRHMucHVzaChuZXdVbmlxSUQpO1xuICAgICAgICAgICAgICAgICAgICBtZW1vcnlBcnJheS5wYXRjaFtuZXdVbmlxSURdID0gVW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaXNFbmQgPSBpbmRleCA+PSB1bmlxSURzLmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IG5lYXJlc3QgPSBpc0VuZCA/IHVuZGVmaW5lZCA6IHVuaXFJRHNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgbmV3VW5pcUlEID0gZ2VuZXJhdGVVaWQocGFyYW1zLnNlcXVlbmNlcywgbmVhcmVzdCwgaXNFbmQpO1xuICAgICAgICAgICAgdW5pcUlEc1tpbmRleF0gPSBuZXdVbmlxSUQ7XG5cbiAgICAgICAgICAgIGlmIChuZXdQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBtZW1vcnkuYWRkU2xpY2VQcm94eVBhcmVudChuZXdQYXJhbXMuSUQsIHBhcmFtcy5JRCwgJ8K0JyArIG5ld1VuaXFJRCk7XG4gICAgICAgICAgICAgICAgbWVtb3J5QXJyYXkucGF0Y2hbbmV3VW5pcUlEXSA9IG5ld1BhcmFtcy5JRDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVtb3J5QXJyYXkucGF0Y2hbbmV3VW5pcUlEXSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFwYXJhbXMubWFwLmhhcyhvbGRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMubWFwLnNldCh2YWx1ZSwgbmV3VW5pcUlEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG1lbW9yeS5tYXJrRGlydHkocGFyYW1zLklEKTsgLy8gbWFyayB0aGUgY2FjaGUgYXMgaW52YWxpZCB3aGVuIGNoYW5nZSB0aGUgc2xpZGUgbWVtb3J5XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgZGVsZXRlUHJvcGVydHkob2JqOiBvYmplY3QsIHByb3A6IGtleVR5cGUpOiBib29sZWFuIHtcbiAgICAgICAgLy8gYHJlbW92ZWRJdGVtYCBpcyBhIG1hcmtlciB0byBub3RpZnkgdGhhdCB0aGVyZSB3YXMgc29tZXRoaW5nIGhlcmUgYnV0XG4gICAgICAgIC8vIGl0IGdvdCByZW1vdmVkXG4gICAgICAgIHRoaXMuc2V0KG9iaiwgcHJvcCwgcmVtb3ZlZEl0ZW0pO1xuICAgICAgICBkZWxldGUgb2JqW3Byb3BdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxufSBhcyBQcm94eU9iamVjdEhhbmRsZXI7XG5cbmV4cG9ydCBmdW5jdGlvbiBfcHJveGlmeUFycmF5PFQgZXh0ZW5kcyBNZW1vcnlBbGxvd2VkVHlwZT4oYXJyYXk6IFRbXSk6IFRbXSB7XG4gICAgY29uc3QgcHJveHlPYmplY3QgPSBfcHJveGlmeU9iamVjdChhcnJheSk7XG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkocHJveHlPYmplY3QsIHByb3h5QXJyYXlIYW5kbGVyKSBhcyBUW107XG4gICAgY29uc3QgcGFyYW1zID0gcHJveHlPYmplY3RbbWVtb3J5UHJveHlQcmFtc0tleV0gYXMgQXJyYXlQYXJhbXM7XG4gICAgcGFyYW1zLnByb3h5ID0gcHJveHk7XG4gICAgcGFyYW1zLmxpbmtDYWxsYmFjayA9IGxpbmtWZXJzaW9uYWJsZTtcbiAgICBwYXJhbXMuTWVtb3J5VHlwZSA9IE1lbW9yeVR5cGVBcnJheTtcbiAgICBwYXJhbXMubWFwID0gbmV3IE1hcCgpO1xuICAgIHBhcmFtcy51bmlxSURzID0gW107XG4gICAgcGFyYW1zLnNlcXVlbmNlcyA9IFtdO1xuICAgIHJldHVybiBwcm94eTtcbn1cblxuZnVuY3Rpb24gdW5zaGlmdChwYXJhbXM6IEFycmF5UGFyYW1zLCAuLi5pdGVtczogTWVtb3J5QWxsb3dlZFR5cGVbXSk6IG51bWJlciB7XG4gICAgZm9yIChsZXQgayA9IDAsIGxlbiA9IGl0ZW1zLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1trXTtcbiAgICAgICAgcGFyYW1zLm9iamVjdC51bnNoaWZ0KFVuZGVmaW5lZCk7XG4gICAgICAgIHBhcmFtcy51bmlxSURzLnVuc2hpZnQoZ2VuZXJhdGVVaWQocGFyYW1zLnNlcXVlbmNlcywgdW5kZWZpbmVkKSk7XG4gICAgICAgIHRoaXNbMF0gPSBpdGVtO1xuICAgIH1cbiAgICByZXR1cm4gcGFyYW1zLm9iamVjdC5sZW5ndGg7XG59XG5mdW5jdGlvbiBzaGlmdChwYXJhbXM6IEFycmF5UGFyYW1zKTogTWVtb3J5QWxsb3dlZFR5cGUge1xuICAgIGNvbnN0IHZhbHVlID0gcGFyYW1zLm9iamVjdFswXTtcbiAgICB0aGlzWycwJ10gPSByZW1vdmVkSXRlbTtcbiAgICBwYXJhbXMub2JqZWN0LnNoaWZ0KCk7XG4gICAgcGFyYW1zLnVuaXFJRHMuc2hpZnQoKTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBwb3AocGFyYW1zOiBBcnJheVBhcmFtcyk6IE1lbW9yeUFsbG93ZWRUeXBlIHtcbiAgICBjb25zdCBsYXN0SW5kZXggPSBwYXJhbXMub2JqZWN0Lmxlbmd0aCAtIDE7XG4gICAgY29uc3QgdmFsdWUgPSBwYXJhbXMub2JqZWN0W2xhc3RJbmRleF07XG4gICAgdGhpcy5sZW5ndGggPSBsYXN0SW5kZXg7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gc3BsaWNlKFxuICAgIHBhcmFtczogQXJyYXlQYXJhbXMsXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICBuYjogbnVtYmVyLFxuICAgIC4uLml0ZW1zOiBNZW1vcnlBbGxvd2VkVHlwZVtdXG4pOiBNZW1vcnlBbGxvd2VkVHlwZVtdIHtcbiAgICBjb25zdCBhcnJheSA9IHBhcmFtcy5vYmplY3Q7XG4gICAgY29uc3QgdW5pcUlEcyA9IHBhcmFtcy51bmlxSURzO1xuICAgIGNvbnN0IGxlbiA9IGFycmF5Lmxlbmd0aDtcbiAgICBpZiAobmIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBuYiA9IGxlbiAtIGluZGV4O1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZTogTWVtb3J5QWxsb3dlZFR5cGVbXSA9IG5ldyAoYXJyYXkuY29uc3RydWN0b3IgYXMgdHlwZW9mIEFycmF5KSgpO1xuICAgIGlmIChuYiA+IDApIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuYjsgaSsrKSB7XG4gICAgICAgICAgICB2YWx1ZS5wdXNoKGFycmF5W2kgKyBpbmRleF0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmI7IGkrKykge1xuICAgICAgICAgICAgdGhpc1soaSArIGluZGV4KS50b1N0cmluZygpXSA9IHJlbW92ZWRJdGVtO1xuICAgICAgICB9XG4gICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgbmIpO1xuICAgICAgICB1bmlxSURzLnNwbGljZShpbmRleCwgbmIpO1xuICAgIH1cbiAgICBmb3IgKGxldCBrZXkgPSAwLCBsZW4gPSBpdGVtcy5sZW5ndGg7IGtleSA8IGxlbjsga2V5KyspIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2tleV07XG4gICAgICAgIGNvbnN0IGkgPSBrZXkgKyBpbmRleDtcbiAgICAgICAgYXJyYXkuc3BsaWNlKGksIDAsIFVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IG5lYXJlc3QgPSB1bmlxSURzW2kgLSAxXTtcbiAgICAgICAgdW5pcUlEcy5zcGxpY2UoaSwgMCwgZ2VuZXJhdGVVaWQocGFyYW1zLnNlcXVlbmNlcywgbmVhcmVzdCkpO1xuICAgICAgICB0aGlzW2ldID0gaXRlbTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gZm9yRWFjaChcbiAgICBwYXJhbXM6IEFycmF5UGFyYW1zLFxuICAgIGNhbGxiYWNrOiAodmFsdWU6IE1lbW9yeUFsbG93ZWRUeXBlLCBpbmRleDogbnVtYmVyLCBhcnJheTogTWVtb3J5QWxsb3dlZFR5cGVbXSkgPT4gdm9pZCxcbik6IHZvaWQge1xuICAgIGNvbnN0IGFycmF5ID0gcGFyYW1zLm9iamVjdDtcbiAgICBmb3IgKGxldCBpbmRleCA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaW5kZXggPCBsZW47IGluZGV4KyspIHtcbiAgICAgICAgY2FsbGJhY2soYXJyYXlbaW5kZXhdLCBpbmRleCwgdGhpcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbWFwKFxuICAgIHBhcmFtczogQXJyYXlQYXJhbXMsXG4gICAgY2FsbGJhY2s6IChcbiAgICAgICAgdmFsdWU6IE1lbW9yeUFsbG93ZWRUeXBlLFxuICAgICAgICBpbmRleDogbnVtYmVyLFxuICAgICAgICBhcnJheTogTWVtb3J5QWxsb3dlZFR5cGVbXSxcbiAgICApID0+IE1lbW9yeUFsbG93ZWRUeXBlLFxuKTogTWVtb3J5QWxsb3dlZFR5cGVbXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgY29uc3QgYXJyYXkgPSBwYXJhbXMub2JqZWN0O1xuICAgIGZvciAobGV0IGluZGV4ID0gMCwgbGVuID0gYXJyYXkubGVuZ3RoOyBpbmRleCA8IGxlbjsgaW5kZXgrKykge1xuICAgICAgICByZXN1bHQucHVzaChjYWxsYmFjayhhcnJheVtpbmRleF0sIGluZGV4LCB0aGlzKSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBmaWx0ZXIoXG4gICAgcGFyYW1zOiBBcnJheVBhcmFtcyxcbiAgICBjYWxsYmFjazogKHZhbHVlOiBNZW1vcnlBbGxvd2VkVHlwZSwgaW5kZXg6IG51bWJlciwgYXJyYXk6IE1lbW9yeUFsbG93ZWRUeXBlW10pID0+IGJvb2xlYW4sXG4pOiBNZW1vcnlBbGxvd2VkVHlwZVtdIHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBjb25zdCBhcnJheSA9IHBhcmFtcy5vYmplY3Q7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCB0aGlzKSkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBpbmRleE9mKHBhcmFtczogQXJyYXlQYXJhbXMsIGl0ZW06IE1lbW9yeUFsbG93ZWRUeXBlKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGFyYW1zLm9iamVjdC5pbmRleE9mKGl0ZW0pO1xufVxuZnVuY3Rpb24gaW5jbHVkZXMocGFyYW1zOiBBcnJheVBhcmFtcywgaXRlbTogTWVtb3J5QWxsb3dlZFR5cGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcGFyYW1zLm9iamVjdC5pbmNsdWRlcyhpdGVtKTtcbn1cbmZ1bmN0aW9uIHByb3hpZnlTeW5jQXJyYXkoKTogeyBjb21waWxlZDogdW5pcUlETWVtb3J5VHlwZVZhbHVlczsgc2VxdWVuY2VzOiB1bmlxSURbXSB9IHtcbiAgICAvLyBTeW5jaHJvbml6YXRpb24gZnVuY3Rpb25cbiAgICAvLyBNb3N0IG1ldGhvZHMgb2YgdGhlIFwicHJveHlcIiB3aWxsIGNhbGwgdGhpcyBzeW5jaHJvbml6YXRpb24gZnVuY3Rpb24sIGV2ZW5cbiAgICAvLyBpZiBpdCBpcyBub3QgeWV0IGxpbmtlZCB0byBhIG1lbW9yeSAhXG4gICAgY29uc3QgcGFyYW1zID0gdGhpcyBhcyBBcnJheVBhcmFtcztcbiAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuICAgIC8vIGVtcHRpZXMgdGhlIGFycmF5XG4gICAgcGFyYW1zLnVuaXFJRHMubGVuZ3RoID0gMDtcbiAgICBwYXJhbXMub2JqZWN0Lmxlbmd0aCA9IDA7XG4gICAgLy8gQ2xlYXIgcHJvcHNcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocGFyYW1zLm9iamVjdCk7XG4gICAgbGV0IGtleTogc3RyaW5nO1xuICAgIHdoaWxlICgoa2V5ID0ga2V5cy5wb3AoKSkpIHtcbiAgICAgICAgZGVsZXRlIHBhcmFtcy5vYmplY3Rba2V5XTtcbiAgICB9XG4gICAgY29uc3QgcmF3VmFsdWVzID0gbWVtb3J5LmdldFNsaWNlVmFsdWUocGFyYW1zLklEKSBhcyBNZW1vcnlBcnJheUNvbXBpbGVkV2l0aFBhdGNoO1xuXG4gICAgaWYgKCFyYXdWYWx1ZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QuYXNzaWduKHt9LCByYXdWYWx1ZXMuY29tcGlsZWRWYWx1ZXMsIHJhd1ZhbHVlcy5uZXdWYWx1ZXMucGF0Y2gpO1xuICAgIGNvbnN0IHNlcXVlbmNlcyA9IE9iamVjdC5rZXlzKHZhbHVlcyk7XG4gICAgc2VxdWVuY2VzLnNvcnQoKTtcbiAgICBwcm94aWZ5U3luY0FycmF5SXRlbXMobWVtb3J5LCBzZXF1ZW5jZXMsIHZhbHVlcywgcGFyYW1zLm9iamVjdCwgcGFyYW1zLnVuaXFJRHMpO1xuICAgIGNvbnN0IHByb3BzID0gT2JqZWN0LmFzc2lnbih7fSwgcmF3VmFsdWVzLnByb3BzLCByYXdWYWx1ZXMubmV3VmFsdWVzLnByb3BzKTtcbiAgICBwcm94aWZ5U3luY0FycmF5SXRlbXMobWVtb3J5LCBPYmplY3Qua2V5cyhwcm9wcyksIHByb3BzLCBwYXJhbXMub2JqZWN0KTtcblxuICAgIHBhcmFtcy5zeW5jU2xpY2UgPSBtZW1vcnkuZ2V0U2xpY2UoKSBhcyBSZWNvcmQ8bnVtYmVyLCBNZW1vcnlUeXBlPjtcbiAgICBwYXJhbXMucHJldmlvdXNTbGljZVZhbHVlcyA9IHJhd1ZhbHVlcy5jb21waWxlZFZhbHVlcztcbiAgICBwYXJhbXMuc2VxdWVuY2VzID0gc2VxdWVuY2VzO1xuXG4gICAgcGFyYW1zLm1hcC5jbGVhcigpO1xuICAgIHBhcmFtcy5vYmplY3QuZm9yRWFjaCgoaXRlbTogTWVtb3J5QWxsb3dlZFR5cGUsIGk6IG51bWJlcikgPT4ge1xuICAgICAgICBwYXJhbXMubWFwLnNldChpdGVtLCBwYXJhbXMudW5pcUlEc1tpXSk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBwcm94aWZ5U3luY0FycmF5SXRlbXMoXG4gICAgbWVtb3J5OiBNZW1vcnlXb3JrZXIsXG4gICAga2V5czogc3RyaW5nW10sXG4gICAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXM+LFxuICAgIGFycmF5OiBNZW1vcnlBbGxvd2VkVHlwZVtdLFxuICAgIHVuaXFJRHM/OiBzdHJpbmdbXSxcbik6IHZvaWQge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgZm9yIChsZXQgayA9IDAsIGxlbiA9IGtleXMubGVuZ3RoOyBrIDwgbGVuOyBrKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5c1trXTtcbiAgICAgICAgbGV0IHZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gcmVtb3ZlZEl0ZW0pIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFZlcnNpb25hYmxlSUQpIHtcbiAgICAgICAgICAgIHZhbHVlID0gbWVtb3J5LmdldFByb3h5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5pcUlEcykge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBVbmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhcnJheVtpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVuaXFJRHMucHVzaChrZXkpO1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFycmF5W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGxpbmtWZXJzaW9uYWJsZShtZW1vcnk6IE1lbW9yeVdvcmtlcik6IHZvaWQge1xuICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMgYXMgQXJyYXlQYXJhbXM7XG4gICAgcGFyYW1zLm1lbW9yeSA9IG1lbW9yeTtcbiAgICBwYXJhbXMuc3luY2hyb25pemUgPSBwcm94aWZ5U3luY0FycmF5O1xuICAgIGNvbnN0IHNsaWNlID0gbWVtb3J5LmdldFNsaWNlKCk7XG4gICAgY29uc3QgYXJyYXkgPSBwYXJhbXMub2JqZWN0O1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhcnJheSk7XG4gICAgY29uc3QgbGVuID0ga2V5cy5sZW5ndGg7XG4gICAgY29uc3QgSUQgPSBwYXJhbXMuSUQ7XG4gICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICBtZW1vcnkubWFya0RpcnR5KElEKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZW1vcnlBcnJheSA9IChzbGljZVtJRCBhcyBudW1iZXJdID0gbmV3IHBhcmFtcy5NZW1vcnlUeXBlKCkgYXMgTWVtb3J5VHlwZUFycmF5KTtcbiAgICBjb25zdCBwcm9wcyA9IG1lbW9yeUFycmF5LnByb3BzO1xuICAgIGNvbnN0IHBhdGNoID0gbWVtb3J5QXJyYXkucGF0Y2g7XG4gICAgY29uc3QgdW5pcUlEcyA9IHBhcmFtcy51bmlxSURzO1xuICAgIGNvbnN0IHNlcXVlbmNlcyA9IHBhcmFtcy5zZXF1ZW5jZXM7XG4gICAgbGV0IGFycmF5SW5kZXggPSAtMTtcbiAgICBmb3IgKGxldCBrID0gMDsgayA8IGxlbjsgaysrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGtleXNba107XG4gICAgICAgIGNvbnN0IGluZGV4ID0gK2tleTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhcnJheVtrZXldO1xuICAgICAgICBjb25zdCB2YWx1ZVBhcmFtcyA9XG4gICAgICAgICAgICB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlW21lbW9yeVByb3h5UHJhbXNLZXldO1xuXG4gICAgICAgIGlmICh2YWx1ZVBhcmFtcykge1xuICAgICAgICAgICAgbWVtb3J5LmxpbmtUb01lbW9yeSh2YWx1ZSBhcyBvYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc05hTihpbmRleCkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIHByb3BzW2tleV0gPSB2YWx1ZVBhcmFtcy5JRDtcbiAgICAgICAgICAgICAgICBtZW1vcnkuYWRkU2xpY2VQcm94eVBhcmVudCh2YWx1ZVBhcmFtcy5JRCwgSUQsIGtleSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3BzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFycmF5SW5kZXgrKztcbiAgICAgICAgICAgIHdoaWxlIChhcnJheUluZGV4IDwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdVbmlxSUQgPSBnZW5lcmF0ZVVpZChzZXF1ZW5jZXMsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdW5pcUlEc1thcnJheUluZGV4XSA9IG5ld1VuaXFJRDtcbiAgICAgICAgICAgICAgICBwYXRjaFtuZXdVbmlxSURdID0gVW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGFycmF5SW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG5ld1VuaXFJRCA9IGdlbmVyYXRlVWlkKHNlcXVlbmNlcywgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICAgIHVuaXFJRHNbaW5kZXhdID0gbmV3VW5pcUlEO1xuICAgICAgICAgICAgaWYgKHZhbHVlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGF0Y2hbbmV3VW5pcUlEXSA9IHZhbHVlUGFyYW1zLklEO1xuICAgICAgICAgICAgICAgIG1lbW9yeS5hZGRTbGljZVByb3h5UGFyZW50KHZhbHVlUGFyYW1zLklELCBJRCwgJ8K0JyArIG5ld1VuaXFJRCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhdGNoW25ld1VuaXFJRF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXJhbXMubWFwLmNsZWFyKCk7XG4gICAgYXJyYXkuZm9yRWFjaCgoaXRlbTogTWVtb3J5QWxsb3dlZFR5cGUsIGk6IG51bWJlcikgPT4ge1xuICAgICAgICBpZiAoIXBhcmFtcy5tYXAuaGFzKGl0ZW0pKSB7XG4gICAgICAgICAgICBwYXJhbXMubWFwLnNldChpdGVtLCB1bmlxSURzW2ldKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIG1lbW9yeS5tYXJrRGlydHkoSUQpO1xufVxuXG4vLyBJRHNcblxuZnVuY3Rpb24gYWxsb2NVaWQobWluOiB1bmlxU2VjLCBtYXg6IHVuaXFTZWMpOiB1bmlxU2VjIHtcbiAgICBjb25zdCBzdGVwID0gNDtcbiAgICBpZiAoIW1pbiAmJiAhbWF4KSB7XG4gICAgICAgIHJldHVybiBbMTI4XTtcbiAgICB9XG4gICAgbWluID0gbWluIHx8IFtdO1xuICAgIG1heCA9IG1heCB8fCBbXTtcbiAgICBjb25zdCByZXMgPSBbXTtcbiAgICBsZXQgbWluU2VxID0gMDtcbiAgICBsZXQgbWF4U2VxID0gbWF4WzBdO1xuICAgIGZvciAobGV0IGluZGV4ID0gMCwgbGVuID0gTWF0aC5tYXgobWluLmxlbmd0aCwgbWF4Lmxlbmd0aCk7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICAgIG1pblNlcSA9IG1pbltpbmRleF0gfCAwO1xuICAgICAgICBtYXhTZXEgPSBpbmRleCBpbiBtYXggPyBtYXhbaW5kZXhdIDogNDA5NjtcbiAgICAgICAgaWYgKG1pblNlcSA9PT0gNDA5NSAmJiBtYXhTZXEgPT09IDQwOTYpIHtcbiAgICAgICAgICAgIHJlcy5wdXNoKG1pblNlcSk7XG4gICAgICAgIH0gZWxzZSBpZiAobWluU2VxID09PSBtYXhTZXEpIHtcbiAgICAgICAgICAgIHJlcy5wdXNoKG1pblNlcSk7XG4gICAgICAgIH0gZWxzZSBpZiAobWluU2VxID09PSBtYXhTZXEgLSAxICYmIGxlbiA+IGluZGV4IC0gMSkge1xuICAgICAgICAgICAgcmVzLnB1c2gobWluU2VxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGRpZmYgPSAobWF4U2VxIC0gbWluU2VxKSA+PiAxO1xuICAgIGlmIChkaWZmID09PSAwKSB7XG4gICAgICAgIHJlcy5wdXNoKG1pbi5sZW5ndGggPyAxMjggOiAyMDQ4KTtcbiAgICB9IGVsc2UgaWYgKG1pblNlcSA9PT0gMCkge1xuICAgICAgICByZXMucHVzaChtYXhTZXEgLSBNYXRoLm1pbihkaWZmLCBzdGVwKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzLnB1c2gobWluU2VxICsgTWF0aC5taW4oZGlmZiwgc3RlcCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuZnVuY3Rpb24gaGV4YVRvU2VxKHN0cjogc3RyaW5nKTogdW5pcVNlYyB7XG4gICAgY29uc3Qgc2VxID0gW107XG4gICAgZm9yIChsZXQgayA9IDAsIGxlbiA9IHN0ci5sZW5ndGg7IGsgPCBsZW47IGsgKz0gMykge1xuICAgICAgICBzZXEucHVzaChwYXJzZUludChzdHIuc2xpY2UoaywgayArIDMpLCAxNikpO1xuICAgIH1cbiAgICByZXR1cm4gc2VxO1xufVxuZnVuY3Rpb24gU2VxVG9IZXhhKHNlcTogdW5pcVNlYyk6IHVuaXFJRCB7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGNvbnN0IGxlbiA9IHNlcS5sZW5ndGg7XG4gICAgZm9yIChsZXQgayA9IDA7IGsgPCBsZW47IGsrKykge1xuICAgICAgICBjb25zdCBuID0gc2VxW2tdO1xuICAgICAgICBpZiAobiA9PT0gMCkge1xuICAgICAgICAgICAgc3RyICs9ICcwMDAnO1xuICAgICAgICB9IGVsc2UgaWYgKG4gPCAxNikge1xuICAgICAgICAgICAgc3RyICs9ICcwMCcgKyBuLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgfSBlbHNlIGlmIChuIDwgMjU2KSB7XG4gICAgICAgICAgICBzdHIgKz0gJzAnICsgbi50b1N0cmluZygxNik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgKz0gbi50b1N0cmluZygxNik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmZ1bmN0aW9uIGdlbmVyYXRlVWlkKHNvcnRlZFVuaXFJRHM6IHVuaXFJRFtdLCBtaW46IHVuaXFJRCwgaXNFbmQ/OiBib29sZWFuKTogdW5pcUlEIHtcbiAgICBsZXQgbWF4OiB1bmlxSUQ7XG4gICAgaWYgKGlzRW5kKSB7XG4gICAgICAgIG1pbiA9IHNvcnRlZFVuaXFJRHNbc29ydGVkVW5pcUlEcy5sZW5ndGggLSAxXTtcbiAgICB9IGVsc2UgaWYgKG1pbikge1xuICAgICAgICBtYXggPSBzb3J0ZWRVbmlxSURzW3NvcnRlZFVuaXFJRHMuaW5kZXhPZihtaW4pICsgMV07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbWF4ID0gc29ydGVkVW5pcUlEc1swXTtcbiAgICB9XG4gICAgY29uc3QgbWluU2VxID0gbWluICYmIGhleGFUb1NlcShtaW4pO1xuICAgIGNvbnN0IG1heFNlcSA9IG1heCAmJiBoZXhhVG9TZXEobWF4KTtcbiAgICBjb25zdCBuZXdVbmlxSUQgPSBTZXFUb0hleGEoYWxsb2NVaWQobWluU2VxLCBtYXhTZXEpKTtcblxuICAgIGlmIChpc0VuZCkge1xuICAgICAgICBzb3J0ZWRVbmlxSURzLnB1c2gobmV3VW5pcUlEKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzb3J0ZWRJbmRleCA9IG1pbiA/IHNvcnRlZFVuaXFJRHMuaW5kZXhPZihtaW4pIDogLTE7XG4gICAgICAgIGlmIChzb3J0ZWRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHNvcnRlZFVuaXFJRHMudW5zaGlmdChuZXdVbmlxSUQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc29ydGVkVW5pcUlEcy5zcGxpY2Uoc29ydGVkSW5kZXggKyAxLCAwLCBuZXdVbmlxSUQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdVbmlxSUQ7XG59XG5cbmV4cG9ydCBjbGFzcyBWZXJzaW9uYWJsZUFycmF5PFQgZXh0ZW5kcyBNZW1vcnlBbGxvd2VkVHlwZSA9IE1lbW9yeUFsbG93ZWRUeXBlPiBleHRlbmRzIEFycmF5PFQ+IHtcbiAgICBjb25zdHJ1Y3RvciguLi5pdGVtczogVFtdKSB7XG4gICAgICAgIHN1cGVyKC4uLml0ZW1zKTtcbiAgICAgICAgcmV0dXJuIF9wcm94aWZ5QXJyYXkodGhpcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtcbiAgICBNZW1vcnlBbGxvd2VkVHlwZSxcbiAgICBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMsXG4gICAgTWVtb3J5VHlwZU9iamVjdCxcbiAgICBNZW1vcnlXb3JrZXIsXG59IGZyb20gJy4vTWVtb3J5JztcbmltcG9ydCB7XG4gICAgVmVyc2lvbmFibGVJRCxcbiAgICBfY2hlY2tWZXJzaW9uYWJsZSxcbiAgICBWZXJzaW9uYWJsZVBhcmFtcyxcbiAgICBnZW5lcmF0ZVZlcnNpb25hYmxlSUQsXG4gICAgX3N0YWNrZWRQcm94aWZ5LFxufSBmcm9tICcuL1ZlcnNpb25hYmxlJztcblxuaW1wb3J0IHtcbiAgICByZW1vdmVkSXRlbSxcbiAgICBtZW1vcnlQcm94eU5vdFZlcnNpb25hYmxlS2V5LFxuICAgIG1lbW9yeVByb3h5UHJhbXNLZXksXG4gICAgRnJvemVuRXJyb3IsXG4gICAgc3ltYm9sVmVyaWZ5LFxufSBmcm9tICcuL2NvbnN0JztcblxuZXhwb3J0IHR5cGUga2V5VHlwZSA9IHN0cmluZyB8IG51bWJlciB8IHN5bWJvbDtcblxuaW50ZXJmYWNlIE9iamVjdFBhcmFtcyBleHRlbmRzIFZlcnNpb25hYmxlUGFyYW1zIHtcbiAgICBwcm94eTogUmVjb3JkPGtleVR5cGUsIE1lbW9yeUFsbG93ZWRUeXBlPjtcbiAgICBvYmplY3Q6IFJlY29yZDxrZXlUeXBlLCBNZW1vcnlBbGxvd2VkVHlwZT47XG4gICAgcHJvdG86IEdldHRlcnNTZXR0ZXJzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldHRlcnNTZXR0ZXJzIHtcbiAgICBnZXR0ZXJzOiBSZWNvcmQ8c3RyaW5nIHwgc3ltYm9sLCAoKSA9PiBNZW1vcnlBbGxvd2VkVHlwZT47XG4gICAgc2V0dGVyczogUmVjb3JkPHN0cmluZyB8IHN5bWJvbCwgKHZhbHVlOiBNZW1vcnlBbGxvd2VkVHlwZSkgPT4gdm9pZD47XG59XG5cbmNvbnN0IGNsYXNzR2V0dGVyc1NldHRlcnM6IFdlYWtNYXA8b2JqZWN0LCBHZXR0ZXJzU2V0dGVycz4gPSBuZXcgV2Vha01hcCgpO1xuY29uc3Qgcm9vdFByb3RvdHlwZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih7fSk7XG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvdG90eXBlR2V0dGVyc1NldHRlcnMob2JqOiBvYmplY3QpOiBHZXR0ZXJzU2V0dGVycyB7XG4gICAgbGV0IGdldHRlcnNTZXR0ZXJzID0gY2xhc3NHZXR0ZXJzU2V0dGVycy5nZXQob2JqLmNvbnN0cnVjdG9yKTtcbiAgICBpZiAoZ2V0dGVyc1NldHRlcnMpIHtcbiAgICAgICAgcmV0dXJuIGdldHRlcnNTZXR0ZXJzO1xuICAgIH1cbiAgICBnZXR0ZXJzU2V0dGVycyA9IHtcbiAgICAgICAgZ2V0dGVyczoge30sXG4gICAgICAgIHNldHRlcnM6IHt9LFxuICAgIH07XG4gICAgY2xhc3NHZXR0ZXJzU2V0dGVycy5zZXQob2JqLmNvbnN0cnVjdG9yLCBnZXR0ZXJzU2V0dGVycyk7XG4gICAgb2JqID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaik7XG4gICAgZG8ge1xuICAgICAgICBjb25zdCBkZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG9iaik7XG4gICAgICAgIE9iamVjdC5rZXlzKGRlc2NzKS5mb3JFYWNoKHByb3BOYW1lID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2MgPSBkZXNjc1twcm9wTmFtZV07XG4gICAgICAgICAgICBpZiAoIWdldHRlcnNTZXR0ZXJzLmdldHRlcnNbcHJvcE5hbWVdICYmIGRlc2MuZ2V0KSB7XG4gICAgICAgICAgICAgICAgZ2V0dGVyc1NldHRlcnMuZ2V0dGVyc1twcm9wTmFtZV0gPSBkZXNjLmdldCBhcyAoKSA9PiBNZW1vcnlBbGxvd2VkVHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZ2V0dGVyc1NldHRlcnMuc2V0dGVyc1twcm9wTmFtZV0gJiYgZGVzYy5zZXQpIHtcbiAgICAgICAgICAgICAgICBnZXR0ZXJzU2V0dGVycy5zZXR0ZXJzW3Byb3BOYW1lXSA9IGRlc2Muc2V0IGFzICh2YWx1ZTogTWVtb3J5QWxsb3dlZFR5cGUpID0+IHZvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gd2hpbGUgKChvYmogPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkgJiYgb2JqICE9PSByb290UHJvdG90eXBlKTtcbiAgICByZXR1cm4gZ2V0dGVyc1NldHRlcnM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJveHlPYmplY3RIYW5kbGVyIHtcbiAgICBnZXQob2JqOiBNZW1vcnlBbGxvd2VkVHlwZSwgcHJvcDoga2V5VHlwZSwgcHJveHk6IG9iamVjdCk6IE1lbW9yeUFsbG93ZWRUeXBlO1xuICAgIHNldChvYmo6IE1lbW9yeUFsbG93ZWRUeXBlLCBwcm9wOiBrZXlUeXBlLCB2YWx1ZTogTWVtb3J5QWxsb3dlZFR5cGUsIHByb3h5OiBvYmplY3QpOiBib29sZWFuO1xuICAgIGhhcyhvYmo6IE1lbW9yeUFsbG93ZWRUeXBlLCBwcm9wOiBrZXlUeXBlKTogYm9vbGVhbjtcbiAgICBvd25LZXlzKG9iajogTWVtb3J5QWxsb3dlZFR5cGUpOiBrZXlUeXBlW107XG4gICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iajogTWVtb3J5QWxsb3dlZFR5cGUsIHByb3A6IHN0cmluZyB8IHN5bWJvbCk6IFByb3BlcnR5RGVzY3JpcHRvcjtcbiAgICBkZWxldGVQcm9wZXJ0eShvYmo6IE1lbW9yeUFsbG93ZWRUeXBlLCBwcm9wOiBzdHJpbmcpOiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgcHJveHlPYmplY3RIYW5kbGVyID0ge1xuICAgIHNldChvYmo6IG9iamVjdCwgcHJvcDoga2V5VHlwZSwgdmFsdWU6IE1lbW9yeUFsbG93ZWRUeXBlLCBwcm94eTogb2JqZWN0KTogYm9vbGVhbiB7XG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24gbWlnaHQgdHJ5IHRvIHNldCB0aGUgdmFsdWUgb2YgdGhlIHBhcmFtc0tleS4gV2VcbiAgICAgICAgLy8gb2J2aW91c2x5IGRvbid0IHdhbnQgdGhhdC4gTGV0IGl0IHRoaW5rIGl0IHN1Y2NlZWRlZCAocmV0dXJuaW5nIGZhbHNlXG4gICAgICAgIC8vIHdpbGwgdGhyb3cgYW4gZXJyb3IsIHdoaWNoIGlzIG5vdCB3aGF0IHdlIHdhbnQgaGVyZS4pXG4gICAgICAgIGlmIChwcm9wID09PSBtZW1vcnlQcm94eVByYW1zS2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvcCA9PT0gc3ltYm9sVmVyaWZ5KSB7XG4gICAgICAgICAgICBvYmpbc3ltYm9sVmVyaWZ5XSA9IHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwYXJhbXMgPSBvYmpbbWVtb3J5UHJveHlQcmFtc0tleV0gYXMgT2JqZWN0UGFyYW1zO1xuICAgICAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuXG4gICAgICAgIGlmICghbWVtb3J5ICYmIHZhbHVlID09PSByZW1vdmVkSXRlbSkge1xuICAgICAgICAgICAgLy8gXCJzeW5jaHJvbml6ZVwiIHRoZSBkZWxldGVcbiAgICAgICAgICAgIGRlbGV0ZSBvYmpbcHJvcF07XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoZSBwcm9wZXJ0eSBpcyBhIG1ldGhvZCBvZiB0aGUgY2xhc3Mgb3IgcHJvdG90eXBlLlxuICAgICAgICBjb25zdCBwcm90b01ldGhvZCA9IHBhcmFtcy5wcm90by5zZXR0ZXJzW3Byb3AgYXMgc3RyaW5nXTtcbiAgICAgICAgaWYgKHByb3RvTWV0aG9kKSB7XG4gICAgICAgICAgICBwcm90b01ldGhvZC5jYWxsKHByb3h5LCB2YWx1ZSBhcyBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGUgcHJvcGVydHkgaXMgYSBnZXR0ZXJcbiAgICAgICAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBwcm9wKTtcbiAgICAgICAgaWYgKGRlc2M/LnNldCkge1xuICAgICAgICAgICAgZGVzYy5zZXQuY2FsbChwcm94eSwgdmFsdWUgYXMgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgX2NoZWNrVmVyc2lvbmFibGUodmFsdWUpO1xuXG4gICAgICAgIC8vIGlmIG5vdCBsaW5rZWQgdG8gbWVtb3J5XG4gICAgICAgIGlmICghbWVtb3J5KSB7XG4gICAgICAgICAgICBvYmpbcHJvcF0gPSB2YWx1ZSBhcyBNZW1vcnlBbGxvd2VkUHJpbWl0aXZlVHlwZXM7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZW1vcnkuaXNGcm96ZW4oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEZyb3plbkVycm9yKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IG9ialtwcm9wXTtcbiAgICAgICAgLy8gVGhlIHZhbHVlIGlzIHRoZSBzYW1lLCBvciB3ZSBhcmUgZGVsZXRpbmcgYSB2YWx1ZSB0aGF0IHdhcyBub3RcbiAgICAgICAgLy8gYWxyZWFkeSB0aGVyZSBpbiB0aGUgZmlyc3QgcGxhY2UuXG4gICAgICAgIGlmIChvbGRWYWx1ZSA9PT0gdmFsdWUgfHwgKHZhbHVlID09PSByZW1vdmVkSXRlbSAmJiAhKHByb3AgaW4gb2JqKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2xpY2UgPSBtZW1vcnkuZ2V0U2xpY2UoKTtcbiAgICAgICAgbGV0IG1lbW9yeU9iamVjdCA9IHNsaWNlW3BhcmFtcy5JRCBhcyBudW1iZXJdIGFzIE1lbW9yeVR5cGVPYmplY3Q7XG4gICAgICAgIGlmICghbWVtb3J5T2JqZWN0KSB7XG4gICAgICAgICAgICBzbGljZVtwYXJhbXMuSUQgYXMgbnVtYmVyXSA9IG1lbW9yeU9iamVjdCA9IG5ldyBwYXJhbXMuTWVtb3J5VHlwZSgpIGFzIE1lbW9yeVR5cGVPYmplY3Q7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWVtb3J5T2JqZWN0UHJvcHMgPSBtZW1vcnlPYmplY3QucHJvcHM7XG5cbiAgICAgICAgbGV0IG1lbW9yeUl0ZW0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIXZhbHVlW21lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXldKSB7XG4gICAgICAgICAgICAvLyBpZiBvYmplY3QsIHRoZSBzdG9yZWQgdmFsdWUgbmVlZHMgdG8gYmUgXCJjb252ZXJ0ZWRcIiAoc2VlIFNldClcbiAgICAgICAgICAgIG1lbW9yeS5saW5rVG9NZW1vcnkodmFsdWUgYXMgb2JqZWN0KTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1BhcmFtcyA9IHZhbHVlICYmIHZhbHVlW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICAgICAgbWVtb3J5SXRlbSA9IG5ld1BhcmFtcy5JRDtcbiAgICAgICAgICAgIG1lbW9yeS5hZGRTbGljZVByb3h5UGFyZW50KG5ld1BhcmFtcy5JRCwgcGFyYW1zLklELCBwcm9wIGFzIHN0cmluZyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGUgb2xkIHZhbHVlIHdhcyBhIHZlcnNpb25hYmxlIGFzIHdlbGwsIHNldmVyIGl0cyBsaW5rIHRvIGl0cyBwYXJlbnRcbiAgICAgICAgY29uc3Qgb2xkUGFyYW1zID0gb2xkVmFsdWUgJiYgdHlwZW9mIG9sZFZhbHVlID09PSAnb2JqZWN0JyAmJiBvbGRWYWx1ZVttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgaWYgKG9sZFBhcmFtcykge1xuICAgICAgICAgICAgbWVtb3J5LmRlbGV0ZVNsaWNlUHJveHlQYXJlbnQob2xkUGFyYW1zLklELCBwYXJhbXMuSUQsIHByb3AgYXMgc3RyaW5nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gcmVtb3ZlZEl0ZW0pIHtcbiAgICAgICAgICAgIG1lbW9yeU9iamVjdFByb3BzW3Byb3AgYXMgc3RyaW5nXSA9IHJlbW92ZWRJdGVtOyAvLyBub3RpZnkgdGhhdCB0aGUgZGVsZXRpb24gaGFwcGVuZWQgaW4gdGhpcyBzbGljZVxuICAgICAgICAgICAgZGVsZXRlIG9ialtwcm9wXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lbW9yeU9iamVjdFByb3BzW3Byb3AgYXMgc3RyaW5nXSA9IG1lbW9yeUl0ZW07XG4gICAgICAgICAgICBvYmpbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1lbW9yeS5tYXJrRGlydHkocGFyYW1zLklEKTsgLy8gbWFyayB0aGUgY2FjaGUgYXMgaW52YWxpZCB3aGVuIGNoYW5nZSB0aGUgc2xpZGUgbWVtb3J5XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgZGVsZXRlUHJvcGVydHkob2JqOiBvYmplY3QsIHByb3A6IGtleVR5cGUpOiBib29sZWFuIHtcbiAgICAgICAgLy8gYHJlbW92ZWRJdGVtYCBpcyBhIG1hcmtlciB0byBub3RpZnkgdGhhdCB0aGVyZSB3YXMgc29tZXRoaW5nIGhlcmUgYnV0XG4gICAgICAgIC8vIGl0IGdvdCByZW1vdmVkXG4gICAgICAgIHRoaXMuc2V0KG9iaiwgcHJvcCwgcmVtb3ZlZEl0ZW0pO1xuICAgICAgICBkZWxldGUgb2JqW3Byb3BdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxufSBhcyBQcm94eU9iamVjdEhhbmRsZXI7XG5cbmV4cG9ydCBmdW5jdGlvbiBfcHJveGlmeU9iamVjdChvYmo6IG9iamVjdCk6IG9iamVjdCB7XG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkob2JqLCBwcm94eU9iamVjdEhhbmRsZXIpIGFzIG9iamVjdDtcblxuICAgIG9ialttZW1vcnlQcm94eVByYW1zS2V5XSA9IHtcbiAgICAgICAgSUQ6IGdlbmVyYXRlVmVyc2lvbmFibGVJRCgpLFxuICAgICAgICBsaW5rQ2FsbGJhY2s6IGxpbmtWZXJzaW9uYWJsZSxcbiAgICAgICAgc3luY2hyb25pemU6IHByb3hpZnlTeW5jT2JqZWN0LFxuICAgICAgICBNZW1vcnlUeXBlOiBNZW1vcnlUeXBlT2JqZWN0LFxuICAgICAgICB2ZXJpZnk6IHZlcmlmeSxcbiAgICAgICAgcHJveHk6IHByb3h5LFxuICAgICAgICBvYmplY3Q6IG9iaixcbiAgICAgICAgcHJvdG86IGdldFByb3RvdHlwZUdldHRlcnNTZXR0ZXJzKG9iaiksXG4gICAgfSBhcyBPYmplY3RQYXJhbXM7XG5cbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgICBmb3IgKGxldCBrID0gMCwgbGVuID0ga2V5cy5sZW5ndGg7IGsgPCBsZW47IGsrKykge1xuICAgICAgICBjb25zdCBrZXkgPSBrZXlzW2tdO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICBfc3RhY2tlZFByb3hpZnkodmFsdWUsIG5ld1ZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBvYmpba2V5XSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHByb3h5O1xufVxuXG5mdW5jdGlvbiB2ZXJpZnkocHJveHk6IE1lbW9yeUFsbG93ZWRUeXBlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcGFyYW1zID0gdGhpcyBhcyBPYmplY3RQYXJhbXM7XG4gICAgY29uc3Qgb2JqID0gcGFyYW1zLm9iamVjdCBhcyBvYmplY3Q7XG4gICAgcHJveHlbc3ltYm9sVmVyaWZ5XSA9IHRydWU7XG4gICAgY29uc3QgdmFsdWUgPSBvYmpbc3ltYm9sVmVyaWZ5XSBhcyBib29sZWFuO1xuICAgIG9ialtzeW1ib2xWZXJpZnldID0gZmFsc2U7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHByb3hpZnlTeW5jT2JqZWN0KCk6IHZvaWQge1xuICAgIC8vIFN5bmNocm9uaXphdGlvbiBmdW5jdGlvblxuICAgIC8vIE1vc3QgbWV0aG9kcyBvZiB0aGUgXCJwcm94eVwiIHdpbGwgY2FsbCB0aGlzIHN5bmNocm9uaXphdGlvbiBmdW5jdGlvbiwgZXZlblxuICAgIC8vIGlmIGl0IGlzIG5vdCB5ZXQgbGlua2VkIHRvIGEgbWVtb3J5ICFcbiAgICBjb25zdCBwYXJhbXMgPSB0aGlzIGFzIE9iamVjdFBhcmFtcztcbiAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuICAgIGNvbnN0IG1lbW9yeU9iamVjdCA9IG1lbW9yeS5nZXRTbGljZVZhbHVlKHBhcmFtcy5JRCkgYXMgTWVtb3J5VHlwZU9iamVjdDtcbiAgICBjb25zdCBtZW1vcnlPYmplY3RQcm9wcyA9IChtZW1vcnlPYmplY3QgJiYgbWVtb3J5T2JqZWN0LnByb3BzKSB8fCB7fTtcblxuICAgIC8vIENsZWFyIGtleXMgdGhhdCBkbyBub3QgZXhpc3QgYW55bW9yZVxuICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMocGFyYW1zLm9iamVjdCk7XG4gICAgbGV0IGtleTogc3RyaW5nO1xuICAgIHdoaWxlICgoa2V5ID0ga2V5cy5wb3AoKSkpIHtcbiAgICAgICAgLy8gaWYgdGhlIG9iamVjdCBpcyBub3QgcHJlc2VudCBpbiB0aGlzIHNsaWNlIG9yIGl0IGRvZXMgbm90IGhhdmUgdGhpcyBrZXlcbiAgICAgICAgaWYgKCEoa2V5IGluIG1lbW9yeU9iamVjdFByb3BzKSkge1xuICAgICAgICAgICAgZGVsZXRlIHBhcmFtcy5vYmplY3Rba2V5XTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICghbWVtb3J5T2JqZWN0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdmFsdWVzIGFjY29yZGluZyB0byB3aGF0IGlzIHN0b3JlZFxuICAgIGtleXMgPSBPYmplY3Qua2V5cyhtZW1vcnlPYmplY3RQcm9wcyk7XG4gICAgd2hpbGUgKChrZXkgPSBrZXlzLnBvcCgpKSkge1xuICAgICAgICBsZXQgdmFsdWUgPSBtZW1vcnlPYmplY3RQcm9wc1trZXldO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBWZXJzaW9uYWJsZUlEKSB7XG4gICAgICAgICAgICAvLyBDb252ZXJ0IHByb3h5IHJlZmVyZW5jZXMgdG8gYWN0dWFsIHByb3h5XG4gICAgICAgICAgICB2YWx1ZSA9IG1lbW9yeS5nZXRQcm94eSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyYW1zLm9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlua1ZlcnNpb25hYmxlKG1lbW9yeTogTWVtb3J5V29ya2VyKTogdm9pZCB7XG4gICAgY29uc3QgcGFyYW1zID0gdGhpcyBhcyBPYmplY3RQYXJhbXM7XG4gICAgcGFyYW1zLm1lbW9yeSA9IG1lbW9yeTtcbiAgICBjb25zdCBzbGljZSA9IHBhcmFtcy5tZW1vcnkuZ2V0U2xpY2UoKTtcbiAgICBjb25zdCBvYmogPSBwYXJhbXMub2JqZWN0O1xuICAgIGNvbnN0IElEID0gcGFyYW1zLklEO1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuICAgIGlmIChrZXlzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBtZW1vcnlPYmplY3RQcm9wcyA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7XG4gICAgICAgIGxldCBrZXk6IHN0cmluZztcbiAgICAgICAgd2hpbGUgKChrZXkgPSBrZXlzLnBvcCgpKSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBvYmpba2V5XTtcbiAgICAgICAgICAgIC8vIFNvbWUgb2YgdGhlIHZhbHVlcyBpbiB0aGUgb3JpZ2luYWwgb2JqZWN0IG1heSBiZSB2ZXJzaW9uYWJsZSBhbmRcbiAgICAgICAgICAgIC8vIG5lZWQgdG8gYmUgY29udmVydGVkXG4gICAgICAgICAgICBjb25zdCB2YWx1ZVBhcmFtcyA9XG4gICAgICAgICAgICAgICAgdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZVttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgICAgIGlmICh2YWx1ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIG1lbW9yeS5saW5rVG9NZW1vcnkodmFsdWUgYXMgb2JqZWN0KTtcbiAgICAgICAgICAgICAgICBtZW1vcnkuYWRkU2xpY2VQcm94eVBhcmVudCh2YWx1ZVBhcmFtcy5JRCwgSUQsIGtleSk7XG4gICAgICAgICAgICAgICAgbWVtb3J5T2JqZWN0UHJvcHNba2V5XSA9IHZhbHVlUGFyYW1zLklEO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lbW9yeU9iamVjdCA9IG5ldyBwYXJhbXMuTWVtb3J5VHlwZSgpIGFzIE1lbW9yeVR5cGVPYmplY3Q7XG4gICAgICAgIG1lbW9yeU9iamVjdC5wcm9wcyA9IG1lbW9yeU9iamVjdFByb3BzO1xuICAgICAgICBzbGljZVtJRCBhcyBudW1iZXJdID0gbWVtb3J5T2JqZWN0OyAvLyBzdG9yZSB0aGUgXCJwdXJlXCIgdmFsdWUgaW4gbWVtb3J5XG4gICAgfVxuICAgIG1lbW9yeS5tYXJrRGlydHkoSUQpO1xufVxuZXhwb3J0IGNsYXNzIFZlcnNpb25hYmxlT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihvYmo/OiBSZWNvcmQ8c3RyaW5nLCBNZW1vcnlBbGxvd2VkVHlwZT4gfCBvYmplY3QpIHtcbiAgICAgICAgaWYgKG9iaikge1xuICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICAgICAgICBsZXQga2V5OiBzdHJpbmc7XG4gICAgICAgICAgICB3aGlsZSAoKGtleSA9IGtleXMucG9wKCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpc1trZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9wcm94aWZ5T2JqZWN0KHRoaXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgTWVtb3J5QWxsb3dlZFR5cGUsXG4gICAgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzLFxuICAgIE1lbW9yeVdvcmtlcixcbiAgICBNZW1vcnlUeXBlU2V0LFxuICAgIE1lbW9yeUNvbXBpbGVkU2V0LFxufSBmcm9tICcuL01lbW9yeSc7XG5pbXBvcnQge1xuICAgIFZlcnNpb25hYmxlSUQsXG4gICAgX2NoZWNrVmVyc2lvbmFibGUsXG4gICAgVmVyc2lvbmFibGVQYXJhbXMsXG4gICAgZ2VuZXJhdGVWZXJzaW9uYWJsZUlELFxuICAgIF9zdGFja2VkUHJveGlmeSxcbn0gZnJvbSAnLi9WZXJzaW9uYWJsZSc7XG5cbmltcG9ydCB7IG1lbW9yeVByb3h5Tm90VmVyc2lvbmFibGVLZXksIG1lbW9yeVByb3h5UHJhbXNLZXksIEZyb3plbkVycm9yIH0gZnJvbSAnLi9jb25zdCc7XG5cbmludGVyZmFjZSBTZXRQYXJhbXMgZXh0ZW5kcyBWZXJzaW9uYWJsZVBhcmFtcyB7XG4gICAgc2l6ZTogbnVtYmVyO1xuICAgIG9iamVjdDogU2V0PE1lbW9yeUFsbG93ZWRUeXBlPjtcbiAgICBwcm94eTogVmVyc2lvbmFibGVTZXQ7XG59XG5cbi8vIFBlb3BsZSBjYW4gb3ZlcnJpZGUgdGhlIHNldCBtZXRob2RzLiBUaGV5IHdpbGwgYmUgY2FsbGVkIGZyb20gdGhlIHByb3h5LCBidXRcbi8vIHNvbWV0aW1lcyB3ZSB3YW50IHRvIGNhbGwgdGhlIHRydWUgb3JpZ2luYWwgbWV0aG9kcywgbm90IHRoZSBvdmVycmlkZSBvZiB0aGVcbi8vIHVzZXIuIFRoaXMgaXMgaG93IHdlIGRvIGl0LlxuY29uc3QgZ2VuZXJpY1NldCA9IG5ldyBTZXQoKSBhcyBTZXQ8TWVtb3J5QWxsb3dlZFR5cGU+O1xuY29uc3QgZ2VuZXJpY1NldFByb3RvdHlwZSA9IFNldC5wcm90b3R5cGU7XG5cbmZ1bmN0aW9uIHNldFByb3RvdHlwZTxUIGV4dGVuZHMgTWVtb3J5QWxsb3dlZFR5cGUgPSBNZW1vcnlBbGxvd2VkVHlwZT4oXG4gICAgcHJveHk6IFZlcnNpb25hYmxlU2V0PFQ+LFxuICAgIG9iajogU2V0PFQ+LFxuKTogdm9pZCB7XG4gICAgZG8ge1xuICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGxvb3BzIG9uIHRoZSBwcm90b3R5cGVzIG9mIHRoZSBvYmplY3QuIFRoaXMgaXMgd2hhdFxuICAgICAgICAvLyBzdG9wcyBpdC5cbiAgICAgICAgLy8gVE9ETyByZWZhY3Rvcjogd2hpbGUgIT09IGdlbmVyaWNTZXRQcm90b3R5cGVcbiAgICAgICAgaWYgKG9iaiA9PT0gZ2VuZXJpY1NldFByb3RvdHlwZSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3AgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9wID0gb3BbaV07IC8vIHByb3BOYW1lXG4gICAgICAgICAgICBpZiAoIXByb3h5W3Byb3BdKSB7XG4gICAgICAgICAgICAgICAgcHJveHlbcHJvcF0gPSBvYmpbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IHdoaWxlICgob2JqID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikpKTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuZnVuY3Rpb24gbm90aGluZygpOiB2b2lkIHt9XG5cbmV4cG9ydCBjbGFzcyBWZXJzaW9uYWJsZVNldDxUIGV4dGVuZHMgTWVtb3J5QWxsb3dlZFR5cGUgPSBNZW1vcnlBbGxvd2VkVHlwZT4gZXh0ZW5kcyBTZXQ8VD4ge1xuICAgIFttZW1vcnlQcm94eVByYW1zS2V5XTogU2V0UGFyYW1zO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcz86IFNldDxUPiB8IFRbXSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBsZXQgc2V0OiBTZXQ8VD47IC8vIG9yaWdpbmFsIHNldCAod29uJ3QgYmUgc3luY2VkLCBpdCdzIGp1c3QgZm9yIGl0cyBtZXRob2QgZXg6IG92ZXJyaWRlcylcbiAgICAgICAgbGV0IHNpemUgPSAwO1xuICAgICAgICBpZiAoIXBhcmFtcykge1xuICAgICAgICAgICAgc2V0ID0gZ2VuZXJpY1NldCBhcyBTZXQ8VD47XG4gICAgICAgIH0gZWxzZSBpZiAocGFyYW1zIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIHNldCA9IGdlbmVyaWNTZXQgYXMgU2V0PFQ+O1xuICAgICAgICAgICAgcGFyYW1zLmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgIHNpemUrKztcbiAgICAgICAgICAgICAgICBfc3RhY2tlZFByb3hpZnkodmFsdWUsIG5ld1ZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0LmFkZC5jYWxsKHRoaXMsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBhcmFtcyBpbnN0YW5jZW9mIFZlcnNpb25hYmxlU2V0KSB7XG4gICAgICAgICAgICAgICAgc2V0ID0gcGFyYW1zW21lbW9yeVByb3h5UHJhbXNLZXldLm9iamVjdCBhcyBTZXQ8VD47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldCA9IHBhcmFtcyBhcyBTZXQ8VD47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJhbXMuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgc2l6ZSsrO1xuICAgICAgICAgICAgICAgIF9zdGFja2VkUHJveGlmeSh2YWx1ZSwgbmV3VmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZXQuYWRkLmNhbGwodGhpcywgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXRQcm90b3R5cGUodGhpcywgc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXNbbWVtb3J5UHJveHlQcmFtc0tleV0gPSB7XG4gICAgICAgICAgICBJRDogZ2VuZXJhdGVWZXJzaW9uYWJsZUlEKCksXG4gICAgICAgICAgICBsaW5rQ2FsbGJhY2s6IGxpbmtWZXJzaW9uYWJsZSxcbiAgICAgICAgICAgIHN5bmNocm9uaXplOiBub3RoaW5nLFxuICAgICAgICAgICAgTWVtb3J5VHlwZTogTWVtb3J5VHlwZVNldCxcbiAgICAgICAgICAgIHZlcmlmeTogKHByb3h5OiBNZW1vcnlBbGxvd2VkVHlwZSk6IGJvb2xlYW4gPT4gcHJveHkgPT09IHRoaXMsXG4gICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgb2JqZWN0OiBzZXQsXG4gICAgICAgICAgICBwcm94eTogdGhpcyxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhZGQoaXRlbTogVCk6IHRoaXMge1xuICAgICAgICAvLyBGb3IgU2V0IHNwZWNpZmljYWxseSwgdGhpcyBsaW5lIHdpbGwgbmV2ZXIgYWN0dWFsbHkgKnByb3hpZnkqIHBlciBzZS5cbiAgICAgICAgLy8gSXQgd2lsbCBlaXRoZXIgd29yayBpZiB0aGUgaXRlbSBpcyBhbHJlYWR5IHByb3hpZmllZCwgb3IgdGhyb3cgYW5cbiAgICAgICAgLy8gZXJyb3IgaWYgaXQgaXMgbm90LlxuICAgICAgICBfY2hlY2tWZXJzaW9uYWJsZShpdGVtKTtcblxuICAgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuICAgICAgICBpZiAobWVtb3J5ICYmIG1lbW9yeS5pc0Zyb3plbigpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRnJvemVuRXJyb3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoZWNrID0gdGhpcy5oYXMoaXRlbSk7XG4gICAgICAgIGlmICghY2hlY2spIHtcbiAgICAgICAgICAgIHBhcmFtcy5vYmplY3QuYWRkLmNhbGwodGhpcywgaXRlbSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hlY2sgfHwgIW1lbW9yeSkge1xuICAgICAgICAgICAgLy8gTm90aGluZyBjaGFuZ2VkLiBFaXRoZXIgdGhlIGl0ZW0gd2FzIGFscmVhZHkgdGhlcmUsIG9yIHdlIGRvbid0XG4gICAgICAgICAgICAvLyBjYXJlIGJlY2F1c2Ugd2UgYXJlIG5vdCBsaW5rZWQgdG8gbWVtb3J5LlxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbWVtb3J5SXRlbSA9IGl0ZW0gYXMgTWVtb3J5QWxsb3dlZFByaW1pdGl2ZVR5cGVzO1xuICAgICAgICBpZiAoaXRlbSAhPT0gbnVsbCAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgIWl0ZW1bbWVtb3J5UHJveHlOb3RWZXJzaW9uYWJsZUtleV0pIHtcbiAgICAgICAgICAgIC8vIFRoZSBpdGVtIGlzIHZlcnNpb25hYmxlLCBncmVhdCwgYnV0IGl0IGlzIG5vdCB2ZXJzaW9uZWQgeWV0ICFcbiAgICAgICAgICAgIC8vIFRoaXMgY2FsbCB2ZXJzaW9ucyBpdCBpbnRvIHRoZSBtZW1vcnkuXG4gICAgICAgICAgICBtZW1vcnkubGlua1RvTWVtb3J5KGl0ZW0gYXMgb2JqZWN0KTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1QYXJhbXMgPSBpdGVtW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICAgICAgbWVtb3J5SXRlbSA9IGl0ZW1QYXJhbXMuSUQ7XG4gICAgICAgICAgICBtZW1vcnkuYWRkU2xpY2VQcm94eVBhcmVudChpdGVtUGFyYW1zLklELCBwYXJhbXMuSUQsIHVuZGVmaW5lZCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgY3VycmVudCBzbGljZS5cbiAgICAgICAgY29uc3Qgc2xpY2UgPSBtZW1vcnkuZ2V0U2xpY2UoKTtcbiAgICAgICAgbGV0IG1lbW9yeVNldCA9IHNsaWNlW3BhcmFtcy5JRCBhcyBudW1iZXJdIGFzIE1lbW9yeVR5cGVTZXQ7IC8vIHJlYWQgdGhlIHB1cmUgdmFsdWUgc3RvcmVkIGluIG1lbW9yeVxuICAgICAgICBpZiAoIW1lbW9yeVNldCkge1xuICAgICAgICAgICAgc2xpY2VbcGFyYW1zLklEIGFzIG51bWJlcl0gPSBtZW1vcnlTZXQgPSBuZXcgTWVtb3J5VHlwZVNldCgpO1xuICAgICAgICAgICAgLy8gTWFyayB0aGUgc2V0IGFzIGJlaW5nIG1vZGlmaWVkIGluIHRoaXMgc2xpY2UgKG5vdCBuZWNlc2FyaWxseSBcImRpcnR5XCIpXG4gICAgICAgICAgICBtZW1vcnkubWFya0RpcnR5KHBhcmFtcy5JRCk7IC8vIG1hcmsgdGhlIGNhY2hlIGFzIGludmFsaWQgd2hlbiBjaGFuZ2UgdGhlIHNsaWRlIG1lbW9yeVxuICAgICAgICB9XG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgc3RvcmVkIGNoYW5nZXMgZm9yIHRoaXMgc2xpY2VcbiAgICAgICAgbWVtb3J5U2V0LmFkZC5hZGQobWVtb3J5SXRlbSk7XG4gICAgICAgIG1lbW9yeVNldC5kZWxldGUuZGVsZXRlKG1lbW9yeUl0ZW0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBkZWxldGUoaXRlbTogVCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzW21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgICAgICBjb25zdCBtZW1vcnkgPSBwYXJhbXMubWVtb3J5O1xuICAgICAgICBpZiAobWVtb3J5ICYmIG1lbW9yeS5pc0Zyb3plbigpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRnJvemVuRXJyb3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoZWNrID0gdGhpcy5oYXMoaXRlbSk7XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgcGFyYW1zLm9iamVjdC5kZWxldGUuY2FsbCh0aGlzLCBpdGVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY2hlY2sgfHwgIW1lbW9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG1lbW9yeUl0ZW0gPSBpdGVtIGFzIE1lbW9yeUFsbG93ZWRQcmltaXRpdmVUeXBlcztcbiAgICAgICAgY29uc3QgaXRlbVBhcmFtcyA9IGl0ZW0gJiYgdHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIGl0ZW1bbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgICAgIGlmIChpdGVtUGFyYW1zKSB7XG4gICAgICAgICAgICBtZW1vcnlJdGVtID0gaXRlbVBhcmFtcy5JRCBhcyBWZXJzaW9uYWJsZUlEO1xuICAgICAgICAgICAgbWVtb3J5LmRlbGV0ZVNsaWNlUHJveHlQYXJlbnQoaXRlbVBhcmFtcy5JRCwgcGFyYW1zLklELCB1bmRlZmluZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2xpY2UgPSBtZW1vcnkuZ2V0U2xpY2UoKTtcbiAgICAgICAgbGV0IG1lbW9yeVNldCA9IHNsaWNlW3BhcmFtcy5JRCBhcyBudW1iZXJdIGFzIE1lbW9yeVR5cGVTZXQ7XG4gICAgICAgIGlmICghbWVtb3J5U2V0KSB7XG4gICAgICAgICAgICBzbGljZVtwYXJhbXMuSUQgYXMgbnVtYmVyXSA9IG1lbW9yeVNldCA9IG5ldyBNZW1vcnlUeXBlU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgbWVtb3J5U2V0LmRlbGV0ZS5hZGQobWVtb3J5SXRlbSk7XG4gICAgICAgIG1lbW9yeVNldC5hZGQuZGVsZXRlKG1lbW9yeUl0ZW0pO1xuXG4gICAgICAgIG1lbW9yeS5tYXJrRGlydHkocGFyYW1zLklEKTsgLy8gbWFyayB0aGUgY2FjaGUgYXMgaW52YWxpZCB3aGVuIGNoYW5nZSB0aGUgc2xpZGUgbWVtb3J5XG5cbiAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgIH1cbiAgICBjbGVhcigpOiB0aGlzIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpc1ttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgY29uc3QgbWVtb3J5ID0gcGFyYW1zLm1lbW9yeTtcbiAgICAgICAgaWYgKG1lbW9yeSAmJiBtZW1vcnkuaXNGcm96ZW4oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEZyb3plbkVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIW1lbW9yeSkge1xuICAgICAgICAgICAgcGFyYW1zLm9iamVjdC5jbGVhci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzbGljZSA9IG1lbW9yeS5nZXRTbGljZSgpO1xuICAgICAgICBsZXQgbWVtb3J5U2V0ID0gc2xpY2VbcGFyYW1zLklEIGFzIG51bWJlcl0gYXMgTWVtb3J5VHlwZVNldDtcbiAgICAgICAgaWYgKCFtZW1vcnlTZXQpIHtcbiAgICAgICAgICAgIHNsaWNlW3BhcmFtcy5JRCBhcyBudW1iZXJdID0gbWVtb3J5U2V0ID0gbmV3IHBhcmFtcy5NZW1vcnlUeXBlKCkgYXMgTWVtb3J5VHlwZVNldDtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmFtcy5vYmplY3QuZm9yRWFjaC5jYWxsKHRoaXMsIChpdGVtOiBUKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtUGFyYW1zID0gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbVttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgICAgIGlmIChpdGVtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1QYXJhbXMuSUQ7XG4gICAgICAgICAgICAgICAgbWVtb3J5LmRlbGV0ZVNsaWNlUHJveHlQYXJlbnQoaXRlbVBhcmFtcy5JRCwgcGFyYW1zLklELCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWVtb3J5U2V0LmRlbGV0ZS5hZGQoaXRlbSk7XG4gICAgICAgICAgICBtZW1vcnlTZXQuYWRkLmRlbGV0ZShpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHBhcmFtcy5vYmplY3QuY2xlYXIuY2FsbCh0aGlzKTtcblxuICAgICAgICBtZW1vcnkubWFya0RpcnR5KHBhcmFtcy5JRCk7IC8vIG1hcmsgdGhlIGNhY2hlIGFzIGludmFsaWQgd2hlbiBjaGFuZ2UgdGhlIHNsaWRlIG1lbW9yeVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaGFzKGl0ZW06IFQpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpc1ttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgcmV0dXJuIHBhcmFtcy5vYmplY3QuaGFzLmNhbGwodGhpcywgaXRlbSk7XG4gICAgfVxuICAgIHZhbHVlcygpOiBJdGVyYWJsZUl0ZXJhdG9yPFQ+IHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpc1ttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgcmV0dXJuIHBhcmFtcy5vYmplY3QudmFsdWVzLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIGtleXMoKTogSXRlcmFibGVJdGVyYXRvcjxUPiB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXNbbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgICAgIHJldHVybiBwYXJhbXMub2JqZWN0LmtleXMuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgZm9yRWFjaChjYWxsYmFjazogKHZhbHVlOiBULCB2YWx1ZTI6IFQsIHNldDogU2V0PFQ+KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXNbbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgICAgIHJldHVybiBwYXJhbXMub2JqZWN0LmZvckVhY2guY2FsbCh0aGlzLCBjYWxsYmFjayk7XG4gICAgfVxuICAgIGVudHJpZXMoKTogSXRlcmFibGVJdGVyYXRvcjxbVCwgVF0+IHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpc1ttZW1vcnlQcm94eVByYW1zS2V5XTtcbiAgICAgICAgcmV0dXJuIHBhcmFtcy5vYmplY3QuZW50cmllcy5jYWxsKHRoaXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJveGlmeVN5bmNTZXQoKTogdm9pZCB7XG4gICAgLy8gU3luY2hyb25pemF0aW9uIGZ1bmN0aW9uXG4gICAgLy8gTW9zdCBtZXRob2RzIG9mIHRoZSBcInByb3h5XCIgd2lsbCBjYWxsIHRoaXMgc3luY2hyb25pemF0aW9uIGZ1bmN0aW9uLCBldmVuXG4gICAgLy8gaWYgaXQgaXMgbm90IHlldCBsaW5rZWQgdG8gYSBtZW1vcnkgIVxuICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMgYXMgU2V0UGFyYW1zO1xuICAgIGNvbnN0IG1lbW9yeSA9IHBhcmFtcy5tZW1vcnk7XG4gICAgY29uc3Qgb2JqZWN0ID0gcGFyYW1zLm9iamVjdDtcbiAgICBjb25zdCBwcm94eSA9IHBhcmFtcy5wcm94eTtcbiAgICAvLyBnZXQgY3VycmVudCBvYmplY3Qgc3RhdGUgaW4gbWVtb3J5XG4gICAgY29uc3QgbWVtb3J5U2V0ID0gbWVtb3J5LmdldFNsaWNlVmFsdWUocGFyYW1zLklEKSBhcyBNZW1vcnlDb21waWxlZFNldDtcblxuICAgIC8vIHJlc2V0IGFsbCBrZXlzICgrIGV4cGxhbmF0aW9uIG9mIGJlc3Qvd29yc3QgY2FzZSBzY2VuYXJpbylcbiAgICBvYmplY3QuY2xlYXIuY2FsbChwcm94eSk7XG4gICAgaWYgKCFtZW1vcnlTZXQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBVcGRhdGUgdmFsdWVzIGFjY29yZGluZyB0byB3aGF0IGlzIHN0b3JlZFxuICAgIG1lbW9yeVNldC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIFZlcnNpb25hYmxlSUQpIHtcbiAgICAgICAgICAgIGl0ZW0gPSBtZW1vcnkuZ2V0UHJveHkoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0LmFkZC5jYWxsKHByb3h5LCBpdGVtKTtcbiAgICB9KTtcbn1cblxuLy8gVGhpcyB3aWxsIGJlIHNldCBvbiB0aGUgdmVyc2lvbmFibGUgcGFyYW1zIG9iamVjdCBhbmQgY2FsbGVkIHdpdGggdGhlIHBhcmFtc1xuLy8gYXMgdGhlIHZhbHVlIG9mIGB0aGlzYC4gSXQgaXMgY3JlYXRlZCBoZXJlIHNvIHRoYXQgaXQgaXMgY3JlYXRlZCBvbmx5IG9uY2UgIVxuZnVuY3Rpb24gbGlua1ZlcnNpb25hYmxlKG1lbW9yeTogTWVtb3J5V29ya2VyKTogdm9pZCB7XG4gICAgY29uc3QgcGFyYW1zID0gdGhpcyBhcyBTZXRQYXJhbXM7XG4gICAgcGFyYW1zLm1lbW9yeSA9IG1lbW9yeTtcbiAgICBwYXJhbXMuc3luY2hyb25pemUgPSBwcm94aWZ5U3luY1NldDtcbiAgICBtZW1vcnkubWFya0RpcnR5KHBhcmFtcy5JRCk7XG4gICAgaWYgKCFwYXJhbXMucHJveHkuc2l6ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHNsaWNlID0gbWVtb3J5LmdldFNsaWNlKCk7XG5cbiAgICBjb25zdCBtZW1vcnlTZXQgPSBuZXcgcGFyYW1zLk1lbW9yeVR5cGUoKSBhcyBNZW1vcnlUeXBlU2V0O1xuICAgIHNsaWNlW3BhcmFtcy5JRCBhcyBudW1iZXJdID0gbWVtb3J5U2V0OyAvLyBzdG9yZSB0aGUgXCJwdXJlXCIgdmFsdWUgaW4gbWVtb3J5XG4gICAgcGFyYW1zLm9iamVjdC5mb3JFYWNoLmNhbGwocGFyYW1zLnByb3h5LCAodmFsdWU6IE1lbW9yeUFsbG93ZWRUeXBlKTogdm9pZCA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlUGFyYW1zID1cbiAgICAgICAgICAgIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWVbbWVtb3J5UHJveHlQcmFtc0tleV07XG4gICAgICAgIGlmICh2YWx1ZVBhcmFtcykge1xuICAgICAgICAgICAgLy8gSWYgb2JqZWN0IGlzIHZlcnNpb25hYmxlIHRoZW4gbGluayBpdCB0byBtZW1vcnkgYXMgd2VsbFxuICAgICAgICAgICAgbWVtb3J5LmxpbmtUb01lbW9yeSh2YWx1ZSBhcyBvYmplY3QpO1xuICAgICAgICAgICAgbWVtb3J5LmFkZFNsaWNlUHJveHlQYXJlbnQodmFsdWVQYXJhbXMuSUQsIHBhcmFtcy5JRCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIG1lbW9yeVNldC5hZGQuYWRkKHZhbHVlUGFyYW1zLklEKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lbW9yeVNldC5hZGQuYWRkKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX3Byb3hpZnlTZXQ8VCBleHRlbmRzIE1lbW9yeUFsbG93ZWRUeXBlPihzZXQ6IFNldDxUPik6IFZlcnNpb25hYmxlU2V0IHtcbiAgICBjb25zdCB2ZXJzaW9uYWJsZVNldCA9IG5ldyBWZXJzaW9uYWJsZVNldChzZXQpO1xuICAgIHNldFttZW1vcnlQcm94eVByYW1zS2V5XSA9IHZlcnNpb25hYmxlU2V0W21lbW9yeVByb3h5UHJhbXNLZXldO1xuICAgIHJldHVybiB2ZXJzaW9uYWJsZVNldDtcbn1cbiIsImltcG9ydCB7IEN1c3RvbUVycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL2Vycm9ycyc7XG5cbmV4cG9ydCBjb25zdCBtZW1vcnlQcm94eU5vdFZlcnNpb25hYmxlS2V5ID0gU3ltYm9sKCdqYWJiZXJ3b2NrTWVtb3J5Tm90VmVyc2lvbmFibGUnKTtcbmV4cG9ydCBjb25zdCBtZW1vcnlQcm94eVByYW1zS2V5ID0gU3ltYm9sKCdqYWJiZXJ3b2NrTWVtb3J5UGFyYW1zJyk7XG5leHBvcnQgY29uc3QgcmVtb3ZlZEl0ZW0gPSBTeW1ib2woJ2phYmJlcndvY2tNZW1vcnlSZW1vdmVkSXRlbScpO1xuZXhwb3J0IGNvbnN0IHN5bWJvbFZlcmlmeSA9IFN5bWJvbCgnamFiYmVyd29ja01lbW9yeVZlcmlmeScpO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2UgcmVwcmVzZW50aW5nIGFuIGVycm9yIHRoYXQgb2NjdXJzIHdoZW4gdGhleXIgYXJlIGFueVxuICogZXJyb3IgaW4gdGhlIG1lbW9yeSBmZWF0dXJlIG9yIHdpdGggdGhlIGludGVncmF0aW9uIG9mIHRoZSBtZW1vcnkuXG4gKi9cbmV4cG9ydCBjbGFzcyBNZW1vcnlFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlPzogc3RyaW5nLCAuLi5wYXJhbXMpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgLi4ucGFyYW1zKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnSmFiYmVyd29rIGVycm9yIGluIG1lbW9yeSBmZWF0dXJlJztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgTm90VmVyc2lvbmFibGVFcnJvciBleHRlbmRzIE1lbW9yeUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID1cbiAgICAgICAgICAgICdZb3UgY2FuIG9ubHkgbGluayB0byB0aGUgbWVtb3J5IHRoZSBpbnN0YW5jZSBvZiBWZXJzaW9uYWJsZU9iamVjdCwgVmVyc2lvbmFibGVBcnJheSBvciBWZXJzaW9uYWJsZVNldC4nICtcbiAgICAgICAgICAgIFwiXFxuSWYgdGhhdCdzIG5vdCBwb3NzaWJsZSwgdGhlbiB5b3UgY2FuIGFsc28gdXNlIG1ha2VWZXJzaW9uYWJsZSBtZXRob2Qgb24geW91ciBjdXN0b20gb2JqZWN0LlwiICtcbiAgICAgICAgICAgICdcXG5JZiB5b3UgZG8gbm90IHdhbnQgdG8gbWFrZSB2ZXJzaW9uYWJsZSB0aGlzIG9iamVjdCwgaW5kaWNhdGUgaXQgdXNpbmcgTWFya05vdFZlcnNpb25hYmxlIG1ldGhvZCcgK1xuICAgICAgICAgICAgJ1xcblBsZWFzZSByZWFkIHRoZSBKYWJiZXJ3b2NrIGRvY3VtZW50YXRpb24uJztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVmVyc2lvbmFibGVBbGxyZWFkeVZlcnNpb25hYmxlRXJyb3IgZXh0ZW5kcyBNZW1vcnlFcnJvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9XG4gICAgICAgICAgICAnVGhpcyBvYmplY3Qgd2FzIGFscmVhZHkgdXBkYXRlIGFuZCBhIHByb3h5IHdhcyBjcmVhdGUgdG8gYmUgdmVyc2lvbmFibGUuJyArXG4gICAgICAgICAgICAnXFxuUGxlYXNlIHVzZSBpdCBpbnN0ZWFkIG9mIHRoZSBzb3VyY2Ugb2JqZWN0Lic7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEZyb3plbkVycm9yIGV4dGVuZHMgTWVtb3J5RXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPVxuICAgICAgICAgICAgJ1RoaXMgbWVtb3J5IGlzIGZyb3plbiBhbmQgaW1tdXRhYmxlLicgK1xuICAgICAgICAgICAgJ1xcbllvdSBjYW4gbm90IHVwZGF0ZSBhIG1lbW9yeSB2ZXJzaW9uIHdobyBjb250ZW50IG1lbW9yeSBkZXBlbmRlbmNpZXMnO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFByZWRpY2F0ZSwgVk5vZGUgfSBmcm9tICcuL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBDb250ZXh0TWFuYWdlciwgQ29udGV4dHVhbEVudHJ5IH0gZnJvbSAnLi9Db250ZXh0TWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZVJ1bGUge1xuICAgIHNlbGVjdG9yOiBQcmVkaWNhdGVbXTtcbiAgICBwcm9wZXJ0aWVzOiB7IFtLIGluIFJ1bGVQcm9wZXJ0eV0/OiBQcm9wZXJ0eURlZmluaXRpb24gfTtcbn1cbmV4cG9ydCB0eXBlIE1vZGVJZGVudGlmaWVyID0gc3RyaW5nO1xuZXhwb3J0IGludGVyZmFjZSBNb2RlRGVmaW5pdGlvbiB7XG4gICAgaWQ6IE1vZGVJZGVudGlmaWVyO1xuICAgIHJ1bGVzOiBNb2RlUnVsZVtdO1xufVxuZXhwb3J0IGludGVyZmFjZSBQcm9wZXJ0eURlZmluaXRpb24ge1xuICAgIHZhbHVlOiBib29sZWFuO1xuICAgIGNhc2NhZGluZz86IGJvb2xlYW47IC8vIGRlZmF1bHQ6IGZhbHNlXG59XG4vKipcbiAqIFByb3BlcnRpZXMgb2YgYSBgVk5vZGVgIHRoYXQgY2FuIGJlIG1vZGlmaWVkIGJ5IGEgbW9kZS5cbiAqL1xuZXhwb3J0IGVudW0gUnVsZVByb3BlcnR5IHtcbiAgICBFRElUQUJMRSA9ICdlZGl0YWJsZScsXG4gICAgQlJFQUtBQkxFID0gJ2JyZWFrYWJsZScsXG4gICAgQUxMT1dfRU1QVFkgPSAnYWxsb3dFbXB0eScsXG59XG5cbnR5cGUgUnVsZUVudHJpZXMgPSBQYXJ0aWFsPFJlY29yZDxSdWxlUHJvcGVydHksIENvbnRleHR1YWxFbnRyeTxQcm9wZXJ0eURlZmluaXRpb24+W10+PjtcblxuZXhwb3J0IGNsYXNzIE1vZGUge1xuICAgIGlkOiBNb2RlSWRlbnRpZmllcjtcbiAgICByZWFkb25seSBydWxlczogTW9kZVJ1bGVbXTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9lbnRyaWVzOiBSdWxlRW50cmllcztcbiAgICBjb25zdHJ1Y3Rvcihtb2RlOiBNb2RlRGVmaW5pdGlvbikge1xuICAgICAgICB0aGlzLmlkID0gbW9kZS5pZDtcbiAgICAgICAgdGhpcy5ydWxlcyA9IG1vZGUucnVsZXM7XG5cbiAgICAgICAgLy8gQ29udmVydCB0aGUgcnVsZXMgaW50byBhbiBvYmplY3QgZGVzY3JpYmluZyB0aGVtIGZvciBlYWNoIHByb3BlcnR5LlxuICAgICAgICBjb25zdCBydWxlRW50cmllczogUnVsZUVudHJpZXMgPSB7fTtcbiAgICAgICAgdGhpcy5fZW50cmllcyA9IHRoaXMucnVsZXMucmVkdWNlKChhY2N1bXVsYXRvciwgcnVsZSkgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBPYmplY3Qua2V5cyhydWxlLnByb3BlcnRpZXMpIGFzIFJ1bGVQcm9wZXJ0eVtdKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW50cnk6IENvbnRleHR1YWxFbnRyeTxQcm9wZXJ0eURlZmluaXRpb24+ID0ge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogcnVsZS5zZWxlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJ1bGUucHJvcGVydGllc1twcm9wZXJ0eV0sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoIXJ1bGVFbnRyaWVzW3Byb3BlcnR5XSkgcnVsZUVudHJpZXNbcHJvcGVydHldID0gW107XG4gICAgICAgICAgICAgICAgcnVsZUVudHJpZXNbcHJvcGVydHldLnB1c2goZW50cnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgICAgICB9LCBydWxlRW50cmllcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoaXMgbW9kZSBkZWZpbmVzIHRoZSBnaXZlbiBub2RlJ3MgcHJvcGVydHkgYXMgdHJ1ZS4gSWZcbiAgICAgKiB0aGUgbW9kZSBkb2VzIG5vdCBkZWZpbmUgYSB2YWx1ZSBmb3IgdGhlIGdpdmVuIG5vZGUncyBwcm9wZXJ0eSB0aGVuXG4gICAgICogcmV0dXJuIHRydWUgaWYgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgb24gdGhlIG5vZGUgaXRzZWxmIGlzXG4gICAgICogdHJ1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICogQHBhcmFtIHByb3BlcnR5XG4gICAgICovXG4gICAgaXMobm9kZTogVk5vZGUsIHByb3BlcnR5OiBSdWxlUHJvcGVydHkpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaGllcmFyY2h5ID0gW25vZGUsIC4uLm5vZGUuYW5jZXN0b3JzKCldO1xuICAgICAgICBjb25zdCBlbnRyaWVzID0gdGhpcy5fZW50cmllc1twcm9wZXJ0eV0gfHwgW107XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IENvbnRleHRNYW5hZ2VyLmdldFJhbmtlZE1hdGNoZXMoaGllcmFyY2h5LCBlbnRyaWVzKTtcbiAgICAgICAgLy8gRm9yIGVhY2ggcmVzdWx0IGZyb20gYSBub24tY2FzY2FkaW5nIHJ1bGUgcHJvcGVydHksIGtlZXAgb25seSB0aGVcbiAgICAgICAgLy8gb25lcyB0aGF0IG1hdGNoIHRoZSBnaXZlbiBub2RlLCBub3Qgb25lIG9mIGl0cyBhbmNlc3RvcnMuXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkUmVzdWx0cyA9IHJlc3VsdC5maWx0ZXIoXG4gICAgICAgICAgICByID0+IHIuZW50cnkudmFsdWUuY2FzY2FkaW5nIHx8IHIubWF0Y2hlZC5zb21lKG1hdGNoID0+IG1hdGNoID09PSBub2RlKSxcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGZpbHRlcmVkUmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZFJlc3VsdHNbMF0uZW50cnkudmFsdWUudmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZVtwcm9wZXJ0eV07XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4vVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFZlcnNpb25hYmxlT2JqZWN0IH0gZnJvbSAnLi9NZW1vcnkvVmVyc2lvbmFibGVPYmplY3QnO1xuXG5leHBvcnQgdHlwZSBNb2RpZmllclR5cGVndWFyZDxUIGV4dGVuZHMgTW9kaWZpZXI+ID0gKG1vZGlmaWVyOiBNb2RpZmllcikgPT4gbW9kaWZpZXIgaXMgVDtcbmV4cG9ydCB0eXBlIE1vZGlmaWVyUHJlZGljYXRlPFQgPSBNb2RpZmllciB8IGJvb2xlYW4+ID0gVCBleHRlbmRzIE1vZGlmaWVyXG4gICAgPyBDb25zdHJ1Y3RvcjxUPiB8IE1vZGlmaWVyVHlwZWd1YXJkPFQ+XG4gICAgOiAobW9kaWZpZXI6IE1vZGlmaWVyKSA9PiBib29sZWFuO1xuXG5pbnRlcmZhY2UgTW9kaWZpZXJDb25zdHJ1Y3RvciB7XG4gICAgbmV3IDxUIGV4dGVuZHMgQ29uc3RydWN0b3I8TW9kaWZpZXI+PiguLi5hcmdzOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8VD4pOiB0aGlzO1xufVxuZXhwb3J0IGludGVyZmFjZSBNb2RpZmllciB7XG4gICAgY29uc3RydWN0b3I6IE1vZGlmaWVyQ29uc3RydWN0b3IgJiB0aGlzO1xufVxuZXhwb3J0IGludGVyZmFjZSBNb2RpZmllclByZXNlcnZlIHtcbiAgICBhZnRlcjogYm9vbGVhbjsgLy8gVHJ1ZSB0byBwcmVzZXJ2ZSBtb2RpZmllciBhZnRlciB0aGUgbm9kZSB0aGF0IGhvbGRzIGl0LlxuICAgIHBhcmFncmFwaEJyZWFrOiBib29sZWFuOyAvLyBUcnVlIHRvIHByZXNlcnZlIG1vZGlmaWVyIGFmdGVyIGEgcGFyYWdyYXBoIGJyZWFrLlxuICAgIGxpbmVCcmVhazogYm9vbGVhbjsgLy8gVHJ1ZSB0byBwcmVzZXJ2ZSBtb2RpZmllciBhZnRlciBhIGxpbmUgYnJlYWsuXG59XG5leHBvcnQgY2xhc3MgTW9kaWZpZXIgZXh0ZW5kcyBWZXJzaW9uYWJsZU9iamVjdCB7XG4gICAgcHJlc2VydmU6IE1vZGlmaWVyUHJlc2VydmUgPSBuZXcgVmVyc2lvbmFibGVPYmplY3Qoe1xuICAgICAgICBhZnRlcjogdHJ1ZSxcbiAgICAgICAgcGFyYWdyYXBoQnJlYWs6IHRydWUsXG4gICAgICAgIGxpbmVCcmVhazogdHJ1ZSxcbiAgICB9KSBhcyBNb2RpZmllclByZXNlcnZlO1xuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYXBwbHlUbyhub2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICBub2RlLm1vZGlmaWVycy5wcmVwZW5kKHRoaXMpO1xuICAgIH1cbiAgICBpc1NhbWVBcyhvdGhlck1vZGlmaWVyOiBNb2RpZmllciB8IHZvaWQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IG90aGVyTW9kaWZpZXI7XG4gICAgfVxuICAgIGNsb25lKCk6IHRoaXMge1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNb2RpZmllciB9IGZyb20gJy4vTW9kaWZpZXInO1xuaW1wb3J0IHsgQ29uc3RydWN0b3IsIGlzQ29uc3RydWN0b3IgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgVmVyc2lvbmFibGVPYmplY3QgfSBmcm9tICcuL01lbW9yeS9WZXJzaW9uYWJsZU9iamVjdCc7XG5pbXBvcnQgeyBWZXJzaW9uYWJsZUFycmF5IH0gZnJvbSAnLi9NZW1vcnkvVmVyc2lvbmFibGVBcnJheSc7XG5cbmV4cG9ydCBjbGFzcyBNb2RpZmllcnMgZXh0ZW5kcyBWZXJzaW9uYWJsZU9iamVjdCB7XG4gICAgcHJpdmF0ZSBfY29udGVudHM6IE1vZGlmaWVyW107XG4gICAgY29uc3RydWN0b3IoLi4ubW9kaWZpZXJzOiBBcnJheTxNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPj4pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgY29uc3QgY2xvbmVkTW9kaWZpZXJzID0gbW9kaWZpZXJzLm1hcChtb2QgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG1vZCBpbnN0YW5jZW9mIE1vZGlmaWVyID8gbW9kLmNsb25lKCkgOiBtb2Q7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFwcGVuZCguLi5jbG9uZWRNb2RpZmllcnMpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHZXR0ZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIGFycmF5LlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRzPy5sZW5ndGggfHwgMDtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBNb2RpZmllcnMgY2xhc3MgY29udGFpbmluZyB0aGUgc2FtZVxuICAgICAqIG1vZGlmaWVycy5cbiAgICAgKi9cbiAgICBjbG9uZSgpOiBNb2RpZmllcnMge1xuICAgICAgICBpZiAodGhpcy5fY29udGVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTW9kaWZpZXJzKC4uLnRoaXMuX2NvbnRlbnRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTW9kaWZpZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQXBwZW5kIG9uZSBvciBtb3JlIG1vZGlmaWVycyB0byB0aGUgYXJyYXkuIElmIG9uZSBvZiB0aGUgZ2l2ZW4gbW9kaWZpZXJzXG4gICAgICogaXMgYSBtb2RpZmllciBjbGFzcyBjb25zdHJ1Y3RvciwgaW5zdGFudGlhdGUgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJzXG4gICAgICovXG4gICAgYXBwZW5kKC4uLm1vZGlmaWVyczogQXJyYXk8TW9kaWZpZXIgfCBDb25zdHJ1Y3RvcjxNb2RpZmllcj4+KTogdm9pZCB7XG4gICAgICAgIGlmIChtb2RpZmllcnMubGVuZ3RoICYmICF0aGlzLl9jb250ZW50cykge1xuICAgICAgICAgICAgdGhpcy5fY29udGVudHMgPSBuZXcgVmVyc2lvbmFibGVBcnJheSgpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgbW9kaWZpZXJzKSB7XG4gICAgICAgICAgICBpZiAobW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzLnB1c2gobW9kaWZpZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50cy5wdXNoKG5ldyBtb2RpZmllcigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmVwZW5kIG9uZSBvciBtb3JlIG1vZGlmaWVycyB0byB0aGUgYXJyYXkuIElmIG9uZSBvZiB0aGUgZ2l2ZW4gbW9kaWZpZXJzXG4gICAgICogaXMgYSBtb2RpZmllciBjbGFzcyBjb25zdHJ1Y3RvciwgaW5zdGFudGlhdGUgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJzXG4gICAgICovXG4gICAgcHJlcGVuZCguLi5tb2RpZmllcnM6IEFycmF5PE1vZGlmaWVyIHwgQ29uc3RydWN0b3I8TW9kaWZpZXI+Pik6IHZvaWQge1xuICAgICAgICBpZiAobW9kaWZpZXJzLmxlbmd0aCAmJiAhdGhpcy5fY29udGVudHMpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzID0gbmV3IFZlcnNpb25hYmxlQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IG1vZGlmaWVyIG9mIFsuLi5tb2RpZmllcnNdLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVyIGluc3RhbmNlb2YgTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50cy51bnNoaWZ0KG1vZGlmaWVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGVudHMudW5zaGlmdChuZXcgbW9kaWZpZXIoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBtb2RpZmllciBpbiB0aGUgYXJyYXkgdGhhdCBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW5cbiAgICAgKiBNb2RpZmllciBjbGFzcywgaWYgYW55LlxuICAgICAqIElmIHRoZSBtb2RpZmllciBwYXNzZWQgaXMgYSBNb2RpZmllciBpbnN0YW5jZSwgcmV0dXJuIGl0IGlmIGl0IHdhc1xuICAgICAqIHByZXNlbnQgaW4gdGhlIGFycmF5LlxuICAgICAqIFRoaXMgYWxzbyBmdW5jdGlvbnMgYXMgYSBwcm94eSB0byB0aGUgbmF0aXZlIGBmaW5kYCBtZXRob2Qgb2YgYEFycmF5YCxcbiAgICAgKiBmb3IgYHRoaXMuX2NvbnRlbnRzYC5cbiAgICAgKlxuICAgICAqIEBzZWUgQXJyYXkuZmluZFxuICAgICAqIEBwYXJhbSBtb2RpZmllclxuICAgICAqL1xuICAgIGZpbmQ8VCBleHRlbmRzIE1vZGlmaWVyPihjYWxsYmFjazogKG1vZGlmaWVyOiBUKSA9PiBib29sZWFuKTogVDtcbiAgICBmaW5kPFQgZXh0ZW5kcyBNb2RpZmllcj4obW9kaWZpZXI6IFQgfCBDb25zdHJ1Y3RvcjxUPik6IFQ7XG4gICAgZmluZDxUIGV4dGVuZHMgTW9kaWZpZXI+KG1vZGlmaWVyOiAoKG1vZGlmaWVyOiBUKSA9PiBib29sZWFuKSB8IFQgfCBDb25zdHJ1Y3RvcjxUPik6IFQge1xuICAgICAgICBpZiAoIXRoaXMuX2NvbnRlbnRzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAobW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgLy8gYG1vZGlmaWVyYCBpcyBhbiBpbnN0YW5jZSBvZiBgTW9kaWZpZXJgIC0+IGZpbmQgaXQgaW4gdGhlIGFycmF5LlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRzLmZpbmQoaW5zdGFuY2UgPT4gaW5zdGFuY2UgPT09IG1vZGlmaWVyKSBhcyBUO1xuICAgICAgICB9IGVsc2UgaWYgKGlzQ29uc3RydWN0b3I8dHlwZW9mIE1vZGlmaWVyPihtb2RpZmllciwgTW9kaWZpZXIpKSB7XG4gICAgICAgICAgICAvLyBgbW9kaWZpZXJgIGlzIGEgYE1vZGlmaWVyYCBjbGFzcyAtPiBmaW5kIGl0cyBmaXJzdCBpbnN0YW5jZSBpblxuICAgICAgICAgICAgLy8gdGhlIGFycmF5LlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRzLmZpbmQobW9kID0+IG1vZC5jb25zdHJ1Y3Rvci5uYW1lID09PSBtb2RpZmllci5uYW1lKSBhcyBUO1xuICAgICAgICB9IGVsc2UgaWYgKG1vZGlmaWVyIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIGBtb2RpZmllcmAgaXMgYSBjYWxsYmFjayAtPiBjYWxsIGBmaW5kYCBuYXRpdmVseSBvbiB0aGUgYXJyYXkuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudHMuZmluZChtb2RpZmllcikgYXMgVDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpcnN0IG1vZGlmaWVyIGluIHRoZSBhcnJheSB0aGF0IGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzIG9yIGNyZWF0ZSBvbmUsIGFwcGVuZCBpdCBhbmQgcmV0dXJuIGl0LlxuICAgICAqIElmIHRoZSBtb2RpZmllciBwYXNzZWQgaXMgYSBtb2RpZmllciBpbnN0YW5jZSwgcmV0dXJuIGl0IGlmIGl0IHdhc1xuICAgICAqIHByZXNlbnQgaW4gdGhlIGFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICovXG4gICAgZ2V0PFQgZXh0ZW5kcyBNb2RpZmllcj4obW9kaWZpZXI6IFQgfCBDb25zdHJ1Y3RvcjxUPik6IFQge1xuICAgICAgICBsZXQgZm91bmQgPSB0aGlzLmZpbmQobW9kaWZpZXIpO1xuICAgICAgICBpZiAoIWZvdW5kICYmIGlzQ29uc3RydWN0b3I8dHlwZW9mIE1vZGlmaWVyPihtb2RpZmllciwgTW9kaWZpZXIpKSB7XG4gICAgICAgICAgICBmb3VuZCA9IG5ldyBtb2RpZmllcigpO1xuICAgICAgICAgICAgdGhpcy5hcHBlbmQoZm91bmQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBtb2RpZmllcnMgaW4gdGhlIGFycmF5IHRoYXQgYXJlIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzLCBpZiBhbnkuXG4gICAgICogVGhpcyBhbHNvIGZ1bmN0aW9ucyBhcyBhIHByb3h5IHRvIHRoZSBuYXRpdmUgYGZpbHRlcmAgbWV0aG9kIG9mIGBBcnJheWAsXG4gICAgICogZm9yIGB0aGlzLl9jb250ZW50c2AuXG4gICAgICpcbiAgICAgKiBAc2VlIEFycmF5LmZpbHRlclxuICAgICAqIEBwYXJhbSBtb2RpZmllclxuICAgICAqL1xuICAgIGZpbHRlcjxUIGV4dGVuZHMgTW9kaWZpZXI+KFxuICAgICAgICBjYWxsYmFja2ZuOiAodmFsdWU6IE1vZGlmaWVyLCBpbmRleDogbnVtYmVyLCBhcnJheTogTW9kaWZpZXJbXSkgPT4gYm9vbGVhbixcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdGhpc0FyZz86IGFueSxcbiAgICApOiBUW107XG4gICAgZmlsdGVyPFQgZXh0ZW5kcyBNb2RpZmllcj4obW9kaWZpZXI6IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIGZpbHRlcjxUIGV4dGVuZHMgTW9kaWZpZXI+KFxuICAgICAgICBtb2RpZmllcjogKCh2YWx1ZTogTW9kaWZpZXIsIGluZGV4OiBudW1iZXIsIGFycmF5OiBNb2RpZmllcltdKSA9PiBib29sZWFuKSB8IENvbnN0cnVjdG9yPFQ+LFxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzQXJnPzogYW55LFxuICAgICk6IFRbXSB7XG4gICAgICAgIGlmICghdGhpcy5fY29udGVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0NvbnN0cnVjdG9yPHR5cGVvZiBNb2RpZmllcj4obW9kaWZpZXIsIE1vZGlmaWVyKSkge1xuICAgICAgICAgICAgLy8gYG1vZGlmaWVyYCBpcyBhIGBNb2RpZmllcmAgY2xhc3MgLT4gcmV0dXJuIGFsbCBpbnN0YW5jZXMgb2YgaXQgaW5cbiAgICAgICAgICAgIC8vIHRoZSBhcnJheS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5maWx0ZXIobSA9PiBtIGluc3RhbmNlb2YgbW9kaWZpZXIpIGFzIFRbXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGBtb2RpZmllcmAgaXMgYSBjYWxsYmFjayAtPiBjYWxsIGBmaWx0ZXJgIG5hdGl2ZWx5IG9uIHRoZSBhcnJheS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5maWx0ZXIobW9kaWZpZXIsIHRoaXNBcmcpIGFzIFRbXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGZpcnN0IG1vZGlmaWVyIGluIHRoZSBhcnJheSB0aGF0IGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzLiBJZiBhIG1vZGlmaWVyIGluc3RhbmNlIGlzIGdpdmVuLCByZW1vdmUgdGhhdCBwYXJ0aWN1YXJcbiAgICAgKiBpbnN0YW5jZSBmcm9tIHRoZSBhcnJheS4gUmV0dXJuIHRydWUgaWYgYSBtb2RpZmllciB3YXMgcmVtb3ZlZCwgZmFsc2VcbiAgICAgKiBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJcbiAgICAgKi9cbiAgICByZW1vdmUobW9kaWZpZXI6IE1vZGlmaWVyIHwgQ29uc3RydWN0b3I8TW9kaWZpZXI+KTogYm9vbGVhbiB7XG4gICAgICAgIGlmICghdGhpcy5fY29udGVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtb2RpZmllckluZGV4ID0gdGhpcy5fY29udGVudHMuZmluZEluZGV4KG1vZGlmaWVySW5zdGFuY2UgPT4ge1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVyIGluc3RhbmNlb2YgTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXJJbnN0YW5jZSA9PT0gbW9kaWZpZXI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllckluc3RhbmNlIGluc3RhbmNlb2YgbW9kaWZpZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobW9kaWZpZXJJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzLnNwbGljZShtb2RpZmllckluZGV4LCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlcGxhY2UgdGhlIGZpcnN0IG1vZGlmaWVyIGluIHRoZSBhcnJheSB0aGF0IGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzIG9yIHRoYXQgbWF0Y2hlcyB0aGUgcGFydGljdWxhciBpbnN0YW5jZSBwYXNzZWQgd2l0aCB0aGVcbiAgICAgKiBnaXZlbiBtb2RpZmllciBpbnN0YW5jZS4gSWYgdGhlIG5ldyBtb2RpZmllciBwYXNzZWQgaXMgYSBjbGFzcyxcbiAgICAgKiBpbnN0YW50aWF0ZSBpdC4gSWYgbm8gbW9kaWZpZXIgd2FzIGZvdW5kLCBzaW1wbHkgcHVzaCB0aGUgbmV3IG1vZGlmaWVyIG9uXG4gICAgICogdGhlIGFycmF5LlxuICAgICAqXG4gICAgICogUmV0dXJuIHRydWUgaWYgYSBtb2RpZmllciB3YXMgcmVwbGFjZWQsIGZhbHNlIGlmIHRoZSBtb2RpZmllciB3YXMgc2ltcGx5XG4gICAgICogYWRkZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb2xkTW9kaWZpZXJcbiAgICAgKiBAcGFyYW0gbmV3TW9kaWZpZXJcbiAgICAgKi9cbiAgICByZXBsYWNlKFxuICAgICAgICBvbGRNb2RpZmllcjogTW9kaWZpZXIgfCBDb25zdHJ1Y3RvcjxNb2RpZmllcj4sXG4gICAgICAgIG5ld01vZGlmaWVyOiBNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPixcbiAgICApOiBib29sZWFuIHtcbiAgICAgICAgY29uc3Qgb2xkTW9kaWZpZXJJbmRleCA9IHRoaXMuX2NvbnRlbnRzPy5maW5kSW5kZXgobW9kaWZpZXJJbnN0YW5jZSA9PiB7XG4gICAgICAgICAgICBpZiAob2xkTW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllckluc3RhbmNlID09PSBvbGRNb2RpZmllcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZGlmaWVySW5zdGFuY2UgaW5zdGFuY2VvZiBvbGRNb2RpZmllcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdGhpcy5fY29udGVudHMgfHwgb2xkTW9kaWZpZXJJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG5ld01vZGlmaWVyKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyID0gbmV3TW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllciA/IG5ld01vZGlmaWVyIDogbmV3IG5ld01vZGlmaWVyKCk7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50c1tvbGRNb2RpZmllckluZGV4XSA9IG1vZGlmaWVyO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBnaXZlbiBtb2RpZmllcnMgb24gdGhpcyBNb2RpZmllcnMgaW5zdGFuY2UuIFJlcGxhY2UgdGhlIG1vZGlmaWVyc1xuICAgICAqIHdpdGggc2FtZSBjb25zdHJ1Y3RvciBpZiB0aGV5IGV4aXN0LCBvdGhlcndpc2UgYXBwZW5kIHRoZSBtb2RpZmllcnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kZmllcnNcbiAgICAgKi9cbiAgICBzZXQoLi4ubW9kaWZpZXJzOiBBcnJheTxNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPj4pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiBtb2RpZmllcnMpIHtcbiAgICAgICAgICAgIGlmIChtb2RpZmllciBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKG1vZGlmaWVyLmNvbnN0cnVjdG9yLCBtb2RpZmllcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShtb2RpZmllciwgbW9kaWZpZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgZmlyc3QgbW9kaWZpZXIgaW4gdGhlIGFycmF5IHRoYXQgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuXG4gICAgICogbW9kaWZpZXIgY2xhc3Mgb3IgdGhhdCBtYXRjaGVzIHRoZSBwYXJ0aWN1bGFyIGluc3RhbmNlIHBhc3NlZC5cbiAgICAgKiBJZiBubyBtb2RpZmllciB3YXMgZm91bmQsIGFkZCB0aGUgZ2l2ZW4gbW9kaWZpZXIgaW5zdGVhZC5cbiAgICAgKiBJZiB0aGUgZ2l2ZW4gbmV3IG1vZGlmaWVyIGlzIGEgY2xhc3MsIGluc3RhbnRpYXRlIGl0LlxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICovXG4gICAgdG9nZ2xlKG1vZGlmaWVyOiBNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPik6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbW92ZShtb2RpZmllcikgfHwgdGhpcy5hcHBlbmQobW9kaWZpZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgbW9kaWZpZXJzIGluIHRoaXMgYXJyYXkgYXJlIHRoZSBzYW1lIGFzIHRoZSBtb2RpZmllcnNcbiAgICAgKiBpbiB0aGUgZ2l2ZW4gYXJyYXkgKGFzIGRlZmluZWQgYnkgdGhlIGBpc1NhbWVBc2AgbWV0aG9kcyBvZiB0aGVcbiAgICAgKiBtb2RpZmllcnMpLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyTW9kaWZpZXJzXG4gICAgICovXG4gICAgYXJlU2FtZUFzKG90aGVyTW9kaWZpZXJzOiBNb2RpZmllcnMpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgbW9kaWZpZXJzTWFwID0gbmV3IE1hcChcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzPy5tYXAoYSA9PiBbYSwgb3RoZXJNb2RpZmllcnMuZmluZChiID0+IGEuaXNTYW1lQXMoYikpXSkgfHwgW10sXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGFNb2RpZmllcnMgPSBBcnJheS5mcm9tKG1vZGlmaWVyc01hcC5rZXlzKCkpO1xuICAgICAgICBjb25zdCBiTW9kaWZpZXJzID0gQXJyYXkuZnJvbShtb2RpZmllcnNNYXAudmFsdWVzKCkpO1xuXG4gICAgICAgIGNvbnN0IGFsbEFpbkIgPSBhTW9kaWZpZXJzLmV2ZXJ5KGEgPT4gYS5pc1NhbWVBcyhtb2RpZmllcnNNYXAuZ2V0KGEpKSk7XG4gICAgICAgIGNvbnN0IGFsbEJpbkEgPSBvdGhlck1vZGlmaWVycy5ldmVyeShcbiAgICAgICAgICAgIGIgPT4gYk1vZGlmaWVycy5pbmNsdWRlcyhiKSB8fCBiLmlzU2FtZUFzKHRoaXMuZmluZChiKSksXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBhbGxBaW5CICYmIGFsbEJpbkE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhbGwgbW9kaWZpZXJzLlxuICAgICAqL1xuICAgIGVtcHR5KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5fY29udGVudHMpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJveHkgZm9yIHRoZSBuYXRpdmUgYHNvbWVgIG1ldGhvZCBvZiBgQXJyYXlgLCBjYWxsZWQgb24gYHRoaXMuX2NvbnRlbnRzYC5cbiAgICAgKlxuICAgICAqIEBzZWUgQXJyYXkuc29tZVxuICAgICAqIEBwYXJhbSBjYWxsYmFja2ZuXG4gICAgICovXG4gICAgc29tZShjYWxsYmFja2ZuOiAodmFsdWU6IE1vZGlmaWVyLCBpbmRleDogbnVtYmVyLCBhcnJheTogTW9kaWZpZXJbXSkgPT4gdW5rbm93bik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudHM/LnNvbWUoY2FsbGJhY2tmbikgfHwgZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3h5IGZvciB0aGUgbmF0aXZlIGBldmVyeWAgbWV0aG9kIG9mIGBBcnJheWAsIGNhbGxlZCBvbiBgdGhpcy5fY29udGVudHNgLlxuICAgICAqXG4gICAgICogQHNlZSBBcnJheS5ldmVyeVxuICAgICAqIEBwYXJhbSBjYWxsYmFja2ZuXG4gICAgICovXG4gICAgZXZlcnkoY2FsbGJhY2tmbjogKHZhbHVlOiBNb2RpZmllciwgaW5kZXg6IG51bWJlciwgYXJyYXk6IE1vZGlmaWVyW10pID0+IHVua25vd24pOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRzID8gdGhpcy5fY29udGVudHMuZXZlcnkoY2FsbGJhY2tmbikgOiB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm94eSBmb3IgdGhlIG5hdGl2ZSBgbWFwYCBtZXRob2Qgb2YgYEFycmF5YCwgY2FsbGVkIG9uIGB0aGlzLl9jb250ZW50c2AuXG4gICAgICpcbiAgICAgKiBAc2VlIEFycmF5Lm1hcFxuICAgICAqIEBwYXJhbSBjYWxsYmFja2ZuXG4gICAgICovXG4gICAgbWFwPFQ+KGNhbGxiYWNrZm46ICh2YWx1ZTogTW9kaWZpZXIsIGluZGV4OiBudW1iZXIsIGFycmF5OiBNb2RpZmllcltdKSA9PiBUKTogVFtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRzPy5tYXAoY2FsbGJhY2tmbikgfHwgW107XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24sIFByZWRpY2F0ZSwgaXNMZWFmIH0gZnJvbSAnLi9WTm9kZSc7XG5pbXBvcnQge1xuICAgIENvbnN0cnVjdG9yLFxuICAgIG5vZGVMZW5ndGgsXG4gICAgaXNDb250ZW50RWRpdGFibGUsXG4gICAgaGFzQ29udGVudEVkaXRhYmxlLFxufSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4vQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi9BdG9taWNOb2RlJztcbmltcG9ydCB7IE1vZGlmaWVycyB9IGZyb20gJy4uL01vZGlmaWVycyc7XG5pbXBvcnQgeyBFdmVudE1peGluIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL0V2ZW50TWl4aW4nO1xuaW1wb3J0IHsgTW9kaWZpZXIgfSBmcm9tICcuLi9Nb2RpZmllcic7XG5pbXBvcnQgeyBtYXJrQXNEaWZmUm9vdCB9IGZyb20gJy4uL01lbW9yeS9NZW1vcnknO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFic3RyYWN0Tm9kZVBhcmFtcyB7XG4gICAgbW9kaWZpZXJzPzogTW9kaWZpZXJzIHwgQXJyYXk8TW9kaWZpZXIgfCBDb25zdHJ1Y3RvcjxNb2RpZmllcj4+O1xufVxuXG5sZXQgaWQgPSAwO1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0Tm9kZSBleHRlbmRzIEV2ZW50TWl4aW4ge1xuICAgIHJlYWRvbmx5IGlkID0gaWQ7XG4gICAgcHJpdmF0ZSBfZWRpdGFibGU6IGJvb2xlYW47XG4gICAgLyoqXG4gICAgICogVHJ1ZSBpZiB0aGUgbm9kZSBpcyBlZGl0YWJsZS4gUHJvcGFnYXRlcyB0byB0aGUgY2hpbGRyZW4uXG4gICAgICogQSBub2RlIHRoYXQgaXMgZWRpdGFibGUgY2FuIGhhdmUgaXRzIG1vZGlmaWVycyBlZGl0ZWQsIGJlIG1vdmVkLCByZW1vdmVkLFxuICAgICAqIGFuZCBhIHNlbGVjdGlvbiBjYW4gYmUgbWFkZSB3aXRoaW4gaXQuXG4gICAgICogQ2FuIGJlIG92ZXJyaWRkZW4gd2l0aCBhIGBNb2RlYC5cbiAgICAgKi9cbiAgICBnZXQgZWRpdGFibGUoKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLl9lZGl0YWJsZSA9PT0gZmFsc2UpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICF0aGlzLnBhcmVudCB8fFxuICAgICAgICAgICAgKGhhc0NvbnRlbnRFZGl0YWJsZSh0aGlzLnBhcmVudClcbiAgICAgICAgICAgICAgICA/IGlzQ29udGVudEVkaXRhYmxlKHRoaXMucGFyZW50KVxuICAgICAgICAgICAgICAgIDogdGhpcy5wYXJlbnQuZWRpdGFibGUpXG4gICAgICAgICk7XG4gICAgfVxuICAgIHNldCBlZGl0YWJsZShzdGF0ZTogYm9vbGVhbikge1xuICAgICAgICB0aGlzLl9lZGl0YWJsZSA9IHN0YXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcnVlIElmIHRoZSBub2RlIHdpbGwgaGF2ZSBhIHJlcHJlc2VudGF0aW9uIGluIHRoZSBkb20uIEVnOiBtYXJrZXJzIGFyZVxuICAgICAqIG5vdCB0YW5naWJsZS5cbiAgICAgKi9cbiAgICB0YW5naWJsZSA9IHRydWU7XG4gICAgLyoqXG4gICAgICogVHJ1ZSBpZiB0aGUgbm9kZSBjYW4gYmUgc3BsaXQuXG4gICAgICogQ2FuIGJlIG92ZXJyaWRkZW4gd2l0aCBhIGBNb2RlYC5cbiAgICAgKi9cbiAgICBicmVha2FibGUgPSB0cnVlO1xuICAgIHBhcmVudDogQ29udGFpbmVyTm9kZTtcbiAgICBtb2RpZmllcnMgPSBuZXcgTW9kaWZpZXJzKCk7XG4gICAgY2hpbGRWTm9kZXM6IFZOb2RlW107XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIHByZWRpY2F0ZSBpcyBhIGNvbnN0cnVjdG9yIG9mIGEgVk5vZGUgY2xhc3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJlZGljYXRlIFRoZSBwcmVkaWNhdGUgdG8gY2hlY2suXG4gICAgICovXG4gICAgc3RhdGljIGlzQ29uc3RydWN0b3IoXG4gICAgICAgIHByZWRpY2F0ZTogUHJlZGljYXRlLFxuICAgICk6IHByZWRpY2F0ZSBpcyBDb25zdHJ1Y3RvcjxDb250YWluZXJOb2RlPiB8IENvbnN0cnVjdG9yPEF0b21pY05vZGU+IHtcbiAgICAgICAgcmV0dXJuIHByZWRpY2F0ZS5wcm90b3R5cGUgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGU7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogQWJzdHJhY3ROb2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlkKys7XG4gICAgICAgIGlmIChwYXJhbXM/Lm1vZGlmaWVycykge1xuICAgICAgICAgICAgaWYgKHBhcmFtcy5tb2RpZmllcnMgaW5zdGFuY2VvZiBNb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGlmaWVycyA9IHBhcmFtcy5tb2RpZmllcnM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kaWZpZXJzLmFwcGVuZCguLi5wYXJhbXMubW9kaWZpZXJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXJrQXNEaWZmUm9vdCh0aGlzKTtcbiAgICB9XG5cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHRleHQgY29udGVudCBvZiB0aGlzIG5vZGUuXG4gICAgICovXG4gICAgZ2V0IHRleHRDb250ZW50KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuKClcbiAgICAgICAgICAgIC5tYXAoY2hpbGQgPT4gY2hpbGQudGV4dENvbnRlbnQpXG4gICAgICAgICAgICAuam9pbignJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFRyYW5zZm9ybSB0aGUgZ2l2ZW4gRE9NIGxvY2F0aW9uIGludG8gaXRzIFZEb2N1bWVudCBjb3VudGVycGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb21Ob2RlIERPTSBub2RlIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyBWTm9kZVxuICAgICAqIEBwYXJhbSBvZmZzZXQgVGhlIG9mZnNldCBvZiB0aGUgbG9jYXRpb24gaW4gdGhlIGdpdmVuIGRvbU5vZGVcbiAgICAgKi9cbiAgICBsb2NhdGUoZG9tTm9kZTogTm9kZSwgb2Zmc2V0OiBudW1iZXIpOiBbdGhpcywgUmVsYXRpdmVQb3NpdGlvbl0ge1xuICAgICAgICAvLyBQb3NpdGlvbiBgQkVGT1JFYCBpcyBwcmVmZXJyZWQgb3ZlciBgQUZURVJgLCB1bmxlc3MgdGhlIG9mZnNldFxuICAgICAgICAvLyBvdmVyZmxvd3MgdGhlIGNoaWxkcmVuIGxpc3QsIGluIHdoaWNoIGNhc2UgYEFGVEVSYCBpcyBuZWVkZWQuXG4gICAgICAgIGxldCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICBjb25zdCBkb21Ob2RlTGVuZ3RoID0gbm9kZUxlbmd0aChkb21Ob2RlKTtcbiAgICAgICAgaWYgKGRvbU5vZGVMZW5ndGggJiYgb2Zmc2V0ID49IGRvbU5vZGVMZW5ndGgpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3RoaXMsIHBvc2l0aW9uXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICovXG4gICAgY2xvbmUocGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihwYXJhbXMpO1xuICAgICAgICBjbG9uZS5tb2RpZmllcnMgPSB0aGlzLm1vZGlmaWVycy5jbG9uZSgpO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGlzIFZOb2RlIHdpdGggdGhlIGdpdmVuIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICByZXBsYWNlV2l0aChub2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aGlzLmJlZm9yZShub2RlKTtcbiAgICAgICAgdGhpcy5tZXJnZVdpdGgobm9kZSk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByb3BlcnRpZXNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4oKS5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlc3QgdGhpcyBub2RlIGFnYWluc3QgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIElmIHRoZSBwcmVkaWNhdGUgaXMgZmFsc3ksIHJldHVybiB0cnVlLiBJZiB0aGUgcHJlZGljYXRlIGlzIGEgY29uc3RydWN0b3JcbiAgICAgKiBvZiBhIFZOb2RlIGNsYXNzLCByZXR1cm4gd2hldGhlciB0aGlzIG5vZGUgaXMgYW4gaW5zdGFuY2Ugb2YgdGhhdCBjbGFzcy5cbiAgICAgKiBJZiB0aGUgcHJlZGljYXRlIGlzIGEgc3RhbmRhcmQgZnVuY3Rpb24sIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoaXNcbiAgICAgKiBmdW5jdGlvbiB3aGVuIGNhbGxlZCB3aXRoIHRoZSBub2RlIGFzIHBhcmFtZXRlci5cbiAgICAgKlxuICAgICAqXG4gICAgICogQHBhcmFtIHByZWRpY2F0ZSBUaGUgcHJlZGljYXRlIHRvIHRlc3QgdGhpcyBub2RlIGFnYWluc3QuXG4gICAgICovXG4gICAgdGVzdChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKEFic3RyYWN0Tm9kZS5pc0NvbnN0cnVjdG9yKHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgcHJlZGljYXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHByZWRpY2F0ZSh0aGlzIGFzIFZOb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGlzIFZOb2RlIGNvbWVzIGJlZm9yZSB0aGUgZ2l2ZW4gVk5vZGUgaW4gdGhlIHByZS1vcmRlclxuICAgICAqIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqL1xuICAgIGlzQmVmb3JlKHZOb2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB0aGlzUGF0aCA9IFt0aGlzIGFzIFZOb2RlLCAuLi50aGlzLmFuY2VzdG9ycygpXTtcbiAgICAgICAgY29uc3Qgbm9kZVBhdGggPSBbdk5vZGUsIC4uLnZOb2RlLmFuY2VzdG9ycygpXTtcbiAgICAgICAgLy8gRmluZCB0aGUgbGFzdCBkaXN0aW5jdCBhbmNlc3RvcnMgaW4gdGhlIHBhdGggdG8gdGhlIHJvb3QuXG4gICAgICAgIGxldCB0aGlzQW5jZXN0b3I6IFZOb2RlO1xuICAgICAgICBsZXQgbm9kZUFuY2VzdG9yOiBWTm9kZTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdGhpc0FuY2VzdG9yID0gdGhpc1BhdGgucG9wKCk7XG4gICAgICAgICAgICBub2RlQW5jZXN0b3IgPSBub2RlUGF0aC5wb3AoKTtcbiAgICAgICAgfSB3aGlsZSAodGhpc0FuY2VzdG9yICYmIG5vZGVBbmNlc3RvciAmJiB0aGlzQW5jZXN0b3IgPT09IG5vZGVBbmNlc3Rvcik7XG5cbiAgICAgICAgaWYgKHRoaXNBbmNlc3RvciAmJiBub2RlQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHRoaXNQYXJlbnQgPSB0aGlzQW5jZXN0b3IucGFyZW50O1xuICAgICAgICAgICAgY29uc3Qgbm9kZVBhcmVudCA9IG5vZGVBbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpc1BhcmVudCAmJiB0aGlzUGFyZW50ID09PSBub2RlUGFyZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gQ29tcGFyZSB0aGUgaW5kaWNlcyBvZiBib3RoIGFuY2VzdG9ycyBpbiB0aGVpciBzaGFyZWQgcGFyZW50LlxuICAgICAgICAgICAgICAgIGNvbnN0IHRoaXNJbmRleCA9IHRoaXNQYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZih0aGlzQW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJbmRleCA9IG5vZGVQYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZihub2RlQW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzSW5kZXggPCBub2RlSW5kZXg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRoZSB2ZXJ5IGZpcnN0IGFuY2VzdG9yIG9mIGJvdGggbm9kZXMgYXJlIGRpZmZlcmVudCBzb1xuICAgICAgICAgICAgICAgIC8vIHRoZXkgYWN0dWFsbHkgY29tZSBmcm9tIHR3byBkaWZmZXJlbnQgdHJlZXMgYWx0b2dldGhlci5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBPbmUgb2YgdGhlIG5vZGVzIHdhcyBpbiB0aGUgYW5jZXN0b3JzIHBhdGggb2YgdGhlIG90aGVyLlxuICAgICAgICAgICAgcmV0dXJuICF0aGlzQW5jZXN0b3IgJiYgISFub2RlQW5jZXN0b3I7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBWTm9kZSBjb21lcyBhZnRlciB0aGUgZ2l2ZW4gVk5vZGUgaW4gdGhlIHByZS1vcmRlclxuICAgICAqIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqL1xuICAgIGlzQWZ0ZXIodk5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB2Tm9kZS5pc0JlZm9yZSh0aGlzIGFzIFZOb2RlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgYW5jZXN0b3JzIGFuZCBzaWJsaW5ncy5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNsb3Nlc3Qgbm9kZSBmcm9tIHRoaXMgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKiBTdGFydCB3aXRoIHRoaXMgbm9kZSB0aGVuIGdvIHVwIHRoZSBhbmNlc3RvcnMgdHJlZSB1bnRpbCBmaW5kaW5nIGEgbWF0Y2guXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJlZGljYXRlXG4gICAgICovXG4gICAgY2xvc2VzdDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZTogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBjbG9zZXN0KHByZWRpY2F0ZTogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgY2xvc2VzdChwcmVkaWNhdGU6IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgaWYgKHRoaXMudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcyBhcyBWTm9kZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKHByZWRpY2F0ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBhbmNlc3RvciBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlblxuICAgICAqIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFuY2VzdG9yPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBhbmNlc3RvcihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBhbmNlc3RvcihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGxldCBhbmNlc3RvciA9IHRoaXMucGFyZW50O1xuICAgICAgICB3aGlsZSAoYW5jZXN0b3IgJiYgIWFuY2VzdG9yLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFuY2VzdG9yO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIGFuY2VzdG9ycyBvZiB0aGUgY3VycmVudCBub2RlIHRoYXQgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gYWxsIHRoZSBhbmNlc3RvcnMgb2YgdGhlXG4gICAgICogY3VycmVudCBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYW5jZXN0b3JzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIGFuY2VzdG9ycyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGFuY2VzdG9ycyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdIHtcbiAgICAgICAgY29uc3QgYW5jZXN0b3JzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgaWYgKHBhcmVudC50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChwYXJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5jZXN0b3JzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxvd2VzdCBjb21tb24gYW5jZXN0b3IgYmV0d2VlbiB0aGlzIFZOb2RlIGFuZCB0aGUgZ2l2ZW4gb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBjb21tb25BbmNlc3RvcjxUIGV4dGVuZHMgVk5vZGU+KG5vZGU6IFZOb2RlLCBwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGNvbW1vbkFuY2VzdG9yKG5vZGU6IFZOb2RlLCBwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBjb21tb25BbmNlc3Rvcihub2RlOiBWTm9kZSwgcHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXJlbnQgPT09IG5vZGUucGFyZW50ICYmIHRoaXMucGFyZW50LnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRoaXNQYXRoID0gW3RoaXMgYXMgVk5vZGUsIC4uLnRoaXMuYW5jZXN0b3JzKHByZWRpY2F0ZSldO1xuICAgICAgICBjb25zdCBub2RlUGF0aCA9IFtub2RlLCAuLi5ub2RlLmFuY2VzdG9ycyhwcmVkaWNhdGUpXTtcbiAgICAgICAgbGV0IGNvbW1vbkFuY2VzdG9yOiBWTm9kZTtcbiAgICAgICAgd2hpbGUgKHRoaXNQYXRoW3RoaXNQYXRoLmxlbmd0aCAtIDFdID09PSBub2RlUGF0aC5wb3AoKSkge1xuICAgICAgICAgICAgY29tbW9uQW5jZXN0b3IgPSB0aGlzUGF0aC5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tbW9uQW5jZXN0b3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgc2libGluZ3Mgb2YgdGhpcyBWTm9kZSB3aGljaCBzYXRpc2Z5IHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBzaWJsaW5nczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFRbXTtcbiAgICBzaWJsaW5ncyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIHNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBzaWJsaW5nczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgc2libGluZzogVk5vZGUgPSB0aGlzLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB3aGlsZSAoc2libGluZykge1xuICAgICAgICAgICAgaWYgKHNpYmxpbmcudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgc2libGluZ3MudW5zaGlmdChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHNpYmxpbmcgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIHdoaWxlIChzaWJsaW5nKSB7XG4gICAgICAgICAgICBpZiAoc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBzaWJsaW5ncy5wdXNoKHNpYmxpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2libGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbm9kZXMgYWRqYWNlbnQgdG8gdGhpcyBWTm9kZSB0aGF0IHNhdGlzZnkgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKi9cbiAgICBhZGphY2VudHM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgYWRqYWNlbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgYWRqYWNlbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBhZGphY2VudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IHNpYmxpbmc6IFZOb2RlID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGFkamFjZW50cy51bnNoaWZ0KHNpYmxpbmcpO1xuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgc2libGluZyA9IHRoaXMubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGFkamFjZW50cy5wdXNoKHNpYmxpbmcpO1xuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRqYWNlbnRzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHByZXZpb3VzIHNpYmxpbmcgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBwcmV2aW91cyBzaWJsaW5nIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBwcmV2aW91c1NpYmxpbmc8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIHByZXZpb3VzU2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBwcmV2aW91c1NpYmxpbmcocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSByZXR1cm47XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZih0aGlzIGFzIFZOb2RlKTtcbiAgICAgICAgbGV0IHNpYmxpbmcgPSB0aGlzLnBhcmVudC5jaGlsZFZOb2Rlc1tpbmRleCAtIDFdO1xuICAgICAgICAvLyBTa2lwIGlnbm9yZWQgc2libGluZ3MgYW5kIHRob3NlIGZhaWxpbmcgdGhlIHByZWRpY2F0ZSB0ZXN0LlxuICAgICAgICB3aGlsZSAoc2libGluZyAmJiAhKHNpYmxpbmcudGFuZ2libGUgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpKSB7XG4gICAgICAgICAgICBzaWJsaW5nID0gc2libGluZy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2libGluZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuZXh0IHNpYmxpbmcgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBuZXh0IHNpYmxpbmcgb2YgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIG5leHRTaWJsaW5nPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBuZXh0U2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0U2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHJldHVybjtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBhcmVudC5jaGlsZFZOb2Rlcy5pbmRleE9mKHRoaXMgYXMgVk5vZGUpO1xuICAgICAgICBsZXQgc2libGluZyA9IHRoaXMucGFyZW50LmNoaWxkVk5vZGVzW2luZGV4ICsgMV07XG4gICAgICAgIC8vIFNraXAgaWdub3JlZCBzaWJsaW5ncyBhbmQgdGhvc2UgZmFpbGluZyB0aGUgcHJlZGljYXRlIHRlc3QuXG4gICAgICAgIHdoaWxlIChzaWJsaW5nICYmICEoc2libGluZy50YW5naWJsZSAmJiBzaWJsaW5nLnRlc3QocHJlZGljYXRlKSkpIHtcbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNpYmxpbmc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgcHJldmlvdXMgbm9kZSBpbiBhIGRlcHRoLWZpcnN0IHByZS1vcmRlciB0cmF2ZXJzYWwgb2YgdGhlXG4gICAgICogdHJlZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4gcmV0dXJuXG4gICAgICogdGhlIHByZXZpb3VzIG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgcHJldmlvdXM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIHByZXZpb3VzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIHByZXZpb3VzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgbGV0IHByZXZpb3VzID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAgICAgICAvLyBUaGUgcHJldmlvdXMgbm9kZSBpcyB0aGUgbGFzdCBsZWFmIG9mIHRoZSBwcmV2aW91cyBzaWJsaW5nLlxuICAgICAgICAgICAgcHJldmlvdXMgPSBwcmV2aW91cy5sYXN0TGVhZigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIHByZXZpb3VzIHNpYmxpbmcgdGhlbiBjbGltYiB1cCB0byB0aGUgcGFyZW50LlxuICAgICAgICAgICAgcHJldmlvdXMgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAocHJldmlvdXMgJiYgIXByZXZpb3VzLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgcHJldmlvdXMgPSBwcmV2aW91cy5wcmV2aW91cygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2aW91cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuZXh0IG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlXG4gICAgICogdGhhdCBzYXRpc2ZpZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS4gSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuIHJldHVybiB0aGVcbiAgICAgKiBuZXh0IG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgbmV4dDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbmV4dChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgLy8gVGhlIG5vZGUgYWZ0ZXIgbm9kZSBpcyBpdHMgZmlyc3QgY2hpbGQuXG4gICAgICAgIGxldCBuZXh0ID0gdGhpcy5maXJzdENoaWxkKCk7XG4gICAgICAgIGlmICghbmV4dCkge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRoZW4gaXQgaXMgaXRzIG5leHQgc2libGluZy5cbiAgICAgICAgICAgIG5leHQgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFuZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiBpdCBoYXMgbm8gc2libGluZ3MgZWl0aGVyIHRoZW4gY2xpbWIgdXAgdG8gdGhlIGNsb3Nlc3QgcGFyZW50XG4gICAgICAgICAgICAvLyB3aGljaCBoYXMgYSBuZXh0IHNpYmlsaW5nLlxuICAgICAgICAgICAgbGV0IGFuY2VzdG9yID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgJiYgIWFuY2VzdG9yLm5leHRTaWJsaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBhbmNlc3RvciAmJiBhbmNlc3Rvci5uZXh0U2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChuZXh0ICYmICFuZXh0LnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgbmV4dCA9IG5leHQubmV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHByZXZpb3VzIGxlYWYgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZVxuICAgICAqIHRyZWUgdGhhdCBzYXRpc2ZpZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS4gSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuIHJldHVyblxuICAgICAqIHRoZSBwcmV2aW91cyBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIHByZXZpb3VzTGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgcHJldmlvdXNMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIHByZXZpb3VzTGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzKChub2RlOiBWTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGlzTGVhZihub2RlKSAmJiBub2RlLnRlc3QocHJlZGljYXRlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbmV4dCBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZVxuICAgICAqIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gdGhlXG4gICAgICogbmV4dCBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIG5leHRMZWFmPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBuZXh0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5leHQoKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaXNMZWFmKG5vZGUpICYmIG5vZGUudGVzdChwcmVkaWNhdGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBwcmV2aW91cyBzaWJsaW5ncyBvZiB0aGUgY3VycmVudCBub2RlIHRoYXQgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gYWxsIHRoZSBwcmV2aW91cyBzaWJsaW5ncyBvZlxuICAgICAqIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBwcmV2aW91c1NpYmxpbmdzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIHByZXZpb3VzU2libGluZ3MocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICBwcmV2aW91c1NpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmdzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGxldCBzaWJsaW5nID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcpIHtcbiAgICAgICAgICAgIGlmIChzaWJsaW5nLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZ3MucHVzaChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2aW91c1NpYmxpbmdzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIG5leHQgc2libGluZ3Mgb2YgdGhlIGN1cnJlbnQgbm9kZSB0aGF0IHNhdGlzZnkgdGhlIGdpdmVuXG4gICAgICogcHJlZGljYXRlLiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4gcmV0dXJuIGFsbCB0aGUgbmV4dCBzaWJsaW5ncyBvZiB0aGVcbiAgICAgKiBjdXJyZW50IG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBuZXh0U2libGluZ3M8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgbmV4dFNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgbmV4dFNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBuZXh0U2libGluZ3M6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IHNpYmxpbmcgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIHdoaWxlIChzaWJsaW5nKSB7XG4gICAgICAgICAgICBpZiAoc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZ3MucHVzaChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5ncztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVXBkYXRpbmdcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgdGhlIGdpdmVuIFZOb2RlIGJlZm9yZSB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBiZWZvcmUobm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaW5zZXJ0IGEgVk5vZGUgYmVmb3JlIGEgVk5vZGUgd2l0aCBubyBwYXJlbnQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQuaW5zZXJ0QmVmb3JlKG5vZGUsIHRoaXMgYXMgVk5vZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgdGhlIGdpdmVuIFZOb2RlIGFmdGVyIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGFmdGVyKG5vZGU6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGluc2VydCBhIFZOb2RlIGFmdGVyIGEgVk5vZGUgd2l0aCBubyBwYXJlbnQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQuaW5zZXJ0QWZ0ZXIobm9kZSwgdGhpcyBhcyBWTm9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyYXAgdGhpcyBub2RlIGluIHRoZSBnaXZlbiBub2RlIGJ5IGluc2VydGluZyB0aGUgZ2l2ZW4gbm9kZSBhdCB0aGlzXG4gICAgICogbm9kZSdzIHBvc2l0aW9uIGluIGl0cyBwYXJlbnQgYW5kIGFwcGVuZGluZyB0aGlzIG5vZGUgdG8gdGhlIGdpdmVuIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIHdyYXAobm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5iZWZvcmUobm9kZSk7XG4gICAgICAgIG5vZGUuYXBwZW5kKHRoaXMgYXMgVk5vZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhpcyBub2RlLlxuICAgICAqL1xuICAgIHJlbW92ZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzIGFzIFZOb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhpcyBub2RlIGluIGZvcndhcmQgZGlyZWN0aW9uLiAoZS5nLiBgRGVsZXRlYCBrZXkpXG4gICAgICovXG4gICAgcmVtb3ZlRm9yd2FyZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoaXMgbm9kZSBpbiBiYWNrd2FyZCBkaXJlY3Rpb24uIChlLmcuIGBCYWNrc3BhY2VgIGtleSlcbiAgICAgKi9cbiAgICByZW1vdmVCYWNrd2FyZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgY2hpbGRyZW4uIFRvIGJlIGltcGxlbWVudGVkIGJ5IHRoZSBjb25jcmV0ZSBzdWJjbGFzcy5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNoaWxkcmVuIG9mIHRoaXMgVk5vZGUgd2hpY2ggc2F0aXNmeSB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqL1xuICAgIGFic3RyYWN0IGNoaWxkcmVuPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIGFic3RyYWN0IGNoaWxkcmVuKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBWTm9kZSBoYXMgY2hpbGRyZW4uXG4gICAgICovXG4gICAgYWJzdHJhY3QgaGFzQ2hpbGRyZW4oKTogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIG50aCBjaGlsZCBvZiB0aGlzIG5vZGUuIFRoZSBnaXZlbiBgbmAgYXJndW1lbnQgaXMgdGhlIDEtYmFzZWRcbiAgICAgKiBpbmRleCBvZiB0aGUgcG9zaXRpb24gb2YgdGhlIGNoaWxkIGluc2lkZSB0aGlzIG5vZGUsIGV4Y2x1ZGluZyBtYXJrZXJzLlxuICAgICAqXG4gICAgICogRXhhbXBsZXM6XG4gICAgICogbnRoQ2hpbGQoMSkgcmV0dXJucyB0aGUgZmlyc3QgKDFzdCkgY2hpbGQuXG4gICAgICogbnRoQ2hpbGQoMikgcmV0dXJucyB0aGUgc2Vjb25kICgybmQpIGNoaWxkLlxuICAgICAqIG50aENoaWxkKDMpIHJldHVybnMgdGhlIHNlY29uZCAoM3JkKSBjaGlsZC5cbiAgICAgKiBudGhDaGlsZCg0KSByZXR1cm5zIHRoZSBzZWNvbmQgKDR0aCkgY2hpbGQuXG4gICAgICogLi4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gblxuICAgICAqL1xuICAgIGFic3RyYWN0IG50aENoaWxkKG46IG51bWJlcik6IFZOb2RlO1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZmlyc3QgY2hpbGQgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBmaXJzdCBjaGlsZCBvZiB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYWJzdHJhY3QgZmlyc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgYWJzdHJhY3QgZmlyc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxhc3QgY2hpbGQgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBsYXN0IGNoaWxkIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBsYXN0Q2hpbGQ8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGFic3RyYWN0IGxhc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpcnN0IGxlYWYgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBmaXJzdCBsZWFmIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBmaXJzdExlYWY8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGFic3RyYWN0IGZpcnN0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxhc3QgbGVhZiBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICogSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuLCByZXR1cm4gdGhlIGxhc3QgbGVhZiBvZiB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYWJzdHJhY3QgbGFzdExlYWY8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGFic3RyYWN0IGxhc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIC8qKlxuICAgICAqIFJldHVybiBhbGwgZGVzY2VuZGFudHMgb2YgdGhlIGN1cnJlbnQgbm9kZSB0aGF0IHNhdGlzZnkgdGhlIGdpdmVuXG4gICAgICogcHJlZGljYXRlLiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4gcmV0dXJuIGFsbCB0aGUgYW5jZXN0b3JzIG9mIHRoZVxuICAgICAqIGN1cnJlbnQgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFic3RyYWN0IGRlc2NlbmRhbnRzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIGFic3RyYWN0IGRlc2NlbmRhbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBkZXNjZW5kYW50IG9mIHRoaXMgVk5vZGUgdGhhdCBzYXRpc2ZpZXMgdGhlIHByZWRpY2F0ZS5cbiAgICAgKiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4sIHJldHVybiB0aGUgZmlyc3QgZGVzY2VuZGFudCBvZiB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYWJzdHJhY3QgZmlyc3REZXNjZW5kYW50PFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBhYnN0cmFjdCBmaXJzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBsYXN0IGRlc2NlbmRhbnQgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBsYXN0IGRlc2NlbmRhbnQgb2YgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFic3RyYWN0IGxhc3REZXNjZW5kYW50PFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBhYnN0cmFjdCBsYXN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBVcGRhdGluZyBjaGlsZHJlbi4gVG8gYmUgaW1wbGVtZW50ZWQgYnkgdGhlIGNvbmNyZXRlIHN1YmNsYXNzLlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFByZXBlbmQgYSBjaGlsZCB0byB0aGlzIG5vZGUuXG4gICAgICovXG4gICAgYWJzdHJhY3QgcHJlcGVuZCguLi5jaGlsZHJlbjogVk5vZGVbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogQXBwZW5kIGEgY2hpbGQgdG8gdGhpcyBWTm9kZS5cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBhcHBlbmQoLi4uY2hpbGRyZW46IFZOb2RlW10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIEluc2VydCB0aGUgZ2l2ZW4gbm9kZSBiZWZvcmUgdGhlIGdpdmVuIHJlZmVyZW5jZSAod2hpY2ggaXMgYSBjaGlsZCBvZlxuICAgICAqIHRoaXMgVk5vZGUpLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICovXG4gICAgYWJzdHJhY3QgaW5zZXJ0QmVmb3JlKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBJbnNlcnQgdGhlIGdpdmVuIG5vZGUgYWZ0ZXIgdGhlIGdpdmVuIHJlZmVyZW5jZSAoYSBjaGlsZCBvZiB0aGlzIFZOb2RlKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqL1xuICAgIGFic3RyYWN0IGluc2VydEFmdGVyKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIGNoaWxkIGZyb20gdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjaGlsZFxuICAgICAqL1xuICAgIGFic3RyYWN0IHJlbW92ZUNoaWxkKGNoaWxkOiBWTm9kZSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBjaGlsZHJlbiBvZiB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGFic3RyYWN0IGVtcHR5KCk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogVW53cmFwIHRoaXMgbm9kZSBieSBtb3ZpbmcgaXRzIGNoaWxkcmVuIGJlZm9yZSBpdCB0aGVuIHJlbW92aW5nIGl0LlxuICAgICAqL1xuICAgIGFic3RyYWN0IHVud3JhcCgpOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIFNwbGl0IHRoaXMgbm9kZSBhdCB0aGUgZ2l2ZW4gY2hpbGQsIG1vdmluZyBpdCBhbmQgaXRzIG5leHQgc2libGluZ3MgaW50b1xuICAgICAqIGEgZHVwbGljYXRlIG9mIHRoaXMgVk5vZGUgdGhhdCBpcyBpbnNlcnRlZCBhZnRlciB0aGUgb3JpZ2luYWwuIFJldHVybiB0aGVcbiAgICAgKiBkdXBsaWNhdGVkIFZOb2RlLlxuICAgICAqIE5vdGU6IG1ha2Ugc3VyZSB0byBjaGVjayB0aGF0IHRoZSBub2RlIGlzIGJyZWFrYWJsZSBiZWZvcmUgYXR0ZW1wdGluZyB0b1xuICAgICAqIHNwbGl0IGl0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGNoaWxkXG4gICAgICovXG4gICAgYWJzdHJhY3Qgc3BsaXRBdChjaGlsZDogVk5vZGUpOiB0aGlzO1xuICAgIC8qKlxuICAgICAqIE1lcmdlIHRoaXMgbm9kZSB3aXRoIHRoZSBnaXZlbiBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuZXdDb250YWluZXIgdGhlIG5ldyBjb250YWluZXIgZm9yIHRoaXMgbm9kZSdzIGNoaWxkcmVuXG4gICAgICovXG4gICAgYWJzdHJhY3QgbWVyZ2VXaXRoKG5ld0NvbnRhaW5lcjogVk5vZGUpOiB2b2lkO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEV2ZW50cy5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhc3luYyB0cmlnZ2VyPEE+KGV2ZW50TmFtZTogc3RyaW5nLCBhcmdzPzogQSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBzdXBlci50cmlnZ2VyKGV2ZW50TmFtZSwgYXJncyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudE5hbWUsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGUuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgY29udmVuaWVudCBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBub2RlIGFuZCBpdHNcbiAgICAgKiBkZXNjZW5kYW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBfX3JlcHJcbiAgICAgKiBAcGFyYW0gbGV2ZWxcbiAgICAgKi9cbiAgICBfcmVwcihfX3JlcHIgPSAnJywgbGV2ZWwgPSAwKTogc3RyaW5nIHtcbiAgICAgICAgX19yZXByICs9IEFycmF5KGxldmVsICogNCArIDEpLmpvaW4oJyAnKSArIHRoaXMubmFtZSArICcgKCcgKyB0aGlzLmlkICsgJyknICsgJ1xcbic7XG4gICAgICAgIHRoaXMuY2hpbGRWTm9kZXMuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBfX3JlcHIgPSBjaGlsZC5fcmVwcihfX3JlcHIsIGxldmVsICsgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19yZXByO1xuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdE5vZGUge1xuICAgIGNvbnN0cnVjdG9yOiBuZXcgPFQgZXh0ZW5kcyBDb25zdHJ1Y3RvcjxWTm9kZT4+KC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczxUPikgPT4gdGhpcztcbn1cbiIsImltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4vQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IFZOb2RlLCBQcmVkaWNhdGUgfSBmcm9tICcuL1ZOb2RlJztcbmltcG9ydCB7IEF0b21pY2l0eUVycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL2Vycm9ycyc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi9Db250YWluZXJOb2RlJztcblxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIHR5cGluZyBvdmVycmlkZXMgZm9yIG11bHRpcGxlIFZOb2RlIG1ldGhvZHMgd2hpY2ggYXJlXG4gKiBzdXBwb3NlZCB0byB0YWtlIHBhcmFtZXRlcnMgYnV0IHRoYXQgYXJlIHVudXNlZCBpbiB0aGUgY2FzZSBvZiBhdG9taWMgbm9kZXMuXG4gKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFycyAqL1xuZXhwb3J0IGNsYXNzIEF0b21pY05vZGUgZXh0ZW5kcyBBYnN0cmFjdE5vZGUge1xuICAgIHBhcmVudDogQ29udGFpbmVyTm9kZTtcbiAgICBnZXQgY2hpbGRWTm9kZXMoKTogVk5vZGVbXSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgY2hpbGRyZW4uXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuY2hpbGRyZW59LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGFuIGVtcHR5IGFycmF5IHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGNoaWxkcmVuPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVk5vZGVbXTtcbiAgICBjaGlsZHJlbihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGNoaWxkcmVuKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmhhc0NoaWxkcmVufS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gUmV0dXJucyBgZmFsc2VgIHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGhhc0NoaWxkcmVuKCk6IGZhbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5udGhDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgbnRoQ2hpbGQobjogbnVtYmVyKTogdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZmlyc3RDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgZmlyc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHVuZGVmaW5lZDtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZDtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3RDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgbGFzdENoaWxkPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogdW5kZWZpbmVkO1xuICAgIGxhc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgbGFzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0TGVhZn0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHRoaXNgIHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGZpcnN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHRoaXM7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHRoaXM7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHRoaXMge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUubGFzdExlYWZ9LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGB0aGlzYCBzaW5jZSBhbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBsYXN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHRoaXM7XG4gICAgbGFzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogdGhpcztcbiAgICBsYXN0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB0aGlzIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0RGVzY2VuZGFudH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgZmlyc3REZXNjZW5kYW50PFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogdW5kZWZpbmVkO1xuICAgIGZpcnN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgZmlyc3REZXNjZW5kYW50KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3REZXNjZW5kYW50fS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gUmV0dXJucyBgdW5kZWZpbmVkYCBzaW5jZSBhbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBsYXN0RGVzY2VuZGFudDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHVuZGVmaW5lZDtcbiAgICBsYXN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZGVzY2VuZGFudHN9LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGFuIGVtcHR5IGFycmF5IHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGRlc2NlbmRhbnRzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVk5vZGVbXTtcbiAgICBkZXNjZW5kYW50cyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGRlc2NlbmRhbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFVwZGF0aW5nIGNoaWxkcmVuLlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnByZXBlbmR9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBwcmVwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIHRocm93IG5ldyBBdG9taWNpdHlFcnJvcih0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUucHJlcGVuZH0uXG4gICAgICpcbiAgICAgKiBAdGhyb3dzIEF0b21pY2l0eUVycm9yIEFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGFwcGVuZCguLi5jaGlsZHJlbjogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaW5zZXJ0QmVmb3JlfS5cbiAgICAgKlxuICAgICAqIEB0aHJvd3MgQXRvbWljaXR5RXJyb3IgQW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgaW5zZXJ0QmVmb3JlKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIHRocm93IG5ldyBBdG9taWNpdHlFcnJvcih0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaW5zZXJ0QWZ0ZXJ9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBpbnNlcnRBZnRlcihub2RlOiBWTm9kZSwgcmVmZXJlbmNlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmVtcHR5fS5cbiAgICAgKi9cbiAgICBlbXB0eSgpOiB2b2lkIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5yZW1vdmVDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAdGhyb3dzIEF0b21pY2l0eUVycm9yIEFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIHJlbW92ZUNoaWxkKGNoaWxkOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnNwbGl0QXR9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgYmUgc3BsaXQuXG4gICAgICovXG4gICAgc3BsaXRBdChjaGlsZDogVk5vZGUpOiB0aGlzIHtcbiAgICAgICAgdGhyb3cgbmV3IEF0b21pY2l0eUVycm9yKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5tZXJnZVdpdGh9LlxuICAgICAqL1xuICAgIG1lcmdlV2l0aChuZXdDb250YWluZXI6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUudW53cmFwfS5cbiAgICAgKi9cbiAgICB1bndyYXAoKTogdm9pZCB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBWTm9kZSwgUHJlZGljYXRlLCBpc0xlYWYgfSBmcm9tICcuL1ZOb2RlJztcbmltcG9ydCB7IENoaWxkRXJyb3IgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvZXJyb3JzJztcbmltcG9ydCB7IFZlcnNpb25hYmxlQXJyYXkgfSBmcm9tICcuLi9NZW1vcnkvVmVyc2lvbmFibGVBcnJheSc7XG5cbmV4cG9ydCBjbGFzcyBDb250YWluZXJOb2RlIGV4dGVuZHMgQWJzdHJhY3ROb2RlIHtcbiAgICByZWFkb25seSBjaGlsZFZOb2RlczogVk5vZGVbXSA9IG5ldyBWZXJzaW9uYWJsZUFycmF5PFZOb2RlPigpO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEJyb3dzaW5nIGNoaWxkcmVuLlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmNoaWxkcmVufS5cbiAgICAgKi9cbiAgICBjaGlsZHJlbjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFRbXTtcbiAgICBjaGlsZHJlbihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGNoaWxkcmVuKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBjaGlsZHJlbjogVk5vZGVbXSA9IFtdO1xuICAgICAgICB0aGlzLmNoaWxkVk5vZGVzLmZvckVhY2goY2hpbGQgPT4ge1xuICAgICAgICAgICAgaWYgKGNoaWxkLnRhbmdpYmxlICYmICghcHJlZGljYXRlIHx8IGNoaWxkLnRlc3QocHJlZGljYXRlKSkpIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaGFzQ2hpbGRyZW59LlxuICAgICAqL1xuICAgIGhhc0NoaWxkcmVuKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLmNoaWxkVk5vZGVzLmZpbmQoY2hpbGQgPT4gY2hpbGQudGFuZ2libGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5udGhDaGlsZH0uXG4gICAgICovXG4gICAgbnRoQ2hpbGQobjogbnVtYmVyKTogVk5vZGUge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbigpW24gLSAxXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZmlyc3RDaGlsZH0uXG4gICAgICovXG4gICAgZmlyc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgZmlyc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgbGV0IGNoaWxkID0gdGhpcy5jaGlsZFZOb2Rlc1swXTtcbiAgICAgICAgd2hpbGUgKGNoaWxkICYmICEoY2hpbGQudGFuZ2libGUgJiYgKCFwcmVkaWNhdGUgfHwgY2hpbGQudGVzdChwcmVkaWNhdGUpKSkpIHtcbiAgICAgICAgICAgIGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3RDaGlsZH0uXG4gICAgICovXG4gICAgbGFzdENoaWxkPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBsYXN0Q2hpbGQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgbGFzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgbGV0IGNoaWxkID0gdGhpcy5jaGlsZFZOb2Rlc1t0aGlzLmNoaWxkVk5vZGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICB3aGlsZSAoY2hpbGQgJiYgIShjaGlsZC50YW5naWJsZSAmJiAoIXByZWRpY2F0ZSB8fCBjaGlsZC50ZXN0KHByZWRpY2F0ZSkpKSkge1xuICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0TGVhZn0uXG4gICAgICovXG4gICAgZmlyc3RMZWFmPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBmaXJzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgY29uc3QgaXNWYWxpZExlYWYgPSAobm9kZTogVk5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpc0xlYWYobm9kZSkgJiYgKCFwcmVkaWNhdGUgfHwgbm9kZS50ZXN0KHByZWRpY2F0ZSkpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaXNWYWxpZExlYWYodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlyc3REZXNjZW5kYW50KChub2RlOiBWTm9kZSkgPT4gaXNWYWxpZExlYWYobm9kZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3RMZWFmfS5cbiAgICAgKi9cbiAgICBsYXN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbGFzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgbGFzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBjb25zdCBpc1ZhbGlkTGVhZiA9IChub2RlOiBWTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGlzTGVhZihub2RlKSAmJiAoIXByZWRpY2F0ZSB8fCBub2RlLnRlc3QocHJlZGljYXRlKSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc1ZhbGlkTGVhZih0aGlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYXN0RGVzY2VuZGFudCgobm9kZTogVk5vZGUpID0+IGlzVmFsaWRMZWFmKG5vZGUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5maXJzdERlc2NlbmRhbnR9LlxuICAgICAqL1xuICAgIGZpcnN0RGVzY2VuZGFudDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgZmlyc3REZXNjZW5kYW50KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIGZpcnN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGxldCBmaXJzdERlc2NlbmRhbnQgPSB0aGlzLmZpcnN0Q2hpbGQoKTtcbiAgICAgICAgd2hpbGUgKGZpcnN0RGVzY2VuZGFudCAmJiBwcmVkaWNhdGUgJiYgIWZpcnN0RGVzY2VuZGFudC50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGZpcnN0RGVzY2VuZGFudCA9IHRoaXMuX2Rlc2NlbmRhbnRBZnRlcihmaXJzdERlc2NlbmRhbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaXJzdERlc2NlbmRhbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3REZXNjZW5kYW50fS5cbiAgICAgKi9cbiAgICBsYXN0RGVzY2VuZGFudDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBsZXQgbGFzdERlc2NlbmRhbnQgPSB0aGlzLmxhc3RDaGlsZCgpO1xuICAgICAgICB3aGlsZSAobGFzdERlc2NlbmRhbnQgJiYgbGFzdERlc2NlbmRhbnQuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgbGFzdERlc2NlbmRhbnQgPSBsYXN0RGVzY2VuZGFudC5sYXN0Q2hpbGQoKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAobGFzdERlc2NlbmRhbnQgJiYgcHJlZGljYXRlICYmICFsYXN0RGVzY2VuZGFudC50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGxhc3REZXNjZW5kYW50ID0gdGhpcy5fZGVzY2VuZGFudEJlZm9yZShsYXN0RGVzY2VuZGFudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxhc3REZXNjZW5kYW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5kZXNjZW5kYW50c30uXG4gICAgICovXG4gICAgZGVzY2VuZGFudHM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgZGVzY2VuZGFudHMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICBkZXNjZW5kYW50cyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdIHtcbiAgICAgICAgY29uc3QgZGVzY2VuZGFudHMgPSBbXTtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBbLi4udGhpcy5jaGlsZFZOb2Rlc107XG4gICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBzdGFjay5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKG5vZGUudGFuZ2libGUgJiYgKCFwcmVkaWNhdGUgfHwgbm9kZS50ZXN0KHByZWRpY2F0ZSkpKSB7XG4gICAgICAgICAgICAgICAgZGVzY2VuZGFudHMucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgQ29udGFpbmVyTm9kZSkge1xuICAgICAgICAgICAgICAgIHN0YWNrLnVuc2hpZnQoLi4ubm9kZS5jaGlsZFZOb2Rlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlc2NlbmRhbnRzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBVcGRhdGluZ1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBWTm9kZSB3aXRoIHRoZSBzYW1lIHR5cGUgYW5kIGF0dHJpYnV0ZXMgYXMgdGhpcyBWTm9kZS5cbiAgICAgKi9cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBjbG9uZSA9IHN1cGVyLmNsb25lKHBhcmFtcyk7XG4gICAgICAgIGlmIChkZWVwQ2xvbmUpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcykge1xuICAgICAgICAgICAgICAgIGNsb25lLmFwcGVuZChjaGlsZC5jbG9uZSh0cnVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5wcmVwZW5kfS5cbiAgICAgKi9cbiAgICBwcmVwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydEF0SW5kZXgoY2hpbGQsIDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGlsZHJlbi5maW5kKGNoaWxkID0+IGNoaWxkLnRhbmdpYmxlKSkge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGlsZExpc3QnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5hcHBlbmR9LlxuICAgICAqL1xuICAgIGFwcGVuZCguLi5jaGlsZHJlbjogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICB0aGlzLl9pbnNlcnRBdEluZGV4KGNoaWxkLCB0aGlzLmNoaWxkVk5vZGVzLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoaWxkcmVuLmZpbmQoY2hpbGQgPT4gY2hpbGQudGFuZ2libGUpKSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2NoaWxkTGlzdCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmluc2VydEJlZm9yZX0uXG4gICAgICovXG4gICAgaW5zZXJ0QmVmb3JlKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGlsZFZOb2Rlcy5pbmRleE9mKHJlZmVyZW5jZSk7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDaGlsZEVycm9yKHRoaXMsIG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2luc2VydEF0SW5kZXgobm9kZSwgaW5kZXgpO1xuICAgICAgICBpZiAobm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGlsZExpc3QnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5pbnNlcnRBZnRlcn0uXG4gICAgICovXG4gICAgaW5zZXJ0QWZ0ZXIobm9kZTogVk5vZGUsIHJlZmVyZW5jZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkVk5vZGVzLmluZGV4T2YocmVmZXJlbmNlKTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IENoaWxkRXJyb3IodGhpcywgbm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW5zZXJ0QXRJbmRleChub2RlLCBpbmRleCArIDEpO1xuICAgICAgICBpZiAobm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGlsZExpc3QnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5lbXB0eX0uXG4gICAgICovXG4gICAgZW1wdHkoKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgWy4uLnRoaXMuY2hpbGRWTm9kZXNdKSB7XG4gICAgICAgICAgICBjaGlsZC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5yZW1vdmVDaGlsZH0uXG4gICAgICovXG4gICAgcmVtb3ZlQ2hpbGQoY2hpbGQ6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGlsZFZOb2Rlcy5pbmRleE9mKGNoaWxkKTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IENoaWxkRXJyb3IodGhpcywgY2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlbW92ZUF0SW5kZXgoaW5kZXgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5zcGxpdEF0fS5cbiAgICAgKi9cbiAgICBzcGxpdEF0KGNoaWxkOiBWTm9kZSk6IHRoaXMge1xuICAgICAgICBpZiAoY2hpbGQucGFyZW50ICE9PSB0aGlzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2hpbGRFcnJvcih0aGlzLCBjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZHVwbGljYXRlID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRWTm9kZXMuaW5kZXhPZihjaGlsZCk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5jaGlsZFZOb2Rlcy5zcGxpY2UoaW5kZXgpO1xuICAgICAgICBkdXBsaWNhdGUuY2hpbGRWTm9kZXMucHVzaCguLi5jaGlsZHJlbik7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGNoaWxkLnBhcmVudCA9IGR1cGxpY2F0ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFmdGVyKGR1cGxpY2F0ZSk7XG4gICAgICAgIHJldHVybiBkdXBsaWNhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLm1lcmdlV2l0aH0uXG4gICAgICovXG4gICAgbWVyZ2VXaXRoKG5ld0NvbnRhaW5lcjogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKG5ld0NvbnRhaW5lciAhPT0gdGhpcykge1xuICAgICAgICAgICAgaWYgKG5ld0NvbnRhaW5lci5jaGlsZFZOb2Rlcy5pbmNsdWRlcyh0aGlzKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcy5zbGljZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRhaW5lci5pbnNlcnRCZWZvcmUoY2hpbGQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGFpbmVyLmFwcGVuZCguLi50aGlzLmNoaWxkVk5vZGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUudW53cmFwfS5cbiAgICAgKi9cbiAgICB1bndyYXAoKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcy5zbGljZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZShjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZGVzY2VuZGFudCBvZiB0aGlzIG5vZGUgdGhhdCBkaXJlY3RseSBwcmVjZWRlcyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAqIGluIGRlcHRoLWZpcnN0IHByZS1vcmRlciB0cmF2ZXJzYWwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIF9kZXNjZW5kYW50QmVmb3JlKG5vZGU6IFZOb2RlKTogVk5vZGUge1xuICAgICAgICBsZXQgcHJldmlvdXMgPSBub2RlLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICBpZiAocHJldmlvdXMpIHtcbiAgICAgICAgICAgIC8vIFRoZSBub2RlIGJlZm9yZSBub2RlIGlzIHRoZSBsYXN0IGxlYWYgb2YgaXRzIHByZXZpb3VzIHNpYmxpbmcuXG4gICAgICAgICAgICBwcmV2aW91cyA9IHByZXZpb3VzLmxhc3RMZWFmKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIC8vIElmIGl0IGhhcyBubyBwcmV2aW91cyBzaWJsaW5nIHRoZW4gY2xpbWIgdXAgdG8gdGhlIHBhcmVudC5cbiAgICAgICAgICAgIC8vIFRoaXMgaXMgc2ltaWxhciB0byBgcHJldmlvdXNgIGJ1dCBjYW4ndCBnbyBmdXJ0aGVyIHRoYW4gYHRoaXNgLlxuICAgICAgICAgICAgcHJldmlvdXMgPSBub2RlLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJldmlvdXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZGVzY2VuZGFudCBvZiB0aGlzIG5vZGUgdGhhdCBkaXJlY3RseSBmb2xsb3dzIHRoZSBnaXZlbiBub2RlXG4gICAgICogaW4gZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2Rlc2NlbmRhbnRBZnRlcihub2RlOiBWTm9kZSk6IFZOb2RlIHtcbiAgICAgICAgLy8gVGhlIG5vZGUgYWZ0ZXIgbm9kZSBpcyBpdHMgZmlyc3QgY2hpbGQuXG4gICAgICAgIGxldCBuZXh0ID0gbm9kZS5maXJzdENoaWxkKCk7XG4gICAgICAgIGlmICghbmV4dCkge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRoZW4gaXQgaXMgaXRzIG5leHQgc2libGluZy5cbiAgICAgICAgICAgIG5leHQgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFuZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiBpdCBoYXMgbm8gc2libGluZ3MgZWl0aGVyIHRoZW4gY2xpbWIgdXAgdG8gdGhlIGNsb3Nlc3QgcGFyZW50XG4gICAgICAgICAgICAvLyB3aGljaCBoYXMgYSBuZXh0IHNpYmlsaW5nLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBzaW1pbGFyIHRvIGBuZXh0YCBidXQgY2FuJ3QgZ28gZnVydGhlciB0aGFuIGB0aGlzYC5cbiAgICAgICAgICAgIGxldCBhbmNlc3RvciA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgd2hpbGUgKGFuY2VzdG9yICE9PSB0aGlzICYmICFhbmNlc3Rvci5uZXh0U2libGluZygpKSB7XG4gICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYW5jZXN0b3IgIT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICBuZXh0ID0gYW5jZXN0b3IubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV4dDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgVk5vZGUgYXQgdGhlIGdpdmVuIGluZGV4IHdpdGhpbiB0aGlzIFZOb2RlJ3MgY2hpbGRyZW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2hpbGRcbiAgICAgKiBAcGFyYW0gaW5kZXggVGhlIGluZGV4IGF0IHdoaWNoIHRoZSBpbnNlcnRpb24gbXVzdCB0YWtlIHBsYWNlIHdpdGhpbiB0aGlzXG4gICAgICogVk5vZGUncyBwYXJlbnQsIGhvbGRpbmcgbWFya2VyIG5vZGVzIGludG8gYWNjb3VudC5cbiAgICAgKi9cbiAgICBfaW5zZXJ0QXRJbmRleChjaGlsZDogVk5vZGUsIGluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKGNoaWxkLnBhcmVudCkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gY2hpbGQucGFyZW50LmNoaWxkVk5vZGVzLmluZGV4T2YoY2hpbGQpO1xuICAgICAgICAgICAgaWYgKGluZGV4ICYmIGNoaWxkLnBhcmVudCA9PT0gdGhpcyAmJiBjdXJyZW50SW5kZXggPCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hpbGRWTm9kZXMuc3BsaWNlKGluZGV4LCAwLCBjaGlsZCk7XG4gICAgICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgbnRoIGNoaWxkIGZyb20gdGhpcyBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IFRoZSBpbmRleCBvZiB0aGUgY2hpbGQgdG8gcmVtb3ZlIGluY2x1ZGluZyBtYXJrZXIgbm9kZXMuXG4gICAgICovXG4gICAgX3JlbW92ZUF0SW5kZXgoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRWTm9kZXMuc3BsaWNlKGluZGV4LCAxKVswXTtcbiAgICAgICAgaWYgKGNoaWxkLnRhbmdpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2NoaWxkTGlzdCcpO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLnBhcmVudCA9IHVuZGVmaW5lZDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGNsYXNzIEZyYWdtZW50Tm9kZSBleHRlbmRzIENvbnRhaW5lck5vZGUge1xuICAgIHJlYWRvbmx5IGVkaXRhYmxlID0gZmFsc2U7XG4gICAgcmVhZG9ubHkgYnJlYWthYmxlID0gZmFsc2U7XG5cbiAgICBzZXQgcGFyZW50KHBhcmVudDogQ29udGFpbmVyTm9kZSkge1xuICAgICAgICB0aGlzLm1lcmdlV2l0aChwYXJlbnQpO1xuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4vQXRvbWljTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBNYXJrZXJOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGF0b21pYyA9IHRydWU7XG4gICAgZWRpdGFibGUgPSBmYWxzZTtcbiAgICB0YW5naWJsZSA9IGZhbHNlO1xufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4vQXRvbWljTm9kZSc7XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIGFuIGF0b21pYyBub2RlIHRoYXQgaXMgdXNlZCBhcyBhIGNvbnRlbnQgc2VwYXJhdG9yLlxuICovXG5leHBvcnQgY2xhc3MgU2VwYXJhdG9yTm9kZSBleHRlbmRzIEF0b21pY05vZGUge31cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuL0NvbnRhaW5lck5vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZFbGVtZW50UGFyYW1zIHtcbiAgICBodG1sVGFnOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBWRWxlbWVudCBleHRlbmRzIENvbnRhaW5lck5vZGUge1xuICAgIGh0bWxUYWc6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IFZFbGVtZW50UGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaHRtbFRhZyA9IHBhcmFtcy5odG1sVGFnO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgVkVsZW1lbnQ+WzBdID0ge1xuICAgICAgICAgICAgaHRtbFRhZzogdGhpcy5odG1sVGFnLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoZGVlcENsb25lLCB7IC4uLmRlZmF1bHRzLCAuLi5wYXJhbXMgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29uc3RydWN0b3IgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4vQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi9BdG9taWNOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4vQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGVudW0gUmVsYXRpdmVQb3NpdGlvbiB7XG4gICAgQkVGT1JFID0gJ0JFRk9SRScsXG4gICAgQUZURVIgPSAnQUZURVInLFxuICAgIElOU0lERSA9ICdJTlNJREUnLFxufVxuXG5leHBvcnQgdHlwZSBWTm9kZSA9IEFic3RyYWN0Tm9kZSAmIChDb250YWluZXJOb2RlIHwgQXRvbWljTm9kZSk7XG5cbmV4cG9ydCB0eXBlIFR5cGVndWFyZDxUIGV4dGVuZHMgVk5vZGU+ID0gKG5vZGU6IFZOb2RlKSA9PiBub2RlIGlzIFQ7XG5leHBvcnQgdHlwZSBQcmVkaWNhdGU8VCA9IFZOb2RlIHwgYm9vbGVhbj4gPSBUIGV4dGVuZHMgVk5vZGVcbiAgICA/IENvbnN0cnVjdG9yPFQ+IHwgVHlwZWd1YXJkPFQ+XG4gICAgOiAobm9kZTogVk5vZGUpID0+IGJvb2xlYW47XG5cbmV4cG9ydCB0eXBlIFBvaW50ID0gW1ZOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uXTtcblxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBpcyBhIGxlYWYgaW4gdGhlIFZEb2N1bWVudCwgdGhhdCBpcyBhIG5vZGUgdGhhdFxuICogaGFzIG5vIGNoaWxkcmVuLlxuICpcbiAqIEBwYXJhbSBub2RlIG5vZGUgdG8gY2hlY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTGVhZihub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhbm9kZS5oYXNDaGlsZHJlbigpO1xufVxuIiwiaW1wb3J0IHsgVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24sIFBvaW50IH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgUHJlZGljYXRlIH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTWFya2VyTm9kZSB9IGZyb20gJy4vVk5vZGVzL01hcmtlck5vZGUnO1xuaW1wb3J0IHsgQ29uc3RydWN0b3IgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgRnJhZ21lbnROb2RlIH0gZnJvbSAnLi9WTm9kZXMvRnJhZ21lbnROb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4vVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBUYWJsZUNlbGxOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXRhYmxlL3NyYy9UYWJsZUNlbGxOb2RlJztcbmltcG9ydCB7IE1vZGUsIFJ1bGVQcm9wZXJ0eSB9IGZyb20gJy4vTW9kZSc7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi9KV0VkaXRvcic7XG5cbmV4cG9ydCBjbGFzcyBWUmFuZ2Uge1xuICAgIHJlYWRvbmx5IHN0YXJ0ID0gbmV3IE1hcmtlck5vZGUoKTtcbiAgICByZWFkb25seSBlbmQgPSBuZXcgTWFya2VyTm9kZSgpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjb250ZXh0IG9mIGEgY29sbGFwc2VkIHJhbmdlIGF0IHRoZSBnaXZlbiBsb2NhdGlvbiwgdGFyZ2V0dGluZ1xuICAgICAqIGEgcmVmZXJlbmNlIFZOb2RlIGFuZCBzcGVjaWZ5aW5nIHRoZSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGF0IFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqIEBwYXJhbSBwb3NpdGlvblxuICAgICAqL1xuICAgIHN0YXRpYyBhdChyZWZlcmVuY2U6IFZOb2RlLCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTogW1BvaW50LCBQb2ludF0ge1xuICAgICAgICByZXR1cm4gVlJhbmdlLnNlbGVjdGluZyhyZWZlcmVuY2UsIHBvc2l0aW9uLCByZWZlcmVuY2UsIHBvc2l0aW9uKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjb250ZXh0IG9mIGEgcmFuZ2UgYXQgdGhlIGxvY2F0aW9uIG9mIHRoZSBnaXZlbiByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByYW5nZVxuICAgICAqL1xuICAgIHN0YXRpYyBjbG9uZShyYW5nZTogVlJhbmdlKTogW1BvaW50LCBQb2ludF0ge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW3JhbmdlLnN0YXJ0LCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRV0sXG4gICAgICAgICAgICBbcmFuZ2UuZW5kLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSXSxcbiAgICAgICAgXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjb250ZXh0IG9mIGEgcmFuZ2Ugc2VsZWN0aW5nIHRoZSBnaXZlbiBub2Rlcy5cbiAgICAgKiBDb25zaWRlciBgYWJgIChgW2AgPSBzdGFydCwgYF1gID0gZW5kKTpcbiAgICAgKiBgc2VsZWN0KGEpYCA9PiBgW2FdYmBcbiAgICAgKiBgc2VsZWN0KGEsIGIpYCA9PiBgW2FiXWBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSlgID0+IGBbYV1iYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUiwgYiwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpYCA9PiBgYVtdYmBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKWAgPT4gYFthYl1gXG4gICAgICogYHNlbGVjdChhLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKWAgPT4gYGFbYl1gXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RhcnROb2RlXG4gICAgICogQHBhcmFtIFtzdGFydFBvc2l0aW9uXSBkZWZhdWx0OiBgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkVgXG4gICAgICogQHBhcmFtIFtlbmROb2RlXSBkZWZhdWx0OiBgc3RhcnROb2RlYFxuICAgICAqIEBwYXJhbSBbZW5kUG9zaXRpb25dIGRlZmF1bHQ6IGBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSYFxuICAgICAqL1xuICAgIHN0YXRpYyBzZWxlY3Rpbmcoc3RhcnROb2RlOiBWTm9kZSwgZW5kTm9kZT86IFZOb2RlKTogW1BvaW50LCBQb2ludF07XG4gICAgc3RhdGljIHNlbGVjdGluZyhcbiAgICAgICAgc3RhcnROb2RlOiBWTm9kZSxcbiAgICAgICAgc3RhcnRQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbixcbiAgICAgICAgZW5kTm9kZTogVk5vZGUsXG4gICAgICAgIGVuZFBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uLFxuICAgICk6IFtQb2ludCwgUG9pbnRdO1xuICAgIHN0YXRpYyBzZWxlY3RpbmcoXG4gICAgICAgIHN0YXJ0Tm9kZTogVk5vZGUsXG4gICAgICAgIHN0YXJ0UG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24gfCBWTm9kZSA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLFxuICAgICAgICBlbmROb2RlOiBWTm9kZSA9IHN0YXJ0Tm9kZSxcbiAgICAgICAgZW5kUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSLFxuICAgICk6IFtQb2ludCwgUG9pbnRdIHtcbiAgICAgICAgaWYgKHN0YXJ0UG9zaXRpb24gaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgIGVuZE5vZGUgPSBzdGFydFBvc2l0aW9uO1xuICAgICAgICAgICAgc3RhcnRQb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbc3RhcnROb2RlLCBzdGFydFBvc2l0aW9uXSxcbiAgICAgICAgICAgIFtlbmROb2RlLCBlbmRQb3NpdGlvbl0sXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyByZWFkb25seSBlZGl0b3I6IEpXRWRpdG9yLFxuICAgICAgICBib3VuZGFyeVBvaW50cz86IFtQb2ludCwgUG9pbnRdLFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9tb2RlPzogTW9kZSxcbiAgICApIHtcbiAgICAgICAgLy8gSWYgYSByYW5nZSBjb250ZXh0IGlzIGdpdmVuLCBhZGFwdCB0aGlzIHJhbmdlIHRvIG1hdGNoIGl0LlxuICAgICAgICBpZiAoYm91bmRhcnlQb2ludHMpIHtcbiAgICAgICAgICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IGJvdW5kYXJ5UG9pbnRzO1xuICAgICAgICAgICAgY29uc3QgW3N0YXJ0Tm9kZSwgc3RhcnRQb3NpdGlvbl0gPSBzdGFydDtcbiAgICAgICAgICAgIGNvbnN0IFtlbmROb2RlLCBlbmRQb3NpdGlvbl0gPSBlbmQ7XG4gICAgICAgICAgICBpZiAoZW5kUG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQUZURVIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEVuZChlbmROb2RlLCBlbmRQb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydChzdGFydE5vZGUsIHN0YXJ0UG9zaXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0KHN0YXJ0Tm9kZSwgc3RhcnRQb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRFbmQoZW5kTm9kZSwgZW5kUG9zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG1vZGUoKTogTW9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2RlIHx8IHRoaXMuZWRpdG9yLm1vZGU7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGdldCBzdGFydENvbnRhaW5lcigpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnBhcmVudDtcbiAgICB9XG5cbiAgICBnZXQgZW5kQ29udGFpbmVyKCk6IFZOb2RlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5kLnBhcmVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgcmFuZ2UgaXMgY29sbGFwc2VkLlxuICAgICAqL1xuICAgIGlzQ29sbGFwc2VkKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRDb250YWluZXIgfHwgIXRoaXMuZW5kQ29udGFpbmVyKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGNoaWxkVk5vZGVzID0gdGhpcy5zdGFydC5wYXJlbnQuY2hpbGRWTm9kZXM7XG4gICAgICAgIGxldCBpbmRleCA9IGNoaWxkVk5vZGVzLmluZGV4T2YodGhpcy5lbmQpO1xuICAgICAgICB3aGlsZSAoaW5kZXggPiAwKSB7XG4gICAgICAgICAgICBpbmRleC0tO1xuICAgICAgICAgICAgY29uc3Qgc2libGluZyA9IGNoaWxkVk5vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChzaWJsaW5nID09PSB0aGlzLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2libGluZy50YW5naWJsZSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIHN0YXJ0IG9yIGVuZCBvZiB0aGUgcmFuZ2UgaXMgY29udGFpbmVkIHdpdGhpbiB0aGVcbiAgICAgKiBnaXZlbiBjb250YWluZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyXG4gICAgICovXG4gICAgaXNJbihjb250YWluZXI6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBzdGFydEFuY2VzdG9yOiBWTm9kZSA9IHRoaXMuc3RhcnQ7XG4gICAgICAgIGxldCBlbmRBbmNlc3RvcjogVk5vZGUgPSB0aGlzLmVuZDtcbiAgICAgICAgd2hpbGUgKHN0YXJ0QW5jZXN0b3IgfHwgZW5kQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIGlmIChzdGFydEFuY2VzdG9yID09PSBjb250YWluZXIgfHwgZW5kQW5jZXN0b3IgPT09IGNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnRBbmNlc3RvciA9IHN0YXJ0QW5jZXN0b3I/LnBhcmVudDtcbiAgICAgICAgICAgIGVuZEFuY2VzdG9yID0gZW5kQW5jZXN0b3I/LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGxpc3Qgb2YgYWxsIG5vZGVzIHRoYXQgYXJlIGZ1bGx5IHNlbGVjdGVkIGJ5IHRoaXMgcmFuZ2UuXG4gICAgICovXG4gICAgc2VsZWN0ZWROb2RlczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIHNlbGVjdGVkTm9kZXMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICBzZWxlY3RlZE5vZGVzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGxldCBub2RlID0gdGhpcy5zdGFydDtcbiAgICAgICAgY29uc3QgYm91bmQgPSB0aGlzLmVuZC5uZXh0KCk7XG4gICAgICAgIGNvbnN0IGVuZENvbnRhaW5lcnMgPSB0aGlzLmVuZC5hbmNlc3RvcnMoKTtcbiAgICAgICAgd2hpbGUgKChub2RlID0gbm9kZS5uZXh0KCkpICYmIG5vZGUgIT09IGJvdW5kKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgIWVuZENvbnRhaW5lcnMuaW5jbHVkZXMobm9kZSkgJiZcbiAgICAgICAgICAgICAgICAhKG5vZGUgaW5zdGFuY2VvZiBGcmFnbWVudE5vZGUpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKG5vZGUsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSkgJiZcbiAgICAgICAgICAgICAgICBub2RlPy50ZXN0KHByZWRpY2F0ZSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbHJlYWR5VGVzdGVkID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgZm9yIChjb25zdCBzZWxlY3RlZE5vZGUgb2Ygc2VsZWN0ZWROb2Rlcykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgbmV4dCBhbmNlc3RvciB3aG9zZSBjaGlsZHJlbiBhcmUgYWxsIHNlbGVjdGVkXG4gICAgICAgICAgICAvLyBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0LlxuICAgICAgICAgICAgLy8gVE9ETzogSWRlYWxseSwgc2VsZWN0ZWQgbm9kZXMgc2hvdWxkIGJlIHJldHVybmVkIGluIERGUyBvcmRlci5cbiAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yID0gc2VsZWN0ZWROb2RlLnBhcmVudDtcbiAgICAgICAgICAgIGlmIChhbmNlc3RvciAmJiAhYWxyZWFkeVRlc3RlZC5oYXMoYW5jZXN0b3IpKSB7XG4gICAgICAgICAgICAgICAgYWxyZWFkeVRlc3RlZC5hZGQoYW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbENoaWxkcmVuU2VsZWN0ZWQgPSBhbmNlc3RvclxuICAgICAgICAgICAgICAgICAgICAuY2hpbGRyZW4oKVxuICAgICAgICAgICAgICAgICAgICAuZXZlcnkoY2hpbGQgPT4gc2VsZWN0ZWROb2Rlcy5pbmNsdWRlcyhjaGlsZCkpO1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgYWxsQ2hpbGRyZW5TZWxlY3RlZCAmJlxuICAgICAgICAgICAgICAgICAgICAhc2VsZWN0ZWROb2Rlcy5pbmNsdWRlcyhhbmNlc3RvcikgJiZcbiAgICAgICAgICAgICAgICAgICAgIShhbmNlc3RvciBpbnN0YW5jZW9mIEZyYWdtZW50Tm9kZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKGFuY2VzdG9yLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpICYmXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yLnRlc3QocHJlZGljYXRlKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGVzLnB1c2goYW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZWN0ZWROb2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbGlzdCBvZiBhbGwgdGhlIG5vZGVzIGN1cnJlbnRseSB0YXJnZXRlZCBieSB0aGUgcmFuZ2UuIElmIHRoZVxuICAgICAqIHJhbmdlIGlzIGNvbGxhcHNlZCwgdGhlIHRhcmdldGVkIG5vZGUgaXMgdGhlIGNvbnRhaW5lciBvZiB0aGUgcmFuZ2UuXG4gICAgICogT3RoZXJ3aXNlLCB0aGUgdGFyZ2V0ZWQgbm9kZXMgYXJlIHRoZSBvbmVzIGVuY291bnRlcmVkIGJ5IHRyYXZlcnNpbmcgdGhlXG4gICAgICogdHJlZSBmcm9tIHRoZSBzdGFydCB0byBlbmQgb2YgdGhpcyByYW5nZSwgdG9nZXRoZXIgd2l0aCB0aGUgc3RhcnRcbiAgICAgKiBjb250YWluZXIuXG4gICAgICovXG4gICAgdGFyZ2V0ZWROb2RlczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIHRhcmdldGVkTm9kZXMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICB0YXJnZXRlZE5vZGVzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCB0YXJnZXRlZE5vZGVzOiBWTm9kZVtdID0gdGhpcy50cmF2ZXJzZWROb2RlcyhwcmVkaWNhdGUpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhdGhpcy5lbmQucHJldmlvdXNTaWJsaW5nKCkgJiZcbiAgICAgICAgICAgIHRhcmdldGVkTm9kZXMubGVuZ3RoICYmXG4gICAgICAgICAgICB0YXJnZXRlZE5vZGVzW3RhcmdldGVkTm9kZXMubGVuZ3RoIC0gMV0gPT09IHRoaXMuZW5kQ29udGFpbmVyXG4gICAgICAgICkge1xuICAgICAgICAgICAgLy8gV2hlbiBzZWxlY3RpbmcgYSBjb250YWluZXIgYW5kIHRoZSBzcGFjZSBiZXR3ZWVuIGl0IGFuZCB0aGUgbmV4dFxuICAgICAgICAgICAgLy8gb25lIChlZy4gdHJpcGxlIGNsaWNrKSwgZG9uJ3QgcmV0dXJuIHRoZSBuZXh0IGNvbnRhaW5lciBhcyB3ZWxsLlxuICAgICAgICAgICAgdGFyZ2V0ZWROb2Rlcy5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjbG9zZXN0U3RhcnRBbmNlc3RvciA9IHRoaXMuc3RhcnQuYW5jZXN0b3IocHJlZGljYXRlKTtcbiAgICAgICAgaWYgKGNsb3Nlc3RTdGFydEFuY2VzdG9yICYmIHRoaXMubW9kZS5pcyhjbG9zZXN0U3RhcnRBbmNlc3RvciwgUnVsZVByb3BlcnR5LkVESVRBQkxFKSkge1xuICAgICAgICAgICAgdGFyZ2V0ZWROb2Rlcy51bnNoaWZ0KGNsb3Nlc3RTdGFydEFuY2VzdG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChjbG9zZXN0U3RhcnRBbmNlc3Rvcikge1xuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBbLi4uY2xvc2VzdFN0YXJ0QW5jZXN0b3IuY2hpbGRWTm9kZXNdLnJldmVyc2UoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICF0YXJnZXRlZE5vZGVzLmluY2x1ZGVzKGNoaWxkKSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGUuaXMoY2hpbGQsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSkgJiZcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQudGVzdChwcmVkaWNhdGUpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldGVkTm9kZXMudW5zaGlmdChjaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXRlZE5vZGVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyB0cmF2ZXJzZWQgZnJvbSBzdGFydCB0byBlbmQgb2YgdGhpcyByYW5nZS5cbiAgICAgKi9cbiAgICB0cmF2ZXJzZWROb2RlczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIHRyYXZlcnNlZE5vZGVzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgdHJhdmVyc2VkTm9kZXMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IHRyYXZlcnNlZE5vZGVzID0gW107XG4gICAgICAgIGxldCBub2RlID0gdGhpcy5zdGFydDtcbiAgICAgICAgY29uc3QgYm91bmQgPSB0aGlzLmVuZC5uZXh0KCk7XG4gICAgICAgIHdoaWxlICgobm9kZSA9IG5vZGUubmV4dCgpKSAmJiBub2RlICE9PSBib3VuZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZS5pcyhub2RlLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpICYmIG5vZGUudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgdHJhdmVyc2VkTm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJhdmVyc2VkTm9kZXM7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBDb2xsYXBzZSB0aGUgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2VkZ2VdIHJhbmdlIGVkZ2Ugb24gd2hpY2ggdG8gY29sbGFwc2VcbiAgICAgKi9cbiAgICBjb2xsYXBzZShlZGdlID0gdGhpcy5zdGFydCk6IHZvaWQge1xuICAgICAgICBpZiAoZWRnZSA9PT0gdGhpcy5zdGFydCkge1xuICAgICAgICAgICAgdGhpcy5zZXRFbmQoZWRnZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZWRnZSA9PT0gdGhpcy5lbmQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhcnQoZWRnZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSByYW5nZSdzIHN0YXJ0IHBvaW50IChpbiB0cmF2ZXJzYWwgb3JkZXIpIGF0IHRoZSBnaXZlbiBsb2NhdGlvbixcbiAgICAgKiB0YXJnZXR0aW5nIGEgYHJlZmVyZW5jZWAgVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIGBwb3NpdGlvbmAgaW4gcmVmZXJlbmNlXG4gICAgICogdG8gdGhhdCBWTm9kZSAoJ0JFRk9SRScsICdBRlRFUicpLCBsaWtlIGluIGFuIGB4cGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKiBAcGFyYW0gW3Bvc2l0aW9uXVxuICAgICAqL1xuICAgIHNldFN0YXJ0KHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLmZpcnN0TGVhZigpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UubGFzdExlYWYoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVmZXJlbmNlIGluc3RhbmNlb2YgQ29udGFpbmVyTm9kZSAmJiAhcmVmZXJlbmNlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZS5wcmVwZW5kKHRoaXMuc3RhcnQpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSICYmIHJlZmVyZW5jZSAhPT0gdGhpcy5lbmQpIHtcbiAgICAgICAgICAgIC8vIFdlIGNoZWNrIHRoYXQgYHJlZmVyZW5jZWAgaXNuJ3QgYHRoaXMuZW5kYCB0byBhdm9pZCBhIGJhY2t3YXJkXG4gICAgICAgICAgICAvLyBjb2xsYXBzZWQgcmFuZ2UuXG4gICAgICAgICAgICByZWZlcmVuY2UuYWZ0ZXIodGhpcy5zdGFydCk7XG4gICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uSU5TSURFKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UuYXBwZW5kKHRoaXMuc3RhcnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmZXJlbmNlLmJlZm9yZSh0aGlzLnN0YXJ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHJhbmdlJ3MgZW5kIHBvaW50IChpbiB0cmF2ZXJzYWwgb3JkZXIpIGF0IHRoZSBnaXZlbiBsb2NhdGlvbixcbiAgICAgKiB0YXJnZXR0aW5nIGEgYHJlZmVyZW5jZWAgVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIGBwb3NpdGlvbmAgaW4gcmVmZXJlbmNlXG4gICAgICogdG8gdGhhdCBWTm9kZSAoJ0JFRk9SRScsICdBRlRFUicpLCBsaWtlIGluIGFuIGB4cGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKiBAcGFyYW0gW3Bvc2l0aW9uXVxuICAgICAqL1xuICAgIHNldEVuZChyZWZlcmVuY2U6IFZOb2RlLCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVIpOiB2b2lkIHtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLmZpcnN0TGVhZigpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UubGFzdExlYWYoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVmZXJlbmNlIGluc3RhbmNlb2YgQ29udGFpbmVyTm9kZSAmJiAhcmVmZXJlbmNlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZS5hcHBlbmQodGhpcy5lbmQpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSAmJiByZWZlcmVuY2UgIT09IHRoaXMuc3RhcnQpIHtcbiAgICAgICAgICAgIC8vIFdlIGNoZWNrIHRoYXQgYHJlZmVyZW5jZWAgaXNuJ3QgYHRoaXMuc3RhcnRgIHRvIGF2b2lkIGEgYmFja3dhcmRcbiAgICAgICAgICAgIC8vIGNvbGxhcHNlZCByYW5nZS5cbiAgICAgICAgICAgIHJlZmVyZW5jZS5iZWZvcmUodGhpcy5lbmQpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlLmFwcGVuZCh0aGlzLmVuZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWZlcmVuY2UuYWZ0ZXIodGhpcy5lbmQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGlzIHJhbmdlIGluIHN1Y2ggYSB3YXkgdGhhdCBpdCBpbmNsdWRlcyB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIFRoaXMgbWV0aG9kIG1vdmVzIHRoZSBib3VuZGFyeSBtYXJrZXIgdGhhdCBpcyBjbG9zZXN0IHRvIHRoZSBnaXZlbiBub2RlXG4gICAgICogdXAgb3IgZG93biB0aGUgdHJlZSBpbiBvcmRlciB0byBpbmNsdWRlIHRoZSBnaXZlbiBub2RlIGludG8gdGhlIHJhbmdlLlxuICAgICAqIEJlY2F1c2Ugb2YgdGhhdCwgY2FsbGluZyB0aGlzIG1ldGhvZCB3aWxsIGFsd2F5cyByZXN1bHQgaW4gYSByYW5nZSB0aGF0XG4gICAgICogaXMgYXQgbGVhc3QgdGhlIHNpemUgdGhhdCBpdCB3YXMgcHJpb3IgdG8gY2FsbGluZyBpdCwgYW5kIHVzdWFsbHkgYmlnZ2VyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRhcmdldE5vZGUgVGhlIG5vZGUgdG8gZXh0ZW5kIHRoZSByYW5nZSB0by5cbiAgICAgKi9cbiAgICBleHRlbmRUbyh0YXJnZXROb2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICBsZXQgcG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb247XG4gICAgICAgIGlmICh0YXJnZXROb2RlLmlzQmVmb3JlKHRoaXMuc3RhcnQpKSB7XG4gICAgICAgICAgICB0YXJnZXROb2RlID0gdGFyZ2V0Tm9kZS5wcmV2aW91cygpO1xuICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIHRhcmdldE5vZGUgPSB0YXJnZXROb2RlLmZpcnN0TGVhZigpO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlICYmIHRoaXMuZW5kLm5leHRTaWJsaW5nKCkgIT09IHRhcmdldE5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0KHRhcmdldE5vZGUsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0YXJnZXROb2RlLmlzQWZ0ZXIodGhpcy5lbmQpKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Tm9kZSA9IHRhcmdldE5vZGUubmV4dCgpO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRFbmQodGFyZ2V0Tm9kZSwgcG9zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwbGl0IHRoZSByYW5nZSBjb250YWluZXJzIHVwIHRvIHRoZWlyIGNvbW1vbiBhbmNlc3Rvci4gUmV0dXJuIGFsbFxuICAgICAqIGNoaWxkcmVuIG9mIHRoZSBjb21tb24gYW5jZXN0b3IgdGhhdCBhcmUgdGFyZ2V0ZWQgYnkgdGhlIHJhbmdlIGFmdGVyIHRoZVxuICAgICAqIHNwbGl0LiBJZiBhIHByZWRpY2F0ZSBpcyBnaXZlbiwgc3BsaXR0aW5nIGNvbnRpbnVlcyB1cCB0byBhbmQgaW5jbHVkaW5nXG4gICAgICogdGhlIG5vZGUgY2xvc2VzdCB0byB0aGUgY29tbW9uIGFuY2VzdG9yIHRoYXQgbWF0Y2hlcyB0aGUgcHJlZGljYXRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHByZWRpY2F0ZVxuICAgICAqL1xuICAgIHNwbGl0KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBhbmNlc3RvciA9IHRoaXMuc3RhcnRDb250YWluZXIuY29tbW9uQW5jZXN0b3IodGhpcy5lbmRDb250YWluZXIpO1xuICAgICAgICBjb25zdCBjbG9zZXN0ID0gYW5jZXN0b3IuY2xvc2VzdChwcmVkaWNhdGUpO1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBjbG9zZXN0ID8gY2xvc2VzdC5wYXJlbnQgOiBhbmNlc3RvcjtcblxuICAgICAgICAvLyBTcGxpdCB0aGUgc3RhcnQgYW5jZXN0b3JzLlxuICAgICAgICBsZXQgc3RhcnQ6IFZOb2RlID0gdGhpcy5zdGFydDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgbGV0IHN0YXJ0QW5jZXN0b3IgPSBzdGFydC5wYXJlbnQ7XG4gICAgICAgICAgICAvLyBEbyBub3Qgc3BsaXQgYXQgdGhlIHN0YXJ0IGVkZ2Ugb2YgYSBub2RlLlxuICAgICAgICAgICAgaWYgKHN0YXJ0LnByZXZpb3VzU2libGluZygpICYmIHRoaXMubW9kZS5pcyhzdGFydEFuY2VzdG9yLCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0QW5jZXN0b3IgPSBzdGFydEFuY2VzdG9yLnNwbGl0QXQoc3RhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnQgPSBzdGFydEFuY2VzdG9yO1xuICAgICAgICB9IHdoaWxlIChzdGFydC5wYXJlbnQgIT09IGNvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gU3BsaXQgdGhlIGVuZCBhbmNlc3RvcnMuXG4gICAgICAgIGxldCBlbmQ6IFZOb2RlID0gdGhpcy5lbmQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGNvbnN0IGVuZEFuY2VzdG9yID0gZW5kLnBhcmVudDtcbiAgICAgICAgICAgIC8vIERvIG5vdCBzcGxpdCBhdCB0aGUgZW5kIGVkZ2Ugb2YgYSBub2RlLlxuICAgICAgICAgICAgaWYgKGVuZC5uZXh0U2libGluZygpICYmIHRoaXMubW9kZS5pcyhlbmRBbmNlc3RvciwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSkpIHtcbiAgICAgICAgICAgICAgICBlbmRBbmNlc3Rvci5zcGxpdEF0KGVuZCk7XG4gICAgICAgICAgICAgICAgZW5kQW5jZXN0b3IuYXBwZW5kKGVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbmQgPSBlbmRBbmNlc3RvcjtcbiAgICAgICAgfSB3aGlsZSAoZW5kLnBhcmVudCAhPT0gY29udGFpbmVyKTtcblxuICAgICAgICAvLyBSZXR1cm4gYWxsIHRvcC1tb3N0IHNwbGl0IG5vZGVzIGJldHdlZW4gYW5kIGluY2x1ZGluZyBzdGFydCBhbmQgZW5kLlxuICAgICAgICBjb25zdCBub2RlcyA9IFtdO1xuICAgICAgICBsZXQgbm9kZSA9IHN0YXJ0O1xuICAgICAgICB3aGlsZSAobm9kZSAhPT0gZW5kKSB7XG4gICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBub2Rlcy5wdXNoKGVuZCk7XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1wdHkgdGhlIHJhbmdlIGJ5IHJlbW92aW5nIHNlbGVjdGVkIG5vZGVzIGFuZCBjb2xsYXBzaW5nIGl0IGJ5IG1lcmdpbmdcbiAgICAgKiBub2RlcyBiZXR3ZWVuIHN0YXJ0IGFuZCBlbmQuXG4gICAgICovXG4gICAgZW1wdHkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlbW92YWJsZU5vZGVzID0gdGhpcy5zZWxlY3RlZE5vZGVzKG5vZGUgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETzogUmVwbGFjZSBUYWJsZSBjaGVjayB3aXRoIGNvbXBsZXggdGFibGUgc2VsZWN0aW9uIHN1cHBvcnQuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlLmlzKG5vZGUsIFJ1bGVQcm9wZXJ0eS5FRElUQUJMRSkgJiYgIShub2RlIGluc3RhbmNlb2YgVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZW1vdmUgc2VsZWN0ZWQgbm9kZXMgd2l0aG91dCB0b3VjaGluZyB0aGUgc3RhcnQgcmFuZ2UncyBhbmNlc3RvcnMuXG4gICAgICAgIGNvbnN0IHN0YXJ0QW5jZXN0b3JzID0gdGhpcy5zdGFydC5hbmNlc3RvcnMoKTtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHJlbW92YWJsZU5vZGVzLmZpbHRlcihub2RlID0+ICFzdGFydEFuY2VzdG9ycy5pbmNsdWRlcyhub2RlKSkpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ29sbGFwc2UgdGhlIHJhbmdlIGJ5IG1lcmdpbmcgbm9kZXMgYmV0d2VlbiBzdGFydCBhbmQgZW5kLCBpZiBpdFxuICAgICAgICAvLyBkb2Vzbid0IHRyYXZlcnNlIGFuIHVuYnJlYWthYmxlIG5vZGUuXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0Q29udGFpbmVyICE9PSB0aGlzLmVuZENvbnRhaW5lcikge1xuICAgICAgICAgICAgY29uc3QgY29tbW9uQW5jZXN0b3IgPSB0aGlzLnN0YXJ0LmNvbW1vbkFuY2VzdG9yKHRoaXMuZW5kKTtcbiAgICAgICAgICAgIGxldCBhbmNlc3RvciA9IHRoaXMuZW5kQ29udGFpbmVyLnBhcmVudDtcbiAgICAgICAgICAgIHdoaWxlIChhbmNlc3RvciAmJiBhbmNlc3RvciAhPT0gY29tbW9uQW5jZXN0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yLmNoaWxkcmVuKCkubGVuZ3RoID4gMSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZENvbnRhaW5lci5wYXJlbnQgPT09IGFuY2VzdG9yICYmXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZS5pcyhhbmNlc3RvciwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3Iuc3BsaXRBdCh0aGlzLmVuZENvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKHRoaXMuZW5kQ29udGFpbmVyLCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGUuaXMoYW5jZXN0b3IsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpICYmXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZS5pcyh0aGlzLnN0YXJ0Q29udGFpbmVyLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpICYmXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZS5pcyh0aGlzLmVuZENvbnRhaW5lciwgUnVsZVByb3BlcnR5LkVESVRBQkxFKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZENvbnRhaW5lci5tZXJnZVdpdGgoYW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRyYXZlcnNlZFVuYnJlYWthYmxlcyA9IHRoaXMudHJhdmVyc2VkTm9kZXModGhpcy5faXNVbmJyZWFrYWJsZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGNvbnN0IHVuYnJlYWthYmxlU3RhcnRBbmNlc3RvciA9IHRoaXMuc3RhcnQuYW5jZXN0b3IodGhpcy5faXNVbmJyZWFrYWJsZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICB1bmJyZWFrYWJsZVN0YXJ0QW5jZXN0b3IgJiZcbiAgICAgICAgICAgICAgICAhdGhpcy5lbmQuYW5jZXN0b3Iobm9kZSA9PiBub2RlID09PSB1bmJyZWFrYWJsZVN0YXJ0QW5jZXN0b3IpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0cmF2ZXJzZWRVbmJyZWFrYWJsZXMudW5zaGlmdCh1bmJyZWFrYWJsZVN0YXJ0QW5jZXN0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICF0cmF2ZXJzZWRVbmJyZWFrYWJsZXMubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKHRoaXMuc3RhcnRDb250YWluZXIsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKHRoaXMuZW5kQ29udGFpbmVyLCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSAmJlxuICAgICAgICAgICAgICAgIHRoaXMubW9kZS5pcyh0aGlzLnN0YXJ0Q29udGFpbmVyLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlLmlzKHRoaXMuZW5kQ29udGFpbmVyLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZENvbnRhaW5lci5tZXJnZVdpdGgodGhpcy5zdGFydENvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvbGxhcHNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoaXMgcmFuZ2UgZnJvbSBpdHMgVkRvY3VtZW50LlxuICAgICAqL1xuICAgIHJlbW92ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGFydC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5lbmQucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBpcyB1bmJyZWFrYWJsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2lzVW5icmVha2FibGUobm9kZTogVk5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLm1vZGUuaXMobm9kZSwgUnVsZVByb3BlcnR5LkJSRUFLQUJMRSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVlJhbmdlIH0gZnJvbSAnLi9WUmFuZ2UnO1xuaW1wb3J0IHsgVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24gfSBmcm9tICcuL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBNYXJrZXJOb2RlIH0gZnJvbSAnLi9WTm9kZXMvTWFya2VyTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4vSldFZGl0b3InO1xuXG5leHBvcnQgY29uc3QgQU5DSE9SX0NIQVIgPSAnWyc7XG5leHBvcnQgY29uc3QgRk9DVVNfQ0hBUiA9ICddJztcblxuZXhwb3J0IGVudW0gRGlyZWN0aW9uIHtcbiAgICBCQUNLV0FSRCA9ICdCQUNLV0FSRCcsXG4gICAgRk9SV0FSRCA9ICdGT1JXQVJEJyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWU2VsZWN0aW9uRGVzY3JpcHRpb24ge1xuICAgIGFuY2hvck5vZGU6IFZOb2RlO1xuICAgIGFuY2hvclBvc2l0aW9uPzogUmVsYXRpdmVQb3NpdGlvbjtcbiAgICBmb2N1c05vZGU/OiBWTm9kZTtcbiAgICBmb2N1c1Bvc2l0aW9uPzogUmVsYXRpdmVQb3NpdGlvbjtcbiAgICBkaXJlY3Rpb246IERpcmVjdGlvbjtcbn1cblxuZXhwb3J0IGNsYXNzIFZTZWxlY3Rpb24ge1xuICAgIHJlYWRvbmx5IHJhbmdlOiBWUmFuZ2UgPSBuZXcgVlJhbmdlKHRoaXMuZWRpdG9yKTtcbiAgICBfZGlyZWN0aW9uOiBEaXJlY3Rpb24gPSBEaXJlY3Rpb24uRk9SV0FSRDtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgZWRpdG9yOiBKV0VkaXRvcikge31cblxuICAgIGdldCBhbmNob3IoKTogTWFya2VyTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkZPUldBUkQgPyB0aGlzLnJhbmdlLnN0YXJ0IDogdGhpcy5yYW5nZS5lbmQ7XG4gICAgfVxuXG4gICAgZ2V0IGZvY3VzKCk6IE1hcmtlck5vZGUge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEID8gdGhpcy5yYW5nZS5lbmQgOiB0aGlzLnJhbmdlLnN0YXJ0O1xuICAgIH1cblxuICAgIGdldCBkaXJlY3Rpb24oKTogRGlyZWN0aW9uIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcbiAgICB9XG5cbiAgICBpc0NvbGxhcHNlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFuZ2UuaXNDb2xsYXBzZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBzZWxlY3Rpb24gYWNjb3JkaW5nIHRvIHRoZSBnaXZlbiBkZXNjcmlwdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWxlY3Rpb25cbiAgICAgKi9cbiAgICBzZXQoc2VsZWN0aW9uOiBWU2VsZWN0aW9uRGVzY3JpcHRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZGlyZWN0aW9uID0gc2VsZWN0aW9uLmRpcmVjdGlvbjtcbiAgICAgICAgdGhpcy5zZWxlY3QoXG4gICAgICAgICAgICBzZWxlY3Rpb24uYW5jaG9yTm9kZSxcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JQb3NpdGlvbixcbiAgICAgICAgICAgIHNlbGVjdGlvbi5mb2N1c05vZGUsXG4gICAgICAgICAgICBzZWxlY3Rpb24uZm9jdXNQb3NpdGlvbixcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IGEgY29sbGFwc2VkIHNlbGVjdGlvbiBhdCB0aGUgZ2l2ZW4gbG9jYXRpb24sIHRhcmdldHRpbmcgYSBgcmVmZXJlbmNlYFxuICAgICAqIFZOb2RlIGFuZCBzcGVjaWZ5aW5nIHRoZSBgcG9zaXRpb25gIGluIHJlZmVyZW5jZSB0byB0aGF0IFZOb2RlICgnQkVGT1JFJyxcbiAgICAgKiAnQUZURVInKSwgbGlrZSBpbiBhbiBgeHBhdGhgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBvc2l0aW9uXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqL1xuICAgIHNldEF0KHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXRBbmNob3IocmVmZXJlbmNlLCBwb3NpdGlvbik7XG4gICAgICAgIHRoaXMuY29sbGFwc2UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBzZWxlY3Rpb24gdG8gc2VsZWN0IHRoZSBnaXZlbiBub2Rlcy5cbiAgICAgKiBDb25zaWRlciBgYWJgIChbID0gYHRoaXMuX3N0YXJ0YCwgXSA9IGB0aGlzLl9lbmRgKTpcbiAgICAgKiBgc2VsZWN0KGEpYCA9PiBgW2FdYmBcbiAgICAgKiBgc2VsZWN0KGEsIGIpYCA9PiBgW2FiXWBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSlgID0+IGBbYV1iYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUiwgYiwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpYCA9PiBgYVtdYmBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKWAgPT4gYFthYl1gXG4gICAgICogYHNlbGVjdChhLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKWAgPT4gYGFbYl1gXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYW5jaG9yTm9kZVxuICAgICAqIEBwYXJhbSBbYW5jaG9yUG9zaXRpb25dIGRlZmF1bHQ6IGBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRWBcbiAgICAgKiBAcGFyYW0gW2ZvY3VzTm9kZV0gZGVmYXVsdDogYHN0YXJ0Tm9kZWBcbiAgICAgKiBAcGFyYW0gW2ZvY3VzUG9zaXRpb25dIGRlZmF1bHQ6IGBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSYFxuICAgICAqL1xuICAgIHNlbGVjdChhbmNob3JOb2RlOiBWTm9kZSwgZm9jdXNOb2RlPzogVk5vZGUpOiB2b2lkO1xuICAgIHNlbGVjdChcbiAgICAgICAgYW5jaG9yTm9kZTogVk5vZGUsXG4gICAgICAgIGFuY2hvclBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uLFxuICAgICAgICBmb2N1c05vZGU6IFZOb2RlLFxuICAgICAgICBmb2N1c1Bvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uLFxuICAgICk6IHZvaWQ7XG4gICAgc2VsZWN0KFxuICAgICAgICBhbmNob3JOb2RlOiBWTm9kZSxcbiAgICAgICAgYW5jaG9yUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24gfCBWTm9kZSA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFLFxuICAgICAgICBmb2N1c05vZGU6IFZOb2RlID0gYW5jaG9yTm9kZSxcbiAgICAgICAgZm9jdXNQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVIsXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmIChhbmNob3JQb3NpdGlvbiBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgZm9jdXNOb2RlID0gYW5jaG9yUG9zaXRpb247XG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmb2N1c1Bvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzKGZvY3VzTm9kZSwgZm9jdXNQb3NpdGlvbik7XG4gICAgICAgICAgICB0aGlzLnNldEFuY2hvcihhbmNob3JOb2RlLCBhbmNob3JQb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldEFuY2hvcihhbmNob3JOb2RlLCBhbmNob3JQb3NpdGlvbik7XG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzKGZvY3VzTm9kZSwgZm9jdXNQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBhbmNob3Igb2YgdGhlIHNlbGVjdGlvbiBieSB0YXJnZXR0aW5nIGEgYHJlZmVyZW5jZWAgVk5vZGUgYW5kXG4gICAgICogc3BlY2lmeWluZyB0aGUgYHBvc2l0aW9uYCBpbiByZWZlcmVuY2UgdG8gdGhhdCBWTm9kZSAoJ0JFRk9SRScsICdBRlRFUicpLFxuICAgICAqIGxpa2UgaW4gYW4gYHhwYXRoYC4gSWYgbm8gcmVsYXRpdmUgcG9zaXRpb24gaWYgZ2l2ZW4sIGluY2x1ZGUgdGhlXG4gICAgICogcmVmZXJlbmNlIG5vZGUgaW4gdGhlIHNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKiBAcGFyYW0gW3Bvc2l0aW9uXVxuICAgICAqL1xuICAgIHNldEFuY2hvcihyZWZlcmVuY2U6IFZOb2RlLCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkZPUldBUkQpIHtcbiAgICAgICAgICAgIHRoaXMucmFuZ2Uuc2V0U3RhcnQocmVmZXJlbmNlLCBwb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJhbmdlLnNldEVuZChyZWZlcmVuY2UsIHBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGZvY3VzIG9mIHRoZSBzZWxlY3Rpb24gYnkgdGFyZ2V0dGluZyBhIGByZWZlcmVuY2VgIFZOb2RlIGFuZFxuICAgICAqIHNwZWNpZnlpbmcgdGhlIGBwb3NpdGlvbmAgaW4gcmVmZXJlbmNlIHRvIHRoYXQgVk5vZGUgKCdCRUZPUkUnLCAnQUZURVInKSxcbiAgICAgKiBsaWtlIGluIGFuIGB4cGF0aGAuIElmIG5vIHJlbGF0aXZlIHBvc2l0aW9uIGlmIGdpdmVuLCBpbmNsdWRlIHRoZVxuICAgICAqIHJlZmVyZW5jZSBub2RlIGluIHRoZSBzZWxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICogQHBhcmFtIFtwb3NpdGlvbl1cbiAgICAgKi9cbiAgICBzZXRGb2N1cyhyZWZlcmVuY2U6IFZOb2RlLCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVIpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRk9SV0FSRCkge1xuICAgICAgICAgICAgdGhpcy5yYW5nZS5zZXRFbmQocmVmZXJlbmNlLCBwb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJhbmdlLnNldFN0YXJ0KHJlZmVyZW5jZSwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGUgc2VsZWN0aW9uIGZyb20gaXRzIGFuY2hvciB0byB0aGUgZ2l2ZW4gbG9jYXRpb24sIHRhcmdldHRpbmcgYVxuICAgICAqIGByZWZlcmVuY2VgIFZOb2RlIGFuZCBzcGVjaWZ5aW5nIHRoZSBgZGlyZWN0aW9uYCBvZiB0aGUgZXh0ZW5zaW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqIEBwYXJhbSBbZGlyZWN0aW9uXSBkZWZhdWx0OiBEaXJlY3Rpb24uRk9SV0FSRFxuICAgICAqL1xuICAgIGV4dGVuZFRvKHJlZmVyZW5jZTogVk5vZGUsIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5GT1JXQVJEKTogdm9pZCB7XG4gICAgICAgIGxldCBwb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbjtcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkZPUldBUkQpIHtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2UuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5uZXh0KCk7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLmZpcnN0TGVhZigpO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5wcmV2aW91cygpO1xuICAgICAgICAgICAgaWYgKHJlZmVyZW5jZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLmZpcnN0TGVhZigpO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmVmZXJlbmNlKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzKHJlZmVyZW5jZSwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbGxhcHNlIHRoZSBzZWxlY3Rpb24gb24gaXRzIGFuY2hvci5cbiAgICAgKlxuICAgICAqL1xuICAgIGNvbGxhcHNlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJhbmdlLmNvbGxhcHNlKHRoaXMuYW5jaG9yKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgSldFZGl0b3IsIHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5cbmV4cG9ydCBlbnVtIEFsaWduVHlwZSB7XG4gICAgTEVGVCA9ICdsZWZ0JyxcbiAgICBDRU5URVIgPSAnY2VudGVyJyxcbiAgICBSSUdIVCA9ICdyaWdodCcsXG4gICAgSlVTVElGWSA9ICdqdXN0aWZ5Jyxcbn1cbmV4cG9ydCB0eXBlIEFsaWduUGFyYW1zID0gQ29tbWFuZFBhcmFtcyAmIHtcbiAgICB0eXBlOiBBbGlnblR5cGU7XG59O1xuXG5leHBvcnQgY2xhc3MgQWxpZ248VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbXTtcbiAgICBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBhbGlnbjoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hbGlnbi5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgbG9hZGFibGVzOiBMb2FkYWJsZXM8S2V5bWFwICYgTGF5b3V0PiA9IHtcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0N0cmwrU2hpZnQrTCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5MRUZUIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDdHJsK1NoaWZ0K0UnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FsaWduJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyB0eXBlOiBBbGlnblR5cGUuQ0VOVEVSIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDdHJsK1NoaWZ0K1InLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FsaWduJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyB0eXBlOiBBbGlnblR5cGUuUklHSFQgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0N0cmwrU2hpZnQrSicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5KVVNUSUZZIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdBbGlnbkxlZnRCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFthbGlnbkJ1dHRvbihBbGlnblR5cGUuTEVGVCldO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnQWxpZ25DZW50ZXJCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFthbGlnbkJ1dHRvbihBbGlnblR5cGUuQ0VOVEVSKV07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdBbGlnblJpZ2h0QnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYWxpZ25CdXR0b24oQWxpZ25UeXBlLlJJR0hUKV07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdBbGlnbkp1c3RpZnlCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFthbGlnbkJ1dHRvbihBbGlnblR5cGUuSlVTVElGWSldO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1xuICAgICAgICAgICAgWydBbGlnbkxlZnRCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICAgICAgWydBbGlnbkNlbnRlckJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ0FsaWduUmlnaHRCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICAgICAgWydBbGlnbkp1c3RpZnlCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICBdLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaGFzIHRoZSBnaXZlbiBhbGlnbm1lbnQgc3R5bGUuIElmIG5vIHR5cGVcbiAgICAgKiBpcyBwYXNzZWQsIHJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGhhcyBhbiBhbGlnbm1lbnQgc3R5bGUgYXQgYWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gW3R5cGVdXG4gICAgICovXG4gICAgc3RhdGljIGlzQWxpZ25lZChub2RlOiBWTm9kZSwgdHlwZT86IEFsaWduVHlwZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhbGlnbiA9IG5vZGUubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLmdldCgndGV4dC1hbGlnbicpO1xuICAgICAgICByZXR1cm4gdHlwZSA/IGFsaWduPy5pbmNsdWRlcyh0eXBlKSA6ICEhYWxpZ247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFsaWduIHRleHQuXG4gICAgICovXG4gICAgYWxpZ24ocGFyYW1zOiBBbGlnblBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBub2RlcyA9IHJhbmdlLnRhcmdldGVkTm9kZXMoKTtcbiAgICAgICAgY29uc3QgdHlwZSA9IHBhcmFtcy50eXBlO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMuZmlsdGVyKG5vZGUgPT4gIW5vZGVzLmluY2x1ZGVzKG5vZGUucGFyZW50KSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGFsaWduZWRBbmNlc3RvciA9IG5vZGUuY2xvc2VzdChBbGlnbi5pc0FsaWduZWQpO1xuXG4gICAgICAgICAgICAvLyBDb21wdXRlIGN1cnJlbnQgYWxpZ25tZW50LlxuICAgICAgICAgICAgY29uc3QgY3VycmVudEFsaWdubWVudCA9IGFsaWduZWRBbmNlc3Rvcj8ubW9kaWZpZXJzXG4gICAgICAgICAgICAgICAgPy5maW5kKEF0dHJpYnV0ZXMpXG4gICAgICAgICAgICAgICAgPy5zdHlsZS5nZXQoJ3RleHQtYWxpZ24nKTtcblxuICAgICAgICAgICAgaWYgKCFhbGlnbmVkQW5jZXN0b3IgfHwgY3VycmVudEFsaWdubWVudCAhPT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zdHlsZS5zZXQoJ3RleHQtYWxpZ24nLCB0eXBlLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhbGlnbkJ1dHRvbih0eXBlOiBBbGlnblR5cGUpOiBBY3Rpb25hYmxlTm9kZSB7XG4gICAgZnVuY3Rpb24gaXNBbGlnbmVkKG5vZGU6IFZOb2RlLCB0eXBlOiBBbGlnblR5cGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgYWxpZ25lZEFuY2VzdG9yID0gbm9kZS5jbG9zZXN0KEFsaWduLmlzQWxpZ25lZCk7XG4gICAgICAgIHJldHVybiBBbGlnbi5pc0FsaWduZWQoYWxpZ25lZEFuY2VzdG9yIHx8IG5vZGUsIHR5cGUpO1xuICAgIH1cblxuICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgIG5hbWU6ICdhbGlnbicgKyB0eXBlLFxuICAgICAgICBsYWJlbDogJ0FsaWduICcgKyB0eXBlLFxuICAgICAgICBjb21tYW5kSWQ6ICdhbGlnbicsXG4gICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IHR5cGUgfSBhcyBBbGlnblBhcmFtcyxcbiAgICAgICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IGVkaXRvci5zZWxlY3Rpb24ucmFuZ2U7XG4gICAgICAgICAgICBjb25zdCBhbmNlc3RvciA9IHJhbmdlLnN0YXJ0LmNsb3Nlc3QoQ29udGFpbmVyTm9kZSk7XG4gICAgICAgICAgICBjb25zdCBzdGFydElzQWxpZ25lZCA9IGFuY2VzdG9yICYmIGlzQWxpZ25lZChhbmNlc3RvciwgdHlwZSk7XG4gICAgICAgICAgICBpZiAoIXN0YXJ0SXNBbGlnbmVkIHx8IHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnRJc0FsaWduZWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yID0gcmFuZ2UuZW5kLmNsb3Nlc3QoQ29udGFpbmVyTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuY2VzdG9yICYmIGlzQWxpZ25lZChhbmNlc3RvciwgdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSk7XG4gICAgYnV0dG9uLm1vZGlmaWVycy5hcHBlbmQoXG4gICAgICAgIG5ldyBBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgIGNsYXNzOiAnZmEgZmEtYWxpZ24tJyArIHR5cGUgKyAnIGZhLWZ3JyxcbiAgICAgICAgfSksXG4gICAgKTtcbiAgICByZXR1cm4gYnV0dG9uO1xufVxuIiwiaW1wb3J0IHsgQ29sb3IsIENvbG9yQ29uZmlnIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWNvbG9yL3NyYy9Db2xvcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuXG5leHBvcnQgY2xhc3MgQmFja2dyb3VuZENvbG9yPFQgZXh0ZW5kcyBDb2xvckNvbmZpZyA9IENvbG9yQ29uZmlnPiBleHRlbmRzIENvbG9yPFQ+IHtcbiAgICBzdHlsZU5hbWUgPSAnYmFja2dyb3VuZC1jb2xvcic7XG4gICAgY29uZmlndXJhdGlvbiA9IHsgZGVmYXVsdENvbG9yOiAnd2hpdGUnLCAuLi50aGlzLmNvbmZpZ3VyYXRpb24gfTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgY29sb3JCYWNrZ3JvdW5kOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmNvbG9yLFxuICAgICAgICB9LFxuICAgICAgICB1bmNvbG9yQmFja2dyb3VuZDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy51bmNvbG9yLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8S2V5bWFwPiA9IHtcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrSCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnY29sb3JCYWNrZ3JvdW5kJyxcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiB1c2UgZGlhbG9nIHRvIGdldCBwYXJhbXNcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczoge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3llbGxvdycsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrSCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAndW5jb2xvckJhY2tncm91bmQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQmxvY2txdW90ZVhtbERvbVBhcnNlciB9IGZyb20gJy4vQmxvY2txdW90ZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuXG5leHBvcnQgY2xhc3MgQmxvY2txdW90ZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0Jsb2NrcXVvdGVYbWxEb21QYXJzZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCBjbGFzcyBCbG9ja3F1b3RlTm9kZSBleHRlbmRzIFZFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoeyBodG1sVGFnOiAnQkxPQ0tRVU9URScgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBCbG9ja3F1b3RlTm9kZSB9IGZyb20gJy4vQmxvY2txdW90ZU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgQmxvY2txdW90ZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ0JMT0NLUVVPVEUnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxCbG9ja3F1b3RlTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGJsb2NrcXVvdGUgPSBuZXcgQmxvY2txdW90ZU5vZGUoKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBibG9ja3F1b3RlLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBibG9ja3F1b3RlLmFwcGVuZCguLi5ub2Rlcyk7XG4gICAgICAgIHJldHVybiBbYmxvY2txdW90ZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQm9sZEZvcm1hdCB9IGZyb20gJy4vQm9sZEZvcm1hdCc7XG5pbXBvcnQgeyBGb3JtYXRQYXJhbXMsIElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBCb2xkWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9Cb2xkWG1sRG9tUGFyc2VyJztcbmltcG9ydCBKV0VkaXRvciwgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcblxuZXhwb3J0IGNsYXNzIEJvbGQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBLZXltYXAgJiBMYXlvdXQ+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbQm9sZFhtbERvbVBhcnNlcl0sXG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK0InLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgRm9ybWF0Q2xhc3M6IEJvbGRGb3JtYXQgfSBhcyBGb3JtYXRQYXJhbXMsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdCb2xkQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYm9sZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1RvZ2dsZSBib2xkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyBGb3JtYXRDbGFzczogQm9sZEZvcm1hdCB9IGFzIEZvcm1hdFBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwbHVnaW5JbmxpbmUgPSBlZGl0b3IucGx1Z2lucy5nZXQoSW5saW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhcGx1Z2luSW5saW5lLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpPy5maW5kKEJvbGRGb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0SXNGb3JtYXRlZCA9ICEhcmFuZ2Uuc3RhcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXh0U2libGluZyhJbmxpbmVOb2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tb2RpZmllcnMuZmluZChCb2xkRm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydElzRm9ybWF0ZWQgfHwgcmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0SXNGb3JtYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXJhbmdlLmVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wcmV2aW91c1NpYmxpbmcoSW5saW5lTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Lm1vZGlmaWVycy5maW5kKEJvbGRGb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1ib2xkIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydCb2xkQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXV0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBCb2xkRm9ybWF0IGV4dGVuZHMgRm9ybWF0IHtcbiAgICBjb25zdHJ1Y3RvcihodG1sVGFnOiAnQicgfCAnU1RST05HJyA9ICdCJykge1xuICAgICAgICBzdXBlcihodG1sVGFnKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRYbWxEb21QYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQm9sZEZvcm1hdCB9IGZyb20gJy4vQm9sZEZvcm1hdCc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBCb2xkWG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0WG1sRG9tUGFyc2VyIHtcbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgKG5vZGVOYW1lKGl0ZW0pID09PSAnQicgfHwgbm9kZU5hbWUoaXRlbSkgPT09ICdTVFJPTkcnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBib2xkIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgYm9sZCA9IG5ldyBCb2xkRm9ybWF0KG5vZGVOYW1lKGl0ZW0pIGFzICdCJyB8ICdTVFJPTkcnKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBib2xkLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGJvbGQsIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IEJ1dHRvblhtbERvbVBhcnNlciB9IGZyb20gJy4vQnV0dG9uWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBCdXR0b248VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbQnV0dG9uWG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRm9ybWF0JztcbmltcG9ydCB7IFZlcnNpb25hYmxlT2JqZWN0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlT2JqZWN0JztcbmltcG9ydCB7IE1vZGlmaWVyUHJlc2VydmUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcic7XG5cbmV4cG9ydCBjbGFzcyBCdXR0b25Gb3JtYXQgZXh0ZW5kcyBGb3JtYXQge1xuICAgIHByZXNlcnZlID0gbmV3IFZlcnNpb25hYmxlT2JqZWN0KHtcbiAgICAgICAgYWZ0ZXI6IHRydWUsXG4gICAgICAgIHBhcmFncmFwaEJyZWFrOiBmYWxzZSxcbiAgICAgICAgbGluZUJyZWFrOiBmYWxzZSxcbiAgICB9KSBhcyBNb2RpZmllclByZXNlcnZlO1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignQlVUVE9OJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRm9ybWF0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEJ1dHRvbkZvcm1hdCB9IGZyb20gJy4vQnV0dG9uRm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEJ1dHRvblhtbERvbVBhcnNlciBleHRlbmRzIEZvcm1hdFhtbERvbVBhcnNlciB7XG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnQlVUVE9OJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBib2xkIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgYm9sZCA9IG5ldyBCdXR0b25Gb3JtYXQoKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBib2xkLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGJvbGQsIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuL0NoYXJOb2RlJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBDaGFyRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0NoYXJEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBDaGFyWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9DaGFyWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IE1vZGlmaWVycyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGlmaWVycyc7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IExpbmVCcmVha05vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWtOb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBJbnNlcnRUZXh0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIHNlbGVjdD86IGJvb2xlYW47XG4gICAgZm9ybWF0cz86IE1vZGlmaWVycztcbn1cblxuZXhwb3J0IGNsYXNzIENoYXI8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtDaGFyWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbQ2hhckRvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBpbnNlcnRUZXh0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluc2VydFRleHQsXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgdGV4dCBhdCB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogSWYgdGhlIHNlbGVjdGlvbiBpcyBjb2xsYXBzZWQsIGFkZCBgdGV4dGAgdG8gdGhlIHZEb2N1bWVudCBhbmQgY29weSB0aGVcbiAgICAgKiBmb3JtYXRpbmcgb2YgdGhlIHByZXZpb3VzIGNoYXIgb3IgdGhlIG5leHQgY2hhci5cbiAgICAgKlxuICAgICAqIElmIHRoZSBzZWxlY3Rpb24gaXMgbm90IGNvbGxhcHNlZCwgcmVwbGFjZSB0aGUgdGV4dCB3aXRoIHRoZSBmb3JtYXRpbmdcbiAgICAgKiB0aGF0IHdhcyBwcmVzZW50IGluIHRoZSBzZWxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgaW5zZXJ0VGV4dChwYXJhbXM6IEluc2VydFRleHRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgdGV4dCA9IHBhcmFtcy50ZXh0O1xuICAgICAgICBjb25zdCBpbmxpbmUgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChJbmxpbmUpO1xuICAgICAgICBsZXQgbW9kaWZpZXJzID0gaW5saW5lLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpO1xuICAgICAgICAvLyBPbnkgcHJlc2VydmVkIG1vZGlmaWVycyBhcmUgYXBwbGllZCBhdCB0aGUgc3RhcnQgb2YgYSBjb250YWluZXIuXG4gICAgICAgIGlmIChtb2RpZmllcnMgJiYgcmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgY29uc3QgcHJldmlvdXNTaWJsaW5nID0gcmFuZ2Uuc3RhcnQucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBpc0FmdGVyTGluZUJyZWFrID0gcHJldmlvdXNTaWJsaW5nIGluc3RhbmNlb2YgTGluZUJyZWFrTm9kZTtcbiAgICAgICAgICAgIGNvbnN0IHByZXNlcnZlZE1vZGlmaWVycyA9IG1vZGlmaWVycy5maWx0ZXIobW9kID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaXNBZnRlckxpbmVCcmVhaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kLnByZXNlcnZlLmxpbmVCcmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kLnByZXNlcnZlLmFmdGVyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2QucHJlc2VydmUucGFyYWdyYXBoQnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocHJlc2VydmVkTW9kaWZpZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVycyA9IG5ldyBNb2RpZmllcnMoLi4ucHJlc2VydmVkTW9kaWZpZXJzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVycyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtcy5mb3JtYXRzKSB7XG4gICAgICAgICAgICBpZiAoIW1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVycyA9IG5ldyBNb2RpZmllcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vZGlmaWVycy5zZXQoLi4ucGFyYW1zLmZvcm1hdHMubWFwKGZvcm1hdCA9PiBmb3JtYXQuY2xvbmUoKSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0eWxlID0gaW5saW5lLmdldEN1cnJlbnRTdHlsZShyYW5nZSk7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgY29udGVudHMgb2YgdGhlIHJhbmdlIGlmIG5lZWRlZC5cbiAgICAgICAgaWYgKCFyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNwbGl0IHRoZSB0ZXh0IGludG8gQ0hBUiBub2RlcyBhbmQgaW5zZXJ0IHRoZW0gYXQgdGhlIHJhbmdlLlxuICAgICAgICBjb25zdCBjaGFyYWN0ZXJzID0gdGV4dC5zcGxpdCgnJyk7XG4gICAgICAgIGNvbnN0IGNoYXJOb2RlcyA9IGNoYXJhY3RlcnMubWFwKGNoYXIgPT4ge1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hhck5vZGUoeyBjaGFyOiBjaGFyLCBtb2RpZmllcnM6IG1vZGlmaWVycy5jbG9uZSgpIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENoYXJOb2RlKHsgY2hhcjogY2hhciB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNoYXJOb2Rlcy5mb3JFYWNoKGNoYXJOb2RlID0+IHtcbiAgICAgICAgICAgIGlmIChzdHlsZT8ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2hhck5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zdHlsZSA9IHN0eWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmFuZ2Uuc3RhcnQuYmVmb3JlKGNoYXJOb2RlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChwYXJhbXMuc2VsZWN0ICYmIGNoYXJOb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5zZWxlY3QoY2hhck5vZGVzWzBdLCBjaGFyTm9kZXNbY2hhck5vZGVzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi9DaGFyTm9kZSc7XG5pbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgQ2hhckRvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGU6IFByZWRpY2F0ZSA9IENoYXJOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKGNoYXJOb2RlOiBDaGFyTm9kZSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0Pik6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJUZXh0KFtjaGFyTm9kZV0sIHdvcmtlcik7XG4gICAgfVxuICAgIGFzeW5jIHJlbmRlckJhdGNoKFxuICAgICAgICBjaGFyTm9kZXM6IENoYXJOb2RlW10sXG4gICAgICAgIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPERvbU9iamVjdD4sXG4gICAgKTogUHJvbWlzZTxEb21PYmplY3RbXT4ge1xuICAgICAgICBjb25zdCBkb21PYmplY3RzOiBEb21PYmplY3RbXSA9IFtdO1xuICAgICAgICBjb25zdCBkb21PYmplY3QgPSB0aGlzLl9yZW5kZXJUZXh0KGNoYXJOb2Rlcywgd29ya2VyKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFyTm9kZXMubGVuZ3RoOyBpKyspIGRvbU9iamVjdHMucHVzaChkb21PYmplY3QpO1xuICAgICAgICByZXR1cm4gZG9tT2JqZWN0cztcbiAgICB9XG4gICAgcHJpdmF0ZSBfcmVuZGVyVGV4dChcbiAgICAgICAgY2hhck5vZGVzOiBDaGFyTm9kZVtdLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+LFxuICAgICk6IERvbU9iamVjdCB7XG4gICAgICAgIC8vIENyZWF0ZSB0ZXh0T2JqZWN0LlxuICAgICAgICBjb25zdCB0ZXh0cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNoYXJOb2RlIG9mIGNoYXJOb2Rlcykge1xuICAgICAgICAgICAgLy8gU2FtZSB0ZXh0IG5vZGUuXG4gICAgICAgICAgICBpZiAoY2hhck5vZGUuY2hhciA9PT0gJyAnICYmIHRleHRzW3RleHRzLmxlbmd0aCAtIDFdID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICAvLyBCcm93c2VycyBkb24ndCByZW5kZXIgY29uc2VjdXRpdmUgc3BhY2UgY2hhcnMgb3RoZXJ3aXNlLlxuICAgICAgICAgICAgICAgIHRleHRzLnB1c2goJ1xcdTAwQTAnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGV4dHMucHVzaChjaGFyTm9kZS5jaGFyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBSZW5kZXIgYmxvY2sgZWRnZSBzcGFjZXMgYXMgbm9uLWJyZWFrYWJsZSBzcGFjZSAob3RoZXJ3aXNlIGJyb3dzZXJzXG4gICAgICAgIC8vIHdvbid0IHJlbmRlciB0aGVtKS5cbiAgICAgICAgY29uc3QgcHJldmlvdXMgPSBjaGFyTm9kZXNbMF0ucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIGlmICghcHJldmlvdXMgfHwgIShwcmV2aW91cyBpbnN0YW5jZW9mIElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICB0ZXh0c1swXSA9IHRleHRzWzBdLnJlcGxhY2UoL14gL2csICdcXHUwMEEwJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV4dCA9IGNoYXJOb2Rlc1tjaGFyTm9kZXMubGVuZ3RoIC0gMV0ubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgaWYgKCFuZXh0IHx8ICEobmV4dCBpbnN0YW5jZW9mIElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICB0ZXh0c1t0ZXh0cy5sZW5ndGggLSAxXSA9IHRleHRzW3RleHRzLmxlbmd0aCAtIDFdLnJlcGxhY2UoL14gL2csICdcXHUwMEEwJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdGV4dE9iamVjdCA9IHsgdGV4dDogdGV4dHMuam9pbignJykgfTtcbiAgICAgICAgd29ya2VyLmxvY2F0ZShjaGFyTm9kZXMsIHRleHRPYmplY3QpO1xuICAgICAgICByZXR1cm4gdGV4dE9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGVQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBDaGFyTm9kZVBhcmFtcyBleHRlbmRzIEFic3RyYWN0Tm9kZVBhcmFtcyB7XG4gICAgY2hhcjogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQ2hhck5vZGUgZXh0ZW5kcyBJbmxpbmVOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbiAgICByZWFkb25seSBjaGFyOiBzdHJpbmc7XG4gICAgY29uc3RydWN0b3IocGFyYW1zOiBDaGFyTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICBpZiAocGFyYW1zLmNoYXIubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgJ0Nhbm5vdCBtYWtlIGEgQ2hhck5vZGUgb3V0IG9mIGFueXRoaW5nIGVsc2UgdGhhbiBhIHN0cmluZyBvZiBsZW5ndGggMS4nLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoYXIgPSBwYXJhbXMuY2hhcjtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IFZOb2RlIHdpdGggdGhlIHNhbWUgdHlwZSBhbmQgYXR0cmlidXRlcyBhcyB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUocGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgQ2hhck5vZGU+WzBdID0ge1xuICAgICAgICAgICAgY2hhcjogdGhpcy5jaGFyLFxuICAgICAgICAgICAgbW9kaWZpZXJzOiB0aGlzLm1vZGlmaWVycy5jbG9uZSgpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgdGV4dCBjb250ZW50IG9mIHRoaXMgbm9kZS5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGdldCB0ZXh0Q29udGVudCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBgYWAgaGFzIHRoZSBzYW1lIGZvcm1hdCBwcm9wZXJ0aWVzIGFzIGBiYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhXG4gICAgICogQHBhcmFtIGJcbiAgICAgKi9cbiAgICBpc1NhbWVUZXh0Tm9kZShub2RlOiBWTm9kZSk6IG5vZGUgaXMgQ2hhck5vZGUge1xuICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIENoYXJOb2RlKSB7XG4gICAgICAgICAgICAvLyBDaGFyIFZOb2RlcyBhcmUgdGhlIHNhbWUgdGV4dCBub2RlIGlmIHRoZXkgaGF2ZSB0aGUgc2FtZVxuICAgICAgICAgICAgLy8gbW9kaWZpZXJzLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzLmFyZVNhbWVBcyhub2RlLm1vZGlmaWVycyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBOb2RlcyB0aGF0IGFyZSBub3QgdmFsaWQgaW4gYSB0ZXh0IG5vZGUgbXVzdCBlbmQgdGhlIHRleHQgbm9kZS5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IHJlbW92ZUZvcm1hdHRpbmdTcGFjZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9mb3JtYXR0aW5nU3BhY2UnO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuL0NoYXJOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuXG5leHBvcnQgY2xhc3MgQ2hhclhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERTtcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogTm9kZSk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBjb25zdCB0ZXh0ID0gcmVtb3ZlRm9ybWF0dGluZ1NwYWNlKGl0ZW0pO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSB0ZXh0LmNoYXJBdChpKTtcbiAgICAgICAgICAgIGxldCBwYXJzZWRWTm9kZTogVk5vZGU7XG4gICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xcbicpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWRWTm9kZSA9IG5ldyB0aGlzLmVuZ2luZS5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5TZXBhcmF0b3IoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkVk5vZGUgPSBuZXcgQ2hhck5vZGUoeyBjaGFyOiBjaGFyIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZXMucHVzaChwYXJzZWRWTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luQ29uZmlnLCBKV1BsdWdpbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVOb2RlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBDb2RlVmlld05vZGUgfSBmcm9tICcuL0NvZGVWaWV3Tm9kZSc7XG5pbXBvcnQgeyBDb2RlVmlld0RvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9Db2RlVmlld0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IHBhcnNlRWRpdGFibGUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvY29uZmlndXJhdGlvbic7XG5pbXBvcnQgeyBEb21MYXlvdXRFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IGlzQmxvY2sgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvaXNCbG9jayc7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5cbmV4cG9ydCBjbGFzcyBDb2RlPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBjb2RlVmlldyA9IG5ldyBDb2RlVmlld05vZGUoKTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxSZW5kZXJlciAmIExheW91dD4gPSB7XG4gICAgICAgIHJlbmRlcmVyczogW0NvZGVWaWV3RG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdDb2RlQnV0dG9uJyxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGFzeW5jICgpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjb2RlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVG9nZ2xlIENvZGUgdmlldycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0b2dnbGVDb2RlVmlldycsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKCk6IGJvb2xlYW4gPT4gdGhpcy5hY3RpdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmFzIGZhLWNvZGUgZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ2NvZGUnLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogYXN5bmMgKCk6IFByb21pc2U8Vk5vZGVbXT4gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3RoaXMuY29kZVZpZXddO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1snQ29kZUJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV1dLFxuICAgIH07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIHRvZ2dsZUNvZGVWaWV3OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnRvZ2dsZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgYWN0aXZlID0gZmFsc2U7XG4gICAgYXN5bmMgc3RhcnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHN1cGVyLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGFzeW5jIHRvZ2dsZShwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWFjdGl2YXRlKHBhcmFtcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmF0ZShwYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGFjdGl2YXRlKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dEVuZ2luZSA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICBjb25zdCBlZGl0YWJsZSA9IGRvbUxheW91dEVuZ2luZS5jb21wb25lbnRzLmVkaXRhYmxlWzBdO1xuXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgdmlldydzIGNvbnRlbnRzLlxuICAgICAgICBjb25zdCBkb21FZGl0YWJsZSA9IGRvbUxheW91dEVuZ2luZS5nZXREb21Ob2RlcyhlZGl0YWJsZSlbMF0gYXMgRWxlbWVudDtcbiAgICAgICAgdGhpcy5jb2RlVmlldy52YWx1ZSA9IHRoaXMuX2Zvcm1hdEVsZW1lbnRIdG1sKGRvbUVkaXRhYmxlKS5pbm5lckhUTUwudHJpbSgpIHx8ICcnO1xuXG4gICAgICAgIC8vIFNob3cgdGhlIGNvZGUgdmlldyBhbmQgaGlkZSB0aGUgZWRpdGFibGUuXG4gICAgICAgIGF3YWl0IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuYXBwZW5kKCdjb2RlJywgJ21haW4nKTtcbiAgICAgICAgYXdhaXQgcGFyYW1zLmNvbnRleHQuZXhlY0NvbW1hbmQoJ2hpZGUnLCB7IGNvbXBvbmVudElkOiAnZWRpdGFibGUnIH0pO1xuICAgIH1cbiAgICBhc3luYyBkZWFjdGl2YXRlKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBjb25zdCBkb21MYXlvdXRFbmdpbmUgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChMYXlvdXQpLmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgY29uc3QgZWRpdGFibGUgPSBkb21MYXlvdXRFbmdpbmUuY29tcG9uZW50cy5lZGl0YWJsZVswXTtcblxuICAgICAgICAvLyBQYXJzZSB0aGUgY29kZSB2aWV3IGludG8gdGhlIGVkaXRhYmxlLlxuICAgICAgICBjb25zdCBjb2RlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvZGVDb250YWluZXIuaW5uZXJIVE1MID0gKGRvbUxheW91dEVuZ2luZS5nZXREb21Ob2RlcyhcbiAgICAgICAgICAgIHRoaXMuY29kZVZpZXcsXG4gICAgICAgIClbMF0gYXMgSFRNTFRleHRBcmVhRWxlbWVudCkudmFsdWU7XG4gICAgICAgIGNvbnN0IG5ld0VkaXRhYmxlID0gYXdhaXQgcGFyc2VFZGl0YWJsZSh0aGlzLmVkaXRvciwgY29kZUNvbnRhaW5lcik7XG4gICAgICAgIGVkaXRhYmxlLmVtcHR5KCk7XG4gICAgICAgIGVkaXRhYmxlLmFwcGVuZCguLi5uZXdFZGl0YWJsZVswXS5jaGlsZHJlbigpKTtcblxuICAgICAgICAvLyBTaG93IHRoZSBlZGl0YWJsZSBhbmQgaGlkZSB0aGUgY29kZSB2aWV3LlxuICAgICAgICBhd2FpdCBwYXJhbXMuY29udGV4dC5leGVjQ29tbWFuZCgnc2hvdycsIHsgY29tcG9uZW50SWQ6ICdlZGl0YWJsZScgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkucmVtb3ZlKCdjb2RlJywgJ21haW4nKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBhbiBlbGVtZW50J3MgaW5uZXIgSFRNTCBieSByZWN1cnNpdmVseSBhZGRpbmcgaW5uZXIgaW5kZW50YXRpb25cbiAgICAgKiB3aGVyZSBpdCBpcyByZWxldmFudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICogQHBhcmFtIFtfbGV2ZWxdXG4gICAgICovXG4gICAgcHJpdmF0ZSBfZm9ybWF0RWxlbWVudEh0bWwoZWxlbWVudDogRWxlbWVudCwgX2xldmVsID0gMCk6IEVsZW1lbnQge1xuICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSkgYXMgRWxlbWVudDtcbiAgICAgICAgY29uc3QgaW5kZW50QmVmb3JlID0gbmV3IEFycmF5KF9sZXZlbCArIDEpLmpvaW4oJyAgICAnKTtcbiAgICAgICAgY29uc3QgaW5kZW50QWZ0ZXIgPSBuZXcgQXJyYXkoX2xldmVsKS5qb2luKCcgICAgJyk7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZWxlbWVudC5jaGlsZHJlbikge1xuICAgICAgICAgICAgY29uc3QgaXNDaGlsZEJsb2NrID0gaXNCbG9jayhjaGlsZCk7XG4gICAgICAgICAgICBpZiAoaXNDaGlsZEJsb2NrKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1xcbicgKyBpbmRlbnRCZWZvcmUpLCBjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9mb3JtYXRFbGVtZW50SHRtbChjaGlsZCwgX2xldmVsICsgMSk7XG4gICAgICAgICAgICBpZiAoaXNDaGlsZEJsb2NrICYmIGVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCA9PT0gY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdcXG4nICsgaW5kZW50QWZ0ZXIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBDb2RlVmlld05vZGUgfSBmcm9tICcuL0NvZGVWaWV3Tm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgQ29kZVZpZXdEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gQ29kZVZpZXdOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKGNvZGVWaWV3OiBDb2RlVmlld05vZGUpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBkb21Db2RlVmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RFWFRBUkVBJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgZG9tQ29kZVZpZXcudmFsdWUgPSBjb2RlVmlldy52YWx1ZTtcbiAgICAgICAgZG9tQ29kZVZpZXcuc2V0QXR0cmlidXRlKFxuICAgICAgICAgICAgJ3N0eWxlJyxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAnd2lkdGg6IDEwMCUnLFxuICAgICAgICAgICAgICAgICdoZWlnaHQ6IDEwMCUnLFxuICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaycsXG4gICAgICAgICAgICAgICAgJ2NvbG9yOiB3aGl0ZScsXG4gICAgICAgICAgICAgICAgJ3BhZGRpbmc6IDVweCcsXG4gICAgICAgICAgICAgICAgJ2ZvbnQtZmFtaWx5OiBcIkNvdXJpZXIgTmV3XCIsIENvdXJpZXIsIFwiTHVjaWRhIFNhbnMgVHlwZXdyaXRlclwiLCBcIkx1Y2lkYSBUeXBld3JpdGVyXCIsIG1vbm9zcGFjZTsnLFxuICAgICAgICAgICAgXS5qb2luKCc7ICcpLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4geyBkb206IFtkb21Db2RlVmlld10gfTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0F0b21pY05vZGUnO1xuXG5leHBvcnQgY2xhc3MgQ29kZVZpZXdOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgdmFsdWUgPSAnJztcbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBDc3NTdHlsZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0Nzc1N0eWxlJztcblxuZXhwb3J0IGludGVyZmFjZSBDb2xvclBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGNvbG9yPzogc3RyaW5nOyAvLyBjc3MtdmFsaWQgY29sb3IgbmFtZVxufVxuZXhwb3J0IGludGVyZmFjZSBDb2xvckNvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBkZWZhdWx0Q29sb3I/OiBzdHJpbmc7IC8vIGNzcy12YWxpZCBjb2xvciBuYW1lXG59XG5cbmV4cG9ydCBjbGFzcyBDb2xvcjxUIGV4dGVuZHMgQ29sb3JDb25maWcgPSBDb2xvckNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHN0eWxlTmFtZTogc3RyaW5nOyAvLyBjc3MtdmFsaWQgc3R5bGUgcHJvcGVydHkgbmFtZSAoZWc6ICdiYWNrZ3JvdW5kLWNvbG9yJylcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBoYXMgdGhlIGdpdmVuIGNvbG9yLlxuICAgICAqIElmIG5vIGNvbG9yIGlzIHBhc3NlZCwgcmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaGFzIGFueSBjb2xvci5cbiAgICAgKiBSZXR1cm4gZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIGhhc0NvbG9yKG5vZGU6IFZOb2RlKTogYm9vbGVhbjtcbiAgICBoYXNDb2xvcihjb2xvcjogc3RyaW5nLCBub2RlOiBWTm9kZSB8IEZvcm1hdCk6IGJvb2xlYW47XG4gICAgaGFzQ29sb3IoY29sb3I6IHN0cmluZyB8IFZOb2RlLCBub2RlPzogVk5vZGUgfCBGb3JtYXQpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKGNvbG9yIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICBub2RlID0gY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZUNvbG9yID0gbm9kZS5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUuZ2V0KHRoaXMuc3R5bGVOYW1lKTtcbiAgICAgICAgaWYgKGNvbG9yIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gISFub2RlQ29sb3I7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZUNvbG9yID09PSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBseSB0aGUgZ2l2ZW4gY29sb3IgdG8gdGhlIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGNvbG9yKHBhcmFtczogQ29sb3JQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29sb3IgPSBwYXJhbXMuY29sb3I7XG4gICAgICAgIGlmIChwYXJhbXMuY29udGV4dC5yYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAvLyBTZXQgdGhlIHN0eWxlIGNhY2hlLlxuICAgICAgICAgICAgY29uc3QgaW5saW5lID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KElubGluZSk7XG4gICAgICAgICAgICAvLyBDb252ZXJ0IENzc1N0eWxlIGNsYXNzIGludG8gYSB0cnVlIG9iamVjdCBmb3Igc3ByZWFkIG9wZXJhdG9yLlxuICAgICAgICAgICAgY29uc3QgY3VycmVudENhY2hlID0gaW5saW5lLmNhY2hlLnN0eWxlID8gaW5saW5lLmNhY2hlLnN0eWxlLnRvSlNPTigpIDoge307XG4gICAgICAgICAgICBpbmxpbmUuY2FjaGUuc3R5bGUgPSBuZXcgQ3NzU3R5bGUoeyAuLi5jdXJyZW50Q2FjaGUsIFt0aGlzLnN0eWxlTmFtZV06IGNvbG9yIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHNlbGVjdGVkTm9kZXMgPSBwYXJhbXMuY29udGV4dC5yYW5nZS5zZWxlY3RlZE5vZGVzKCk7XG4gICAgICAgICAgICBzZWxlY3RlZE5vZGVzID0gc2VsZWN0ZWROb2Rlcy5maWx0ZXIobm9kZSA9PiAhc2VsZWN0ZWROb2Rlcy5pbmNsdWRlcyhub2RlLnBhcmVudCkpO1xuICAgICAgICAgICAgLy8gQ29sb3IgdGhlIGhpZ2hlc3QgYW5jZXN0b3IuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygc2VsZWN0ZWROb2Rlcykge1xuICAgICAgICAgICAgICAgIC8vIENvbG9yIHRoZSBoaWdoZXN0IGZ1bGx5IHNlbGVjdGVkIGZvcm1hdCBpZiBhbnkuXG4gICAgICAgICAgICAgICAgY29uc3QgZnVsbHlTZWxlY3RlZEZvcm1hdHMgPSB0aGlzLl9uZXdGb3JtYXRzKG5vZGUpLmZpbHRlcihmb3JtYXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGZvcm1hdCBpcyBzdGFydGVkIGJ5IHRoaXMgbm9kZS4gTm93IGZpbmQgb3V0IGlmIHdlXG4gICAgICAgICAgICAgICAgICAgIC8vIGVuZCBpdCB3aXRoaW4gdGhlIHNlbGVjdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTm9kZXMuaW5jbHVkZXModGhpcy5fbGFzdE5vZGVXaXRoRm9ybWF0KG5vZGUsIGZvcm1hdCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChmdWxseVNlbGVjdGVkRm9ybWF0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGlnaGVzdEZ1bGxGb3JtYXQgPSBmdWxseVNlbGVjdGVkRm9ybWF0cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFpcnM6IFtWTm9kZSB8IEZvcm1hdCwgRm9ybWF0XVtdID0gc2VsZWN0ZWROb2Rlcy5tYXAoc2VsZWN0ZWROb2RlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHRoaXMuX2ZpbmRGb3JtYXQoc2VsZWN0ZWROb2RlLCBoaWdoZXN0RnVsbEZvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0aGlzLl9pbmhlcml0c0NvbG9yRnJvbShzZWxlY3RlZE5vZGUsIGNvbG9yKSwgZm9ybWF0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFpciBvZiBwYWlycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhaXI/LlsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbG9yIHRoZSBmb3JtYXRzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWlyWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBub2RlIGluaGVyaXRlZCB0aGUgY29sb3IsIHJlbW92ZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5oZXJpdGVkIGNvbG9yLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDb2xvcihwYWlyWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXBwbHlDb2xvcihwYWlyWzFdLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLl9pbmhlcml0c0NvbG9yRnJvbShub2RlLCBjb2xvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCBpZiB0aGUgbm9kZSBhbHJlYWR5IGhhcyB0aGUgcmlnaHQgY29sb3IsIHRocm91Z2ggYW5cbiAgICAgICAgICAgICAgICAgICAgLy8gYW5jZXN0b3Igb3IgYSBmb3JtYXQuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FwcGx5Q29sb3Iobm9kZSwgY29sb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGN1cnJlbnQgY29sb3IgZnJvbSB0aGUgcmFuZ2UuIElmIHRoZSBjb2xvciB3YXMgYXBwbGllZCB0b1xuICAgICAqIGFuIGFuY2VzdG9yLCBhcHBseSB0aGUgZGVmYXVsdCBjb2xvciB0byBpdHMgcmVsZXZhbnQgaW5saW5lIGRlc2NlbmRhbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHVuY29sb3IocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRDb2xvciA9IHRoaXMuY29uZmlndXJhdGlvbi5kZWZhdWx0Q29sb3I7XG4gICAgICAgIGNvbnN0IGhhc0NvbG9yID0gdGhpcy5oYXNDb2xvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICBjb25zdCBpbmxpbmUgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoSW5saW5lKTtcblxuICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0LmFuY2VzdG9yKGhhc0NvbG9yKSkge1xuICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgY29sb3Igc3R5bGUgY2FjaGUgdG8gdGhlIGRlZmF1bHQgY29sb3IuXG4gICAgICAgICAgICAgICAgaWYgKCFpbmxpbmUuY2FjaGUuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5saW5lLmNhY2hlLnN0eWxlID0gbmV3IENzc1N0eWxlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlubGluZS5jYWNoZS5zdHlsZS5zZXQodGhpcy5zdHlsZU5hbWUsIGRlZmF1bHRDb2xvcik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlubGluZS5jYWNoZS5zdHlsZSkge1xuICAgICAgICAgICAgICAgIC8vIFVuc2V0IHRoZSBjb2xvciBzdHlsZSBjYWNoZS5cbiAgICAgICAgICAgICAgICBpbmxpbmUuY2FjaGUuc3R5bGUucmVtb3ZlKHRoaXMuc3R5bGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMuY29udGV4dC5yYW5nZS5zZWxlY3RlZE5vZGVzKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLl9ub2RlT3JGaXJzdEZvcm1hdChub2RlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Q29sb3IgPSB0YXJnZXQubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLmdldCh0aGlzLnN0eWxlTmFtZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDb2xvciB8fCBjdXJyZW50Q29sb3IgPT09IGRlZmF1bHRDb2xvciB8fCBub2RlLmFuY2VzdG9yKGhhc0NvbG9yKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGNvbG9yIHRvIHRoZSBkZWZhdWx0IGNvbG9yLlxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zdHlsZS5zZXQodGhpcy5zdHlsZU5hbWUsIGRlZmF1bHRDb2xvcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjb2xvci5cbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5zdHlsZS5yZW1vdmUodGhpcy5zdHlsZU5hbWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFVuY29sb3IgdGhlIGNoaWxkcmVuIGFuZCB0aGVpciBmb3JtYXRzIGFzIHdlbGwuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLnJlbW92ZSh0aGlzLnN0eWxlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIElubGluZU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZm9ybWF0IG9mIGNoaWxkLm1vZGlmaWVycy5maWx0ZXIoRm9ybWF0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdC5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUucmVtb3ZlKHRoaXMuc3R5bGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBub2RlJ3MgZmlyc3QgZm9ybWF0IGlmIGFueSwgaXRzZWxmIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX25vZGVPckZpcnN0Rm9ybWF0KG5vZGU6IFZOb2RlKTogVk5vZGUgfCBGb3JtYXQge1xuICAgICAgICByZXR1cm4gbm9kZS5tb2RpZmllcnMuZmlsdGVyKEZvcm1hdClbMF0gfHwgbm9kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgYWxsIHRoZSBjaGlsZHJlbiBvZiB0aGUgZ2l2ZW4gbm9kZSBoYXZlIHRoZSBnaXZlbiBjb2xvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICogQHBhcmFtIGNvbG9yXG4gICAgICovXG4gICAgX2lzQWxsQ29sb3JlZChub2RlOiBWTm9kZSwgY29sb3I6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZS5jaGlsZHJlbigpLmV2ZXJ5KGNoaWxkID0+IHRoaXMuaGFzQ29sb3IoY29sb3IsIGNoaWxkKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZmlyc3QgZm9ybWF0IHRoYXQgbWF0Y2hlcyB0aGUgZ2l2ZW4gZm9ybWF0LCBvbiB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICogQHBhcmFtIGZvcm1hdFxuICAgICAqL1xuICAgIHByaXZhdGUgX2ZpbmRGb3JtYXQobm9kZTogVk5vZGUsIGZvcm1hdDogRm9ybWF0KTogRm9ybWF0IHtcbiAgICAgICAgcmV0dXJuIG5vZGUubW9kaWZpZXJzLmZpbHRlcihGb3JtYXQpLmZpbmQobm9kZUZvcm1hdCA9PiBub2RlRm9ybWF0LmlzU2FtZUFzKGZvcm1hdCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxhc3QgY29uc2VjdXRpdmUgbm9kZSB0byBoYXZlIHRoZSBnaXZlbiBmb3JtYXQgKGFzc3VtZWQgdG8gYmVcbiAgICAgKiBoZWxkIGJ5IHRoZSBnaXZlbiBub2RlIHRvbykuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBmb3JtYXRcbiAgICAgKi9cbiAgICBwcml2YXRlIF9sYXN0Tm9kZVdpdGhGb3JtYXQobm9kZTogVk5vZGUsIGZvcm1hdDogRm9ybWF0KTogVk5vZGUge1xuICAgICAgICBsZXQgY3VycmVudCA9IG5vZGU7XG4gICAgICAgIGxldCBuZXh0ID0gbm9kZS5uZXh0U2libGluZygpO1xuICAgICAgICB3aGlsZSAodGhpcy5fZmluZEZvcm1hdChuZXh0LCBmb3JtYXQpKSB7XG4gICAgICAgICAgICBjdXJyZW50ID0gbmV4dDtcbiAgICAgICAgICAgIG5leHQgPSBjdXJyZW50Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbGwgZm9ybWF0cyB0aGF0IGFyZSBzdGFydGVkIGJ5IHRoZSBnaXZlbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9uZXdGb3JtYXRzKG5vZGU6IFZOb2RlKTogRm9ybWF0W10ge1xuICAgICAgICBjb25zdCBmb3JtYXRzID0gbm9kZS5tb2RpZmllcnMuZmlsdGVyKEZvcm1hdCk7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzID0gbm9kZS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgLy8gQSBuZXcgZm9ybWF0IGlzIHN0YXJ0aW5nIGlmIHRoZSBwcmV2aW91cyBzaWJsaW5nIGRvZXNuJ3QgaGF2ZSBpdC5cbiAgICAgICAgaWYgKCFwcmV2aW91cykgcmV0dXJuIGZvcm1hdHM7XG4gICAgICAgIHJldHVybiBmb3JtYXRzLmZpbHRlcihmb3JtYXQgPT4gIXRoaXMuX2ZpbmRGb3JtYXQocHJldmlvdXMsIGZvcm1hdCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZ2l2ZW4gbm9kZSBpbmhlcml0cyB0aGUgZ2l2ZW4gY29sb3IgdGhyb3VnaCBhbiBhbmNlc3RvciBvZiBhXG4gICAgICogZm9ybWF0LCBvciBpZiBpdCBzaW1wbHkgaGFzIGl0IGl0c2VsZiwgcmV0dXJuIHRoZSBub2RlIG9yIGZvcm1hdCBpdFxuICAgICAqIGluaGVyaXRzIGl0IGZyb20uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBjb2xvclxuICAgICAqL1xuICAgIHByaXZhdGUgX2luaGVyaXRzQ29sb3JGcm9tKG5vZGU6IFZOb2RlLCBjb2xvcjogc3RyaW5nKTogVk5vZGUgfCBGb3JtYXQgfCB1bmRlZmluZWQge1xuICAgICAgICBpZiAodGhpcy5oYXNDb2xvcihjb2xvciwgbm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbG9yQW5jZXN0b3IgPSBub2RlLmFuY2VzdG9yKHRoaXMuaGFzQ29sb3IuYmluZCh0aGlzKSk7XG4gICAgICAgIGlmIChjb2xvckFuY2VzdG9yICYmIHRoaXMuaGFzQ29sb3IoY29sb3IsIGNvbG9yQW5jZXN0b3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gY29sb3JBbmNlc3RvcjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGZvcm1hdCBvZiBub2RlLm1vZGlmaWVycy5maWx0ZXIoRm9ybWF0KSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzQ29sb3IoY29sb3IsIGZvcm1hdCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgX2FwcGx5Q29sb3Iobm9kZTogVk5vZGUgfCBGb3JtYXQsIGNvbG9yOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbm9kZS5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnN0eWxlLnNldCh0aGlzLnN0eWxlTmFtZSwgY29sb3IpO1xuICAgIH1cbiAgICBwcml2YXRlIF9yZW1vdmVDb2xvcihub2RlOiBWTm9kZSB8IEZvcm1hdCk6IHZvaWQge1xuICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGUucmVtb3ZlKHRoaXMuc3R5bGVOYW1lKTtcbiAgICB9XG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vRGV2aWNlUHJldmlldy5jc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cbnZhciBleHBvcnRlZCA9IGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB7fTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZWQ7IiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgVGhlbWUgfSBmcm9tICcuLi8uLi9wbHVnaW4tdGhlbWUvc3JjL1RoZW1lJztcbmltcG9ydCB7IElmcmFtZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pZnJhbWUvc3JjL0lmcmFtZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBEb21MYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0JztcbmltcG9ydCB7IFRoZW1lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi10aGVtZS9zcmMvVGhlbWVOb2RlJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcblxuaW1wb3J0ICcuLi9hc3NldHMvRGV2aWNlUHJldmlldy5jc3MnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERldmljZVByZXZpZXdDb25maWcgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyB7XG4gICAgZ2V0VGhlbWU/OiAoZWRpdG9yOiBKV0VkaXRvcikgPT4gVGhlbWVOb2RlO1xuICAgIGRldmljZXM/OiBSZWNvcmQ8XG4gICAgICAgIHN0cmluZyxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6IHN0cmluZztcbiAgICAgICAgICAgIGhlYWQ6IHN0cmluZztcbiAgICAgICAgfVxuICAgID47XG59XG5pbnRlcmZhY2UgRGV2aWNlUHJldmlld1BhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGRldmljZTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgRGV2aWNlUHJldmlldzxUIGV4dGVuZHMgRGV2aWNlUHJldmlld0NvbmZpZyA9IERldmljZVByZXZpZXdDb25maWc+IGV4dGVuZHMgSldQbHVnaW48XG4gICAgVFxuPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtUaGVtZSwgSWZyYW1lLCBEb21MYXlvdXRdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIEtleW1hcCAmIExheW91dD4gPSB7XG4gICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ0RldmljZVByZXZpZXdCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdkZXZpY2VQcmV2aWV3JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVG9nZ2xlIGRldmljZSBwcmV2aWV3JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZURldmljZVByZXZpZXcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEhZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IuYW5jZXN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBUaGVtZU5vZGUgJiYgbm9kZS50aGVtZU5hbWUuZW5kc1dpdGgoJ1ByZXZpZXcnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLW1vYmlsZS1hbHQgZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtbJ0RldmljZVByZXZpZXdCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICB0b2dnbGVEZXZpY2VQcmV2aWV3OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnRvZ2dsZURldmljZVByZXZpZXcsXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IsIGNvbmZpZ3VyYXRpb246IFQpIHtcbiAgICAgICAgc3VwZXIoZWRpdG9yLCBjb25maWd1cmF0aW9uKTtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZ3VyYXRpb24uZ2V0VGhlbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAnUGxlYXNlIGRlZmluZSB0aGUgZ2V0VGhlbWUgbWV0aG9kIHRvIGNvbmZpZ3VyZSB0aGUgRGV2aWNlUHJldmlldyBwbHVnaW4uJyxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuY29uZmlndXJhdGlvbi5kZXZpY2VzKSB7XG4gICAgICAgICAgICBjb25zdCBzdHlsZVNoZWV0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3R5bGUgb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc3R5bGUsIGxpbmsnKSkge1xuICAgICAgICAgICAgICAgIHN0eWxlU2hlZXRzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLm91dGVySFRNTC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUuaW5uZXJIVE1MLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUuaW5uZXJIVE1MLnJlcGxhY2UoLzwvLCAnJmx0OycpLnJlcGxhY2UoLz4vLCAnJmd0OycpLFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24uZGV2aWNlcyA9IHtcbiAgICAgICAgICAgICAgICBtb2JpbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdNb2JpbGUgcHJldmlldycsXG4gICAgICAgICAgICAgICAgICAgIGhlYWQ6IHN0eWxlU2hlZXRzLmpvaW4oJycpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgc3RhcnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgZGV2aWNlTmFtZSBpbiB0aGlzLmNvbmZpZ3VyYXRpb24uZGV2aWNlcykge1xuICAgICAgICAgICAgY29uc3QgZGV2aWNlID0gdGhpcy5jb25maWd1cmF0aW9uLmRldmljZXNbZGV2aWNlTmFtZV07XG4gICAgICAgICAgICB0aGlzLmRlcGVuZGVuY2llcy5nZXQoVGhlbWUpLmFkZFRoZW1lKHtcbiAgICAgICAgICAgICAgICBpZDogZGV2aWNlTmFtZSArICdEZXZpY2VQcmV2aWV3JyxcbiAgICAgICAgICAgICAgICBsYWJlbDogZGV2aWNlLmxhYmVsLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogYXN5bmMgKGVkaXRvcjogSldFZGl0b3IpOiBQcm9taXNlPFZOb2RlW10+ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5wbHVnaW5zXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KFBhcnNlcilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wYXJzZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dC9odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHQtaWZyYW1lIGlkPVwianctZGV2aWNlLXByZXZpZXdcIiBjbGFzcz1cImRldmljZS1wcmV2aWV3LScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VOYW1lICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1wiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2UuaGVhZCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8dC1wbGFjZWhvbGRlci8+PC90LWlmcmFtZT4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1cGVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSB0aGUgZGV2aWNlIHByZXZpZXcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgdG9nZ2xlRGV2aWNlUHJldmlldyhwYXJhbXM6IERldmljZVByZXZpZXdQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgdGhlbWUgPSB0aGlzLmNvbmZpZ3VyYXRpb24uZ2V0VGhlbWUodGhpcy5lZGl0b3IpO1xuICAgICAgICBpZiAodGhlbWUpIHtcbiAgICAgICAgICAgIGlmIChwYXJhbXMuZGV2aWNlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV2aWNlID0gcGFyYW1zLmRldmljZSArICdEZXZpY2VQcmV2aWV3JztcbiAgICAgICAgICAgICAgICB0aGVtZS50aGVtZU5hbWUgPSB0aGVtZS50aGVtZU5hbWUgPT09IGRldmljZSA/ICdkZWZhdWx0JyA6IGRldmljZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV2aWNlcyA9IFsnZGVmYXVsdCddLmNvbmNhdChcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5jb25maWd1cmF0aW9uLmRldmljZXMpLm1hcChkZXZpY2UgPT4gZGV2aWNlICsgJ0RldmljZVByZXZpZXcnKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZGV2aWNlcy5pbmRleE9mKHRoZW1lLnRoZW1lTmFtZSkgKyAxO1xuICAgICAgICAgICAgICAgIHRoZW1lLnRoZW1lTmFtZSA9IGRldmljZXNbaW5kZXhdID8gZGV2aWNlc1tpbmRleF0gOiAnZGVmYXVsdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vRGV2VG9vbHMuY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGVzPlxcbiAgICA8IS0tIElOU1BFQ1RPUiAtLT5cXG4gICAgPGRldnRvb2xzLXBhbmVsIGNsYXNzPVxcXCJpbnNwZWN0b3JcXFwiIHQtbmFtZT1cXFwiSW5zcGVjdG9yQ29tcG9uZW50XFxcIiB0LWF0dC1jbGFzcz1cXFwie2FjdGl2ZTogcHJvcHMuaXNPcGVufVxcXCJcXG4gICAgICAgIHQtb24tbm9kZS1zZWxlY3RlZD1cXFwic2VsZWN0Tm9kZVxcXCJcXG4gICAgICAgIHQtb24ta2V5ZG93bj1cXFwib25LZXlkb3duXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1jb250ZW50cyB0LWlmPVxcXCJwcm9wcy5pc09wZW5cXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1tYWlucGFuZT5cXG4gICAgICAgICAgICAgICAgPG1haW5wYW5lLWNvbnRlbnRzPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyZWU+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyZWVDb21wb25lbnRcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdk5vZGU9XFxcImRvbUVuZ2luZS5yb290XFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1Jvb3Q9XFxcInRydWVcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUGF0aD1cXFwiZ2V0UGF0aChzZWxlY3RlZE5vZGUpXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZElEPVxcXCJzdGF0ZS5zZWxlY3RlZElEXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyZWU+XFxuICAgICAgICAgICAgICAgIDwvbWFpbnBhbmUtY29udGVudHM+XFxuICAgICAgICAgICAgICAgIDxQYXRoQ29tcG9uZW50XFxuICAgICAgICAgICAgICAgICAgICBwYXRoPVxcXCJnZXRQYXRoKHNlbGVjdGVkTm9kZSlcXFwiXFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZElEPVxcXCJzdGF0ZS5zZWxlY3RlZElEXFxcIi8+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy1tYWlucGFuZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtc2lkZXBhbmU+XFxuICAgICAgICAgICAgICAgIDxJbmZvQ29tcG9uZW50IHZOb2RlPVxcXCJzZWxlY3RlZE5vZGVcXFwiLz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXNpZGVwYW5lPlxcbiAgICAgICAgPC9kZXZ0b29scy1jb250ZW50cz5cXG4gICAgPC9kZXZ0b29scy1wYW5lbD5cXG5cXG4gICAgPCEtLSBJTlNQRUNUT1IuVHJlZSAtLT5cXG4gICAgPGRldnRvb2xzLW5vZGUgdC1uYW1lPVxcXCJUcmVlQ29tcG9uZW50XFxcIlxcbiAgICAgICAgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICBibG9jazogcHJvcHMudk5vZGUubGVuZ3RoIGFuZCAhcHJvcHMudk5vZGUuY2hhcixcXG4gICAgICAgICAgICBmb2xkZWQ6IHN0YXRlLmZvbGRlZCxcXG4gICAgICAgICAgICByb290OiBwcm9wcy5pc1Jvb3QsXFxuICAgICAgICAgICAgJ3NlbGYtY2xvc2luZyc6ICFwcm9wcy52Tm9kZS5oYXNDaGlsZHJlbigpLFxcbiAgICAgICAgfVxcXCJcXG4gICAgICAgIHRhYmluZGV4PVxcXCIxXFxcIlxcbiAgICAgICAgdC1vbi1rZXlkb3duPVxcXCJvbktleWRvd25cXFwiXFxuICAgICAgICB0LW9uLW5vZGUtc2VsZWN0ZWQ9XFxcInNlbGVjdE5vZGVcXFwiPlxcbiAgICAgICAgPHQgdC1pZj1cXFwicHJvcHMuaXNSb290XFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtbm9kZW5hbWUgY2xhc3M9XFxcInNlbGVjdGFibGUtbGluZSBibG9ja1xcXCJcXG4gICAgICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwib25DbGlja05vZGVcXFwiIHQtb24tZGJsY2xpY2s9XFxcIm9uRGJsQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHByb3BzLnNlbGVjdGVkSUQgPT0gcHJvcHMudk5vZGUuaWQsXFxuICAgICAgICAgICAgICAgIH1cXFwiPnJvb3Q8L2RldnRvb2xzLW5vZGVuYW1lPlxcbiAgICAgICAgICAgIDx0IHQtY2FsbD1cXFwidHJlZUNoaWxkcmVuXFxcIi8+XFxuICAgICAgICA8L3Q+XFxuICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+XFxuICAgICAgICAgICAgPGRldnRvb2xzLW5vZGVuYW1lIHQtaWY9XFxcIiFwcm9wcy52Tm9kZS50YW5naWJsZVxcXCJcXG4gICAgICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwib25DbGlja05vZGVcXFwiIHQtb24tZGJsY2xpY2s9XFxcIm9uRGJsQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lIGlubGluZSBtYXJrZXItbm9kZVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBwcm9wcy5zZWxlY3RlZElEID09IHByb3BzLnZOb2RlLmlkLFxcbiAgICAgICAgICAgICAgICB9XFxcIj5cXG4gICAgICAgICAgICAgICAgPGI+PHQgdC1lc2M9XFxcInJlcHIoKVxcXCIvPjwvYj5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW5vZGVuYW1lPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1ub2RlbmFtZSB0LWVsaWY9XFxcInByb3BzLnZOb2RlLmNoYXJcXFwiIHQtb24tY2xpY2s9XFxcIm9uQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICB0LW9uLWRibGNsaWNrPVxcXCJvbkRibENsaWNrTm9kZVxcXCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XFxcInNlbGVjdGFibGUtbGluZSBpbmxpbmVcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICBib2xkOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ2InKSxcXG4gICAgICAgICAgICAgICAgICAgIGl0YWxpYzogaXNGb3JtYXQocHJvcHMudk5vZGUsICdpJyksXFxuICAgICAgICAgICAgICAgICAgICB1bmRlcmxpbmU6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAndScpLFxcbiAgICAgICAgICAgICAgICAgICAgbGluazogaXNGb3JtYXQocHJvcHMudk5vZGUsICdsaW5rJyksXFxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHQ6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnc3Vic2NyaXB0JyksXFxuICAgICAgICAgICAgICAgICAgICBzdXBlcnNjcmlwdDogaXNGb3JtYXQocHJvcHMudk5vZGUsICdzdXBlcnNjcmlwdCcpLFxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHByb3BzLnNlbGVjdGVkSUQgPT0gcHJvcHMudk5vZGUuaWQsXFxuICAgICAgICAgICAgICAgIH1cXFwiPlxcbiAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwicmVwcigpXFxcIi8+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy1ub2RlbmFtZT5cXG4gICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy1ub2RlbmFtZSBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lIGJsb2NrXFxcIiB0LW9uLWNsaWNrPVxcXCJvbkNsaWNrTm9kZVxcXCJcXG4gICAgICAgICAgICAgICAgICAgIHQtb24tZGJsY2xpY2s9XFxcIm9uRGJsQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgICAgICBib2xkOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ2InKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGFsaWM6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnaScpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVybGluZTogaXNGb3JtYXQocHJvcHMudk5vZGUsICd1JyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluazogaXNGb3JtYXQocHJvcHMudk5vZGUsICdsaW5rJyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0OiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ3N1YnNjcmlwdCcpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1cGVyc2NyaXB0OiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ3N1cGVyc2NyaXB0JyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHByb3BzLnNlbGVjdGVkSUQgPT0gcHJvcHMudk5vZGUuaWQsXFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xpbmUtYnJlYWsnOiBwcm9wcy52Tm9kZS5odG1sVGFnID09PSAnQlInLFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwicmVwcigpXFxcIi8+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtbm9kZW5hbWU+XFxuICAgICAgICAgICAgICAgIDx0IHQtY2FsbD1cXFwidHJlZUNoaWxkcmVuXFxcIi8+XFxuICAgICAgICAgICAgPC90PlxcbiAgICAgICAgPC90PlxcbiAgICA8L2RldnRvb2xzLW5vZGU+XFxuXFxuICAgIDx0IHQtbmFtZT1cXFwidHJlZUNoaWxkcmVuXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1jaGlsZHJlbj5cXG4gICAgICAgICAgICA8VHJlZUNvbXBvbmVudCB0LWlmPVxcXCIhc3RhdGUuZm9sZGVkXFxcIlxcbiAgICAgICAgICAgICAgICB0LWZvcmVhY2g9XFxcInByb3BzLnZOb2RlLmNoaWxkVk5vZGVzLnNsaWNlKClcXFwiIHQtYXM9XFxcImNoaWxkXFxcIlxcbiAgICAgICAgICAgICAgICB0LWtleT1cXFwiY2hpbGQuaWRcXFwiXFxuICAgICAgICAgICAgICAgIHZOb2RlPVxcXCJjaGlsZFxcXCJcXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRQYXRoPVxcXCJwcm9wcy5zZWxlY3RlZFBhdGhcXFwiXFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkSUQ9XFxcInByb3BzLnNlbGVjdGVkSURcXFwiLz5cXG4gICAgICAgIDwvZGV2dG9vbHMtY2hpbGRyZW4+XFxuICAgIDwvdD5cXG5cXG4gICAgPCEtLSBJTlNQRUNUT1IuUGF0aCAtLT5cXG4gICAgPGRldnRvb2xzLXBhdGggdC1uYW1lPVxcXCJQYXRoQ29tcG9uZW50XFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1wYXRobm9kZSB0LWZvcmVhY2g9XFxcInByb3BzLnBhdGhcXFwiIHQtYXM9XFxcInZOb2RlXFxcIlxcbiAgICAgICAgICAgIHQta2V5PVxcXCJ2Tm9kZS5pZFxcXCJcXG4gICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogdk5vZGUuaWQgPT0gcHJvcHMuc2VsZWN0ZWRJRFxcbiAgICAgICAgICAgIH1cXFwiXFxuICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwic2VsZWN0Tm9kZSh2Tm9kZSlcXFwiPlxcbiAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJnZXROb2RlUmVwcih2Tm9kZSlcXFwiLz5cXG4gICAgICAgIDwvZGV2dG9vbHMtcGF0aG5vZGU+XFxuICAgIDwvZGV2dG9vbHMtcGF0aD5cXG5cXG4gICAgPCEtLSBJTlNQRUNUT1IuSW5mbyAtLT5cXG4gICAgPGRldnRvb2xzLWluZm8gdC1uYW1lPVxcXCJJbmZvQ29tcG9uZW50XFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1uYXZiYXI+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWJ1dHRvbiB0LW9uLWNsaWNrPVxcXCJvcGVuVGFiKCd2Tm9kZScpXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAndk5vZGUnLFxcbiAgICAgICAgICAgIH1cXFwiPlZOb2RlPC9kZXZ0b29scy1idXR0b24+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWJ1dHRvbiB0LW9uLWNsaWNrPVxcXCJvcGVuVGFiKCdzZWxlY3Rpb24nKVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLmN1cnJlbnRUYWIgPT0gJ3NlbGVjdGlvbicsXFxuICAgICAgICAgICAgfVxcXCI+U2VsZWN0aW9uPC9kZXZ0b29scy1idXR0b24+XFxuICAgICAgICA8L2RldnRvb2xzLW5hdmJhcj5cXG4gICAgICAgIDx0IHQtY2FsbD1cXFwiaW5mb1ZOb2RlXFxcIiB0LWlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICd2Tm9kZSdcXFwiLz5cXG4gICAgICAgIDx0IHQtY2FsbD1cXFwiaW5mb1NlbGVjdGlvblxcXCIgdC1pZj1cXFwic3RhdGUuY3VycmVudFRhYiA9PSAnc2VsZWN0aW9uJ1xcXCIvPlxcbiAgICA8L2RldnRvb2xzLWluZm8+XFxuXFxuICAgIDwhLS0gSU5TUEVDVE9SLkluZm8udk5vZGUgLS0+XFxuICAgIDx0IHQtbmFtZT1cXFwiaW5mb1ZOb2RlXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1hYm91dD5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtdHlwZT48dCB0LWVzYz1cXFwiY2xhc3NOYW1lKHByb3BzLnZOb2RlKVxcXCIvPjwvZGV2dG9vbHMtdHlwZT4gPHQgdC1lc2M9XFxcInByb3BzLnZOb2RlLm5hbWVcXFwiLz5cXG4gICAgICAgICAgICA8dCB0LWlmPVxcXCJwcm9wcy52Tm9kZS5jaGFyXFxcIj46XFxuICAgICAgICAgICAgICAgIFxcXCI8dCB0LWVzYz1cXFwicHJvcHMudk5vZGUuY2hhclxcXCIvPlxcXCJcXG4gICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWJ1dHRvbiBjbGFzcz1cXFwibG9nZ2VyXFxcIiB0LW9uLWNsaWNrPVxcXCJsb2dWTm9kZShwcm9wcy52Tm9kZSlcXFwiPiZndDtfPC9kZXZ0b29scy1idXR0b24+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWlkPjx0IHQtZXNjPVxcXCJwcm9wcy52Tm9kZS5pZFxcXCIvPjwvZGV2dG9vbHMtaWQ+XFxuICAgICAgICA8L2RldnRvb2xzLWFib3V0PlxcbiAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWluZm90aXRsZT7wn5GkIEFib3V0IG1lPC9kZXZ0b29scy1pbmZvdGl0bGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJhYm91dE1lUHJvcHNcXFwiIHQtYXM9XFxcInByb3BOYW1lXFxcIiB0LWtleT1cXFwicHJvcE5hbWVfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicHJvcE5hbWVcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicHJvcFJlcHIocHJvcHMudk5vZGUsIHByb3BOYW1lKVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD50b3RhbCBsZW5ndGg8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwidG90YWxMZW5ndGgocHJvcHMudk5vZGUpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPnRleHQgY29udGVudDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wcy52Tm9kZS50ZXh0Q29udGVudFxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWluZm90aXRsZT7wn5OWIE15IFByb3BlcnRpZXM8L2RldnRvb2xzLWluZm90aXRsZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ciB0LWZvcmVhY2g9XFxcIm5vZGVQcm9wZXJ0aWVzKHByb3BzLnZOb2RlKVxcXCIgdC1hcz1cXFwicHJvcFxcXCIgdC1rZXk9XFxcInByb3BfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicHJvcC5rZXlcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicHJvcC52YWx1ZVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWluZm90aXRsZT7wn5GqIE15IEZhbWlseTwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwiZmFtaWx5UHJvcHNcXFwiIHQtYXM9XFxcInByb3BOYW1lXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgdC1rZXk9XFxcInByb3BOYW1lX2luZGV4XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcInByb3BOYW1lXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQgdC1pZj1cXFwicHJvcE5hbWUgPT09ICdwYXJlbnQnXFxcIiB0LW9uLWNsaWNrPVxcXCJzZWxlY3ROb2RlKHByb3BzLnZOb2RlLnBhcmVudClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwicHJvcFJlcHIocHJvcHMudk5vZGUsIHByb3BOYW1lKVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkIHQtZWxpZj1cXFwicHJvcE5hbWUgPT09ICdzaWJsaW5ncydcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0aXRlbSB0LWlmPVxcXCJwcm9wcy52Tm9kZS5wcmV2aW91c1NpYmxpbmcoKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJzZWxlY3ROb2RlKHByb3BzLnZOb2RlLnByZXZpb3VzU2libGluZygpKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXM6IDx0IHQtZXNjPVxcXCJwcm9wcy52Tm9kZS5wcmV2aW91c1NpYmxpbmcoKS5uYW1lXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWxpc3RpdGVtPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWxpc3RpdGVtIHQtZWxzZT1cXFwiXFxcIj5wcmV2aW91czogbm9uZTwvZGV2dG9vbHMtbGlzdGl0ZW0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdGl0ZW0gdC1pZj1cXFwicHJvcHMudk5vZGUubmV4dFNpYmxpbmcoKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJzZWxlY3ROb2RlKHByb3BzLnZOb2RlLm5leHRTaWJsaW5nKCkpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiA8dCB0LWVzYz1cXFwicHJvcHMudk5vZGUubmV4dFNpYmxpbmcoKS5uYW1lXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWxpc3RpdGVtPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWxpc3RpdGVtIHQtZWxzZT1cXFwiXFxcIj5uZXh0OiBub25lPC9kZXZ0b29scy1saXN0aXRlbT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1saXN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkIHQtZWxpZj1cXFwicHJvcE5hbWUgPT09ICdjaGlsZHJlbidcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdCB0LWlmPVxcXCJwcm9wcy52Tm9kZS5jaGlsZFZOb2Rlcy5sZW5ndGhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWxpc3RpdGVtIHQtZm9yZWFjaD1cXFwicHJvcHMudk5vZGUuY2hpbGRyZW4oKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LWFzPVxcXCJjaGlsZFxcXCIgdC1rZXk9XFxcImNoaWxkLmlkXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtb24tY2xpY2s9XFxcInNlbGVjdE5vZGUoY2hpbGQpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwiY2hpbGQubmFtZVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1saXN0aXRlbT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1saXN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+bm9uZTwvdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZCB0LWVsc2U9XFxcIlxcXCI+PHQgdC1lc2M9XFxcInByb3BSZXByKHByb3BzLnZOb2RlLCBwcm9wTmFtZSlcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgPC9kZXZ0b29scy1wcm9wZXJ0aWVzPlxcbiAgICA8L3Q+XFxuXFxuICAgIDwhLS0gSU5TUEVDVE9SLkluZm8uc2VsZWN0aW9uIC0tPlxcbiAgICA8dCB0LW5hbWU9XFxcImluZm9TZWxlY3Rpb25cXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLWFib3V0PlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10eXBlPlZTZWxlY3Rpb248L2RldnRvb2xzLXR5cGU+IFNlbGVjdGlvblxcbiAgICAgICAgPC9kZXZ0b29scy1hYm91dD5cXG4gICAgICAgIDxkZXZ0b29scy1wcm9wZXJ0aWVzPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1pbmZvdGl0bGU+8J+RpCBBYm91dCBtZTwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5kaXJlY3Rpb248L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwiZW52LmVkaXRvci5zZWxlY3Rpb24uZGlyZWN0aW9uXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjxzdHJvbmcgY2xhc3M9XFxcIm1hcmtlci1ub2RlXFxcIj5bPC9zdHJvbmc+IGFuY2hvcjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJfcmVwcihlbnYuZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjxzdHJvbmcgY2xhc3M9XFxcIm1hcmtlci1ub2RlXFxcIj5dPC9zdHJvbmc+IGZvY3VzPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcIl9yZXByKGVudi5lZGl0b3Iuc2VsZWN0aW9uLmZvY3VzKVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgIDwvdD5cXG5cXG4gICAgPGRldnRvb2xzLXBhbmVsIHQtbmFtZT1cXFwiQ29tbWFuZHNDb21wb25lbnRcXFwiXFxuICAgICAgICB0LWF0dC1jbGFzcz1cXFwie2FjdGl2ZTogcHJvcHMuaXNPcGVufVxcXCIgdGFiaW5kZXg9XFxcIjFcXFwiXFxuICAgICAgICB0LW9uLWtleWRvd249XFxcIm9uS2V5ZG93blxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtY29udGVudHMgdC1pZj1cXFwicHJvcHMuaXNPcGVuXFxcIj5cXG4gICAgICAgICAgICA8dCB0LXNldD1cXFwic2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25zXFxcIiB0LXZhbHVlPVxcXCJzdGF0ZS5yZWdpc3RyeVtzdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyXVxcXCIvPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1tYWlucGFuZSBzdHlsZT1cXFwib3ZlcmZsb3c6IGhpZGRlblxcXCI+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy1uYXZiYXI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ3F1ZXVlJylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLmN1cnJlbnRUYWIgPT0gJ3F1ZXVlJyxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFwiPlF1ZXVlPC9kZXZ0b29scy1idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ3JlZ2lzdHJ5JylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLmN1cnJlbnRUYWIgPT0gJ3JlZ2lzdHJ5JyxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFwiPlJlZ2lzdHJ5PC9kZXZ0b29scy1idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtbmF2YmFyPlxcbiAgICAgICAgICAgICAgICA8bWFpbnBhbmUtY29udGVudHMgdC1pZj1cXFwic3RhdGUuY3VycmVudFRhYiA9PSAncXVldWUnXFxcIiBzdHlsZT1cXFwib3ZlcmZsb3c6IGF1dG9cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlIHN0eWxlPVxcXCJ3aWR0aDogMTAwJTtcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwiQXJyYXkuZnJvbShwcm9wcy5jb21tYW5kcy5rZXlzKCkpLnJldmVyc2UoKVxcXCIgdC1hcz1cXFwiY29tbWFuZEluZGV4XFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1rZXk9XFxcImNvbW1hbmRJbmRleF9pbmRleFxcXCIgY2xhc3M9XFxcInNlbGVjdGFibGUtbGluZVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLnNlbGVjdGVkQ29tbWFuZEluZGV4ID09IGNvbW1hbmRJbmRleCxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJzZWxlY3RDb21tYW5kQnlJbmRleChjb21tYW5kSW5kZXgpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZCBjbGFzcz1cXFwibnVtYmVyaW5nXFxcIj48dCB0LWVzYz1cXFwiY29tbWFuZEluZGV4ICsgMVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcInByb3BzLmNvbW1hbmRzW2NvbW1hbmRJbmRleF1bMF1cXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICA8L21haW5wYW5lLWNvbnRlbnRzPlxcbiAgICAgICAgICAgICAgICA8bWFpbnBhbmUtY29udGVudHMgdC1lbGlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdyZWdpc3RyeSdcXFwiIHN0eWxlPVxcXCJvdmVyZmxvdzogYXV0b1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtY29tbWFuZCB0LWZvcmVhY2g9XFxcIk9iamVjdC5rZXlzKHN0YXRlLnJlZ2lzdHJ5KS5zb3J0KClcXFwiIHQtYXM9XFxcImNvbW1hbmRJZGVudGlmaWVyXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIHQta2V5PVxcXCJyZWNvcmRfaW5kZXhcXFwiIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmVcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIgPT0gY29tbWFuZElkZW50aWZpZXIsXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJzZWxlY3RDb21tYW5kKGNvbW1hbmRJZGVudGlmaWVyKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcImNvbW1hbmRJZGVudGlmaWVyXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWNvbW1hbmQ+XFxuICAgICAgICAgICAgICAgIDwvbWFpbnBhbmUtY29udGVudHM+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy1tYWlucGFuZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtc2lkZXBhbmU+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy1pbmZvIHQtaWY9XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ3F1ZXVlJ1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dCB0LXNldD1cXFwic2VsZWN0ZWRDb21tYW5kXFxcIiB0LXZhbHVlPVxcXCJwcm9wcy5jb21tYW5kc1tzdGF0ZS5zZWxlY3RlZENvbW1hbmRJbmRleF1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1hYm91dCB0LWlmPVxcXCJzZWxlY3RlZENvbW1hbmRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10eXBlPkNvbW1hbmQ8L2RldnRvb2xzLXR5cGU+IDx0IHQtZXNjPVxcXCJzZWxlY3RlZENvbW1hbmRbMF1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtYWJvdXQ+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtcHJvcGVydGllcyB0LWlmPVxcXCJzZWxlY3RlZENvbW1hbmRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1pbmZvdGl0bGU+QXJndW1lbnRzPC9kZXZ0b29scy1pbmZvdGl0bGU+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtaWY9XFxcInNlbGVjdGVkQ29tbWFuZFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LXNldD1cXFwicGF5bG9hZFxcXCIgdC12YWx1ZT1cXFwic2VsZWN0ZWRDb21tYW5kWzFdXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWNhbGw9XFxcImNvbW1hbmRBcmdzXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1jYWxsPVxcXCJzZWxlY3RlZENvbW1hbmRUYWJsZVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtcHJvcGVydGllcz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtcHJvcGVydGllcz5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy1pbmZvPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtaW5mbyB0LWVsaWY9XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ3JlZ2lzdHJ5J1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJzdGF0ZS5yZWdpc3RyeVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWFib3V0IHQtaWY9XFxcInN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHlwZT5Db21tYW5kPC9kZXZ0b29scy10eXBlPiA8dCB0LWVzYz1cXFwic3RhdGUuc2VsZWN0ZWRDb21tYW5kSWRlbnRpZmllclxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtYWJvdXQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXMgdC1pZj1cXFwic3RhdGUuc2VsZWN0ZWRDb21tYW5kSWRlbnRpZmllclxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtY2FsbD1cXFwic2VsZWN0ZWRDb21tYW5kVGFibGVcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtaW5mbz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXNpZGVwYW5lPlxcbiAgICAgICAgPC9kZXZ0b29scy1jb250ZW50cz5cXG4gICAgPC9kZXZ0b29scy1wYW5lbD5cXG5cXG4gICAgPHQgdC1uYW1lPVxcXCJjb21tYW5kQXJnc1xcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtdGFibGUgdC1pZj1cXFwicGF5bG9hZFxcXCI+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICA8dCB0LWZvcmVhY2g9XFxcIk9iamVjdC5rZXlzKHBheWxvYWQpXFxcIiB0LWFzPVxcXCJrZXlcXFwiIHQta2V5PVxcXCJrZXlfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtaWY9XFxcImtleSAhPT0gJ2NvbnRleHQnXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LXNldD1cXFwidmFsdWVcXFwiIHQtdmFsdWU9XFxcInBheWxvYWRba2V5XVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcImtleVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJ2YWx1ZSBhbmQga2V5ID09ICd2U2VsZWN0aW9uJ1xcXCIgdC1jYWxsPVxcXCJwYXlsb2FkVlNlbGVjdGlvblxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+PHQgdC1lc2M9XFxcImZvcm1hdFBheWxvYWRWYWx1ZSh2YWx1ZSlcXFwiLz48L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgIDxwIHQtZWxzZT1cXFwiXFxcIj5Ob25lPC9wPlxcbiAgICA8L3Q+XFxuXFxuICAgIDx0IHQtbmFtZT1cXFwicGF5bG9hZFZTZWxlY3Rpb25cXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvblxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwidmFsdWUuZGlyZWN0aW9uIG9yICd1bnNldCdcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3JcXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcInZhbHVlLmFuY2hvclBvc2l0aW9uXFxcIi8+IDx0IHQtZXNjPVxcXCJ2YWx1ZS5hbmNob3JOb2RlLmlkXFxcIi8+ICg8dCB0LWVzYz1cXFwidmFsdWUuYW5jaG9yTm9kZS5uYW1lXFxcIi8+KVxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzXFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJ2YWx1ZS5mb2N1c1Bvc2l0aW9uXFxcIi8+IDx0IHQtZXNjPVxcXCJ2YWx1ZS5mb2N1c05vZGUuaWRcXFwiLz4gKDx0IHQtZXNjPVxcXCJ2YWx1ZS5mb2N1c05vZGUubmFtZVxcXCIvPilcXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10Ym9keT5cXG4gICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgIDwvdD5cXG5cXG4gICAgPHQgdC1uYW1lPVxcXCJzZWxlY3RlZENvbW1hbmRUYWJsZVxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPkNvbW1hbmQgZGVmaW5pdGlvbnM8L2RldnRvb2xzLWluZm90aXRsZT5cXG4gICAgICAgIDxkZXZ0b29scy10YWJsZSB0LWlmPVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbnNcXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwic2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25zXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgdC1hcz1cXFwic2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25cXFwiIHQta2V5PVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbl9pbmRleFxcXCJcXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmVcXFwiXFxuICAgICAgICAgICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5zZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbkluZGV4ID09IGhhbmRsZXJJbmRleCxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbi5oYW5kbGVyLm5hbWVcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbi5oYW5kbGVyXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgIDxwIHQtZWxzZT1cXFwiXFxcIj5Ob25lPC9wPlxcbiAgICAgICAgPHQgdC1zZXQ9XFxcIm1hcHBpbmdzXFxcIiB0LXZhbHVlPVxcXCJtYXRjaGluZ01hcHBpbmdzKHN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIpXFxcIi8+XFxuICAgICAgICA8dCB0LWlmPVxcXCJtYXBwaW5ncy5sZW5ndGhcXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1pbmZvdGl0bGU+U2hvcnRjdXRzPC9kZXZ0b29scy1pbmZvdGl0bGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJtYXBwaW5nc1xcXCIgdC1hcz1cXFwibWFwcGluZ1xcXCIgdC1rZXk9XFxcIm1hcHBpbmdfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZCBzdHlsZT1cXFwid2lkdGg6IDUwJTtcXFwiPjx0IHQtZXNjPVxcXCJzdHJpbmdpZnlQYXR0ZXJuKG1hcHBpbmcucGF0dGVybilcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwiYXJnc1JlcHIobWFwcGluZy5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kQXJncylcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgPC90PlxcbiAgICA8L3Q+XFxuXFxuICAgIDwhLS0gU0hPUlRDVVRTIC0tPlxcbiAgICA8ZGV2dG9vbHMtcGFuZWwgdC1uYW1lPVxcXCJTaG9ydGN1dHNDb21wb25lbnRcXFwiXFxuICAgICAgICB0LWF0dC1jbGFzcz1cXFwie2FjdGl2ZTogcHJvcHMuaXNPcGVufVxcXCIgdGFiaW5kZXg9XFxcIjFcXFwiXFxuICAgICAgICB0LW9uLWtleWRvd249XFxcIm9uS2V5ZG93blxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtY29udGVudHMgdC1pZj1cXFwicHJvcHMuaXNPcGVuXFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtbWFpbnBhbmUgc3R5bGU9XFxcIm92ZXJmbG93OiBoaWRkZW5cXFwiPlxcbiAgICAgICAgICAgICAgICA8bWFpbnBhbmUtY29udGVudHMgc3R5bGU9XFxcIm92ZXJmbG93OiBhdXRvXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJtYXBwaW5nc1xcXCIgdC1hcz1cXFwibWFwcGluZ1xcXCIgdC1rZXk9XFxcIm1hcHBpbmdfaW5kZXhcXFwiIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcInN0cmluZ2lmeVBhdHRlcm4obWFwcGluZy5wYXR0ZXJuKVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwibWFwcGluZy5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWRcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcImFyZ3NSZXByKG1hcHBpbmcuY29uZmlndXJlZENvbW1hbmQuY29tbWFuZEFyZ3MpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPC9tYWlucGFuZS1jb250ZW50cz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW1haW5wYW5lPlxcbiAgICAgICAgPC9kZXZ0b29scy1jb250ZW50cz5cXG4gICAgPC9kZXZ0b29scy1wYW5lbD5cXG5cXG4gICAgPCEtLSBQTFVHSU5TIC0tPlxcbiAgICA8ZGV2dG9vbHMtcGFuZWwgdC1uYW1lPVxcXCJQbHVnaW5zQ29tcG9uZW50XFxcIlxcbiAgICAgICAgdC1hdHQtY2xhc3M9XFxcInthY3RpdmU6IHByb3BzLmlzT3Blbn1cXFwiIHRhYmluZGV4PVxcXCIxXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1jb250ZW50cyB0LWlmPVxcXCJwcm9wcy5pc09wZW5cXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1tYWlucGFuZSBzdHlsZT1cXFwib3ZlcmZsb3c6IGhpZGRlblxcXCI+XFxuICAgICAgICAgICAgICAgIDxtYWlucGFuZS1jb250ZW50cyBzdHlsZT1cXFwib3ZlcmZsb3c6IGF1dG9cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ciB0LWZvcmVhY2g9XFxcInBsdWdpbnNcXFwiIHQtYXM9XFxcInBsdWdpblxcXCIgdC1rZXk9XFxcInBsdWdpbl9pbmRleFxcXCIgY2xhc3M9XFxcInNlbGVjdGFibGUtbGluZVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicGx1Z2luXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPC9tYWlucGFuZS1jb250ZW50cz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW1haW5wYW5lPlxcbiAgICAgICAgPC9kZXZ0b29scy1jb250ZW50cz5cXG4gICAgPC9kZXZ0b29scy1wYW5lbD5cXG5cXG4gICAgPCEtLSBNT0RFUyAtLT5cXG4gICAgPGRldnRvb2xzLXBhbmVsIHQtbmFtZT1cXFwiTW9kZXNDb21wb25lbnRcXFwiXFxuICAgICAgICB0LWF0dC1jbGFzcz1cXFwie2FjdGl2ZTogcHJvcHMuaXNPcGVufVxcXCIgdGFiaW5kZXg9XFxcIjFcXFwiXFxuICAgICAgICB0LW9uLWtleWRvd249XFxcIm9uS2V5ZG93blxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtY29udGVudHMgdC1pZj1cXFwicHJvcHMuaXNPcGVuXFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtbWFpbnBhbmUgc3R5bGU9XFxcIm92ZXJmbG93OiBoaWRkZW5cXFwiPlxcbiAgICAgICAgICAgICAgICA8bWFpbnBhbmUtY29udGVudHMgc3R5bGU9XFxcIm92ZXJmbG93OiBhdXRvXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJPYmplY3QudmFsdWVzKG1vZGVzKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1hcz1cXFwibW9kZVxcXCIgdC1rZXk9XFxcIm1vZGUuaWRcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmVcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuc2VsZWN0ZWRNb2RlIGFuZCBzdGF0ZS5zZWxlY3RlZE1vZGUuaWQgPT0gbW9kZS5pZCxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwic2VsZWN0TW9kZShtb2RlLmlkKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1vbi1kYmxjbGljaz1cXFwic2V0TW9kZShtb2RlLmlkKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWlmPVxcXCJtb2RlLmlkID09IHN0YXRlLmN1cnJlbnRNb2RlLmlkXFxcIj7inIU8L3Q+IDx0IHQtZXNjPVxcXCJtb2RlLmlkXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPC9tYWlucGFuZS1jb250ZW50cz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW1haW5wYW5lPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1zaWRlcGFuZT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLWluZm8+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtYWJvdXQgdC1pZj1cXFwic3RhdGUuc2VsZWN0ZWRNb2RlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHlwZT5Nb2RlPC9kZXZ0b29scy10eXBlPiA8dCB0LWVzYz1cXFwic3RhdGUuc2VsZWN0ZWRNb2RlLmlkXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWFib3V0PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXMgdC1pZj1cXFwic3RhdGUuc2VsZWN0ZWRNb2RlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPvCfk5YgUnVsZXM8L2RldnRvb2xzLWluZm90aXRsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJzdGF0ZS5zZWxlY3RlZE1vZGVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1mb3JlYWNoPVxcXCJzdGF0ZS5zZWxlY3RlZE1vZGUucnVsZXNcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1hcz1cXFwicnVsZVxcXCIgdC1rZXk9XFxcInJ1bGUuaWRcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XFxcInNlbGVjdGFibGUtbGluZVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0aXRlbT5TZWxlY3RvcjogPGRldnRvb2xzLWJ1dHRvbiB0LW9uLWNsaWNrPVxcXCJsb2dTZWxlY3RvcihydWxlLnNlbGVjdG9yKVxcXCI+Jmd0O188L2RldnRvb2xzLWJ1dHRvbj48L2RldnRvb2xzLWxpc3RpdGVtPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0aXRlbSB0LWZvcmVhY2g9XFxcIk9iamVjdC5rZXlzKHJ1bGUucHJvcGVydGllcylcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1hcz1cXFwicHJvcGVydHlcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1rZXk9XFxcInByb3BlcnR5X2lkXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcInByb3BlcnR5XFxcIi8+OiA8dCB0LWVzYz1cXFwicnVsZS5wcm9wZXJ0aWVzW3Byb3BlcnR5XS52YWx1ZVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJydWxlLnByb3BlcnRpZXNbcHJvcGVydHldLmNhc2NhZGluZ1xcXCI+IChjYXNjYWRpbmcpPC90PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+ICh0YXJnZXRlZCk8L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1saXN0aXRlbT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtbGlzdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtaW5mbz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXNpZGVwYW5lPlxcbiAgICAgICAgPC9kZXZ0b29scy1jb250ZW50cz5cXG4gICAgPC9kZXZ0b29scy1wYW5lbD5cXG5cXG4gICAgPCEtLSBNQUlOIC0tPlxcbiAgICA8anctZGV2dG9vbHMgdC1uYW1lPVxcXCJkZXZ0b29sc1xcXCJcXG4gICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgY2xvc2VkOiBzdGF0ZS5jbG9zZWQsXFxuICAgICAgICB9XFxcIlxcbiAgICAgICAgdC1hdHRmLXN0eWxlPVxcXCJoZWlnaHQ6IHt7c3RhdGUuaGVpZ2h0fX1weFxcXCJcXG4gICAgICAgIHRhYmluZGV4PVxcXCIyXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1uYXZiYXJcXG4gICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJ0b2dnbGVDbG9zZWRcXFwiXFxuICAgICAgICAgICAgdC1vbi1tb3VzZWRvd249XFxcInN0YXJ0UmVzaXplXFxcIlxcbiAgICAgICAgICAgIHQtb24tdG91Y2hzdGFydD1cXFwic3RhcnRSZXNpemVcXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYignaW5zcGVjdG9yJylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5jdXJyZW50VGFiID09ICdpbnNwZWN0b3InLFxcbiAgICAgICAgICAgIH1cXFwiPkluc3BlY3RvcjwvZGV2dG9vbHMtYnV0dG9uPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYignY29tbWFuZHMnKVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLmN1cnJlbnRUYWIgPT0gJ2NvbW1hbmRzJyxcXG4gICAgICAgICAgICB9XFxcIj5Db21tYW5kczwvZGV2dG9vbHMtYnV0dG9uPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYignc2hvcnRjdXRzJylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5jdXJyZW50VGFiID09ICdzaG9ydGN1dHMnLFxcbiAgICAgICAgICAgIH1cXFwiPlNob3J0Y3V0czwvZGV2dG9vbHMtYnV0dG9uPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYigncGx1Z2lucycpXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAncGx1Z2lucycsXFxuICAgICAgICAgICAgfVxcXCI+UGx1Z2luczwvZGV2dG9vbHMtYnV0dG9uPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYignbW9kZXMnKVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHN0YXRlLmN1cnJlbnRUYWIgPT0gJ21vZGVzJyxcXG4gICAgICAgICAgICB9XFxcIj5Nb2RlczwvZGV2dG9vbHMtYnV0dG9uPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwiaW5zcGVjdERvbSgpXFxcIj4mIzEyODI2OTs8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgIDwvZGV2dG9vbHMtbmF2YmFyPlxcbiAgICAgICAgPHQgdC1pZj1cXFwiIXN0YXRlLmNsb3NlZFxcXCI+XFxuICAgICAgICAgICAgPEluc3BlY3RvckNvbXBvbmVudCBpc09wZW49XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ2luc3BlY3RvcidcXFwiIHQtcmVmPVxcXCJpbnNwZWN0b3JcXFwiLz5cXG4gICAgICAgICAgICA8Q29tbWFuZHNDb21wb25lbnQgaXNPcGVuPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdjb21tYW5kcydcXFwiXFxuICAgICAgICAgICAgICAgIGNvbW1hbmRzPVxcXCJzdGF0ZS5jb21tYW5kc1xcXCIvPlxcbiAgICAgICAgICAgIDxTaG9ydGN1dHNDb21wb25lbnQgaXNPcGVuPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdzaG9ydGN1dHMnXFxcIi8+XFxuICAgICAgICAgICAgPFBsdWdpbnNDb21wb25lbnQgaXNPcGVuPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdwbHVnaW5zJ1xcXCIvPlxcbiAgICAgICAgICAgIDxNb2Rlc0NvbXBvbmVudCBpc09wZW49XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ21vZGVzJ1xcXCIvPlxcbiAgICAgICAgPC90PlxcbiAgICA8L2p3LWRldnRvb2xzPlxcblxcbjwvdGVtcGxhdGVzPlxcblwiIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgT3dsIH0gZnJvbSAnLi4vLi4vcGx1Z2luLW93bC9zcmMvT3dsJztcbmltcG9ydCB7IE93bE5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xOb2RlJztcbmltcG9ydCB7IERldlRvb2xzQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL0RldlRvb2xzQ29tcG9uZW50JztcbmltcG9ydCB7IERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IERvbUxheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXQnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcblxuaW1wb3J0IGRldnRvb2xzVGVtcGxhdGVzIGZyb20gJy4uL2Fzc2V0cy9EZXZUb29scy54bWwnO1xuaW1wb3J0ICcuLi9hc3NldHMvRGV2VG9vbHMuY3NzJztcblxuZXhwb3J0IGNsYXNzIERldlRvb2xzPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW093bCwgRG9tT2JqZWN0UmVuZGVyZXIsIERvbUxheW91dF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8TGF5b3V0ICYgT3dsPiA9IHtcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnZGV2VG9vbHMnLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPE93bE5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBPd2xOb2RlKHsgQ29tcG9uZW50OiBEZXZUb29sc0NvbXBvbmVudCwgcHJvcHM6IHt9IH0pXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtbJ2RldlRvb2xzJywgWydkZWJ1ZyddXV0sXG4gICAgICAgIG93bFRlbXBsYXRlczogW2RldnRvb2xzVGVtcGxhdGVzXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLW93bC9zcmMvT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IENvbW1hbmRJZGVudGlmaWVyIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBDb21tYW5kSW1wbGVtZW50YXRpb24gfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IG5vZGVOYW1lLCBmbGF0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEtleW1hcCwgTWFwcGluZyB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBhcmdzUmVwciB9IGZyb20gJy4uL3V0aWxzJztcblxuaW50ZXJmYWNlIENvbW1hbmRzU3RhdGUge1xuICAgIGN1cnJlbnRUYWI6IHN0cmluZztcbiAgICByZWdpc3RyeTogUmVjb3JkPENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSW1wbGVtZW50YXRpb25bXT47XG4gICAgc2VsZWN0ZWRDb21tYW5kSW5kZXg6IG51bWJlcjtcbiAgICBzZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyOiBzdHJpbmc7XG4gICAgc2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25JbmRleDogbnVtYmVyO1xufVxuaW50ZXJmYWNlIENvbW1hbmRzUHJvcHMge1xuICAgIC8vIFN0YWNrIG9mIGFsbCBjb21tYW5kcyBleGVjdXRlZCBzaW5jZSBpbml0LlxuICAgIGNvbW1hbmRzOiBBcnJheTxbQ29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRQYXJhbXNdPjtcbn1cblxuZXhwb3J0IGNsYXNzIENvbW1hbmRzQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PENvbW1hbmRzUHJvcHM+IHtcbiAgICBzdGF0ZTogQ29tbWFuZHNTdGF0ZSA9IHtcbiAgICAgICAgY3VycmVudFRhYjogJ3F1ZXVlJyxcbiAgICAgICAgcmVnaXN0cnk6IHRoaXMuZW52LmVkaXRvci5kaXNwYXRjaGVyLmNvbW1hbmRzLFxuICAgICAgICBzZWxlY3RlZENvbW1hbmRJbmRleDogbnVsbCwgLy8gSW5kZXggb2YgdGhlIHNlbGVjdGVkIGNvbW1hbmQgaW4gdGhlIHN0YWNrXG4gICAgICAgIHNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXI6IG51bGwsIC8vIElkZW50aWZpZXIgb2YgdGhlIHNlbGVjdGVkIGNvbW1hbmRcbiAgICAgICAgc2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25JbmRleDogbnVsbCwgLy8gSW5kZXggb2YgdGhlIHNlbGVjdGVkIGNvbW1hbmQgZGVmaW5pdGlvblxuICAgIH07XG4gICAgbG9jYWxTdG9yYWdlID0gWydjdXJyZW50VGFiJ107XG4gICAgYXJnc1JlcHIgPSBhcmdzUmVwcjtcbiAgICBzdHJpbmdpZnlQYXR0ZXJuID0gdGhpcy5lbnYuZWRpdG9yLnBsdWdpbnMuZ2V0KEtleW1hcCkuc3RyaW5naWZ5UGF0dGVybjtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBUYWtlIGEgcGF5bG9hZCB2YWx1ZSBhbmQgZm9ybWF0IGl0IGZvciBkaXNwbGF5IChtb3N0bHkgdG8gZW5zdXJlIHRoYXRcbiAgICAgKiB3ZSBjYW4gZGlzcGxheSBpdCBwcm9wZXJseSBhcyBhIHN0cmluZykuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKi9cbiAgICBmb3JtYXRQYXlsb2FkVmFsdWUodmFsdWU6IE5vZGUgfCBzdHJpbmcgfCBib29sZWFuIHwgbnVtYmVyIHwgb2JqZWN0KTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlIGluc3RhbmNlb2YgTm9kZSAmJiBub2RlTmFtZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiAnPCcgKyBub2RlTmFtZSh2YWx1ZSkudG9Mb3dlckNhc2UoKSArICc+JztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgcmV0dXJuICcnICsgdmFsdWUuam9pbignLCAnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJycgKyB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGFuZGxlIGtleWRvd24gZXZlbnQgdG8gbmF2aWdhdGUgaW4gdGhlIGNvbW1hbmQgc3RhY2suXG4gICAgICovXG4gICAgb25LZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRUYWIgPT09ICdxdWV1ZScpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1heCh0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZEluZGV4IC0gMSwgMCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd1VwJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29tbWFuZHMubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5jdXJyZW50VGFiID09PSAncmVnaXN0cnknKSB7XG4gICAgICAgICAgICBjb25zdCBpZGVudGlmaWVycyA9IE9iamVjdC5rZXlzKHRoaXMuc3RhdGUucmVnaXN0cnkpLnNvcnQoKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IGlkZW50aWZpZXJzLmluZGV4T2YodGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyKTtcbiAgICAgICAgICAgIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRDb21tYW5kSWRlbnRpZmllciA9XG4gICAgICAgICAgICAgICAgICAgIGlkZW50aWZpZXJzW01hdGgubWluKGN1cnJlbnRJbmRleCArIDEsIGlkZW50aWZpZXJzLmxlbmd0aCAtIDEpXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyID0gaWRlbnRpZmllcnNbTWF0aC5tYXgoY3VycmVudEluZGV4IC0gMSwgMCldO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW4gdGhlIHRhYiB3aXRoIHRoZSBnaXZlbiB0YWJOYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRhYk5hbWVcbiAgICAgKi9cbiAgICBvcGVuVGFiKHRhYk5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRUYWIgPSB0YWJOYW1lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWxlY3QgdGhlIGNvbW1hbmQgYXQgZ2l2ZW4gaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaW5kZXhcbiAgICAgKi9cbiAgICBzZWxlY3RDb21tYW5kQnlJbmRleChpbmRleDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcbiAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyID0gdGhpcy5wcm9wcy5jb21tYW5kc1tpbmRleF1bMF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbGVjdCB0aGUgY29tbWFuZCB3aXRoIGdpdmVuIGlkZW50aWZpZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tbWFuZElkZW50aWZpZXJcbiAgICAgKi9cbiAgICBzZWxlY3RDb21tYW5kKGNvbW1hbmRJZGVudGlmaWVyOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyID0gY29tbWFuZElkZW50aWZpZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUga2V5IG1hcHBpbmdzIG1hdGNoaW5nIHRoZSBnaXZlbiBjb21tYW5kIGlkZW50aWZpZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tbWFuZElkZW50aWZpZXJcbiAgICAgKi9cbiAgICBtYXRjaGluZ01hcHBpbmdzKGNvbW1hbmRJZGVudGlmaWVyOiBzdHJpbmcpOiBNYXBwaW5nW10ge1xuICAgICAgICByZXR1cm4gZmxhdCh0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoS2V5bWFwKS5tYXBwaW5ncykuZmlsdGVyKFxuICAgICAgICAgICAgbWFwcGluZyA9PiBtYXBwaW5nLmNvbmZpZ3VyZWRDb21tYW5kLmNvbW1hbmRJZCA9PT0gY29tbWFuZElkZW50aWZpZXIsXG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29tbWFuZHNDb21wb25lbnQgfSBmcm9tICcuL0NvbW1hbmRzQ29tcG9uZW50JztcbmltcG9ydCB7IEluc3BlY3RvckNvbXBvbmVudCB9IGZyb20gJy4vSW5zcGVjdG9yQ29tcG9uZW50JztcbmltcG9ydCB7IFNob3J0Y3V0c0NvbXBvbmVudCB9IGZyb20gJy4vU2hvcnRjdXRzQ29tcG9uZW50JztcbmltcG9ydCB7IFBsdWdpbnNDb21wb25lbnQgfSBmcm9tICcuL1BsdWdpbnNDb21wb25lbnQnO1xuaW1wb3J0IHsgTW9kZXNDb21wb25lbnQgfSBmcm9tICcuL01vZGVzQ29tcG9uZW50JztcbmltcG9ydCB7IE93bENvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1vd2wvc3JjL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICdAb2Rvby9vd2wnO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gdG9kbzogdXNlIEFQSSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5pbnRlcmZhY2UgRGV2VG9vbHNTdGF0ZSB7XG4gICAgY2xvc2VkOiBib29sZWFuOyAvLyBBcmUgdGhlIGRldnRvb2xzIG9wZW4/XG4gICAgaGVpZ2h0OiBudW1iZXI7IC8vIEluIHB4XG4gICAgY3VycmVudFRhYjogc3RyaW5nOyAvLyBOYW1lIG9mIHRoZSBjdXJyZW50IHRhYlxuICAgIGNvbW1hbmRzOiBBcnJheTxbQ29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRQYXJhbXNdPjtcbn1cblxuZXhwb3J0IGNsYXNzIERldlRvb2xzQ29tcG9uZW50PFQgPSB7fT4gZXh0ZW5kcyBPd2xDb21wb25lbnQ8VD4ge1xuICAgIHN0YXRpYyBjb21wb25lbnRzID0ge1xuICAgICAgICBDb21tYW5kc0NvbXBvbmVudDogQ29tbWFuZHNDb21wb25lbnQsXG4gICAgICAgIEluc3BlY3RvckNvbXBvbmVudCxcbiAgICAgICAgU2hvcnRjdXRzQ29tcG9uZW50LFxuICAgICAgICBQbHVnaW5zQ29tcG9uZW50LFxuICAgICAgICBNb2Rlc0NvbXBvbmVudCxcbiAgICB9O1xuICAgIHN0YXRpYyB0ZW1wbGF0ZSA9ICdkZXZ0b29scyc7XG4gICAgaW5zcGVjdG9yUmVmID0gaG9va3MudXNlUmVmKCdpbnNwZWN0b3InKTtcblxuICAgIHN0YXRlOiBEZXZUb29sc1N0YXRlID0ge1xuICAgICAgICBjbG9zZWQ6IHRydWUsXG4gICAgICAgIGN1cnJlbnRUYWI6ICdpbnNwZWN0b3InLFxuICAgICAgICBoZWlnaHQ6IDMwMCxcbiAgICAgICAgY29tbWFuZHM6IFtdLCAvLyBTdGFjayBvZiBhbGwgY29tbWFuZHMgZXhlY3V0ZWQgc2luY2UgaW5pdC5cbiAgICB9O1xuICAgIGxvY2FsU3RvcmFnZSA9IFsnY2xvc2VkJywgJ2N1cnJlbnRUYWInLCAnaGVpZ2h0J107XG4gICAgLy8gRm9yIHJlc2l6aW5nL29wZW5pbmcgKHNlZSB0b2dnbGVDbG9zZWQpXG4gICAgX2hlaWdodE9uTGFzdE1vdXNlZG93bjogbnVtYmVyO1xuXG4gICAgYXN5bmMgd2lsbFN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmVudi5lZGl0b3IuZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmRIb29rKCcqJywgdGhpcy5hZGRDb21tYW5kLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmVudi5lZGl0b3IuZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmRIb29rKCdAY29tbWl0JywgdGhpcy5yZW5kZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHJldHVybiBzdXBlci53aWxsU3RhcnQoKTtcbiAgICB9XG4gICAgd2lsbFVubW91bnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuY29tbWFuZHMgPSBbXTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8qKlxuICAgICAqIE9wZW4gdGhlIHRhYiB3aXRoIHRoZSBnaXZlbiBgdGFiTmFtZWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0YWJOYW1lXG4gICAgICovXG4gICAgb3BlblRhYih0YWJOYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50VGFiID0gdGFiTmFtZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQmluZCBtb3VzZSBoYW5kbGVyIHRvIGFsbG93IHRoZSBzZWxlY3Rpb24gb2YgdGhlIG5vZGUgaW4gdGhlIGRldnRvb2xzIGluc3BlY3Rvci5cbiAgICAgKiBXaGVuIHRoZSBtb3VzZSB3aWxsIG1vdmUsIHdlIGFkZCBhIGNsYXNzIHRvIGhpZ2hsaWdodCB0aGUgdGFyZ2V0ZWQgbm9kZSAobGlua2VkIHRvIFZOb2RlKS5cbiAgICAgKiBXaWxsIGJlIHVuYmluZCB3aGVuIHRoZSB1c2VyIGNsaWNrIGluc2lkZSB0aGUgZG9tLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgaW5zcGVjdERvbSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50VGFiID0gJ2luc3BlY3Rvcic7XG4gICAgICAgICh0aGlzLmluc3BlY3RvclJlZi5jb21wIGFzIEluc3BlY3RvckNvbXBvbmVudCk/Lmluc3BlY3REb20oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIHRoZSByZWNlbnQgZGlzcGF0Y2hpbmcgb2YgdGhlIGdpdmVuIGNvbW1hbmQgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuICAgICAqL1xuICAgIGFkZENvbW1hbmQocGFyYW1zOiBDb21tYW5kUGFyYW1zLCBpZDogQ29tbWFuZElkZW50aWZpZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jb21tYW5kcy5wdXNoKFtpZCwgcGFyYW1zXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERyYWcgdGhlIERldlRvb2xzIHRvIHJlc2l6ZSB0aGVtXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgc3RhcnRSZXNpemUoZXZlbnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuX2hlaWdodE9uTGFzdE1vdXNlZG93biA9IHRoaXMuc3RhdGUuaGVpZ2h0O1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gRG8gbm90IHJlc2l6ZSBpZiB0aGUgRGV2VG9vbHMgYXJlIGNsb3NlZFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXJ0WTogbnVtYmVyID1cbiAgICAgICAgICAgIGV2ZW50IGluc3RhbmNlb2YgTW91c2VFdmVudCA/IGV2ZW50LnBhZ2VZIDogZXZlbnQudGFyZ2V0VG91Y2hlc1swXS5wYWdlWTsgLy8gWSBwb3NpdGlvbiBvZiB0aGUgbW91c2Vkb3duXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBlcmZvcm0gdGhlIHJlc2l6aW5nIG9uIGV2ZXJ5IG1vdXNlIG1vdXZlbWVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gZXZcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IGRvUmVzaXplID0gKGV2OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFk6IG51bWJlciA9XG4gICAgICAgICAgICAgICAgZXYgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ID8gZXYucGFnZVkgOiBldi50YXJnZXRUb3VjaGVzWzBdLnBhZ2VZO1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0OiBudW1iZXIgPSBzdGFydFkgLSBjdXJyZW50WTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuaGVpZ2h0ID0gdGhpcy5faGVpZ2h0T25MYXN0TW91c2Vkb3duICsgb2Zmc2V0O1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcCByZXNpemluZyBvbiBtb3VzZSB1cFxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3Qgc3RvcFJlc2l6ZSA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBkb1Jlc2l6ZSwgZmFsc2UpO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzdG9wUmVzaXplLCBmYWxzZSk7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZG9SZXNpemUsIGZhbHNlKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHN0b3BSZXNpemUsIGZhbHNlKTtcbiAgICAgICAgfTtcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZG9SZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN0b3BSZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZG9SZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBzdG9wUmVzaXplKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIHRoZSBgY2xvc2VkYCBzdGF0ZSBvZiB0aGUgRGV2VG9vbHMgKG9ubHkgb24gYSBzaW1wbGUgY2xpY2s6IG5vdFxuICAgICAqIGlmIHNvbWUgcmVzaXppbmcgb2NjdXJyZWQgYmV0d2VlbiBtb3VzZWRvd24gYW5kIG1vdXNldXApXG4gICAgICovXG4gICAgdG9nZ2xlQ2xvc2VkKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRpZEp1c3RSZXNpemUgPSB0aGlzLl9oZWlnaHRPbkxhc3RNb3VzZWRvd24gIT09IHRoaXMuc3RhdGUuaGVpZ2h0O1xuICAgICAgICBjb25zdCBpc09uQnV0dG9uID0gbm9kZU5hbWUoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KSA9PT0gJ0RFVlRPT0xTLUJVVFRPTic7XG4gICAgICAgIGlmICghZGlkSnVzdFJlc2l6ZSAmJiAhKGlzT25CdXR0b24gJiYgIXRoaXMuc3RhdGUuY2xvc2VkKSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5jbG9zZWQgPSAhdGhpcy5zdGF0ZS5jbG9zZWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmludGVyZmFjZSBJbmZvU3RhdGUge1xuICAgIGN1cnJlbnRUYWI6IHN0cmluZztcbn1cbmV4cG9ydCBjbGFzcyBJbmZvQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PHt9PiB7XG4gICAgYWJvdXRNZVByb3BzID0gWydpZCcsICduYW1lJywgJ2xlbmd0aCcsICdhdG9taWMnLCAnbW9kaWZpZXJzJ107XG4gICAgZmFtaWx5UHJvcHMgPSBbJ3BhcmVudCcsICdjaGlsZHJlbicsICdzaWJsaW5ncyddO1xuICAgIGN1c3RvbVByb3BzQmxhY2tsaXN0ID0gdGhpcy5hYm91dE1lUHJvcHMuY29uY2F0KHRoaXMuZmFtaWx5UHJvcHMpLmNvbmNhdChbJ2NoaWxkVk5vZGVzJ10pO1xuICAgIHN0YXRlOiBJbmZvU3RhdGUgPSB7XG4gICAgICAgIGN1cnJlbnRUYWI6ICd2Tm9kZScsXG4gICAgfTtcbiAgICBsb2NhbFN0b3JhZ2UgPSBbJ2N1cnJlbnRUYWInXTtcbiAgICAvKipcbiAgICAgKiBPcGVuIHRoZSB0YWIgd2l0aCB0aGUgZ2l2ZW4gYHRhYk5hbWVgXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGFiTmFtZVxuICAgICAqL1xuICAgIG9wZW5UYWIodGFiTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFRhYiA9IHRhYk5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyaWdnZXIgYSAnbm9kZS1zZWxlY3RlZCcgY3VzdG9tIGV2ZW50XG4gICAgICogd2l0aCB0aGUgZ2l2ZW4gYHZOb2RlYCB0byBzZWxlY3QgaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IHZOb2RlXG4gICAgICovXG4gICAgc2VsZWN0Tm9kZSh2Tm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdub2RlLXNlbGVjdGVkJywge1xuICAgICAgICAgICAgdk5vZGU6IHZOb2RlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBjbGFzcyBvZiB0aGUgZ2l2ZW4gVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdk5vZGVcbiAgICAgKi9cbiAgICBjbGFzc05hbWUodk5vZGU6IFZOb2RlKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHZOb2RlLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGNvbnRlbnRzIG9mIGEgcHJvcGVydHkgb2YgYSBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqIEBwYXJhbSBwcm9wTmFtZVxuICAgICAqL1xuICAgIHByb3BSZXByKHZOb2RlOiBWTm9kZSwgcHJvcE5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9wID0gdk5vZGVbcHJvcE5hbWVdO1xuICAgICAgICBpZiAocHJvcE5hbWUgPT09ICdhdG9taWMnKSB7XG4gICAgICAgICAgICBpZiAodk5vZGUgaW5zdGFuY2VvZiBBdG9taWNOb2RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0cnVlJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodk5vZGUgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdmYWxzZSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocHJvcE5hbWUgPT09ICdtb2RpZmllcnMnKSB7XG4gICAgICAgICAgICBpZiAoIXZOb2RlLm1vZGlmaWVycy5sZW5ndGgpIHJldHVybiAnW10nO1xuICAgICAgICAgICAgcmV0dXJuIGBbICR7dk5vZGUubW9kaWZpZXJzLm1hcChtID0+IG0udG9TdHJpbmcoKSkuam9pbignLCAnKX0gXWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoe30udG9TdHJpbmcuY2FsbChwcm9wKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJykge1xuICAgICAgICAgICAgICAgIHByb3AgPSB2Tm9kZVtwcm9wTmFtZV0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm9wUmVwcihwcm9wKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgZ2l2ZW4gVk5vZGUncyBwdWJsaWMgcHJvcGVydGllcyBhc1xuICAgICAqIGFscGhhYmV0aWNhbGx5IHNvcnRlZCBwYWlycyBvZiBrZXkgYW5kIHZhbHVlIHN0cmluZ3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdk5vZGVcbiAgICAgKi9cbiAgICBub2RlUHJvcGVydGllcyh2Tm9kZTogVk5vZGUpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9W10ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModk5vZGUpXG4gICAgICAgICAgICAuZmlsdGVyKGtleSA9PiAha2V5LnN0YXJ0c1dpdGgoJ18nKSAmJiAhdGhpcy5jdXN0b21Qcm9wc0JsYWNrbGlzdC5pbmNsdWRlcyhrZXkpKVxuICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgLm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGtleToga2V5LCB2YWx1ZTogdGhpcy5fcHJvcFJlcHIodk5vZGVba2V5XSkgfTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGlzIG5vZGUgYW5kIGFsbCBpdHMgZGVzY2VuZGVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gX19jdXJyZW50XG4gICAgICovXG4gICAgdG90YWxMZW5ndGgodk5vZGU6IFZOb2RlLCBfX2N1cnJlbnQgPSAwKTogbnVtYmVyIHtcbiAgICAgICAgX19jdXJyZW50ICs9IHZOb2RlLmxlbmd0aDtcbiAgICAgICAgdk5vZGUuY2hpbGRyZW4oKS5mb3JFYWNoKChjaGlsZDogVk5vZGUpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGlmIChjaGlsZC5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgX19jdXJyZW50ID0gdGhpcy50b3RhbExlbmd0aChjaGlsZCwgX19jdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2N1cnJlbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvZyBhIGBWTm9kZWAgdG8gdGhlIGNvbnNvbGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdk5vZGVcbiAgICAgKi9cbiAgICBsb2dWTm9kZSh2Tm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2codk5vZGUpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgX3JlcHIodk5vZGU6IFZOb2RlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSB2Tm9kZS5uZXh0U2libGluZygpO1xuICAgICAgICBjb25zdCBwcmV2U2libGluZyA9IHZOb2RlLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IG5leHRTaWJsaW5nID8gJ0JFRk9SRScgOiBwcmV2U2libGluZyA/ICdBRlRFUicgOiAnSU5TSURFJztcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlID0gbmV4dFNpYmxpbmcgfHwgcHJldlNpYmxpbmcgfHwgdk5vZGUucGFyZW50O1xuICAgICAgICBpZiAocmVmZXJlbmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7cG9zaXRpb259ICR7cmVmZXJlbmNlLmlkfSAoJHtyZWZlcmVuY2UubmFtZX0pYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnTm90IGluIFZEb2N1bWVudCc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY29udGVudHMgb2YgYSBwcm9wZXJ0eSBvZiBhIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZOb2RlXG4gICAgICogQHBhcmFtIHByb3BOYW1lXG4gICAgICovXG4gICAgX3Byb3BSZXByKHByb3ApOiBzdHJpbmcge1xuICAgICAgICBsZXQgdmFsdWUgPSAnJyArIHByb3A7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHByb3ApICYmICFwcm9wLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gJ1tdJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gJ251bGwnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICd1bmRlZmluZWQnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wIGluc3RhbmNlb2YgU2V0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICBwcm9wLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXByb3AgfHwgIU9iamVjdC5rZXlzKHByb3ApLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gJ3t9JztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcC50b1N0cmluZyA9PT0ge30udG9TdHJpbmcpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX29iamVjdFJlcHIocHJvcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb3AgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9ICdcIicgKyB2YWx1ZSArICdcIic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50aW5nIGFsbCBrZXkvdmFsdWUgcGFpcnMgb2YgYW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHZOb2RlXG4gICAgICogQHBhcmFtIHByb3BOYW1lXG4gICAgICovXG4gICAgX29iamVjdFJlcHIob2JqOiBvYmplY3QpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKVxuICAgICAgICAgICAgLmZpbHRlcihrZXkgPT4ga2V5ICE9PSAndG9TdHJpbmcnKVxuICAgICAgICAgICAgLm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBrZXkgKyAnOiAnICsgb2JqW2tleV07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEluZm9Db21wb25lbnQgfSBmcm9tICcuL0luZm9Db21wb25lbnQnO1xuaW1wb3J0IHsgUGF0aENvbXBvbmVudCB9IGZyb20gJy4vUGF0aENvbXBvbmVudCc7XG5pbXBvcnQgeyBUcmVlQ29tcG9uZW50IH0gZnJvbSAnLi9UcmVlQ29tcG9uZW50JztcbmltcG9ydCB7IE93bENvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1vd2wvc3JjL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBjYXJldFBvc2l0aW9uRnJvbVBvaW50IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL3BvbHlmaWxsJztcbmltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWNoYXIvc3JjL0NoYXJOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuY29uc3QgaG92ZXJTdHlsZSA9ICdib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxMDB2aCByZ2JhKDk1LCAxNDYsIDIwNCwgMC41KTsgY3Vyc29yOiBwb2ludGVyOyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5zcGVjdG9yU3RhdGUge1xuICAgIHNlbGVjdGVkSUQ6IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIEluc3BlY3RvckNvbXBvbmVudFByb3BzIGV4dGVuZHMgSW5zcGVjdG9yU3RhdGUge1xuICAgIHJvb3Q6IFZOb2RlO1xufVxuXG5leHBvcnQgY2xhc3MgSW5zcGVjdG9yQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PEluc3BlY3RvckNvbXBvbmVudFByb3BzPiB7XG4gICAgc3RhdGljIGNvbXBvbmVudHMgPSB7IEluZm9Db21wb25lbnQsIFBhdGhDb21wb25lbnQsIFRyZWVDb21wb25lbnQgfTtcbiAgICBkb21FbmdpbmUgPSB0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KS5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG5cbiAgICBwcml2YXRlIF9ob3ZlcmVkVGFyZ2V0czoge1xuICAgICAgICBlbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgICAgICAgb2xkU3R5bGU6IHN0cmluZztcbiAgICB9W10gPSBbXTtcblxuICAgIHN0YXRlOiBJbnNwZWN0b3JTdGF0ZSA9IHtcbiAgICAgICAgc2VsZWN0ZWRJRDogdGhpcy5kb21FbmdpbmUuY29tcG9uZW50cy5lZGl0YWJsZVswXT8uaWQgfHwgdGhpcy5kb21FbmdpbmUucm9vdC5pZCxcbiAgICB9O1xuICAgIHNlbGVjdGVkTm9kZSA9IHRoaXMuZ2V0Tm9kZSh0aGlzLnN0YXRlLnNlbGVjdGVkSUQpO1xuICAgIHByaXZhdGUgX2luc3BlY3RpbmcgPSBuZXcgU2V0PERvY3VtZW50IHwgU2hhZG93Um9vdD4oKTtcblxuICAgIGNvbnN0cnVjdG9yKHBhcmVudD86IE93bENvbXBvbmVudDx7fT4sIHByb3BzPzogSW5zcGVjdG9yQ29tcG9uZW50UHJvcHMpIHtcbiAgICAgICAgc3VwZXIocGFyZW50LCBwcm9wcyk7XG4gICAgICAgIHRoaXMuX29uSW5zcGVjdG9yTW91c2VFbnRlciA9IHRoaXMuX29uSW5zcGVjdG9yTW91c2VFbnRlci5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTW92ZSA9IHRoaXMuX29uSW5zcGVjdG9yTW91c2VNb3ZlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX29uSW5zcGVjdG9yTW91c2VMZWF2ZSA9IHRoaXMuX29uSW5zcGVjdG9yTW91c2VMZWF2ZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vbkluc3BlY3Rvck1vdXNlRG93biA9IHRoaXMuX29uSW5zcGVjdG9yTW91c2VEb3duLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX29uSW5zcGVjdG9yQ2xpY2sgPSB0aGlzLl9vbkluc3BlY3RvckNsaWNrLmJpbmQodGhpcyk7XG4gICAgfVxuICAgIHdpbGxVbm1vdW50KCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9ob3ZlcmVkVGFyZ2V0cyA9IFtdO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZSA9IG51bGw7XG4gICAgfVxuICAgIGFzeW5jIHJlbmRlcihmb3JjZSA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHN1cGVyLnJlbmRlcihmb3JjZSk7XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignZGV2dG9vbHMtbm9kZW5hbWUuc2VsZWN0ZWQnKT8uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUga2V5Ym9hcmQgbmF2aWdhdGlvbiBpbiBEZXZUb29scyAoYXJyb3dzIHRvIG1vdmUgaW4gdGhlIHRyZWUpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgb25LZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkOiBWTm9kZSA9IHRoaXMuZ2V0Tm9kZSh0aGlzLnN0YXRlLnNlbGVjdGVkSUQpO1xuICAgICAgICBsZXQgbmV3U2VsZWN0aW9uOiBWTm9kZTtcbiAgICAgICAgc3dpdGNoIChldmVudC5jb2RlKSB7XG4gICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgICAgIG5ld1NlbGVjdGlvbiA9IHNlbGVjdGVkLm5leHRTaWJsaW5nKCkgfHwgc2VsZWN0ZWQuZmlyc3RDaGlsZCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgbmV3U2VsZWN0aW9uID0gc2VsZWN0ZWQucHJldmlvdXNTaWJsaW5nKCkgfHwgc2VsZWN0ZWQucGFyZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dMZWZ0JzpcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3Rpb24gPSBzZWxlY3RlZC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgICAgICAgIG5ld1NlbGVjdGlvbiA9IHNlbGVjdGVkLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZElEID0gbmV3U2VsZWN0aW9uLmlkO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUgPSB0aGlzLmdldE5vZGUodGhpcy5zdGF0ZS5zZWxlY3RlZElEKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHNlbGVjdGlvbiBvZiBhIG5vZGUuIEEgc3ViY29tcG9uZW50IHRyaWdnZXJzIGEgJ3NlbGVjdC1ub2RlJ1xuICAgICAqIGN1c3RvbSBldmVudCBhbmQgdGhpcyBtZXRob2QgbGlzdGVucyB0byBpdCwgcmV0cmlldmVzIHRoZSBgdk5vZGVgIHRoYXQgaXRcbiAgICAgKiBwYXNzZXMgaW4gaXRzIGBkZXRhaWxgIGtleSwgYW5kIG1vZGlmaWVzIGl0cyBzdGF0ZSB0byBhY2NvdW50IGZvciB0aGVcbiAgICAgKiBjaGFuZ2UgaW4gc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtDdXN0b21FdmVudH0gZXZlbnRcbiAgICAgKiBAcGFyYW0ge1ZOb2RlfSBldmVudC5kZXRhaWwudk5vZGVcbiAgICAgKi9cbiAgICBzZWxlY3ROb2RlKGV2ZW50OiBDdXN0b21FdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkSUQgPSBldmVudC5kZXRhaWwudk5vZGUuaWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlID0gdGhpcy5nZXROb2RlKHRoaXMuc3RhdGUuc2VsZWN0ZWRJRCk7XG4gICAgfVxuICAgIGdldE5vZGUoaWQ6IG51bWJlcik6IFZOb2RlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9tRW5naW5lLnJvb3QuZGVzY2VuZGFudHMobm9kZSA9PiBub2RlLmlkID09PSBpZClbMF0gfHwgdGhpcy5kb21FbmdpbmUucm9vdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBwYXRoIGJldHdlZW4gdGhlIGdpdmVuIGB2Tm9kZWAgYW5kIHRoZSByb290IHZOb2RlLCBhcyBhbiBhcnJheVxuICAgICAqIG9mIFZOb2RlLCBzb3J0ZWQgZnJvbSB0aGUgaGlnaGVzdCBwYXJlbnQgKHRoZSByb290KSB0byB0aGUgZ2l2ZW4gdk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1ZOb2RlfSB2Tm9kZVxuICAgICAqIEByZXR1cm5zIHtWTm9kZSBbXX1cbiAgICAgKi9cbiAgICBnZXRQYXRoKHZOb2RlOiBWTm9kZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBwYXRoOiBWTm9kZVtdID0gW3ZOb2RlXTtcbiAgICAgICAgbGV0IHBhcmVudDogVk5vZGUgPSB2Tm9kZS5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhdGgudW5zaGlmdChwYXJlbnQpO1xuICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICB9XG5cbiAgICBwYXRjaGVkKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5wYXRjaGVkKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgICAvL3NlbGVjdGVkLnNjcm9sbEludG9WaWV3KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCaW5kIG1vdXNlIGhhbmRsZXIgdG8gYWxsb3cgdGhlIHNlbGVjdGlvbiBvZiB0aGUgbm9kZSBpbiB0aGUgZGV2dG9vbHMgaW5zcGVjdG9yLlxuICAgICAqIFdoZW4gdGhlIG1vdXNlIHdpbGwgbW92ZSwgd2UgYWRkIGEgY2xhc3MgdG8gaGlnaGxpZ2h0IHRoZSB0YXJnZXRlZCBub2RlIChsaW5rZWQgdG8gVk5vZGUpLlxuICAgICAqIFdpbGwgYmUgdW5iaW5kIHdoZW4gdGhlIHVzZXIgY2xpY2sgaW5zaWRlIHRoZSBkb20uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBpbnNwZWN0RG9tKGRvYzogRG9jdW1lbnQgfCBTaGFkb3dSb290ID0gZG9jdW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pbnNwZWN0aW5nLmhhcyhkb2MpKSB7XG4gICAgICAgICAgICB0aGlzLl9pbnNwZWN0aW5nLmFkZChkb2MpO1xuICAgICAgICAgICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLl9vbkluc3BlY3Rvck1vdXNlRW50ZXIsIHRydWUpO1xuICAgICAgICAgICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX29uSW5zcGVjdG9yTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5fb25JbnNwZWN0b3JNb3VzZUxlYXZlLCB0cnVlKTtcbiAgICAgICAgICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9vbkluc3BlY3Rvck1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICAgICAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkluc3BlY3RvckNsaWNrLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfb25JbnNwZWN0b3JNb3VzZUVudGVyKGV2OiBNb3VzZUV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGVsID0gZXYudGFyZ2V0IGFzIEVsZW1lbnQ7XG4gICAgICAgIGlmIChub2RlTmFtZShlbCkgPT09ICdJRlJBTUUnKSB7XG4gICAgICAgICAgICBjb25zdCBkb2MgPSAoZXYudGFyZ2V0IGFzIEhUTUxJRnJhbWVFbGVtZW50KS5jb250ZW50V2luZG93Py5kb2N1bWVudDtcbiAgICAgICAgICAgIGlmIChkb2MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluc3BlY3REb20oZG9jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChlbC5zaGFkb3dSb290KSB7XG4gICAgICAgICAgICB0aGlzLmluc3BlY3REb20oZWwuc2hhZG93Um9vdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgY2xhc3MgdG8gaGlnaGxpZ2h0IHRoZSB0YXJnZXRlZCBub2RlIChsaWtlIHRvIFZOb2RlKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgX29uSW5zcGVjdG9yTW91c2VNb3ZlKGV2OiBNb3VzZUV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBmb3IgKGNvbnN0IGluc3BlY3RlZCBvZiB0aGlzLl9ob3ZlcmVkVGFyZ2V0cykge1xuICAgICAgICAgICAgaW5zcGVjdGVkLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsIGluc3BlY3RlZC5vbGRTdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faG92ZXJlZFRhcmdldHMgPSBbXTtcblxuICAgICAgICBjb25zdCBlbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5fZ2V0Tm9kZUZyb21Qb3NpdGlvbihcbiAgICAgICAgICAgIGV2LmNsaWVudFgsXG4gICAgICAgICAgICBldi5jbGllbnRZLFxuICAgICAgICAgICAgKGV2LnRhcmdldCBhcyBOb2RlKS5vd25lckRvY3VtZW50LFxuICAgICAgICApKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgdGhpcy5kb21FbmdpbmUuZ2V0RG9tTm9kZXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9tTm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ID8gZG9tTm9kZSA6IGRvbU5vZGUucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoIWVsZW1lbnRzLmluY2x1ZGVzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50cykge1xuICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnc3R5bGUnKSB8fCAnJztcbiAgICAgICAgICAgIHRoaXMuX2hvdmVyZWRUYXJnZXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgb2xkU3R5bGU6IHN0eWxlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBzdHlsZSArICc7JyArIGhvdmVyU3R5bGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIHJlbW92ZSBjbGFzcyB0byByZW1vdmUgdGhlIGhpZ2hsaWdodC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIHByaXZhdGUgX29uSW5zcGVjdG9yTW91c2VMZWF2ZShldjogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZm9yIChjb25zdCBpbnNwZWN0ZWQgb2YgdGhpcy5faG92ZXJlZFRhcmdldHMpIHtcbiAgICAgICAgICAgIGlmIChpbnNwZWN0ZWQuZWxlbWVudCA9PT0gZXYudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faG92ZXJlZFRhcmdldHMuc3BsaWNlKHRoaXMuX2hvdmVyZWRUYXJnZXRzLmluZGV4T2YoaW5zcGVjdGVkKSwgMSk7XG4gICAgICAgICAgICAgICAgaW5zcGVjdGVkLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsIGluc3BlY3RlZC5vbGRTdHlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJldmVudCBkZWZhdWx0IGJlaGF2aW9yIChkb21FZGl0YWJsZSBub3JtYWxpc2F0aW9uKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIHByaXZhdGUgX29uSW5zcGVjdG9yTW91c2VEb3duKGV2OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICBwcml2YXRlIF9nZXROb2RlRnJvbVBvc2l0aW9uKGNsaWVudFg6IG51bWJlciwgY2xpZW50WTogbnVtYmVyLCBkb2M6IERvY3VtZW50KTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IGNhcmV0UG9zaXRpb24gPSBjYXJldFBvc2l0aW9uRnJvbVBvaW50KGNsaWVudFgsIGNsaWVudFksIGRvYyk7XG4gICAgICAgIGxldCBub2RlID0gY2FyZXRQb3NpdGlvbj8ub2Zmc2V0Tm9kZTtcbiAgICAgICAgbGV0IG5vZGVzID0gW107XG4gICAgICAgIHdoaWxlICghbm9kZXMubGVuZ3RoICYmIG5vZGUpIHtcbiAgICAgICAgICAgIG5vZGVzID0gdGhpcy5kb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSk7XG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2Rlc1swXSBpbnN0YW5jZW9mIENoYXJOb2RlICYmIG5vZGVzW2NhcmV0UG9zaXRpb24ub2Zmc2V0XSkge1xuICAgICAgICAgICAgcmV0dXJuIFtub2Rlc1tjYXJldFBvc2l0aW9uLm9mZnNldF1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSB0YXJnZXRlZCBub2RlIGluIHRoZSBkZXZ0b29scyBpbnNwZWN0b3IgYW5kIHVuYmluZCB0aGUgbW91c2UgaGFuZGxlclxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBfb25JbnNwZWN0b3JDbGljayhldjogTW91c2VFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiB0aGlzLl9pbnNwZWN0aW5nKSB7XG4gICAgICAgICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHRoaXMuX29uSW5zcGVjdG9yTW91c2VFbnRlciwgdHJ1ZSk7XG4gICAgICAgICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5fb25JbnNwZWN0b3JNb3VzZU1vdmUsIHRydWUpO1xuICAgICAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTGVhdmUsIHRydWUpO1xuICAgICAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX29uSW5zcGVjdG9yTW91c2VEb3duLCB0cnVlKTtcbiAgICAgICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uSW5zcGVjdG9yQ2xpY2ssIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2luc3BlY3RpbmcuY2xlYXIoKTtcbiAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGZvciAoY29uc3QgaW5zcGVjdGVkIG9mIHRoaXMuX2hvdmVyZWRUYXJnZXRzKSB7XG4gICAgICAgICAgICBpbnNwZWN0ZWQuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaW5zcGVjdGVkLm9sZFN0eWxlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9ob3ZlcmVkVGFyZ2V0cyA9IFtdO1xuXG4gICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5fZ2V0Tm9kZUZyb21Qb3NpdGlvbihcbiAgICAgICAgICAgIGV2LmNsaWVudFgsXG4gICAgICAgICAgICBldi5jbGllbnRZLFxuICAgICAgICAgICAgKGV2LnRhcmdldCBhcyBOb2RlKS5vd25lckRvY3VtZW50LFxuICAgICAgICApO1xuICAgICAgICBpZiAobm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkSUQgPSBub2Rlc1swXS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlID0gdGhpcy5nZXROb2RlKHRoaXMuc3RhdGUuc2VsZWN0ZWRJRCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IGNsYXNzIE1vZGVzQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PHt9PiB7XG4gICAgbW9kZXMgPSB0aGlzLmVudi5lZGl0b3IubW9kZXM7XG4gICAgbG9jYWxTdG9yYWdlID0gWydjdXJyZW50VGFiJ107XG4gICAgc3RhdGUgPSB7XG4gICAgICAgIHNlbGVjdGVkTW9kZTogbnVsbCxcbiAgICAgICAgY3VycmVudE1vZGU6IHRoaXMuZW52LmVkaXRvci5tb2RlLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSBtb2RlIGF0IGdpdmVuIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4XG4gICAgICovXG4gICAgc2VsZWN0TW9kZUJ5SW5kZXgoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkTW9kZSA9IHRoaXMubW9kZXNbT2JqZWN0LmtleXModGhpcy5tb2RlcylbaW5kZXhdXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSBtb2RlIHdpdGggZ2l2ZW4gaWRlbnRpZmllci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtb2RlSWRlbnRpZmllclxuICAgICAqL1xuICAgIHNlbGVjdE1vZGUobW9kZUlkZW50aWZpZXI6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkTW9kZSA9IHRoaXMubW9kZXNbbW9kZUlkZW50aWZpZXJdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUga2V5ZG93biBldmVudCB0byBuYXZpZ2F0ZSBpbiB0aGUgbW9kZXMgbGlzdC5cbiAgICAgKi9cbiAgICBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kZUlkZW50aWZpZXJzID0gT2JqZWN0LmtleXModGhpcy5tb2Rlcyk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRNb2RlSW5kZXggPSBtb2RlSWRlbnRpZmllcnMuZmluZEluZGV4KFxuICAgICAgICAgICAga2V5ID0+IGtleSA9PT0gdGhpcy5zdGF0ZS5zZWxlY3RlZE1vZGUuaWQsXG4gICAgICAgICk7XG4gICAgICAgIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RNb2RlQnlJbmRleChNYXRoLm1pbihjdXJyZW50TW9kZUluZGV4ICsgMSwgbW9kZUlkZW50aWZpZXJzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dVcCcpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0TW9kZUJ5SW5kZXgoTWF0aC5tYXgoY3VycmVudE1vZGVJbmRleCAtIDEsIDApKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gICAgc2V0TW9kZShtb2RlSWRlbnRpZmllcjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW52LmVkaXRvci5zZXRNb2RlKG1vZGVJZGVudGlmaWVyKTtcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50TW9kZSA9IHRoaXMuZW52LmVkaXRvci5tb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2cgYSBzZWxlY3RvciB0byB0aGUgY29uc29sZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWxlY3RvclxuICAgICAqL1xuICAgIGxvZ1NlbGVjdG9yKHNlbGVjdG9yOiBQcmVkaWNhdGVbXSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3Rvcik7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLW93bC9zcmMvT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBQYXRoQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PHt9PiB7XG4gICAgZ2V0Tm9kZVJlcHIodk5vZGU6IFZOb2RlKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF2Tm9kZS5pZCkge1xuICAgICAgICAgICAgcmV0dXJuICdkZWF0aC1WTm9kZTogJyArIHZOb2RlLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlcHI6IHN0cmluZyA9IHZOb2RlLm5hbWUgfHwgJz8nO1xuICAgICAgICBmb3IgKGNvbnN0IGZvcm1hdCBvZiB2Tm9kZS5tb2RpZmllcnMuZmlsdGVyKEZvcm1hdCkpIHtcbiAgICAgICAgICAgIHJlcHIgKz0gJy4nICsgZm9ybWF0Lm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcHI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyaWdnZXIgYSAnbm9kZS1zZWxlY3RlZCcgY3VzdG9tIGV2ZW50XG4gICAgICogd2l0aCB0aGUgZ2l2ZW4gYHZOb2RlYCB0byBzZWxlY3QgaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IHZOb2RlXG4gICAgICovXG4gICAgc2VsZWN0Tm9kZSh2Tm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdub2RlLXNlbGVjdGVkJywge1xuICAgICAgICAgICAgdk5vZGU6IHZOb2RlLFxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xDb21wb25lbnQnO1xuXG5leHBvcnQgY2xhc3MgUGx1Z2luc0NvbXBvbmVudCBleHRlbmRzIE93bENvbXBvbmVudDx7fT4ge1xuICAgIHBsdWdpbnMgPSBBcnJheS5mcm9tKHRoaXMuZW52LmVkaXRvci5wbHVnaW5zLnZhbHVlcygpKVxuICAgICAgICAubWFwKHBsdWdpbiA9PiBwbHVnaW4uY29uc3RydWN0b3IubmFtZSlcbiAgICAgICAgLnNvcnQoKTtcbiAgICBsb2NhbFN0b3JhZ2UgPSBbJ2N1cnJlbnRUYWInXTtcbn1cbiIsImltcG9ydCB7IE93bENvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1vd2wvc3JjL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgYXJnc1JlcHIgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBmbGF0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNob3J0Y3V0c0NvbXBvbmVudCBleHRlbmRzIE93bENvbXBvbmVudDx7fT4ge1xuICAgIG1hcHBpbmdzID0gZmxhdCh0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoS2V5bWFwKS5tYXBwaW5ncykuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBpZiAoYS5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQgPCBiLmNvbmZpZ3VyZWRDb21tYW5kLmNvbW1hbmRJZCkgcmV0dXJuIC0xO1xuICAgICAgICBpZiAoYS5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQgPiBiLmNvbmZpZ3VyZWRDb21tYW5kLmNvbW1hbmRJZCkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH0pO1xuICAgIGxvY2FsU3RvcmFnZSA9IFsnY3VycmVudFRhYiddO1xuICAgIGFyZ3NSZXByID0gYXJnc1JlcHI7XG4gICAgc3RyaW5naWZ5UGF0dGVybiA9IHRoaXMuZW52LmVkaXRvci5wbHVnaW5zLmdldChLZXltYXApLnN0cmluZ2lmeVBhdHRlcm47XG59XG4iLCJpbXBvcnQgeyB0b1VuaWNvZGUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLW93bC9zcmMvT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFZTZWxlY3Rpb25EZXNjcmlwdGlvbiwgRGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBBTkNIT1JfQ0hBUiwgRk9DVVNfQ0hBUiB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgQ29yZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuXG5pbnRlcmZhY2UgTm9kZVByb3BzIHtcbiAgICBpc1Jvb3Q6IGJvb2xlYW47XG4gICAgdk5vZGU6IFZOb2RlO1xuICAgIHNlbGVjdGVkUGF0aDogVk5vZGVbXTtcbn1cblxuaW50ZXJmYWNlIE5vZGVTdGF0ZSB7XG4gICAgZm9sZGVkOiBib29sZWFuO1xufVxuXG4vKipcbiAqIE5vdGU6IGBUcmVlQ29tcG9uZW50YCByZXF1aXJlcyB0aHJlZSBwcm9wZXJ0aWVzIHBhc3NlZCBieSB0aGUgcGFyZW50XG4gKiAgICAgICBDb21wb25lbnQgKGBEZXZUb29sc0NvbXBvbmVudGApIHZpYSB0aGUgdGVtcGxhdGUgKHNlZSBgRGV2VG9vbHMueG1sYCk6XG4gKiAgICAgICAtIHZOb2RlOiBWTm9kZVxuICogICAgICAgLSBpc1Jvb3Q6IGJvb2xlYW5cbiAqICAgICAgIC0gc2VsZWN0ZWRJRDogbnVtYmVyICh0aGUgSUQgb2YgdGhlIHNlbGVjdGVkIFZOb2RlKVxuICovXG5leHBvcnQgY2xhc3MgVHJlZUNvbXBvbmVudCBleHRlbmRzIE93bENvbXBvbmVudDxOb2RlUHJvcHM+IHtcbiAgICAvLyBUaGlzIGlzIGEgcmVjdXJzaXZlIENvbXBvbmVudDogZWFjaCBub2RlIG9mIHRoZSB0cmVlIGlzIGl0c2VsZiBhIHRyZWVcbiAgICBzdGF0aWMgY29tcG9uZW50cyA9IHsgVHJlZUNvbXBvbmVudCB9O1xuICAgIC8vIFVzZXItZnJpZW5kbHkgcmVwcmVzZW50YXRpb24gb2YgdGhlIG5vZGVcbiAgICBfcmVwcjogc3RyaW5nID0gdGhpcy5fZ2V0Tm9kZVJlcHIodGhpcy5wcm9wcy52Tm9kZSk7XG4gICAgc3RhdGU6IE5vZGVTdGF0ZSA9IHtcbiAgICAgICAgLy8gU2hvdyB0aGUgc2VsZWN0ZWQgbm9kZSBhbmQgcm9vdCBieSBkZWZhdWx0XG4gICAgICAgIGZvbGRlZDogIXRoaXMucHJvcHMuaXNSb290ICYmICF0aGlzLnByb3BzLnNlbGVjdGVkUGF0aC5pbmNsdWRlcyh0aGlzLnByb3BzLnZOb2RlKSxcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBgc3RhdGUuZm9sZGVkYCB3aGVuIGBwcm9wcy5zZWxlY3RlZFBhdGhgIGNoYW5nZXMgaWYgYHByb3BzLnZOb2RlYFxuICAgICAqIGlzIGluIGBwcm9wcy5zZWxlY3RlZFBhdGhgLCB1bmxlc3MgaXQgaXMgdGhlIGxhc3QgaXRlbS4gQWxzbyB1cGRhdGVcbiAgICAgKiBgc3RhdGUuZm9sZGVkYCBmb3IgdGhlIGFuY2VzdG9ycyBvZiB0aGUgc2VsZWN0aW9uIG1hcmtlciBub2Rlcy5cbiAgICAgKi9cbiAgICBhc3luYyB3aWxsVXBkYXRlUHJvcHMobmV4dFByb3BzOiBOb2RlUHJvcHMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gVGhlIHNlbGVjdGVkIG5vZGUgaXRzZWxmIHNob3VsZCBzdGF5IGZvbGRlZCBldmVuIHdoZW4gc2VsZWN0ZWQuIE9ubHlcbiAgICAgICAgLy8gdGhlIG5vZGVzIGluIHRoZSBwYXRoIGxlYWRpbmcgdG8gaXQgc2hvdWxkIGFjdHVhbGx5IGJlIHVuZm9sZGVkLiBCeVxuICAgICAgICAvLyBjb25zdHJ1Y3Rpb24sIHRoZSBsYXN0IGl0ZW0gb2YgYHNlbGVjdGVkIHBhdGhgIGlzIGFsd2F5cyB0aGUgc2VsZWN0ZWRcbiAgICAgICAgLy8gbm9kZSBpdHNlbGYgc28gaXQgY2FuIHNhZmVseSBiZSBvbWl0dGVkIGZyb20gdGhlIGNoZWNrLlxuICAgICAgICBjb25zdCBwYXRoID0gbmV4dFByb3BzLnNlbGVjdGVkUGF0aC5zbGljZSgwLCAtMSk7XG4gICAgICAgIGlmIChwYXRoLnNvbWUobm9kZSA9PiBub2RlLmlkID09PSBuZXh0UHJvcHMudk5vZGUuaWQpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmZvbGRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbk1hcmtlcnNQYXRoID0gdGhpcy5fZ2V0U2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycygpO1xuICAgICAgICBpZiAoc2VsZWN0aW9uTWFya2Vyc1BhdGguaGFzKG5leHRQcm9wcy52Tm9kZS5pZCkpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZm9sZGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgYSBjbGljayBldmVudCBvbiBhIG5vZGUgb2YgdGhlIHRyZWU6IHRvZ2dsZSBpdHMgZm9sZCBvbiBjbGljayBpdHNcbiAgICAgKiBjYXJldCwgc2VsZWN0IGl0IG90aGVyd2lzZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudFxuICAgICAqL1xuICAgIG9uQ2xpY2tOb2RlKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRpZENsaWNrQ2FyZXQ6IGJvb2xlYW4gPSBldmVudC5vZmZzZXRYIDwgMTA7XG4gICAgICAgIGlmIChkaWRDbGlja0NhcmV0KSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUZvbGRlZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdub2RlLXNlbGVjdGVkJywge1xuICAgICAgICAgICAgICAgIHZOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25EYmxDbGlja05vZGUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uOiBWU2VsZWN0aW9uRGVzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICBhbmNob3JOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgZm9jdXNOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbnYuZWRpdG9yLmV4ZWNDb21tYW5kPENvcmU+KCdzZXRTZWxlY3Rpb24nLCB7IHZTZWxlY3Rpb246IGxvY2F0aW9uIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZm9sZGluZy91bmZvbGRpbmcgb24gcHJlc3MgRW50ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZlbnRcbiAgICAgKi9cbiAgICBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUZvbGRlZCgpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVwcigpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy52Tm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcHI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBSZXByZXNlbnRhdGlvbiBvZiBpbnRhbmdpYmxlIG5vZGVzIChlLmcuIG1hcmtlcnMpIG1pZ2h0IGNoYW5nZVxuICAgICAgICAgICAgLy8gZGVwZW5kaW5nIG9uIHRoZSBjb250ZXh0IGluIHdoaWNoIHRoZXkgYXJlIHJlZmVyZW5jZWQsIGV2ZW5cbiAgICAgICAgICAgIC8vIHRob3VnaCB0aGV5IGRpZCBub3QgYWN0dWFsbHkgY2hhbmdlIHBlciBzZS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXROb2RlUmVwcih0aGlzLnByb3BzLnZOb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbmZvbGQgYWxsIG9mIGEgbm9kZSdzIGRpcmVjdCBhbmNlc3RvcnMgb24gc2VsZWN0IGl0XG4gICAgICogVE9ETzogZmluZCBhIHdheSB0byBkbyB0aGlzIGNyb3NzLWNvbXBvbmVudHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q3VzdG9tRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgc2VsZWN0Tm9kZShldmVudDogQ3VzdG9tRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmRldGFpbC52Tm9kZS5pZCAhPT0gdGhpcy5wcm9wcy52Tm9kZS5pZCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5mb2xkZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgdGhlIGBmb2xkZWRgIHByb3BvZXJ0eSBvZiB0aGUgc3RhdGVcbiAgICAgKi9cbiAgICB0b2dnbGVGb2xkZWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuZm9sZGVkID0gIXRoaXMuc3RhdGUuZm9sZGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBoYXMgdGhlIGdpdmVuIGZvcm1hdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgaXNGb3JtYXQobm9kZTogVk5vZGUsIGZvcm1hdE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgbm9kZSBpbnN0YW5jZW9mIElubGluZU5vZGUgJiZcbiAgICAgICAgICAgICEhbm9kZS5tb2RpZmllcnMuZmluZChmb3JtYXQgPT4gZm9ybWF0Lm5hbWUgPT09IGZvcm1hdE5hbWUpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSB1c2VyLWZyaWVuZGx5IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBub2RlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1ZOb2RlfSBub2RlXG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKi9cbiAgICBfZ2V0Tm9kZVJlcHIobm9kZTogVk5vZGUpOiBzdHJpbmcge1xuICAgICAgICBpZiAobm9kZSA9PT0gdGhpcy5lbnYuZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IpIHtcbiAgICAgICAgICAgIHJldHVybiBBTkNIT1JfQ0hBUjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSA9PT0gdGhpcy5lbnYuZWRpdG9yLnNlbGVjdGlvbi5mb2N1cykge1xuICAgICAgICAgICAgcmV0dXJuIEZPQ1VTX0NIQVI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUubmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRvVW5pY29kZShub2RlLm5hbWUpLnJlcGxhY2UoL05vZGUvLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICc/JztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgc2V0IG9mIHRoZSBJRHMgb2YgYWxsIGFuY2VzdG9ycyBvZiBib3RoIHNlbGVjdGlvbiBtYXJrZXIgbm9kZXMuXG4gICAgICovXG4gICAgX2dldFNlbGVjdGlvbk1hcmtlcnNBbmNlc3RvcnMoKTogU2V0PG51bWJlcj4ge1xuICAgICAgICBjb25zdCBzZWxlY3Rpb25NYXJrZXJzQW5jZXN0b3JzID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgICAgIGxldCBhbmNlc3RvcjogVk5vZGUgPSB0aGlzLmVudi5lZGl0b3Iuc2VsZWN0aW9uLmFuY2hvci5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChhbmNlc3Rvcikge1xuICAgICAgICAgICAgc2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycy5hZGQoYW5jZXN0b3IuaWQpO1xuICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgYW5jZXN0b3IgPSB0aGlzLmVudi5lZGl0b3Iuc2VsZWN0aW9uLmZvY3VzLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKGFuY2VzdG9yKSB7XG4gICAgICAgICAgICBzZWxlY3Rpb25NYXJrZXJzQW5jZXN0b3JzLmFkZChhbmNlc3Rvci5pZCk7XG4gICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycztcbiAgICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gYXJnc1JlcHIoYXJnczoge30pOiBzdHJpbmcge1xuICAgIGlmIChhcmdzID09PSB1bmRlZmluZWQpIHJldHVybiAnJztcbiAgICByZXR1cm4gYHsgJHtPYmplY3Qua2V5cyhhcmdzKVxuICAgICAgICAubWFwKGtleSA9PiBrZXkgKyAnOiAnICsgYXJnc1trZXldKVxuICAgICAgICAuam9pbignLCAnKX0gfWA7XG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vRGlhbG9nLmNzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxudmFyIGV4cG9ydGVkID0gY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHt9O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRlZDsiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPGp3LWRpYWxvZz5cXG4gICAgPGp3LWJhY2tkcm9wIGNsYXNzPVxcXCJqdy1jbG9zZVxcXCI+PC9qdy1iYWNrZHJvcD5cXG4gICAgPGp3LWNvbnRlbnQ+XFxuICAgICAgICA8anctYnV0dG9uIGNsYXNzPVxcXCJqdy1jbG9zZVxcXCI+4p2MPC9qdy1idXR0b24+XFxuICAgIDwvanctY29udGVudD5cXG48L2p3LWRpYWxvZz5cXG5cIiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBEaWFsb2dab25lRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0RpYWxvZ1pvbmVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBEaWFsb2dab25lWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9EaWFsb2dab25lWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBEb21MYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0JztcblxuZXhwb3J0IGNsYXNzIERpYWxvZzxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtQYXJzZXIsIFJlbmRlcmVyLCBEb21MYXlvdXRdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0RpYWxvZ1pvbmVYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtEaWFsb2dab25lRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgRGlhbG9nWm9uZU5vZGUgfSBmcm9tICcuL0RpYWxvZ1pvbmVOb2RlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENvbXBvbmVudElkIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBNZXRhZGF0YU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhTm9kZSc7XG5cbmltcG9ydCB0ZW1wbGF0ZSBmcm9tICcuLi9hc3NldHMvRGlhbG9nLnhtbCc7XG5pbXBvcnQgJy4uL2Fzc2V0cy9EaWFsb2cuY3NzJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5jb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdqdy1jb250YWluZXInKTtcbmNvbnRhaW5lci5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcbmNvbnN0IGRpYWxvZyA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZDtcblxuZXhwb3J0IGNsYXNzIERpYWxvZ1pvbmVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gRGlhbG9nWm9uZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIoXG4gICAgICAgIG5vZGU6IERpYWxvZ1pvbmVOb2RlLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+LFxuICAgICk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IGZsb2F0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnanctZGlhbG9nLWNvbnRhaW5lcicpO1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRWTm9kZXMpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZC50YW5naWJsZSB8fCBjaGlsZCBpbnN0YW5jZW9mIE1ldGFkYXRhTm9kZSkge1xuICAgICAgICAgICAgICAgIGlmICghbm9kZS5oaWRkZW4/LltjaGlsZC5pZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQuYXBwZW5kQ2hpbGQoYXdhaXQgdGhpcy5fcmVuZGVyRGlhbG9nKGNoaWxkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdvcmtlci5kZXBlbmRzKGNoaWxkLCBub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZG9tOiBmbG9hdC5jaGlsZE5vZGVzLmxlbmd0aCA/IFtmbG9hdF0gOiBbXSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9yZW5kZXJEaWFsb2cobm9kZTogVk5vZGUpOiBQcm9taXNlPEVsZW1lbnQ+IHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBkaWFsb2cuY2xvbmVOb2RlKHRydWUpIGFzIEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBjbG9uZS5xdWVyeVNlbGVjdG9yKCdqdy1jb250ZW50Jyk7XG4gICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQodGhpcy5lbmdpbmUucmVuZGVyUGxhY2Vob2xkZXIobm9kZSkpO1xuICAgICAgICBsZXQgY29tcG9uZW50SWQ6IENvbXBvbmVudElkO1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lcy5kb20uY29tcG9uZW50cztcbiAgICAgICAgZm9yIChjb25zdCBpZCBpbiBjb21wb25lbnRzKSB7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50c1tpZF0uaW5jbHVkZXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRJZCA9IGlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNsb25lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2OiBNb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldi50YXJnZXQgYXMgRWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqdy1jbG9zZScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kKCdoaWRlJywgeyBjb21wb25lbnRJZDogY29tcG9uZW50SWQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgWm9uZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9ab25lTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dab25lTm9kZSBleHRlbmRzIFpvbmVOb2RlIHt9XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IERpYWxvZ1pvbmVOb2RlIH0gZnJvbSAnLi9EaWFsb2dab25lTm9kZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dab25lWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnVC1ESUFMT0cnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHpvbmVzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgaXRlbS5xdWVyeVNlbGVjdG9yQWxsKCd0W3Qtem9uZV0nKSkge1xuICAgICAgICAgICAgem9uZXMucHVzaChjaGlsZC5nZXRBdHRyaWJ1dGUoJ3Qtem9uZScpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW25ldyBEaWFsb2dab25lTm9kZSh7IG1hbmFnZWRab25lczogem9uZXMgfSldO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IERpdmlkZXJYbWxEb21QYXJzZXIgfSBmcm9tICcuL0RpdmlkZXJYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcblxuZXhwb3J0IGNsYXNzIERpdmlkZXI8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtEaXZpZGVyWG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgRGl2aWRlck5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0RJVicgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBEaXZpZGVyTm9kZSB9IGZyb20gJy4vRGl2aWRlck5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgRGl2aWRlclhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ0RJVic7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPERpdmlkZXJOb2RlW10+IHtcbiAgICAgICAgY29uc3QgZGl2aWRlciA9IG5ldyBEaXZpZGVyTm9kZSgpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRpdmlkZXIubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgZGl2aWRlci5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2RpdmlkZXJdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IERvbUxheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXQnO1xuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBFdmVudE5vcm1hbGl6ZXIsIEV2ZW50QmF0Y2gsIE5vcm1hbGl6ZWRBY3Rpb24gfSBmcm9tICcuL0V2ZW50Tm9ybWFsaXplcic7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgSW5zZXJ0VGV4dFBhcmFtcyB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IFZTZWxlY3Rpb25QYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBEb21MYXlvdXRFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IEpXRWRpdG9yIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUmVsYXRpdmVQb3NpdGlvbiwgUG9pbnQsIFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZSYW5nZSc7XG5pbXBvcnQgeyBSdWxlUHJvcGVydHkgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RlJztcblxuZXhwb3J0IGNsYXNzIERvbUVkaXRhYmxlPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0RvbUxheW91dCwgTGF5b3V0XTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgc2VsZWN0QWxsOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnNlbGVjdEFsbCxcbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgZXZlbnROb3JtYWxpemVyOiBFdmVudE5vcm1hbGl6ZXI7XG5cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KERvbUxheW91dCk7XG4gICAgICAgIHRoaXMuZXZlbnROb3JtYWxpemVyID0gbmV3IEV2ZW50Tm9ybWFsaXplcihcbiAgICAgICAgICAgIGRvbUxheW91dC5pc0luRWRpdGFibGUuYmluZChkb21MYXlvdXQpLFxuICAgICAgICAgICAgdGhpcy5fb25Ob3JtYWxpemVkRXZlbnQuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBoYW5kbGU6IHRoaXMuX3Byb2Nlc3NLZXlkb3duLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgaGFuZGxlQ2FwdHVyZTogZG9tTGF5b3V0LnByb2Nlc3NLZXlkb3duLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgYXN5bmMgc3RvcCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5ldmVudE5vcm1hbGl6ZXIuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gc3VwZXIuc3RvcCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgc2VsZWN0aW9uIGluIHN1Y2ggYSB3YXkgdGhhdCBpdCBzZWxlY3RzIHRoZSBlbnRpcmUgZG9jdW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgc2VsZWN0QWxsKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB1bmJyZWFrYWJsZUFuY2VzdG9yID0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnN0YXJ0LmFuY2VzdG9yKFxuICAgICAgICAgICAgbm9kZSA9PiAhdGhpcy5lZGl0b3IubW9kZS5pcyhub2RlLCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSxcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgZG9tRW5naW5lID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KExheW91dCkuZW5naW5lcy5kb207XG4gICAgICAgIGNvbnN0IGVkaXRhYmxlID0gZG9tRW5naW5lLmNvbXBvbmVudHMuZWRpdGFibGVbMF07XG4gICAgICAgIHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5zZXQoe1xuICAgICAgICAgICAgYW5jaG9yTm9kZTogdW5icmVha2FibGVBbmNlc3Rvcj8uZmlyc3RMZWFmKCkgfHwgZWRpdGFibGUuZmlyc3RMZWFmKCksXG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsXG4gICAgICAgICAgICBmb2N1c05vZGU6IHVuYnJlYWthYmxlQW5jZXN0b3I/Lmxhc3RMZWFmKCkgfHwgZWRpdGFibGUubGFzdExlYWYoKSxcbiAgICAgICAgICAgIGZvY3VzUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24uQUZURVIsXG4gICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgcmVjZWl2ZWQgc2lnbmFsIGFuZCBkaXNwYXRjaCB0aGUgY29ycmVzcG9uZGluZyBlZGl0b3IgY29tbWFuZCxcbiAgICAgKiBiYXNlZCBvbiB0aGUgdXNlcidzIGNvbmZpZ3VyYXRpb24gYW5kIGNvbnRleHQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBfbWF0Y2hDb21tYW5kKFxuICAgICAgICBhY3Rpb246IE5vcm1hbGl6ZWRBY3Rpb24sXG4gICAgKTogW0NvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kUGFyYW1zLCBbUG9pbnQsIFBvaW50XT9dIHtcbiAgICAgICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnaW5zZXJ0TGluZUJyZWFrJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gWydpbnNlcnRMaW5lQnJlYWsnLCB7fV07XG4gICAgICAgICAgICBjYXNlICdpbnNlcnRUZXh0JzpcbiAgICAgICAgICAgIGNhc2UgJ2luc2VydEh0bWwnOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBJbnNlcnRUZXh0UGFyYW1zID0geyB0ZXh0OiBhY3Rpb24udGV4dCB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBbJ2luc2VydFRleHQnLCBwYXJhbXNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0QWxsJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gWydzZWxlY3RBbGwnLCB7fV07XG4gICAgICAgICAgICBjYXNlICdzZXRTZWxlY3Rpb24nOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KExheW91dCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgICAgICAgICBjb25zdCB2U2VsZWN0aW9uUGFyYW1zOiBWU2VsZWN0aW9uUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICB2U2VsZWN0aW9uOiBkb21MYXlvdXRFbmdpbmUucGFyc2VTZWxlY3Rpb24oYWN0aW9uLmRvbVNlbGVjdGlvbiksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWydzZXRTZWxlY3Rpb24nLCB2U2VsZWN0aW9uUGFyYW1zXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ2luc2VydFBhcmFncmFwaEJyZWFrJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gWydpbnNlcnRQYXJhZ3JhcGhCcmVhaycsIHt9XTtcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZVdvcmQnOlxuICAgICAgICAgICAgICAgIGlmIChhY3Rpb24uZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRk9SV0FSRCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gQXJyYXkuZnJvbShhY3Rpb24udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0W3RleHQubGVuZ3RoIC0gMV0gPT09ICcgJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRvIGhhbmRsZSBhIHNwYWNlIF9iZWZvcmVfIHRoZSB3b3JkLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC51bnNoaWZ0KHRleHQucG9wKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBlbmQ6IFZOb2RlID0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLmVuZDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZCAmJiB0ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IGVuZC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQ/LnRleHRDb250ZW50ID09PSB0ZXh0LnNoaWZ0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBuZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGVsZXRlRm9yd2FyZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZSYW5nZS5zZWxlY3RpbmcodGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnN0YXJ0LCBlbmQpLFxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydDogVk5vZGUgPSB0aGlzLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBBcnJheS5mcm9tKGFjdGlvbi50ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHRbMF0gPT09ICcgJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRvIHRyZWF0IGEgc3BhY2UgX2JlZm9yZV8gdGhlIHdvcmQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LnB1c2godGV4dC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnQgJiYgdGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gc3RhcnQucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXM/LnRleHRDb250ZW50ID09PSB0ZXh0LnBvcCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBwcmV2aW91cztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2RlbGV0ZUJhY2t3YXJkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgVlJhbmdlLnNlbGVjdGluZyhzdGFydCwgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLmVuZCksXG4gICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlQ29udGVudCc6IHtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkZPUldBUkQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsnZGVsZXRlRm9yd2FyZCcsIHt9XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWydkZWxldGVCYWNrd2FyZCcsIHt9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgcmVjZWl2ZWQgc2lnbmFsIGFuZCBkaXNwYXRjaCB0aGUgY29ycmVzcG9uZGluZyBlZGl0b3IgY29tbWFuZCxcbiAgICAgKiBiYXNlZCBvbiB0aGUgdXNlcidzIGNvbmZpZ3VyYXRpb24gYW5kIGNvbnRleHQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYmF0Y2hQcm9taXNlXG4gICAgICovXG4gICAgYXN5bmMgX29uTm9ybWFsaXplZEV2ZW50KGJhdGNoUHJvbWlzZTogUHJvbWlzZTxFdmVudEJhdGNoPik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBUT0RPOiBUaGUgYG5leHRFdmVudE11dGV4YCBzaGVuYW5pZ2FucyB0aGF0IHdlcmUgcmVtb3ZlZCBpbiB0aGlzXG4gICAgICAgIC8vIGNvbW1pdCBzaG91bGQgYmUgcmVpbnN0YXRlZCB1bmxlc3Mgd2Ugd2FudCB0aGUgbm9ybWFsaXplciB0byBjYWxsXG4gICAgICAgIC8vIGBleGVjQ29tbWFuZGAgcmVnYXJkbGVzcyBvZiB0aGUgb2JzZXJ2YXRpb24gb3V0Y29tZSBsaWtlIGl0IHVzZWQgdG9cbiAgICAgICAgLy8gY2FsbCBgbmV4dEV2ZW50TXV0ZXhgIGJlZm9yZSBjYWxsaW5nIGBleGVjQ29tbWFuZGAuXG4gICAgICAgIGNvbnN0IGJhdGNoID0gYXdhaXQgYmF0Y2hQcm9taXNlO1xuICAgICAgICBjb25zdCBkb21FbmdpbmUgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KS5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgIGlmIChiYXRjaC5tdXRhdGVkRWxlbWVudHMpIHtcbiAgICAgICAgICAgIGRvbUVuZ2luZS5tYXJrRm9yUmVkcmF3KGJhdGNoLm11dGF0ZWRFbGVtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoYmF0Y2guaW5mZXJyZWRLZXlkb3duRXZlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbUxheW91dCA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChEb21MYXlvdXQpO1xuICAgICAgICAgICAgcHJvY2Vzc2VkID0gISEoYXdhaXQgZG9tTGF5b3V0LnByb2Nlc3NLZXlkb3duKFxuICAgICAgICAgICAgICAgIG5ldyBLZXlib2FyZEV2ZW50KCdrZXlkb3duJywge1xuICAgICAgICAgICAgICAgICAgICAuLi5iYXRjaC5pbmZlcnJlZEtleWRvd25FdmVudCxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBiYXRjaC5pbmZlcnJlZEtleWRvd25FdmVudC5rZXksXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IGJhdGNoLmluZmVycmVkS2V5ZG93bkV2ZW50LmNvZGUsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICApKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXByb2Nlc3NlZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBhY3Rpb24gb2YgYmF0Y2guYWN0aW9ucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRTcGVjID0gdGhpcy5fbWF0Y2hDb21tYW5kKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmRTcGVjKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IFtjb21tYW5kTmFtZSwgY29tbWFuZFBhcmFtcywgcmFuZ2VCb3VuZHNdID0gY29tbWFuZFNwZWM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kTmFtZSAmJiByYW5nZUJvdW5kcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5lZGl0b3IuZXhlY1dpdGhSYW5nZShyYW5nZUJvdW5kcywgY29tbWFuZE5hbWUsIGNvbW1hbmRQYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbW1hbmROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmVkaXRvci5leGVjQ29tbWFuZChjb21tYW5kTmFtZSwgY29tbWFuZFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gRG9tTGF5b3V0LCBLZXlib2FyZEV2ZW50IGxpc3RlbmVyIHRvIGJlIGFkZGVkIHRvIHRoZSBET00gdGhhdCBjYWxsc1xuICAgICAqIGBleGVjQ29tbWFuZGAgaWYgdGhlIGtleXMgcHJlc3NlZCBtYXRjaCBvbmUgb2YgdGhlIHNob3J0Y3V0IHJlZ2lzdGVyZWRcbiAgICAgKiBpbiB0aGUga2V5bWFwLlxuICAgICAqIEluIGNhc2Ugb2YgdGhlIGtleWRvdyBhcmUgZGVmYXVsdFByZXZlbnRlZCBpdCdzIG1lYW5zIHdlIGV4ZWN1dGVkIGEgbmV3XG4gICAgICogY29tbWFuZC4gV2Ugc3BsaXQgdGhlIGV2ZW50IGFncmFnYXRpb24gb2Ygbm9ybWFsaXplciB0byBlbnN1cmUgdG8gaGF2ZVxuICAgICAqIHRoZSBuZXh0IGV4ZWNDb21tYW5kIGF0IHRoZSByaWdodCB0aW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBfcHJvY2Vzc0tleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnROb3JtYWxpemVyLmluaXROZXh0T2JzZXJ2YXRpb24oKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgTXV0YXRpb25Ob3JtYWxpemVyIH0gZnJvbSAnLi9NdXRhdGlvbk5vcm1hbGl6ZXInO1xuaW1wb3J0IHsgY2FyZXRQb3NpdGlvbkZyb21Qb2ludCwgZWxlbWVudEZyb21Qb2ludCB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9wb2x5ZmlsbCc7XG5pbXBvcnQgeyB0YXJnZXREZWVwZXN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL0RvbSc7XG5pbXBvcnQgeyBub2RlTmFtZSwgZ2V0RG9jdW1lbnQgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5jb25zdCBuYXZpZ2F0aW9uS2V5ID0gbmV3IFNldChbXG4gICAgJ0Fycm93VXAnLFxuICAgICdBcnJvd0Rvd24nLFxuICAgICdBcnJvd0xlZnQnLFxuICAgICdBcnJvd1JpZ2h0JyxcbiAgICAnUGFnZVVwJyxcbiAgICAnUGFnZURvd24nLFxuICAgICdFbmQnLFxuICAgICdIb21lJyxcbl0pO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uIHtcbiAgICByZWFkb25seSBhbmNob3JOb2RlOiBOb2RlO1xuICAgIHJlYWRvbmx5IGFuY2hvck9mZnNldDogbnVtYmVyO1xuICAgIHJlYWRvbmx5IGZvY3VzTm9kZTogTm9kZTtcbiAgICByZWFkb25seSBmb2N1c09mZnNldDogbnVtYmVyO1xuICAgIHJlYWRvbmx5IGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIG9yaWdpbj86IHN0cmluZzsgLy8gb3JpZ2luIG9mIHRoZSBzZWxlY3Rpb24gY2hhbmdlXG59XG5cbmNvbnN0IGlucHV0VHlwZUNvbW1hbmRzID0gbmV3IFNldChbXG4gICAgJ2hpc3RvcnlVbmRvJyxcbiAgICAnaGlzdG9yeVJlZG8nLFxuICAgICdmb3JtYXRCb2xkJyxcbiAgICAnZm9ybWF0SXRhbGljJyxcbiAgICAnZm9ybWF0VW5kZXJsaW5lJyxcbiAgICAnZm9ybWF0U3RyaWtlVGhyb3VnaCcsXG4gICAgJ2Zvcm1hdFN1cGVyc2NyaXB0JyxcbiAgICAnZm9ybWF0U3Vic2NyaXB0JyxcbiAgICAnZm9ybWF0SnVzdGlmeUZ1bGwnLFxuICAgICdmb3JtYXRKdXN0aWZ5Q2VudGVyJyxcbiAgICAnZm9ybWF0SnVzdGlmeVJpZ2h0JyxcbiAgICAnZm9ybWF0SnVzdGlmeUxlZnQnLFxuICAgICdmb3JtYXRJbmRlbnQnLFxuICAgICdmb3JtYXRPdXRkZW50JyxcbiAgICAnZm9ybWF0UmVtb3ZlJyxcbiAgICAnZm9ybWF0U2V0QmxvY2tUZXh0RGlyZWN0aW9uJyxcbiAgICAnZm9ybWF0U2V0SW5saW5lVGV4dERpcmVjdGlvbicsXG4gICAgJ2Zvcm1hdEJhY2tDb2xvcicsXG4gICAgJ2Zvcm1hdEZvbnRDb2xvcicsXG4gICAgJ2Zvcm1hdEZvbnROYW1lJyxcbl0pO1xuXG4vKlxuICogUmVnZXhwIHRvIHRlc3QgaWYgYSBjaGFyYWN0ZXIgaXMgd2l0aGluIGFuIGFscGhhYmV0IGtub3duIGJ5IHVzLlxuICpcbiAqIE5vdGU6IE5vdCBhbGwgYWxwaGFiZXRzIGFyZSB0YWtlbiBpbnRvIGNvbnNpZGVyYXRpb24gYW5kIHRoaXMgUmVnRXhwIGlzIHN1YmplY3QgdG8gYmUgY29tcGxldGVkXG4gKiAgICAgICBhcyBtb3JlIGFscGhhYmV0cyB3aWxsIGJlIGNvdmVyZWQuXG4gKlxuICogVW5pY29kZSByYW5nZSBzb3VyY2U6XG4gKiAtIHdpa2lwZWRpYVxuICogLSBnb29nbGUgdHJhbnNsYXRlXG4gKiAtIGh0dHBzOi8vanJncmFwaGl4Lm5ldC9yL1VuaWNvZGUvXG4gKlxuICogVG9vbCB0byBnZW5lcmF0ZSBSZWdFeHAgcmFuZ2U6XG4gKiAtIGh0dHBzOi8vYXBwcy50aW13aGl0bG9jay5pbmZvL2pzL3JlZ2V4XG4gKlxuICogVGhlIHN0cmF0ZWd5IGlzIHRvIHNlcGFyYXRlIGFueSB3b3JkIGJ5IHNlbGVjdGluZyBzdWJzZXF1ZW50IGNoYXJhY3RlcnMgb2YgYSBjb21tb24gYWxwaGFiZXQuXG4gKi9cbmNvbnN0IGFscGhhYmV0c0NvbnRhaW5pbmdTcGFjZXMgPSBuZXcgUmVnRXhwKFxuICAgICcoJyArXG4gICAgICAgIFtcbiAgICAgICAgICAgICdb0LAt0Y/QkC3Qr9CALdO/1IAt1K9dKycsIC8vIGN5cmlsbGljXG4gICAgICAgICAgICAnW82wLc++4byALeG/vl0rJywgLy8gZ3JlZWsgJiBjb3B0aWNcbiAgICAgICAgICAgICdbXFx1MDUzMC1cXHUwNThGXSsnLCAvLyBhcm1lbmlhblxuICAgICAgICAgICAgJ1tcXHUwNjAwLdu+3ZAt3b5cXHUwOGEwLVxcdTA4ZmVdKycsIC8vIGFyYWJpY1xuICAgICAgICAgICAgJ1tcXHUwOTAwLVxcdTBERkZdKycsIC8vIEluZGlhXG4gICAgICAgICAgICAnW2EtekEtWl0rJywgLy8gbGF0aW5cbiAgICAgICAgICAgICdbYS16QS1aw4Atw79dKycsIC8vIGxhdGluLTFcbiAgICAgICAgICAgICdbYS16QS1axIAtxb9dKycsIC8vIExhdGluIEV4dGVuZGVkLUFcbiAgICAgICAgICAgICdbYS16QS1axoAtyY9dKycsIC8vIExhdGluIEV4dGVuZGVkLUJcbiAgICAgICAgXS5qb2luKCd8JykgK1xuICAgICAgICAnKSQnLFxuKTtcblxuLyoqXG4gKiBUaGVzZSBqYXZhc2NyaXB0IGV2ZW50IHR5cGVzIG1pZ2h0LCBpbiBjYXNlIG9mIHNhZmFyaSBvciBzcGVsbC1jaGVja2luZ1xuICoga2V5Ym9hcmQsIHRyaWdnZXIgZG9tIGV2ZW50cyBpbiBtdWx0aXBsZSBqYXZhc2NyaXB0IHN0YWNrcy4gVGhleSB3aWxsIHJlcXVpcmVcbiAqIHRvIG9ic2VydmUgZXZlbnRzIGR1cmluZyB0d28gdGlja3MgcmF0aGVyIHRoYW4gYWZ0ZXIgYSBzaW5nbGUgdGljay5cbiAqL1xuY29uc3QgTXVsdGlTdGFja0V2ZW50VHlwZXMgPSBbJ2lucHV0JywgJ2NvbXBvc2l0aW9uZW5kJywgJ3NlbGVjdEFsbCddO1xuXG5pbnRlcmZhY2UgSW5zZXJ0VGV4dEFjdGlvbiB7XG4gICAgdHlwZTogJ2luc2VydFRleHQnO1xuICAgIHRleHQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluc2VydEh0bWxBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRIdG1sJztcbiAgICBodG1sOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSW5zZXJ0UGFyYWdyYXBoQnJlYWtBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRQYXJhZ3JhcGhCcmVhayc7XG59XG5cbmludGVyZmFjZSBJbnNlcnRMaW5lQnJlYWtBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRMaW5lQnJlYWsnO1xufVxuXG5pbnRlcmZhY2UgSW5zZXJ0RmlsZXNBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRGaWxlcyc7XG4gICAgZmlsZXM6IEZpbGVbXTtcbn1cblxuaW50ZXJmYWNlIERlbGV0ZUNvbnRlbnRBY3Rpb24ge1xuICAgIHR5cGU6ICdkZWxldGVDb250ZW50JztcbiAgICBkaXJlY3Rpb246IERpcmVjdGlvbjtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgRGVsZXRlV29yZEFjdGlvbiB7XG4gICAgdHlwZTogJ2RlbGV0ZVdvcmQnO1xuICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIHRleHQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIERlbGV0ZUhhcmRMaW5lQWN0aW9uIHtcbiAgICB0eXBlOiAnZGVsZXRlSGFyZExpbmUnO1xuICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIGRvbVNlbGVjdGlvbjogRG9tU2VsZWN0aW9uRGVzY3JpcHRpb247XG59XG5cbmludGVyZmFjZSBTZWxlY3RBbGxBY3Rpb24ge1xuICAgIHR5cGU6ICdzZWxlY3RBbGwnO1xufVxuXG5pbnRlcmZhY2UgU2V0U2VsZWN0aW9uQWN0aW9uIHtcbiAgICB0eXBlOiAnc2V0U2VsZWN0aW9uJztcbiAgICBkb21TZWxlY3Rpb246IERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uO1xufVxuXG5pbnRlcmZhY2UgQXBwbHlGb3JtYXRBY3Rpb24ge1xuICAgIHR5cGU6ICdhcHBseUZvcm1hdCc7XG4gICAgZm9ybWF0OiBzdHJpbmc7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBkYXRhOiBhbnk7XG59XG5cbmludGVyZmFjZSBIaXN0b3J5QWN0aW9uIHtcbiAgICB0eXBlOiAnaGlzdG9yeVVuZG8nIHwgJ2hpc3RvcnlSZWRvJztcbn1cblxuZXhwb3J0IHR5cGUgTm9ybWFsaXplZEFjdGlvbiA9XG4gICAgfCBJbnNlcnRUZXh0QWN0aW9uXG4gICAgfCBJbnNlcnRIdG1sQWN0aW9uXG4gICAgfCBJbnNlcnRMaW5lQnJlYWtBY3Rpb25cbiAgICB8IEluc2VydFBhcmFncmFwaEJyZWFrQWN0aW9uXG4gICAgfCBJbnNlcnRGaWxlc0FjdGlvblxuICAgIHwgRGVsZXRlQ29udGVudEFjdGlvblxuICAgIHwgRGVsZXRlV29yZEFjdGlvblxuICAgIHwgRGVsZXRlSGFyZExpbmVBY3Rpb25cbiAgICB8IFNlbGVjdEFsbEFjdGlvblxuICAgIHwgU2V0U2VsZWN0aW9uQWN0aW9uXG4gICAgfCBBcHBseUZvcm1hdEFjdGlvblxuICAgIHwgSGlzdG9yeUFjdGlvbjtcblxuZXhwb3J0IGludGVyZmFjZSBDYXJldFBvc2l0aW9uIHtcbiAgICBvZmZzZXROb2RlOiBOb2RlO1xuICAgIG9mZnNldDogbnVtYmVyO1xufVxuXG4vKipcbiAqIFRoZSBtb2RpZmllcnMga2V5cyBiZWluZyBwdXNoZWQgYXQgYSBwYXJ0aWN1bGFyIHRpbWUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTW9kaWZpZXJLZXlzIHtcbiAgICBjdHJsS2V5OiBib29sZWFuO1xuICAgIGFsdEtleTogYm9vbGVhbjtcbiAgICBtZXRhS2V5OiBib29sZWFuO1xuICAgIHNoaWZ0S2V5OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFRoZSBjb2RlIHRoYXQgd2UgaW5mZXIgZm9yIHZpcnR1YWwga2V5Ym9hcmQgdGhhdCBkbyBub3QgcHJvdmlkZSB0aGVtLlxuICovXG50eXBlIEluZmVycmVkQ29kZVZhbHVlID0gJ0VudGVyJyB8ICdCYWNrc3BhY2UnIHwgJ0RlbGV0ZSc7XG5cbi8qKlxuICogVGhlIGluZmVyZWQga2V5ZG93biBldmVudCBmb3IgdmlydHVhbCBrZWJvYXJkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEluZmVycmVkS2V5ZG93bkV2ZW50IGV4dGVuZHMgTW9kaWZpZXJLZXlzIHtcbiAgICBrZXk6IEluZmVycmVkQ29kZVZhbHVlO1xuICAgIGNvZGU6IEluZmVycmVkQ29kZVZhbHVlO1xufVxuXG4vKipcbiAqIE9uZSBldmVudEJhdGNoIGNvbnRhaW4gYWxsIGVsZW1lbnQgYmVpbmcgdHJpZ2dlcmVkIGFuZCBub3JtYWxpemVkIGZyb20gb25lIG9yIG1vcmUgZXZlbnRzIHN0YWNrc1xuICogKGluIGNhc2Ugb2Ygc2FmYXJpKVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50QmF0Y2gge1xuICAgIC8vIFdlIGN1cnJlbnRseSBvbmx5IG5lZWQgYW4gYXJyYXkgb2YgZXZlbnQgaW4gY2FzZSBvZiBtdWx0aWtleXByZXNzLlxuICAgIGFjdGlvbnM6IE5vcm1hbGl6ZWRBY3Rpb25bXTtcbiAgICBtdXRhdGVkRWxlbWVudHM/OiBTZXQ8Tm9kZT47XG4gICAgLyoqXG4gICAgICogSW4gdGhlIGNhc2Ugb2YgdmlydHVhbCBrZXlib2FyZCwgaW5mZXIgdGhlIGtleSBiZWluZyBwdXNoZWQgZm9yICdFbnRlcicsXG4gICAgICogJ0JhY2tzcGFjZScsICdEZWxldGUnLlxuICAgICAqL1xuICAgIGluZmVycmVkS2V5ZG93bkV2ZW50PzogSW5mZXJyZWRLZXlkb3duRXZlbnQ7XG59XG5cbmludGVyZmFjZSBEYXRhVHJhbnNmZXJEZXRhaWxzIHtcbiAgICB0eXBlOiAnZHJvcCcgfCAncGFzdGUnIHwgJ2N1dCc7XG4gICAgJ3RleHQvcGxhaW4nOiBzdHJpbmc7XG4gICAgJ3RleHQvaHRtbCc6IHN0cmluZztcbiAgICAndGV4dC91cmktbGlzdCc6IHN0cmluZztcbiAgICBmaWxlczogRmlsZVtdO1xuICAgIG9yaWdpbmFsRXZlbnQ6IEV2ZW50O1xuICAgIGRyYWdnaW5nRnJvbUVkaXRhYmxlOiBib29sZWFuO1xuICAgIGNhcmV0UG9zaXRpb246IENhcmV0UG9zaXRpb247XG4gICAgc2VsZWN0aW9uOiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbjtcbn1cbi8qKlxuICogVGhlIGV2ZW50IHRvIHByb2Nlc3MgaW4gYF9wcm9jZXNzRXZlbnRzYCBjb3VsZCBiZSBhIG5hdGl2ZSBgRXZlbnRgIG9yIGEgY3VzdG9tIGV2ZW50IHRoYXQgd2VcbiAqIGNyZWF0ZWQgKGBEYXRhVHJhbnNmZXJEZXRhaWxzYCkuXG4gKi9cbnR5cGUgRXZlbnRUb1Byb2Nlc3MgPSBFdmVudCB8IERhdGFUcmFuc2ZlckRldGFpbHM7XG5cbmludGVyZmFjZSBFdmVudExpc3RlbmVyRGVjbGFyYXRpb24ge1xuICAgIHJlYWRvbmx5IHRhcmdldDogRG9jdW1lbnQgfCBTaGFkb3dSb290IHwgV2luZG93O1xuICAgIHJlYWRvbmx5IHR5cGU6IHN0cmluZztcbiAgICByZWFkb25seSBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcjtcbiAgICByZWFkb25seSBjYXB0dXJlOiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgQ29tcG9zaXRpb25EYXRhIHtcbiAgICBjb21wb3NpdGlvbkZyb206IHN0cmluZztcbiAgICBjb21wb3NpdGlvblRvOiBzdHJpbmc7XG4gICAgYWN0aW9uczogTm9ybWFsaXplZEFjdGlvbltdO1xufVxuXG4vKipcbiAqIE9iamVjdCBjb250YWluaW5nIGFsbCBldmVudHMgcHJlc2VudCBpbiBvbmUgc3RhY2suXG4gKi9cbmludGVyZmFjZSBDdXJyZW50U3RhY2tPYnNlcnZhdGlvbnMge1xuICAgIC8qKlxuICAgICAqIEV2ZW50cyBmaXJlZCBkdXJpbmcgdGhlIGN1cnJlbnQgdGljay5cbiAgICAgKiBfZXZlbnRzIHdpdGggdmFsdWUgbnVsbCBtZWFuIHRoYXQgd2UgYXJlIG5vdCBjdXJyZW50bHkgb2JzZXJ2aW5nIGNoYW5nZXMuXG4gICAgICovXG4gICAgX2V2ZW50czogRXZlbnRUb1Byb2Nlc3NbXTtcbiAgICAvKipcbiAgICAgKiBNYXAgaXMgdXNlZCB0byBnYXRoZXIgaW5mb3JtYXRpb25zIHdoZW4gbXVsdGlwbGVzIGtleXMgYXJlIGZvdW5kIGluIHRoZVxuICAgICAqIHNhbWUgc3RhY2suXG4gICAgICovXG4gICAgX211bHRpS2V5U3RhY2s6IHtcbiAgICAgICAga2V5ZG93bj86IEtleWJvYXJkRXZlbnQ7XG4gICAgICAgIGtleXByZXNzPzogS2V5Ym9hcmRFdmVudDtcbiAgICAgICAgaW5wdXQ/OiBJbnB1dEV2ZW50O1xuICAgIH1bXTtcbiAgICAvKipcbiAgICAgKiBNYXAgdXNlZCB0byBjb2xsZWN0IGluZm9ybWF0aW9uIGFib3V0IHRoZSBsYXN0IGV2ZW50cyBvZiBhIHR5cGUgdGhhdFxuICAgICAqIGhhcHBlbmVkIGluIG9uZSBvciB0d28gdGlja3MuXG4gICAgICovXG4gICAgX2V2ZW50c01hcDoge1xuICAgICAgICBrZXlkb3duPzogS2V5Ym9hcmRFdmVudDtcbiAgICAgICAga2V5cHJlc3M/OiBLZXlib2FyZEV2ZW50O1xuICAgICAgICBpbnB1dD86IElucHV0RXZlbnQ7XG4gICAgICAgIGxhc3RDb21wb3NpdGlvbj86IENvbXBvc2l0aW9uRXZlbnQ7XG4gICAgICAgIGNvbXBvc2l0aW9uc3RhcnQ/OiBDb21wb3NpdGlvbkV2ZW50O1xuICAgICAgICBjb21wb3NpdGlvbnVwZGF0ZT86IENvbXBvc2l0aW9uRXZlbnQ7XG4gICAgICAgIGNvbXBvc2l0aW9uZW5kPzogQ29tcG9zaXRpb25FdmVudDtcbiAgICAgICAgY3V0PzogRGF0YVRyYW5zZmVyRGV0YWlscztcbiAgICAgICAgZHJvcD86IERhdGFUcmFuc2ZlckRldGFpbHM7XG4gICAgICAgIHBhc3RlPzogRGF0YVRyYW5zZmVyRGV0YWlscztcbiAgICAgICAga2V5Ym9hcmRTZWxlY3RBbGw/OiBDdXN0b21FdmVudDtcbiAgICB9O1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIHByb21pc2UgdGhhdCByZXNvbHZlIG9uY2UgYSB0aW1lb3V0IGZpbmlzaCBvciB3aGVuIGNhbGxpbmdcbiAqIGBleGVjdXRlQW5kQ2xlYXJgLlxuICovXG5jbGFzcyBUaW1lb3V0PFQgPSB2b2lkPiB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBwZW5kaW5nID0gdHJ1ZTtcbiAgICBwcm9taXNlOiBQcm9taXNlPFQ+O1xuICAgIHByaXZhdGUgX3Jlc29sdmU6IEZ1bmN0aW9uO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGZuOiAoKSA9PiBUIHwgUHJvbWlzZTxUPiwgaW50ZXJ2YWwgPSAwKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKTogdm9pZCA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgICAgICAgIHRoaXMuaWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShmbigpKTtcbiAgICAgICAgICAgIH0sIGludGVydmFsKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZpcmUocmVzdWx0PzogVCk6IHZvaWQge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5pZCk7XG4gICAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuZm4oKSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbnR5cGUgVHJpZ2dlckV2ZW50QmF0Y2hDYWxsYmFjayA9IChiYXRjaDogUHJvbWlzZTxFdmVudEJhdGNoPikgPT4gdm9pZDtcblxuLyoqXG4gKiAjIyBUaGUgcHJvYmxlbXMgdGhlIG5vcm1hbGl6ZXIgc29sdmVcbiAqIEJyb3dzZXIgYW5kIHZpcnR1YWwga2V5Ym9hcmRzIG9uIG1vYmlsZSBkb2VzIG5vdCBpbXBsZW1lbnQgcHJvcGVybHkgdGhlIHczY1xuICogY29udGVudGVkaXRhYmxlIHNwZWNpZmljYXRpb24gYW5kIGFyZSBpbmNvbnNpc3RlbnQuXG4gKlxuICogIyMgR29hbCBvZiB0aGUgbm9ybWFsaXplclxuICogMS4gSG9vayBhbnkgY2hhbmdlIHRoYXQgaGFwcGVuZCBpbiBhbiBlbGVtZW50IGNhbGxlZCB0aGUgYGVkaXRhYmxlYC5cbiAqIDIuIFRyaWdnZXIgdGhlIHNhbWUgZXZlbnQgZm9yIHRoZSBzYW1lIGFjdGlvbiBhY2Nyb3NzIGFsbCBicm93c2VycyBhbmRcbiAqICAgIGRldmljZXMuXG4gKlxuICogIyMgU3RyYXRlZ3lcbiAqIEhvb2sgYWxsIGphdmFzY3JpcHQgZXZlbnRzIHRoYXQgbW9kaWZ5IHRoZSBgZWRpdGFibGVgIGVsZW1lbnQuIFRoZW4sIHRyaWdnZXJcbiAqIG5vcm1hbGl6ZWQgZXZlbnRzLlxuICpcbiAqICMjIEhvdyB0byB1c2UgdGhpcyBub3JtYWxpemVyP1xuICogMS4gSmF2YXNjcmlwdCBFdmVudHMgb2NjdXJzXG4gKiAyLiBOb3JtYWxpemUgamF2YXNjcmlwdCBvbmUgb3IgbW9yZSBgRXZlbnRgIHRvIG9uZSBvciBtb3JlXG4gKiAgICBgTm9ybWFsaXplZEFjdGlvbmAuXG4gKiAzLiBVcGRhdGUgb3VyIGBWRG9jdW1lbnRgIGluIHJlZ2FyZCBvZiB0cmlnZ2VyZWQgbm9ybWFsaXplZCBhY3Rpb25zLlxuICogNC4gUmVuZGVyIHdoYXQgY2hhbmdlZCBpbiB0aGUgYFZEb2N1bWVudGAgSFRNTCBpbiB0aGUgYGVkaXRhYmxlYC5cbiAqXG4gKiBUaGUgbm9ybWFsaXplciBkb2VzIG5vdCBwcmV2ZW50RGVmYXVsdCBtb3N0IG9mIHRoZSBjaGFuZ2UgaW4gdGhlIGVkaXRhYmxlXG4gKiBoYXBwZW4gKHRoZSBleGNlcHRpb24gZm9yIFwicGFzdGVcIiBhbmQgXCJkcm9wXCIgamF2YXNjcmlwdCBldmVudCkuXG4gKlxuICpcbiAqICMjIEhhbmRlbGluZyBqYXZhc2NyaXB0IGV2ZW50c1xuICogQSBqYXZhc2NyaXB0IGV2ZW50IGlzIGFsbW9zdCBuZXZlciBwcmV2ZW50ZWQgYW5kIGFsbW9zdCBhbHdheXMgYWx0ZXIgdGhlXG4gKiBlZGl0YWJsZSBpbiB0aGUgRE9NLlxuICpcbiAqIFRoZSByZWFzb24gdGhhdCB3ZSBkbyBub3QgcHJldmVudCBkZWZhdWx0IGlzIGJlY2F1c2Ugd2UgbmVlZCBtb3JlXG4gKiBpbmZvcm1hdGlvbnMuIFRoZSBpbmZvcm1hdGlvbiBtb2RpZmllZCBpbiB0aGUgZG9tIChieSBvYnNlcnZpbmcgb2JzZXJ2aW5nXG4gKiBtdXRhdGlvbnMpLlxuICpcbiAqIFRoZXJlIGlzIGFuIGV4Y2VwdGlvbiBmb3IgdGhlIGV2ZW50ICdwYXN0ZScgYW5kICdkcm9wJy5cbiAqXG4gKiBUaGUgcmVhc29uIHRvIHByZXZlbnREZWZhdWx0ICdwYXN0ZScgaXMgYmVjYXVzZSBtb3N0IG9mIHRoZSB0aW1lLCBicm93c2Vyc1xuICogcGFzdGUgY29udGVudCB0aGF0IG5lZWQgdG8gYmUgY2xlYW5lZC4gRm9yIHRoYXQgcmVhc29uIHdlIHByZXZlbnQgaXQgZnJvbVxuICogYmVpbmcgaW5zZXJ0ZWQgaW4gdGhlIGVkaXRhYmxlIGVsZW1lbnQgYnV0IHRoZSBpbmZvcm1hdGlvbnMgY2FuIGJlIGZvdW5kIGluXG4gKiB0aGUgdHJpZ2dlcmVkIG5vcm1hbGl6ZWQgZXZlbnRzIGFjdGlvbnMuXG4gKlxuICogVGhlIHJlYXNvbiB0byBwcmV2ZW50RGVmYXVsdCAnZHJvcCcgaXMgYmVjYXVzZSBzb21lIGJyb3dzZXJzIGNoYW5nZSBwYWdlIHdoZW5cbiAqIGRyb3BwaW5nIGFuIGltYWdlIG9yIGFuIHVybCB0aGF0IGNvbWVzIGZyb20gdGhlIGFkZHJlc3MgYmFyIChlLmcuIGNocm9tZSkuXG4gKlxuICogIyMgU3VwcG9ydGVkIGJyb3dzZXIgYW5kIHZpcnR1YWwga2V5Ym9hcmRcbiAqIC0gTWFjXG4gKiAgIC0gQ2hyb21lXG4gKiAgIC0gRmlyZWZveFxuICogICAtIEVkZ2VcbiAqICAgLSBTYWZhcmlcbiAqIC0gV2luZG93c1xuICogICAtIENocm9tZVxuICogICAtIEZpcmVmb3hcbiAqICAgLSBFZGdlXG4gKiAgIC0gU2FmYXJpXG4gKiAtIExpbnV4XG4gKiAgIC0gQ2hyb21lXG4gKiAgIC0gRmlyZWZveFxuICogLSBBbmRyb2lkXG4gKiAgIC0gQ2hyb21lXG4gKiAgIC0gRmlyZWZveFxuICogICAtIEdvb2dsZSBrZXlib2FyZFxuICogICAtIFN3aWZ0IGtleWJvYXJkXG4gKiAtIElPU1xuICogICAtIFNhZmFyaVxuICogICAtIENocm9tZVxuICogICAtIEZpcmVmb3hcbiAqL1xuZXhwb3J0IGNsYXNzIEV2ZW50Tm9ybWFsaXplciB7XG4gICAgLyoqXG4gICAgICogRXZlbnQgbGlzdGVuZXJzIHRoYXQgYXJlIGJvdW5kIGluIHRoZSBET00gYnkgdGhlIG5vcm1hbGl6ZXIgb24gY3JlYXRpb25cbiAgICAgKiBhbmQgdW5ib3VuZCBvbiBkZXN0cm95LlxuICAgICAqL1xuICAgIF9ldmVudExpc3RlbmVyczogRXZlbnRMaXN0ZW5lckRlY2xhcmF0aW9uW10gPSBbXTtcbiAgICAvKipcbiAgICAgKiBUaGUgTXV0YXRpb25Ob3JtYWxpemVyIHVzZWQgYnkgdGhlIG5vcm1hbGl6ZXIgdG8gd2F0Y2ggdGhlIG5vZGVzIHRoYXQgYXJlXG4gICAgICogYmVpbmcgbW9kaWZpZWQgc2luY2UgdGhlIG5vcm1hbGl6ZXIgY3JlYXRpb24gdW50aWwgaXQgaXMgZHJlc3Ryb3llZC5cbiAgICAgKi9cbiAgICBfbXV0YXRpb25Ob3JtYWxpemVyOiBNdXRhdGlvbk5vcm1hbGl6ZXI7XG5cbiAgICBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbjogQ3VycmVudFN0YWNrT2JzZXJ2YXRpb25zO1xuXG4gICAgLyoqXG4gICAgICogVXNlZCBpbiBgX29uU2VsZWN0aW9uQ2hhbmdlYCBmb3IgdGhlIGhldXJpc2ljIHRoYXQgY2hlY2sgaWYgd2UgbWlnaHRcbiAgICAgKiBzZWxlY3QgYWxsIHRoZSBgZWRpdGFibGVgXG4gICAgICovXG4gICAgX2ZvbGxvd3NQb2ludGVyQWN0aW9uOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHNlbGVjdGlvbiBpcyBhbHJlYWR5IHJlY29nbml6ZWQgYXMgYmVpbmdcbiAgICAgKiBhIFwic2VsZWN0IGFsbFwiLlxuICAgICAqL1xuICAgIF9jdXJyZW50bHlTZWxlY3RpbmdBbGw6IGJvb2xlYW47XG4gICAgLyoqXG4gICAgICogT3JpZ2luYWwgbW91c2Vkb3duIGV2ZW50IGZyb20gd2hpY2ggdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHdhcyBtYWRlLlxuICAgICAqL1xuICAgIF9tb3VzZWRvd25JbkVkaXRhYmxlOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIE9yaWdpbmFsIHNlbGVjdGlvbiB0YXJnZXQgYmVmb3JlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBpcyB1cGRhdGVkLlxuICAgICAqL1xuICAgIF9pbml0aWFsQ2FyZXRQb3NpdGlvbjogQ2FyZXRQb3NpdGlvbjtcbiAgICAvKipcbiAgICAgKiBTZXQgdG8gdHJ1ZSB3aGVuIGBfb25TZWxlY3Rpb25DaGFuZ2VgLiBJZiBzZXQsIGRvbid0IHByb2Nlc3NcbiAgICAgKiBgX29uQ29udGV4dE1lbnVgLlxuICAgICAqL1xuICAgIF9zZWxlY3Rpb25IYXNDaGFuZ2VkOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgZHJhZ2dpbmcgb3BlcmF0aW9uIHN0YXJ0ZWQgZnJvbSBpbnNpZGUgdGhlIGVkaXRhYmxlLlxuICAgICAqIEZhbHNlIGlmIHRoZSBkcmFnZ2luZyBzdGFydGVkIG91dHNpZGUgb2YgdGhlIGVkaXRhYmxlLlxuICAgICAqL1xuICAgIF9kcmFnZ2luZ0Zyb21FZGl0YWJsZTogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBDYWNoZSB0aGUgc3RhdGUgb2YgbW9kaWZpZXJzIGtleXMgb24gZWFjaCBrZXlzdHJva2VzLlxuICAgICAqL1xuICAgIF9tb2RpZmllcktleXM6IE1vZGlmaWVyS2V5cyA9IHtcbiAgICAgICAgY3RybEtleTogZmFsc2UsXG4gICAgICAgIGFsdEtleTogZmFsc2UsXG4gICAgICAgIG1ldGFLZXk6IGZhbHNlLFxuICAgICAgICBzaGlmdEtleTogZmFsc2UsXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudCBzZWxlY3Rpb24gaGFzIHRvIGJlIG9ic2VydmVkIGFzIGEgcmVzdWx0IG9mIGEgbW91c2Vkb3duIGJlaW5nXG4gICAgICogdHJpZ2dlcmVkLiBIb3dldmVyLCB0aGlzIGNhbm5vdCBiZSBkb25lIGF0IHRoZSB0aW1lIG9mIHRoZSBtb3VzZWRvd25cbiAgICAgKiBpdHNlbGYgc2luY2UgdGhlIGJyb3dzZXIgaGFzbid0IHVwZGF0ZWQgdGhlIHNlbGVjdGlvbiBpbiB0aGUgRE9NIHlldC5cbiAgICAgKiBUaGlzIG9ic2VydmF0aW9uIGlzIHRodXMgZGVmZXJyZWQgaW5zaWRlIGEgYHNldFRpbWVvdXRgLiBJZiB0aGUgYnJvd3NlclxuICAgICAqIGdldHMgb3ZlcmxvYWRlZCwgaXQgbWlnaHQgZmlyZSB0aGUgdGltZW91dCBhZnRlciBvdGhlciBldmVudHMgaGF2ZVxuICAgICAqIGhhcHBlbmVkLCB0aHVzIHJlbmRlcmluZyB0aGUgb2JzZXJ2YXRpb24gbWVhbmluZ2xlc3Mgc2luY2UgdGhlIHNlbGVjdGlvblxuICAgICAqIHdvdWxkIGhhdmUgY2hhbmdlZCB5ZXQgYWdhaW4uIFRoZSBvYnNlcnZhdGlvbiB0aW1lb3V0IGlzIHN0b3JlZCBpbiB0aGlzXG4gICAgICogdmFyaWFibGUgaW4gb3JkZXIgdG8gbWFudWFsbHkgZmlyZSBpdHMgZXhlY3V0aW9uIHdoZW4gYW4gZXZlbnQgdGhhdCBtaWdodFxuICAgICAqIGNoYW5nZSB0aGUgc2VsZWN0aW9uIGlzIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGJyb3dzZXIgZXhlY3V0ZWQgdGhlIHRpbWVyLlxuICAgICAqL1xuICAgIF9wb2ludGVyU2VsZWN0aW9uVGltZW91dDogVGltZW91dDxFdmVudEJhdGNoPjtcbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudCBzZWxlY3Rpb24gaGFzIHRvIGJlIG9ic2VydmVkIGFzIGEgcmVzdWx0IG9mIGEgbmFnaXZhdGlvbiBrZXlcbiAgICAgKiBiZWluZyBwcmVzc2VkLiBIb3dldmVyLCB0aGlzIGNhbm5vdCBiZSBkb25lIGF0IHRoZSB0aW1lIG9mIHRoZSBrZXlkb3duXG4gICAgICogaXRzZWxmIHNpbmNlIHRoZSBicm93c2VyIGhhc24ndCB1cGRhdGVkIHRoZSBzZWxlY3Rpb24gaW4gdGhlIERPTSB5ZXQuXG4gICAgICogVGhpcyBvYnNlcnZhdGlvbiBpcyB0aHVzIGRlZmVycmVkIGluc2lkZSBhIGBzZXRUaW1lb3V0YC4gSWYgdGhlIGJyb3dzZXJcbiAgICAgKiBnZXRzIG92ZXJsb2FkZWQsIGl0IG1pZ2h0IGZpcmUgdGhlIHRpbWVvdXQgYWZ0ZXIgb3RoZXIgZXZlbnRzIGhhdmVcbiAgICAgKiBoYXBwZW5lZCwgdGh1cyByZW5kZXJpbmcgdGhlIG9ic2VydmF0aW9uIG1lYW5pbmdsZXNzIHNpbmNlIHRoZSBzZWxlY3Rpb25cbiAgICAgKiB3b3VsZCBoYXZlIGNoYW5nZWQgeWV0IGFnYWluLiBUaGUgb2JzZXJ2YXRpb24gdGltZW91dCBpcyBzdG9yZWQgaW4gdGhpc1xuICAgICAqIHZhcmlhYmxlIGluIG9yZGVyIHRvIG1hbnVhbGx5IGZpcmUgaXRzIGV4ZWN1dGlvbiB3aGVuIGFuIGV2ZW50IHRoYXQgbWlnaHRcbiAgICAgKiBjaGFuZ2UgdGhlIHNlbGVjdGlvbiBpcyB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBicm93c2VyIGV4ZWN1dGVkIHRoZSB0aW1lci5cbiAgICAgKi9cbiAgICBfa2V5Ym9hcmRTZWxlY3Rpb25UaW1lb3V0OiBUaW1lb3V0PEV2ZW50QmF0Y2g+O1xuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50IHNlbGVjdGlvbiBoYXMgdG8gYmUgb2JzZXJ2ZWQgYXMgYSByZXN1bHQgb2YgYSBuYWdpdmF0aW9uIGtleVxuICAgICAqIGJlaW5nIHByZXNzZWQuIEhvd2V2ZXIsIHRoaXMgY2Fubm90IGJlIGRvbmUgYXQgdGhlIHRpbWUgb2YgdGhlIGtleWRvd25cbiAgICAgKiBpdHNlbGYgc2luY2UgdGhlIGJyb3dzZXIgaGFzbid0IHVwZGF0ZWQgdGhlIHNlbGVjdGlvbiBpbiB0aGUgRE9NIHlldC5cbiAgICAgKiBUaGlzIG9ic2VydmF0aW9uIGlzIHRodXMgZGVmZXJyZWQgaW5zaWRlIGEgYHNldFRpbWVvdXRgLiBJZiB0aGUgYnJvd3NlclxuICAgICAqIGdldHMgb3ZlcmxvYWRlZCwgaXQgd2lsbCB0cmlnZ2VyIGFsbCB0aGUgc3Vic2VxdWVudCBldmVudHMgaW4gdGhlIHNhbWVcbiAgICAgKiBldmVudCBzdGFjaywgdGh1cyBwcmV2ZW50aW5nIHRoZSBvYnNlcnZhdGlvbiBvZiB0aGUgc2VsZWN0aW9uIGJldHdlZW5cbiAgICAgKiBtdWx0aXBsZSBrZXlzLiBTaW5jZSBuYXZpZ2F0aW9uIGtleXMgYXJlIGlycmVsZXZhbnQgZm9yIHNwZWxsLWNoZWNraW5nXG4gICAgICoga2V5Ym9hcmQgY29uY2VybnMsIHRoZSBjdXJyZW50IHN0YWNrIGNhbiBiZSBwcm9jZXNzZWQgYXMgc29vbiBhcyBhXG4gICAgICogbmF2aWdhdGlvbiBrZXkgaXMgcHJlc3NlZCBpbnN0ZWFkIG9mIGNvbnRpbnVpbmcgdG8gYmF0Y2ggdGhlbSB0b2dldGhlci5cbiAgICAgKiBUaGUgcHJldmlvdXMgc3RhY2sgdGltZW91dCBpcyBzdG9yZWQgaW4gdGhpcyB2YXJpYWJsZSBpbiBvcmRlciB0b1xuICAgICAqIG1hbnVhbGx5IGZpcmUgaXRzIGV4ZWN1dGlvbiB3aGVuIGEgbmF2aWdhdGlvbiBrZXkgaXMgcHJlc3NlZC5cbiAgICAgKi9cbiAgICBfc3RhY2tUaW1lb3V0OiBUaW1lb3V0PEV2ZW50QmF0Y2g+O1xuICAgIC8qKlxuICAgICAqIE1hcCBvZiB0aGUgc2hhZG93IGRvbSBldmVudCBub3JtYWxpemVyLlxuICAgICAqIElmIGFuIGV2ZW50IGlzIHRyaWdnZXJlZCBpbnNpZGUgYSBzaGFkb3cgZG9tLCB3ZSBpbnN0YW5jaWF0ZSBhIG5ld1xuICAgICAqIEV2ZW50Tm9ybWFsaXplciBpbiB0aGUgc2hhZG93IGRvbS5cbiAgICAgKi9cbiAgICBwcml2YXRlIF9zaGFkb3dOb3JtYWxpemVycyA9IG5ldyBNYXA8RG9jdW1lbnQgfCBTaGFkb3dSb290LCBFdmVudE5vcm1hbGl6ZXI+KCk7XG4gICAgLyoqXG4gICAgICogVGhpcyBpcyBhIGNhY2hlIG9mIHRoZSBzZWxlY3Rpb24gc3RhdGUgdXNlZCBvbmx5IGZvciBkZXRlcm1pbmluZyB3aGV0aGVyXG4gICAgICogYSBwYXJ0aWN1bGFyIGRlbGV0ZUNvbnRlbnQgaXMgYWN0dWFsbHkgYSBkZWxldGVXb3JkIHVzaW5nIHRoZSBTd2lmdEtleVxuICAgICAqIG1vYmlsZSBrZXlib2FyZCBvciBub3QuXG4gICAgICovXG4gICAgcHJpdmF0ZSBfc3dpZnRLZXlEZWxldGVXb3JkU2VsZWN0aW9uQ2FjaGU/OiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbltdID0gW107XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBfaXNJbkVkaXRhYmxlIENhbGxiYWNrIHRvIGNoZWNrIGlmIHRoZSBub2RlIGlzIGluIGVkaXRhYmxlLlxuICAgICAqIEBwYXJhbSBfdHJpZ2dlckV2ZW50QmF0Y2ggQ2FsbGJhY2sgdG8gdHJpZ2dlciBmb3IgZWFjaCB1c2VyIGFjdGlvbi5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBfaXNJbkVkaXRhYmxlOiAobm9kZTogTm9kZSkgPT4gYm9vbGVhbixcbiAgICAgICAgcHJpdmF0ZSBfdHJpZ2dlckV2ZW50QmF0Y2g6IFRyaWdnZXJFdmVudEJhdGNoQ2FsbGJhY2ssXG4gICAgICAgIHByaXZhdGUgcHJvY2Vzc0tleWRvd246IHtcbiAgICAgICAgICAgIGhhbmRsZTogKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkO1xuICAgICAgICAgICAgaGFuZGxlQ2FwdHVyZTogKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkO1xuICAgICAgICB9LFxuICAgICAgICBwcml2YXRlIHJvb3Q6IERvY3VtZW50IHwgU2hhZG93Um9vdCA9IGRvY3VtZW50LFxuICAgICkge1xuICAgICAgICB0aGlzLl9zaGFkb3dOb3JtYWxpemVycy5zZXQocm9vdCwgdGhpcyk7XG4gICAgICAgIHRoaXMuaW5pdE5leHRPYnNlcnZhdGlvbigpO1xuXG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAna2V5ZG93bicsIHByb2Nlc3NLZXlkb3duLmhhbmRsZSk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAna2V5ZG93bicsIHByb2Nlc3NLZXlkb3duLmhhbmRsZUNhcHR1cmUsIHRydWUpO1xuXG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2NvbXBvc2l0aW9uc3RhcnQnLCB0aGlzLl9yZWdpc3RlckV2ZW50KTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnY29tcG9zaXRpb251cGRhdGUnLCB0aGlzLl9yZWdpc3RlckV2ZW50KTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnY29tcG9zaXRpb25lbmQnLCB0aGlzLl9yZWdpc3RlckV2ZW50KTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnYmVmb3JlaW5wdXQnLCB0aGlzLl9yZWdpc3RlckV2ZW50KTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnaW5wdXQnLCB0aGlzLl9yZWdpc3RlckV2ZW50KTtcblxuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdC5vd25lckRvY3VtZW50IHx8IHJvb3QsICdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLl9vblNlbGVjdGlvbkNoYW5nZSk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2NvbnRleHRtZW51JywgdGhpcy5fb25Db250ZXh0TWVudSk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAnbW91c2Vkb3duJywgdGhpcy5fb25Qb2ludGVyRG93bik7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAndG91Y2hzdGFydCcsIHRoaXMuX29uUG9pbnRlckRvd24pO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ2xvYWQtaWZyYW1lJywgdGhpcy5fb25FdmVudEVuYWJsZU5vcm1hbGl6ZXIpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ21vdXNlZG93bicsIHRoaXMuX29uRXZlbnRFbmFibGVOb3JtYWxpemVyKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KHJvb3QsICd0b3VjaHN0YXJ0JywgdGhpcy5fb25FdmVudEVuYWJsZU5vcm1hbGl6ZXIpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ21vdXNldXAnLCB0aGlzLl9vblBvaW50ZXJVcCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAndG91Y2hlbmQnLCB0aGlzLl9vblBvaW50ZXJVcCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2tleWRvd24nLCB0aGlzLl9vbktleURvd25PcktleVByZXNzKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAna2V5cHJlc3MnLCB0aGlzLl9vbktleURvd25PcktleVByZXNzKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KHJvb3QsICdvbmtleXVwJywgdGhpcy5fdXBkYXRlTW9kaWZpZXJzS2V5cyk7XG5cbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnY3V0JywgdGhpcy5fb25DbGlwYm9hcmQpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnRJbkVkaXRhYmxlKHJvb3QsICdwYXN0ZScsIHRoaXMuX29uQ2xpcGJvYXJkKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnZHJhZ3N0YXJ0JywgdGhpcy5fb25EcmFnU3RhcnQpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnRJbkVkaXRhYmxlKHJvb3QsICdkcm9wJywgdGhpcy5fb25Ecm9wKTtcblxuICAgICAgICB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIgPSBuZXcgTXV0YXRpb25Ob3JtYWxpemVyKFxuICAgICAgICAgICAgcm9vdCBpbnN0YW5jZW9mIERvY3VtZW50ID8gcm9vdC5ib2R5IDogcm9vdC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIENyZWF0ZSBFdmVudE5vcm1hbGl6ZXIgZm9yIGFsbCBhbHJlYWR5IGxvYWRlZCBpZnJhbWVzLlxuICAgICAgICBmb3IgKGNvbnN0IGlmcmFtZSBvZiByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpKSB7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVOb3JtYWxpemVyKGlmcmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gZGVzdHJveSB0aGUgZXZlbnQgbm9ybWFsaXplci5cbiAgICAgKiBSZW1vdmUgYWxsIGFkZGVkIGhhbmRsZXJzLlxuICAgICAqXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fbXV0YXRpb25Ob3JtYWxpemVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fdW5iaW5kRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3NoYWRvd05vcm1hbGl6ZXJzLmZvckVhY2goXG4gICAgICAgICAgICBldmVudE5vcm1hbGl6ZXIgPT4gZXZlbnROb3JtYWxpemVyICE9PSB0aGlzICYmIGV2ZW50Tm9ybWFsaXplci5kZXN0cm95KCksXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudEJhdGNoID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNJbkVkaXRhYmxlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEJpbmQgdGhlIG9jY3VyZW5jZSBvZiBnaXZlbiBldmVuIHR5cGUgb24gdGhlIGdpdmVuIHRhcmdldCBlbGVtZW50IHRvIHRoZVxuICAgICAqIGdpdmVuIGxpc3RlbmVyIGZ1bmN0aW9uLiBTZWUgX3VuYmluZEV2ZW50cyB0byB1bmJpbmQgYWxsIGV2ZW50cyBib3VuZCBieVxuICAgICAqIGNhbGxpbmcgdGhpcyBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YXJnZXQgZWxlbWVudCBvbiB3aGljaCB0byBsaXN0ZW4gZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB0eXBlIG9mIHRoZSBldmVudCB0byBsaXN0ZW5cbiAgICAgKiBAcGFyYW0gbGlzdGVuZXIgdG8gY2FsbCB3aGVuIHRoZSBldmVuIG9jY3VycyBvbiB0aGUgdGFyZ2V0XG4gICAgICovXG4gICAgX2JpbmRFdmVudChcbiAgICAgICAgdGFyZ2V0OiBEb2N1bWVudCB8IFNoYWRvd1Jvb3QgfCBXaW5kb3csXG4gICAgICAgIHR5cGU6IHN0cmluZyxcbiAgICAgICAgbGlzdGVuZXI6IEZ1bmN0aW9uLFxuICAgICAgICBjYXB0dXJlID0gdHJ1ZSxcbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYm91bmRMaXN0ZW5lciA9IChldjogRXZlbnRUb1Byb2Nlc3MpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGlmICgndGFyZ2V0JyBpbiBldikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvYyA9IChldi50YXJnZXQgYXMgTm9kZSkub3duZXJEb2N1bWVudDtcbiAgICAgICAgICAgICAgICBpZiAoZG9jICE9PSB0aGlzLnJvb3QgJiYgZG9jICE9PSB0aGlzLnJvb3Qub3duZXJEb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBldik7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2V2ZW50TGlzdGVuZXJzLnB1c2goe1xuICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgbGlzdGVuZXI6IGJvdW5kTGlzdGVuZXIsXG4gICAgICAgICAgICBjYXB0dXJlOiBjYXB0dXJlLFxuICAgICAgICB9KTtcbiAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgYm91bmRMaXN0ZW5lciwgdHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlciBldmVudCBmcm9tIGVkaXRhYmxlLlxuICAgICAqXG4gICAgICogQHNlZSBfYmluZEV2ZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IGVsZW1lbnQgb24gd2hpY2ggdG8gbGlzdGVuIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0gdHlwZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuXG4gICAgICogQHBhcmFtIGxpc3RlbmVyIHRvIGNhbGwgd2hlbiB0aGUgZXZlbiBvY2N1cnMgb24gdGhlIHRhcmdldFxuICAgICAqL1xuICAgIF9iaW5kRXZlbnRJbkVkaXRhYmxlKHRhcmdldDogRG9jdW1lbnQgfCBTaGFkb3dSb290LCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCBib3VuZExpc3RlbmVyID0gKGV2OiBFdmVudFRvUHJvY2Vzcyk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgbGV0IGV2ZW50VGFyZ2V0ID0gJ3RhcmdldCcgaW4gZXYgJiYgKGV2LnRhcmdldCBhcyBOb2RlKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBldmVudFRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgJiZcbiAgICAgICAgICAgICAgICAoZXZlbnRUYXJnZXQuc2hhZG93Um9vdCB8fCBub2RlTmFtZShldmVudFRhcmdldCkgPT09ICdJRlJBTUUnKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlTm9ybWFsaXplcihldmVudFRhcmdldCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChldmVudFRhcmdldCAmJiBldi5jb25zdHJ1Y3Rvci5uYW1lID09PSAnTW91c2VFdmVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQgPSB0aGlzLl9nZXRFdmVudFRhcmdldChldiBhcyBNb3VzZUV2ZW50KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50VGFyZ2V0ICYmIGV2LmNvbnN0cnVjdG9yLm5hbWUgPT09ICdUb3VjaEV2ZW50Jykge1xuICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldCA9IHRoaXMuX2dldEV2ZW50VGFyZ2V0KGV2IGFzIFRvdWNoRXZlbnQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNJbkVkaXRhYmxlKGV2ZW50VGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0Py5vd25lckRvY3VtZW50LmdldFNlbGVjdGlvbigpLmZvY3VzTm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50VGFyZ2V0ICYmIHRoaXMuX2lzSW5FZGl0YWJsZShldmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBldik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQodGFyZ2V0LCB0eXBlLCBib3VuZExpc3RlbmVyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVW5iaW5kIGFsbCBldmVudHMgYm91bmQgYnkgY2FsbHMgdG8gX2JpbmRFdmVudC5cbiAgICAgKlxuICAgICAqL1xuICAgIF91bmJpbmRFdmVudHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2V2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgdGFyZ2V0LCB0eXBlLCBsaXN0ZW5lciwgY2FwdHVyZSB9KSA9PiB7XG4gICAgICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgY2FwdHVyZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBnaXZlbiBldmVudCBvbiB0aGUgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzIHF1ZXVlLlxuICAgICAqIElmIHRoZSBxdWV1ZSBpcyBub3QgeWV0IGluaXRpYWxpemVkIG9yIGhhcyBiZWVuIGNsZWFyZWQgcHJpb3IgdG8gdGhpc1xuICAgICAqIGNhbGwsIHJlLWluaXRpYWxpemUgaXQuIEFmdGVyIGEgdGljayAoc2V0VGltZW91dCAwbXMpIHRoZVxuICAgICAqICdfcHJvY2Vzc0V2ZW50cycgbWV0aG9kIGlzIGNhbGxlZC4gQWxsIGV2ZW50cyB0aGF0IGhhcHBlbmVkIGR1cmluZyB0aGVcbiAgICAgKiB0aWNrIGFyZSByZWFkIGZyb20gdGhlIHF1ZXVlIGFuZCB0aGUgYW5hbHlzaXMgdHJpZXMgdG8gZXh0cmFjdCB0aGVcbiAgICAgKiBhY3Rpb25zIGRlc2lyZWQgYnkgdGhlIHVzZXIgc3VjaCBhcyBpbnNlcnQsIGRlbGV0ZSwgYmFja3NwYWNlLCBzcGVsbFxuICAgICAqIGNoZWNraW5nLCBzcGVjaWFsIGNoYXJhY3RlcnMsIGV0Yy5cbiAgICAgKlxuICAgICAqIEBzZWUgX3Byb2Nlc3NFdmVudHNcbiAgICAgKi9cbiAgICBfcmVnaXN0ZXJFdmVudChldjogRXZlbnRUb1Byb2Nlc3MpOiB2b2lkIHtcbiAgICAgICAgLy8gU2VlIGNvbW1lbnQgb24gYF9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXRgLlxuICAgICAgICBpZiAodGhpcy5fa2V5Ym9hcmRTZWxlY3Rpb25UaW1lb3V0Py5wZW5kaW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXQuZmlyZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNlZSBjb21tZW50IG9uIGBfcG9pbnRlclNlbGVjdGlvblRpbWVvdXRgLlxuICAgICAgICBpZiAodGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQ/LnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0LmZpcmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzTmF2aWdhdGlvbkV2ZW50ID1cbiAgICAgICAgICAgIGV2IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiBldi50eXBlID09PSAna2V5ZG93bicgJiYgbmF2aWdhdGlvbktleS5oYXMoZXYua2V5KTtcblxuICAgICAgICBpZiAoaXNOYXZpZ2F0aW9uRXZlbnQpIHtcbiAgICAgICAgICAgIC8vIE1hbnVhbGx5IHRyaWdnZXJpbmcgdGhlIHByb2Nlc3Npbmcgb2YgdGhlIGN1cnJlbnQgc3RhY2sgYXQgdGhpc1xuICAgICAgICAgICAgLy8gcG9pbnQgZm9yY2VzIHRoZSByZW5kZXJpbmcgaW4gdGhlIERPTSBvZiB0aGUgcmVzdWx0IG9mIHRoZVxuICAgICAgICAgICAgLy8gb2JzZXJ2ZWQgZXZlbnRzLiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgbmV3IHNlbGVjdGlvbiB0aGF0IGlzXG4gICAgICAgICAgICAvLyBldmVudHVhbGx5IGdvaW5nIHRvIGJlIHNldCBieSB0aGUgYnJvd3NlciBhY3R1YWxseSB0YXJnZXRzIG5vZGVzXG4gICAgICAgICAgICAvLyB0aGF0IGFyZSBwcm9wZXJseSByZWNvZ25pemVkIGluIG91ciBhYnN0cmF0aW9uLCB3aGljaCB3b3VsZCBub3RcbiAgICAgICAgICAgIC8vIGJlIHRoZSBjYXNlIG90aGVyd2lzZS4gU2VlIGNvbW1lbnQgb24gYF9zdGFja1RpbWVvdXRgLlxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YWNrVGltZW91dD8ucGVuZGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWNrVGltZW91dC5maXJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUT0RPOiBubyByZW5kZXJpbmcgaW4gZWRpdGFibGUgY2FuIGhhcHBlbiBiZWZvcmUgdGhlIGFuYWx5c2lzIG9mXG4gICAgICAgICAgICAvLyB0aGUgc2VsZWN0aW9uLiBUaGVyZSBzaG91bGQgYmUgYSBtZWNoYW5pc20gaGVyZSB0aGF0IGNhbiBiZSB1c2VkXG4gICAgICAgICAgICAvLyBieSB0aGUgbm9ybWFsaXplciB0byBibG9jayB0aGUgcmVuZGVyaW5nIHVudGlsIHRoaXMgcmVzb2x2ZXMuXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RG9tU2VsZWN0aW9uID0gdGhpcy5fZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLl9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXQgPSBuZXcgVGltZW91dDxFdmVudEJhdGNoPihcbiAgICAgICAgICAgICAgICBhc3luYyAoKTogUHJvbWlzZTxFdmVudEJhdGNoPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0RvbVNlbGVjdGlvbiA9IHRoaXMuX2dldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xsYXBzZWQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RG9tU2VsZWN0aW9uLmFuY2hvck5vZGUgPT09IG5ld0RvbVNlbGVjdGlvbi5mb2N1c05vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RvbVNlbGVjdGlvbi5hbmNob3JPZmZzZXQgPT09IG5ld0RvbVNlbGVjdGlvbi5mb2N1c09mZnNldDtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgZG9tU2VsZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sbGFwc2VkICYmICF0aGlzLl9pc0luRWRpdGFibGUobmV3RG9tU2VsZWN0aW9uLmFuY2hvck5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IGEgY29sbGFwc2VkIHNlbGVjdGlvbiBvdXRzaWRlIHRoZSBlZGl0YWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29udGV4dDoga2VlcCB0aGUgY3VycmVudCBzZWxlY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICBkb21TZWxlY3Rpb24gPSBjdXJyZW50RG9tU2VsZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uID0gbmV3RG9tU2VsZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NldFNlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBkb21TZWxlY3Rpb246IGRvbVNlbGVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgYWN0aW9uczogW3NldFNlbGVjdGlvbkFjdGlvbl0sIG11dGF0ZWRFbGVtZW50czogbmV3IFNldChbXSkgfTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudEJhdGNoKHRoaXMuX2tleWJvYXJkU2VsZWN0aW9uVGltZW91dC5wcm9taXNlKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdE5leHRPYnNlcnZhdGlvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgcXVldWUgaXMgbm90IGluaXRpYWxpemVkIG9yIGhhcyBiZWVuIHJlc2V0LCBzbyB0aGlzIGlzIGFcbiAgICAgICAgICAgICAgICAvLyBuZXcgdXNlciBhY3Rpb24uIFJlLWluaXRpYWxpemUgdGhlIHF1ZXVlIHN1Y2ggdGhhdCB0aGVcbiAgICAgICAgICAgICAgICAvLyBhbmFseXNpcyBpcyBub3QgcG9sbHV0ZWQgYnkgcHJldmlvdXMgb2JzZXJ2YXRpb25zLlxuXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5pbml0TmV4dE9ic2VydmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhY2sgPSB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uO1xuXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgb2JzZXJ2aW5nIG11dGF0aW9ucy5cbiAgICAgICAgICAgICAgICB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIuc3RhcnQoKTtcblxuICAgICAgICAgICAgICAgIC8vIEFsbCBldmVudHMgb2YgdGhpcyB0aWNrIHdpbGwgYmUgcHJvY2Vzc2VkIGluIHRoZSBuZXh0IG9uZS5cbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFja1RpbWVvdXQgPSBuZXcgVGltZW91dDxFdmVudEJhdGNoPihcbiAgICAgICAgICAgICAgICAgICAgKCk6IFByb21pc2U8RXZlbnRCYXRjaD4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb2Nlc3NFdmVudHMoc3RhY2spO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50QmF0Y2godGhpcy5fc3RhY2tUaW1lb3V0LnByb21pc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJdCBpcyBwb3NzaWJsZSB0byBoYXZlIG11bHRpcGxlcyBrZXlzIHRoYXQgbXVzdCB0cmlnZ2VyIG11bHRpcGxlc1xuICAgICAgICAgICAgLy8gdGltZXMgdGhhdCBhcmUgYmVpbmcgcHVzaCBpbiB0aGUgc2FtZSB0aWNrLiBUbyBiZSBhYmxlIHRvIGhhbmRsZVxuICAgICAgICAgICAgLy8gdGhpcyBjYXNlIGluIGBfcHJvY2Vzc0V2ZW50c2AsIHdlIGFnZ3JlZ2F0ZSB0aGUgaW5mb3JtYXRpb25zIGluXG4gICAgICAgICAgICAvLyBgX211bHRpS2V5U3RhY2tgLlxuICAgICAgICAgICAgaWYgKFsna2V5ZG93bicsICdrZXlwcmVzcycsICdpbnB1dCddLmluY2x1ZGVzKGV2LnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gdGhlIG11bHRpcGxlIGtleSBjYXNlLCBhICdrZXlkb3duJyBpcyBhbHdheXMgdGhlIGZpcnN0XG4gICAgICAgICAgICAgICAgLy8gZXZlbnQgdHJpZ2dlcmVkIGJldHdlZW4gdGhlIHRocmVlIChrZXlkb3duLCBrZXlwcmVzcywgaW5wdXQpLlxuICAgICAgICAgICAgICAgIC8vIFNvIHdlIGNyZWF0ZSBhIG5ldyBtYXAgZWFjaCB0aW1lIGEgJ2tleWRvd24nIGlzIHJlZ2lzdHJlZC5cbiAgICAgICAgICAgICAgICBpZiAoZXYgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50ICYmIGV2LnR5cGUgPT09ICdrZXlkb3duJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9tdWx0aUtleVN0YWNrLnB1c2goe30pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIERyb3AgYW55IHNlbGVjdGlvbiB0aGF0IGlzIG5vdCB0aGUgbGFzdCBvbmUgYmVmb3JlIGlucHV0LlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zd2lmdEtleURlbGV0ZVdvcmRTZWxlY3Rpb25DYWNoZSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N3aWZ0S2V5RGVsZXRlV29yZFNlbGVjdGlvbkNhY2hlLnBvcCgpLFxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TXVsdGlLZXlzID0gdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFja1tcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFjay5sZW5ndGggLSAxXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdE11bHRpS2V5cykge1xuICAgICAgICAgICAgICAgICAgICBsYXN0TXVsdGlLZXlzW2V2LnR5cGVdID0gZXY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXBbZXYudHlwZV0gPSBldjtcbiAgICAgICAgICAgIGlmIChldi50eXBlLnN0YXJ0c1dpdGgoJ2NvbXBvc2l0aW9uJykpIHtcbiAgICAgICAgICAgICAgICAvLyBJbiBtb3N0IGNhc2VzIHdlIG9ubHkgbmVlZCB0aGUgbGFzdCBjb21wb3NpdGlvbiBvZiB0aGVcbiAgICAgICAgICAgICAgICAvLyByZWdpc3RyZWQgZXZlbnRzXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmxhc3RDb21wb3NpdGlvbiA9IGV2IGFzIENvbXBvc2l0aW9uRXZlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHMucHVzaChldik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBpcyB0aGUgcm9vdCBvZiB0aGUgbm9ybWFsaXphdGlvbiBmb3IgbW9zdCBldmVudHMuXG4gICAgICpcbiAgICAgKiBQcm9jZXNzIHRoZSBldmVudHMgcmVnaXN0ZXJlZCB3aXRoIGBfcmVnaXRlckV2ZW50YCBhbmQgY2FsbFxuICAgICAqIGBfdHJpZ2dlckV2ZW50QmF0Y2hgIHdpdGggb25lIG9yIG1vcmUgYE5vcm1hbGl6ZWRFdmVudGAgd2hlbiBzdWZmaWNpZW50XG4gICAgICogaW5mb3JtYXRpb24gaGFzIGJlZW4gZ2F0aGVyZWQgZnJvbSBhbGwgcmVnaXN0cmVkIGV2ZW50cy5cbiAgICAgKlxuICAgICAqIEl0IGNvdWxkIHRha2UgdXAgdG8gdHdvIHRpY2sgaW4gdGhlIGJyb3dzZXIgdG8gZ2F0aGVyIGFsbCB0aGUgc3VmZmljaWVudFxuICAgICAqIGluZm9ybWF0aW9uLiAoZS5nLiBTYWZhcmkpXG4gICAgICpcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEluIHNvbWUgY2FzZXMsIHRoZSBvYnNlcnZhdGlvbiBtdXN0IGJlIGRlbGF5ZWQgdG8gdGhlIG5leHQgdGljay4gSW4gdGhlc2VcbiAgICAgKiBjYXNlcywgdGhpcyBjb250cm9sIHZhcmlhYmxlIHdpbGwgYmUgc2V0IHRvIHRydWUgc3VjaCB0aGF0IHRoZSBhbmFseXNpc1xuICAgICAqIHByb2Nlc3Mga25vd3MgdGhlIGN1cnJlbnQgZXZlbnQgcXVldWUgcHJvY2Vzc2luZyBoYXMgYmVlbiBkZWxheWVkLlxuICAgICAqL1xuICAgIGFzeW5jIF9wcm9jZXNzRXZlbnRzKFxuICAgICAgICBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbjogQ3VycmVudFN0YWNrT2JzZXJ2YXRpb25zLFxuICAgICAgICBzZWNvbmRUaWNrT2JzZXJ2YXRpb24gPSBmYWxzZSxcbiAgICApOiBQcm9taXNlPEV2ZW50QmF0Y2g+IHtcbiAgICAgICAgLy8gSW4gc29tZSBjYXNlcywgZm9yIGV4YW1wbGUgY3V0dGluZyB3aXRoIENtZCtYIG9uIFNhZmFyaSwgdGhlIGJyb3dzZXJcbiAgICAgICAgLy8gdHJpZ2dlcnMgZXZlbnRzIGluIHR3byBkaWZmZXJlbnQgc3RhY2tzLiBJbiBzdWNoIGNhc2VzLCBvYnNlcnZpbmdcbiAgICAgICAgLy8gZXZlbnRzIG9jY3VyaW5nIGR1cmluZyBvbmUgdGljayBpcyBub3QgZW5vdWdoIHNvIHdlIG5lZWQgdG8gZGVsYXkgdGhlXG4gICAgICAgIC8vIGFuYWx5c2lzIGFmdGVyIHdlIG9ic2VydmUgZXZlbnRzIGR1cmluZyB0d28gdGlja3MgaW5zdGVhZC5cbiAgICAgICAgY29uc3QgbmVlZFNlY29uZFRpY2tPYnNlcnZhdGlvbiA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHMuZXZlcnkoZXYgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICFNdWx0aVN0YWNrRXZlbnRUeXBlcy5pbmNsdWRlcyhldi50eXBlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChuZWVkU2Vjb25kVGlja09ic2VydmF0aW9uICYmICFzZWNvbmRUaWNrT2JzZXJ2YXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuX3Byb2Nlc3NFdmVudHMoY3VycmVudFN0YWNrT2JzZXJ2YXRpb24sIHRydWUpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5vcm1hbGl6ZWRBY3Rpb25zOiBOb3JtYWxpemVkQWN0aW9uW10gPSBbXTtcblxuICAgICAgICBjb25zdCBrZXlkb3duRXZlbnQgPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmtleWRvd247XG4gICAgICAgIGNvbnN0IGtleXByZXNzRXZlbnQgPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmtleXByZXNzO1xuICAgICAgICBjb25zdCBpbnB1dEV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5pbnB1dDtcbiAgICAgICAgY29uc3Qga2V5Ym9hcmRTZWxlY3RBbGxFdmVudCA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXAua2V5Ym9hcmRTZWxlY3RBbGw7XG4gICAgICAgIGNvbnN0IGNvbXBvc2l0aW9uRXZlbnQgPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmxhc3RDb21wb3NpdGlvbjtcbiAgICAgICAgY29uc3QgY3V0RXZlbnQgPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmN1dDtcbiAgICAgICAgY29uc3QgZHJvcEV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5kcm9wO1xuICAgICAgICBjb25zdCBwYXN0ZUV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5wYXN0ZTtcblxuICAgICAgICBjb25zdCBjb21wb3NpdGlvbkRhdGEgPSB0aGlzLl9nZXRDb21wb3NpdGlvbkRhdGEoY29tcG9zaXRpb25FdmVudCwgaW5wdXRFdmVudCk7XG5cbiAgICAgICAgY29uc3QgaXNHb29nbGVLZXlib2FyZEJhY2tzcGFjZSA9XG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YS5jb21wb3NpdGlvbkZyb20uc2xpY2UoMCwgLTEpID09PSBjb21wb3NpdGlvbkRhdGEuY29tcG9zaXRpb25UbyAmJlxuICAgICAgICAgICAga2V5ZG93bkV2ZW50ICYmXG4gICAgICAgICAgICBrZXlkb3duRXZlbnQua2V5ID09PSAnVW5pZGVudGlmaWVkJztcblxuICAgICAgICBjb25zdCBpbmZlcnJlZEtleWRvd25FdmVudDogSW5mZXJyZWRLZXlkb3duRXZlbnQgPVxuICAgICAgICAgICAga2V5ZG93bkV2ZW50ICYmXG4gICAgICAgICAgICBrZXlkb3duRXZlbnQua2V5ID09PSAnVW5pZGVudGlmaWVkJyAmJlxuICAgICAgICAgICAgdGhpcy5faW5mZXJLZXlkb3duRXZlbnQoaW5wdXRFdmVudCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIEZpcnN0IHBhc3MgdG8gZ2V0IHRoZSBpbmZvcm1hdGlvbnNcbiAgICAgICAgLy9cbiAgICAgICAgY29uc3Qga2V5OiBzdHJpbmcgPVxuICAgICAgICAgICAgKGtleXByZXNzRXZlbnQgJiZcbiAgICAgICAgICAgICAgICBrZXlwcmVzc0V2ZW50LmtleSAhPT0gJ1VuaWRlbnRpZmllZCcgJiZcbiAgICAgICAgICAgICAgICBrZXlwcmVzc0V2ZW50LmtleSAhPT0gJ0RlYWQnICYmXG4gICAgICAgICAgICAgICAga2V5cHJlc3NFdmVudC5rZXkpIHx8XG4gICAgICAgICAgICAoaW5wdXRFdmVudCAmJiBpbnB1dEV2ZW50LmRhdGE/Lmxlbmd0aCA9PT0gMSAmJiBpbnB1dEV2ZW50LmRhdGEpIHx8XG4gICAgICAgICAgICAoa2V5ZG93bkV2ZW50ICYmXG4gICAgICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSAhPT0gJ1VuaWRlbnRpZmllZCcgJiZcbiAgICAgICAgICAgICAgICBrZXlkb3duRXZlbnQua2V5ICE9PSAnRGVhZCcgJiZcbiAgICAgICAgICAgICAgICBrZXlkb3duRXZlbnQua2V5KSB8fFxuICAgICAgICAgICAgKGlzR29vZ2xlS2V5Ym9hcmRCYWNrc3BhY2UgJiYgJ0JhY2tzcGFjZScpIHx8XG4gICAgICAgICAgICAoa2V5ZG93bkV2ZW50ICYmXG4gICAgICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSA9PT0gJ1VuaWRlbnRpZmllZCcgJiZcbiAgICAgICAgICAgICAgICBpbmZlcnJlZEtleWRvd25FdmVudCAmJlxuICAgICAgICAgICAgICAgIGluZmVycmVkS2V5ZG93bkV2ZW50LmNvZGUpO1xuICAgICAgICBjb25zdCBpbnB1dFR5cGUgPVxuICAgICAgICAgICAgKGN1dEV2ZW50ICYmICdkZWxldGVCeUN1dCcpIHx8XG4gICAgICAgICAgICAoZHJvcEV2ZW50ICYmICdpbnNlcnRGcm9tRHJvcCcpIHx8XG4gICAgICAgICAgICAocGFzdGVFdmVudCAmJiAnaW5zZXJ0RnJvbVBhc3RlJykgfHxcbiAgICAgICAgICAgIChpbnB1dEV2ZW50ICYmIGlucHV0RXZlbnQuaW5wdXRUeXBlKTtcblxuICAgICAgICAvLyBJbiBjYXNlIG9mIGFjY2VudCBpbnNlcnRlZCBmcm9tIGEgTWFjLCBjaGVjayB0aGF0IHRoZSBjaGFyIGJlZm9yZSB3YXNcbiAgICAgICAgLy8gb25lIG9mIHRoZSBzcGVjaWFsIGFjY2VudCB0ZW1wb3JhcmlseSBpbnNlcnRlZCBpbiB0aGUgRE9NIChlLmcuICdeJyxcbiAgICAgICAgLy8gJ2AnLCAuLi4pLlxuICAgICAgICAvL1xuICAgICAgICBjb25zdCBjb21wb3NpdGlvblJlcGxhY2VPbmVDaGFyID1cbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YSAmJlxuICAgICAgICAgICAgY29tcG9zaXRpb25EYXRhLmNvbXBvc2l0aW9uRnJvbS5sZW5ndGggPT09IDEgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YS5jb21wb3NpdGlvblRvLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgY29uc3QgY29tcG9zaXRpb25BZGRPbmVDaGFyID1cbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YSAmJlxuICAgICAgICAgICAgY29tcG9zaXRpb25EYXRhLmNvbXBvc2l0aW9uRnJvbSA9PT0gJycgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YS5jb21wb3NpdGlvblRvLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgY29uc3QgaXNDb21wb3NpdGlvbktleWJvYXJkID0gY29tcG9zaXRpb25BZGRPbmVDaGFyIHx8IGNvbXBvc2l0aW9uUmVwbGFjZU9uZUNoYXI7XG5cbiAgICAgICAgY29uc3QgaXNWaXJ0dWFsS2V5Ym9hcmQgPSBjb21wb3NpdGlvbkV2ZW50ICYmIGtleSAmJiBrZXkubGVuZ3RoICE9PSAxO1xuXG4gICAgICAgIC8vIENvbXB1dGUgdGhlIHNldCBvZiBtdXRhdGVkIGVsZW1lbnRzIGFjY3Jvc3MgYWxsIG9ic2VydmVkIGV2ZW50cy5cbiAgICAgICAgY29uc3QgbXV0YXRlZEVsZW1lbnRzID0gdGhpcy5fbXV0YXRpb25Ob3JtYWxpemVyLmdldE11dGF0ZWRFbGVtZW50cygpO1xuICAgICAgICB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIuc3RvcCgpO1xuXG4gICAgICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgdHJpZ2dlciBtdWx0aXBsZXMga2V5ZG93biBhdCBvbmNlLCBmb3IgZWFjaCBrZXlkb3duXG4gICAgICAgIC8vIHRoZXJlIGlzIGFsd2F5cyBhbHNvIGEga2V5cHJlc3MgYW5kIGFuIGlucHV0IHRoYXQgbXVzdCBiZSBwcmVzZW50LlxuICAgICAgICBjb25zdCBwb3NzaWJsZU11bHRpS2V5ZG93biA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9tdWx0aUtleVN0YWNrLmV2ZXJ5KFxuICAgICAgICAgICAga2V5ZG93bk1hcCA9PlxuICAgICAgICAgICAgICAgIGtleWRvd25NYXAua2V5ZG93biAmJlxuICAgICAgICAgICAgICAgIGtleWRvd25NYXAua2V5ZG93bi5rZXkgIT09ICdVbmlkZW50aWZpZWQnICYmXG4gICAgICAgICAgICAgICAgKGtleWRvd25NYXAuaW5wdXQgfHwga2V5ZG93bk1hcC5rZXlkb3duLmtleS5sZW5ndGggPiAxKSxcbiAgICAgICAgKTtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgb25seSBvbmUgX211bHRpS2V5TWFwLCBpdCBtZWFucyB0aGF0IHRoZXJlIGlzIG5vXG4gICAgICAgIC8vIG11bHRpcGxlcyBrZXlzIHB1c2hlZC5cbiAgICAgICAgaWYgKGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9tdWx0aUtleVN0YWNrLmxlbmd0aCA+IDEgJiYgcG9zc2libGVNdWx0aUtleWRvd24pIHtcbiAgICAgICAgICAgIGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9tdWx0aUtleVN0YWNrLm1hcChrZXlkb3duTWFwID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBrZXlib2FyZEFjdGlvbiA9IHRoaXMuX2dldEtleWJvYXJkQWN0aW9uKFxuICAgICAgICAgICAgICAgICAgICBrZXlkb3duTWFwLmtleWRvd24ua2V5LFxuICAgICAgICAgICAgICAgICAgICAoa2V5ZG93bk1hcC5pbnB1dCAmJiBrZXlkb3duTWFwLmlucHV0LmlucHV0VHlwZSkgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICEhbXV0YXRlZEVsZW1lbnRzLnNpemUsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5Ym9hcmRBY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaChrZXlib2FyZEFjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY3V0RXZlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlbGV0ZUNvbnRlbnRBY3Rpb246IERlbGV0ZUNvbnRlbnRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2RlbGV0ZUNvbnRlbnQnLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uLkZPUldBUkQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHByZXZpb3VzbHkgcGFyc2VkIGtleWJvYXJkIGFjdGlvbiBhcyB3ZSBvbmx5IHdhbnQgdG8gcmVtb3ZlXG4gICAgICAgICAgICBub3JtYWxpemVkQWN0aW9ucy5wdXNoKGRlbGV0ZUNvbnRlbnRBY3Rpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKGRyb3BFdmVudCkge1xuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaCguLi50aGlzLl9nZXREcm9wQWN0aW9ucyhkcm9wRXZlbnQpKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXN0ZUV2ZW50KSB7XG4gICAgICAgICAgICBub3JtYWxpemVkQWN0aW9ucy5wdXNoKHRoaXMuX2dldERhdGFUcmFuc2ZlckFjdGlvbihwYXN0ZUV2ZW50KSk7XG4gICAgICAgIH0gZWxzZSBpZiAoa2V5Ym9hcmRTZWxlY3RBbGxFdmVudCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0QWxsQWN0aW9uOiBTZWxlY3RBbGxBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdEFsbCcsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaChzZWxlY3RBbGxBY3Rpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMubGVuZ3RoID09PSAwICYmXG4gICAgICAgICAgICAoKCFjb21wb3NpdGlvbkV2ZW50ICYmIGtleSkgfHwgaXNDb21wb3NpdGlvbktleWJvYXJkIHx8IGlzVmlydHVhbEtleWJvYXJkKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGNvbnN0IGtleWJvYXJkQWN0aW9uID0gdGhpcy5fZ2V0S2V5Ym9hcmRBY3Rpb24oXG4gICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgIGlucHV0VHlwZSxcbiAgICAgICAgICAgICAgICAhIW11dGF0ZWRFbGVtZW50cy5zaXplLFxuICAgICAgICAgICAgICAgIGtleWRvd25FdmVudCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoa2V5Ym9hcmRBY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkQWN0aW9ucy5wdXNoKGtleWJvYXJkQWN0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbXBvc2l0aW9uUmVwbGFjZU9uZUNoYXIpIHtcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkQWN0aW9ucyA9IGNvbXBvc2l0aW9uRGF0YS5hY3Rpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG5vcm1hbGl6ZWRBY3Rpb25zLmxlbmd0aCA9PT0gMCAmJiBjb21wb3NpdGlvbkRhdGEpIHtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goLi4uY29tcG9zaXRpb25EYXRhLmFjdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlucHV0RXZlbnQgJiYgaW5wdXRFdmVudC5pbnB1dFR5cGUgJiYgaW5wdXRFdmVudC5pbnB1dFR5cGUuaW5kZXhPZignZm9ybWF0JykgPT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdE5hbWUgPSBpbnB1dEV2ZW50LmlucHV0VHlwZS5yZXBsYWNlKCdmb3JtYXQnLCAnJykudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgY29uc3QgYXBwbHlGb3JtYXRBY3Rpb246IEFwcGx5Rm9ybWF0QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdhcHBseUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXROYW1lLFxuICAgICAgICAgICAgICAgIGRhdGE6IGlucHV0RXZlbnQuZGF0YSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goYXBwbHlGb3JtYXRBY3Rpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKGlucHV0RXZlbnQgJiYgWydoaXN0b3J5VW5kbycsICdoaXN0b3J5UmVkbyddLmluY2x1ZGVzKGlucHV0RXZlbnQuaW5wdXRUeXBlKSkge1xuICAgICAgICAgICAgY29uc3QgaGlzdG9yeUFjdGlvbjogSGlzdG9yeUFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBpbnB1dEV2ZW50LmlucHV0VHlwZSBhcyAnaGlzdG9yeVVuZG8nIHwgJ2hpc3RvcnlSZWRvJyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBub3JtYWxpemVkQWN0aW9ucy5wdXNoKGhpc3RvcnlBY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbml0TmV4dE9ic2VydmF0aW9uKCk7XG5cbiAgICAgICAgaWYgKG5vcm1hbGl6ZWRBY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGJhdGNoOiBFdmVudEJhdGNoID0ge1xuICAgICAgICAgICAgICAgIGFjdGlvbnM6IG5vcm1hbGl6ZWRBY3Rpb25zLFxuICAgICAgICAgICAgICAgIG11dGF0ZWRFbGVtZW50cyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoaW5mZXJyZWRLZXlkb3duRXZlbnQpIHtcbiAgICAgICAgICAgICAgICBiYXRjaC5pbmZlcnJlZEtleWRvd25FdmVudCA9IGluZmVycmVkS2V5ZG93bkV2ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJhdGNoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGFjdGlvbnM6IFtdIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBuZXh0IG9ic2VydmF0aW9uLlxuICAgICAqL1xuICAgIGluaXROZXh0T2JzZXJ2YXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2ZvbGxvd3NQb2ludGVyQWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24gPSB7XG4gICAgICAgICAgICBfZXZlbnRzOiBbXSxcbiAgICAgICAgICAgIF9tdWx0aUtleVN0YWNrOiBbXSxcbiAgICAgICAgICAgIF9ldmVudHNNYXA6IHt9LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIF9nZXRDb21wb3NpdGlvbkRhdGEoXG4gICAgICAgIGNvbXBvc2l0aW9uRXZlbnQ6IENvbXBvc2l0aW9uRXZlbnQgfCB1bmRlZmluZWQsXG4gICAgICAgIGlucHV0RXZlbnQ6IElucHV0RXZlbnQgfCB1bmRlZmluZWQsXG4gICAgKTogQ29tcG9zaXRpb25EYXRhIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgaWYgKGNvbXBvc2l0aW9uRXZlbnQgJiYgaW5wdXRFdmVudCkge1xuICAgICAgICAgICAgbGV0IGNvbXBvc2l0aW9uRGF0YVN0cmluZzogc3RyaW5nID0gY29tcG9zaXRpb25FdmVudC5kYXRhO1xuXG4gICAgICAgICAgICAvLyBTcGVjaWZpYyBjYXNlIGZvciBTd2lmdEtleS4gU3dpZnRrZXkgYWRkIGEgc3BhY2UgaW4gdGhlXG4gICAgICAgICAgICAvLyBpbnB1dEV2ZW50IGJ1dCBub3QgaW4gdGhlIGNvbXBvc2l0aW9uIGV2ZW50LlxuICAgICAgICAgICAgY29uc3QgaXNTd2lmdEtleUF1dG9jb3JyZWN0ID1cbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmlucHV0VHlwZSA9PT0gJ2luc2VydFRleHQnICYmXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudC5kYXRhICYmXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudC5kYXRhLmxlbmd0aCA9PT0gMSAmJlxuICAgICAgICAgICAgICAgIGlucHV0RXZlbnQuZGF0YSAhPT0gY29tcG9zaXRpb25EYXRhU3RyaW5nICYmXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudC5kYXRhID09PSAnICc7XG4gICAgICAgICAgICBpZiAoaXNTd2lmdEtleUF1dG9jb3JyZWN0KSB7XG4gICAgICAgICAgICAgICAgY29tcG9zaXRpb25EYXRhU3RyaW5nICs9ICcgJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENvbXBvc2l0aW9uRnJvbVN0cmluZyhjb21wb3NpdGlvbkRhdGFTdHJpbmcpO1xuICAgICAgICB9IGVsc2UgaWYgKGlucHV0RXZlbnQgJiYgaW5wdXRFdmVudC5pbnB1dFR5cGUgPT09ICdpbnNlcnRSZXBsYWNlbWVudFRleHQnKSB7XG4gICAgICAgICAgICAvLyBzYWZhcmkgdHJpZ2dlciBhbiBpbnB1dCB3aXRoICdpbnNlcnRSZXBsYWNlbWVudFRleHQnIHdoZW4gaXRcbiAgICAgICAgICAgIC8vIGNvcnJlY3QgYSB3b3JkLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENvbXBvc2l0aW9uRnJvbVN0cmluZyhpbnB1dEV2ZW50LmRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5mZXIgYSBgS2V5Ym9hcmRFdmVudGAgYGNvZGVgIGZyb20gYW4gYElucHV0RXZlbnRgXG4gICAgICovXG4gICAgX2luZmVyS2V5ZG93bkV2ZW50KGlucHV0RXZlbnQ6IElucHV0RXZlbnQpOiBJbmZlcnJlZEtleWRvd25FdmVudCB7XG4gICAgICAgIGxldCBjb2RlOiBJbmZlcnJlZENvZGVWYWx1ZTtcbiAgICAgICAgaWYgKGlucHV0RXZlbnQuaW5wdXRUeXBlID09PSAnaW5zZXJ0UGFyYWdyYXBoJykge1xuICAgICAgICAgICAgY29kZSA9ICdFbnRlcic7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRFdmVudC5pbnB1dFR5cGUgPT09ICdkZWxldGVDb250ZW50QmFja3dhcmQnKSB7XG4gICAgICAgICAgICBjb2RlID0gJ0JhY2tzcGFjZSc7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRFdmVudC5pbnB1dFR5cGUgPT09ICdkZWxldGVDb250ZW50Rm9yd2FyZCcpIHtcbiAgICAgICAgICAgIGNvZGUgPSAnRGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLl9tb2RpZmllcktleXMsXG4gICAgICAgICAgICAgICAga2V5OiBjb2RlLFxuICAgICAgICAgICAgICAgIGNvZGU6IGNvZGUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhIGtleWJvYXJkIGFjdGlvbiBpZiBzb21ldGhpbmcgaGFzIGhhcHBuZWQgaW4gdGhlIERPTSAoaW5zZXJ0LFxuICAgICAqIGRlbGV0ZSwgbmF2aWdhdGlvbikuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICogQHBhcmFtIGlucHV0VHlwZVxuICAgICAqIEBwYXJhbSBoYXNNdXRhdGFlZEVsZW1lbnRzXG4gICAgICogQHBhcmFtIGlzTXVsdGlLZXlcbiAgICAgKi9cbiAgICBfZ2V0S2V5Ym9hcmRBY3Rpb24oXG4gICAgICAgIGtleTogc3RyaW5nLFxuICAgICAgICBpbnB1dFR5cGU6IHN0cmluZyxcbiAgICAgICAgaGFzTXV0YXRlZEVsZW1lbnRzOiBib29sZWFuLFxuICAgICAgICBrZXlkb3duRXZlbnQ/OiBLZXlib2FyZEV2ZW50LFxuICAgICk6XG4gICAgICAgIHwgSW5zZXJ0TGluZUJyZWFrQWN0aW9uXG4gICAgICAgIHwgSW5zZXJ0UGFyYWdyYXBoQnJlYWtBY3Rpb25cbiAgICAgICAgfCBJbnNlcnRUZXh0QWN0aW9uXG4gICAgICAgIHwgU2V0U2VsZWN0aW9uQWN0aW9uXG4gICAgICAgIHwgRGVsZXRlV29yZEFjdGlvblxuICAgICAgICB8IERlbGV0ZUhhcmRMaW5lQWN0aW9uXG4gICAgICAgIHwgRGVsZXRlQ29udGVudEFjdGlvbiB7XG4gICAgICAgIGNvbnN0IGlzSW5zZXJ0T3JSZW1vdmVBY3Rpb24gPSBoYXNNdXRhdGVkRWxlbWVudHMgJiYgIWlucHV0VHlwZUNvbW1hbmRzLmhhcyhpbnB1dFR5cGUpO1xuICAgICAgICBpZiAoaXNJbnNlcnRPclJlbW92ZUFjdGlvbikge1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ0JhY2tzcGFjZScgfHwga2V5ID09PSAnRGVsZXRlJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRSZW1vdmVBY3Rpb24oa2V5LCBpbnB1dFR5cGUsIGtleWRvd25FdmVudCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFR5cGUgPT09ICdpbnNlcnRMaW5lQnJlYWsnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydExpbmVCcmVha0FjdGlvbjogSW5zZXJ0TGluZUJyZWFrQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydExpbmVCcmVhaycsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnNlcnRMaW5lQnJlYWtBY3Rpb247XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0UGFyYWdyYXBoQWN0aW9uOiBJbnNlcnRQYXJhZ3JhcGhCcmVha0FjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRQYXJhZ3JhcGhCcmVhaycsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnNlcnRQYXJhZ3JhcGhBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0VGV4dEFjdGlvbjogSW5zZXJ0VGV4dEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydFRleHQnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBrZXksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0VGV4dEFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGlvbnMgZm9yIGEgZXZlbnQgYGV2YCBvZiB0eXBlIGRyb3AuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBfZ2V0RHJvcEFjdGlvbnMoZXY6IERhdGFUcmFuc2ZlckRldGFpbHMpOiAoRGVsZXRlQ29udGVudEFjdGlvbiB8IFNldFNlbGVjdGlvbkFjdGlvbilbXSB7XG4gICAgICAgIGNvbnN0IGFjdGlvbnMgPSBbXTtcbiAgICAgICAgaWYgKGV2LmRyYWdnaW5nRnJvbUVkaXRhYmxlICYmICFldi5maWxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVDb250ZW50QWN0aW9uOiBEZWxldGVDb250ZW50QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGVsZXRlQ29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uLkZPUldBUkQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goZGVsZXRlQ29udGVudEFjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzZXRTZWxlY3Rpb25BY3Rpb246IFNldFNlbGVjdGlvbkFjdGlvbiA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiBldi5zZWxlY3Rpb24sXG4gICAgICAgIH07XG4gICAgICAgIGFjdGlvbnMucHVzaChzZXRTZWxlY3Rpb25BY3Rpb24pO1xuICAgICAgICBhY3Rpb25zLnB1c2godGhpcy5fZ2V0RGF0YVRyYW5zZmVyQWN0aW9uKGV2KSk7XG4gICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGluZm9ybWF0aW9ucyBmcm9tIGRhdGFUcmFuc2VyIHRvIGtub3cgd2hhdCBoYXMgYmVlbiBkb25lIGluIHRoZVxuICAgICAqIERPTSBhbmQgcmV0dXJuIGl0IGEgbm9ybWFsaXplZEFjdGlvbi5cbiAgICAgKlxuICAgICAqIHdoZW4gZHJhZyBhbmQgZHJvcHBpbmcsIG1vc3QgYnJvd3NlcnMgd3JhcCB0aGUgZWxlbWVudCB3aXRoIHRhZ3MgYW5kXG4gICAgICogc3R5bGVzLiAgQW5kIHdoZW4gZHJvcHBpbmcgaW4gdGhlIChzYW1lIG9yIGRpZmZlcmVudCkgYnJvd3NlciwgdGhlcmUgaXNcbiAgICAgKiBtYW55IGRpZmZlcmVudHMgYmVoYXZpb3IuXG4gICAgICpcbiAgICAgKiBTb21lIGJyb3dzZXIgcmVsb2FkIHRoZSBwYWdlIHdoZW4gZHJvcHBpbmcgKGltZyBvciBsaW5rIChmcm9tIHN0YXR1c1xuICAgICAqIGJhcikpLiAgRm9yIHRoaXMgcmVhc29uLCB3ZSBibG9jayBhbGwgdGhlIGNvbnRlbnQgZnJvbSBiZWluZyBhZGRlZCBpbiB0aGVcbiAgICAgKiBlZGl0YWJsZS4gKG90aGVyd2lzZSByZWxvYWRpbmcgaGFwcGVuKS5cbiAgICAgKlxuICAgICAqIE5vdGU6IFRoZSB1c2VyIGNhbiBkcmFnIGFuZCBkcm9wIGEgbGluayBvciBhbiBpbWcsIGZyb20gdGhlIGJyb3dzZXJcbiAgICAgKiBuYXZpZ2F0aW9uIGJhci5cbiAgICAgKlxuICAgICAqL1xuICAgIF9nZXREYXRhVHJhbnNmZXJBY3Rpb24oXG4gICAgICAgIGRhdGFUcmFuc2ZlcjogRGF0YVRyYW5zZmVyRGV0YWlscyxcbiAgICApOiBJbnNlcnRGaWxlc0FjdGlvbiB8IEluc2VydEh0bWxBY3Rpb24gfCBJbnNlcnRUZXh0QWN0aW9uIHtcbiAgICAgICAgaWYgKGRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydEZpbGVzQWN0aW9uOiBJbnNlcnRGaWxlc0FjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnaW5zZXJ0RmlsZXMnLFxuICAgICAgICAgICAgICAgIGZpbGVzOiBkYXRhVHJhbnNmZXIuZmlsZXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGluc2VydEZpbGVzQWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVyaSA9IGRhdGFUcmFuc2ZlclsndGV4dC91cmktbGlzdCddO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29udHJvbC1yZWdleFxuICAgICAgICBjb25zdCBodG1sID0gZGF0YVRyYW5zZmVyWyd0ZXh0L2h0bWwnXS5yZXBsYWNlKC9cXHgwMC9nLCAnJyk7IC8vIHJlcGxhY2UgZm9yIGRyYWcmZHJvcCBmcm9tIGZpcmVmb3ggdG8gY2hyb21lXG4gICAgICAgIGNvbnN0IHRleHQgPSBkYXRhVHJhbnNmZXJbJ3RleHQvcGxhaW4nXTtcblxuICAgICAgICBpZiAoaHRtbCAmJiB1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wJyk7XG4gICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGVtcC5xdWVyeVNlbGVjdG9yKCdhLCBpbWcnKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAhZGF0YVRyYW5zZmVyLmRyYWdnaW5nRnJvbUVkaXRhYmxlICYmXG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lKGVsZW1lbnQpID09PSAnQScgJiZcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPT09ICcnXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBkZWZhdWx0IGNvbnRlbnQgaWYgaXQncyBleHRlcm5hbCBsaW5rXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdXJpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBpbnNlcnRIdG1sQWN0aW9uOiBJbnNlcnRIdG1sQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW5zZXJ0SHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGh0bWw6IGVsZW1lbnQub3V0ZXJIVE1MLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB1cmksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0SHRtbEFjdGlvbjogSW5zZXJ0SHRtbEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydEh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBodG1sOiBodG1sLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB1cmksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChodG1sKSB7XG4gICAgICAgICAgICBjb25zdCBpbnNlcnRIdG1sQWN0aW9uOiBJbnNlcnRIdG1sQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRIdG1sJyxcbiAgICAgICAgICAgICAgICAvLyBDcm9zcyBicm93c2VyIGRyYWcgJiBkcm9wIHdpbGwgYWRkIHVzZWxlc3MgbWV0YSB0YWcgYXQgdGhlXG4gICAgICAgICAgICAgICAgLy8gYmVnaW5uaW5nIG9mIHRoZSBodG1sLlxuICAgICAgICAgICAgICAgIGh0bWw6IGh0bWwgJiYgaHRtbC5yZXBsYWNlKC9ePG1ldGFbXj5dKz4vLCAnJyksXG4gICAgICAgICAgICAgICAgdGV4dDogdGV4dCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgfSBlbHNlIGlmICh1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydEh0bWxBY3Rpb246IEluc2VydEh0bWxBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydEh0bWwnLFxuICAgICAgICAgICAgICAgIGh0bWw6ICc8YSBocmVmPVwiJyArIHVyaSArICdcIj4nICsgdXJpICsgJzwvYT4nLFxuICAgICAgICAgICAgICAgIHRleHQ6IHVyaSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydFRleHRBY3Rpb246IEluc2VydFRleHRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydFRleHQnLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRleHQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGluc2VydFRleHRBY3Rpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvY2VzcyB0aGUgY29tcG9zaXRpb24gdG8gaWRlbnRpZnkgdGhlIHRleHQgdGhhdCB3YXMgaW5zZXJ0ZWQuXG4gICAgICpcbiAgICAgKiBBdHRlbnRpb24sIHRoZXJlIGlzIGEgY2FzZSBpbXBvc3NpYmxlIHRvIHJldHJpZXZlIHRoZSBjb21wbGV0ZVxuICAgICAqIGluZm9ybWF0aW9uLiBJbiB0aGUgY2FzZSBvZiB3ZSBkb24ndCBoYXZlIHRoZSBldmVudCBkYXRhIGFuZCBtdXRhdGlvblxuICAgICAqIGFuZCB3ZSBtaWdodCBoYXZlIFwiYSBiXCIgY2hhbmdlIGZyb20gYSBjb21wb3NpdGlvbiB0byBcImEgY1wiLiBXZSByZWNlaXZlXG4gICAgICogdGhlIHdvcmQgY2hhbmdlIFwiYlwiIHRvIFwiY1wiIGluc3RlYWQgb2YgXCJhIGJcIiB0byBcImEgY1wiLlxuICAgICAqXG4gICAgICovXG4gICAgX2dldENvbXBvc2l0aW9uRnJvbVN0cmluZyhjb21wb3NpdGlvbkRhdGE6IHN0cmluZyk6IENvbXBvc2l0aW9uRGF0YSB7XG4gICAgICAgIGNvbnN0IGNoYXJNYXAgPSB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIuZ2V0Q2hhcmFjdGVyc01hcHBpbmcoKTtcblxuICAgICAgICAvLyBUaGUgZ29hbCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIHByZWNpc2VseSBmaW5kIHdoYXQgd2FzIGluc2VydGVkIGJ5XG4gICAgICAgIC8vIGEga2V5Ym9hcmQgc3VwcG9ydGluZyBzcGVsbC1jaGVja2luZyBhbmQgc3VnZ2VzdGlvbnMuXG4gICAgICAgIC8vIEV4YW1wbGUgKGB8YCByZXByZXNlbnRzIHRoZSB0ZXh0IGN1cnNvcik6XG4gICAgICAgIC8vICAgUHJldmlvdXMgY29udGVudDogJ015IGZyaWVuZCBDaHJpc3RvZmV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBDdXJyZW50IGNvbnRlbnQ6ICAnTXkgZnJpZW5kIENocmlzdG9waGUgTWF0dGhpZXV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBBY3R1YWwgdGV4dCBpbnNlcnRlZCBieSB0aGUga2V5Ym9hcmQ6ICdDaHJpc3RvcGhlIE1hdHRoaWV1J1xuXG4gICAgICAgIGxldCBpbmRleCA9IGNoYXJNYXAuaW5kZXg7XG4gICAgICAgIGxldCBpbnNlcnQgPSBjaGFyTWFwLmluc2VydDtcbiAgICAgICAgbGV0IHJlbW92ZSA9IGNoYXJNYXAucmVtb3ZlO1xuXG4gICAgICAgIGlmIChpbnNlcnQgPT09IHJlbW92ZSAmJiBjb21wb3NpdGlvbkRhdGEpIHtcbiAgICAgICAgICAgIGluc2VydCA9IGNvbXBvc2l0aW9uRGF0YTtcbiAgICAgICAgICAgIHJlbW92ZSA9IGNvbXBvc2l0aW9uRGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluIG11dGF0aW9uOlxuICAgICAgICAvLyAtIHdlIGdldCB0aGUgY2hhbmdlc1xuICAgICAgICAvLyAtIHRyeSB0byBleHRyYWN0IHRoZSB3b3JkIG9yIGEgcGFydCBvZiB0aGUgd29yZCAod2l0aCBvciB3aXRob3V0XG4gICAgICAgIC8vICAgcG9zaXRpb24pXG4gICAgICAgIC8vIC0gbG9jYXRlOiB3aGVyZSB0aGUgY2hhbmdlIGhhcyBiZWVuIG1hZGVcblxuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgLy8gaWYgaW5kZXggPT09IC0xIGl0IG1lYW5zIHdlIGNvdWxkIG5vdCBmaW5kIHRoZSBwb3NpdGlvbiBpbiB0aGUgbXV0YXRlZCBlbGVtZW50c1xuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZSBpbmRleCBvZiB0aGUgb2JzZXJ2ZWQgY2hhbmdlIGFyZVxuICAgICAgICAgICAgLy8gdW5kZWZpbmVkXG4gICAgICAgICAgICAvLyBFeGFtcGxlIChgfGAgcmVwcmVzZW50cyB0aGUgY29sbGFwc2VkIHNlbGVjdGlvbik6XG4gICAgICAgICAgICAvLyAgIFByZXZpb3VzIGNvbnRlbnQ6ICdhYSBhYSBhYXwgYWEgYWEnXG4gICAgICAgICAgICAvLyAgIEN1cnJlbnQgY29udGVudDogICdhYSBhYSBhYSBhYXwgYWEgYWEnXG4gICAgICAgICAgICAvLyAgIEFjdHVhbCB0ZXh0IGluc2VydGVkIGJ5IHRoZSBrZXlib2FyZDogJ2FhICdcbiAgICAgICAgICAgIC8vICAgT2JzZXJ2ZWQgY2hhbmdlOiAgJ2FhIF1hYSBhYSBhYSBhYVsgYWEnXG4gICAgICAgICAgICAvLyBUT0RPIENITTogdGhlIGJlbG93IG1pbi9tYXggZG9lcyBub3QgY292ZXIgYWxsIGNhc2VzXG5cbiAgICAgICAgICAgIC8vIFdpdGggbW9zdCBzcGVsbC1jaGVja2luZyBtb2JpbGUga2V5Ym9hcmRzLCB0aGUgcmFuZ2UgaXMgc2V0IHJpZ2h0XG4gICAgICAgICAgICAvLyBhZnRlciB0aGUgaW5zZXJ0ZWQgdGV4dC4gSXQgY2FuIHRoZW4gYmUgdXNlZCBhcyBhIG1hcmtlciB0b1xuICAgICAgICAgICAgLy8gaWRlbnRpZnkgdGhlIGVuZCBvZiB0aGUgY2hhbmdlLlxuICAgICAgICAgICAgbGV0IGluc2VydEVuZCA9IDA7XG4gICAgICAgICAgICAvLyBUaGUgdGV4dCBoYXMgYmVlbiBmbGF0dGVuZWQgaW4gdGhlIGNoYXJhY3RlcnMgbWFwcGluZy4gV2hlblxuICAgICAgICAgICAgLy8gdGhlIGluZGV4IG9mIHRoZSBub2RlIGhhcyBiZWVuIGZvdW5kLCB1c2UgdGhlIHJhbmdlIG9mZnNldFxuICAgICAgICAgICAgLy8gdG8gZmluZCB0aGUgaW5kZXggb2YgdGhlIGNoYXJhY3RlciBwcm9wZXIuXG4gICAgICAgICAgICBpbnNlcnRFbmQgKz0gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0O1xuICAgICAgICAgICAgaW5kZXggPSBpbnNlcnRFbmQgLSBpbnNlcnQubGVuZ3RoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IG9mZnNldCA9IGluZGV4ICsgaW5zZXJ0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gJiZcbiAgICAgICAgICAgICAgICAoc2VsZWN0aW9uLmZvY3VzTm9kZSAhPT0gY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmZvY3VzT2Zmc2V0ICE9PSBjaGFyTWFwLmN1cnJlbnQub2Zmc2V0c1tvZmZzZXRdICsgMSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gJiZcbiAgICAgICAgICAgICAgICAgICAgKHNlbGVjdGlvbi5mb2N1c05vZGUgIT09IGNoYXJNYXAuY3VycmVudC5ub2Rlc1tvZmZzZXRdIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uZm9jdXNPZmZzZXQgPiBjaGFyTWFwLmN1cnJlbnQub2Zmc2V0c1tvZmZzZXRdKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2hhck1hcC5jdXJyZW50LmNoYXJzW29mZnNldF07XG4gICAgICAgICAgICAgICAgICAgIGluc2VydCArPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUgKz0gdGV4dDtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmVmb3JlID0gY2hhck1hcC5wcmV2aW91cy5jaGFycy5zbGljZSgwLCBpbmRleCk7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gYmVmb3JlLm1hdGNoKGFscGhhYmV0c0NvbnRhaW5pbmdTcGFjZXMpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBtYXRjaCAmJlxuICAgICAgICAgICAgKGluc2VydCA9PT0gJycgfHwgYWxwaGFiZXRzQ29udGFpbmluZ1NwYWNlcy50ZXN0KGluc2VydCkpICYmXG4gICAgICAgICAgICAocmVtb3ZlID09PSAnJyB8fCBhbHBoYWJldHNDb250YWluaW5nU3BhY2VzLnRlc3QocmVtb3ZlKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICAvLyB0aGUgd29yZCBpcyB3cml0ZSBpbiBhIGFscGhhYmV0IHdoaWNoIGNvbnRhaW4gc3BhY2UsIHNlYXJjaFxuICAgICAgICAgICAgLy8gdG8gY29tcGxldGUgdGhlIGNoYW5nZSBhbmQgaW5jbHVkZSB0aGUgcmVzdCBvZiB0aGUgd29yZFxuICAgICAgICAgICAgY29uc3QgYmVnaW5Xb3JkID0gbWF0Y2hbMV07XG4gICAgICAgICAgICByZW1vdmUgPSBiZWdpbldvcmQgKyByZW1vdmU7XG4gICAgICAgICAgICBpbnNlcnQgPSBiZWdpbldvcmQgKyBpbnNlcnQ7XG4gICAgICAgICAgICBpbmRleCAtPSBiZWdpbldvcmQubGVuZ3RoO1xuICAgICAgICAgICAgLy8gU29tZSB2aXJ0dWFsIGtleWJvYXJkcyAoZS5nLiBTd2lmdEtleSkgYWRkIGEgc3BhY2UgYXQgdGhlIGVuZCBvZlxuICAgICAgICAgICAgLy8gZWFjaCBjb21wb3NpdGlvbiBzdWNoIHRoYXQgdGhlIGluc2VydCBpcyAnICcuIFdlIGZpbHRlciBvdXQgdGhvc2VcbiAgICAgICAgICAgIC8vIGV2ZW50cy5cbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YSAmJlxuICAgICAgICAgICAgaW5zZXJ0ICYmXG4gICAgICAgICAgICAocmVtb3ZlIHx8IGluc2VydCAhPT0gJyAnKSAmJlxuICAgICAgICAgICAgY29tcG9zaXRpb25EYXRhICE9PSBpbnNlcnRcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zdCBjaGFySW5kZXggPSBjb21wb3NpdGlvbkRhdGEubGFzdEluZGV4T2YoaW5zZXJ0KTtcbiAgICAgICAgICAgIGlmIChjaGFySW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggLT0gY2hhckluZGV4O1xuICAgICAgICAgICAgICAgIGluc2VydCA9IGNvbXBvc2l0aW9uRGF0YTtcbiAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSByZW1vdmUubGVuZ3RoICsgY2hhckluZGV4O1xuICAgICAgICAgICAgICAgIHJlbW92ZSA9IGNoYXJNYXAucHJldmlvdXMuY2hhcnMuc2xpY2UoaW5kZXgsIGluZGV4ICsgbGVuICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmltIHRoZSB0cmFpbGluZyBzcGFjZSBhZGRlZCBieSBzb21lIHZpcnR1YWwga2V5Ym9hcmRzIChlLmcuXG4gICAgICAgIC8vIFN3aWZ0S2V5KS5cbiAgICAgICAgY29uc3QgcmVtb3ZlZEVuZFNwYWNlID0gcmVtb3ZlW3JlbW92ZS5sZW5ndGggLSAxXSA9PT0gJyAnO1xuICAgICAgICBjb25zdCBpbnNlcnRlZEVuZFNwYWNlID0gaW5zZXJ0W2luc2VydC5sZW5ndGggLSAxXSA9PT0gJyAnO1xuICAgICAgICBsZXQgcmF3UmVtb3ZlID0gcmVtb3ZlO1xuICAgICAgICBsZXQgcmF3SW5zZXJ0ID0gaW5zZXJ0O1xuICAgICAgICBpZiAoaW5zZXJ0ZWRFbmRTcGFjZSAmJiByZW1vdmVkRW5kU3BhY2UpIHtcbiAgICAgICAgICAgIHJhd1JlbW92ZSA9IHJhd1JlbW92ZS5zbGljZSgwLCAtMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluc2VydGVkRW5kU3BhY2UpIHtcbiAgICAgICAgICAgIHJhd0luc2VydCA9IHJhd0luc2VydC5zbGljZSgwLCAtMSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcmV2aW91c05vZGVzID0gY2hhck1hcC5wcmV2aW91cy5ub2RlcztcbiAgICAgICAgY29uc3QgcHJldmlvdXNPZmZzZXRzID0gY2hhck1hcC5wcmV2aW91cy5vZmZzZXRzO1xuICAgICAgICBjb25zdCBsYXN0UHJldmlvdXNOb2RlID0gcHJldmlvdXNOb2Rlc1twcmV2aW91c05vZGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICBjb25zdCBsYXN0UHJldmlvdXNPZmZzZXQgPSBwcmV2aW91c09mZnNldHNbcHJldmlvdXNPZmZzZXRzLmxlbmd0aCAtIDFdICsgMTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0RW5kID0gaW5kZXggKyByYXdSZW1vdmUubGVuZ3RoO1xuICAgICAgICBjb25zdCBzZXRTZWxlY3Rpb25BY3Rpb246IFNldFNlbGVjdGlvbkFjdGlvbiA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgYW5jaG9yTm9kZTogcHJldmlvdXNOb2Rlc1tpbmRleF0gfHwgbGFzdFByZXZpb3VzTm9kZSxcbiAgICAgICAgICAgICAgICBhbmNob3JPZmZzZXQ6XG4gICAgICAgICAgICAgICAgICAgIGluZGV4IGluIHByZXZpb3VzT2Zmc2V0cyA/IHByZXZpb3VzT2Zmc2V0c1tpbmRleF0gOiBsYXN0UHJldmlvdXNPZmZzZXQsXG4gICAgICAgICAgICAgICAgZm9jdXNOb2RlOiBwcmV2aW91c05vZGVzW29mZnNldEVuZF0gfHwgbGFzdFByZXZpb3VzTm9kZSxcbiAgICAgICAgICAgICAgICBmb2N1c09mZnNldDpcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0RW5kIGluIHByZXZpb3VzT2Zmc2V0cyA/IHByZXZpb3VzT2Zmc2V0c1tvZmZzZXRFbmRdIDogbGFzdFByZXZpb3VzT2Zmc2V0LFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uLkZPUldBUkQsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBpbnNlcnRUZXh0QWN0aW9uOiBJbnNlcnRUZXh0QWN0aW9uID0ge1xuICAgICAgICAgICAgdHlwZTogJ2luc2VydFRleHQnLFxuICAgICAgICAgICAgdGV4dDogcmF3SW5zZXJ0LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhY3Rpb25zID0gW3NldFNlbGVjdGlvbkFjdGlvbiwgaW5zZXJ0VGV4dEFjdGlvbl07XG5cbiAgICAgICAgaWYgKGluc2VydGVkRW5kU3BhY2UpIHtcbiAgICAgICAgICAgIGlmIChyZW1vdmVkRW5kU3BhY2UpIHtcbiAgICAgICAgICAgICAgICBpbmRleCArPSByYXdSZW1vdmUubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uQWN0aW9uOiBTZXRTZWxlY3Rpb25BY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICBkb21TZWxlY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IHByZXZpb3VzTm9kZXNbaW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yT2Zmc2V0OiBwcmV2aW91c09mZnNldHNbaW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNOb2RlOiBwcmV2aW91c05vZGVzW29mZnNldEVuZF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09mZnNldDogcHJldmlvdXNPZmZzZXRzW2luZGV4ICsgMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYWN0aW9ucy5wdXNoKHNldFNlbGVjdGlvbkFjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpbnNlcnRUZXh0QWN0aW9uOiBJbnNlcnRUZXh0QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRUZXh0JyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnICcsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYWN0aW9ucy5wdXNoKGluc2VydFRleHRBY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRnJvbTogcmVtb3ZlLFxuICAgICAgICAgICAgY29tcG9zaXRpb25UbzogaW5zZXJ0LFxuICAgICAgICAgICAgYWN0aW9uczogYWN0aW9ucyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvY2VzcyB0aGUgZ2l2ZW4gY29tcGlsZWQgZXZlbnQgYXMgYSBiYWNrc3BhY2UvZGVsZXRlIHRvIGlkZW50aWZ5IHRoZVxuICAgICAqIHRleHQgdGhhdCB3YXMgcmVtb3ZlZCBhbmQgcmV0dXJuIGFuIGFycmF5IG9mIHRoZSBjb3JyZXNwb25kaW5nXG4gICAgICogTm9ybWFsaXplZEFjdGlvbi5cbiAgICAgKlxuICAgICAqIEluIHRoZSBjYXNlIG9mIGN1dCBldmVudCwgdGhlIGRpcmVjdGlvbiB3aWxsIGJlIGBEaXJlY3Rpb24uRk9SV0FSRGAuXG4gICAgICpcbiAgICAgKi9cbiAgICBfZ2V0UmVtb3ZlQWN0aW9uKFxuICAgICAgICBrZXk6IHN0cmluZyxcbiAgICAgICAgaW5wdXRUeXBlOiBzdHJpbmcsXG4gICAgICAgIGtleWRvd25FdmVudDogS2V5Ym9hcmRFdmVudCxcbiAgICApOiBEZWxldGVXb3JkQWN0aW9uIHwgRGVsZXRlSGFyZExpbmVBY3Rpb24gfCBEZWxldGVDb250ZW50QWN0aW9uIHtcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0ga2V5ID09PSAnQmFja3NwYWNlJyA/IERpcmVjdGlvbi5CQUNLV0FSRCA6IERpcmVjdGlvbi5GT1JXQVJEO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBkZWxldGVXb3JkIGZyb20gdGhlIFN3aWZ0S2V5IG1vYmlsZSBrZXlib2FyZC4gVGhpc1xuICAgICAgICAvLyBiZSB0cmlnZ2VyZWQgYnkgbG9uZy1wcmVzc2luZyB0aGUgYmFja3NwYWNlIGtleSwgaG93ZXZlciBTd2lmdEtleVxuICAgICAgICAvLyBkb2VzIG5vdCB0cmlnZ2VyIGEgcHJvcGVyIGRlbGV0ZVdvcmQgZXZlbnQgc28gd2UgbXVzdCBkZXRlY3QgaXQuXG4gICAgICAgIC8vIFRoaXMgaXMgZXh0cmVtZWx5IGFkLWhvYyBmb3IgdGhlIHBhcnRpY3VsYXIgY2FzZSBvZiBTd2lmdEtleSBhbmQgd2VcbiAgICAgICAgLy8gbmVlZCB0byByZXRyaWV2ZSB0aGUgc2VsZWN0aW9uIGFzIGl0IHdhcyByaWdodCBiZWZvcmUgdGhlIGRlbGV0aW9uLlxuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9zd2lmdEtleURlbGV0ZVdvcmRTZWxlY3Rpb25DYWNoZVswXTtcbiAgICAgICAgdGhpcy5fc3dpZnRLZXlEZWxldGVXb3JkU2VsZWN0aW9uQ2FjaGUubGVuZ3RoID0gMDtcblxuICAgICAgICAvLyBHZXQgY2hhcmFjdGVyTWFwcGluZyB0byByZXRyaWV2ZSB3aGljaCB3b3JkIGhhcyBiZWVuIGRlbGV0ZWQuXG4gICAgICAgIGNvbnN0IGNoYXJhY3Rlck1hcHBpbmcgPSB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIuZ2V0Q2hhcmFjdGVyc01hcHBpbmcoKTtcblxuICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9XG4gICAgICAgICAgICBzZWxlY3Rpb24gJiZcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JOb2RlID09PSBzZWxlY3Rpb24uZm9jdXNOb2RlICYmXG4gICAgICAgICAgICBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0ID09PSBzZWxlY3Rpb24uZm9jdXNPZmZzZXQ7XG5cbiAgICAgICAgY29uc3QgaXNTd2lmdEtleURlbGV0ZVdvcmQgPVxuICAgICAgICAgICAgKGlucHV0VHlwZSA9PT0gJ2RlbGV0ZUNvbnRlbnRGb3J3YXJkJyB8fCBpbnB1dFR5cGUgPT09ICdkZWxldGVDb250ZW50QmFja3dhcmQnKSAmJlxuICAgICAgICAgICAga2V5ZG93bkV2ZW50Py5rZXkgPT09ICdVbmlkZW50aWZpZWQnICYmXG4gICAgICAgICAgICBpc0NvbGxhcHNlZCAmJlxuICAgICAgICAgICAgY2hhcmFjdGVyTWFwcGluZy5yZW1vdmUubGVuZ3RoID4gMTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBpbnB1dFR5cGUgPT09ICdkZWxldGVXb3JkRm9yd2FyZCcgfHxcbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gJ2RlbGV0ZVdvcmRCYWNrd2FyZCcgfHxcbiAgICAgICAgICAgIGlzU3dpZnRLZXlEZWxldGVXb3JkXG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgZGVsZXRlV29yZEFjdGlvbjogRGVsZXRlV29yZEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGVsZXRlV29yZCcsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb24sXG4gICAgICAgICAgICAgICAgdGV4dDogY2hhcmFjdGVyTWFwcGluZy5yZW1vdmUsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGRlbGV0ZVdvcmRBY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgaW5wdXRUeXBlID09PSAnZGVsZXRlSGFyZExpbmVGb3J3YXJkJyB8fFxuICAgICAgICAgICAgaW5wdXRUeXBlID09PSAnZGVsZXRlSGFyZExpbmVCYWNrd2FyZCcgfHxcbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gJ2RlbGV0ZVNvZnRMaW5lRm9yd2FyZCcgfHxcbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gJ2RlbGV0ZVNvZnRMaW5lQmFja3dhcmQnXG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgZGVsZXRlSGFyZExpbmVBY3Rpb246IERlbGV0ZUhhcmRMaW5lQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdkZWxldGVIYXJkTGluZScsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb24sXG4gICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IGNoYXJhY3Rlck1hcHBpbmcucHJldmlvdXMubm9kZXNbY2hhcmFjdGVyTWFwcGluZy5pbmRleF0sXG4gICAgICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogY2hhcmFjdGVyTWFwcGluZy5wcmV2aW91cy5vZmZzZXRzW2NoYXJhY3Rlck1hcHBpbmcuaW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c05vZGU6XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJNYXBwaW5nLnByZXZpb3VzLm5vZGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlck1hcHBpbmcuaW5kZXggKyBjaGFyYWN0ZXJNYXBwaW5nLnJlbW92ZS5sZW5ndGggLSAxXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c09mZnNldDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlck1hcHBpbmcucHJldmlvdXMub2Zmc2V0c1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJNYXBwaW5nLmluZGV4ICsgY2hhcmFjdGVyTWFwcGluZy5yZW1vdmUubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgXSArIDEsXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGRlbGV0ZUhhcmRMaW5lQWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlbGV0ZUNvbnRlbnRBY3Rpb246IERlbGV0ZUNvbnRlbnRBY3Rpb24gPSB7XG4gICAgICAgICAgICB0eXBlOiAnZGVsZXRlQ29udGVudCcsXG4gICAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvbixcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlbGV0ZUNvbnRlbnRBY3Rpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGNhbiBiZSBjb25zaWRlcmVkIGEgdGV4dHVhbCBub2RlLCB0aGF0IGlzXG4gICAgICogYSB0ZXh0IG5vZGUgb3IgYSBCUiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBfaXNUZXh0dWFsTm9kZShub2RlOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSB8fCBub2RlTmFtZShub2RlKSA9PT0gJ0JSJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHNlbGVjdGlvbiBmcm9tIHRoZSBET00uIElmIHRoZXJlIGlzIG5vIHNlbGVjdGlvbiBpbiB0aGVcbiAgICAgKiBET00sIHJldHVybiBhIGZha2Ugb25lIGF0IG9mZnNldCAwIG9mIHRoZSBlZGl0YWJsZSBlbGVtZW50LlxuICAgICAqIElmIGFuIGV2ZW50IGlzIGdpdmVuLCB0aGVuIHRoZSBzZWxlY3Rpb24gbXVzdCBiZSBhdCBsZWFzdCBwYXJ0aWFsbHlcbiAgICAgKiBjb250YWluZWQgaW4gdGhlIHRhcmdldCBvZiB0aGUgZXZlbnQsIG90aGVyd2lzZSBpdCBtZWFucyBpdCB0b29rIG5vXG4gICAgICogcGFydCBpbiBpdC4gSW4gdGhpcyBjYXNlLCByZXR1cm4gdGhlIGNhcmV0IHBvc2l0aW9uIGluc3RlYWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2V2XVxuICAgICAqL1xuICAgIF9nZXRTZWxlY3Rpb24oZXY/OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCk6IERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uIHtcbiAgICAgICAgbGV0IHNlbGVjdGlvbkRlc2NyaXB0aW9uOiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbjtcbiAgICAgICAgbGV0IHRhcmdldDogTm9kZTtcbiAgICAgICAgbGV0IHJvb3Q6IERvY3VtZW50IHwgU2hhZG93Um9vdDtcbiAgICAgICAgaWYgKGV2KSB7XG4gICAgICAgICAgICB0YXJnZXQgPSB0aGlzLl9nZXRFdmVudFRhcmdldChldik7XG4gICAgICAgICAgICByb290ID0gZ2V0RG9jdW1lbnQodGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9pbml0aWFsQ2FyZXRQb3NpdGlvbj8ub2Zmc2V0Tm9kZSkge1xuICAgICAgICAgICAgcm9vdCA9IGdldERvY3VtZW50KHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uLm9mZnNldE5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcm9vdCA9IGRvY3VtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gcm9vdC5nZXRTZWxlY3Rpb25cbiAgICAgICAgICAgID8gcm9vdC5nZXRTZWxlY3Rpb24oKVxuICAgICAgICAgICAgOiByb290Lm93bmVyRG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IGZvcndhcmQ6IGJvb2xlYW47XG4gICAgICAgIGlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5yYW5nZUNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAvLyBObyBzZWxlY3Rpb24gaW4gdGhlIERPTS4gQ3JlYXRlIGEgZmFrZSBvbmUuXG4gICAgICAgICAgICBzZWxlY3Rpb25EZXNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBkb2N1bWVudC5ib2R5LFxuICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogMCxcbiAgICAgICAgICAgICAgICBmb2N1c05vZGU6IGRvY3VtZW50LmJvZHksXG4gICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IDAsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGUgc2VsZWN0aW9uIGRpcmVjdGlvbiBpcyBzb3JlbHkgbWlzc2luZyBmcm9tIHRoZSBET00gYXBpLlxuICAgICAgICAgICAgY29uc3QgbmF0aXZlUmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24uYW5jaG9yTm9kZSA9PT0gc2VsZWN0aW9uLmZvY3VzTm9kZSkge1xuICAgICAgICAgICAgICAgIGZvcndhcmQgPSBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0IDw9IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yd2FyZCA9IHNlbGVjdGlvbi5hbmNob3JOb2RlID09PSBuYXRpdmVSYW5nZS5zdGFydENvbnRhaW5lcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdGlvbkRlc2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IHNlbGVjdGlvbi5hbmNob3JOb2RlLFxuICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogc2VsZWN0aW9uLmFuY2hvck9mZnNldCxcbiAgICAgICAgICAgICAgICBmb2N1c05vZGU6IHNlbGVjdGlvbi5mb2N1c05vZGUsXG4gICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IHNlbGVjdGlvbi5mb2N1c09mZnNldCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGZvcndhcmQgPyBEaXJlY3Rpb24uRk9SV0FSRCA6IERpcmVjdGlvbi5CQUNLV0FSRCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBhbiBldmVudCBpcyBnaXZlbiwgdGhlbiB0aGUgcmFuZ2UgbXVzdCBiZSBhdCBsZWFzdCBwYXJ0aWFsbHlcbiAgICAgICAgLy8gY29udGFpbmVkIGluIHRoZSB0YXJnZXQgb2YgdGhlIGV2ZW50LCBvdGhlcndpc2UgaXQgbWVhbnMgaXQgdG9vayBub1xuICAgICAgICAvLyBwYXJ0IGluIGl0LiBJbiB0aGlzIGNhc2UsIGNvbnNpZGVyIHRoZSBjYXJldCBwb3NpdGlvbiBpbnN0ZWFkLlxuICAgICAgICAvLyBUaGlzIGNhbiBoYXBwZW4gd2hlbiB0YXJnZXQgaXMgYW4gaW5wdXQgb3IgYSBjb250ZW50ZWRpdGFibGU9ZmFsc2UuXG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICAgICAgICBjb25zdCBjYXJldFBvc2l0aW9uID0gdGhpcy5fZ2V0RXZlbnRDYXJldFBvc2l0aW9uKGV2KTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAhdGFyZ2V0LmNvbnRhaW5zKHNlbGVjdGlvbkRlc2NyaXB0aW9uLmFuY2hvck5vZGUpICYmXG4gICAgICAgICAgICAgICAgIXRhcmdldC5jb250YWlucyhzZWxlY3Rpb25EZXNjcmlwdGlvbi5mb2N1c05vZGUpICYmXG4gICAgICAgICAgICAgICAgY2FyZXRQb3NpdGlvbi5vZmZzZXROb2RlID09PSB0YXJnZXRcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbkRlc2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBjYXJldFBvc2l0aW9uLm9mZnNldE5vZGUsXG4gICAgICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogY2FyZXRQb3NpdGlvbi5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzTm9kZTogY2FyZXRQb3NpdGlvbi5vZmZzZXROb2RlLFxuICAgICAgICAgICAgICAgICAgICBmb2N1c09mZnNldDogY2FyZXRQb3NpdGlvbi5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uLkZPUldBUkQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZWxlY3Rpb25EZXNjcmlwdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHJhbmdlIGlzIHNlbGVjdGluZyB0aGUgd2hvbGUgZWRpdGFibGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VsZWN0aW9uXG4gICAgICovXG4gICAgX2lzU2VsZWN0QWxsKHNlbGVjdGlvbjogRG9tU2VsZWN0aW9uRGVzY3JpcHRpb24pOiBib29sZWFuIHtcbiAgICAgICAgLy8gVGhlIHNlbGVjdGlvbiBmcm9tIHRoZSBjb250ZXh0IG1lbnUgb3IgYSBzaG9ydGN1dCBuZXZlciBoYXZlXG4gICAgICAgIC8vIGRpcmVjdGlvbiBmb3J3YXJkLlxuICAgICAgICBpZiAoc2VsZWN0aW9uLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkJBQ0tXQVJEKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc3RhcnRDb250YWluZXIgPSBzZWxlY3Rpb24uYW5jaG9yTm9kZTtcbiAgICAgICAgbGV0IHN0YXJ0T2Zmc2V0ID0gc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcbiAgICAgICAgbGV0IGVuZENvbnRhaW5lciA9IHNlbGVjdGlvbi5mb2N1c05vZGU7XG4gICAgICAgIGxldCBlbmRPZmZzZXQgPSBzZWxlY3Rpb24uZm9jdXNPZmZzZXQ7XG5cbiAgICAgICAgLy8gVGhlIHNlbGVjdGlvbiBtaWdodCBzdGlsbCBiZSBvbiBhIG5vZGUgd2hpY2ggaGFzIHNpbmNlIGJlZW4gcmVtb3ZlZC5cbiAgICAgICAgbGV0IGludmFsaWRTdGFydCA9IHRydWU7XG4gICAgICAgIGxldCBkb21Ob2RlID0gc3RhcnRDb250YWluZXI7XG4gICAgICAgIHdoaWxlIChkb21Ob2RlICYmIGludmFsaWRTdGFydCkge1xuICAgICAgICAgICAgaWYgKGRvbU5vZGUgaW5zdGFuY2VvZiBTaGFkb3dSb290KSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGUuaG9zdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keS5jb250YWlucyhkb21Ob2RlKSkge1xuICAgICAgICAgICAgICAgIGludmFsaWRTdGFydCA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBpbnZhbGlkRW5kID0gdHJ1ZTtcbiAgICAgICAgZG9tTm9kZSA9IGVuZENvbnRhaW5lcjtcbiAgICAgICAgd2hpbGUgKGRvbU5vZGUgJiYgaW52YWxpZEVuZCkge1xuICAgICAgICAgICAgaWYgKGRvbU5vZGUgaW5zdGFuY2VvZiBTaGFkb3dSb290KSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGUuaG9zdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keS5jb250YWlucyhkb21Ob2RlKSkge1xuICAgICAgICAgICAgICAgIGludmFsaWRFbmQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbnZhbGlkU2VsZWN0aW9uID0gaW52YWxpZFN0YXJ0IHx8IGludmFsaWRFbmQ7XG5cbiAgICAgICAgLy8gVGhlIHNlbGVjdGlvbiBtaWdodCBiZSBjb2xsYXBzZWQgaW4gd2hpY2ggY2FzZSB0aGVyZSBpcyBubyBzZWxlY3Rpb24uXG4gICAgICAgIGNvbnN0IG9ubHlPbmVOb2RlU2VsZWN0ZWQgPSBzdGFydENvbnRhaW5lciA9PT0gZW5kQ29udGFpbmVyO1xuICAgICAgICBjb25zdCBub0NoYXJhY3RlclNlbGVjdGVkID0gc3RhcnRPZmZzZXQgPT09IGVuZE9mZnNldDtcbiAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBvbmx5T25lTm9kZVNlbGVjdGVkICYmIG5vQ2hhcmFjdGVyU2VsZWN0ZWQ7XG5cbiAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGlvbiBpcyBpbnZhbGlkIG9yIHRoZSBzZWxlY3Rpb24gaXMgY29sbGFwc2VkLCBpdFxuICAgICAgICAvLyBkZWZpbml0ZWx5IGRvZXMgbm90IGNvcnJlc3BvbmQgdG8gYSBzZWxlY3QgYWxsIGFjdGlvbi5cbiAgICAgICAgaWYgKGludmFsaWRTZWxlY3Rpb24gfHwgaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIFtzdGFydENvbnRhaW5lciwgc3RhcnRPZmZzZXRdID0gdGFyZ2V0RGVlcGVzdChzdGFydENvbnRhaW5lciwgc3RhcnRPZmZzZXQpO1xuICAgICAgICBbZW5kQ29udGFpbmVyLCBlbmRPZmZzZXRdID0gdGFyZ2V0RGVlcGVzdChlbmRDb250YWluZXIsIGVuZE9mZnNldCk7XG5cbiAgICAgICAgLy8gTG9vayBmb3IgdmlzaWJsZSBub2RlcyBpbiBlZGl0YWJsZSB0aGF0IHdvdWxkIGJlIG91dHNpZGUgdGhlIHJhbmdlLlxuICAgICAgICBjb25zdCBzdGFydEluc2lkZUVkaXRhYmxlID0gdGhpcy5faXNJbkVkaXRhYmxlKHN0YXJ0Q29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgZW5kSW5zaWRlRWRpdGFibGUgPSB0aGlzLl9pc0luRWRpdGFibGUoZW5kQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKHN0YXJ0SW5zaWRlRWRpdGFibGUgJiYgZW5kSW5zaWRlRWRpdGFibGUpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgc3RhcnRPZmZzZXQgPT09IDAgJiZcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0F0VmlzaWJsZUVkZ2Uoc3RhcnRDb250YWluZXIsICdzdGFydCcpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5faXNBdFZpc2libGVFZGdlKGVuZENvbnRhaW5lciwgJ2VuZCcpXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXJ0SW5zaWRlRWRpdGFibGUpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGFydE9mZnNldCA9PT0gMCAmJiB0aGlzLl9pc0F0VmlzaWJsZUVkZ2Uoc3RhcnRDb250YWluZXIsICdzdGFydCcpO1xuICAgICAgICB9IGVsc2UgaWYgKGVuZEluc2lkZUVkaXRhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNBdFZpc2libGVFZGdlKGVuZENvbnRhaW5lciwgJ2VuZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgYXQgdGhlIGVkZ2Ugb2YgdGhlIGVkaXRhYmxlIG5vZGUgaW5cbiAgICAgKiB0aGUgZ2l2ZW4gZGlyZWN0aW9uLiBBbiBlbGVtZW50IGlzIGNvbnNpZGVyZWQgYXQgdGhlIGVkZ2Ugb2YgdGhlIGVkaXRhYmxlXG4gICAgICogbm9kZSBpZiB0aGVyZSBpcyBubyBvdGhlciB2aXNpYmxlIGVsZW1lbnQgaW4gZWRpdGFibGUgdGhhdCBpcyBsb2NhdGVkXG4gICAgICogYmV5b25kIGl0IGluIHRoZSBnaXZlbiBkaXJlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZSB0byBjaGVjayB3aGV0aGVyIGl0IGlzIGF0IHRoZSB2aXNpYmxlIGVkZ2VcbiAgICAgKiBAcGFyYW0gc2lkZSBmcm9tIHdoaWNoIHRvIGxvb2sgZm9yIHRleHR1YWwgbm9kZXMgKCdzdGFydCcgb3IgJ2VuZCcpXG4gICAgICovXG4gICAgX2lzQXRWaXNpYmxlRWRnZShub2RlOiBOb2RlLCBzaWRlOiAnc3RhcnQnIHwgJ2VuZCcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgZWRpdGFibGU6IEVsZW1lbnQgPSB0aGlzLl9nZXRDbG9zZXN0RWxlbWVudChub2RlKS5jbG9zZXN0KCdbY29udGVudEVkaXRhYmxlPXRydWVdJyk7XG5cbiAgICAgICAgLy8gU3RhcnQgZnJvbSB0aGUgdG9wIGFuZCBkbyBhIGRlcHRoLWZpcnN0IHNlYXJjaCB0cnlpbmcgdG8gZmluZCBhXG4gICAgICAgIC8vIHZpc2libGUgbm9kZSB0aGF0IHdvdWxkIGJlIGluIGVkaXRhYmxlIGFuZCBiZXlvbmQgdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZTogTm9kZSA9IGVkaXRhYmxlO1xuICAgICAgICBjb25zdCBjaGlsZCA9IHNpZGUgPT09ICdzdGFydCcgPyAnZmlyc3RDaGlsZCcgOiAnbGFzdENoaWxkJztcbiAgICAgICAgY29uc3Qgc2libGluZyA9IHNpZGUgPT09ICdzdGFydCcgPyAnbmV4dFNpYmxpbmcnIDogJ3ByZXZpb3VzU2libGluZyc7XG4gICAgICAgIGxldCBjcm9zc1Zpc2libGUgPSBmYWxzZTtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGUgPT09IG5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgcmVhY2hlZCB3aXRob3V0IGZpbmRpbmcgYW5vdGhlciB2aXNpYmxlIG5vZGUuXG4gICAgICAgICAgICAgICAgcmV0dXJuICFjcm9zc1Zpc2libGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faXNUZXh0dWFsTm9kZShjdXJyZW50Tm9kZSkgJiYgdGhpcy5faXNWaXNpYmxlKGN1cnJlbnROb2RlLCBlZGl0YWJsZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGVyZSBpcyBhIHRleHR1YWwgbm9kZSBpbiBlZGl0YWJsZSBiZXlvbmQgdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAgICAgICAgICAgICAgY3Jvc3NWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHRoZSBkZXB0aC1maXJzdCBzZWFyY2guXG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGVbY2hpbGRdKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZVtjaGlsZF07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnROb2RlW3NpYmxpbmddKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZVtzaWJsaW5nXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudE5vZGUucGFyZW50Tm9kZSA9PT0gZWRpdGFibGUpIHtcbiAgICAgICAgICAgICAgICAvLyBEZXB0aC1maXJzdCBzZWFyY2ggaGFzIGNoZWNrZWQgYWxsIGVsZW1lbnRzIGluIGVkaXRhYmxlLlxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgYW5jZXN0b3IgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gYW5jZXN0b3Jbc2libGluZ107XG4gICAgICAgICAgICAgICAgLy8gV2hlbiBjaGVja2luZyBmcm9tIHRoZSBlbmQgd2UgbmVlZCB0byBnbyB1cCB0aGUgYW5jZXN0b3JzXG4gICAgICAgICAgICAgICAgLy8gdHJlZSB0byBmaW5kIG9uZSB3aGljaCBkb2VzIGhhdmUgYSBwcmV2aW91cyBzaWJsaW5nLlxuICAgICAgICAgICAgICAgIHdoaWxlICghY3VycmVudE5vZGUgJiYgc2lkZSA9PT0gJ2VuZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGFuY2VzdG9yW3NpYmxpbmddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERldGVybWluZSBpZiBhIG5vZGUgaXMgY29uc2lkZXJlZCB2aXNpYmxlLlxuICAgICAqL1xuICAgIF9pc1Zpc2libGUoZWw6IE5vZGUsIGVkaXRhYmxlOiBFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChlbCA9PT0gZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWwgPT09IGVkaXRhYmxlKSB7XG4gICAgICAgICAgICAvLyBUaGUgZWRpdGFibGUgbm9kZSB3YXMgcmVhY2hlZCB3aXRob3V0IGVuY291bnRlcmluZyBhIGhpZGRlblxuICAgICAgICAgICAgLy8gY29udGFpbmVyLiBUaGUgZWRpdGFibGUgbm9kZSBpcyBzdXBwb3NlZCB0byBiZSB2aXNpYmxlLlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQSA8YnI+IGVsZW1lbnQgd2l0aCBubyBuZXh0IHNpYmxpbmcgaXMgbmV2ZXIgdmlzaWJsZS5cbiAgICAgICAgaWYgKG5vZGVOYW1lKGVsKSA9PT0gJ0JSJyAmJiAhZWwubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuX2dldENsb3Nlc3RFbGVtZW50KGVsKSk7XG4gICAgICAgIGlmIChzdHlsZS5kaXNwbGF5ID09PSAnbm9uZScgfHwgc3R5bGUudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXNWaXNpYmxlKGVsLnBhcmVudE5vZGUsIGVkaXRhYmxlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBub2RlIGFuZCBvZmZzZXQgdGFyZ2V0ZWQgYnkgYSBldmVudCwgaW5jbHVkaW5nIGlmIHRoZSB0YXJnZXRcbiAgICAgKiBpcyBpbnNpZGUgYSBzaGFkb3cgZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgX2dldEV2ZW50Q2FyZXRQb3NpdGlvbihldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBDYXJldFBvc2l0aW9uIHtcbiAgICAgICAgY29uc3QgeCA9XG4gICAgICAgICAgICBldi5jb25zdHJ1Y3Rvci5uYW1lID09PSAnVG91Y2hFdmVudCdcbiAgICAgICAgICAgICAgICA/IChldiBhcyBUb3VjaEV2ZW50KS50b3VjaGVzWzBdLmNsaWVudFhcbiAgICAgICAgICAgICAgICA6IChldiBhcyBNb3VzZUV2ZW50KS5jbGllbnRYO1xuICAgICAgICBjb25zdCB5ID1cbiAgICAgICAgICAgIGV2LmNvbnN0cnVjdG9yLm5hbWUgPT09ICdUb3VjaEV2ZW50J1xuICAgICAgICAgICAgICAgID8gKGV2IGFzIFRvdWNoRXZlbnQpLnRvdWNoZXNbMF0uY2xpZW50WVxuICAgICAgICAgICAgICAgIDogKGV2IGFzIE1vdXNlRXZlbnQpLmNsaWVudFk7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBOb2RlO1xuICAgICAgICBsZXQgY2FyZXRQb3NpdGlvbiA9IGNhcmV0UG9zaXRpb25Gcm9tUG9pbnQoeCwgeSwgdGFyZ2V0Lm93bmVyRG9jdW1lbnQpO1xuICAgICAgICBpZiAoIWNhcmV0UG9zaXRpb24pIHtcbiAgICAgICAgICAgIGNhcmV0UG9zaXRpb24gPSB7IG9mZnNldE5vZGU6IGV2LnRhcmdldCBhcyBOb2RlLCBvZmZzZXQ6IDAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZXRQb3NpdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlIHRoZSBwb3NpdGlvbiB0byBnZXQgdGhlIHRhcmdldCBmcm9tIHRoZSBldmVudCAoaW5jbHVkaW5nIHRoZSB0YXJnZXRcbiAgICAgKiBpbiBzaGFkb3cgZWxlbWVudClcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIF9nZXRFdmVudFRhcmdldChldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBOb2RlIHtcbiAgICAgICAgY29uc3QgeCA9XG4gICAgICAgICAgICBldi5jb25zdHJ1Y3Rvci5uYW1lID09PSAnVG91Y2hFdmVudCdcbiAgICAgICAgICAgICAgICA/IChldiBhcyBUb3VjaEV2ZW50KS50b3VjaGVzWzBdLmNsaWVudFhcbiAgICAgICAgICAgICAgICA6IChldiBhcyBNb3VzZUV2ZW50KS5jbGllbnRYO1xuICAgICAgICBjb25zdCB5ID1cbiAgICAgICAgICAgIGV2LmNvbnN0cnVjdG9yLm5hbWUgPT09ICdUb3VjaEV2ZW50J1xuICAgICAgICAgICAgICAgID8gKGV2IGFzIFRvdWNoRXZlbnQpLnRvdWNoZXNbMF0uY2xpZW50WVxuICAgICAgICAgICAgICAgIDogKGV2IGFzIE1vdXNlRXZlbnQpLmNsaWVudFk7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBOb2RlO1xuICAgICAgICByZXR1cm4gZWxlbWVudEZyb21Qb2ludCh4LCB5LCB0YXJnZXQub3duZXJEb2N1bWVudCkgfHwgdGFyZ2V0O1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBIYW5kbGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENhdGNoIHNldFNlbGVjdGlvbiBhbmQgc2VsZWN0QWxsIGFjdGlvbnNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZcbiAgICAgKi9cbiAgICBfb25Db250ZXh0TWVudShldjogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQ/LnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0LmZpcmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dCA9IG5ldyBUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc2VsZWN0aW9uSGFzQ2hhbmdlZCB8fCB0aGlzLl9jdXJyZW50bHlTZWxlY3RpbmdBbGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhY3Rpb25zOiBbXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uQWN0aW9uOiBTZXRTZWxlY3Rpb25BY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NldFNlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiB0aGlzLl9nZXRTZWxlY3Rpb24oZXYpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbkhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uczogW3NldFNlbGVjdGlvbkFjdGlvbl0sXG4gICAgICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KFtdKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaCh0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dC5wcm9taXNlKTtcbiAgICAgICAgLy8gVGhlIF9jbGlja2VkSW5FZGl0YWJsZSBwcm9wZXJ0eSBpcyB1c2VkIHRvIGFzc2VzcyB3aGV0aGVyIHRoZSB1c2VyIGlzXG4gICAgICAgIC8vIGN1cnJlbnRseSBjaGFuZ2luZyB0aGUgc2VsZWN0aW9uIGJ5IHVzaW5nIHRoZSBtb3VzZS4gSWYgdGhlIGNvbnRleHRcbiAgICAgICAgLy8gbWVudSBlbmRzIHVwIG9wZW5pbmcsIHRoZSB1c2VyIGlzIGRlZmluaXRlbHkgbm90IHNlbGVjdGluZy5cbiAgICAgICAgdGhpcy5fbW91c2Vkb3duSW5FZGl0YWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYXRjaCBFbnRlciwgQmFja3NwYWNlLCBEZWxldGUgYW5kIGluc2VydCBhY3Rpb25zXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2XG4gICAgICovXG4gICAgX29uS2V5RG93bk9yS2V5UHJlc3MoZXY6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlTW9kaWZpZXJzS2V5cyhldik7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRXZlbnQoZXYpO1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgY29uc3QgW29mZnNldE5vZGUsIG9mZnNldF0gPSB0YXJnZXREZWVwZXN0KHNlbGVjdGlvbi5hbmNob3JOb2RlLCBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB7IG9mZnNldE5vZGUsIG9mZnNldCB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgaW50ZXJuYWwgcHJvcGVydGllcyBvZiB0aGUgcG9pbnRlciBkb3duIGV2ZW50IHRvIHJldHJpZXZlIHRoZW0gbGF0ZXJcbiAgICAgKiBvbiB3aGVuIHRoZSB1c2VyIHN0b3BzIGRyYWdnaW5nIGl0cyBzZWxlY3Rpb24gYW5kIHRoZSBzZWxlY3Rpb24gaGFzXG4gICAgICogY2hhbmdlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZcbiAgICAgKi9cbiAgICBfb25Qb2ludGVyRG93bihldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gRG9uJ3QgdHJpZ2dlciBldmVudHMgb24gdGhlIGVkaXRhYmxlIGlmIHRoZSBjbGljayB3YXMgZG9uZSBvdXRzaWRlIG9mXG4gICAgICAgIC8vIHRoZSBlZGl0YWJsZSBpdHNlbGYgb3Igb24gc29tZXRoaW5nIGVsc2UgdGhhbiBhbiBlbGVtZW50LlxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLl9nZXRFdmVudFRhcmdldChldik7XG4gICAgICAgIGNvbnN0IGNhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICBpZiAodGFyZ2V0ICYmIHRoaXMuX2lzSW5FZGl0YWJsZShjYXJldFBvc2l0aW9uLm9mZnNldE5vZGUpKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZWRvd25JbkVkaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uID0gY2FyZXRQb3NpdGlvbjtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbkhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2ZvbGxvd3NQb2ludGVyQWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlZG93bkluRWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhdGNoIHNldFNlbGVjdGlvbiBhY3Rpb25zIGNvbWluZyBmcm9tIGNsaWNrcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIF9vblBvaW50ZXJVcChldjogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICAvLyBEb24ndCB0cmlnZ2VyIGV2ZW50cyBvbiB0aGUgZWRpdGFibGUgaWYgdGhlIGNsaWNrIHdhcyBkb25lIG91dHNpZGUgb2ZcbiAgICAgICAgLy8gdGhlIGVkaXRhYmxlIGl0c2VsZiBvciBvbiBzb21ldGhpbmcgZWxzZSB0aGFuIGFuIGVsZW1lbnQuXG4gICAgICAgIGlmICh0aGlzLl9tb3VzZWRvd25JbkVkaXRhYmxlICYmIGV2LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gV2hlbiB0aGUgdXNlcnMgY2xpY2tzIGluIHRoZSBET00sIHRoZSByYW5nZSBpcyBzZXQgaW4gdGhlIG5leHRcbiAgICAgICAgICAgICAgICAvLyB0aWNrLiBUaGUgb2JzZXJ2YXRpb24gb2YgdGhlIHJlc3VsdGluZyByYW5nZSBtdXN0IHRodXMgYmUgZGVsYXllZFxuICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBuZXh0IHRpY2sgYXMgd2VsbC4gU3RvcmUgdGhlIGRhdGEgd2UgaGF2ZSBub3cgYmVmb3JlIGl0XG4gICAgICAgICAgICAgICAgLy8gZ2V0cyBpbnZhbGlkYXRlZCBieSB0aGUgcmVkcmF3aW5nIG9mIHRoZSBET00uXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0ID0gbmV3IFRpbWVvdXQ8RXZlbnRCYXRjaD4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5hbHl6ZVNlbGVjdGlvbkNoYW5nZShldik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50QmF0Y2godGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQucHJvbWlzZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW91c2Vkb3duSW5FZGl0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGV2LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgISFldi50YXJnZXQuY2xvc2VzdCgnW2NvbnRlbnRFZGl0YWJsZT10cnVlXScpKSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdpdGhpbiBhIGNvbnRlbnRlZGl0YWJsZSBlbGVtZW50IGJ1dCBpbiBhIG5vbi1lZGl0YWJsZVxuICAgICAgICAgICAgLy8gY29udGV4dCwgcHJldmVudCBhIGNvbGxhcHNlZCBzZWxlY3Rpb24gYnkgcmVtb3ZpbmcgYWxsIHJhbmdlcy5cbiAgICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSB0aGVtIGZyb20gdGhlIFZEb2N1bWVudCBhcyB3ZWxsLlxuICAgICAgICAgICAgdGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQgPSBuZXcgVGltZW91dDxFdmVudEJhdGNoPigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gdGhpcy5fZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29sbGFwc2VkID1cbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmFuY2hvck5vZGUgPT09IHNlbGVjdGlvbi5mb2N1c05vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmFuY2hvck9mZnNldCA9PT0gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuX2dldENsb3Nlc3RFbGVtZW50KHNlbGVjdGlvbi5mb2N1c05vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsYXBzZWQgJiYgISF0YXJnZXQuY2xvc2VzdCgnW2NvbnRlbnRFZGl0YWJsZT10cnVlXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiBbXSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaCh0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dC5wcm9taXNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbmFseXplIGEgY2hhbmdlIG9mIHNlbGVjdGlvbiB0byB0cmlnZ2VyIGEgcG9pbnRlciBldmVudCBmb3IgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBfYW5hbHl6ZVNlbGVjdGlvbkNoYW5nZShldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBFdmVudEJhdGNoIHtcbiAgICAgICAgY29uc3QgZXZlbnRCYXRjaCA9IHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtdLFxuICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KFtdKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX3NlbGVjdGlvbkhhc0NoYW5nZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgIGRvbVNlbGVjdGlvbjogdGhpcy5fZ2V0U2VsZWN0aW9uKGV2KSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBldmVudEJhdGNoLmFjdGlvbnMucHVzaChzZXRTZWxlY3Rpb25BY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudEJhdGNoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBub2RlJ3MgcGFyZW50IGlmIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIGBFbGVtZW50YC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2dldENsb3Nlc3RFbGVtZW50KG5vZGU6IE5vZGUpOiBFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50ID8gbm9kZSA6IG5vZGUucGFyZW50RWxlbWVudDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgdGhlIGRyYWcgc3RhcnQgZXZlbnQgaXMgb2JzZXJ2ZWQgYnkgdGhlIG5vcm1hbGl6ZXIsIGl0IG1lYW5zIHRoZVxuICAgICAqIGRyYWdnaW5nIHN0YXJ0ZWQgaW4gdGhlIGVkaXRhYmxlIGl0c2VsZi4gSXQgbWVhbnMgdGhlIHVzZXIgaXMgZHJhZ2dpbmdcbiAgICAgKiBjb250ZW50IGFyb3VuZCBpbiB0aGUgZWRpdGFibGUgem9uZS5cbiAgICAgKlxuICAgICAqL1xuICAgIF9vbkRyYWdTdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZHJhZ2dpbmdGcm9tRWRpdGFibGUgPSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRoZSBkcm9wIGV2ZW50IGludG8gYSBjdXN0b20gcHJlLXByb2Nlc3NlZCBmb3JtYXQgaW4gb3JkZXIgdG9cbiAgICAgKiBzdG9yZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHRoYXQgYXJlIHNwZWNpZmljIHRvIHRoaXMgcG9pbnQgaW4gdGltZSxcbiAgICAgKiBzdWNoIGFzIHRoZSBjdXJyZW50IHJhbmdlIGFuZCB0aGUgaW5pdGlhbCBjYXJldCBwb3NpdGlvbi5cbiAgICAgKlxuICAgICAqIEluIHNvbWUgYnJvd3NlciB3ZSBuZWVkIHRvIGluZmVyIHRoZSBkcm9wIGZyb20gb3RoZXIgZXZlbnRzLlxuICAgICAqXG4gICAgICogRXhhbXBsZSBvZiBkcm9wcGFibGUgb2JqZWN0IGFyZSBmaWxlLCB0ZXh0LCB1cmwuXG4gICAgICpcbiAgICAgKiBEcm9wIGV2ZW50IGNhbiBvcmlnaW5hdGUgZnJvbSBhbm90aGVyIHNvZnR3YXJlLCBvdXRzaWRlIHRoZSBlZGl0b3Igem9uZVxuICAgICAqIG9yIGluc2lkZSB0aGUgZWRpdG9yIHpvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBfb25Ecm9wKGV2OiBEcmFnRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gUHJldmVudCBkZWZhdWx0IGJlaGF2aW9yIChlLmcuIHByZXZlbnQgZmlsZSBmcm9tIGJlaW5nIG9wZW5lZCBpbiB0aGVcbiAgICAgICAgLy8gY3VycmVudCB0YWIpLlxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IHRyYW5zZmVyID0gZXYuZGF0YVRyYW5zZmVyO1xuXG4gICAgICAgIGNvbnN0IGZpbGVzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0cmFuc2Zlci5pdGVtcykge1xuICAgICAgICAgICAgaWYgKGl0ZW0ua2luZCA9PT0gJ2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChpdGVtLmdldEFzRmlsZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICBjb25zdCBkcm9wRXZlbnQ6IERhdGFUcmFuc2ZlckRldGFpbHMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZHJvcCcsXG4gICAgICAgICAgICAndGV4dC9wbGFpbic6IHRyYW5zZmVyLmdldERhdGEoJ3RleHQvcGxhaW4nKSxcbiAgICAgICAgICAgICd0ZXh0L2h0bWwnOiB0cmFuc2Zlci5nZXREYXRhKCd0ZXh0L2h0bWwnKSxcbiAgICAgICAgICAgICd0ZXh0L3VyaS1saXN0JzogdHJhbnNmZXIuZ2V0RGF0YSgndGV4dC91cmktbGlzdCcpLFxuICAgICAgICAgICAgZmlsZXM6IGZpbGVzLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXYsXG4gICAgICAgICAgICBzZWxlY3Rpb246IHtcbiAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBjYXJldFBvc2l0aW9uLm9mZnNldE5vZGUsXG4gICAgICAgICAgICAgICAgYW5jaG9yT2Zmc2V0OiBjYXJldFBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgICAgICAgICBmb2N1c05vZGU6IGNhcmV0UG9zaXRpb24ub2Zmc2V0Tm9kZSxcbiAgICAgICAgICAgICAgICBmb2N1c09mZnNldDogY2FyZXRQb3NpdGlvbi5vZmZzZXQsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYXJldFBvc2l0aW9uOiBjYXJldFBvc2l0aW9uLFxuICAgICAgICAgICAgZHJhZ2dpbmdGcm9tRWRpdGFibGU6IHRoaXMuX2RyYWdnaW5nRnJvbUVkaXRhYmxlLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9yZWdpc3RlckV2ZW50KGRyb3BFdmVudCk7XG5cbiAgICAgICAgLy8gRHJhZ2dpbmcgaXMgb3ZlciwgcmVzZXQgdGhpcyBwcm9wZXJ0eS5cbiAgICAgICAgdGhpcy5fZHJhZ2dpbmdGcm9tRWRpdGFibGUgPSBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydCB0aGUgY2xpcGJvYXJkIGV2ZW50IGludG8gYSBjdXN0b20gcHJlLXByb2Nlc3NlZCBmb3JtYXQgaW4gb3JkZXJcbiAgICAgKiB0byBzdG9yZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHRoYXQgYXJlIHNwZWNpZmljIHRvIHRoaXMgcG9pbnQgaW4gdGltZSxcbiAgICAgKiBzdWNoIGFzIHRoZSBjdXJyZW50IHJhbmdlIGFuZCB0aGUgaW5pdGlhbCBjYXJldCBwb3NpdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIF9vbkNsaXBib2FyZChldjogQ2xpcGJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2LnR5cGUgPT09ICdwYXN0ZScpIHtcbiAgICAgICAgICAgIC8vIFByZXZlbnQgdGhlIGRlZmF1bHQgYnJvd3NlciB3aWxkIHBhc3RpbmcgYmVoYXZpb3IuXG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsaXBib2FyZCA9IGV2LmNsaXBib2FyZERhdGE7XG4gICAgICAgIGNvbnN0IHBhc3RlRXZlbnQ6IERhdGFUcmFuc2ZlckRldGFpbHMgPSB7XG4gICAgICAgICAgICB0eXBlOiBldi50eXBlIGFzICdjdXQnIHwgJ3Bhc3RlJyxcbiAgICAgICAgICAgICd0ZXh0L3BsYWluJzogY2xpcGJvYXJkLmdldERhdGEoJ3RleHQvcGxhaW4nKSxcbiAgICAgICAgICAgICd0ZXh0L2h0bWwnOiBjbGlwYm9hcmQuZ2V0RGF0YSgndGV4dC9odG1sJyksXG4gICAgICAgICAgICAndGV4dC91cmktbGlzdCc6IGNsaXBib2FyZC5nZXREYXRhKCd0ZXh0L3VyaS1saXN0JyksXG4gICAgICAgICAgICBmaWxlczogW10sXG4gICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldixcbiAgICAgICAgICAgIHNlbGVjdGlvbjogdGhpcy5fZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICBjYXJldFBvc2l0aW9uOiB0aGlzLl9pbml0aWFsQ2FyZXRQb3NpdGlvbixcbiAgICAgICAgICAgIGRyYWdnaW5nRnJvbUVkaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJFdmVudChwYXN0ZUV2ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIG1vZGlmaWVycyBrZXlzIHRvIGtub3cgd2hpY2ggbW9kaWZpZXJzIGtleXMgYXJlIHB1c2hlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBlXG4gICAgICovXG4gICAgX3VwZGF0ZU1vZGlmaWVyc0tleXMoZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9tb2RpZmllcktleXMgPSB7XG4gICAgICAgICAgICBjdHJsS2V5OiBlLmN0cmxLZXksXG4gICAgICAgICAgICBhbHRLZXk6IGUuYWx0S2V5LFxuICAgICAgICAgICAgbWV0YUtleTogZS5tZXRhS2V5LFxuICAgICAgICAgICAgc2hpZnRLZXk6IGUuc2hpZnRLZXksXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9uIGVhY2ggY2hhbmdlIG9mIHNlbGVjdGlvbiwgY2hlY2sgaWYgaXQgbWlnaHQgYmUgYSBcInNlbGVjdEFsbFwiIGFjdGlvbi5cbiAgICAgKlxuICAgICAqIEEgXCJzZWxlY3RBbGxcIiBhY3Rpb24gY2FuIGJlIHRyaWdnZXJlZCBieTpcbiAgICAgKiAtIFRoZSBzaG9ydGN1dCAnQ1RSTCtBJ1xuICAgICAqIC0gQSB1c2VyIG1hcHBpbmcgb2YgdGhlIE9TIG9yIGJyb3dzZXJcbiAgICAgKiAtIEZyb20gdGhlIGNvbnRleHQgbWVudVxuICAgICAqIC0gUHJvZ3JhbW1hdGljYWxseVxuICAgICAqL1xuICAgIF9vblNlbGVjdGlvbkNoYW5nZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pbml0aWFsQ2FyZXRQb3NpdGlvbikge1xuICAgICAgICAgICAgLy8gRmlsdGVyIHRoZSBldmVudHMgYmVjYXVzZSB3ZSBjYW4gaGF2ZSBzb21lIFNoYWRvdyByb290IGFuZCBlYWNoXG4gICAgICAgICAgICAvLyBub3JtYWxpc2VyIGJpbmQgZXZlbnQgb24gZG9jdW1lbnQuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gdGhpcy5fZ2V0U2VsZWN0aW9uKCk7XG5cbiAgICAgICAgdGhpcy5fc3dpZnRLZXlEZWxldGVXb3JkU2VsZWN0aW9uQ2FjaGUucHVzaChzZWxlY3Rpb24pO1xuXG4gICAgICAgIGNvbnN0IGtleWRvd25FdmVudCA9IHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5rZXlkb3duO1xuICAgICAgICBjb25zdCBpc05hdkV2ZW50ID1cbiAgICAgICAgICAgIGtleWRvd25FdmVudCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQgJiZcbiAgICAgICAgICAgIGtleWRvd25FdmVudC50eXBlID09PSAna2V5ZG93bicgJiZcbiAgICAgICAgICAgIG5hdmlnYXRpb25LZXkuaGFzKGtleWRvd25FdmVudC5rZXkpO1xuICAgICAgICBpZiAoaXNOYXZFdmVudCkge1xuICAgICAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uQWN0aW9uOiBTZXRTZWxlY3Rpb25BY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NldFNlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiBzZWxlY3Rpb24sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5pbml0TmV4dE9ic2VydmF0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaChcbiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeyBhY3Rpb25zOiBbc2V0U2VsZWN0aW9uQWN0aW9uXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uSGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAvLyBUaGlzIGhldXJpc3RpYyBwcm90ZWN0cyBhZ2FpbnN0IGEgY29zdGx5IGBfaXNTZWxlY3RBbGxgIGNhbGwuXG4gICAgICAgICAgICBjb25zdCBtb2RpZmllZEtleUV2ZW50ID0gdGhpcy5fbW9kaWZpZXJLZXlzLmN0cmxLZXkgfHwgdGhpcy5fbW9kaWZpZXJLZXlzLm1ldGFLZXk7XG4gICAgICAgICAgICBjb25zdCBoZXVyaXN0aWMgPSBtb2RpZmllZEtleUV2ZW50IHx8IHRoaXMuX2ZvbGxvd3NQb2ludGVyQWN0aW9uO1xuICAgICAgICAgICAgY29uc3QgaXNTZWxlY3RBbGwgPSBoZXVyaXN0aWMgJiYgdGhpcy5faXNTZWxlY3RBbGwoc2VsZWN0aW9uKTtcbiAgICAgICAgICAgIGlmIChpc1NlbGVjdEFsbCAmJiAhdGhpcy5fY3VycmVudGx5U2VsZWN0aW5nQWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGlmaWVkS2V5RXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBzZWxlY3QgYWxsIHdhcyB0cmlnZ2VyZWQgZnJvbSB0aGUga2V5Ym9hcmQuIEFkZCBhXG4gICAgICAgICAgICAgICAgICAgIC8vIGZha2Ugc2VsZWN0QWxsIGV2ZW50IHRvIHRoZSBxdWV1ZSBhcyBhIG1hcmtlciBmb3JcbiAgICAgICAgICAgICAgICAgICAgLy8gYF9wcm9jZXNzRXZlbnRzYCB0byByZWdpc3RlciB0aGF0IGEgc2VsZWN0IGFsbCB3YXNcbiAgICAgICAgICAgICAgICAgICAgLy8gdHJpZ2dlcmVkIGluIHRoaXMgc3RhY2suXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVyRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdrZXlib2FyZFNlbGVjdEFsbCcpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgdGFyZ2V0IG9mIHRoZSBzZWxlY3QgYWxsIHNwZWNpZmllcyB3aGVyZSB0aGUgdXNlciBjYXJldFxuICAgICAgICAgICAgICAgICAgICAvLyB3YXMgd2hlbiB0aGUgc2VsZWN0IGFsbCB3YXMgdHJpZ2dlcmVkLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RBbGxBY3Rpb246IFNlbGVjdEFsbEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3RBbGwnLFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGRpZCBub3QgZmluZCBhbnkgY2FzZSB3aGVyZSBhIHNlbGVjdCBhbGwgdHJpZ2dlcmVkXG4gICAgICAgICAgICAgICAgICAgIC8vIGZyb20gdGhlIG1vdXNlIGFjdHVhbGx5IHJlc3VsdGVkIGluIGEgbXV0YXRpb24sIHNvIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBtdXRhdGlvbiBub3JtYWxpemVyIGlzIG5vdCBsaXN0bmVuaW5nIGluIHRoaXMgY2FzZS4gSWYgaXRcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFwcGVucyB0byBiZSBpbnN1ZmZpY2llbnQgbGF0ZXIgb24sIHRoZSBtdXRhdGVkIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpbGwgbmVlZCB0byBiZSByZXRyaWV2ZWQgZnJvbSB0aGUgbXV0YXRpb24gbm9ybWFsaXplci5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50QmF0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IFtzZWxlY3RBbGxBY3Rpb25dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0ZWRFbGVtZW50czogbmV3IFNldCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU2FmYXJpIG9uIE1hY09TIHRyaWdnZXJzIGEgc2VsZWN0aW9uIGNoYW5nZSB3aGVuIHByZXNzaW5nIEN0cmxcbiAgICAgICAgICAgIC8vIGV2ZW4gdGhvdWdoIHRoZSBzZWxlY3Rpb24gZGlkIG5vdCBhY3R1YWxseSBjaGFuZ2UuIFRoaXMgcHJvcGVydHlcbiAgICAgICAgICAgIC8vIGlzIHVzZWQgdG8gc3RvcmUgd2hldGhlciB0aGUgY3VycmVudCBzdGF0ZSBpcyBjb25zaWRlcmVkIHRvIGJlIGFcbiAgICAgICAgICAgIC8vIHNlbGVjdCBhbGwuIFRoZSBwb2ludCBpcyB0byBhdm9pZCB0cmlnZ2VyaW5nIGEgbmV3IGV2ZW50IGZvciBhXG4gICAgICAgICAgICAvLyBzZWxlY3Rpb24gY2hhbmdlIGlmIGV2ZXJ5dGhpbmcgd2FzIGFscmVhZHkgc2VsZWN0ZWQgYmVmb3JlaGFuZC5cbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRseVNlbGVjdGluZ0FsbCA9IGlzU2VsZWN0QWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBFdmVudE5vcm1hbGl6ZXIgaWYgdGhlIHBvaW50ZXIgdG91Y2ggYSBzaGFkb3cgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZcbiAgICAgKi9cbiAgICBfb25FdmVudEVuYWJsZU5vcm1hbGl6ZXIoZXY6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2VuYWJsZU5vcm1hbGl6ZXIoZXYudGFyZ2V0IGFzIEVsZW1lbnQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgRXZlbnROb3JtYWxpemVyIGZvciB0aGUgZ2l2ZW4gZWxlbWVudCB3aXRoIHNoYWRvd1xuICAgICAqIGNvbnRlbnQgb3IgaWZyYW1lIGNvbnRlbnQuXG4gICAgICogVG8gYmUgZWRpdGFibGUgYW4gaWZyYW1lIGNhbm5vdCBoYXZlIHNyYyBiZWNhdXNlIGl0IG11c3QgYmUgYW4gaWZyYW1lXG4gICAgICogd2l0aCBjb250ZW50IGdlbmVyYXRlZCBieSB0aGUgZWRpdG9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgICAqL1xuICAgIHByaXZhdGUgX2VuYWJsZU5vcm1hbGl6ZXIoZWw6IEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgcm9vdCA9XG4gICAgICAgICAgICBlbC5zaGFkb3dSb290IHx8XG4gICAgICAgICAgICAoZWwgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCAmJlxuICAgICAgICAgICAgICAgICghZWwuc3JjIHx8IGVsLnNyYyA9PT0gd2luZG93LmxvY2F0aW9uLmhyZWYpICYmXG4gICAgICAgICAgICAgICAgZWwuY29udGVudFdpbmRvdy5kb2N1bWVudCk7XG4gICAgICAgIGlmIChyb290ICYmICF0aGlzLl9zaGFkb3dOb3JtYWxpemVycy5nZXQocm9vdCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50Tm9ybWFsaXplciA9IG5ldyBFdmVudE5vcm1hbGl6ZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5faXNJbkVkaXRhYmxlLFxuICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudEJhdGNoLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0tleWRvd24sXG4gICAgICAgICAgICAgICAgcm9vdCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLl9zaGFkb3dOb3JtYWxpemVycy5zZXQocm9vdCwgZXZlbnROb3JtYWxpemVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuaW50ZXJmYWNlIENoYXJNdXRhdGlvbiB7XG4gICAgb2xkPzogc3RyaW5nO1xuICAgIGN1cnJlbnQ/OiBzdHJpbmc7XG4gICAgdGFyZ2V0PzogTm9kZTtcbn1cbmludGVyZmFjZSBDaGFyYWN0ZXJzTWFwcGluZyB7XG4gICAgY2hhcnM6IHN0cmluZzsgLy8gY29uY2F0ZW5hdGVkIGNoYXJhY3RlcnMgYWNjcm9zcyBtdWx0aXBsZSBub2Rlc1xuICAgIG5vZGVzOiBBcnJheTxOb2RlPjsgLy8gY29ycmVzcG9uZGluZyB0ZXh0dWFsIG5vZGVzXG4gICAgb2Zmc2V0czogbnVtYmVyW107IC8vIGNoYXJhY3RlciBvZmZzZXRzIGluIHRoZWlyIGNvcnJlc3BvbmRpbmcgdGV4dHVhbCBub2Rlc1xufVxuXG5leHBvcnQgY2xhc3MgTXV0YXRpb25Ob3JtYWxpemVyIHtcbiAgICAvKipcbiAgICAgKiBUaGUgTXV0YXRpb25PYnNlcnZlciB1c2VkIGJ5IHRoZSBub3JtYWxpemVyIHRvIHdhdGNoIHRoZSBub2RlcyB0aGF0IGFyZVxuICAgICAqIGJlaW5nIG1vZGlmaWVkIHNpbmNlIHRoZSBub3JtYWxpemVyIGNyZWF0aW9uIHVudGlsIGl0IGlzIGRyZXN0cm95ZWQuXG4gICAgICovXG4gICAgX29ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyO1xuXG4gICAgX2xpc3RlbjogYm9vbGVhbjtcbiAgICBfbXV0YXRpb25zOiBNdXRhdGlvblJlY29yZFtdO1xuXG4gICAgY29uc3RydWN0b3IoZWw6IEVsZW1lbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgIHRoaXMuX29ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodGhpcy5fb25NdXRhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXIub2JzZXJ2ZShlbCwge1xuICAgICAgICAgICAgY2hhcmFjdGVyRGF0YU9sZFZhbHVlOiB0cnVlLCAvLyBhZGQgb2xkIHRleHQgdmFsdWUgb24gY2hhbmdlc1xuICAgICAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwgLy8gbW9uaXRvciB0ZXh0IGNvbnRlbnQgY2hhbmdlc1xuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLCAvLyBtb25pdG9yIGNoaWxkIG5vZGVzIGFkZGl0aW9uIG9yIHJlbW92YWxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsIC8vIGV4dGVuZCBtb25pdG9yaW5nIHRvIGFsbCBjaGlsZHJlbiBvZiB0aGUgdGFyZ2V0XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fbGlzdGVuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgYSBtYXBwaW5nIG9mIHRoZSBzZXBhcmF0ZSBjaGFyYWN0ZXJzLCB0aGVpciBjb3JyZXNwb25kaW5nIHRleHRcbiAgICAgKiBub2RlcyBhbmQgdGhlaXIgb2Zmc2V0cyBpbiBzYWlkIG5vZGVzIGZyb20gdGhlIGdpdmVuIG5vZGUncyBzdWJ0cmVlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gY2hhck11dGF0aW9uc1xuICAgICAqIEByZXR1cm5zIHsgcHJldmlvdXMsIGN1cnJlbnQgfVxuICAgICAqL1xuICAgIGdldENoYXJhY3RlcnNNYXBwaW5nKCk6IHtcbiAgICAgICAgaW5zZXJ0OiBzdHJpbmc7XG4gICAgICAgIHJlbW92ZTogc3RyaW5nO1xuICAgICAgICBpbmRleDogbnVtYmVyO1xuICAgICAgICBwcmV2aW91czogQ2hhcmFjdGVyc01hcHBpbmc7XG4gICAgICAgIGN1cnJlbnQ6IENoYXJhY3RlcnNNYXBwaW5nO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBiZWZvcmU6IFNldDxOb2RlPiA9IG5ldyBTZXQoKTtcbiAgICAgICAgY29uc3QgYWRkOiBTZXQ8Tm9kZT4gPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQ6IFNldDxOb2RlPiA9IG5ldyBTZXQoKTtcbiAgICAgICAgY29uc3QgdGV4dE11dGF0aW9ucyA9IFtdO1xuICAgICAgICAvLyBHYXRoZXIgYWxsIG1vZGlmaWVkIG5vZGVzIHRvIG5vdGlmeSB0aGUgbGlzdGVuZXIuXG4gICAgICAgIGZ1bmN0aW9uIGdldFNlbGZBbmRBbGxDaGlsZHJlbih0YXJnZXQ6IE5vZGUpOiBOb2RlW10ge1xuICAgICAgICAgICAgY29uc3QgdGV4dHMgPSBbdGFyZ2V0XTtcbiAgICAgICAgICAgIHRhcmdldC5jaGlsZE5vZGVzLmZvckVhY2godGFyZ2V0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0cy5wdXNoKC4uLmdldFNlbGZBbmRBbGxDaGlsZHJlbih0YXJnZXQpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRleHRzO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGlzVGV4dE5vZGUodGFyZ2V0OiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0Lm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSB8fCBub2RlTmFtZSh0YXJnZXQpID09PSAnQlInO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5mb3JFYWNoKHJlY29yZCA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRNdXRhdGlvbiA9IHJlY29yZC50YXJnZXQ7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRJc0FkZGVkID0gYWRkLmhhcyh0YXJnZXRNdXRhdGlvbik7XG4gICAgICAgICAgICBpZiAoIXRhcmdldElzQWRkZWQpIHtcbiAgICAgICAgICAgICAgICBiZWZvcmUuYWRkKHRhcmdldE11dGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudC5hZGQodGFyZ2V0TXV0YXRpb24pO1xuICAgICAgICAgICAgICAgIHRleHRNdXRhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0TXV0YXRpb24sXG4gICAgICAgICAgICAgICAgICAgIG9sZDogcmVjb3JkLm9sZFZhbHVlLnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDogdGFyZ2V0TXV0YXRpb24udGV4dENvbnRlbnQucmVwbGFjZSgvXFx1MDBBMC9nLCAnICcpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWNvcmQuYWRkZWROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBnZXRTZWxmQW5kQWxsQ2hpbGRyZW4obm9kZSkuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJlZm9yZS5oYXMoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkLmFkZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmFkZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGV4dE5vZGUoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dE11dGF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGNoaWxkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNoaWxkLnRleHRDb250ZW50LnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnXFxuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZWNvcmQucmVtb3ZlZE5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGdldFNlbGZBbmRBbGxDaGlsZHJlbihub2RlKS5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LmhhcyhjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmRlbGV0ZShjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0SXNBZGRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZC5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZGQuaGFzKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZS5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RleHROb2RlKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRNdXRhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBjaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjaGlsZC50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHUwMEEwL2csICcgJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ1xcbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGFscmVhZHkgPSBuZXcgTWFwKCk7XG4gICAgICAgIGNvbnN0IGNoYXJNdXRhdGlvbnMgPSBbXTtcbiAgICAgICAgdGV4dE11dGF0aW9ucy5mb3JFYWNoKHRleHRNdXRhdGlvbiA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0ZXh0TXV0YXRpb24udGFyZ2V0O1xuICAgICAgICAgICAgbGV0IG11dGF0aW9uID0gYWxyZWFkeS5nZXQodGFyZ2V0KTtcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Lmhhcyh0YXJnZXQpICYmICFtdXRhdGlvbi5jdXJyZW50Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5jdXJyZW50ID0gdGV4dE11dGF0aW9uLmN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXJyZW50Lmhhcyh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBvbGQ6IGJlZm9yZS5oYXModGFyZ2V0KSA/IHRleHRNdXRhdGlvbi5vbGQgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDogdGV4dE11dGF0aW9uLmN1cnJlbnQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjaGFyTXV0YXRpb25zLnB1c2gobXV0YXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmUuaGFzKHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICBtdXRhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgIG9sZDogdGV4dE11dGF0aW9uLm9sZCxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDogJycsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjaGFyTXV0YXRpb25zLnB1c2gobXV0YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWxyZWFkeS5zZXQodGFyZ2V0LCBtdXRhdGlvbik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRMaW5rZWQgPSB0aGlzLl9nZXRDaGFyTGlua2VkKGNoYXJNdXRhdGlvbnMsICdjdXJyZW50Jyk7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzTGlua2VkID0gdGhpcy5fZ2V0Q2hhckxpbmtlZChjaGFyTXV0YXRpb25zLCAnb2xkJyk7XG5cbiAgICAgICAgY29uc3Qgb2xkVGV4dCA9IHByZXZpb3VzTGlua2VkLmNoYXJzO1xuICAgICAgICBjb25zdCBjdXJyZW50VGV4dCA9IGN1cnJlbnRMaW5rZWQuY2hhcnM7XG4gICAgICAgIGlmIChvbGRUZXh0ID09PSBjdXJyZW50VGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleDogLTEsXG4gICAgICAgICAgICAgICAgaW5zZXJ0OiAnJyxcbiAgICAgICAgICAgICAgICByZW1vdmU6ICcnLFxuICAgICAgICAgICAgICAgIHByZXZpb3VzOiBwcmV2aW91c0xpbmtlZCxcbiAgICAgICAgICAgICAgICBjdXJyZW50OiBjdXJyZW50TGlua2VkLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoYW5nZVBvc2l0aW9uID0gdGhpcy5fY2hhbmdlZE9mZnNldChvbGRUZXh0LCBjdXJyZW50VGV4dCk7XG4gICAgICAgIGNvbnN0IG1pbkxlbmd0aCA9IE1hdGgubWluKG9sZFRleHQubGVuZ3RoLCBjdXJyZW50VGV4dC5sZW5ndGgpO1xuXG4gICAgICAgIGxldCBpbnNlcnRCeUNoYW5nZTogc3RyaW5nO1xuICAgICAgICBjb25zdCB1bmtub3duUG9zaXRpb24gPSBjaGFuZ2VQb3NpdGlvbi5sZWZ0ID4gbWluTGVuZ3RoIC0gY2hhbmdlUG9zaXRpb24ucmlnaHQ7XG5cbiAgICAgICAgaWYgKHVua25vd25Qb3NpdGlvbikge1xuICAgICAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gTWF0aC5tYXgob2xkVGV4dC5sZW5ndGgsIGN1cnJlbnRUZXh0Lmxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBsZW4gPSBtYXhMZW5ndGggLSBtaW5MZW5ndGg7XG4gICAgICAgICAgICBpbnNlcnRCeUNoYW5nZSA9IGN1cnJlbnRUZXh0LnNsaWNlKGN1cnJlbnRUZXh0Lmxlbmd0aCAtIGNoYW5nZVBvc2l0aW9uLnJpZ2h0KTtcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrICsgbGVuIDwgbWluTGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5zZXJ0QnlDaGFuZ2VbayAtIDFdID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0QnlDaGFuZ2UgPSBpbnNlcnRCeUNoYW5nZS5zbGljZShrKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5zZXJ0QnlDaGFuZ2UgPSBpbnNlcnRCeUNoYW5nZS5zbGljZSgwLCBsZW4pO1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlQnlDaGFuZ2UgPSBvbGRUZXh0LnNsaWNlKFxuICAgICAgICAgICAgICAgIG9sZFRleHQubGVuZ3RoIC0gY2hhbmdlUG9zaXRpb24ucmlnaHQgLSBsZW4sXG4gICAgICAgICAgICAgICAgb2xkVGV4dC5sZW5ndGggLSBjaGFuZ2VQb3NpdGlvbi5yaWdodCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGluZGV4OiAtMSxcbiAgICAgICAgICAgICAgICBpbnNlcnQ6IGluc2VydEJ5Q2hhbmdlLFxuICAgICAgICAgICAgICAgIHJlbW92ZTogcmVtb3ZlQnlDaGFuZ2UsXG4gICAgICAgICAgICAgICAgcHJldmlvdXM6IHByZXZpb3VzTGlua2VkLFxuICAgICAgICAgICAgICAgIGN1cnJlbnQ6IGN1cnJlbnRMaW5rZWQsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5zZXJ0QnlDaGFuZ2UgPSBjdXJyZW50VGV4dC5zbGljZShcbiAgICAgICAgICAgICAgICBjaGFuZ2VQb3NpdGlvbi5sZWZ0LFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUZXh0Lmxlbmd0aCAtIGNoYW5nZVBvc2l0aW9uLnJpZ2h0LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBmaW5lQ2hhbmdlUG9zaXRpb246IHsgbGVmdDogbnVtYmVyOyByaWdodDogbnVtYmVyIH07XG4gICAgICAgIGxldCBpbnNlcnRlZFdvcmRBbmFseXNlZDogc3RyaW5nO1xuICAgICAgICBpZiAodGV4dE11dGF0aW9ucy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBsZXQgYWxyZWFkeUZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKGxldCBrID0gdGV4dE11dGF0aW9ucy5sZW5ndGggLSAxOyBrID49IDA7IGstLSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXJNdXRhdGlvbiA9IHRleHRNdXRhdGlvbnNba107XG4gICAgICAgICAgICAgICAgaWYgKGNoYXJNdXRhdGlvbi5vbGQubGVuZ3RoID49IGNoYXJNdXRhdGlvbi5jdXJyZW50Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRDaGFuZ2U6IHN0cmluZztcbiAgICAgICAgICAgICAgICBpZiAoY2hhck11dGF0aW9uLm9sZCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFscmVhZHlGb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2xkVGV4dE11dGF0aW9uID0gY2hhck11dGF0aW9uLm9sZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRleHRNdXRhdGlvbiA9IGNoYXJNdXRhdGlvbi5jdXJyZW50O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNNdXRhdGlvbiA9IHRoaXMuX2NoYW5nZWRPZmZzZXQob2xkVGV4dE11dGF0aW9uLCBjdXJyZW50VGV4dE11dGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYW5nZSA9IGN1cnJlbnRUZXh0TXV0YXRpb24uc2xpY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNNdXRhdGlvbi5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRleHRNdXRhdGlvbi5sZW5ndGggLSByZXNNdXRhdGlvbi5yaWdodCxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYXJNdXRhdGlvbi5jdXJyZW50ID09PSBjdXJyZW50VGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2hhbmdlID0gY2hhck11dGF0aW9uLmN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlSW5kZXggPSBjdXJyZW50Q2hhbmdlLmluZGV4T2YoaW5zZXJ0QnlDaGFuZ2UpO1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXhTdGFydCA9IGN1cnJlbnRUZXh0LmluZGV4T2YoY3VycmVudENoYW5nZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXhFbmQgPSBpbmRleFN0YXJ0ICsgY3VycmVudENoYW5nZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgcmFuZ2VDaGFuZ2VTdGFydCA9IGNoYW5nZVBvc2l0aW9uLmxlZnQgLSBjaGFuZ2VJbmRleDtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZUNoYW5nZUVuZCA9IGN1cnJlbnRUZXh0Lmxlbmd0aCAtIGNoYW5nZVBvc2l0aW9uLnJpZ2h0O1xuXG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAocmFuZ2VDaGFuZ2VTdGFydCA+PSBpbmRleFN0YXJ0ICYmIHJhbmdlQ2hhbmdlU3RhcnQgPCBpbmRleEVuZCkgfHxcbiAgICAgICAgICAgICAgICAgICAgKHJhbmdlQ2hhbmdlRW5kID4gaW5kZXhTdGFydCAmJiByYW5nZUNoYW5nZUVuZCA8PSBpbmRleEVuZCkgfHxcbiAgICAgICAgICAgICAgICAgICAgKHJhbmdlQ2hhbmdlRW5kID49IGluZGV4RW5kICYmIHJhbmdlQ2hhbmdlU3RhcnQgPD0gaW5kZXhTdGFydClcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgZmluZUNoYW5nZVBvc2l0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogaW5kZXhTdGFydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBjdXJyZW50VGV4dC5sZW5ndGggLSBpbmRleEVuZCxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWRXb3JkQW5hbHlzZWQgPSBjdXJyZW50Q2hhbmdlO1xuICAgICAgICAgICAgICAgICAgICBhbHJlYWR5Rm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhck11dGF0aW9uLm9sZCA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgaW5zZXJ0ZWRXb3JkQW5hbHlzZWQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpbnNlcnRlZFdvcmRBbmFseXNlZCA9IGluc2VydEJ5Q2hhbmdlO1xuXG4gICAgICAgICAgICBsZXQgYmVmb3JlSW5kZXggPSBpbnNlcnRlZFdvcmRBbmFseXNlZC5pbmRleE9mKGluc2VydEJ5Q2hhbmdlKTtcbiAgICAgICAgICAgIGlmIChpbnNlcnRCeUNoYW5nZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBiZWZvcmVJbmRleCA9IGluc2VydGVkV29yZEFuYWx5c2VkLmxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlSW5kZXggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluZUNoYW5nZVBvc2l0aW9uID0ge1xuICAgICAgICAgICAgICAgIGxlZnQ6IGNoYW5nZVBvc2l0aW9uLmxlZnQgLSBiZWZvcmVJbmRleCxcbiAgICAgICAgICAgICAgICByaWdodDogY2hhbmdlUG9zaXRpb24ucmlnaHQsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVtb3ZlZFdvcmRBbmFseXNlZCA9IG9sZFRleHQuc2xpY2UoXG4gICAgICAgICAgICBmaW5lQ2hhbmdlUG9zaXRpb24ubGVmdCxcbiAgICAgICAgICAgIG9sZFRleHQubGVuZ3RoIC0gZmluZUNoYW5nZVBvc2l0aW9uLnJpZ2h0LFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpbmRleDogZmluZUNoYW5nZVBvc2l0aW9uLmxlZnQsXG4gICAgICAgICAgICBpbnNlcnQ6IGluc2VydGVkV29yZEFuYWx5c2VkLFxuICAgICAgICAgICAgcmVtb3ZlOiByZW1vdmVkV29yZEFuYWx5c2VkLFxuICAgICAgICAgICAgcHJldmlvdXM6IHByZXZpb3VzTGlua2VkLFxuICAgICAgICAgICAgY3VycmVudDogY3VycmVudExpbmtlZCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0TXV0YXRlZEVsZW1lbnRzKCk6IFNldDxOb2RlPiB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzOiBTZXQ8Tm9kZT4gPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5mb3JFYWNoKE11dGF0aW9uUmVjb3JkID0+IHtcbiAgICAgICAgICAgIGlmIChNdXRhdGlvblJlY29yZC50eXBlID09PSAnY2hhcmFjdGVyRGF0YScpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5hZGQoTXV0YXRpb25SZWNvcmQudGFyZ2V0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgTXV0YXRpb25SZWNvcmQuYWRkZWROb2Rlcy5mb3JFYWNoKHRhcmdldCA9PiBlbGVtZW50cy5hZGQodGFyZ2V0KSk7XG4gICAgICAgICAgICAgICAgTXV0YXRpb25SZWNvcmQucmVtb3ZlZE5vZGVzLmZvckVhY2godGFyZ2V0ID0+IGVsZW1lbnRzLmFkZCh0YXJnZXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBlbGVtZW50cztcbiAgICB9XG4gICAgc3RvcCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fbGlzdGVuID0gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIGRlc3Ryb3kgdGhlIG11dGF0aW9uIG5vcm1hbGl6ZXIuXG4gICAgICogUmVtb3ZlIGFsbCBhZGRlZCBoYW5kbGVycy5cbiAgICAgKlxuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX29ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIF9nZXRDaGFyTGlua2VkKGNoYXJNdXRhdGlvbnM6IENoYXJNdXRhdGlvbltdLCB0eXBlOiBzdHJpbmcpOiBDaGFyYWN0ZXJzTWFwcGluZyB7XG4gICAgICAgIGNvbnN0IG1hcE5vZGVWYWx1ZSA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIGNvbnN0IG9iajogQ2hhcmFjdGVyc01hcHBpbmcgPSB7XG4gICAgICAgICAgICBjaGFyczogJycsXG4gICAgICAgICAgICBub2RlczogW10sXG4gICAgICAgICAgICBvZmZzZXRzOiBbXSxcbiAgICAgICAgfTtcbiAgICAgICAgY2hhck11dGF0aW9ucy5mb3JFYWNoKGNoYXJNdXRhdGlvbiA9PiB7XG4gICAgICAgICAgICBtYXBOb2RlVmFsdWUuc2V0KGNoYXJNdXRhdGlvbi50YXJnZXQsIGNoYXJNdXRhdGlvblt0eXBlXSk7XG4gICAgICAgICAgICBjb25zdCBsZW4gPSBjaGFyTXV0YXRpb25bdHlwZV0ubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKG9iai5ub2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFyUGFyZW50ZWQgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSBjaGFyTXV0YXRpb24udGFyZ2V0O1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgbm9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAoIShub2RlIGluc3RhbmNlb2YgRWxlbWVudCkgfHwgIW5vZGUuZ2V0QXR0cmlidXRlKCdjb250ZW50RWRpdGFibGUnKSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhclBhcmVudGVkLmFkZChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGZpcnN0ID0gb2JqLm5vZGVzWzBdO1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgZmlyc3QgJiZcbiAgICAgICAgICAgICAgICAgICAgKCEoZmlyc3QgaW5zdGFuY2VvZiBFbGVtZW50KSB8fCAhZmlyc3QuZ2V0QXR0cmlidXRlKCdjb250ZW50RWRpdGFibGUnKSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJQYXJlbnRlZC5oYXMoZmlyc3QucHJldmlvdXNTaWJsaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmNoYXJzID0gY2hhck11dGF0aW9uW3R5cGVdICsgb2JqLmNoYXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLm5vZGVzLnVuc2hpZnQoLi4ubmV3IEFycmF5KGxlbikuZmlsbChjaGFyTXV0YXRpb24udGFyZ2V0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoub2Zmc2V0cy51bnNoaWZ0KC4uLkFycmF5KGxlbikua2V5cygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IGZpcnN0LnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JqLmNoYXJzICs9IGNoYXJNdXRhdGlvblt0eXBlXTtcbiAgICAgICAgICAgIG9iai5ub2Rlcy5wdXNoKC4uLm5ldyBBcnJheShsZW4pLmZpbGwoY2hhck11dGF0aW9uLnRhcmdldCkpO1xuICAgICAgICAgICAgb2JqLm9mZnNldHMucHVzaCguLi5BcnJheShsZW4pLmtleXMoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICBvYmouY2hhcnMgPSBvYmouY2hhcnMucmVwbGFjZSgvXFx1MDBBMC9nLCAnICcpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgICBfY2hhbmdlZE9mZnNldChvbGQ6IHN0cmluZywgY3VycmVudDogc3RyaW5nKTogeyBsZWZ0OiBudW1iZXI7IHJpZ2h0OiBudW1iZXIgfSB7XG4gICAgICAgIC8vIEluIHRoZSBvcHRpbWFsIGNhc2Ugd2hlcmUgYm90aCB0aGUgcmFuZ2UgaXMgY29ycmVjdGx5IHBsYWNlZCBhbmQgdGhlXG4gICAgICAgIC8vIGRhdGEgcHJvcGVydHkgb2YgdGhlIGNvbXBvc2l0aW9uIGV2ZW50IGlzIGNvcnJlY3RseSBzZXQsIHRoZSBhYm92ZVxuICAgICAgICAvLyBhbmFseXNpcyBpcyBjYXBhYmxlIG9mIGZpbmRpbmcgdGhlIHByZWNpc2UgdGV4dCB0aGF0IHdhcyBpbnNlcnRlZC5cbiAgICAgICAgLy8gSG93ZXZlciwgaWYgYW55IG9mIHRoZXNlIHR3byBjb25kaXRpb25zIGFyZSBub3QgbWV0LCB0aGUgcmVzdWx0c1xuICAgICAgICAvLyBtaWdodCBiZSBzcGVjdGFjdWxhcmx5IHdyb25nLiBGb3IgZXhhbXBsZSwgc3BlbGwgY2hlY2tpbmcgc3VnZ2VzdGlvbnNcbiAgICAgICAgLy8gb24gTWFjT1MgYXJlIGRpc3BsYXllZCB3aGlsZSBob3ZlcmluZyB0aGUgbWlzcGVsbGVkIHdvcmQsIHJlZ2FyZGxlc3NcbiAgICAgICAgLy8gb2YgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHJhbmdlLCBhbmQgdGhlIGNvcnJlY3Rpb24gZG9lcyBub3RcbiAgICAgICAgLy8gdHJpZ2dlciBhbiB1cGRhdGUgb2YgdGhlIHJhbmdlIHBvc2l0aW9uIGVpdGhlciBhZnRlciBjb3JyZWN0aW5nLlxuICAgICAgICAvLyBFeGFtcGxlIChgfGAgcmVwcmVzZW50cyB0aGUgdGV4dCBjdXJzb3IpOlxuICAgICAgICAvLyAgIFByZXZpb3VzIGNvbnRlbnQ6ICdNeSBmcmllbmQgQ2hyaXN0b2ZlIHdhcyBoZXJlLnwnXG4gICAgICAgIC8vICAgQ3VycmVudCBjb250ZW50OiAgJ015IGZyaWVuZCBDaHJpc3RvcGhlIE1hdHRoaWV1IHdhcyBoZXJlLnwnXG4gICAgICAgIC8vICAgQWN0dWFsIHRleHQgaW5zZXJ0ZWQgYnkgdGhlIGtleWJvYXJkOiAnQ2hyaXN0b3BoZSBNYXR0aGlldSdcbiAgICAgICAgLy8gICBSZXN1bHQgaWYgZGF0YSBpcyBzZXQgdG8gJ0NocmlzdG9waGUnIChsZW5ndGg6IDEwKTogJ2Ugd2FzIGhlcmUnXG4gICAgICAgIC8vICAgUmVzdWx0IGlmIGRhdGEgaXMgbm90IHNldCAocmVnYXJkbGVzcyBvZiB0aGUgcmFuZ2UpOiAnJ1xuICAgICAgICAvL1xuICAgICAgICAvLyBCZWNhdXNlIHRoZSBmaXJzdCBhbmFseXNpcyBtaWdodCBub3QgYmUgZW5vdWdoIGluIHNvbWUgY2FzZXMsIGFcbiAgICAgICAgLy8gc2Vjb25kIGFuYWx5c2lzIG11c3QgYmUgcGVyZm9ybWVkLiBUaGlzIGFuYWx5c2lzIGFpbXMgYXQgcHJlY2lzZWx5XG4gICAgICAgIC8vIGlkZW50aWZ5aW5nIHRoZSBvZmZzZXQgb2YgdGhlIGFjdHVhbCBjaGFuZ2UgaW4gdGhlIHRleHQgYnkgY29tcGFyaW5nXG4gICAgICAgIC8vIHRoZSBwcmV2aW91cyBjb250ZW50IHdpdGggdGhlIGN1cnJlbnQgb25lIGZyb20gbGVmdCB0byByaWdodCB0byBmaW5kXG4gICAgICAgIC8vIHRoZSBzdGFydCBvZiB0aGUgY2hhbmdlIGFuZCBmcm9tIHJpZ2h0IHRvIGxlZnQgdG8gZmluZCBpdHMgZW5kLlxuICAgICAgICAvLyBFeGFtcGxlIChgfGAgcmVwcmVzZW50cyB0aGUgdGV4dCBjdXJzb3IpOlxuICAgICAgICAvLyAgIFByZXZpb3VzIGNvbnRlbnQ6ICdNeSBmcmllbmQgQ2hyaXN0b2ZlfCB3YXMgaGVyZS4nXG4gICAgICAgIC8vICAgQ3VycmVudCBjb250ZW50OiAgJ015IGZyaWVuZCBDaHJpc3RvcGhlIE1hdHRoaWV1fCB3YXMgaGVyZS4nXG4gICAgICAgIC8vICAgT2JzZXJ2ZWQgY2hhbmdlOiAgJ015IGZyaWVuZCBDaHJpc3RvW2ZlID0+IHBoZSBNYXR0aGlldV0gd2FzIGhlcmUuJ1xuICAgICAgICAvLyAgIENoYW5nZSBvZmZzZXRzIGluIHRoZSBjdXJyZW50IGNvbnRlbnQ6IHtsZWZ0OiAxNywgcmlnaHQ6IDI5fVxuXG4gICAgICAgIGNvbnN0IG9sZFRleHQgPSBvbGQ7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUZXh0ID0gY3VycmVudDtcbiAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gTWF0aC5tYXgob2xkVGV4dC5sZW5ndGgsIGN1cnJlbnRUZXh0Lmxlbmd0aCk7XG4gICAgICAgIGxldCBsZWZ0ID0gMDtcbiAgICAgICAgZm9yICg7IGxlZnQgPCBtYXhMZW5ndGg7IGxlZnQrKykge1xuICAgICAgICAgICAgaWYgKG9sZFRleHRbbGVmdF0gIT09IGN1cnJlbnRUZXh0W2xlZnRdKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJpZ2h0ID0gMDtcbiAgICAgICAgZm9yICg7IHJpZ2h0IDwgbWF4TGVuZ3RoOyByaWdodCsrKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgb2xkVGV4dFtvbGRUZXh0Lmxlbmd0aCAtIDEgLSByaWdodF0gIT09IGN1cnJlbnRUZXh0W2N1cnJlbnRUZXh0Lmxlbmd0aCAtIDEgLSByaWdodF1cbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGxlZnQsIHJpZ2h0IH07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEhhbmRsZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgX29uTXV0YXRpb24obXV0YXRpb25zTGlzdDogTXV0YXRpb25SZWNvcmRbXSk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5fbGlzdGVuKSB7XG4gICAgICAgICAgICAvLyB3ZSBwdXNoIHRoZSBtdXRhdGlvbiBiZWNhdXNlIHNvbWUgYnJvd3NlciAoZS5nLiBzYWZhcmkpIHNlcGFyYXRlIG11dGF0aW9ucyB3aXRoXG4gICAgICAgICAgICAvLyBtaWNyb3Rhc2suXG4gICAgICAgICAgICB0aGlzLl9tdXRhdGlvbnMucHVzaCguLi5tdXRhdGlvbnNMaXN0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9Gb2xsb3dSYW5nZS5jc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cbnZhciBleHBvcnRlZCA9IGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB7fTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZWQ7IiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEZvbGxvd1JhbmdlWm9uZU5vZGVYbWxEb21QYXJzZXIgfSBmcm9tICcuL0ZvbGxvd1JhbmdlWm9uZU5vZGVYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgRm9sbG93UmFuZ2Vab25lRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0ZvbGxvd1JhbmdlWm9uZURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBEb21MYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0JztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5cbmV4cG9ydCBjbGFzcyBGb2xsb3dSYW5nZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtQYXJzZXIsIFJlbmRlcmVyLCBEb21MYXlvdXQsIExheW91dF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbRm9sbG93UmFuZ2Vab25lTm9kZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW0ZvbGxvd1JhbmdlWm9uZURvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IEZvbGxvd1JhbmdlWm9uZU5vZGUgfSBmcm9tICcuL0ZvbGxvd1JhbmdlWm9uZU5vZGUnO1xuaW1wb3J0IHsgdGFyZ2V0RGVlcGVzdCB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9Eb20nO1xuXG5pbXBvcnQgJy4uL2Fzc2V0cy9Gb2xsb3dSYW5nZS5jc3MnO1xuXG5leHBvcnQgY2xhc3MgRm9sbG93UmFuZ2Vab25lRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IEZvbGxvd1JhbmdlWm9uZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogRm9sbG93UmFuZ2Vab25lTm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGlmIChub2RlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIGxldCBkZWJvdW5jZTogbnVtYmVyO1xuICAgICAgICAgICAgbGV0IGZvbGxvd1JhbmdlRGVib3VuY2VkOiAoKSA9PiB2b2lkO1xuICAgICAgICAgICAgY29uc3QgZm9sbG93UmFuZ2U6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdKVy1GT0xMT1ctUkFOR0UnLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuKCksXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogeyBzdHlsZTogeyAnZGlzcGxheSc6ICdub25lJyB9IH0sXG4gICAgICAgICAgICAgICAgYXR0YWNoOiAoZWw6IEhUTUxFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGZvbGxvd1JhbmdlRGVib3VuY2VkID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChkZWJvdW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJvdW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZvbGxvd0NoYW5nZWRTZWxlY3Rpb24uYmluZCh0aGlzLCBlbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZvbGxvd1JhbmdlRGVib3VuY2VkLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmb2xsb3dSYW5nZURlYm91bmNlZCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkZXRhY2g6ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZm9sbG93UmFuZ2VEZWJvdW5jZWQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZvbGxvd1JhbmdlRGVib3VuY2VkKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBmb2xsb3dSYW5nZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IGNoaWxkcmVuOiBbXSB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfZm9sbG93Q2hhbmdlZFNlbGVjdGlvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGxldCBzZWxlY3Rpb246IFNlbGVjdGlvbjtcbiAgICAgICAgbGV0IGRvYzogRG9jdW1lbnQgfCBTaGFkb3dSb290ID0gZG9jdW1lbnQ7XG4gICAgICAgIGxldCBpc0NvbGxhcHNlZCA9IHRydWU7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbiA9IGRvYy5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGRvYyA9IG51bGw7XG4gICAgICAgICAgICAvLyBkb24ndCB1c2Ugc2VsZWN0aW9uLmlzQ29sbGFwc2VkIGJlY2F1c2UgaW4gc2hhZG93Um9vdCB0aGUgdmFsdWVcbiAgICAgICAgICAgIC8vIGlzIGV2ZXJ5IHRpbWUgdHJ1ZS5cbiAgICAgICAgICAgIGlzQ29sbGFwc2VkID1cbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYW5jaG9yTm9kZSA9PT0gc2VsZWN0aW9uLmZvY3VzTm9kZSAmJlxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JPZmZzZXQgPT09IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24ucmFuZ2VDb3VudCAmJiBpc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtlbF0gPSB0YXJnZXREZWVwZXN0KHNlbGVjdGlvbi5hbmNob3JOb2RlLCBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBFbGVtZW50ICYmIGVsLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jID0gZWwuc2hhZG93Um9vdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKGRvYyk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbklzSW5FZGl0YWJsZSA9XG4gICAgICAgICAgICAhIXNlbGVjdGlvbiAmJlxuICAgICAgICAgICAgc2VsZWN0aW9uLmFuY2hvck5vZGUgJiZcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JOb2RlLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnW2NvbnRlbnRlZGl0YWJsZT1cInRydWVcIl0nKTtcblxuICAgICAgICAvLyBJZiB0aGUgc2VsZWN0aW9uIGdvZXMgaW50byBhbiBpbnB1dCBpbnNpZGUgdGhlIGp3LWZvbGxvdy1yYW5nZSwgZG8gbm90aGluZy5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQgJiZcbiAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuY2xvc2VzdCgnSlctRk9MTE9XLVJBTkdFJylcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2VsZWN0aW9uLnJhbmdlQ291bnQgJiYgIWlzQ29sbGFwc2VkICYmIHNlbGVjdGlvbklzSW5FZGl0YWJsZSkge1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5wYXJlbnRFbGVtZW50LnRhZ05hbWUgIT09ICdCT0RZJykge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gICAgICAgICAgICBjb25zdCBib3ggPSByYW5nZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSB3aW5kb3cuc2Nyb2xsWSArIGJveC50b3AgLSBzaXplLmhlaWdodCArICdweCc7XG4gICAgICAgICAgICBsZXQgbGVmdFBvc2l0aW9uID0gYm94LmxlZnQgKyAoYm94LndpZHRoIC0gc2l6ZS53aWR0aCkgLyAyO1xuICAgICAgICAgICAgbGVmdFBvc2l0aW9uID0gTWF0aC5tYXgoMCwgbGVmdFBvc2l0aW9uKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gbGVmdFBvc2l0aW9uICsgJ3B4JztcbiAgICAgICAgfSBlbHNlIGlmIChjb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7XG4gICAgICAgICAgICAvLyBVc2UgY29uZGl0aW9uIHRvIGhhdmUgdGhlIG1pbmltdW0gb2YgbXV0YXRpb25zLlxuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBab25lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL1pvbmVOb2RlJztcblxuZXhwb3J0IGNsYXNzIEZvbGxvd1JhbmdlWm9uZU5vZGUgZXh0ZW5kcyBab25lTm9kZSB7fVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBGb2xsb3dSYW5nZVpvbmVOb2RlIH0gZnJvbSAnLi9Gb2xsb3dSYW5nZVpvbmVOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEZvbGxvd1JhbmdlWm9uZU5vZGVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdULVJBTkdFJztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCB6b25lcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGl0ZW0ucXVlcnlTZWxlY3RvckFsbCgndFt0LXpvbmVdJykpIHtcbiAgICAgICAgICAgIHpvbmVzLnB1c2goY2hpbGQuZ2V0QXR0cmlidXRlKCd0LXpvbmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtuZXcgRm9sbG93UmFuZ2Vab25lTm9kZSh7IG1hbmFnZWRab25lczogem9uZXMgfSldO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFZOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtc1R5cGUsIENvbW1hbmRzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvbnRleHRNYW5hZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBFeGVjdXRpb25Db250ZXh0IHtcbiAgICBleGVjQ29tbWFuZDogPFAgZXh0ZW5kcyBKV1BsdWdpbiwgQyBleHRlbmRzIENvbW1hbmRzPFA+ID0gQ29tbWFuZHM8UD4+KFxuICAgICAgICBjb21tYW5kTmFtZTogQyB8ICgoY29udGV4dDogQ29udGV4dCkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQpLFxuICAgICAgICBwYXJhbXM/OiBDb21tYW5kUGFyYW1zVHlwZTxQLCBDPixcbiAgICApID0+IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBEb21IZWxwZXJzPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgY2xhc3Mgb3IgYSBsaXN0IG9mIGNsYXNzZXMgdG8gYSBET00gbm9kZSBvciBhIGxpc3Qgb2YgRE9NIG5vZGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIGFkZENsYXNzKFxuICAgICAgICBjb250ZXh0OiBFeGVjdXRpb25Db250ZXh0LFxuICAgICAgICBkb21Ob2RlOiBOb2RlIHwgTm9kZVtdLFxuICAgICAgICBjbGFzc05hbWU6IHN0cmluZyB8IHN0cmluZ1tdLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkb21IZWxwZXJzQWRkQ2xhc3MgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gQXJyYXkuaXNBcnJheShjbGFzc05hbWUpID8gY2xhc3NOYW1lIDogW2NsYXNzTmFtZV07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5nZXROb2Rlcyhkb21Ob2RlKSkge1xuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5jbGFzc0xpc3QuYWRkKC4uLmNsYXNzZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29udGV4dC5leGVjQ29tbWFuZChkb21IZWxwZXJzQWRkQ2xhc3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBjbGFzcyBvciBhIGxpc3Qgb2YgY2xhc3NlcyBmcm9tIGEgRE9NIG5vZGUgb3IgYSBsaXN0IG9mIERPTSBub2Rlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyByZW1vdmVDbGFzcyhcbiAgICAgICAgY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCxcbiAgICAgICAgZG9tTm9kZTogTm9kZSB8IE5vZGVbXSxcbiAgICAgICAgY2xhc3NOYW1lOiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tSGVscGVyc1JlbW92ZUNsYXNzID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IEFycmF5LmlzQXJyYXkoY2xhc3NOYW1lKSA/IGNsYXNzTmFtZSA6IFtjbGFzc05hbWVdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBub2RlLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5jbGFzc0xpc3QucmVtb3ZlKC4uLmNsYXNzZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29udGV4dC5leGVjQ29tbWFuZChkb21IZWxwZXJzUmVtb3ZlQ2xhc3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgb3IgcmVtb3ZlIGEgY2xhc3Mgb3IgYSBsaXN0IG9mIGNsYXNzZXMgZnJvbSBhIERPTSBub2RlIG9yIGEgbGlzdCBvZlxuICAgICAqIERPTSBub2Rlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyB0b2dnbGVDbGFzcyhcbiAgICAgICAgY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCxcbiAgICAgICAgZG9tTm9kZTogTm9kZSB8IE5vZGVbXSxcbiAgICAgICAgY2xhc3NOYW1lOiBzdHJpbmcsXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGRvbUhlbHBlcnNUb2dnbGVDbGFzcyA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBBcnJheS5pc0FycmF5KGNsYXNzTmFtZSkgPyBjbGFzc05hbWUgOiBbY2xhc3NOYW1lXTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzLmdldE5vZGVzKGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLmNsYXNzTGlzdC50b2dnbGUoLi4uY2xhc3Nlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb250ZXh0LmV4ZWNDb21tYW5kKGRvbUhlbHBlcnNUb2dnbGVDbGFzcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCBhbiBhdHRyaWJ1dGUgb24gYSBET00gbm9kZSBvciBhIGxpc3Qgb2YgRE9NIG5vZGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIHNldEF0dHJpYnV0ZShcbiAgICAgICAgY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCxcbiAgICAgICAgZG9tTm9kZTogTm9kZSB8IE5vZGVbXSxcbiAgICAgICAgbmFtZTogc3RyaW5nLFxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkb21IZWxwZXJzU2V0QXR0cmlidXRlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc2V0KG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuZXhlY0NvbW1hbmQoZG9tSGVscGVyc1NldEF0dHJpYnV0ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBhdHRyaWJ1dGVzIHdpdGggdGhlIGdpdmVuIGRpY3Rpb25uYXJ5IGFuZCBjbGVhciBhbGwgcHJldmlvdXNcbiAgICAgKiBhdHRyaWJ1dGVzLlxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUF0dHJpYnV0ZXMoXG4gICAgICAgIGNvbnRleHQ6IEV4ZWN1dGlvbkNvbnRleHQsXG4gICAgICAgIGRvbU5vZGU6IE5vZGUgfCBOb2RlW10sXG4gICAgICAgIGF0dHJpYnV0ZXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGRvbUhlbHBlcnNVcGRhdGVBdHRyaWJ1dGUgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5nZXROb2Rlcyhkb21Ob2RlKSkge1xuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5jbGVhcigpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc2V0KG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb250ZXh0LmV4ZWNDb21tYW5kKGRvbUhlbHBlcnNVcGRhdGVBdHRyaWJ1dGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgYSBzdHlsZSBrZXkvdmFsdWUgcGFpciBvbiBhIERPTSBub2RlIG9yIGEgbGlzdCBvZiBET00gbm9kZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgc2V0U3R5bGUoXG4gICAgICAgIGNvbnRleHQ6IEV4ZWN1dGlvbkNvbnRleHQsXG4gICAgICAgIGRvbU5vZGU6IE5vZGUgfCBOb2RlW10sXG4gICAgICAgIG5hbWU6IHN0cmluZyxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgaW1wb3J0YW50PzogYm9vbGVhbixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tSGVscGVyc1NldFN0eWxlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGltcG9ydGFudCA/IHZhbHVlICsgJyAhaW1wb3J0YW50JyA6IHZhbHVlO1xuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zdHlsZS5zZXQobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29udGV4dC5leGVjQ29tbWFuZChkb21IZWxwZXJzU2V0U3R5bGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBET00gbm9kZSBvciBhIGxpc3Qgb2YgRE9NIG5vZGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShcbiAgICAgICAgY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCxcblxuICAgICAgICBkb21Ob2RlOiBOb2RlIHwgTm9kZVtdLFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkb21IZWxwZXJzUmVtb3ZlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29udGV4dC5leGVjQ29tbWFuZChkb21IZWxwZXJzUmVtb3ZlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoZSBjb250ZW50cyBvZiBhIERPTSBub2RlIG9yIG9mIGEgbGlzdCBvZiBET00gbm9kZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgZW1wdHkoXG4gICAgICAgIGNvbnRleHQ6IEV4ZWN1dGlvbkNvbnRleHQsXG5cbiAgICAgICAgZG9tTm9kZTogTm9kZSB8IE5vZGVbXSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tSGVscGVyc0VtcHR5ID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBub2RlLmVtcHR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb250ZXh0LmV4ZWNDb21tYW5kKGRvbUhlbHBlcnNFbXB0eSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlcGxhY2UgYSBET00gbm9kZSBvciBhIGxpc3Qgb2YgRE9NIG5vZGVzIHdpdGggdGhlIGdpdmVuIEhUTUwgY29udGVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyByZXBsYWNlKGNvbnRleHQ6IEV4ZWN1dGlvbkNvbnRleHQsIGRvbU5vZGVzOiBOb2RlIHwgTm9kZVtdLCBodG1sOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tSGVscGVyc1JlcGxhY2UgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuZ2V0Tm9kZXMoZG9tTm9kZXMpO1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkTm9kZXMgPSBhd2FpdCB0aGlzLl9wYXJzZUh0bWxTdHJpbmcoaHRtbCk7XG4gICAgICAgICAgICBjb25zdCBmaXJzdE5vZGUgPSBub2Rlc1swXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFyc2VkTm9kZSBvZiBwYXJzZWROb2Rlcykge1xuICAgICAgICAgICAgICAgIGZpcnN0Tm9kZS5iZWZvcmUocGFyc2VkTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29udGV4dC5leGVjQ29tbWFuZChkb21IZWxwZXJzUmVwbGFjZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyYXAgdGhlIGdpdmVuIEhUTUwgY29udGVudCB3aXRoaW4gYSBET00gY29udGFpbmVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIHdyYXAoY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCwgZG9tQ29udGFpbmVyOiBOb2RlLCBodG1sOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZG9tSGVscGVyc1dyYXAgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmdldE5vZGVzKGRvbUNvbnRhaW5lcilbMF07XG4gICAgICAgICAgICBpZiAoIShjb250YWluZXIgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBwcm92aWRlZCBjb250YWluZXIgbXVzdCBiZSBhIENvbnRhaW5lck5vZGUgaW4gdGhlIEphYmJlcndvY2sgc3RydWN0dXJlLicsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZE5vZGVzID0gYXdhaXQgdGhpcy5fcGFyc2VIdG1sU3RyaW5nKGh0bWwpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJzZWROb2RlIG9mIHBhcnNlZE5vZGVzKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLndyYXAocGFyc2VkTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb250ZXh0LmV4ZWNDb21tYW5kKGRvbUhlbHBlcnNXcmFwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW92ZSBhIERPTSBOb2RlIGJlZm9yZSBhbm90aGVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIG1vdmVCZWZvcmUoY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCwgZnJvbURvbU5vZGU6IE5vZGUsIHRvRG9tTm9kZTogTm9kZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkb21IZWxwZXJzTW92ZUJlZm9yZSA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRvTm9kZSA9IHRoaXMuZ2V0Tm9kZXModG9Eb21Ob2RlKVswXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZnJvbU5vZGUgb2YgdGhpcy5nZXROb2Rlcyhmcm9tRG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBmcm9tTm9kZS5iZWZvcmUodG9Ob2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuZXhlY0NvbW1hbmQoZG9tSGVscGVyc01vdmVCZWZvcmUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNb3ZlIGEgRE9NIE5vZGUgYWZ0ZXIgYW5vdGhlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyBtb3ZlQWZ0ZXIoY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCwgZnJvbURvbU5vZGU6IE5vZGUsIHRvRG9tTm9kZTogTm9kZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkb21IZWxwZXJzTW92ZUFmdGVyID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgY29uc3QgdG9Ob2RlcyA9IHRoaXMuZ2V0Tm9kZXModG9Eb21Ob2RlKTtcbiAgICAgICAgICAgIGNvbnN0IHRvTm9kZSA9IHRvTm9kZXNbdG9Ob2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZnJvbU5vZGUgb2YgdGhpcy5nZXROb2Rlcyhmcm9tRG9tTm9kZSkucmV2ZXJzZSgpKSB7XG4gICAgICAgICAgICAgICAgZnJvbU5vZGUuYWZ0ZXIodG9Ob2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuZXhlY0NvbW1hbmQoZG9tSGVscGVyc01vdmVBZnRlcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluc2VydCBodG1sIGNvbnRlbnQgYmVmb3JlLCBhZnRlciBvciBpbnNpZGUgYSBET00gTm9kZS4gSWYgbm8gRE9NIE5vZGVcbiAgICAgKiB3YXMgcHJvdmlkZWQsIGVtcHR5IHRoZSByYW5nZSBhbmQgaW5zZXJ0IHRoZSBodG1sIGNvbnRlbnQgYmVmb3JlIHRoZSBpdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyBpbnNlcnRIdG1sKFxuICAgICAgICBjb250ZXh0OiBFeGVjdXRpb25Db250ZXh0LFxuICAgICAgICBodG1sOiBzdHJpbmcsXG4gICAgICAgIGRvbU5vZGU/OiBOb2RlLFxuICAgICAgICBwb3NpdGlvbj86IFJlbGF0aXZlUG9zaXRpb24sXG4gICAgKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGxldCBwYXJzZWROb2RlczogVk5vZGVbXTtcbiAgICAgICAgYXdhaXQgY29udGV4dC5leGVjQ29tbWFuZChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgbm9kZXM6IFZOb2RlW107XG4gICAgICAgICAgICBpZiAoZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGVzID0gdGhpcy5nZXROb2Rlcyhkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoIW5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBnaXZlbiBET00gbm9kZSBkb2VzIG5vdCBoYXZlIGEgY29ycmVzcG9uZGluZyBWTm9kZS4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbiB8fCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgbm9kZXMgPSBbdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnN0YXJ0XTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyc2VkTm9kZXMgPSBhd2FpdCB0aGlzLl9wYXJzZUh0bWxTdHJpbmcoaHRtbCk7XG4gICAgICAgICAgICBzd2l0Y2ggKHBvc2l0aW9uLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFOlxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnNlZE5vZGUgb2YgcGFyc2VkTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzWzBdLmJlZm9yZShwYXJzZWROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFJlbGF0aXZlUG9zaXRpb24uQUZURVI6XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFyc2VkTm9kZSBvZiBbLi4ucGFyc2VkTm9kZXNdLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbbm9kZXMubGVuZ3RoIC0gMV0uYWZ0ZXIocGFyc2VkTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERTpcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJzZWROb2RlIG9mIFsuLi5wYXJzZWROb2Rlc10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdLmFwcGVuZChwYXJzZWROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwYXJzZWROb2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBgVk5vZGVgKHMpIG1hdGNoaW5nIGEgRE9NIE5vZGUgb3IgYSBsaXN0IG9mIERPTSBOb2Rlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb21Ob2RlXG4gICAgICovXG4gICAgZ2V0Tm9kZXMoZG9tTm9kZTogTm9kZSB8IE5vZGVbXSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChMYXlvdXQpO1xuICAgICAgICBjb25zdCBkb21FbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICBsZXQgbm9kZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgb25lRG9tTm9kZSBvZiBkb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZXMucHVzaCguLi5kb21FbmdpbmUuZ2V0Tm9kZXMob25lRG9tTm9kZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm9kZXMgPSBkb21FbmdpbmUuZ2V0Tm9kZXMoZG9tTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIERPTSBOb2RlKHMpIG1hdGNoaW5nIGEgVk5vZGUgb3IgYSBsaXN0IG9mIFZOb2Rlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgZ2V0RG9tTm9kZXMobm9kZTogVk5vZGUgfCBWTm9kZVtdKTogTm9kZVtdIHtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tRW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgbGV0IGRvbU5vZGVzOiBOb2RlW10gPSBbXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobm9kZSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgb25lTm9kZSBvZiBub2RlKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZXMucHVzaCguLi5kb21FbmdpbmUuZ2V0RG9tTm9kZXMob25lTm9kZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZG9tTm9kZXMgPSBkb21FbmdpbmUuZ2V0RG9tTm9kZXMobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGVzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYW4gSFRNTCBzdHJpbmcgYW5kIHJldHVybiB0aGUgcmVzdWx0aW5nIGBWTm9kZXNgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGh0bWxcbiAgICAgKi9cbiAgICBhc3luYyBfcGFyc2VIdG1sU3RyaW5nKGh0bWw6IHN0cmluZyk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBwYXJzZXIgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChQYXJzZXIpO1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGl2LmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHJldHVybiBwYXJzZXIucGFyc2UoJ2RvbS9odG1sJywgLi4uZGl2LmNoaWxkTm9kZXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3RFbGVtZW50LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuaW1wb3J0IHsgRG9tTGF5b3V0IH0gZnJvbSAnLi9Eb21MYXlvdXQnO1xuXG5leHBvcnQgdHlwZSBEb21PYmplY3RBY3Rpb25hYmxlID0gRG9tT2JqZWN0RWxlbWVudCAmIHsgaGFuZGxlcjogKCkgPT4gdm9pZCB9O1xuXG5leHBvcnQgY2xhc3MgQWN0aW9uYWJsZURvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGU6IFByZWRpY2F0ZSA9IEFjdGlvbmFibGVOb2RlO1xuXG4gICAgYWN0aW9uYWJsZU5vZGVzID0gbmV3IE1hcDxBY3Rpb25hYmxlTm9kZSwgSFRNTEVsZW1lbnQ+KCk7XG5cbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSkge1xuICAgICAgICBzdXBlcihlbmdpbmUpO1xuICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmRIb29rKFxuICAgICAgICAgICAgJ0Bjb21taXQnLFxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uYWJsZXMuYmluZCh0aGlzKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXIoXG4gICAgICAgIGJ1dHRvbjogQWN0aW9uYWJsZU5vZGUsXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBQcm9taXNlPERvbU9iamVjdEFjdGlvbmFibGU+IHtcbiAgICAgICAgbGV0IGNsaWNrSGFuZGxlcjogKGV2OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBsZXQgbW91c2Vkb3duSGFuZGxlcjogKGV2OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBjb25zdCBvYmplY3RCdXR0b246IERvbU9iamVjdEFjdGlvbmFibGUgPSB7XG4gICAgICAgICAgICB0YWc6ICdKVy1CVVRUT04nLFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgIG5hbWU6IGJ1dHRvbi5hY3Rpb25OYW1lLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhbmRsZXI6ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYnV0dG9uLmNvbW1hbmRJZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY0NvbW1hbmQoYnV0dG9uLmNvbW1hbmRJZCwgYnV0dG9uLmNvbW1hbmRBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXR0YWNoOiAoZWw6IEhUTUxCdXR0b25FbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgY2xpY2tIYW5kbGVyID0gKGV2KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0QnV0dG9uLmhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIG1vdXNlZG93bkhhbmRsZXIgPSAoZXY6IE1vdXNlRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0hhbmRsZXIpO1xuICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG1vdXNlZG93bkhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uYWJsZU5vZGVzLnNldChidXR0b24sIGVsKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZXRhY2g6IChlbDogSFRNTEJ1dHRvbkVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgbW91c2Vkb3duSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3Rpb25hYmxlTm9kZXMuZGVsZXRlKGJ1dHRvbik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gYnV0dG9uLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSBhdHRyaWJ1dGVzPy5nZXQoJ2NsYXNzJyk7XG4gICAgICAgIGlmIChjbGFzc05hbWU/LmluY2x1ZGVzKCcgZmEtJykpIHtcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlcy5nZXQoJ3RpdGxlJykpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RCdXR0b24uYXR0cmlidXRlcy50aXRsZSA9IGJ1dHRvbi5sYWJlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9iamVjdEJ1dHRvbi5jaGlsZHJlbiA9IFt7IHRleHQ6IGJ1dHRvbi5sYWJlbCB9XTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvYmplY3RCdXR0b247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGJ1dHRvbiByZW5kZXJpbmcgYWZ0ZXIgdGhlIGNvbW1hbmQgaWYgdGhlIHZhbHVlIG9mIHNlbGVjdGVkIG9yXG4gICAgICogZW5hYmxlZCBjaGFuZ2UuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF91cGRhdGVBY3Rpb25hYmxlcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcGx1Z2luQ29uZmlnID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KERvbUxheW91dCkuY29uZmlndXJhdGlvbjtcbiAgICAgICAgY29uc3QgcHJlc3NlZEFjdGlvbmFibGVzQ2xhc3NOYW1lID0gcGx1Z2luQ29uZmlnLnByZXNzZWRBY3Rpb25hYmxlc0NsYXNzTmFtZVxuICAgICAgICAgICAgPyBwbHVnaW5Db25maWcucHJlc3NlZEFjdGlvbmFibGVzQ2xhc3NOYW1lXG4gICAgICAgICAgICA6ICdwcmVzc2VkJztcbiAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uYWJsZSwgZWxlbWVudF0gb2YgdGhpcy5hY3Rpb25hYmxlTm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZW5naW5lLmVkaXRvcjtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdCA9ICEhYWN0aW9uYWJsZS5zZWxlY3RlZChlZGl0b3IpO1xuICAgICAgICAgICAgY29uc3QgZW5hYmxlID0gISFhY3Rpb25hYmxlLmVuYWJsZWQoZWRpdG9yKTtcbiAgICAgICAgICAgIGNvbnN0IHZpc2libGUgPSAhIWFjdGlvbmFibGUudmlzaWJsZShlZGl0b3IpO1xuXG4gICAgICAgICAgICBjb25zdCBhdHRyU2VsZWN0ZWQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0LnRvU3RyaW5nKCkgIT09IGF0dHJTZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLXByZXNzZWQnLCBzZWxlY3QudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQocHJlc3NlZEFjdGlvbmFibGVzQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUocHJlc3NlZEFjdGlvbmFibGVzQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkb21FbmFibGUgPSAhZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICBpZiAoZW5hYmxlICE9PSBkb21FbmFibGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZG9tVmlzaWJsZSA9IGVsZW1lbnQuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgICAgICAgaWYgKHZpc2libGUgIT09IGRvbVZpc2libGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHtcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IEFjdGlvbmFibGVHcm91cE5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlR3JvdXBOb2RlJztcblxuZXhwb3J0IGNsYXNzIEFjdGlvbmFibGVHcm91cERvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBBY3Rpb25hYmxlR3JvdXBOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKGdyb3VwOiBBY3Rpb25hYmxlR3JvdXBOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWdyb3VwLmRlc2NlbmRhbnRzKG5vZGUgPT4gIShub2RlIGluc3RhbmNlb2YgQWN0aW9uYWJsZUdyb3VwTm9kZSkgJiYgbm9kZS50YW5naWJsZSlcbiAgICAgICAgICAgICAgICAubGVuZ3RoXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIHsgY2hpbGRyZW46IFtdIH07XG4gICAgICAgIH0gZWxzZSBpZiAoZ3JvdXAuYW5jZXN0b3IoQWN0aW9uYWJsZUdyb3VwTm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJTZWxlY3QoZ3JvdXApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckdyb3VwKGdyb3VwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIF9yZW5kZXJTZWxlY3QoZ3JvdXA6IEFjdGlvbmFibGVHcm91cE5vZGUpOiBEb21PYmplY3Qge1xuICAgICAgICBjb25zdCBvYmplY3RTZWxlY3Q6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgIHRhZzogJ1NFTEVDVCcsXG4gICAgICAgICAgICBjaGlsZHJlbjogW3sgdGFnOiAnT1BUSU9OJyB9LCAuLi5ncm91cC5jaGlsZHJlbigpXSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG9iamVjdFNlbGVjdDtcbiAgICB9XG4gICAgcHJpdmF0ZSBfcmVuZGVyR3JvdXAoZ3JvdXA6IEFjdGlvbmFibGVHcm91cE5vZGUpOiBEb21PYmplY3Qge1xuICAgICAgICBjb25zdCBvYmplY3RHcm91cDogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnSlctR1JPVVAnLFxuICAgICAgICAgICAgY2hpbGRyZW46IGdyb3VwLmNoaWxkcmVuKCksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvYmplY3RHcm91cDtcbiAgICB9XG59XG4iLCJpbXBvcnQge1xuICAgIERvbU9iamVjdCxcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlR3JvdXBOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZUdyb3VwTm9kZSc7XG5pbXBvcnQgeyBTZXBhcmF0b3JOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1NlcGFyYXRvck5vZGUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTGFiZWxOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGFiZWxOb2RlJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgRG9tT2JqZWN0QWN0aW9uYWJsZSB9IGZyb20gJy4vQWN0aW9uYWJsZURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5leHBvcnQgY2xhc3MgQWN0aW9uYWJsZUdyb3VwU2VsZWN0SXRlbURvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSAobm9kZTogVk5vZGUpOiBib29sZWFuID0+IG5vZGUuYW5jZXN0b3JzKEFjdGlvbmFibGVHcm91cE5vZGUpLmxlbmd0aCA+PSAyO1xuXG4gICAgYWN0aW9uYWJsZU5vZGVzID0gbmV3IE1hcDxBY3Rpb25hYmxlTm9kZSwgSFRNTEVsZW1lbnQ+KCk7XG5cbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSkge1xuICAgICAgICBzdXBlcihlbmdpbmUpO1xuICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmRIb29rKFxuICAgICAgICAgICAgJ0Bjb21taXQnLFxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uYWJsZXMuYmluZCh0aGlzKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXIoaXRlbTogVk5vZGUsIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPERvbU9iamVjdD4pOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBsZXQgZG9tT2JqZWN0OiBEb21PYmplY3Q7XG4gICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgQWN0aW9uYWJsZU5vZGUpIHtcbiAgICAgICAgICAgIGxldCBoYW5kbGVyOiAoZXY6IEV2ZW50KSA9PiB2b2lkO1xuICAgICAgICAgICAgY29uc3QgZG9tT2JqZWN0QWN0aW9uYWJsZTogRG9tT2JqZWN0QWN0aW9uYWJsZSA9IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdPUFRJT04nLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0uYWN0aW9uTmFtZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBpdGVtLmxhYmVsID8gW3sgdGV4dDogaXRlbS5sYWJlbCB9XSA6IFtdLFxuICAgICAgICAgICAgICAgIGhhbmRsZXI6ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY29tbWFuZElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY0NvbW1hbmQoaXRlbS5jb21tYW5kSWQsIGl0ZW0uY29tbWFuZEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhdHRhY2g6IChlbDogSFRNTE9wdGlvbkVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ID0gZWwuY2xvc2VzdCgnc2VsZWN0JykgfHwgZWwucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciA9IChldjogRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKCdvcHRpb246Y2hlY2tlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbiA9PT0gZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21PYmplY3RBY3Rpb25hYmxlLmhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbmFibGVOb2Rlcy5zZXQoaXRlbSwgZWwpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGV0YWNoOiAoZWw6IEhUTUxPcHRpb25FbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdCA9IGVsLmNsb3Nlc3QoJ3NlbGVjdCcpIHx8IGVsLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3Rpb25hYmxlTm9kZXMuZGVsZXRlKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZG9tT2JqZWN0ID0gZG9tT2JqZWN0QWN0aW9uYWJsZTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgQWN0aW9uYWJsZUdyb3VwTm9kZSkge1xuICAgICAgICAgICAgaWYgKGl0ZW0uYW5jZXN0b3JzKEFjdGlvbmFibGVHcm91cE5vZGUpLmxlbmd0aCA8PSAyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBpdGVtLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5nZXQoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgZG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0YWc6ICdPUFRHUk9VUCcsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0uZ3JvdXBOYW1lIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogdGl0bGUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IGl0ZW0uY2hpbGRyZW4oKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb21PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBpdGVtLmNoaWxkcmVuKCksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgU2VwYXJhdG9yTm9kZSkge1xuICAgICAgICAgICAgZG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgIHRhZzogJ09QVElPTicsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICByb2xlOiAnc2VwYXJhdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICd0cnVlJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgTGFiZWxOb2RlKSB7XG4gICAgICAgICAgICBkb21PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgdGFnOiAnT1BUSU9OJyxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBuZXcgU2V0KFsnbGFiZWwnXSksXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAndHJ1ZScsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3sgdGV4dDogaXRlbS5sYWJlbCB9XSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbSBpbnN0YW5jZW9mIFpvbmVOb2RlKSB7XG4gICAgICAgICAgICBkb21PYmplY3QgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihpdGVtLCB3b3JrZXIpO1xuICAgICAgICAgICAgaWYgKCEoJ3RhZycgaW4gZG9tT2JqZWN0KSB8fCBkb21PYmplY3QudGFnLnRvVXBwZXJDYXNlKCkgIT09ICdPUFRJT04nKSB7XG4gICAgICAgICAgICAgICAgZG9tT2JqZWN0ID0geyBjaGlsZHJlbjogaXRlbS5jaGlsZHJlbigpIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb21PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgdGFnOiAnT1BUSU9OJyxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3sgdGV4dDogaXRlbS50ZXh0Q29udGVudCB9XSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3B0aW9uIHJlbmRlcmluZyBhZnRlciB0aGUgY29tbWFuZCBpZiB0aGUgdmFsdWUgb2Ygc2VsZWN0ZWQgb3JcbiAgICAgKiBlbmFibGVkIGNoYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhYWN0aW9uYWJsZVxuICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICovXG4gICAgcHJvdGVjdGVkIF91cGRhdGVBY3Rpb25hYmxlcygpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBbYWFjdGlvbmFibGUsIGVsZW1lbnRdIG9mIHRoaXMuYWN0aW9uYWJsZU5vZGVzKSB7XG4gICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmVuZ2luZS5lZGl0b3I7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3QgPSBhYWN0aW9uYWJsZS5zZWxlY3RlZChlZGl0b3IpO1xuICAgICAgICAgICAgY29uc3QgZW5hYmxlID0gYWFjdGlvbmFibGUuZW5hYmxlZChlZGl0b3IpO1xuICAgICAgICAgICAgY29uc3QgYXR0clNlbGVjdGVkID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0LnRvU3RyaW5nKCkgIT09IGF0dHJTZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbG9zZXN0KCdzZWxlY3QnKS52YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRvbUVuYWJsZSA9ICFlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIGlmIChlbmFibGUgIT09IGRvbUVuYWJsZSkge1xuICAgICAgICAgICAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEpXRWRpdG9yLCBMb2FkYWJsZXMsIENvbW1pdFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBEb21MYXlvdXRMb2NhdGlvbiwgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi9Eb21MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHtcbiAgICBEb21ab25lUG9zaXRpb24sXG4gICAgQ29tcG9uZW50RGVmaW5pdGlvbixcbiAgICBDb21wb25lbnRJZCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFpvbmVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vWm9uZURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFpvbmVYbWxEb21QYXJzZXIgfSBmcm9tICcuL1pvbmVYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTGF5b3V0Q29udGFpbmVyRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0xheW91dENvbnRhaW5lckRvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFpvbmVJZGVudGlmaWVyLCBab25lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL1pvbmVOb2RlJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgQWN0aW9uYWJsZURvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9BY3Rpb25hYmxlRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgQWN0aW9uYWJsZUdyb3VwRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0FjdGlvbmFibGVHcm91cERvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IEFjdGlvbmFibGVHcm91cFNlbGVjdEl0ZW1Eb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vQWN0aW9uYWJsZUdyb3VwU2VsZWN0SXRlbURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IExhYmVsRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0xhYmVsRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgU2VwYXJhdG9yRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL1NlcGFyYXRvckRvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFJ1bGVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGUnO1xuaW1wb3J0IHsgaXNDb250ZW50RWRpdGFibGUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvbUxheW91dENvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBsb2NhdGlvbj86IFtOb2RlLCBEb21ab25lUG9zaXRpb25dO1xuICAgIGxvY2F0aW9ucz86IFtDb21wb25lbnRJZCwgRG9tTGF5b3V0TG9jYXRpb25dW107XG4gICAgY29tcG9uZW50cz86IENvbXBvbmVudERlZmluaXRpb25bXTtcbiAgICBjb21wb25lbnRab25lcz86IFtDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXJbXV1bXTtcbiAgICBwcmVzc2VkQWN0aW9uYWJsZXNDbGFzc05hbWU/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBEb21MYXlvdXQ8VCBleHRlbmRzIERvbUxheW91dENvbmZpZyA9IERvbUxheW91dENvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtEb21PYmplY3RSZW5kZXJlciwgUGFyc2VyLCBSZW5kZXJlciwgTGF5b3V0LCBLZXltYXBdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgTGF5b3V0PiA9IHtcbiAgICAgICAgcmVuZGVyZXJzOiBbXG4gICAgICAgICAgICBab25lRG9tT2JqZWN0UmVuZGVyZXIsXG4gICAgICAgICAgICBMYXlvdXRDb250YWluZXJEb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIEFjdGlvbmFibGVHcm91cFNlbGVjdEl0ZW1Eb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIEFjdGlvbmFibGVHcm91cERvbU9iamVjdFJlbmRlcmVyLFxuICAgICAgICAgICAgQWN0aW9uYWJsZURvbU9iamVjdFJlbmRlcmVyLFxuICAgICAgICAgICAgTGFiZWxEb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIFNlcGFyYXRvckRvbU9iamVjdFJlbmRlcmVyLFxuICAgICAgICBdLFxuICAgICAgICBwYXJzZXJzOiBbWm9uZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIGxheW91dEVuZ2luZXM6IFtdLFxuICAgICAgICBjb21wb25lbnRzOiBbXSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRlcnMgPSB7XG4gICAgICAgIGRvbUxvY2F0aW9uczogdGhpcy5fbG9hZENvbXBvbmVudExvY2F0aW9ucyxcbiAgICB9O1xuICAgIGNvbW1hbmRIb29rcyA9IHtcbiAgICAgICAgJ0Bjb21taXQnOiB0aGlzLl9yZWRyYXcsXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IsIGNvbmZpZ3VyYXRpb246IFQpIHtcbiAgICAgICAgc3VwZXIoZWRpdG9yLCBjb25maWd1cmF0aW9uKTtcbiAgICAgICAgdGhpcy5sb2FkYWJsZXMubGF5b3V0RW5naW5lcy5wdXNoKERvbUxheW91dEVuZ2luZSk7XG4gICAgICAgIHRoaXMucHJvY2Vzc0tleWRvd24gPSB0aGlzLnByb2Nlc3NLZXlkb3duLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc3RhcnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChMYXlvdXQpO1xuICAgICAgICBjb25zdCBkb21MYXlvdXRFbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbmZpZ3VyYXRpb24uY29tcG9uZW50cyB8fCBbXSkge1xuICAgICAgICAgICAgZG9tTGF5b3V0RW5naW5lLmxvYWRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB6b25lczogUmVjb3JkPENvbXBvbmVudElkLCBab25lSWRlbnRpZmllcltdPiA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IFtpZCwgem9uZV0gb2YgdGhpcy5jb25maWd1cmF0aW9uLmNvbXBvbmVudFpvbmVzIHx8IFtdKSB7XG4gICAgICAgICAgICB6b25lc1tpZF0gPSB6b25lO1xuICAgICAgICB9XG4gICAgICAgIGRvbUxheW91dEVuZ2luZS5sb2FkQ29tcG9uZW50Wm9uZXMoem9uZXMpO1xuICAgICAgICB0aGlzLl9sb2FkQ29tcG9uZW50TG9jYXRpb25zKHRoaXMuY29uZmlndXJhdGlvbi5sb2NhdGlvbnMgfHwgW10pO1xuICAgICAgICBkb21MYXlvdXRFbmdpbmUubG9jYXRpb24gPSB0aGlzLmNvbmZpZ3VyYXRpb24ubG9jYXRpb247XG4gICAgICAgIGF3YWl0IGRvbUxheW91dEVuZ2luZS5zdGFydCgpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMucHJvY2Vzc0tleWRvd24sIHRydWUpO1xuICAgIH1cbiAgICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMucHJvY2Vzc0tleWRvd24sIHRydWUpO1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tO1xuICAgICAgICBhd2FpdCBkb21MYXlvdXRFbmdpbmUuc3RvcCgpO1xuICAgICAgICByZXR1cm4gc3VwZXIuc3RvcCgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBLZXlib2FyZEV2ZW50IGxpc3RlbmVyIHRvIGJlIGFkZGVkIHRvIHRoZSBET00gdGhhdCBjYWxscyBgZXhlY0NvbW1hbmRgIGlmXG4gICAgICogdGhlIGtleXMgcHJlc3NlZCBtYXRjaCBvbmUgb2YgdGhlIHNob3J0Y3V0IHJlZ2lzdGVyZWQgaW4gdGhlIGtleW1hcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqL1xuICAgIGFzeW5jIHByb2Nlc3NLZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogUHJvbWlzZTxDb21tYW5kSWRlbnRpZmllcj4ge1xuICAgICAgICAvLyBJZiB0YXJnZXQgPT0gbnVsbCB3ZSBieXBhc3MgdGhlIGVkaXRhYmxlIHpvbmUgY2hlY2suXG4gICAgICAgIC8vIFRoaXMgc2hvdWxkIG9ubHkgb2NjdXJzIHdoZW4gd2UgcmVjZWl2ZSBhbiBpbmZlcnJlZEtleWRvd25FdmVudFxuICAgICAgICAvLyBjcmVhdGVkIGZyb20gYW4gSW5wdXRFdmVudCBzZW5kIGJ5IGEgbW9iaWxlIGRldmljZS5cbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAmJiAhdGhpcy5pc0luRWRpdGFibGUoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgICAgICAgICAvLyBEb24ndCBwcm9jZXNzIGtleWRvd24gaWYgdGhlIHVzZXIgaXMgb3V0c2lkZSB0aGUgY3VycmVudCBlZGl0b3IgZWRpdGFibGUgWm9uZS5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXltYXAgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoS2V5bWFwKTtcbiAgICAgICAgY29uc3QgY29tbWFuZHMgPSBrZXltYXAubWF0Y2goZXZlbnQpO1xuICAgICAgICBjb25zdCBbY29tbWFuZCwgY29udGV4dF0gPSB0aGlzLmVkaXRvci5jb250ZXh0TWFuYWdlci5tYXRjaChjb21tYW5kcyk7XG5cbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29tbWFuZC5jb21tYW5kSWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHsgY29udGV4dCwgLi4uY29tbWFuZC5jb21tYW5kQXJncyB9O1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmVkaXRvci5leGVjQ29tbWFuZChjb21tYW5kLmNvbW1hbmRJZCwgcGFyYW1zKTtcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kLmNvbW1hbmRJZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSB0YXJnZXQgbm9kZSBpcyBpbnNpZGUgSmFiYmVyd29jaydzIG1haW4gZWRpdGFibGUgWm9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YXJnZXQ6IE5vZGVcbiAgICAgKi9cbiAgICBpc0luRWRpdGFibGUodGFyZ2V0OiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChMYXlvdXQpO1xuICAgICAgICBjb25zdCBkb21MYXlvdXRFbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICB0YXJnZXQgPSB0aGlzLl9nZXREZWVwZXN0VGFyZ2V0KHRhcmdldCk7XG4gICAgICAgIGxldCBub2RlcyA9IGRvbUxheW91dEVuZ2luZS5nZXROb2Rlcyh0YXJnZXQpO1xuICAgICAgICB3aGlsZSAoIW5vZGVzLmxlbmd0aCAmJiB0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlcyA9IGRvbUxheW91dEVuZ2luZS5nZXROb2Rlcyh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlcz8ucG9wKCk7XG4gICAgICAgIC8vIFdlIGNhbm5vdCBhbHdheXMgZXhwZWN0IGEgJ2NvbnRlbnRFZGl0YWJsZScgYXR0cmlidXRlIG9uIHRoZSBtYWluXG4gICAgICAgIC8vIGFuY2VzdG9yLiBTbyB3ZSBleHBlY3QgdG8gZmluZCB0aGUgbWFpbiBlZGl0b3IgWm9uZU5vZGUgaWYgd2UgYXJlIGluXG4gICAgICAgIC8vIHRoZSBlZGl0YWJsZSBwYXJ0IG9mIEphYmJlcndvY2suXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBub2RlICYmXG4gICAgICAgICAgICAoaXNDb250ZW50RWRpdGFibGUobm9kZSkgfHwgdGhpcy5lZGl0b3IubW9kZS5pcyhub2RlLCBSdWxlUHJvcGVydHkuRURJVEFCTEUpKSAmJlxuICAgICAgICAgICAgISFub2RlLmFuY2VzdG9yKG5vZGUgPT4gbm9kZSBpbnN0YW5jZW9mIFpvbmVOb2RlICYmIG5vZGUubWFuYWdlZFpvbmVzLmluY2x1ZGVzKCdtYWluJykpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBwcml2YXRlIF9sb2FkQ29tcG9uZW50TG9jYXRpb25zKGxvY2F0aW9uczogW0NvbXBvbmVudElkLCBEb21MYXlvdXRMb2NhdGlvbl1bXSk6IHZvaWQge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgZm9yIChjb25zdCBbaWQsIGxvY2F0aW9uXSBvZiBsb2NhdGlvbnMpIHtcbiAgICAgICAgICAgIGRvbUxheW91dEVuZ2luZS5sb2NhdGlvbnNbaWRdID0gbG9jYXRpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBkZWVwZXN0IHRhcmdldCwgYmFzZWQgb24gdGhlIGdpdmVuIHRhcmdldCBhbmQgdGhlIGN1cnJlbnRcbiAgICAgKiBzZWxlY3Rpb24uIFRoZSBzZWxlY3Rpb24gY2FuIGJlIHVzZWQgb25seSBpZiBpdCBpcyBpbmRlZWQgY29udGFpbmVkXG4gICAgICogd2l0aGluIHRoZSB0YXJnZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBfZ2V0RGVlcGVzdFRhcmdldCh0YXJnZXQ6IE5vZGUpOiBOb2RlIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gdGFyZ2V0Lm93bmVyRG9jdW1lbnQ/LmdldFNlbGVjdGlvbigpO1xuICAgICAgICBjb25zdCBhbmNob3JOb2RlID0gc2VsZWN0aW9uPy5hbmNob3JOb2RlO1xuICAgICAgICBsZXQgbm9kZSA9IGFuY2hvck5vZGU7XG4gICAgICAgIGxldCBpc0FuY2hvckRlc2NlbmRhbnRPZlRhcmdldCA9IGZhbHNlO1xuICAgICAgICB3aGlsZSAobm9kZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUgPT09IHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGlzQW5jaG9yRGVzY2VuZGFudE9mVGFyZ2V0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzQW5jaG9yRGVzY2VuZGFudE9mVGFyZ2V0ID8gYW5jaG9yTm9kZSA6IHRhcmdldDtcbiAgICB9XG4gICAgcHJpdmF0ZSBhc3luYyBfcmVkcmF3KHBhcmFtczogQ29tbWl0UGFyYW1zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChMYXlvdXQpO1xuICAgICAgICBjb25zdCBkb21MYXlvdXRFbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICBhd2FpdCBkb21MYXlvdXRFbmdpbmUucmVkcmF3KHBhcmFtcy5jaGFuZ2VzTG9jYXRpb25zKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQge1xuICAgIExheW91dEVuZ2luZSxcbiAgICBDb21wb25lbnRJZCxcbiAgICBEb21ab25lUG9zaXRpb24sXG4gICAgQ29tcG9uZW50RGVmaW5pdGlvbixcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgRGlyZWN0aW9uLCBWU2VsZWN0aW9uRGVzY3JpcHRpb24gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WU2VsZWN0aW9uJztcbmltcG9ydCB7IERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1lZGl0YWJsZS9zcmMvRXZlbnROb3JtYWxpemVyJztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBEb21SZWNvbmNpbGlhdGlvbkVuZ2luZSB9IGZyb20gJy4vRG9tUmVjb25jaWxpYXRpb25FbmdpbmUnO1xuaW1wb3J0IHsgTGF5b3V0Q29udGFpbmVyIH0gZnJvbSAnLi9MYXlvdXRDb250YWluZXJOb2RlJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5pbXBvcnQgeyBmbGF0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lQ2FjaGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcbmltcG9ydCB7IENoYW5nZXNMb2NhdGlvbnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvTWVtb3J5JztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcblxuZXhwb3J0IHR5cGUgRG9tUG9pbnQgPSBbTm9kZSwgbnVtYmVyXTtcbmV4cG9ydCB0eXBlIERvbUxheW91dExvY2F0aW9uID0gW05vZGUsIERvbVpvbmVQb3NpdGlvbl07XG5cbmV4cG9ydCBjbGFzcyBEb21MYXlvdXRFbmdpbmUgZXh0ZW5kcyBMYXlvdXRFbmdpbmUge1xuICAgIHN0YXRpYyByZWFkb25seSBpZCA9ICdkb20nO1xuICAgIHJlYWRvbmx5IF9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZSA9IG5ldyBEb21SZWNvbmNpbGlhdGlvbkVuZ2luZSgpO1xuXG4gICAgLy8gdXNlZCBvbmx5IHRvIGRldmVsb3AgYW5kIGF2b2lkIHdyb25nIHByb21pc2UgZnJvbSBjb21tYW5kc1xuICAgIHByaXZhdGUgX2N1cnJlbnRseVJlZHJhd2luZyA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSByZW5kZXJpbmdNYXA6IFJlY29yZDxDb21wb25lbnRJZCwgTm9kZVtdPiA9IHt9O1xuICAgIHByaXZhdGUgX21hcmtlZEZvclJlZHJhdyA9IG5ldyBTZXQ8Tm9kZT4oKTtcbiAgICBsb2NhdGlvbjogW05vZGUsIERvbVpvbmVQb3NpdGlvbl07XG4gICAgbG9jYXRpb25zOiBSZWNvcmQ8Q29tcG9uZW50SWQsIERvbUxheW91dExvY2F0aW9uPiA9IHt9O1xuXG4gICAgcHJpdmF0ZSBfcmVuZGVyZXJDYWNoZTogUmVuZGVyaW5nRW5naW5lQ2FjaGU8RG9tT2JqZWN0PjtcblxuICAgIGRlZmF1bHRSb290Q29tcG9uZW50OiBDb21wb25lbnREZWZpbml0aW9uID0ge1xuICAgICAgICBpZDogJ2VkaXRvcicsXG4gICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IG5ldyBWRWxlbWVudCh7IGh0bWxUYWc6ICdKVy1FRElUT1InIH0pO1xuICAgICAgICAgICAgZWRpdG9yLmFwcGVuZChuZXcgWm9uZU5vZGUoeyBtYW5hZ2VkWm9uZXM6IFsnbWFpbiddIH0pKTtcbiAgICAgICAgICAgIGVkaXRvci5hcHBlbmQobmV3IFpvbmVOb2RlKHsgbWFuYWdlZFpvbmVzOiBbJ2RlZmF1bHQnXSB9KSk7XG4gICAgICAgICAgICByZXR1cm4gW2VkaXRvcl07XG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgZm9yIChjb25zdCBjb21wb25lbnRJZCBpbiB0aGlzLmxvY2F0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJpbmdNYXBbY29tcG9uZW50SWRdID0gW107XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudFpvbmVzW2NvbXBvbmVudElkXSA9IFsncm9vdCddO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudElkXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTGF5b3V0IGNvbXBvbmVudCBcIicgKyBjb21wb25lbnRJZCArICdcIiBub3QgZm91bmQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmbGF0KE9iamVjdC52YWx1ZXModGhpcy5jb21wb25lbnRab25lcykpLmluY2x1ZGVzKCdyb290JykpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnMuZWRpdG9yID0gdGhpcy5kZWZhdWx0Um9vdENvbXBvbmVudDtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Wm9uZXMuZWRpdG9yID0gWydyb290J107XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBjb21wb25lbnRJZCBpbiB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLl9wcmVwYXJlTGF5b3V0Q29udGFpbmVyQW5kTG9jYXRpb24odGhpcy5jb21wb25lbnREZWZpbml0aW9uc1tjb21wb25lbnRJZF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgYXN5bmMgc3RvcCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgZm9yIChjb25zdCBjb21wb25lbnRJZCBpbiB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zKSB7XG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb25zW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tTm9kZXMgPSB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS50b0RvbShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uWzFdID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVuZG8gdGhlIHJlcGxhY2UgdGhhdCB3YXMgZG9uZSBieSB0aGUgbGF5b3V0IGVuZ2luZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaXJzdCA9IGRvbU5vZGVzICYmIGRvbU5vZGVzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaXJzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gdGhpcy5yZW5kZXJpbmdNYXBbY29tcG9uZW50SWRdWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0ICYmIGZpcnN0LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShsb2NhdGlvblswXSwgZmlyc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyaW5nTWFwID0ge307XG4gICAgICAgIHRoaXMuX21hcmtlZEZvclJlZHJhdyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IG51bGw7XG4gICAgICAgIHRoaXMubG9jYXRpb25zID0ge307XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyQ2FjaGUgPSBudWxsO1xuICAgICAgICB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS5jbGVhcigpO1xuICAgICAgICByZXR1cm4gc3VwZXIuc3RvcCgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIFZOb2RlKHMpIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIERPTSBOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIE5vZGVcbiAgICAgKi9cbiAgICBnZXROb2Rlcyhkb21Ob2RlOiBOb2RlKTogVk5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS5mcm9tRG9tKGRvbU5vZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIERPTSBOb2RlKHMpIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBnZXREb21Ob2Rlcyhub2RlOiBWTm9kZSk6IE5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS50b0RvbShub2RlKTtcbiAgICB9XG4gICAgYXN5bmMgcmVkcmF3KHBhcmFtczogQ2hhbmdlc0xvY2F0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5fY3VycmVudGx5UmVkcmF3aW5nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RvdWJsZSByZWRyYXcgZGV0ZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdXJyZW50bHlSZWRyYXdpbmcgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVkcmF3KHBhcmFtcylcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50bHlSZWRyYXdpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRseVJlZHJhd2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlIHRoZSBkb20gc2VsZWN0aW9uIGludG8gdGhlIGRlc2NyaXB0aW9uIG9mIGEgVlNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWxlY3Rpb25cbiAgICAgKiBAcGFyYW0gW2RpcmVjdGlvbl1cbiAgICAgKi9cbiAgICBwYXJzZVNlbGVjdGlvbihzZWxlY3Rpb246IFNlbGVjdGlvbiB8IERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uKTogVlNlbGVjdGlvbkRlc2NyaXB0aW9uIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS5sb2NhdGUoXG4gICAgICAgICAgICBzZWxlY3Rpb24uYW5jaG9yTm9kZSxcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JPZmZzZXQsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGVuZCA9IHRoaXMuX2RvbVJlY29uY2lsaWF0aW9uRW5naW5lLmxvY2F0ZShcbiAgICAgICAgICAgIHNlbGVjdGlvbi5mb2N1c05vZGUsXG4gICAgICAgICAgICBzZWxlY3Rpb24uZm9jdXNPZmZzZXQsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IFtzdGFydFZOb2RlLCBzdGFydFBvc2l0aW9uXSA9IHN0YXJ0O1xuICAgICAgICBjb25zdCBbZW5kVk5vZGUsIGVuZFBvc2l0aW9uXSA9IGVuZDtcblxuICAgICAgICBsZXQgZGlyZWN0aW9uOiBEaXJlY3Rpb247XG4gICAgICAgIGlmIChzZWxlY3Rpb24gaW5zdGFuY2VvZiBTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbVJhbmdlID0gc2VsZWN0aW9uLnJhbmdlQ291bnQgJiYgc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZG9tUmFuZ2Uuc3RhcnRDb250YWluZXIgPT09IHNlbGVjdGlvbi5hbmNob3JOb2RlICYmXG4gICAgICAgICAgICAgICAgZG9tUmFuZ2Uuc3RhcnRPZmZzZXQgPT09IHNlbGVjdGlvbi5hbmNob3JPZmZzZXRcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5GT1JXQVJEO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBEaXJlY3Rpb24uQkFDS1dBUkQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkaXJlY3Rpb24gPSBzZWxlY3Rpb24uZGlyZWN0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFuY2hvck5vZGU6IHN0YXJ0Vk5vZGUsXG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbjogc3RhcnRQb3NpdGlvbixcbiAgICAgICAgICAgIGZvY3VzTm9kZTogZW5kVk5vZGUsXG4gICAgICAgICAgICBmb2N1c1Bvc2l0aW9uOiBlbmRQb3NpdGlvbixcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBtYXJrRm9yUmVkcmF3KGRvbU5vZGVzOiBTZXQ8Tm9kZT4pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRvbU5vZGVzKSB7XG4gICAgICAgICAgICB0aGlzLl9tYXJrZWRGb3JSZWRyYXcuYWRkKGRvbU5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBwcml2YXRlIGFzeW5jIF9yZWRyYXcocGFyYW1zOiBDaGFuZ2VzTG9jYXRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWROb2RlcyA9IFsuLi50aGlzLl9nZXRJbnZhbGlkTm9kZXMocGFyYW1zKV07XG5cbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoUmVuZGVyZXIpO1xuICAgICAgICBjb25zdCBlbmdpbmUgPSBsYXlvdXQuZW5naW5lc1snZG9tL29iamVjdCddIGFzIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICAgICAgY29uc3QgY2FjaGUgPSAodGhpcy5fcmVuZGVyZXJDYWNoZSA9IGF3YWl0IGVuZ2luZS5yZW5kZXIoXG4gICAgICAgICAgICB1cGRhdGVkTm9kZXMsXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlckNhY2hlLFxuICAgICAgICApKTtcblxuICAgICAgICB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS51cGRhdGUoXG4gICAgICAgICAgICB1cGRhdGVkTm9kZXMsXG4gICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdzLFxuICAgICAgICAgICAgY2FjaGUubG9jYXRpb25zLFxuICAgICAgICAgICAgY2FjaGUucmVuZGVyaW5nRGVwZW5kZW50LFxuICAgICAgICAgICAgdGhpcy5fbWFya2VkRm9yUmVkcmF3LFxuICAgICAgICApO1xuICAgICAgICB0aGlzLl9tYXJrZWRGb3JSZWRyYXcgPSBuZXcgU2V0KCk7XG5cbiAgICAgICAgLy8gQXBwZW5kIGluIGRvbSBpZiBuZWVkZWQuXG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5sb2NhdGlvbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgIGNvbnN0IG5lZWRJbnNlcnQgPSBub2Rlcy5maW5kKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbU5vZGVzID0gdGhpcy5fZG9tUmVjb25jaWxpYXRpb25FbmdpbmUudG9Eb20obm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFkb21Ob2Rlcy5sZW5ndGggfHwgZG9tTm9kZXMuc29tZShub2RlID0+ICFub2RlLnBhcmVudE5vZGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAobmVlZEluc2VydCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FwcGVuZENvbXBvbmVudEluRG9tKGNvbXBvbmVudElkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3JlbmRlclNlbGVjdGlvbigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGludmFsaWRhdGVkIG5vZGVzIGluIHRoZSByZW5kZXJpbmcuXG4gICAgICogQ2xlYXIgdGhlIHJlbmRlcmVyIGluIGNhY2hlIGZvciB0aGlzIG5vZGUgb3IgbW9kaWZpZXIuIFRoZSBjYWNoZVxuICAgICAqIHJlbmRlcmVyIGlzIGFkZGVkIG9ubHkgZm9yIHBlcmZvcm1hbmNlIGF0IHJlZHJhd2luZyB0aW1lLiBUaGVcbiAgICAgKiBpbnZhbGlkYXRpb24gYXJlIGF1dG9tYXRpY2FsbHkgbWFkZSBmcm9tIG1lbW9yeSBjaGFuZ2VzLlxuICAgICAqL1xuICAgIHByaXZhdGUgX2dldEludmFsaWROb2RlcyhkaWZmOiBDaGFuZ2VzTG9jYXRpb25zKTogU2V0PFZOb2RlPiB7XG4gICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5fcmVuZGVyZXJDYWNoZTtcbiAgICAgICAgY29uc3QgcmVtb3ZlID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgY29uc3QgdXBkYXRlID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgY29uc3QgdXBkYXRlZE1vZGlmaWVycyA9IG5ldyBTZXQ8TW9kaWZpZXI+KCk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRTaWJsaW5ncyA9IG5ldyBTZXQ8Vk5vZGU+KCk7XG5cbiAgICAgICAgY29uc3QgYWRkID0gbmV3IFNldDxWTm9kZT4oKTtcblxuICAgICAgICAvLyBBZGQgbmV3IG5vZGVzIGZvciByZWRyYXdpbmcgaXQuXG4gICAgICAgIGZvciAoY29uc3Qgb2JqZWN0IG9mIGRpZmYuYWRkKSB7XG4gICAgICAgICAgICBpZiAob2JqZWN0IGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICAgICAgYWRkLmFkZChvYmplY3QgYXMgVk5vZGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChvYmplY3QgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgIHVwZGF0ZWRNb2RpZmllcnMuYWRkKG9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgYWRkKSB7XG4gICAgICAgICAgICBpZiAoIW5vZGUucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgYWRkLmRlbGV0ZShub2RlKTtcbiAgICAgICAgICAgICAgICByZW1vdmUuYWRkKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmNoaWxkVk5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2Ygbm9kZS5kZXNjZW5kYW50cygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlLmFkZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FjaGUpIHtcbiAgICAgICAgICAgIC8vIFNlbGVjdCB0aGUgcmVtb3ZlZCBWTm9kZSBhbmQgTW9kaWZpZXJzLlxuICAgICAgICAgICAgY29uc3QgYWxsUmVtb3ZlID0gbmV3IFNldChkaWZmLnJlbW92ZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG9iamVjdCBvZiBkaWZmLnJlbW92ZSkge1xuICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlLmFkZChvYmplY3QgYXMgVk5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE1vZGlmaWVycy5hZGQob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtwYXJlbnRdIG9mIHRoaXMuZWRpdG9yLm1lbW9yeS5nZXRQYXJlbnRzKG9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUuYWRkKHBhcmVudCBhcyBWTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmVudCBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE1vZGlmaWVycy5hZGQocGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmQgPSB0aGlzLl9maWx0ZXJJblJvb3QoWy4uLnJlbW92ZV0pO1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGZpbHRlcmQucmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlbGV0ZShub2RlKTtcbiAgICAgICAgICAgICAgICByZW1vdmUuYWRkKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmNoaWxkVk5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2Ygbm9kZS5kZXNjZW5kYW50cygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUuYWRkKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBmaWx0ZXJkLmtlZXApIHtcbiAgICAgICAgICAgICAgICB1cGRhdGUuYWRkKG5vZGUpOyAvLyBUT0RPOiBtZW1vcnkgY2hhbmdlIHRvIGhhdmUgcmVhbCBhZGQgYW5kIG5vdCBhZGQgKyBtb3ZlLlxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBuZWVkU2libGluZ3MgPSBuZXcgU2V0PEFic3RyYWN0Tm9kZT4oKTtcblxuICAgICAgICAgICAgLy8gRmlsdGVyIHRvIGtlZXAgb25seSB1cGRhdGUgbm90IGFkZGVkIG9yIHJlbW92ZWQgbm9kZXMuXG4gICAgICAgICAgICBjb25zdCBwYXJhbXNVcGRhdGU6IFtvYmplY3QsIHN0cmluZ1tdIHwgbnVtYmVyW10gfCB2b2lkXVtdID0gW107XG4gICAgICAgICAgICBkaWZmLnVwZGF0ZS5maWx0ZXIodXAgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9iamVjdCA9IHVwWzBdO1xuICAgICAgICAgICAgICAgIGlmICh1cFsxXSAmJiBvYmplY3QgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUgJiYgIW9iamVjdC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlLmFkZChvYmplY3QgYXMgVk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG9iamVjdC5kZXNjZW5kYW50cygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUuYWRkKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXJlbW92ZS5oYXMob2JqZWN0IGFzIFZOb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXNVcGRhdGUucHVzaCh1cCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1heUJlQWxyZWFkeVJlbW92ZWQ6IFZOb2RlW10gPSBbXTtcblxuICAgICAgICAgICAgLy8gU2VsZWN0IHRoZSB1cGRhdGVkIFZOb2RlIGFuZCBNb2RpZmllcnMgYW5kIHRoZSBWTm9kZSBzaWJsaW5ncy5cbiAgICAgICAgICAgIC8vIEZyb20gdGhlIHBhcmVudCwgc2VsZWN0IHRoZSByZW1vdmVkIFZOb2RlIHNpYmxpbmdzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBbb2JqZWN0LCBjaGFuZ2VzXSBvZiBwYXJhbXNVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGFsbFJlbW92ZS5oYXMob2JqZWN0KSB8fFxuICAgICAgICAgICAgICAgICAgICByZW1vdmUuaGFzKG9iamVjdCBhcyBWTm9kZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmhhcyhvYmplY3QgYXMgVk5vZGUpIHx8XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRNb2RpZmllcnMuaGFzKG9iamVjdCBhcyBNb2RpZmllcilcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmFkZChvYmplY3QgYXMgVk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBuZWVkU2libGluZ3MuYWRkKG9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIG1heUJlQWxyZWFkeVJlbW92ZWQucHVzaChvYmplY3QgYXMgVk5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE1vZGlmaWVycy5hZGQob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtwYXJlbnQsIHBhcmVudFByb3BdIG9mIHRoaXMuZWRpdG9yLm1lbW9yeS5nZXRQYXJlbnRzKG9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3ZlLmhhcyhwYXJlbnQgYXMgVk5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBub2RlIHdhcyBhbHJlYWR5IHJlbW92ZWQgaW4gYW4gb3RoZXIgbWVtb3J5IHNsaWNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXBhcmVudC5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW4gb2xkIHJlbW92ZWQgbm9kZSBjYW4gY2hhbmdlLiBGb3IgZWc6IG1vdmUgYSBjaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnRvIHRoZSBhY3RpdmUgVkRvY3VtZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUuYWRkKHBhcmVudCBhcyBWTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgcGFyZW50LmRlc2NlbmRhbnRzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZS5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmRlbGV0ZShjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFByb3BbMF1bMF0gPT09ICdjaGlsZFZOb2RlcycgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGNoYW5nZXNbMF0gPT09ICdudW1iZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGNoYW5nZSBhIGNoaWxkcmVuIChhZGQgb3IgcmVtb3ZlKSByZWRyYXcgdGhlIG5vZGUgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpYmxpbmdzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZFZOb2RlcyA9IHBhcmVudC5jaGlsZFZOb2RlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGNoYW5nZXNbaV0gYXMgbnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZFZOb2Rlc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFkZC5oYXMoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlc1tpIC0gMV0gIT09IGluZGV4IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IGNoaWxkLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91cyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWFkZC5oYXMocHJldmlvdXMpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdXBkYXRlLmhhcyhwcmV2aW91cylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkU2libGluZ3MuYWRkKHByZXZpb3VzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlc1tpICsgMV0gIT09IGluZGV4ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gY2hpbGQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQgJiYgIWFkZC5oYXMobmV4dCkgJiYgIXVwZGF0ZS5oYXMobmV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0KSB1cGRhdGVkU2libGluZ3MuYWRkKG5leHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZHJlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdCA9IGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiAhYWRkLmhhcyhsYXN0KSAmJiAhdXBkYXRlLmhhcyhsYXN0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFNpYmxpbmdzLmFkZChsYXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUuYWRkKHBhcmVudCBhcyBWTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heUJlQWxyZWFkeVJlbW92ZWQucHVzaChwYXJlbnQgYXMgVk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5hZGQocGFyZW50IGFzIFZOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZFNpYmxpbmdzLmFkZChwYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXlCZUFscmVhZHlSZW1vdmVkLnB1c2gocGFyZW50IGFzIFZOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmVudCBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE1vZGlmaWVycy5hZGQocGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuX2ZpbHRlckluUm9vdChtYXlCZUFscmVhZHlSZW1vdmVkKS5yZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGUuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgICAgIHJlbW92ZS5hZGQobm9kZSk7XG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlbGV0ZShub2RlKTtcbiAgICAgICAgICAgICAgICBuZWVkU2libGluZ3MuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiBhbnkgY2hhbmdlIGludmFsaWRhdGUgdGhlIHNpYmxpbmdzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5lZWRTaWJsaW5ncykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQpIHVwZGF0ZWRTaWJsaW5ncy5hZGQobmV4dCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSBub2RlLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91cykgdXBkYXRlZFNpYmxpbmdzLmFkZChwcmV2aW91cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY29tcGF0aWJsZSByZW5kZXJlciBjYWNoZS5cbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB1cGRhdGUpIHtcbiAgICAgICAgICAgICAgICBjYWNoZS5jYWNoZWRDb21wYXRpYmxlUmVuZGVyZXIuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHJlbW92ZSkge1xuICAgICAgICAgICAgICAgIGNhY2hlLmNhY2hlZENvbXBhdGlibGVSZW5kZXJlci5kZWxldGUobm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFkZCByZW1vdmVkIG5vZGVzIG1vZGlmaWVycyBmb3IgaW52YWxpZGF0aW9uLlxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHJlbW92ZSkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLm1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbm9kZSBpcyBjcmVhdGVkIGFmdGVyIHRoaXMgbWVtb3J5IHNsaWNlICh1bmRvKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG5vZGUgaGFzIG5vIHZhbHVlcywgbm8gaWQsIG5vIG1vZGlmaWVycy4uLiBCdXQgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vZGlmaWVycyBpcyBpbnNpZGUgdGhlIGxpc3Qgb2YgcmVtb3ZlZCBvYmplY3RzLlxuICAgICAgICAgICAgICAgICAgICBub2RlLm1vZGlmaWVycy5tYXAobW9kaWZpZXIgPT4gdXBkYXRlZE1vZGlmaWVycy5hZGQobW9kaWZpZXIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY29tcGF0aWJsZSByZW5kZXJlciBjYWNoZSBhbmQgbW9kaWZpZXIgY29tcGFyZSBjYWNoZS5cbiAgICAgICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgdXBkYXRlZE1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIGNhY2hlLmNhY2hlZENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyLmRlbGV0ZShtb2RpZmllcik7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSBjYWNoZS5jYWNoZWRNb2RpZmllcklkLmdldChtb2RpZmllcik7XG4gICAgICAgICAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBjYWNoZS5jYWNoZWRJc1NhbWVBc01vZGlmaWVySWRzW2lkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgY2FjaGUuY2FjaGVkSXNTYW1lQXNNb2RpZmllcltrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNhY2hlLmNhY2hlZElzU2FtZUFzTW9kaWZpZXJJZHNbaWRdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZGQgdGhlIHNpYmxpbmdzIHRvIGludmFsaWRhdGUgdGhlIHNpYmxpbmcgZ3JvdXBzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBzaWJsaW5nIG9mIHVwZGF0ZWRTaWJsaW5ncykge1xuICAgICAgICAgICAgICAgIHVwZGF0ZS5hZGQoc2libGluZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBhbGwgbGlua2VkIGFuZCBkZXBlbmRlbnQgVk5vZGVzIGFuZCBNb2RpZmllcnMgdG8gaW52YWxpZGF0ZSBjYWNoZS5cbiAgICAgICAgICAgIGNvbnN0IHRyZWF0ZWQgPSBuZXcgU2V0PERvbU9iamVjdD4oKTtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzT3JNb2RpZmllcnMgPSBbLi4udXBkYXRlLCAuLi5yZW1vdmUsIC4uLnVwZGF0ZWRNb2RpZmllcnNdO1xuICAgICAgICAgICAgY29uc3QgdHJlYXRlZEl0ZW0gPSBuZXcgU2V0PFZOb2RlIHwgTW9kaWZpZXI+KG5vZGVzT3JNb2RpZmllcnMpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlT3JNb2RpZmllciBvZiBub2Rlc09yTW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua2VkUmVuZGVyaW5ncyA9IGNhY2hlLm5vZGVEZXBlbmRlbnQuZ2V0KG5vZGVPck1vZGlmaWVyKTtcbiAgICAgICAgICAgICAgICBpZiAobGlua2VkUmVuZGVyaW5ncykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmsgb2YgbGlua2VkUmVuZGVyaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0cmVhdGVkLmhhcyhsaW5rKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyZWF0ZWQuYWRkKGxpbmspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb20gPSBjYWNoZS5yZW5kZXJpbmdEZXBlbmRlbnQuZ2V0KGxpbmspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBmcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRyZWF0ZWRJdGVtLmhhcyhuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byBpbnZhbGlkIGRvbU9iamVjdCBvcmlnaW4gbm9kZXMgb3IgbW9kaWZpZXJzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzT3JNb2RpZmllcnMucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmVhdGVkSXRlbS5hZGQobik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua2VkTm9kZXMgPSBjYWNoZS5saW5rZWROb2Rlcy5nZXQobm9kZU9yTW9kaWZpZXIpO1xuICAgICAgICAgICAgICAgIGlmIChsaW5rZWROb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgbGlua2VkTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdHJlYXRlZEl0ZW0uaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRvIGludmFsaWQgbGlua2VkIG5vZGVzIG9mIGxpbmtlcyBub2Rlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc09yTW9kaWZpZXJzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJlYXRlZEl0ZW0uYWRkKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub2RlT3JNb2RpZmllciBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGUuYWRkKG5vZGVPck1vZGlmaWVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkTW9kaWZpZXJzLmFkZChub2RlT3JNb2RpZmllcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBSZW1vdmUgYWxsIHJlbW92ZWQgY2hpbGRyZW4gZnJvbSBub2RlIHRvIHVwZGF0ZS5cbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiByZW1vdmUpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGUuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbnZhbGlkYXRlIFZOb2RlIGNhY2hlIG9yaWdpbiwgbG9jYXRpb24gYW5kIGxpbmtlZC5cbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBbLi4udXBkYXRlLCAuLi5yZW1vdmVdKSB7XG4gICAgICAgICAgICAgICAgY2FjaGUucmVuZGVyaW5nUHJvbWlzZXMuZGVsZXRlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBjYWNoZS5yZW5kZXJpbmdzLmdldChub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtcyA9IFtpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdEZXBlbmRlbnQuZGVsZXRlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGUubG9jYXRpb25zLmRlbGV0ZShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnY2hpbGRyZW4nIGluIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGl0ZW0uY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdzLmRlbGV0ZShub2RlKTtcbiAgICAgICAgICAgICAgICBjYWNoZS5ub2RlRGVwZW5kZW50LmRlbGV0ZShub2RlKTtcbiAgICAgICAgICAgICAgICBjYWNoZS5saW5rZWROb2Rlcy5kZWxldGUobm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEludmFsaWRhdGUgTW9kaWZpZXJzIGNhY2hlIGxpbmtlZC5cbiAgICAgICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgdXBkYXRlZE1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIGNhY2hlLm5vZGVEZXBlbmRlbnQuZGVsZXRlKG1vZGlmaWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgYWRkKSB7XG4gICAgICAgICAgICB1cGRhdGUuYWRkKG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVuZGVyIG5vZGVzLlxuICAgICAgICByZXR1cm4gdXBkYXRlO1xuICAgIH1cbiAgICBwcml2YXRlIF9maWx0ZXJJblJvb3Qobm9kZXM6IFZOb2RlW10pOiB7IGtlZXA6IFNldDxWTm9kZT47IHJlbW92ZTogU2V0PFZOb2RlPiB9IHtcbiAgICAgICAgY29uc3QgaW5Sb290ID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgY29uc3Qgbm90Um9vdCA9IG5ldyBTZXQ8Vk5vZGU+KCk7XG4gICAgICAgIGNvbnN0IG5vZGVzSW5Sb290ID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgY29uc3Qgbm9kZXNJbk5vdFJvb3QgPSBuZXcgU2V0PFZOb2RlPigpO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgICAgIGxldCBhbmNlc3RvciA9IG5vZGU7XG4gICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgJiYgIW5vdFJvb3QuaGFzKGFuY2VzdG9yKSkge1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvciA9PT0gdGhpcy5yb290IHx8IGluUm9vdC5oYXMoYW5jZXN0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBWTm9kZSBpcyBpbiB0aGUgZG9tTGF5b3V0LlxuICAgICAgICAgICAgICAgICAgICBub2Rlc0luUm9vdC5hZGQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFyZW50IG9mIHBhcmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluUm9vdC5hZGQocGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGFyZW50cy5wdXNoKGFuY2VzdG9yKTtcbiAgICAgICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgICAgICAgICBpZiAoIWFuY2VzdG9yIHx8ICFhbmNlc3Rvci5pZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBIFZOb2RlIHdpdGhvdXQgYW4gaWQgZG9lcyBub3QgZXhpc3QgeWV0L2FueW1vcmUgaW4gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgbWVtb3J5IHNsaWNlLlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgVk5vZGUgaXMgbm90IGluIHRoZSBkb21MYXlvdXQuXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzSW5Ob3RSb290LmFkZChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJlbnQgb2YgcGFyZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90Um9vdC5hZGQocGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBrZWVwOiBub2Rlc0luUm9vdCwgcmVtb3ZlOiBub2Rlc0luTm90Um9vdCB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIGdpdmVuIFZTZWxlY3Rpb24gYXMgYSBET00gc2VsZWN0aW9uIGluIHRoZSBnaXZlbiB0YXJnZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VsZWN0aW9uXG4gICAgICogQHBhcmFtIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgX3JlbmRlclNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uO1xuICAgICAgICBjb25zdCBkb21Ob2RlcyA9IHRoaXMuX2RvbVJlY29uY2lsaWF0aW9uRW5naW5lLnRvRG9tKHNlbGVjdGlvbi5hbmNob3IucGFyZW50KTtcbiAgICAgICAgaWYgKCFkb21Ob2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3IuYW5jZXN0b3JzKCkucG9wKCkgIT09IHRoaXMucm9vdCB8fFxuICAgICAgICAgICAgc2VsZWN0aW9uLmZvY3VzLmFuY2VzdG9ycygpLnBvcCgpICE9PSB0aGlzLnJvb3RcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCByZW5kZXIgYSBzZWxlY3Rpb24gdGhhdCBpcyBvdXRzaWRlIHRoZSBMYXlvdXQuJyk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbmNob3IgPSB0aGlzLl9kb21SZWNvbmNpbGlhdGlvbkVuZ2luZS5nZXRMb2NhdGlvbnMoc2VsZWN0aW9uLmFuY2hvcik7XG4gICAgICAgIGNvbnN0IGZvY3VzID0gdGhpcy5fZG9tUmVjb25jaWxpYXRpb25FbmdpbmUuZ2V0TG9jYXRpb25zKHNlbGVjdGlvbi5mb2N1cyk7XG5cbiAgICAgICAgY29uc3QgZG9jID0gYW5jaG9yWzBdLm93bmVyRG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGRvbVNlbGVjdGlvbiA9IGRvYy5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uYW5jaG9yTm9kZSA9PT0gYW5jaG9yWzBdICYmXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uYW5jaG9yT2Zmc2V0ID09PSBhbmNob3JbMV0gJiZcbiAgICAgICAgICAgIGRvbVNlbGVjdGlvbi5mb2N1c05vZGUgPT09IGZvY3VzWzBdICYmXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uZm9jdXNPZmZzZXQgPT09IGZvY3VzWzFdXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZG9tUmFuZ2UgPSBkb2MuY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgaWYgKHNlbGVjdGlvbi5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEKSB7XG4gICAgICAgICAgICBkb21SYW5nZS5zZXRTdGFydChhbmNob3JbMF0sIGFuY2hvclsxXSk7XG4gICAgICAgICAgICBkb21SYW5nZS5jb2xsYXBzZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbVJhbmdlLnNldEVuZChhbmNob3JbMF0sIGFuY2hvclsxXSk7XG4gICAgICAgICAgICBkb21SYW5nZS5jb2xsYXBzZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZG9tU2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICBkb21TZWxlY3Rpb24uYWRkUmFuZ2UoZG9tUmFuZ2UpO1xuICAgICAgICBkb21TZWxlY3Rpb24uZXh0ZW5kKGZvY3VzWzBdLCBmb2N1c1sxXSk7XG4gICAgfVxuICAgIHByaXZhdGUgX2FwcGVuZENvbXBvbmVudEluRG9tKGlkOiBDb21wb25lbnRJZCk6IHZvaWQge1xuICAgICAgICBsZXQgW3RhcmdldCwgcG9zaXRpb25dID0gdGhpcy5sb2NhdGlvbnNbaWRdO1xuICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMucmVuZGVyaW5nTWFwW2lkXTtcbiAgICAgICAgY29uc3QgZmlyc3QgPSBub2Rlcy5maW5kKG5vZGUgPT4gbm9kZS5wYXJlbnROb2RlICYmIG5vZGUub3duZXJEb2N1bWVudC5ib2R5LmNvbnRhaW5zKG5vZGUpKTtcblxuICAgICAgICBpZiAoZmlyc3Q/LnByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgdGFyZ2V0ID0gZmlyc3QucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgcG9zaXRpb24gPSAnYWZ0ZXInO1xuICAgICAgICB9IGVsc2UgaWYgKGZpcnN0Py5wYXJlbnROb2RlPy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSBmaXJzdC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgcG9zaXRpb24gPSAncHJlcGVuZCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcHJldmlvdXMgPSBpZDtcbiAgICAgICAgICAgIHdoaWxlICgocHJldmlvdXMgPSB0aGlzLl9nZXRQcmV2aW91c0NvbXBvbmVudElkKHByZXZpb3VzKSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0ID0gdGhpcy5yZW5kZXJpbmdNYXBbcHJldmlvdXNdW3RoaXMucmVuZGVyaW5nTWFwW3ByZXZpb3VzXS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiBsYXN0Lm93bmVyRG9jdW1lbnQuYm9keS5jb250YWlucyhsYXN0KSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBsYXN0O1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9ICdhZnRlcic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYWZ0ZXInICYmICF0YXJnZXQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHJlbmRlciBhIGNvbXBvbmVudCBhZnRlciBhbiBlbGVtZW50IHdpdGggbm8gcGFyZW50LicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ3JlcGxhY2UnICYmICF0YXJnZXQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHJlcGxhY2UgYW4gZWxlbWVudCB3aXRob3V0IGFueSBwYXJlbnQuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkb21Ob2RlczogTm9kZVtdID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzLmNvbXBvbmVudHNbaWRdKSB7XG4gICAgICAgICAgICBkb21Ob2Rlcy5wdXNoKC4uLnRoaXMuX2RvbVJlY29uY2lsaWF0aW9uRW5naW5lLnRvRG9tKG5vZGUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRvbU5vZGVzLmxlbmd0aCAmJiB0aGlzLmxvY2F0aW9uc1tpZF1bMV0gPT09ICdyZXBsYWNlJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHJlcGxhY2UgYSBlbGVtZW50IHdpdGggYW4gZW1wdHkgdGVtcGxhdGUuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zaXRpb24gPT09ICdhZnRlcicpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRvbU5vZGUsIHRhcmdldC5uZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAncHJlcGVuZCcpIHtcbiAgICAgICAgICAgIGxldCBpdGVtOiBOb2RlID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKGRvbU5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9tTm9kZSAhPT0gaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKGRvbU5vZGUsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBkb21Ob2RlLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3JlcGxhY2UnKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9tTm9kZSwgdGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRhcmdldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5yZW5kZXJpbmdNYXBbaWRdKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5wYXJlbnROb2RlICYmICFkb21Ob2Rlcy5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVuZGVyaW5nTWFwW2lkXSA9IGRvbU5vZGVzO1xuICAgIH1cbiAgICBwcml2YXRlIF9nZXRQcmV2aW91c0NvbXBvbmVudElkKGlkOiBDb21wb25lbnRJZCk6IENvbXBvbmVudElkIHtcbiAgICAgICAgY29uc3QgW3RhcmdldCwgcG9zaXRpb25dID0gdGhpcy5sb2NhdGlvbnNbaWRdO1xuICAgICAgICBjb25zdCBsb2NhdGlvbnMgPSBPYmplY3QudmFsdWVzKHRoaXMubG9jYXRpb25zKTtcbiAgICAgICAgY29uc3QgY29tcG9uZW50SWRzID0gT2JqZWN0LmtleXModGhpcy5sb2NhdGlvbnMpO1xuICAgICAgICBjb25zdCBpbmRleCA9IGNvbXBvbmVudElkcy5pbmRleE9mKGlkKTtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYWZ0ZXInKSB7XG4gICAgICAgICAgICBmb3IgKGxldCB1ID0gaW5kZXggLSAxOyB1ID49IDA7IHUtLSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtvdGhlclRhcmdldCwgb3RoZXJQb3NpdGlvbl0gPSBsb2NhdGlvbnNbdV07XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPT09IG90aGVyVGFyZ2V0ICYmXG4gICAgICAgICAgICAgICAgICAgIChvdGhlclBvc2l0aW9uID09PSAnYWZ0ZXInIHx8IG90aGVyUG9zaXRpb24gPT09ICdyZXBsYWNlJylcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudElkc1t1XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCB1ID0gbG9jYXRpb25zLmxlbmd0aCAtIDE7IHUgPiBpbmRleDsgdS0tKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgW290aGVyVGFyZ2V0LCBvdGhlclBvc2l0aW9uXSA9IGxvY2F0aW9uc1t1XTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ID09PSBvdGhlclRhcmdldCAmJiBvdGhlclBvc2l0aW9uID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudElkc1t1XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdyZXBsYWNlJykge1xuICAgICAgICAgICAgZm9yIChsZXQgdSA9IGluZGV4IC0gMTsgdSA+PSAwOyB1LS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbb3RoZXJUYXJnZXQsIG90aGVyUG9zaXRpb25dID0gbG9jYXRpb25zW3VdO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IG90aGVyVGFyZ2V0ICYmIG90aGVyUG9zaXRpb24gPT09ICdyZXBsYWNlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50SWRzW3VdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIF9wcmVwYXJlTGF5b3V0Q29udGFpbmVyQW5kTG9jYXRpb24oY29tcG9uZW50RGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCB6b25lID0gdGhpcy5jb21wb25lbnRab25lc1tjb21wb25lbnREZWZpbml0aW9uLmlkXTtcbiAgICAgICAgaWYgKHpvbmU/LmluY2x1ZGVzKCdyb290JykpIHtcbiAgICAgICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgd3JhcCB0aGUgY2hpbGQgaW50byBhIGxheW91dENvbnRhaW5lciB0byBrZWVwIGxvY2F0aW9uIG9mIGFsbCBub2Rlc1xuICAgICAgICAgICAgLy8gd2hlbiB1cGRhdGUgdGhlIHRlbXBsYXRlIGFuZCByZWRyYXdcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnNbY29tcG9uZW50RGVmaW5pdGlvbi5pZF0gPSB7XG4gICAgICAgICAgICAgICAgaWQ6IGNvbXBvbmVudERlZmluaXRpb24uaWQsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKGVkaXRvcjogSldFZGl0b3IpOiBQcm9taXNlPExheW91dENvbnRhaW5lcltdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgY29tcG9uZW50RGVmaW5pdGlvbi5yZW5kZXIoZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF5b3V0Q29udGFpbmVyID0gbmV3IExheW91dENvbnRhaW5lcigpO1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXRDb250YWluZXIuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtsYXlvdXRDb250YWluZXJdO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9jYXRpb25zW2NvbXBvbmVudERlZmluaXRpb24uaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb25zW2NvbXBvbmVudERlZmluaXRpb24uaWRdID0gdGhpcy5sb2NhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJpbmdNYXBbY29tcG9uZW50RGVmaW5pdGlvbi5pZF0gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSwgUG9pbnQsIFJlbGF0aXZlUG9zaXRpb24gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUsIG5vZGVMZW5ndGgsIEZsYXR0ZW5VbmlvbiwgZmxhdCB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBEb21Qb2ludCB9IGZyb20gJy4vRG9tTGF5b3V0RW5naW5lJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdEF0dHJpYnV0ZXMsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTW9kaWZpZXIgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcic7XG5pbXBvcnQgeyBpc1RleHROb2RlIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL0RvbSc7XG5pbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrTm9kZSc7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEludGVybmFsIG9iamVjdHNcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxudHlwZSBHZW5lcmljRG9tT2JqZWN0ID0gUGFydGlhbDxGbGF0dGVuVW5pb248RG9tT2JqZWN0Pj47XG50eXBlIERvbU9iamVjdElEID0gbnVtYmVyO1xudHlwZSBEb21PYmplY3RNYXBwaW5nID0ge1xuICAgIGlkOiBEb21PYmplY3RJRDtcbiAgICBvYmplY3Q6IEdlbmVyaWNEb21PYmplY3Q7XG4gICAgcGFyZW50PzogRG9tT2JqZWN0SUQ7XG4gICAgY2hpbGRyZW46IERvbU9iamVjdElEW107XG4gICAgcGFyZW50RG9tTm9kZT86IEVsZW1lbnQgfCBTaGFkb3dSb290O1xuICAgIGRvbTogTm9kZVtdO1xuICAgIGRvbU5vZGVzOiBOb2RlW107XG4gICAgZG9tTm9kZXNDaGlsZHJlbj86IFtOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uLCBEb21PYmplY3RJRFtdXVtdO1xufTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gSW50ZXJuYWwgZGlmZlxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG50eXBlIERpZmZEb21PYmplY3QgPSB7XG4gICAgaWQ6IERvbU9iamVjdElEO1xuICAgIHJlbW92ZWRDaGlsZHJlbjogRG9tT2JqZWN0SURbXTtcbiAgICBhdHRyaWJ1dGVzOiBEb21PYmplY3RBdHRyaWJ1dGVzO1xuICAgIHN0eWxlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudWxsPjtcbiAgICBjbGFzc0xpc3Q6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+O1xuICAgIHBhcmVudERvbU5vZGU6IEVsZW1lbnQgfCBTaGFkb3dSb290O1xuICAgIGRvbTogTm9kZVtdO1xuICAgIGFza0NvbXBsZXRlUmVkcmF3aW5nPzogYm9vbGVhbjtcbn07XG5cbmxldCBkaWZmT2JqZWN0SWQgPSAwO1xuXG4vKipcbiAqIFNldCB0aGUgc3R5bGUgb2YgYW4gZWxlbWVudCBrZWVwaW5nIHRoZSBcIiFpbXBvcnRhbnRcIiBjc3MgbW9kaWZpZXIgaW4gdGhlIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHNldFN0eWxlKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodmFsdWUuaW5jbHVkZXMoJyFpbXBvcnRhbnQnKSkge1xuICAgICAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIHZhbHVlLnJlcGxhY2UoJyFpbXBvcnRhbnQnLCAnJyksICdpbXBvcnRhbnQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEb21SZWNvbmNpbGlhdGlvbkVuZ2luZSB7XG4gICAgcHJpdmF0ZSBfb2JqZWN0czogUmVjb3JkPERvbU9iamVjdElELCBEb21PYmplY3RNYXBwaW5nPiA9IHt9O1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX29iamVjdElkcyA9IG5ldyBNYXA8R2VuZXJpY0RvbU9iamVjdCwgRG9tT2JqZWN0SUQ+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBfZnJvbUl0ZW0gPSBuZXcgTWFwPFZOb2RlIHwgTW9kaWZpZXIsIERvbU9iamVjdElEPigpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2Zyb21Eb20gPSBuZXcgTWFwPE5vZGUsIERvbU9iamVjdElEPigpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3JlbmRlcmVkTm9kZXMgPSBuZXcgTWFwPFZOb2RlIHwgTW9kaWZpZXIsIFNldDxEb21PYmplY3RJRD4+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBfcmVuZGVyZWRJZHMgPSBuZXcgU2V0PERvbU9iamVjdElEPigpO1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBfbG9jYXRpb25zID0gbmV3IE1hcDxHZW5lcmljRG9tT2JqZWN0LCBWTm9kZVtdPigpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2l0ZW1zID0gbmV3IE1hcDxHZW5lcmljRG9tT2JqZWN0LCBBcnJheTxWTm9kZSB8IE1vZGlmaWVyPj4oKTtcblxuICAgIC8vIFRoZSBkaWZmIGlzIGZpbGxlZCBpbiB1cGRhdGUgd2hlbiB3ZSBjb21wYXJlIHRoZSBuZXcgZG9tT2JqZWN0IHdpdGggdGhlXG4gICAgLy8gb2xkIG9uZSwgYW5kIHRoZSBkaWZmIGFyZSBjb25zdW1lZCB3aGVuIHdlIHJlZHJhdyB0aGUgbm9kZS5cbiAgICBwcml2YXRlIHJlYWRvbmx5IF9kaWZmOiBSZWNvcmQ8RG9tT2JqZWN0SUQsIERpZmZEb21PYmplY3Q+ID0ge307XG4gICAgcHJpdmF0ZSByZWFkb25seSBfcmVuZGVyZXJUcmVhdGVkID0gbmV3IFNldDxHZW5lcmljRG9tT2JqZWN0PigpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3JlbGVhc2VkSXRlbXMgPSBuZXcgU2V0PFZOb2RlIHwgTW9kaWZpZXI+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBfZG9tVXBkYXRlZCA9IG5ldyBTZXQ8RG9tT2JqZWN0SUQ+KCk7XG5cbiAgICB1cGRhdGUoXG4gICAgICAgIHVwZGF0ZWROb2RlczogVk5vZGVbXSxcbiAgICAgICAgcmVuZGVyaW5nczogTWFwPFZOb2RlLCBEb21PYmplY3Q+LFxuICAgICAgICBsb2NhdGlvbnM6IE1hcDxEb21PYmplY3QsIFZOb2RlW10+LFxuICAgICAgICBmcm9tOiBNYXA8RG9tT2JqZWN0LCBTZXQ8Vk5vZGUgfCBNb2RpZmllcj4+LFxuICAgICAgICBkb21Ob2Rlc1RvUmVkcmF3ID0gbmV3IFNldDxOb2RlPigpLFxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCByZW5kZXJlZFNldCA9IG5ldyBTZXQ8RG9tT2JqZWN0PigpO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdXBkYXRlZE5vZGVzKSB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJpbmcgPSByZW5kZXJpbmdzLmdldChub2RlKTtcbiAgICAgICAgICAgIGlmIChyZW5kZXJpbmcpIHtcbiAgICAgICAgICAgICAgICByZW5kZXJlZFNldC5hZGQocmVuZGVyaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZW5kZXJlZCA9IFsuLi5yZW5kZXJlZFNldF07XG5cbiAgICAgICAgLy8gRm91bmQgdGhlIHBvdGVudGlhbCBvbGQgdmFsdWVzICh0aGV5IGNvdWxkIGJlY29tZSBjaGlsZHJlbiBvZiB0aGUgY3VycmVudCBub2RlKS5cbiAgICAgICAgLy8gSW4gb2xkIHZhbHVlcyB0aGUgcmVuZGVyZXIgYXJlIG1heSBiZSBtZXJnZSBzb21lIG9iamVjdCwgd2Ugd2FudCB0byBmb3VuZCB0aGVcbiAgICAgICAgLy8gY2hpbGRyZW4gb2JqZWN0IGluIG9sZCB2YWx1ZSB0byBjYW1wYXJlIGl0IHdpdGggdGhlIG5ld2VzdC5cbiAgICAgICAgY29uc3QgbWFwT2xkSWRzID0gbmV3IE1hcDxHZW5lcmljRG9tT2JqZWN0LCBTZXQ8RG9tT2JqZWN0SUQ+PigpO1xuICAgICAgICBjb25zdCBkb21PYmplY3RzOiBHZW5lcmljRG9tT2JqZWN0W10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBkb21PYmplY3Qgb2YgcmVuZGVyZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZW5kZXJlclRyZWF0ZWQuaGFzKGRvbU9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvbU9iamVjdHMucHVzaChkb21PYmplY3QpO1xuICAgICAgICAgICAgbGV0IG9sZE9iamVjdHMgPSBtYXBPbGRJZHMuZ2V0KGRvbU9iamVjdCk7XG4gICAgICAgICAgICBpZiAoIW9sZE9iamVjdHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRMb2NhdGlvbnMoZG9tT2JqZWN0LCBsb2NhdGlvbnMsIGZyb20pO1xuICAgICAgICAgICAgICAgIG9sZE9iamVjdHMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgbWFwT2xkSWRzLnNldChkb21PYmplY3QsIG9sZE9iamVjdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLl9pdGVtcy5nZXQoZG9tT2JqZWN0KTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGlua2VkTm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkcyA9IHRoaXMuX3JlbmRlcmVkTm9kZXMuZ2V0KGxpbmtlZE5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChpZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBpZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2xkT2JqZWN0cy5oYXMoaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF0ub2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyVHJlYXRlZC5kZWxldGUob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vYmplY3RJZHMuZGVsZXRlKG9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZWRJZHMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRPYmplY3RzLmFkZChpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlclRyZWF0ZWQuZGVsZXRlKGRvbU9iamVjdCk7XG4gICAgICAgICAgICB0aGlzLl9vYmplY3RJZHMuZGVsZXRlKGRvbU9iamVjdCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNYWtlIGRpZmYuXG4gICAgICAgIGZvciAoY29uc3QgZG9tT2JqZWN0IG9mIGRvbU9iamVjdHMpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fb2JqZWN0SWRzLmhhcyhkb21PYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLl9pdGVtcy5nZXQoZG9tT2JqZWN0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gaXRlbXMuZmluZChub2RlID0+IG5vZGUgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIGFzIFZOb2RlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZFJlZklkID0gdGhpcy5fZnJvbUl0ZW0uZ2V0KG5vZGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZElkcyA9IG1hcE9sZElkcy5nZXQoZG9tT2JqZWN0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9IHRoaXMuX2RpZmZPYmplY3QocmVuZGVyaW5ncywgZG9tT2JqZWN0LCBpdGVtcywgbWFwT2xkSWRzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlZElkcy5hZGQoaWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudE9iamVjdCA9IHRoaXMuX29iamVjdHNbdGhpcy5fb2JqZWN0c1tpZF0ucGFyZW50XT8ub2JqZWN0O1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgb2xkUmVmSWQgIT09IGlkIHx8XG4gICAgICAgICAgICAgICAgICAgICFwYXJlbnRPYmplY3QgfHxcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMuX3JlbmRlcmVyVHJlYXRlZC5oYXMocGFyZW50T2JqZWN0KSB8fFxuICAgICAgICAgICAgICAgICAgICBvbGRJZHMuc2l6ZSA+IDFcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlbmRlcmluZyBjaGFuZ2UsIHdlIG11c3QgY2hlY2sgaWYgd2UgcmVkcmF3IHRoZSBwYXJlbnQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yV2l0aFJlbmRlcmluZyA9IG5vZGUuYW5jZXN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvciA9PiAhIXRoaXMuX2Zyb21JdGVtLmdldChhbmNlc3RvciksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdXBkYXRlZE5vZGVzLmluY2x1ZGVzKGFuY2VzdG9yV2l0aFJlbmRlcmluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yT2JqZWN0SWQgPSB0aGlzLl9mcm9tSXRlbS5nZXQoYW5jZXN0b3JXaXRoUmVuZGVyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmNlc3Rvck9iamVjdElkICYmICF0aGlzLl9kaWZmW2FuY2VzdG9yT2JqZWN0SWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50T2JqZWN0ID0gdGhpcy5fb2JqZWN0c1thbmNlc3Rvck9iamVjdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuX2l0ZW1zLmdldChwYXJlbnRPYmplY3Qub2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBPbGRJZHMuc2V0KHBhcmVudE9iamVjdC5vYmplY3QsIG5ldyBTZXQoW2FuY2VzdG9yT2JqZWN0SWRdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXJUcmVhdGVkLmRlbGV0ZShwYXJlbnRPYmplY3Qub2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kaWZmT2JqZWN0KHJlbmRlcmluZ3MsIHBhcmVudE9iamVjdC5vYmplY3QsIG5vZGVzLCBtYXBPbGRJZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGlmZnMgPSBPYmplY3QudmFsdWVzKHRoaXMuX2RpZmYpO1xuXG4gICAgICAgIC8vIFByZXBhcmUgcGF0aCBmb3IgZnJhZ21lbnQgaW5zZXJ0aW9uIGluIHRoZSBkb20uXG4gICAgICAgIGNvbnN0IG9iamVjdHNQYXRoOiBSZWNvcmQ8RG9tT2JqZWN0SUQsIFtFbGVtZW50LCBudW1iZXJdW10+ID0ge307XG4gICAgICAgIGZvciAoY29uc3QgZGlmZiBvZiBkaWZmcykge1xuICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tkaWZmLmlkXTtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gZGlmZi5kb20ubGVuZ3RoID8gZGlmZi5kb20gOiB0aGlzLl9nZXRjaGlsZHJlbkRvbU5vZGVzKGRpZmYuaWQpO1xuICAgICAgICAgICAgY29uc3QgcGF0aDogW0VsZW1lbnQsIG51bWJlcl1bXSA9IFtdO1xuICAgICAgICAgICAgbGV0IHBhcmVudCA9IHRoaXMuX29iamVjdHNbb2JqZWN0LnBhcmVudF07XG4gICAgICAgICAgICB3aGlsZSAocGFyZW50ICYmICFwYXJlbnQub2JqZWN0LnRhZykge1xuICAgICAgICAgICAgICAgIHBhcmVudCA9IHRoaXMuX29iamVjdHNbcGFyZW50LnBhcmVudF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXBhcmVudCkge1xuICAgICAgICAgICAgICAgIGxldCBkb21Ob2RlID0gbm9kZXNbMF07XG4gICAgICAgICAgICAgICAgd2hpbGUgKGRvbU5vZGUgJiYgZG9tTm9kZS5wYXJlbnRFbGVtZW50ICYmIGRvbU5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUucGFyZW50RWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFtdLmluZGV4T2YuY2FsbChkb21Ob2RlLnBhcmVudEVsZW1lbnQuY2hpbGROb2RlcywgZG9tTm9kZSksXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9iamVjdHNQYXRoW2RpZmYuaWRdID0gcGF0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlbGVjdCByZW1vdmVkIG9iamVjdHMuXG4gICAgICAgIGNvbnN0IHJlbW92ZU9iamVjdHM6IERvbU9iamVjdElEW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBkaWZmIG9mIGRpZmZzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGRpZmYucmVtb3ZlZENoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICAgICAgaWYgKCFvYmplY3QucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZU9iamVjdHMucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgcmVtb3ZlT2JqZWN0cykge1xuICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICBpZiAoIW9iamVjdC5wYXJlbnQgJiYgcmVtb3ZlT2JqZWN0cy5pbmNsdWRlcyhpZCkpIHtcbiAgICAgICAgICAgICAgICBvYmplY3QucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkSWQgb2Ygb2JqZWN0LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5fb2JqZWN0c1tjaGlsZElkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgKCFjaGlsZC5wYXJlbnQgfHwgY2hpbGQucGFyZW50ID09PSBpZCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICFyZW1vdmVPYmplY3RzLmluY2x1ZGVzKGNoaWxkSWQpXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlT2JqZWN0cy5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIHJlZmVyZW5jaWVzIHRvIHJlbW92ZWQgb2JqZWN0cy5cbiAgICAgICAgY29uc3QgYWxsT2xkRG9tTm9kZXM6IE5vZGVbXSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIHJlbW92ZU9iamVjdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IG9sZCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvbGQub2JqZWN0LmRldGFjaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG9sZC5vYmplY3QuZGV0YWNoKC4uLm9sZC5kb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuX2xvY2F0aW9ucy5nZXQob2xkLm9iamVjdCkgfHwgW10pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZnJvbUl0ZW0uZ2V0KG5vZGUpID09PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mcm9tSXRlbS5kZWxldGUobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuX2l0ZW1zLmdldChvbGQub2JqZWN0KSB8fCBbXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkcyA9IHRoaXMuX3JlbmRlcmVkTm9kZXMuZ2V0KG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChpZHMgJiYgaWRzLmhhcyhpZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZWROb2Rlcy5kZWxldGUobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9sZC5kb20pIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2Ygb2xkLmRvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZnJvbURvbS5nZXQoZG9tTm9kZSkgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9mcm9tRG9tLmRlbGV0ZShkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21Ob2RlIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbE9sZERvbU5vZGVzLnB1c2goZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fZGlmZltpZF07XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlZElkcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgdGhpcy5faXRlbXMuZGVsZXRlKG9sZC5vYmplY3QpO1xuICAgICAgICAgICAgdGhpcy5fbG9jYXRpb25zLmRlbGV0ZShvbGQub2JqZWN0KTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyVHJlYXRlZC5kZWxldGUob2xkLm9iamVjdCk7XG4gICAgICAgICAgICBjb25zdCBpID0gZGlmZnMuZmluZEluZGV4KGRpZmYgPT4gZGlmZi5pZCA9PT0gaWQpO1xuICAgICAgICAgICAgaWYgKGkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZGlmZnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVW52YWxpZGF0ZSBvYmplY3QgbGlua2VkIHRvIGRvbU5vZGVzVG9SZWRyYXc7XG4gICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlc1RvUmVkcmF3KSB7XG4gICAgICAgICAgICBjb25zdCBpZCA9IHRoaXMuX2Zyb21Eb20uZ2V0KGRvbU5vZGUpO1xuICAgICAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RpZmZbaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RpZmZbaWRdLmFza0NvbXBsZXRlUmVkcmF3aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX29iamVjdHNbaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkb21PYmplY3QgPSBvYmplY3Qub2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRvbU9iamVjdC5kZXRhY2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU9iamVjdC5kZXRhY2goLi4ub2JqZWN0LmRvbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGlmZltpZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTGlzdDoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBkb206IG9iamVjdC5kb20sXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnREb21Ob2RlOiBvYmplY3QucGFyZW50RG9tTm9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRDaGlsZHJlbjogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc2tDb21wbGV0ZVJlZHJhd2luZzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgZGlmZnMucHVzaCh0aGlzLl9kaWZmW2lkXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWxsT2xkRG9tTm9kZXMucHVzaChkb21Ob2RlKTtcbiAgICAgICAgICAgIGFsbE9sZERvbU5vZGVzLnB1c2goLi4uZG9tTm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlbGVjdCBhbGwgZG9tIG5vZGVzLlxuICAgICAgICBmb3IgKGNvbnN0IGRpZmYgb2YgZGlmZnMpIHtcbiAgICAgICAgICAgIGFsbE9sZERvbU5vZGVzLnB1c2goLi4uZGlmZi5kb20pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU29ydCB0aGUgZGlmZiBieSBhbmNlc3RvcnMuXG4gICAgICAgIGRpZmZzLnNvcnQoKGRhLCBkYikgPT4ge1xuICAgICAgICAgICAgbGV0IGFMZW4gPSAwO1xuICAgICAgICAgICAgbGV0IGEgPSB0aGlzLl9vYmplY3RzW2RhLmlkXTtcbiAgICAgICAgICAgIHdoaWxlIChhPy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBhTGVuKys7XG4gICAgICAgICAgICAgICAgYSA9IHRoaXMuX29iamVjdHNbYS5wYXJlbnRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGJMZW4gPSAwO1xuICAgICAgICAgICAgbGV0IGIgPSB0aGlzLl9vYmplY3RzW2RiLmlkXTtcbiAgICAgICAgICAgIHdoaWxlIChiPy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBiTGVuKys7XG4gICAgICAgICAgICAgICAgYiA9IHRoaXMuX29iamVjdHNbYi5wYXJlbnRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFMZW4gLSBiTGVuO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZWRyYXcgYWxsIG9iamVjdHMuXG4gICAgICAgIGNvbnN0IG9iamVjdFRvSW5zZXJ0OiBEb21PYmplY3RJRFtdID0gW107XG4gICAgICAgIGZvciAoY29uc3QgZGlmZiBvZiBkaWZmcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3VwZGF0ZURvbShkaWZmLmlkKSkge1xuICAgICAgICAgICAgICAgIG9iamVjdFRvSW5zZXJ0LnB1c2goZGlmZi5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbnNlcnQgb2JqZWN0IGRvbSBub2RlcyB3aGljaCBkb24ndCBoYXZlIGRpcmVjdCBvYmplY3Qgd2l0aCBub2RlTmFtZVxuICAgICAgICAvLyBhbmQgbm90IGFkZGVkIGJ5IHRoZSB1cGRhdGVEb20gYmVjYXVzZSBoaXMgcGFyZW50IGhhdmUgbm8gZGlmZi5cbiAgICAgICAgZm9yIChjb25zdCBpZCBvZiBvYmplY3RUb0luc2VydCkge1xuICAgICAgICAgICAgY29uc3QgcGF0aCA9IG9iamVjdHNQYXRoW2lkXSB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLl9vYmplY3RzW2lkXTtcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLl9vYmplY3RzW2l0ZW0ucGFyZW50XSB8fCBpdGVtO1xuICAgICAgICAgICAgd2hpbGUgKCFwYXJlbnQub2JqZWN0LnRhZyAmJiBwYXJlbnQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gdGhpcy5fb2JqZWN0c1twYXJlbnQucGFyZW50XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhcmVudERvbU5vZGUgPSBwYXJlbnQuZG9tWzBdIGFzIEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlczogTm9kZVtdID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkSWQgb2YgcGFyZW50LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZXMucHVzaCguLi50aGlzLl9nZXREb21DaGlsZChjaGlsZElkLCBwYXJlbnREb21Ob2RlKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChkb21Ob2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50ICE9PSBpdGVtICYmIHBhcmVudC5vYmplY3QudGFnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydERvbUNoaWxkcmVuKGRvbU5vZGVzLCBwYXJlbnREb21Ob2RlLCBwYXJlbnREb21Ob2RlLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnREb21Ob2RlOiBFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBsZXQgZmlyc3REb21Ob2RlOiBOb2RlO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIXBhcmVudERvbU5vZGUgJiYgcGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhJdGVtID0gcGF0aC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBdmFpbGFibGVQYXJlbnQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhJdGVtWzBdLm93bmVyRG9jdW1lbnQuY29udGFpbnMocGF0aEl0ZW1bMF0pICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWRvbU5vZGVzLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUgPT4gcGF0aEl0ZW1bMF0gPT09IGRvbU5vZGUgfHwgZG9tTm9kZS5jb250YWlucyhwYXRoSXRlbVswXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0F2YWlsYWJsZVBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudERvbU5vZGUgPSBwYXRoSXRlbVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdERvbU5vZGUgPSBwYXJlbnREb21Ob2RlLmNoaWxkTm9kZXNbcGF0aEl0ZW1bMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnREb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnNlcnREb21DaGlsZHJlbihkb21Ob2RlcywgcGFyZW50RG9tTm9kZSwgZmlyc3REb21Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsZWFuL3JlbW92ZSB1bnVzZWQgZG9tIG5vZGVzLlxuICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgYWxsT2xkRG9tTm9kZXMpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZnJvbURvbS5nZXQoZG9tTm9kZSkgJiYgZG9tTm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRvbU5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsbCBhdHRhY2ggbWV0aG9kcyBmb3IgdGhlIGNoYW5nZWQgZG9tTm9kZXMuXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgdGhpcy5fZG9tVXBkYXRlZCkge1xuICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICBpZiAodHlwZW9mIG9iamVjdD8ub2JqZWN0LmF0dGFjaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG9iamVjdC5vYmplY3QuYXR0YWNoKC4uLm9iamVjdC5kb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2RvbVVwZGF0ZWQuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fcmVsZWFzZWRJdGVtcy5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgVk5vZGVzIGxpbmtlZCBpbiByZW5kZXJuZyB0byB0aGUgZ2l2ZW4gVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGdldFJlbmRlcmVkV2l0aChub2RlOiBWTm9kZSB8IE1vZGlmaWVyKTogQXJyYXk8Vk5vZGUgfCBNb2RpZmllcj4ge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuX2Zyb21JdGVtLmdldChub2RlKTtcbiAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBjb25zdCBvYmplY3QgPSB0aGlzLl9vYmplY3RzW2lkXTtcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9ucyA9IHRoaXMuX2xvY2F0aW9ucy5nZXQob2JqZWN0Lm9iamVjdCk7XG4gICAgICAgICAgICByZXR1cm4gWy4uLihsb2NhdGlvbnMubGVuZ3RoID8gbG9jYXRpb25zIDogdGhpcy5faXRlbXMuZ2V0KG9iamVjdC5vYmplY3QpKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgVk5vZGUocykgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gRE9NIE5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9tTm9kZVxuICAgICAqL1xuICAgIGZyb21Eb20oZG9tTm9kZTogTm9kZSk6IFZOb2RlW10ge1xuICAgICAgICBsZXQgb2JqZWN0OiBEb21PYmplY3RNYXBwaW5nO1xuICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IFtdO1xuICAgICAgICB3aGlsZSAoIW9iamVjdCAmJiBkb21Ob2RlKSB7XG4gICAgICAgICAgICBvYmplY3QgPSB0aGlzLl9vYmplY3RzW3RoaXMuX2Zyb21Eb20uZ2V0KGRvbU5vZGUpXTtcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9ucyA9IG9iamVjdCAmJiB0aGlzLl9sb2NhdGlvbnMuZ2V0KG9iamVjdC5vYmplY3QpO1xuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBvYmplY3QgJiYgKGxvY2F0aW9ucy5sZW5ndGggPyBsb2NhdGlvbnMgOiB0aGlzLl9pdGVtcy5nZXQob2JqZWN0Lm9iamVjdCkpO1xuICAgICAgICAgICAgaWYgKGl0ZW1zPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChkb21Ob2RlLnByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5wcmV2aW91c1NpYmxpbmc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgRE9NIE5vZGUgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIHRvRG9tKG5vZGU6IFZOb2RlIHwgTW9kaWZpZXIpOiBOb2RlW10ge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuX2Zyb21JdGVtLmdldChub2RlKTtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgIGlmICghb2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH0gZWxzZSBpZiAob2JqZWN0LmRvbS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBbLi4ub2JqZWN0LmRvbV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Y2hpbGRyZW5Eb21Ob2RlcyhpZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBwb3NpdGlvbiBpbiB0aGUgVk5vZGVzIGFzIGEgdHVwbGUgY29udGFpbmluZyBhIHJlZmVyZW5jZVxuICAgICAqIG5vZGUgYW5kIGEgcmVsYXRpdmUgcG9zaXRpb24gd2l0aCByZXNwZWN0IHRvIHRoaXMgbm9kZSAoJ0JFRk9SRScgb3JcbiAgICAgKiAnQUZURVInKS4gVGhlIHBvc2l0aW9uIGlzIGFsd2F5cyBnaXZlbiBvbiB0aGUgbGVhZi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb250YWluZXJcbiAgICAgKiBAcGFyYW0gb2Zmc2V0XG4gICAgICovXG4gICAgbG9jYXRlKGRvbU5vZGU6IE5vZGUsIGRvbU9mZnNldDogbnVtYmVyKTogUG9pbnQge1xuICAgICAgICBsZXQgZm9yY2VBZnRlciA9IGZhbHNlO1xuICAgICAgICBsZXQgZm9yY2VQcmVwZW5kID0gZmFsc2U7XG4gICAgICAgIGxldCBjb250YWluZXIgPSBkb21Ob2RlO1xuICAgICAgICBsZXQgb2Zmc2V0ID0gZG9tT2Zmc2V0O1xuXG4gICAgICAgIC8vIFdoZW4gdGFyZ2V0dGluZyB0aGUgZW5kIG9mIGEgbm9kZSwgdGhlIERPTSBnaXZlcyBhbiBvZmZzZXQgdGhhdCBpc1xuICAgICAgICAvLyBlcXVhbCB0byB0aGUgbGVuZ3RoIG9mIHRoZSBjb250YWluZXIuIEluIG9yZGVyIHRvIHJldHJpZXZlIHRoZSBsYXN0XG4gICAgICAgIC8vIGRlc2NlbmRlbnQsIHdlIG5lZWQgdG8gbWFrZSBzdXJlIHdlIHRhcmdldCBhbiBleGlzdGluZyBub2RlLCBpZS4gYW5cbiAgICAgICAgLy8gZXhpc3RpbmcgaW5kZXguXG4gICAgICAgIGlmICghaXNUZXh0Tm9kZShkb21Ob2RlKSAmJiBvZmZzZXQgPj0gbm9kZUxlbmd0aChjb250YWluZXIpKSB7XG4gICAgICAgICAgICBmb3JjZUFmdGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIG9mZnNldCA9IGNvbnRhaW5lci5jaGlsZE5vZGVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB3aGlsZSAoY29udGFpbmVyLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gY29udGFpbmVyLmNoaWxkTm9kZXNbb2Zmc2V0XTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBjb250YWluZXIuY2hpbGROb2Rlcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2UgYXJlIHRhcmdldHRpbmcgdGhlIGRlZXBlc3QgZGVzY2VuZGFudC5cbiAgICAgICAgd2hpbGUgKGNvbnRhaW5lci5jaGlsZE5vZGVzW29mZnNldF0pIHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBub2RlTmFtZShjb250YWluZXIuY2hpbGROb2Rlc1tvZmZzZXRdKSA9PT0gJ0JSJyAmJlxuICAgICAgICAgICAgICAgICFjb250YWluZXIuY2hpbGROb2Rlc1tvZmZzZXRdLm5leHRTaWJsaW5nXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAvLyBUYXJnZXQgdGhlIGxhc3QgYnIgaW4gYSBjb250YWluZXIuXG4gICAgICAgICAgICAgICAgZm9yY2VBZnRlciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZm9yY2VBZnRlcikge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5jaGlsZE5vZGVzW25vZGVMZW5ndGgoY29udGFpbmVyKSAtIDFdO1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IG5vZGVMZW5ndGgoY29udGFpbmVyKSAtIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5jaGlsZE5vZGVzW29mZnNldF07XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlYXJjaCB0byBkb21PYmplY3QgY29yZXNwb25kaW5nIHRvIHRoZSBkb20gZWxlbWVudC5cbiAgICAgICAgbGV0IG9iamVjdDogRG9tT2JqZWN0TWFwcGluZztcbiAgICAgICAgd2hpbGUgKCFvYmplY3QpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5fZnJvbURvbS5nZXQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgICAgIG9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgICAgIGlmICghb2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRG9tIGxvY2F0aW9uIGFsdGVyZWQuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb250YWluZXIucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgZm9yY2VBZnRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gY29udGFpbmVyLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBub2RlTGVuZ3RoKGNvbnRhaW5lcikgLSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JjZVByZXBlbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IFtdLmluZGV4T2YuY2FsbChjb250YWluZXIucGFyZW50Tm9kZS5jaGlsZE5vZGVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgd2hpbGUgKG9iamVjdC5jaGlsZHJlbltvZmZzZXRdKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZElkID0gb2JqZWN0LmNoaWxkcmVuW29mZnNldF07XG4gICAgICAgICAgICBvYmplY3QgPSB0aGlzLl9vYmplY3RzW2NoaWxkSWRdO1xuICAgICAgICAgICAgaWYgKGZvcmNlQWZ0ZXIgJiYgdGhpcy5fbG9jYXRpb25zLmdldChvYmplY3Qub2JqZWN0KS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLl9sb2NhdGlvbnMuZ2V0KG9iamVjdC5vYmplY3QpLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3IgZG9tT2JqZWN0VGV4dCwgYWRkIHRoZSBwcmV2aW91cyB0ZXh0IGxlbmd0aCBhcyBvZmZzZXQuXG4gICAgICAgIGlmIChvYmplY3Qub2JqZWN0LnRleHQgJiYgaXNUZXh0Tm9kZShkb21Ob2RlKSkge1xuICAgICAgICAgICAgY29uc3QgdGV4dHMgPSBvYmplY3QuZG9tIGFzIFRleHRbXTtcbiAgICAgICAgICAgIGxldCBpbmRleCA9IHRleHRzLmluZGV4T2YoZG9tTm9kZSk7XG4gICAgICAgICAgICB3aGlsZSAoaW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gdGV4dHNbaW5kZXhdLnRleHRDb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBvYmplY3RDaGlsZCA9IG9iamVjdDtcbiAgICAgICAgd2hpbGUgKCF0aGlzLl9sb2NhdGlvbnMuZ2V0KG9iamVjdC5vYmplY3QpLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5fb2JqZWN0c1tvYmplY3QucGFyZW50XTtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyZW50LmNoaWxkcmVuLmluZGV4T2Yob2JqZWN0LmlkKTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICBvYmplY3QgPSB0aGlzLl9vYmplY3RzW3BhcmVudC5jaGlsZHJlbltpbmRleCAtIDFdXTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvYmplY3QuY2hpbGRyZW4ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbnMgPSB0aGlzLl9sb2NhdGlvbnMuZ2V0KG9iamVjdC5vYmplY3QpO1xuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbG9jYXRpb25zW2xvY2F0aW9ucy5sZW5ndGggLSAxXSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwYXJlbnQuY2hpbGRyZW4uaW5kZXhPZihvYmplY3RDaGlsZC5pZCk7XG4gICAgICAgICAgICAgICAgb2JqZWN0ID0gcGFyZW50O1xuICAgICAgICAgICAgICAgIG9iamVjdENoaWxkID0gb2JqZWN0O1xuICAgICAgICAgICAgICAgIGZvcmNlUHJlcGVuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb25zID0gdGhpcy5fbG9jYXRpb25zLmdldChwYXJlbnQub2JqZWN0KTtcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb25zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ID4gcGFyZW50LmNoaWxkcmVuLmxlbmd0aCAvIDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQWZ0ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbG9jYXRpb25zID0gdGhpcy5fbG9jYXRpb25zLmdldChvYmplY3Qub2JqZWN0KTtcbiAgICAgICAgaWYgKCFsb2NhdGlvbnNbb2Zmc2V0XSkge1xuICAgICAgICAgICAgcmV0dXJuIFtsb2NhdGlvbnNbbG9jYXRpb25zLmxlbmd0aCAtIDFdLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSXTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JjZVByZXBlbmQgJiYgbG9jYXRpb25zW29mZnNldF0gaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gW2xvY2F0aW9uc1tvZmZzZXRdLCBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERV07XG4gICAgICAgIH0gZWxzZSBpZiAoZm9yY2VBZnRlcikge1xuICAgICAgICAgICAgcmV0dXJuIFtsb2NhdGlvbnNbb2Zmc2V0XSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW2xvY2F0aW9uc1tvZmZzZXRdLCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRV07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciB0aGUgbWFwIG9mIGFsbCBjb3JyZXNwb25kYW5jZXMuXG4gICAgICpcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBvYmplY3RNYXAgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLl9vYmplY3RzKSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmplY3RNYXAub2JqZWN0LmRldGFjaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG9iamVjdE1hcC5vYmplY3QuZGV0YWNoKC4uLm9iamVjdE1hcC5kb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgZnJvbURvbSBvZiB0aGlzLl9mcm9tRG9tKSB7XG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlID0gZnJvbURvbVswXTtcbiAgICAgICAgICAgIGlmIChkb21Ob2RlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb2JqZWN0cyA9IHt9O1xuICAgICAgICB0aGlzLl9mcm9tSXRlbS5jbGVhcigpO1xuICAgICAgICB0aGlzLl9mcm9tRG9tLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVkTm9kZXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJZHMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fb2JqZWN0SWRzLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX2xvY2F0aW9ucy5jbGVhcigpO1xuICAgICAgICB0aGlzLl9pdGVtcy5jbGVhcigpO1xuICAgICAgICB0aGlzLl9yZW5kZXJlclRyZWF0ZWQuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fZG9tVXBkYXRlZC5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbG9jYXRpb24gaW4gdGhlIERPTSBjb3JyZXNwb25kaW5nIHRvIHRoZSBsb2NhdGlvbiBpbiB0aGVcbiAgICAgKiBWRG9jdW1lbnQgb2YgdGhlIGdpdmVuIFZOb2RlLiBUaGUgbG9jYXRpb24gaW4gdGhlIERPTSBpcyBleHByZXNzZWQgYXMgYVxuICAgICAqIHR1cGxlIGNvbnRhaW5pbmcgYSByZWZlcmVuY2UgTm9kZSBhbmQgYSByZWxhdGl2ZSBwb3NpdGlvbiB3aXRoIHJlc3BlY3QgdG9cbiAgICAgKiB0aGUgcmVmZXJlbmNlIE5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGdldExvY2F0aW9ucyhub2RlOiBWTm9kZSk6IERvbVBvaW50IHtcbiAgICAgICAgbGV0IHJlZmVyZW5jZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIGxldCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgIGlmICghcmVmZXJlbmNlIHx8IHJlZmVyZW5jZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICAgICAgaWYgKHJlZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5maXJzdExlYWYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlZmVyZW5jZSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gbm9kZS5wYXJlbnQ7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uSU5TSURFO1xuICAgICAgICAgICAgaWYgKCFyZWZlcmVuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgb2JqZWN0OiBEb21PYmplY3RNYXBwaW5nO1xuICAgICAgICBsZXQgbG9jYXRpb25zOiBWTm9kZVtdO1xuXG4gICAgICAgIC8vIHVzZSB0aGUgbG9jYXRpb25cbiAgICAgICAgbGV0IGRvbU5vZGVzOiBOb2RlW107XG4gICAgICAgIGxldCBpc1RleHQgPSB0cnVlO1xuICAgICAgICBjb25zdCBhbHJlYWR5Q2hlY2sgPSBuZXcgU2V0PFZOb2RlPigpO1xuICAgICAgICB3aGlsZSAoIWRvbU5vZGVzICYmIHJlZmVyZW5jZSkge1xuICAgICAgICAgICAgYWxyZWFkeUNoZWNrLmFkZChyZWZlcmVuY2UpO1xuICAgICAgICAgICAgY29uc3QgaWRzID0gdGhpcy5fcmVuZGVyZWROb2Rlcy5nZXQocmVmZXJlbmNlKTtcbiAgICAgICAgICAgIGlmIChpZHMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpZCBvZiBpZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9ucyA9IHRoaXMuX2xvY2F0aW9ucy5nZXQob2JqZWN0Lm9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbG9jYXRpb25zLmluY2x1ZGVzKHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoYXNMb2NhdGU6IG51bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkcyA9IFtpZF07XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaWRzLmxlbmd0aCAmJiAoIWhhc0xvY2F0ZSB8fCBwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpZCA9IGlkcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9sb2NhdGlvbnMuZ2V0KGNoaWxkLm9iamVjdCkuaW5jbHVkZXMocmVmZXJlbmNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNMb2NhdGUgPSBpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkcy5wdXNoKC4uLlsuLi5jaGlsZC5jaGlsZHJlbl0ucmV2ZXJzZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGhhc0xvY2F0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25zID0gdGhpcy5fbG9jYXRpb25zLmdldChvYmplY3Qub2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0LmRvbS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZG9tTm9kZXMpIGRvbU5vZGVzID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGVzLnB1c2goLi4ub2JqZWN0LmRvbSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvbU5vZGVzKSBkb21Ob2RlcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2Rlcy5wdXNoKC4uLnRoaXMuX2dldGNoaWxkcmVuRG9tTm9kZXMoaWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tTm9kZXMubGVuZ3RoICYmIChvYmplY3Qub2JqZWN0LnRhZyB8fCBvYmplY3Qub2JqZWN0LmRvbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzVGV4dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkb21Ob2Rlcz8ubGVuZ3RoIHx8ICFkb21Ob2Rlc1swXS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IHJlZmVyZW5jZS5uZXh0TGVhZigpO1xuICAgICAgICAgICAgICAgIGlmIChuZXh0ICYmICFhbHJlYWR5Q2hlY2suaGFzKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IG5leHQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERTtcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZG9tTm9kZXMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGRvbU5vZGU6IE5vZGU7XG4gICAgICAgIGxldCBvZmZzZXQgPVxuICAgICAgICAgICAgcG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQUZURVJcbiAgICAgICAgICAgICAgICA/IGxvY2F0aW9ucy5sYXN0SW5kZXhPZihyZWZlcmVuY2UpXG4gICAgICAgICAgICAgICAgOiBsb2NhdGlvbnMuaW5kZXhPZihyZWZlcmVuY2UpO1xuXG4gICAgICAgIGlmIChpc1RleHQpIHtcbiAgICAgICAgICAgIGxldCBpbmRleCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAob2Zmc2V0ID49IGRvbU5vZGVzW2luZGV4XS50ZXh0Q29udGVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgLT0gZG9tTm9kZXNbaW5kZXhdLnRleHRDb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUikge1xuICAgICAgICAgICAgICAgIC8vIEluY3JlbWVudCB0aGUgb2Zmc2V0IHRvIGJlIHBvc2l0aW9uZWQgYWZ0ZXIgdGhlIHJlZmVyZW5jZSBub2RlLlxuICAgICAgICAgICAgICAgIG9mZnNldCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERSkge1xuICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGVzW29mZnNldF07XG4gICAgICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGVzW2RvbU5vZGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZXNbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9tTm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBkb21Ob2RlLnRleHRDb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hhciBub2RlcyBoYXZlIHRoZWlyIG9mZnNldCBpbiB0aGUgY29ycmVzcG9uZGluZyB0ZXh0IG5vZGVzXG4gICAgICAgICAgICAgICAgLy8gcmVnaXN0ZXJlZCBpbiB0aGUgbWFwIHZpYSBgc2V0YCBidXQgdm9pZCBub2RlcyBkb24ndC4gVGhlaXJcbiAgICAgICAgICAgICAgICAvLyBsb2NhdGlvbiBuZWVkIHRvIGJlIGNvbXB1dGVkIHdpdGggcmVzcGVjdCB0byB0aGVpciBwYXJlbnRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvbU5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGNvbnRhaW5lci5jaGlsZE5vZGVzLCBkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gY29udGFpbmVyO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEluY3JlbWVudCB0aGUgb2Zmc2V0IHRvIGJlIHBvc2l0aW9uZWQgYWZ0ZXIgdGhlIHJlZmVyZW5jZSBub2RlLlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW2RvbU5vZGUsIG9mZnNldF07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICAgIHByaXZhdGUgX2RpZmZPYmplY3QoXG4gICAgICAgIG5vZGVUb0RvbU9iamVjdDogTWFwPFZOb2RlIHwgTW9kaWZpZXIsIEdlbmVyaWNEb21PYmplY3Q+LFxuICAgICAgICBkb21PYmplY3Q6IEdlbmVyaWNEb21PYmplY3QsXG4gICAgICAgIGZyb21Ob2RlczogQXJyYXk8Vk5vZGUgfCBNb2RpZmllcj4sXG4gICAgICAgIG1hcE9sZElkcz86IE1hcDxHZW5lcmljRG9tT2JqZWN0LCBTZXQ8RG9tT2JqZWN0SUQ+PixcbiAgICAgICAgY2hpbGRyZW5NYXBwaW5nPzogTWFwPEdlbmVyaWNEb21PYmplY3QsIERvbU9iamVjdElEPixcbiAgICApOiBEb21PYmplY3RJRCB7XG4gICAgICAgIGxldCBvbGRJZHMgPSBtYXBPbGRJZHMuZ2V0KGRvbU9iamVjdCk7XG5cbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLl9pdGVtcy5nZXQoZG9tT2JqZWN0KTtcbiAgICAgICAgaWYgKCFvbGRJZHMpIHtcbiAgICAgICAgICAgIG9sZElkcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpZHMgPSB0aGlzLl9yZW5kZXJlZE5vZGVzLmdldChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBpZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2RpZmZbaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZElkcy5hZGQoaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoYXNDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIGlmIChvbGRJZHMuc2l6ZSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpZCBvZiBbLi4ub2xkSWRzXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgICAgIGlmICghb2xkIHx8IHRoaXMuX3JlbmRlcmVyVHJlYXRlZC5oYXMob2xkLm9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgb2xkSWRzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjaGlsZHJlbk1hcHBpbmcpIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbk1hcHBpbmcgPSB0aGlzLl9kaWZmT2JqZWN0QXNzb2NpYXRlQ2hpbGRyZW5NYXAoZG9tT2JqZWN0LCBvbGRJZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IG9sZElkcy5zaXplICE9PSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGlkID0gY2hpbGRyZW5NYXBwaW5nPy5nZXQoZG9tT2JqZWN0KTtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIG9sZElkcy5hZGQoaWQpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBvbGQgPSB0aGlzLl9vYmplY3RzW2lkXTtcblxuICAgICAgICBpZiAob2xkICYmICF0aGlzLl9yZW5kZXJlclRyZWF0ZWQuaGFzKG9sZC5vYmplY3QpKSB7XG4gICAgICAgICAgICBjaGlsZHJlbk1hcHBpbmcuZGVsZXRlKGRvbU9iamVjdCk7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlclRyZWF0ZWQuYWRkKG9sZC5vYmplY3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2xkID0gbnVsbDtcbiAgICAgICAgICAgIGhhc0NoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgZGlmZk9iamVjdElkKys7XG4gICAgICAgICAgICBpZCA9IGRpZmZPYmplY3RJZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyVHJlYXRlZC5hZGQoZG9tT2JqZWN0KTtcbiAgICAgICAgdGhpcy5fb2JqZWN0SWRzLnNldChkb21PYmplY3QsIGlkKTtcblxuICAgICAgICBjb25zdCByZW1vdmVkQ2hpbGRyZW46IERvbU9iamVjdElEW10gPSBbXTtcbiAgICAgICAgY29uc3QgZGlmZkF0dHJpYnV0ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bGw+ID0ge307XG4gICAgICAgIGNvbnN0IGRpZmZTdHlsZTogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVsbD4gPSB7fTtcbiAgICAgICAgY29uc3QgZGlmZkNsYXNzTGlzdDogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB7fTtcblxuICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IHRoaXMuX2xvY2F0aW9ucy5nZXQoZG9tT2JqZWN0KSB8fCBbXTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlczogRG9tT2JqZWN0QXR0cmlidXRlcyA9IHt9O1xuICAgICAgICBjb25zdCBjaGlsZHJlbjogRG9tT2JqZWN0SURbXSA9IFtdO1xuICAgICAgICBsZXQgZG9tTm9kZXM6IE5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgYWxsRG9tTm9kZXM6IE5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgZG9tTm9kZXNDaGlsZHJlbjogW05vZGUsIFJlbGF0aXZlUG9zaXRpb24sIERvbU9iamVjdElEW11dW107XG4gICAgICAgIGxldCBkb21Ob2Rlc0NoaWxkcmVuUHJvY2VzczogW05vZGUsIFJlbGF0aXZlUG9zaXRpb24sIFZOb2RlW11dW107XG5cbiAgICAgICAgY29uc3Qgb2xkQ2hpbGRyZW4gPSBvbGQ/LmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICBjb25zdCBuZXdDaGlsZHJlbiA9IGRvbU9iamVjdC5jaGlsZHJlbiB8fCBbXTtcblxuICAgICAgICBpZiAoZG9tT2JqZWN0LmRvbSkge1xuICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBkb21Ob2RlcyA9IGRvbU9iamVjdC5kb207XG4gICAgICAgICAgICBkb21Ob2Rlc0NoaWxkcmVuUHJvY2VzcyA9IFtdO1xuXG4gICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnM6IFJlY29yZDxzdHJpbmcsIEVsZW1lbnQ+ID0ge307XG4gICAgICAgICAgICBsZXQgaGF2ZVBsYWNlaG9sZGVyID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgIGlmIChkb21Ob2RlIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWUoZG9tTm9kZSkgPT09ICdKVy1ET01PQkpFQ1QtVk5PREUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXZlUGxhY2Vob2xkZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJzW2RvbU5vZGUuaWRdID0gZG9tTm9kZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBkb21Ob2RlLnNoYWRvd1Jvb3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGRvbU5vZGUuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yQWxsKCdqdy1kb21vYmplY3Qtdm5vZGUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogZG9tTm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdqdy1kb21vYmplY3Qtdm5vZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tIG9mIGNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZlUGxhY2Vob2xkZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyc1tkb20uaWRdID0gZG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaGF2ZVBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJWTm9kZXM6IFtFbGVtZW50LCBWTm9kZV1bXSA9IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbE5vZGVzID0gZnJvbU5vZGVzLmZpbHRlcihpdGVtID0+IGl0ZW0gaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIGFzIFZOb2RlW107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGFsbE5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsbE5vZGVzLnB1c2goLi4ubm9kZS5jaGlsZFZOb2Rlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBhbGxOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyc1tub2RlLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlclZOb2Rlcy5wdXNoKFtwbGFjZWhvbGRlciwgbm9kZV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyVk5vZGVzLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtwbGFjZWhvbGRlciwgbm9kZV0gb2YgcGxhY2Vob2xkZXJWTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoaWxkOiBbTm9kZSwgUmVsYXRpdmVQb3NpdGlvbiwgVk5vZGVbXV07XG4gICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGRvbU5vZGVzLmluZGV4T2YocGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IGRvbU5vZGVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFZzogW1BMQUNFSE9MREVSLCBQTEFDRUhPTERFUiwgPGRpdj48L2Rpdj5dXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBbZG9tTm9kZXNbaW5kZXggKyAxXSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIFtub2RlXV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVnOiBbPGRpdj48L2Rpdj4sIFBMQUNFSE9MREVSLCBQTEFDRUhPTERFUl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIWNoaWxkICYmIGluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleC0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWUoZG9tTm9kZXNbaW5kZXhdKSAhPT0gJ0pXLURPTU9CSkVDVC1WTk9ERScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gW2RvbU5vZGVzW2luZGV4XSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUiwgW25vZGVdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGVzLnNwbGljZShkb21Ob2Rlcy5pbmRleE9mKHBsYWNlaG9sZGVyKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2Vob2xkZXIubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVnOiBbPGRpdj5QTEFDRUhPTERFUjxpPjwvaT48L2Rpdj5dXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IFtwbGFjZWhvbGRlci5uZXh0U2libGluZywgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIFtub2RlXV07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2Vob2xkZXIucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWc6IFs8ZGl2PjxpPjwvaT5QTEFDRUhPTERFUjwvZGl2Pl1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gW3BsYWNlaG9sZGVyLnBhcmVudE5vZGUsIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFLCBbbm9kZV1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IGRvbU5vZGVzQ2hpbGRyZW5Qcm9jZXNzLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9PiBuZXh0WzBdID09PSBjaGlsZFswXSAmJiBuZXh0WzFdID09PSBjaGlsZFsxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRbMl0udW5zaGlmdChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tTm9kZXNDaGlsZHJlblByb2Nlc3MucHVzaChjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4ucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9tTm9kZXNDaGlsZHJlblByb2Nlc3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEV2ZXJ5IGRvbU5vZGVzIGFyZSBwbGFjZWhvbGRlci4gSXQncyBsaWtlIGNoaWxkcmVuIG9ubHkuXG4gICAgICAgICAgICAgICAgICAgIGRvbU5vZGVzQ2hpbGRyZW5Qcm9jZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFkZCBhbGwgbm9kZXMgYXMgbWFwcGluZyB0byBhdm9pZCBhc3NvY2lhdGlvbiBieSBjaGlsZHJlbi5cbiAgICAgICAgICAgIGFsbERvbU5vZGVzID0gW107XG4gICAgICAgICAgICBjb25zdCBhbGxOb2RlczogTm9kZVtdID0gWy4uLmRvbU5vZGVzXTtcbiAgICAgICAgICAgIHdoaWxlIChhbGxOb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkb21Ob2RlID0gYWxsTm9kZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgYWxsRG9tTm9kZXMucHVzaChkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoZG9tTm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxsTm9kZXMucHVzaCguLi5kb21Ob2RlLmNoaWxkTm9kZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbmV3Q2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGxldCBjaGlsZElkOiBEb21PYmplY3RJRDtcbiAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IG5vZGVUb0RvbU9iamVjdC5nZXQoY2hpbGQpO1xuICAgICAgICAgICAgICAgIGxldCBvbGRDaGlsZElkID0gdGhpcy5fb2JqZWN0SWRzLmdldChkb21PYmplY3QpIHx8IHRoaXMuX2Zyb21JdGVtLmdldChjaGlsZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFvbGRDaGlsZElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9sZENoaWxkSWRzID0gdGhpcy5fcmVuZGVyZWROb2Rlcy5nZXQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2xkQ2hpbGRJZHM/LnNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZENoaWxkSWQgPSBbLi4ub2xkQ2hpbGRJZHNdWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5faXRlbXMuZ2V0KGRvbU9iamVjdCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JlbmRlcmVyVHJlYXRlZC5oYXMoZG9tT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZElkID0gb2xkQ2hpbGRJZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFkb21PYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZENoaWxkSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkSWQgPSBvbGRDaGlsZElkO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gcmVuZGVyaW5nIGZvciB0aGUgbm9kZSgnICsgY2hpbGQuaWQgKyAnKTogJyArIGNoaWxkLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRJZCA9IHRoaXMuX2RpZmZPYmplY3Qobm9kZVRvRG9tT2JqZWN0LCBkb21PYmplY3QsIG5vZGVzLCBtYXBPbGRJZHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlZElkcy5hZGQoY2hpbGRJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9yZW5kZXJlclRyZWF0ZWQuaGFzKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGNoaWxkSWQgPSB0aGlzLl9vYmplY3RJZHMuZ2V0KGNoaWxkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hpbGRJZCA9IHRoaXMuX2RpZmZPYmplY3QoXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUb0RvbU9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLFxuICAgICAgICAgICAgICAgICAgICBtYXBPbGRJZHMsXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuTWFwcGluZyxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2hpbGRJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29iamVjdHNbY2hpbGRJZF0ucGFyZW50ID0gaWQ7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGlsZHJlbi5pbmNsdWRlcyhjaGlsZElkKSkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkSWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaGlsZHJlbi5qb2luKCkgIT09IG9sZENoaWxkcmVuLmpvaW4oKSkge1xuICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkSWQgb2Ygb2xkQ2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWNoaWxkcmVuLmluY2x1ZGVzKGNoaWxkSWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vYmplY3RzW2NoaWxkSWRdLnBhcmVudCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29iamVjdHNbY2hpbGRJZF0ucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkQ2hpbGRyZW4ucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9tTm9kZXNDaGlsZHJlblByb2Nlc3MpIHtcbiAgICAgICAgICAgIGRvbU5vZGVzQ2hpbGRyZW4gPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW3JlZiwgcG9zaXRpb24sIG5vZGVzXSBvZiBkb21Ob2Rlc0NoaWxkcmVuUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZHM6IERvbU9iamVjdElEW10gPSBub2Rlc1xuICAgICAgICAgICAgICAgICAgICAubWFwKG5vZGUgPT4gdGhpcy5fZnJvbUl0ZW0uZ2V0KG5vZGUpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGlkID0+IGlkKTtcbiAgICAgICAgICAgICAgICBkb21Ob2Rlc0NoaWxkcmVuLnB1c2goW3JlZiwgcG9zaXRpb24sIG5vZGVJZHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZG9tTm9kZXMubGVuZ3RoICYmIGRvbU9iamVjdC50YWcpIHtcbiAgICAgICAgICAgIGlmICghb2xkIHx8IGRvbU9iamVjdC50YWcgIT09IG9sZC5vYmplY3QudGFnKSB7XG4gICAgICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBVcGRhdGUgYXR0cmlidXRlcy5cbiAgICAgICAgICAgIGNvbnN0IG5ld0F0dHJpYnV0ZXM6IERvbU9iamVjdEF0dHJpYnV0ZXMgPSBkb21PYmplY3QuYXR0cmlidXRlcyB8fCB7fTtcbiAgICAgICAgICAgIGNvbnN0IG9sZEF0dHJpYnV0ZXM6IERvbU9iamVjdEF0dHJpYnV0ZXMgPSBvbGQ/Lm9iamVjdC5hdHRyaWJ1dGVzIHx8IHt9O1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gb2xkQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGlmICghbmV3QXR0cmlidXRlc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG9sZEF0dHJpYnV0ZXNbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmU3R5bGVba2V5XSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2Ygb2xkQXR0cmlidXRlc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZDbGFzc0xpc3RbY2xhc3NOYW1lXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZkF0dHJpYnV0ZXNbbmFtZV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIGluIG5ld0F0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdTdHlsZSA9IG5ld0F0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9sZFN0eWxlID0gb2xkQXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbmV3U3R5bGVba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlN0eWxlW2tleV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuZXdTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1N0eWxlW2tleV0gIT09IG9sZFN0eWxlPy5ba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0NoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZTdHlsZVtrZXldID0gbmV3U3R5bGVba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDbGFzc05hbWVzID0gbmV3QXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2xkQ2xhc3NOYW1lcyA9IG9sZEF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRDbGFzc05hbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBvbGRDbGFzc05hbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAmJiAhbmV3Q2xhc3NOYW1lcy5oYXMoY2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZkNsYXNzTGlzdFtjbGFzc05hbWVdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIG9mIG5ld0NsYXNzTmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUgJiYgIW9sZENsYXNzTmFtZXM/LmhhcyhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZkNsYXNzTGlzdFtjbGFzc05hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3QXR0cmlidXRlc1tuYW1lXSBhcyBzdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gb2xkQXR0cmlidXRlc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaWZmQXR0cmlidXRlc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNbbmFtZV0gPSBuZXdBdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCFkb21Ob2Rlcy5sZW5ndGggJiYgZG9tT2JqZWN0LnRleHQpIHtcbiAgICAgICAgICAgIGlmICghb2xkIHx8IGRvbU9iamVjdC50ZXh0ICE9PSBvbGQub2JqZWN0LnRleHQpIHtcbiAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghZG9tTm9kZXMubGVuZ3RoICYmIG9sZD8uZG9tLmxlbmd0aCkge1xuICAgICAgICAgICAgaGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZW1vdmUgb2xkIHJlZmVyZW5jaWVzXG4gICAgICAgIGNvbnN0IG9sZElkc1RvUmVsZWFzZTogRG9tT2JqZWN0SURbXSA9IFtdO1xuICAgICAgICBpZiAoaXRlbXMgJiYgb2xkSWRzLnNpemUpIHtcbiAgICAgICAgICAgIG9sZElkc1RvUmVsZWFzZS5wdXNoKC4uLm9sZElkcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9sZCkge1xuICAgICAgICAgICAgb2xkSWRzVG9SZWxlYXNlLnB1c2gob2xkLmlkKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb2xkLm9iamVjdC5kZXRhY2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBvbGQub2JqZWN0LmRldGFjaCguLi5vbGQuZG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIG9sZElkc1RvUmVsZWFzZSkge1xuICAgICAgICAgICAgY29uc3Qgb2xkID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5faXRlbXMuZ2V0KG9sZC5vYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWRzID0gdGhpcy5fcmVuZGVyZWROb2Rlcy5nZXQoaXRlbSk7XG4gICAgICAgICAgICAgICAgaWYgKGlkcyAmJiBpZHMuaGFzKGlkKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3JlbGVhc2VkSXRlbXMuaGFzKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWxlYXNlZEl0ZW1zLmFkZChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVkTm9kZXMuZGVsZXRlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIG5ldyByZWZlcmVuY2llcy5cbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICAgICAgICB0aGlzLl9mcm9tSXRlbS5zZXQobm9kZSwgaWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIG5ldyBTZXQoWy4uLml0ZW1zLCAuLi50aGlzLl9pdGVtcy5nZXQoZG9tT2JqZWN0KV0pKSB7XG4gICAgICAgICAgICAgICAgbGV0IGlkcyA9IHRoaXMuX3JlbmRlcmVkTm9kZXMuZ2V0KGl0ZW0pO1xuICAgICAgICAgICAgICAgIGlmICghaWRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZWROb2Rlcy5zZXQoaXRlbSwgaWRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWRzLmFkZChpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhdGlvbnMuZ2V0KGRvbU9iamVjdCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9ucy5zZXQoZG9tT2JqZWN0LCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb2JqZWN0c1tpZF0gPSB7XG4gICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICBvYmplY3Q6IGRvbU9iamVjdCxcbiAgICAgICAgICAgIHBhcmVudDogb2xkPy5wYXJlbnQsXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW4sXG4gICAgICAgICAgICBkb206IGRvbU5vZGVzLFxuICAgICAgICAgICAgZG9tTm9kZXM6IGFsbERvbU5vZGVzLFxuICAgICAgICAgICAgZG9tTm9kZXNDaGlsZHJlbjogZG9tTm9kZXNDaGlsZHJlbixcbiAgICAgICAgICAgIHBhcmVudERvbU5vZGU6IG9sZD8ucGFyZW50RG9tTm9kZSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoaGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgY29uc3Qgb2xkRG9tTm9kZXMgPSBvbGQ/LmRvbSA/IFsuLi5vbGQuZG9tXSA6IFtdO1xuICAgICAgICAgICAgaWYgKG9sZElkcykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaWQgb2Ygb2xkSWRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiB0aGlzLl9vYmplY3RzW2lkXS5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2xkRG9tTm9kZXMuaW5jbHVkZXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGREb21Ob2Rlcy5wdXNoKGRvbU5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZGlmZltpZF0gPSB7XG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGRpZmZBdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBkaWZmU3R5bGUsXG4gICAgICAgICAgICAgICAgY2xhc3NMaXN0OiBkaWZmQ2xhc3NMaXN0LFxuICAgICAgICAgICAgICAgIGRvbTogb2xkRG9tTm9kZXMsXG4gICAgICAgICAgICAgICAgcGFyZW50RG9tTm9kZTogb2xkPy5wYXJlbnREb21Ob2RlLFxuICAgICAgICAgICAgICAgIHJlbW92ZWRDaGlsZHJlbjogcmVtb3ZlZENoaWxkcmVuLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX29iamVjdHNbaWRdLmRvbSA9IG9sZC5kb207XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvbU9iamVjdC5hdHRhY2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBkb21PYmplY3QuYXR0YWNoKC4uLm9sZC5kb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9XG4gICAgcHJpdmF0ZSBfZGlmZk9iamVjdEFzc29jaWF0ZUNoaWxkcmVuTWFwKFxuICAgICAgICBvYmplY3RBOiBHZW5lcmljRG9tT2JqZWN0LFxuICAgICAgICBvYmplY3RJZHNCOiBTZXQ8RG9tT2JqZWN0SUQ+LFxuICAgICk6IE1hcDxHZW5lcmljRG9tT2JqZWN0LCBEb21PYmplY3RJRD4ge1xuICAgICAgICBjb25zdCBtYXAgPSBuZXcgTWFwPEdlbmVyaWNEb21PYmplY3QsIERvbU9iamVjdElEPigpO1xuICAgICAgICBpZiAoIW9iamVjdElkc0Iuc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1hcDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbGxDaGlsZHJlbkE6IEdlbmVyaWNEb21PYmplY3RbXSA9IFtvYmplY3RBXTtcbiAgICAgICAgZm9yIChjb25zdCBkb21PYmplY3Qgb2YgYWxsQ2hpbGRyZW5BKSB7XG4gICAgICAgICAgICBpZiAoZG9tT2JqZWN0LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBkb21PYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxDaGlsZHJlbkEucHVzaChjaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWxsQ2hpbGRyZW5COiBEb21PYmplY3RJRFtdID0gWy4uLm9iamVjdElkc0JdO1xuICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGFsbENoaWxkcmVuQikge1xuICAgICAgICAgICAgY29uc3Qgb2JqQiA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXJUcmVhdGVkLmRlbGV0ZShvYmpCLm9iamVjdCk7XG4gICAgICAgICAgICBpZiAob2JqQj8uY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIG9iakIuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29iamVjdHNbaWRdICYmICF0aGlzLl9yZW5kZXJlZElkcy5oYXMoaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxDaGlsZHJlbkIucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtYXBSYXRpb3MgPSB0aGlzLl9kaWZmT2JqZWN0QXNzb2NpYXRlQ2hpbGRyZW4oYWxsQ2hpbGRyZW5BLCBhbGxDaGlsZHJlbkIpO1xuICAgICAgICBtYXBSYXRpb3Muc29ydCgoYSwgYikgPT4gYlswXSAtIGFbMF0pO1xuXG4gICAgICAgIGNvbnN0IHVzZWQgPSBuZXcgU2V0PERvbU9iamVjdElEPigpO1xuICAgICAgICBmb3IgKGNvbnN0IFssIGNoaWxkUmVmLCBpZF0gb2YgbWFwUmF0aW9zKSB7XG4gICAgICAgICAgICBpZiAoIW1hcC5nZXQoY2hpbGRSZWYpICYmICF1c2VkLmhhcyhpZCkpIHtcbiAgICAgICAgICAgICAgICBtYXAuc2V0KGNoaWxkUmVmLCBpZCk7XG4gICAgICAgICAgICAgICAgdXNlZC5hZGQoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXA7XG4gICAgfVxuICAgIHByaXZhdGUgX2RpZmZPYmplY3RBc3NvY2lhdGVDaGlsZHJlbihcbiAgICAgICAgYXJyYXlBOiBHZW5lcmljRG9tT2JqZWN0W10sXG4gICAgICAgIGFycmF5QjogRG9tT2JqZWN0SURbXSxcbiAgICApOiBbbnVtYmVyLCBHZW5lcmljRG9tT2JqZWN0LCBEb21PYmplY3RJRF1bXSB7XG4gICAgICAgIGNvbnN0IG1hcFJhdGlvczogW251bWJlciwgR2VuZXJpY0RvbU9iamVjdCwgRG9tT2JqZWN0SURdW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBvYmplY3RBIG9mIGFycmF5QSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpZEIgb2YgYXJyYXlCKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbUIgPSB0aGlzLl9vYmplY3RzW2lkQl07XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0QiA9IGl0ZW1CLm9iamVjdDtcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFJhdGlvID0gMDtcbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0QS50YWcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdEEudGFnID09PSBvYmplY3RCLnRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0ckE6IERvbU9iamVjdEF0dHJpYnV0ZXMgPSBvYmplY3RBLmF0dHJpYnV0ZXMgfHwge307XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyQjogRG9tT2JqZWN0QXR0cmlidXRlcyA9IG9iamVjdEIuYXR0cmlidXRlcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHNvbWUgcG9pbnRzIGZvciBhdHRyaWJ1dGVzIG1hdGNoaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYW1lID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBpbiBhdHRyQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlQSA9IGF0dHJBW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHlsZUIgPSBhdHRyQj8uW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGVBKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzdHlsZUEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGVBW2tleV0gPT09IHN0eWxlQj8uW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGFzc0EgPSBhdHRyQVtuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xhc3NCID0gYXR0ckI/LltuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjIG9mIGNsYXNzQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc0I/LmhhcyhjKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyQVtuYW1lXSA9PT0gYXR0ckI/LltuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIGluIGF0dHJCKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVBID0gYXR0ckE/LltuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVCID0gYXR0ckJbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHlsZUIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHN0eWxlQikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3R5bGVBIHx8ICEoa2V5IGluIHN0eWxlQSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsYXNzQSA9IGF0dHJBPy5bbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsYXNzQiA9IGF0dHJCW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3NCKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGMgb2YgY2xhc3NCKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjbGFzc0E/LmhhcyhjKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFhdHRyQSB8fCAhKG5hbWUgaW4gYXR0ckEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhdGlvID0gMSArIHNhbWUgLyAobWF4IHx8IDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvYmplY3RBLnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdEIudGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhdGlvID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob2JqZWN0QS5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1CLmRvbS5sZW5ndGggJiYgIW9iamVjdEIudGFnICYmICFvYmplY3RCLnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYXRpbyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9iamVjdEEuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1CLmNoaWxkcmVuICYmICFvYmplY3RCLnRleHQgJiYgIW9iamVjdEIudGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmF0aW8gPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UmF0aW8gPj0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYmVzdCBoYXZlIGF0IGxlYXQgb24gbm9kZSBpbiBjb21tb24gb3IgdGhlIHR3aWNlIGRvZXMgbm90IGhhdmUgbm9kZS5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbXNBID0gdGhpcy5faXRlbXMuZ2V0KG9iamVjdEEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtc0IgPSB0aGlzLl9pdGVtcy5nZXQob2JqZWN0Qik7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNvbWUgcG9pbnRzIGZvciBjaGlsZHJlbiBub2Rlcy5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoTm9kZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXhOb2RlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGl0ZW1zQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhOb2RlKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zQi5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaE5vZGUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGl0ZW1zQikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWl0ZW1zQi5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhOb2RlKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVSYXRpbyA9IG1heE5vZGUgPyBtYXRjaE5vZGUgLyBtYXhOb2RlIDogMTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZVJhdGlvID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhdGlvICs9IG5vZGVSYXRpbztcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGJlc3QgY2FuZGlkYXRlIG11c3QgaGF2ZSB0aGUgbW9zdCBjb21tb24gbG9jYXRlZCBub2Rlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvY0EgPSB0aGlzLl9sb2NhdGlvbnMuZ2V0KG9iamVjdEEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9jQiA9IHRoaXMuX2xvY2F0aW9ucy5nZXQob2JqZWN0Qik7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1heCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgbG9jQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NCLmluY2x1ZGVzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGxvY0IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvY0EuaW5jbHVkZXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhdGlvICs9IG1heCA/IG1hdGNoIC8gbWF4IDogMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGJlc3QgY2FuZGlkYXRlIG11c3QgaGF2ZSB0aGUgbW9zdCBjb21tb24gbW9kaWZpZXJzLlxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoTW9kaWZpZXIgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1heE1vZGlmaWVyID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBpdGVtc0EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhNb2RpZmllcisrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNCLmluY2x1ZGVzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaE1vZGlmaWVyKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgaXRlbXNCKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVtc0IuaW5jbHVkZXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heE1vZGlmaWVyKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmF0aW8gKz0gKG1heE1vZGlmaWVyID8gbWF0Y2hNb2RpZmllciAvIG1heE1vZGlmaWVyIDogMCkgLyAxMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwUmF0aW9zLnB1c2goW2N1cnJlbnRSYXRpbywgb2JqZWN0QSwgaWRCXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hcFJhdGlvcztcbiAgICB9XG4gICAgcHJpdmF0ZSBfYWRkTG9jYXRpb25zKFxuICAgICAgICBkb21PYmplY3Q6IEdlbmVyaWNEb21PYmplY3QsXG4gICAgICAgIGxvY2F0aW9uczogTWFwPEdlbmVyaWNEb21PYmplY3QsIFZOb2RlW10+LFxuICAgICAgICBmcm9tOiBNYXA8R2VuZXJpY0RvbU9iamVjdCwgU2V0PFZOb2RlIHwgTW9kaWZpZXI+PixcbiAgICApOiBBcnJheTxWTm9kZSB8IE1vZGlmaWVyPiB7XG4gICAgICAgIGNvbnN0IGFsbEl0ZW1zOiBBcnJheTxWTm9kZSB8IE1vZGlmaWVyPiA9IFtdO1xuICAgICAgICBjb25zdCBpdGVtcyA9IGZyb20uZ2V0KGRvbU9iamVjdCk7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhbGxJdGVtcy5pbmNsdWRlcyhpdGVtKSkge1xuICAgICAgICAgICAgICAgICAgICBhbGxJdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vZGVzID0gbG9jYXRpb25zLmdldChkb21PYmplY3QpO1xuICAgICAgICBpZiAobm9kZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9ucy5zZXQoZG9tT2JqZWN0LCBub2RlcyA/IEFycmF5LmZyb20obm9kZXMpIDogW10pO1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhbGxJdGVtcy5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBhbGxJdGVtcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9ucy5zZXQoZG9tT2JqZWN0LCBbXSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9tT2JqZWN0LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGluZGV4IGluIGRvbU9iamVjdC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gZG9tT2JqZWN0LmNoaWxkcmVuW2luZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuX2FkZExvY2F0aW9ucyhjaGlsZCwgbG9jYXRpb25zLCBmcm9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxsSXRlbXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pdGVtcy5zZXQoZG9tT2JqZWN0LCBhbGxJdGVtcyk7XG4gICAgICAgIHJldHVybiBhbGxJdGVtcztcbiAgICB9XG4gICAgcHJpdmF0ZSBfdXBkYXRlRG9tKGlkOiBEb21PYmplY3RJRCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBkaWZmID0gdGhpcy5fZGlmZltpZF07XG4gICAgICAgIGlmICghZGlmZikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICBjb25zdCBkb21PYmplY3QgPSBvYmplY3Qub2JqZWN0O1xuICAgICAgICBsZXQgbmV3Tm9kZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChkb21PYmplY3QudGFnKSB7XG4gICAgICAgICAgICBsZXQgZG9tTm9kZSA9IHRoaXMuX2dldEF2YWlsYWJsZUVsZW1lbnQoaWQpO1xuXG4gICAgICAgICAgICBpZiAoZG9tTm9kZSAmJiAhZG9tT2JqZWN0LnNoYWRvd1Jvb3QgIT09ICFkb21Ob2RlLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBhdHRyaWJ1dGVzOiBEb21PYmplY3RBdHRyaWJ1dGVzO1xuICAgICAgICAgICAgaWYgKGRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGlmZi5hc2tDb21wbGV0ZVJlZHJhd2luZykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHIgb2YgZG9tTm9kZS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGRvbU9iamVjdC5hdHRyaWJ1dGVzW2F0dHIubmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHIubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IGRvbU9iamVjdC5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBkaWZmLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZGlmZi5hc2tDb21wbGV0ZVJlZHJhd2luZykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGlmZi5zdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U3R5bGUoZG9tTm9kZSwgbmFtZSwgZGlmZi5zdHlsZVtuYW1lXSB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIGluIGRpZmYuY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlmZi5jbGFzc0xpc3RbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLmNsYXNzTGlzdC5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGUuY2xhc3NMaXN0LnJlbW92ZShuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZG9tT2JqZWN0LnRhZyk7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IGRvbU9iamVjdC5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIGlmIChkb21PYmplY3Quc2hhZG93Um9vdCkge1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFN0eWxlKGRvbU5vZGUsIG5hbWUsIHN0eWxlW25hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBOb3cgd2Ugc2V0IHRoZSBhdHRyaWJ1dGUgYWdhaW4gdG8ga2VlcCBvcmRlci5cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVJbmxpbmUgPSBkb21Ob2RlLmdldEF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlSW5saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBzdHlsZUlubGluZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xhc3NMaXN0ID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBOb3cgd2Ugc2V0IHRoZSBhdHRyaWJ1dGUgYWdhaW4gdG8ga2VlcCBvcmRlci5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xhc3NJbmxpbmUgPSBkb21Ob2RlLmdldEF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzSW5saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjbGFzc0lubGluZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGRvbU5vZGUuZ2V0QXR0cmlidXRlKCdjbGFzcycpID09PSAnJykge1xuICAgICAgICAgICAgICAgIGRvbU5vZGUucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvbU5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZScpID09PSAnJykge1xuICAgICAgICAgICAgICAgIGRvbU5vZGUucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JqZWN0LmRvbSA9IFtkb21Ob2RlXTtcbiAgICAgICAgfSBlbHNlIGlmIChkb21PYmplY3QudGV4dCkge1xuICAgICAgICAgICAgb2JqZWN0LmRvbSA9IHRoaXMuX3JlZHJhd0FuZEFzc29jaWF0ZVRleHQoaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG9iamVjdC5kb21Ob2Rlc0NoaWxkcmVuICYmIG9iamVjdC5kb20ubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2Ygb2JqZWN0LmRvbSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mcm9tRG9tLmdldChkb21Ob2RlKSAhPT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZnJvbURvbS5zZXQoZG9tTm9kZSwgaWQpO1xuICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBZGQgYWxsIG5vZGVzIGFzIG1hcHBpbmcgdG8gYXZvaWQgYXNzb2NpYXRpb24gYnkgY2hpbGRyZW4uXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2Ygb2JqZWN0LmRvbU5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZnJvbURvbS5zZXQoZG9tTm9kZSwgaWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbnNlcnQgY2hpbGRyZW4gaW4gdGhlIGRvbSB3aGljaCBsb2NhdGUgd2l0aCB0aGUgcGxhY2Vob2xkZXIuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtyZWYsIHBvc2l0aW9uLCBjaGlsZElkc10gb2Ygb2JqZWN0LmRvbU5vZGVzQ2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uSU5TSURFKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkRG9tTm9kZXMgPSBmbGF0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRJZHMubWFwKGNoaWxkSWQgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9nZXREb21DaGlsZChjaGlsZElkLCByZWYgYXMgRWxlbWVudCB8IFNoYWRvd1Jvb3QpLFxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGNoaWxkRG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZi5hcHBlbmRDaGlsZChkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkRG9tTm9kZXMgPSBmbGF0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRJZHMubWFwKGNoaWxkSWQgPT4gdGhpcy5fZ2V0RG9tQ2hpbGQoY2hpbGRJZCwgcmVmLnBhcmVudEVsZW1lbnQpKSxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGNoaWxkRG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoZG9tTm9kZSwgcmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWYubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSByZWYubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgY2hpbGREb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZi5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShkb21Ob2RlLCBuZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZi5wYXJlbnRFbGVtZW50LmFwcGVuZCguLi5jaGlsZERvbU5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVtb3ZlIHByb3RlY3RlZCBtYXBwaW5nLlxuICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIG9iamVjdC5kb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Zyb21Eb20uZGVsZXRlKGRvbU5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIG9iamVjdC5kb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9mcm9tRG9tLnNldChkb21Ob2RlLCBpZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRPRE8gcmVtb3ZlID9cbiAgICAgICAgICAgIGxldCBpdGVtID0gZGlmZi5kb20/LlswXTtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IGl0ZW0/LnBhcmVudE5vZGU7XG4gICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIG9iamVjdC5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9tTm9kZSAhPT0gaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShkb21Ob2RlLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBkb21Ob2RlLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRpZmYuZG9tKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZnJvbURvbS5nZXQoZG9tTm9kZSkgPT09IGlkICYmICFvYmplY3QuZG9tLmluY2x1ZGVzKGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZnJvbURvbS5kZWxldGUoZG9tTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIG9iamVjdC5kb20pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9mcm9tRG9tLmdldChkb21Ob2RlKSAhPT0gaWQgfHwgIWRvbU5vZGUucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Zyb21Eb20uc2V0KGRvbU5vZGUsIGlkKTtcbiAgICAgICAgICAgICAgICBuZXdOb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghb2JqZWN0LmRvbU5vZGVzQ2hpbGRyZW4gJiYgb2JqZWN0LmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IHBhcmVudERvbU5vZGUgPSBvYmplY3QucGFyZW50RG9tTm9kZTtcbiAgICAgICAgICAgIGlmIChkb21PYmplY3QudGFnKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RG9tTm9kZSA9IG9iamVjdC5kb21bMF0gYXMgRWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoZG9tT2JqZWN0LnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50RG9tTm9kZSA9IHBhcmVudERvbU5vZGUuc2hhZG93Um9vdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlczogTm9kZVtdID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkSWQgb2Ygb2JqZWN0LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZXMucHVzaCguLi50aGlzLl9nZXREb21DaGlsZChjaGlsZElkLCBwYXJlbnREb21Ob2RlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9tTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvbU9iamVjdC50YWcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5zZXJ0RG9tQ2hpbGRyZW4oZG9tTm9kZXMsIHBhcmVudERvbU5vZGUsIHBhcmVudERvbU5vZGUuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZGVsZXRlIHRoaXMuX2RpZmZbaWRdO1xuICAgICAgICB0aGlzLl9kb21VcGRhdGVkLmFkZChpZCk7XG5cbiAgICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfVxuICAgIHByaXZhdGUgX2dldERvbUNoaWxkKGlkOiBEb21PYmplY3RJRCwgcGFyZW50RG9tTm9kZTogRWxlbWVudCB8IFNoYWRvd1Jvb3QpOiBOb2RlW10ge1xuICAgICAgICAvLyBBcHBseSBkaWZmIGZvciBkZXNjZW5kZW50cyBpZiBuZWVkZWQuXG4gICAgICAgIGNvbnN0IGRlc2NlbmRlbnRzID0gW2lkXTtcbiAgICAgICAgZm9yIChjb25zdCBpZCBvZiBkZXNjZW5kZW50cykge1xuICAgICAgICAgICAgY29uc3QgZGVzY2VuZGVudCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICAgICAgZGVzY2VuZGVudC5wYXJlbnREb21Ob2RlID0gcGFyZW50RG9tTm9kZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kaWZmW2lkXSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZURvbShpZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCEoJ3RhZycgaW4gZGVzY2VuZGVudC5vYmplY3QpICYmIGRlc2NlbmRlbnQuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgY2hpbGRyZW4gaWYgaXQncyBhIGZyYWdtZW50LlxuICAgICAgICAgICAgICAgIGRlc2NlbmRlbnRzLnB1c2goLi4uZGVzY2VuZGVudC5jaGlsZHJlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2V0IHRoZSBkb20gcmVwcmVzZW50aW5nIHRoaXMgY2hpbGQuXG4gICAgICAgIGxldCBkb21Ob2RlczogTm9kZVtdID0gW107XG4gICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgIGlmIChjaGlsZC5kb20ubGVuZ3RoKSB7XG4gICAgICAgICAgICBkb21Ob2RlcyA9IGNoaWxkLmRvbTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbU5vZGVzID0gdGhpcy5fZ2V0Y2hpbGRyZW5Eb21Ob2RlcyhpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGVzO1xuICAgIH1cbiAgICBwcml2YXRlIF9yZWRyYXdBbmRBc3NvY2lhdGVUZXh0KGlkOiBEb21PYmplY3RJRCk6IFRleHRbXSB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdLm9iamVjdDtcbiAgICAgICAgY29uc3QgdGV4dENvbnRlbnQgPSBkb21PYmplY3QudGV4dDtcbiAgICAgICAgbGV0IHRleHROb2RlcyA9IHRoaXMuX2dldEF2YWlsYWJsZVRleHROb2RlcyhpZCkgYXMgVGV4dFtdO1xuICAgICAgICBpZiAodGV4dE5vZGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjaGFyczogW3N0cmluZywgVGV4dCwgbnVtYmVyXVtdID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRleHROb2RlIG9mIHRleHROb2Rlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNwbGl0ID0gdGV4dE5vZGUudGV4dENvbnRlbnQuc3BsaXQoJycpO1xuICAgICAgICAgICAgICAgIGlmIChzcGxpdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnMucHVzaChbc3BsaXRbaV0sIHRleHROb2RlLCBpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjaGFycy5wdXNoKFsnJywgdGV4dE5vZGUsIDBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IHRleHRDb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IGNoYXJMZW4gPSBjaGFycy5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBtYXhMZW4gPSBNYXRoLm1heChsZW4sIGNoYXJMZW4pO1xuXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAwO1xuICAgICAgICAgICAgbGV0IGluZGV4Rmlyc3RDaGFuZ2U6IG51bWJlciA9IG51bGw7IC8vIGluZGV4IGZyb20gYmVnaW5cbiAgICAgICAgICAgIGxldCBpbmRleExhc3RDaGFuZ2U6IG51bWJlciA9IG51bGw7IC8vIGluZGV4IGZyb20gZW5kXG4gICAgICAgICAgICB3aGlsZSAoKGluZGV4Rmlyc3RDaGFuZ2UgPT09IG51bGwgfHwgaW5kZXhMYXN0Q2hhbmdlID09PSBudWxsKSAmJiBpbmRleCA8IG1heExlbikge1xuICAgICAgICAgICAgICAgIGlmIChpbmRleEZpcnN0Q2hhbmdlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgPSB0ZXh0Q29udGVudFtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9sZCA9IGNoYXJzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvbGQgfHwgY2hhciAhPT0gb2xkWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleEZpcnN0Q2hhbmdlID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4TGFzdENoYW5nZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyID0gdGV4dENvbnRlbnRbbGVuIC0gMSAtIGluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2xkID0gY2hhcnNbY2hhckxlbiAtIDEgLSBpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGlmICghb2xkIHx8IGNoYXIgIT09IG9sZFswXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhMYXN0Q2hhbmdlID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGluZGV4Rmlyc3RDaGFuZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBsZXQgdGV4dEJlZ2luOiBUZXh0O1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0RW5kOiBUZXh0O1xuICAgICAgICAgICAgICAgIGxldCBmaXJzdDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCBjZW50ZXI6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgbGFzdDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXJCZWdpbiA9IGNoYXJzW2luZGV4Rmlyc3RDaGFuZ2VdO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNoYXJCZWdpbikge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0QmVnaW4gPSB0ZXh0RW5kID0gY2hhckJlZ2luWzFdO1xuICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IHRleHRCZWdpbi50ZXh0Q29udGVudC5zbGljZSgwLCBjaGFyQmVnaW5bMl0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyRW5kID0gY2hhcnNbY2hhckxlbiAtIGluZGV4TGFzdENoYW5nZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleEZpcnN0Q2hhbmdlID49IGxlbiAtIGluZGV4TGFzdENoYW5nZSB8fCAhY2hhckVuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGluZGV4ZXMgb2YgdGhlIGRlc3RpbmF0aW9uIHRleHQgY3Jvc3MsIGl0IGlzIHRoYXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBlbmQgYW5kIHRoZSBiZWdpbm5pbmcgYXJlIGp1c3QuIENlcnRhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoYXJhY3RlcnMgc2hvdWxkIGJlIHJlbW92ZWQgYW5kIHJlcGxjZSBieSB0aGUgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvZiB0aGUgbmVlZGVkIHRleHRDb250ZW50LiBJZiB0aGVyZSBpcyBubyBlbmRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoYW5nZSwgZXZlcnkgZW5kaW5nIGNoYXJzIGFyZSBmYWxzZSBhbmQgd2lsbCBiZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlZCBhbmQgcmVwbGFjZSBieSB0aGUgbmV3IGVuZGluZyB0ZXh0LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGxlYXNlIG5vdGUgdGhhdCB5b3UgbXVzdCBrZWVwIHRoZSBleGlzdGluZyB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub2Rlcy4gQW5kIHRoZXJlZm9yZSByZW1vdmUgdGhlIGNoYXJhY3RlciBpbiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRleHQgbm9kZXMgcHJlc2VudCBpbiB0aGUgZG9tLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhckVuZCA9IGNoYXJzW2NoYXJMZW4gLSBpbmRleExhc3RDaGFuZ2UgKyAxXSB8fCBjaGFyc1tjaGFyTGVuIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleExhc3RDaGFuZ2UgPSBjaGFyTGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEVuZCA9IGNoYXJFbmRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXIgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSB0ZXh0Q29udGVudC5zbGljZShpbmRleEZpcnN0Q2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBpbmRleGVzLCBkbyBub3QgY3Jvc3MsIHNvIHdlIHdpbGwgYWRkIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWlzc2luZyBwaWVjZSBhbmQgcmVtb3ZlIHRoZSBlcnJvbmVvdXMgY2hhcmFjdGVycy5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRFbmQgPSBjaGFyRW5kWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IHRleHRFbmQudGV4dENvbnRlbnQuc2xpY2UoY2hhckVuZFsyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXIgPSB0ZXh0Q29udGVudC5zbGljZShpbmRleEZpcnN0Q2hhbmdlLCBsZW4gLSBpbmRleExhc3RDaGFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gc3RhcnQgb2YgY2hhbmdlLCB0aGlzIGltcGxpZXMgdGhhdCBvbmx5XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoYXJhY3RlcnMgbXVzdCBiZSBhZGRlZC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciA9IGNoYXJzW2luZGV4Rmlyc3RDaGFuZ2UgLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgdGV4dEJlZ2luID0gdGV4dEVuZCA9IGNoYXJbMV07XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gdGV4dEJlZ2luLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBjZW50ZXIgPSB0ZXh0Q29udGVudC5zbGljZShpbmRleEZpcnN0Q2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgbGFzdCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNlYXJjaCBldmVyeSB0ZXh0IG5vZGVzIGJldHdlZW4gdGhlIGJlZ2luIGFuZCBlbmQgb2YgdGhlXG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlcy4gVGhpcyB0ZXh0IG5vZGVzIHdpbGwgYmUgcmVtb3ZlZC5cbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0c0JldHdlZW5TdGFydEVuZDogVGV4dFtdID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSBpbmRleEZpcnN0Q2hhbmdlOyBpbmRleCA8IGluZGV4TGFzdENoYW5nZTsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2hhcnNbaW5kZXhdPy5bMV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgIT09IHRleHRCZWdpbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCAhPT0gdGV4dEVuZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXRleHRzQmV0d2VlblN0YXJ0RW5kLmluY2x1ZGVzKHRleHQpXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHNCZXR3ZWVuU3RhcnRFbmQucHVzaCh0ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZG9tIHdpdGggdGhlIG1pbmltdW0gb2YgbXV0YXRpb25zLlxuICAgICAgICAgICAgICAgIGlmICh0ZXh0QmVnaW4gPT09IHRleHRFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0ID09PSAnJyAmJiBjZW50ZXIgPT09ICcnICYmIGxhc3QgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0c0JldHdlZW5TdGFydEVuZC5wdXNoKHRleHRCZWdpbik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGV4dEJlZ2luLnRleHRDb250ZW50ICE9PSBmaXJzdCArIGNlbnRlciArIGxhc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRCZWdpbi50ZXh0Q29udGVudCA9IGZpcnN0ICsgY2VudGVyICsgbGFzdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCA9PT0gJycgJiYgY2VudGVyID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHNCZXR3ZWVuU3RhcnRFbmQucHVzaCh0ZXh0QmVnaW4pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRleHRCZWdpbi50ZXh0Q29udGVudCAhPT0gZmlyc3QgKyBjZW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRCZWdpbi50ZXh0Q29udGVudCA9IGZpcnN0ICsgY2VudGVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0ID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHNCZXR3ZWVuU3RhcnRFbmQucHVzaCh0ZXh0RW5kKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXh0RW5kLnRleHRDb250ZW50ICE9PSBsYXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RW5kLnRleHRDb250ZW50ID0gbGFzdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZXMgdGV4dCBub2RlcyBiZXR3ZWVuIHRoZSBiZWdpbiBhbmQgZW5kLCBhbmQgbWF5IGJlXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFuIG90aGVyIHRleHQgbm9kZSwgaWYgaXQncyByZXBsYWNlIGJ5IGFuIGVtcHR5IHN0cmluZy5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgdGV4dHNCZXR3ZWVuU3RhcnRFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzLnNwbGljZSh0ZXh0Tm9kZXMuaW5kZXhPZihkb21Ob2RlKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRvbU5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkb21Ob2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0ZXh0Tm9kZXMgPSBbZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dENvbnRlbnQpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGV4dE5vZGVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgbWlzc2luZyBkb21Ob2RlcyBpbiB0aGlzIGVsZW1lbnQuXG4gICAgICovXG4gICAgcHJpdmF0ZSBfaW5zZXJ0RG9tQ2hpbGRyZW4oZG9tTm9kZXM6IE5vZGVbXSwgcGFyZW50Tm9kZTogTm9kZSwgaW5zZXJ0QmVmb3JlOiBOb2RlKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgaWYgKGluc2VydEJlZm9yZSkge1xuICAgICAgICAgICAgICAgIGlmIChpbnNlcnRCZWZvcmUgPT09IGRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0QmVmb3JlID0gaW5zZXJ0QmVmb3JlLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRvbU5vZGUsIGluc2VydEJlZm9yZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKGRvbU5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgX2dldEF2YWlsYWJsZUVsZW1lbnQoaWQ6IERvbU9iamVjdElEKTogdm9pZCB8IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IG9iamVjdC5vYmplY3Q7XG4gICAgICAgIGNvbnN0IHRhZ05hbWUgPSBkb21PYmplY3QudGFnLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IGRpZmYgPSB0aGlzLl9kaWZmW2lkXTtcbiAgICAgICAgaWYgKG9iamVjdC5wYXJlbnREb21Ob2RlKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2Ygb2JqZWN0LnBhcmVudERvbU5vZGUuY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgICAgIGlmICh0YWdOYW1lID09PSBub2RlTmFtZShkb21Ob2RlKSAmJiB0aGlzLmlzQXZhaWxhYmxlTm9kZShpZCwgZG9tTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvbU5vZGUgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkaWZmKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZGlmZi5kb20pIHtcbiAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gbm9kZU5hbWUoZG9tTm9kZSkgJiYgdGhpcy5pc0F2YWlsYWJsZU5vZGUoaWQsIGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkb21Ob2RlIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIF9nZXRBdmFpbGFibGVUZXh0Tm9kZXMoaWQ6IERvbU9iamVjdElEKTogdm9pZCB8IFRleHRbXSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHRoaXMuX29iamVjdHNbaWRdO1xuICAgICAgICBjb25zdCBkaWZmID0gdGhpcy5fZGlmZltpZF07XG4gICAgICAgIGxldCB0ZXh0Tm9kZTogVGV4dDtcbiAgICAgICAgaWYgKG9iamVjdC5wYXJlbnREb21Ob2RlKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2Ygb2JqZWN0LnBhcmVudERvbU5vZGUuY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgICAgIGlmIChpc1RleHROb2RlKGRvbU5vZGUpICYmIHRoaXMuaXNBdmFpbGFibGVOb2RlKGlkLCBkb21Ob2RlKSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZSA9IGRvbU5vZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGV4dE5vZGUgJiYgZGlmZikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRpZmYuZG9tKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzVGV4dE5vZGUoZG9tTm9kZSkgJiYgdGhpcy5pc0F2YWlsYWJsZU5vZGUoaWQsIGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHROb2RlID0gZG9tTm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRleHROb2RlKSB7XG4gICAgICAgICAgICAvLyBHZXQgYWxsIGZyZWUgdGV4dCBub2Rlcy5cbiAgICAgICAgICAgIGNvbnN0IHRleHROb2RlcyA9IFt0ZXh0Tm9kZV07XG4gICAgICAgICAgICBsZXQgdGV4dCA9IHRleHROb2RlO1xuICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICAgIHRleHQucHJldmlvdXNTaWJsaW5nICYmXG4gICAgICAgICAgICAgICAgaXNUZXh0Tm9kZSh0ZXh0LnByZXZpb3VzU2libGluZykgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmlzQXZhaWxhYmxlTm9kZShpZCwgdGV4dC5wcmV2aW91c1NpYmxpbmcpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5wcmV2aW91c1NpYmxpbmc7XG4gICAgICAgICAgICAgICAgdGV4dE5vZGVzLnVuc2hpZnQodGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ZXh0ID0gdGV4dE5vZGU7XG4gICAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICAgICAgdGV4dC5uZXh0U2libGluZyAmJlxuICAgICAgICAgICAgICAgIGlzVGV4dE5vZGUodGV4dC5uZXh0U2libGluZykgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmlzQXZhaWxhYmxlTm9kZShpZCwgdGV4dC5uZXh0U2libGluZylcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIHRleHROb2Rlcy5wdXNoKHRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRleHROb2RlcztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGUgZG9tTm9kZSBhcmUgYWxyZWFkeSBhc3NvY2lhdGUgdG8gYW4gb3RoZXIgZG9tT2JqZWN0IGFuZFxuICAgICAqIHRoaXMgb2JqZWN0IGRvbid0IG5lZWQgdG8gYmUgcmVkcmF3ZWQuIFRoZSBhZGRpdGlvbmFsIGNoZWNraW5nIGZvciB0aGVcbiAgICAgKiBkaWZmIGlzJ3QgdXNlIHRvIGFzc29jaWF0ZSB0aGUgZG9tTm9kZWNyZWF0ZSBieSBhIHNwbGl0IGZyb20gdGhlIGJyb3dzZXIuXG4gICAgICogVGhlIGJyb3dzZXIgY2FuIGFkZCB0aGUgbmV3IGRvbU5vZGUgYWZ0ZXIgb3IgYmVmb3JlIHRoZSBzcGxpdC5cbiAgICAgKi9cbiAgICBwcml2YXRlIGlzQXZhaWxhYmxlTm9kZShpZDogRG9tT2JqZWN0SUQsIGRvbU5vZGU6IE5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgbGlua2VkSWQgPSB0aGlzLl9mcm9tRG9tLmdldChkb21Ob2RlKTtcbiAgICAgICAgaWYgKCFsaW5rZWRJZCkge1xuICAgICAgICAgICAgLy8gVGhlIGJyb3dzZXIgY2FuIHNlcGFyYXRlIGFuIGl0ZW0gYW5kIGtlZXAgYWxsIGF0dHJpYnV0ZXMgb24gdGhlXG4gICAgICAgICAgICAvLyBjbG9uZS4gSW4gdGhlIGV2ZW50IG9mIGEgbmV3IGVsZW1lbnQgdG8gYmUgYXNzb2NpYXRlZCwgYVxuICAgICAgICAgICAgLy8gY29tcGxldGUgcmVkcmF3aW5nIGlzIHJlcXVlc3RlZC5cbiAgICAgICAgICAgIHRoaXMuX2RpZmZbaWRdLmFza0NvbXBsZXRlUmVkcmF3aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaW5rZWRJZCA9PT0gaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9kaWZmW2xpbmtlZElkXT8uYXNrQ29tcGxldGVSZWRyYXdpbmcpIHtcbiAgICAgICAgICAgIC8vIFRoZSBicm93c2VyIGNhbiBhZGQgdGhlIG5ldyBkb21Ob2RlIGFmdGVyIG9yIGJlZm9yZSB0aGUgc3BsaXQuXG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIHRoZXJlIGlzIGEgY2hhbmdlIGluIGJvdGggZWxlbWVudHMuIEluIHRoZSBjYXNlIG9mXG4gICAgICAgICAgICAvLyB0ZXh0IGl0IGlzIGltcG9ydGFudCB0byBrZWVwIHRoZSBkb20gaW50YWN0IGluIG9yZGVyIHRvIGd1YXJhbnRlZVxuICAgICAgICAgICAgLy8gdGhlIG9wZXJhdGlvbiBvZiB0aGUgc3BlbGwgY2hlY2tlcnMuIEl0IGlzIGFsc28gaW1wb3J0YW50IHRvIGtlZXBcbiAgICAgICAgICAgIC8vIG9yZGVyIGZvciB0aGUgcGFyZW50cyBvZiB0aGVzZSB0ZXh0cywgYnV0IGJ5IGRvaW5nIHRoaXMsIHdlIGFyZVxuICAgICAgICAgICAgLy8gZm9yY2VkIHRvIHJlc2V0IHRoZSBjb250ZW50LCBhbmltYXRpb25zIG1heSBiZSBsb3N0LlxuICAgICAgICAgICAgdGhpcy5fZGlmZltpZF0uYXNrQ29tcGxldGVSZWRyYXdpbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSBfZ2V0Y2hpbGRyZW5Eb21Ob2RlcyhpZDogRG9tT2JqZWN0SUQpOiBOb2RlW10ge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB0aGlzLl9vYmplY3RzW2lkXTtcbiAgICAgICAgY29uc3QgZG9tTm9kZXM6IE5vZGVbXSA9IFtdO1xuICAgICAgICBjb25zdCB0cmVhdGVkT2JqZWN0OiBEb21PYmplY3RJRFtdID0gW107XG4gICAgICAgIGlmIChvYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGRJZCBvZiBvYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuX29iamVjdHNbY2hpbGRJZF07XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkICYmICF0cmVhdGVkT2JqZWN0LmluY2x1ZGVzKGNoaWxkSWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyZWF0ZWRPYmplY3QucHVzaChjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoaWxkRG9tTm9kZXM6IE5vZGVbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLmRvbS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkRG9tTm9kZXMgPSBjaGlsZC5kb207XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZERvbU5vZGVzID0gdGhpcy5fZ2V0Y2hpbGRyZW5Eb21Ob2RlcyhjaGlsZElkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgY2hpbGREb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb21Ob2Rlcy5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU5vZGVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGVzO1xuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBMYWJlbE5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYWJlbE5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTGFiZWxEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTGFiZWxOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKGxhYmVsOiBMYWJlbE5vZGUpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBvYmplY3RMYWJlbDogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnU1BBTicsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7IGNsYXNzOiBuZXcgU2V0KFsnbGFiZWwnXSkgfSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbeyB0ZXh0OiBsYWJlbC5sYWJlbCB9XSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG9iamVjdExhYmVsO1xuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBMYXlvdXRDb250YWluZXIgfSBmcm9tICcuL0xheW91dENvbnRhaW5lck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTGF5b3V0Q29udGFpbmVyRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IExheW91dENvbnRhaW5lcjtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBMYXlvdXRDb250YWluZXIpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hpbGRyZW46IFsuLi5ub2RlLmNoaWxkVk5vZGVzXSxcbiAgICAgICAgfTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTGF5b3V0Q29udGFpbmVyIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgcmVhZG9ubHkgZWRpdGFibGUgPSBmYWxzZTtcbiAgICByZWFkb25seSBicmVha2FibGUgPSBmYWxzZTtcbn1cbiIsImltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBTZXBhcmF0b3JOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1NlcGFyYXRvck5vZGUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgVG9vbGJhck5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgU2VwYXJhdG9yRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IChub2RlOiBWTm9kZSk6IGJvb2xlYW4gPT5cbiAgICAgICAgbm9kZSBpbnN0YW5jZW9mIFNlcGFyYXRvck5vZGUgJiYgISFub2RlLmFuY2VzdG9yKFRvb2xiYXJOb2RlKTtcblxuICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBvYmplY3RTZXBhcmF0b3I6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgIHRhZzogJ0pXLVNFUEFSQVRPUicsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7IHJvbGU6ICdzZXBhcmF0b3InIH0sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvYmplY3RTZXBhcmF0b3I7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lV29ya2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5cbmV4cG9ydCBjbGFzcyBab25lRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFpvbmVOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IFpvbmVOb2RlLCB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+KTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuKCk7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdDogRG9tT2JqZWN0ID0geyBjaGlsZHJlbjogW10gfTtcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwLCBsZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2luZGV4XTtcbiAgICAgICAgICAgIGlmICghbm9kZS5oaWRkZW4/LltjaGlsZC5pZF0pIHtcbiAgICAgICAgICAgICAgICBkb21PYmplY3QuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhjaGlsZCwgbm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgWm9uZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QnICYmICEhaXRlbS5nZXRBdHRyaWJ1dGUoJ3Qtem9uZScpO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIHJldHVybiBbbmV3IFpvbmVOb2RlKHsgbWFuYWdlZFpvbmVzOiBbaXRlbS5nZXRBdHRyaWJ1dGUoJ3Qtem9uZScpXSB9KV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSW5wdXROb2RlIH0gZnJvbSAnLi8uLi8uLi9wbHVnaW4taW5wdXQvc3JjL0lucHV0Tm9kZSc7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgRm9udFNpemVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vRm9udFNpemVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXQnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tY2hhci9zcmMvQ2hhck5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZvbnRTaXplQ29tbWFuZFBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIHZhbHVlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBGb250U2l6ZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbnB1dF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXIgJiBMYXlvdXQ+ID0ge1xuICAgICAgICByZW5kZXJlcnM6IFtGb250U2l6ZURvbU9iamVjdFJlbmRlcmVyXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnRm9udFNpemVJbnB1dCcsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8SW5wdXROb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgSW5wdXROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dE5hbWU6ICdmb250LXNpemUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiAoZWRpdG9yOiBKV0VkaXRvcik6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnc2V0Rm9udFNpemUnLCB7IHZhbHVlOiBwYXJzZUludChpbnB1dC52YWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtpbnB1dF07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgc2V0Rm9udFNpemU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuc2V0Rm9udFNpemUsXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGZvbnQgc2l6ZSBvZiB0aGUgY29udGV4dCByYW5nZVxuICAgICAqL1xuICAgIHNldEZvbnRTaXplKHBhcmFtczogRm9udFNpemVDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGxldCBub2RlczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBpZiAoIXBhcmFtcy5jb250ZXh0LnJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIG5vZGVzID0gcGFyYW1zLmNvbnRleHQucmFuZ2UudGFyZ2V0ZWROb2RlcyhDaGFyTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGUuc2V0KCdmb250LXNpemUnLCBgJHtwYXJhbXMudmFsdWV9cHhgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IElucHV0RG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuLy4uLy4uL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXREb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBJbnB1dE5vZGUgfSBmcm9tICcuLy4uLy4uL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXROb2RlJztcbmltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWNoYXIvc3JjL0NoYXJOb2RlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IERvbUxheW91dEVuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXRFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgRm9udFNpemVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIElucHV0RG9tT2JqZWN0UmVuZGVyZXIge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSAobm9kZTogVk5vZGUpOiBib29sZWFuID0+XG4gICAgICAgIG5vZGUgaW5zdGFuY2VvZiBJbnB1dE5vZGUgJiYgbm9kZS5pbnB1dE5hbWUgPT09ICdmb250LXNpemUnO1xuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgX29uQ29tbWl0KG5vZGU6IElucHV0Tm9kZSwgaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIuX29uQ29tbWl0KG5vZGUsIGlucHV0KTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5lbmdpbmUuZWRpdG9yO1xuICAgICAgICBjb25zdCByYW5nZSA9IGVkaXRvci5zZWxlY3Rpb24ucmFuZ2U7XG5cbiAgICAgICAgbGV0IG5leHQgPSByYW5nZS5zdGFydC5uZXh0U2libGluZyhDaGFyTm9kZSk7XG4gICAgICAgIGlmIChuZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZW5kIGlzIGJlZm9yZSB0aGUgY2hhck5vZGUsIHRoZSBjaGFyTm9kZSBpcyBub3Qgc2VsZWN0ZWQuXG4gICAgICAgICAgICBjb25zdCBjaGlsZFZOb2RlcyA9IG5leHQucGFyZW50LmNoaWxkVk5vZGVzO1xuICAgICAgICAgICAgbGV0IGluZGV4ID0gY2hpbGRWTm9kZXMuaW5kZXhPZihuZXh0KTtcbiAgICAgICAgICAgIGxldCBzaWJsaW5nOiBWTm9kZTtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleCAmJiAoc2libGluZyA9IGNoaWxkVk5vZGVzW2luZGV4IC0gMV0pICYmIHNpYmxpbmcgIT09IHJhbmdlLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNpYmxpbmcgIT09IHJhbmdlLmVuZCkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBmb250U2l6ZSA9IG5leHQ/Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5zdHlsZT8uZ2V0KCdmb250LXNpemUnKTtcblxuICAgICAgICBpbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgaWYgKGZvbnRTaXplKSB7XG4gICAgICAgICAgICBmb250U2l6ZSA9IHBhcnNlSW50KGZvbnRTaXplLCAxMCkudG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmIChuZXh0KSB7XG4gICAgICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KTtcbiAgICAgICAgICAgIGNvbnN0IGRvbUxheW91dCA9IGxheW91dC5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgICAgICBjb25zdCBmaXJzdERvbU5vZGUgPSBkb21MYXlvdXQuZ2V0RG9tTm9kZXMobmV4dClbMF07XG4gICAgICAgICAgICBsZXQgZmlyc3REb21FbGVtZW50OiBFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGZpcnN0RG9tTm9kZSkge1xuICAgICAgICAgICAgICAgIGZpcnN0RG9tRWxlbWVudCA9XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0RG9tTm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ID8gZmlyc3REb21Ob2RlIDogZmlyc3REb21Ob2RlLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0RG9tRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZSA9IHBhcnNlSW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShmaXJzdERvbUVsZW1lbnQpWydmb250LXNpemUnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDEwLFxuICAgICAgICAgICAgICAgICAgICApLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICBpbnB1dC52YWx1ZSA9IGZvbnRTaXplIHx8ICcnO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IEZvbnRBd2Vzb21lWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9Gb250QXdlc29tZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBGb250QXdlc29tZURvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9Gb250QXdlc29tZURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgRm9udEF3ZXNvbWU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtGb250QXdlc29tZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW0ZvbnRBd2Vzb21lRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBGb250QXdlc29tZU5vZGUgfSBmcm9tICcuL0ZvbnRBd2Vzb21lTm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0RnJhZ21lbnQsXG4gICAgRG9tT2JqZWN0VGV4dCxcbiAgICBEb21PYmplY3RFbGVtZW50LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5jb25zdCB6ZXJvV2lkdGhTcGFjZSA9ICdcXHUyMDBiJztcblxuZXhwb3J0IGNsYXNzIEZvbnRBd2Vzb21lRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IEZvbnRBd2Vzb21lTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihcbiAgICAgICAgbm9kZTogRm9udEF3ZXNvbWVOb2RlLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+LFxuICAgICk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IGZvbnRhd2Vzb21lOiBEb21PYmplY3RFbGVtZW50ID0ge1xuICAgICAgICAgICAgdGFnOiBub2RlLmh0bWxUYWcsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IG5ldyBTZXQobm9kZS5mYUNsYXNzZXMpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgLy8gU3Vycm91bmQgdGhlIGZvbnRhd2Vzb21lIHdpdGggdHdvIGludmlzaWJsZSBjaGFyYWN0ZXJzIHNvIHRoZVxuICAgICAgICAvLyBzZWxlY3Rpb24gY2FuIG5hdmlnYXRlIGFyb3VuZCBpdC5cbiAgICAgICAgY29uc3QgZG9tT2JqZWN0OiBEb21PYmplY3RGcmFnbWVudCA9IHtcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAgLy8gV2UgYXJlIHRhcmdldHRpbmcgdGhlIGludmlzaWJsZSBjaGFyYWN0ZXIgQkVGT1JFIHRoZVxuICAgICAgICAgICAgICAgIC8vIGZvbnRhd2Vzb21lIG5vZGUuXG4gICAgICAgICAgICAgICAgLy8gSWYgb2Zmc2V0IDE6XG4gICAgICAgICAgICAgICAgLy8gTW92aW5nIGZyb20gYmVmb3JlIHRoZSBmb250YXdlc29tZSBub2RlIHRvIGFmdGVyIGl0LlxuICAgICAgICAgICAgICAgIC8vIChET00gaXMgYDxpbnZpc2libGUvPltdPGZvbnRhd2Vzb21lLz48aW52aXNpYmxlLz5gIGJ1dFxuICAgICAgICAgICAgICAgIC8vIHNob3VsZCBiZSBgPGludmlzaWJsZS8+PGZvbnRhd2Vzb21lLz48aW52aXNpYmxlLz5bXWApLlxuICAgICAgICAgICAgICAgIC8vIGVsc2U6XG4gICAgICAgICAgICAgICAgLy8gU3RheSBiZWZvcmUgdGhlIGZvbnRhd2Vzb21lIG5vZGUuXG4gICAgICAgICAgICAgICAgeyB0ZXh0OiB6ZXJvV2lkdGhTcGFjZSB9LFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGFyZSB0YXJnZXR0aW5nIHRoZSBmb250YXdlc29tZSBkaXJlY3R5bGUgdGhlbiBzdGF5XG4gICAgICAgICAgICAgICAgLy8gYmVmb3JlIHRoZSBmb250YXdlc29tZSBub2RlLlxuICAgICAgICAgICAgICAgIGZvbnRhd2Vzb21lLFxuICAgICAgICAgICAgICAgIC8vIFdlIGFyZSB0YXJnZXR0aW5nIHRoZSBpbnZpc2libGUgY2hhcmFjdGVyIEFGVEVSIHRoZVxuICAgICAgICAgICAgICAgIC8vIGZvbnRhd2Vzb21lIG5vZGUuXG4gICAgICAgICAgICAgICAgLy8gSWYgb2Zmc2V0IDA6XG4gICAgICAgICAgICAgICAgLy8gTW92aW5nIGZyb20gYWZ0ZXIgdGhlIGZvbnRhd2Vzb21lIG5vZGUgdG8gYmVmb3JlIGl0LlxuICAgICAgICAgICAgICAgIC8vIChET00gaXMgYDxpbnZpc2libGUvPjxmb250YXdlc29tZS8+W108aW52aXNpYmxlLz5gIGJ1dFxuICAgICAgICAgICAgICAgIC8vIHNob3VsZCBiZSBgW108aW52aXNpYmxlLz48Zm9udGF3ZXNvbWUvPjxpbnZpc2libGUvPmApLlxuICAgICAgICAgICAgICAgIC8vIGVsc2U6XG4gICAgICAgICAgICAgICAgLy8gU3RheSBhZnRlciB0aGUgZm9udGF3ZXNvbWUgbm9kZS5cbiAgICAgICAgICAgICAgICB7IHRleHQ6IHplcm9XaWR0aFNwYWNlIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9O1xuXG4gICAgICAgIHdvcmtlci5sb2NhdGUoW25vZGVdLCBkb21PYmplY3QuY2hpbGRyZW5bMF0gYXMgRG9tT2JqZWN0VGV4dCk7XG4gICAgICAgIHdvcmtlci5sb2NhdGUoW25vZGVdLCBmb250YXdlc29tZSk7XG4gICAgICAgIHdvcmtlci5sb2NhdGUoW25vZGVdLCBkb21PYmplY3QuY2hpbGRyZW5bMl0gYXMgRG9tT2JqZWN0VGV4dCk7XG5cbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGVQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBGb250QXdlc29tZU5vZGVQYXJhbXMgZXh0ZW5kcyBBYnN0cmFjdE5vZGVQYXJhbXMge1xuICAgIGh0bWxUYWc6IHN0cmluZztcbiAgICBmYUNsYXNzZXM6IHN0cmluZ1tdO1xufVxuZXhwb3J0IGNsYXNzIEZvbnRBd2Vzb21lTm9kZSBleHRlbmRzIElubGluZU5vZGUge1xuICAgIHN0YXRpYyByZWFkb25seSBhdG9taWMgPSB0cnVlO1xuICAgIGh0bWxUYWc6IHN0cmluZztcbiAgICBmYUNsYXNzZXM6IHN0cmluZ1tdO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogRm9udEF3ZXNvbWVOb2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKHBhcmFtcyk7XG4gICAgICAgIHRoaXMuaHRtbFRhZyA9IHBhcmFtcy5odG1sVGFnO1xuICAgICAgICB0aGlzLmZhQ2xhc3NlcyA9IHBhcmFtcy5mYUNsYXNzZXM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRm9udEF3ZXNvbWVOb2RlIH0gZnJvbSAnLi9Gb250QXdlc29tZU5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBWZXJzaW9uYWJsZUFycmF5IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlQXJyYXknO1xuXG5leHBvcnQgY29uc3QgRm9udEF3ZXNvbWVSZWdleCA9IC8oPzpefFxcc3xcXG4pKGZhW2JkbHJzXT8pKD86LnxcXG4pKj8oZmEtLio/KSg/Olxcc3xcXG58JCkvO1xuXG5leHBvcnQgY2xhc3MgRm9udEF3ZXNvbWVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gRm9udEF3ZXNvbWVYbWxEb21QYXJzZXIuaXNGb250QXdlc29tZShpdGVtKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Rm9udEF3ZXNvbWVOb2RlW10+IHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgLy8gUmVtb3ZlIGZhIGNsYXNzZXMgdG8gYXZvaWQgaGF2aW5nIHRoZW0gc3ByZWFkIHRvIG5lYXJieSBub2Rlcy5cbiAgICAgICAgLy8gVGhleSB3aWxsIGJlIHB1dCBiYWNrIGF0IHJlbmRlcm5nIHRpbWUuXG4gICAgICAgIGNvbnN0IGZhQ2xhc3NlcyA9IGl0ZW0uY2xhc3NOYW1lLm1hdGNoKEZvbnRBd2Vzb21lUmVnZXgpLnNsaWNlKDEpO1xuICAgICAgICBjb25zdCBmb250YXdlc29tZSA9IG5ldyBGb250QXdlc29tZU5vZGUoe1xuICAgICAgICAgICAgaHRtbFRhZzogbm9kZU5hbWUoaXRlbSksXG4gICAgICAgICAgICBmYUNsYXNzZXM6IG5ldyBWZXJzaW9uYWJsZUFycmF5KC4uLmZhQ2xhc3NlcyksXG4gICAgICAgIH0pO1xuICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzTGlzdC5yZW1vdmUoLi4uZmFDbGFzc2VzKTtcbiAgICAgICAgLy8gS2VlcCB0aGUgYXR0cmlidXRlcyBldmVuIHRob3VnaCBpdCBtaWdodCBiZSBlbXB0eSBhcyBpdCB3aWxsIGJlIHVzZWRcbiAgICAgICAgLy8gdG8gcmVzdG9yZSB0aGUgcHJvcGVyIG9yZGVyIG9mIGNsYXNzZXMuXG4gICAgICAgIGZvbnRhd2Vzb21lLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIHJldHVybiBbZm9udGF3ZXNvbWVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBET00gbm9kZSBpcyBhIGZvbnRhd2Vzb21lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBzdGF0aWMgaXNGb250QXdlc29tZShpdGVtOiBOb2RlKTogaXRlbSBpcyBFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIEZvbnRBd2Vzb21lUmVnZXgudGVzdChpdGVtLmNsYXNzTmFtZSk7XG4gICAgfVxufVxuIiwidmFyIGFwaSA9IHJlcXVpcmUoXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL0Z1bGxzY3JlZW4uY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsImltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgRnVsbHNjcmVlbkJ1dHRvbkRvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9GdWxsc2NyZWVuQnV0dG9uRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgQ29tcG9uZW50SWQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmludGVyZmFjZSBGdWxsc2NyZWVuQ29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIGNvbXBvbmVudD86IENvbXBvbmVudElkO1xufVxuXG5leHBvcnQgY2xhc3MgRnVsbHNjcmVlbjxUIGV4dGVuZHMgRnVsbHNjcmVlbkNvbmZpZyA9IEZ1bGxzY3JlZW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFJlbmRlcmVyICYgTGF5b3V0PiA9IHtcbiAgICAgICAgcmVuZGVyZXJzOiBbRnVsbHNjcmVlbkJ1dHRvbkRvbU9iamVjdFJlbmRlcmVyXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnRnVsbHNjcmVlbkJ1dHRvbicsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBhc3luYyAoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnZnVsbHNjcmVlbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1RvZ2dsZSBGdWxsc2NyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoKTogYm9vbGVhbiA9PiB0aGlzLmlzRnVsbHNjcmVlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYXMgZmEtZXhwYW5kIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydGdWxsc2NyZWVuQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXV0sXG4gICAgfTtcbiAgICBpc0Z1bGxzY3JlZW4gPSBmYWxzZTtcbn1cbiIsImltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5cbmltcG9ydCAnLi4vYXNzZXRzL0Z1bGxzY3JlZW4uY3NzJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IEZ1bGxzY3JlZW4gfSBmcm9tICcuL0Z1bGxzY3JlZW4nO1xuaW1wb3J0IHsgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBEb21PYmplY3RBY3Rpb25hYmxlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0FjdGlvbmFibGVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuZXhwb3J0IGNsYXNzIEZ1bGxzY3JlZW5CdXR0b25Eb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PlxuICAgICAgICBub2RlIGluc3RhbmNlb2YgQWN0aW9uYWJsZU5vZGUgJiYgbm9kZS5hY3Rpb25OYW1lID09PSAnZnVsbHNjcmVlbic7XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIEZ1bGxzY3JlZW5Ob2RlLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihcbiAgICAgICAgYnV0dG9uOiBBY3Rpb25hYmxlTm9kZSxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBQcm9taXNlPERvbU9iamVjdEFjdGlvbmFibGU+IHtcbiAgICAgICAgY29uc3QgZG9tT2JqZWN0ID0gKGF3YWl0IHRoaXMuc3VwZXIucmVuZGVyKGJ1dHRvbiwgd29ya2VyKSkgYXMgRG9tT2JqZWN0QWN0aW9uYWJsZTtcbiAgICAgICAgY29uc3QgZnVsbHNjcmVlblBsdWdpbiA9IHRoaXMuZW5naW5lLmVkaXRvci5wbHVnaW5zLmdldChGdWxsc2NyZWVuKTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lc1xuICAgICAgICAgICAgLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG5cbiAgICAgICAgbGV0IGVsQnV0dG9uOiBFbGVtZW50O1xuICAgICAgICBkb21PYmplY3QuaGFuZGxlciA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIC8vIG9ubHkgb25lIGNvbXBvbmVudCBjYW4gYmUgZGlzcGxheSBpbiBmdWxsc2NyZWVuXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPVxuICAgICAgICAgICAgICAgIGRvbUxheW91dEVuZ2luZS5jb21wb25lbnRzW2Z1bGxzY3JlZW5QbHVnaW4uY29uZmlndXJhdGlvbi5jb21wb25lbnRdPy5bMF07XG5cbiAgICAgICAgICAgIGlmIChjb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBvbmx5IG9uZSBlbGVtZW50IGNhbiBiZSBkaXNwbGF5IGluIGZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9tTGF5b3V0RW5naW5lLmdldERvbU5vZGVzKGNvbXBvbmVudClbMF07XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmdWxsc2NyZWVuUGx1Z2luLmlzRnVsbHNjcmVlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqdy1mdWxsc2NyZWVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwcmVzc2VkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtcHJlc3NlZCcsICdmYWxzZScpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlblBsdWdpbi5pc0Z1bGxzY3JlZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdqdy1mdWxsc2NyZWVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2p3LWZ1bGxzY3JlZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3ByZXNzZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgncmVzaXplJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZ1bGxzY3JlZW5QbHVnaW4uaXNGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlblBsdWdpbi5pc0Z1bGxzY3JlZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2p3LWZ1bGxzY3JlZW4nKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3Jlc2l6ZScpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgYXR0YWNoID0gZG9tT2JqZWN0LmF0dGFjaDtcbiAgICAgICAgLy8gVE9ETzogUmVwbGFjZSB0aGVzZSBoYW5kbGVycyBieSBhIGBzdG9wYCBtZWNoYW5pc20gZm9yIHJlbmRlcmVycy5cbiAgICAgICAgZG9tT2JqZWN0LmF0dGFjaCA9IGZ1bmN0aW9uKGVsOiBFbGVtZW50KTogdm9pZCB7XG4gICAgICAgICAgICBlbEJ1dHRvbiA9IGVsO1xuICAgICAgICAgICAgYXR0YWNoLmNhbGwodGhpcywgZWwpO1xuICAgICAgICAgICAgaWYgKGZ1bGxzY3JlZW5QbHVnaW4uaXNGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdqdy1mdWxsc2NyZWVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRldGFjaCA9IGRvbU9iamVjdC5kZXRhY2g7XG4gICAgICAgIC8vIFRPRE86IFJlcGxhY2UgdGhlc2UgaGFuZGxlcnMgYnkgYSBgc3RvcGAgbWVjaGFuaXNtIGZvciByZW5kZXJlcnMuXG4gICAgICAgIGRvbU9iamVjdC5kZXRhY2ggPSBmdW5jdGlvbihlbDogRWxlbWVudCk6IHZvaWQge1xuICAgICAgICAgICAgZWxCdXR0b24gPSBudWxsO1xuICAgICAgICAgICAgZGV0YWNoLmNhbGwodGhpcywgZWwpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdqdy1mdWxsc2NyZWVuJyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkb21PYmplY3Q7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSGVhZGluZ1htbERvbVBhcnNlciB9IGZyb20gJy4vSGVhZGluZ1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBIZWFkaW5nTm9kZSB9IGZyb20gJy4vSGVhZGluZ05vZGUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgQ2hlY2tpbmdDb250ZXh0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvQ29udGV4dE1hbmFnZXInO1xuaW1wb3J0IHsgSW5zZXJ0UGFyYWdyYXBoQnJlYWtQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBDb21wb25lbnREZWZpbml0aW9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IFJ1bGVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEhlYWRpbmdQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICBsZXZlbDogbnVtYmVyO1xufVxuXG5mdW5jdGlvbiBoZWFkaW5nQnV0dG9uKGxldmVsOiBudW1iZXIpOiBDb21wb25lbnREZWZpbml0aW9uIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpZDogJ0hlYWRpbmcnICsgbGV2ZWwgKyAnQnV0dG9uJyxcbiAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnaGVhZGluZycgKyBsZXZlbCxcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0hlYWRpbmcnICsgbGV2ZWwsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYXBwbHlIZWFkaW5nU3R5bGUnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IGxldmVsOiBsZXZlbCB9IGFzIEhlYWRpbmdQYXJhbXMsXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJc0hlYWRpbmcgPSByYW5nZS5zdGFydC5jbG9zZXN0KEhlYWRpbmdOb2RlKT8ubGV2ZWwgPT09IGxldmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0SXNIZWFkaW5nIHx8IHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydElzSGVhZGluZztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByYW5nZS5lbmQuY2xvc2VzdChIZWFkaW5nTm9kZSk/LmxldmVsID09PSBsZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2gnICsgbGV2ZWwgfSldLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIEhlYWRpbmc8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBhcHBseUhlYWRpbmdTdHlsZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hcHBseUhlYWRpbmdTdHlsZSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWs6IHtcbiAgICAgICAgICAgIHNlbGVjdG9yOiBbXG4gICAgICAgICAgICAgICAgKG5vZGUpOiBib29sZWFuID0+XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBIZWFkaW5nTm9kZSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5tb2RlLmlzKG5vZGUsIFJ1bGVQcm9wZXJ0eS5CUkVBS0FCTEUpLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGNoZWNrOiAoY29udGV4dDogQ2hlY2tpbmdDb250ZXh0KTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBjb250ZXh0LnJhbmdlO1xuICAgICAgICAgICAgICAgIHJldHVybiByYW5nZS5pc0NvbGxhcHNlZCgpICYmICFyYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0UGFyYWdyYXBoQnJlYWssXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBLZXltYXAgJiBMYXlvdXQ+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbSGVhZGluZ1htbERvbVBhcnNlcl0sXG4gICAgICAgIHNob3J0Y3V0czogWzAsIDEsIDIsIDMsIDQsIDUsIDZdLm1hcChsZXZlbCA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxEaWdpdCcgKyBsZXZlbCArICc+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhcHBseUhlYWRpbmdTdHlsZScsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgbGV2ZWw6IGxldmVsIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnUGFyYWdyYXBoQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAncGFyYWdyYXBoJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnUGFyYWdyYXBoJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FwcGx5SGVhZGluZ1N0eWxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IGxldmVsOiAwIH0gYXMgSGVhZGluZ1BhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2Uuc3RhcnQucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0SXNEZWZhdWx0ID0gISFyYW5nZS5zdGFydC5jbG9zZXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvciBpbnN0YW5jZW9mIGVkaXRvci5jb25maWd1cmF0aW9uLmRlZmF1bHRzLkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydElzRGVmYXVsdCB8fCByYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnRJc0RlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFyYW5nZS5lbmQuY2xvc2VzdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvciA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvciBpbnN0YW5jZW9mXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5jb25maWd1cmF0aW9uLmRlZmF1bHRzLkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ3AnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC4uLlsxLCAyLCAzLCA0LCA1LCA2XS5tYXAoaGVhZGluZ0J1dHRvbiksXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbXG4gICAgICAgICAgICBbJ1BhcmFncmFwaEJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ0hlYWRpbmcxQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgICAgIFsnSGVhZGluZzJCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICAgICAgWydIZWFkaW5nM0J1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ0hlYWRpbmc0QnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgICAgIFsnSGVhZGluZzVCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICAgICAgWydIZWFkaW5nNkJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgIF0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIGZvcm1hdHRpbmcgb2YgdGhlIG5vZGVzIGluIGdpdmVuIHJhbmdlIHRvIEhlYWRpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXBwbHlIZWFkaW5nU3R5bGUocGFyYW1zOiBIZWFkaW5nUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKENvbnRhaW5lck5vZGUpKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gdGhpcy5fY3JlYXRlSGVhZGluZ0NvbnRhaW5lcihwYXJhbXMubGV2ZWwpO1xuICAgICAgICAgICAgaGVhZGluZy5tb2RpZmllcnMgPSBub2RlLm1vZGlmaWVycy5jbG9uZSgpO1xuICAgICAgICAgICAgbm9kZS5yZXBsYWNlV2l0aChoZWFkaW5nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluc2VydGluZyBhIHBhcmFncmFwaCBicmVhayBhdCB0aGUgZW5kIG9mIGEgaGVhZGluZyBleGl0cyB0aGUgaGVhZGluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBpbnNlcnRQYXJhZ3JhcGhCcmVhayhwYXJhbXM6IEluc2VydFBhcmFncmFwaEJyZWFrUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGhlYWRpbmcgPSByYW5nZS50YXJnZXRlZE5vZGVzKEhlYWRpbmdOb2RlKVswXTtcbiAgICAgICAgY29uc3QgZHVwbGljYXRlID0gaGVhZGluZy5zcGxpdEF0KHJhbmdlLnN0YXJ0KTtcbiAgICAgICAgY29uc3QgbmV3Q29udGFpbmVyID0gbmV3IHRoaXMuZWRpdG9yLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMuQ29udGFpbmVyKCk7XG4gICAgICAgIGR1cGxpY2F0ZS5yZXBsYWNlV2l0aChuZXdDb250YWluZXIpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgaGVhZGluZyBub2RlIG9yIGEgYmFzZSBjb250YWluZXIgYmFzZWQgb24gdGhlIGdpdmVuIGxldmVsLlxuICAgICAqXG4gICAgICogQHBhcmFtIGxldmVsXG4gICAgICovXG4gICAgX2NyZWF0ZUhlYWRpbmdDb250YWluZXIobGV2ZWw6IG51bWJlcik6IFZOb2RlIHtcbiAgICAgICAgaWYgKGxldmVsID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuZWRpdG9yLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMuQ29udGFpbmVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEhlYWRpbmdOb2RlKHsgbGV2ZWw6IGxldmVsIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgSGVhZGluZ05vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgbGV2ZWw6IG51bWJlcjtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IHsgbGV2ZWw6IG51bWJlciB9KSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0gnICsgcGFyYW1zLmxldmVsIH0pO1xuICAgICAgICB0aGlzLmxldmVsID0gcGFyYW1zLmxldmVsO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLmxldmVsO1xuICAgIH1cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBkZWZhdWx0czogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBIZWFkaW5nTm9kZT5bMF0gPSB7XG4gICAgICAgICAgICBsZXZlbDogdGhpcy5sZXZlbCxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb25lKGRlZXBDbG9uZSwgeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEhlYWRpbmdOb2RlIH0gZnJvbSAnLi9IZWFkaW5nTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuY29uc3QgSGVhZGluZ1RhZ3MgPSBbJ0gxJywgJ0gyJywgJ0gzJywgJ0g0JywgJ0g1JywgJ0g2J107XG5cbmV4cG9ydCBjbGFzcyBIZWFkaW5nWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIEhlYWRpbmdUYWdzLmluY2x1ZGVzKG5vZGVOYW1lKGl0ZW0pKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8SGVhZGluZ05vZGVbXT4ge1xuICAgICAgICBjb25zdCBoZWFkaW5nID0gbmV3IEhlYWRpbmdOb2RlKHsgbGV2ZWw6IHBhcnNlSW50KG5vZGVOYW1lKGl0ZW0pWzFdLCAxMCkgfSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgaGVhZGluZy5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgaGVhZGluZy5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2hlYWRpbmddO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IEpXRWRpdG9yLCBMb2FkYWJsZXMsIENvbW1pdFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBIaXN0b3J5PFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxLZXltYXAgJiBMYXlvdXQ+ID0ge1xuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtaJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bmRvJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrWicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAncmVkbycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1knLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3JlZG8nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnVW5kb0J1dHRvbicsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBhc3luYyAoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAndW5kbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0hpc3RvcnkgdW5kbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bmRvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6ICgpOiBib29sZWFuID0+IHRoaXMuX21lbW9yeVN0ZXAgPiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLXVuZG8gZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ1JlZG9CdXR0b24nLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogYXN5bmMgKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4gPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3JlZG8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdIaXN0b3J5IHJlZG8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAncmVkbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiAoKTogYm9vbGVhbiA9PiB0aGlzLl9tZW1vcnlLZXlzLmxlbmd0aCAtIDEgPiB0aGlzLl9tZW1vcnlTdGVwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLXJlZG8gZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtcbiAgICAgICAgICAgIFsnVW5kb0J1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ1JlZG9CdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICBdLFxuICAgIH07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIHVuZG86IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMudW5kbyxcbiAgICAgICAgfSxcbiAgICAgICAgcmVkbzoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5yZWRvLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgY29tbWFuZEhvb2tzID0ge1xuICAgICAgICAnQGNvbW1pdCc6IHRoaXMuX3JlZ2lzdGVyTWVtb3J5S2V5LFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcihlZGl0b3I6IEpXRWRpdG9yKSB7XG4gICAgICAgIHN1cGVyKGVkaXRvcik7XG4gICAgICAgIHRoaXMubG9hZGFibGVzLmNvbXBvbmVudHMucHVzaCgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX21lbW9yeUtleXM6IHN0cmluZ1tdID0gW107XG4gICAgcHJpdmF0ZSBfbWVtb3J5Q29tbWFuZHM6IHN0cmluZ1tdW10gPSBbXTtcbiAgICBwcml2YXRlIF9tZW1vcnlTdGVwID0gLTE7XG5cbiAgICB1bmRvKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9tZW1vcnlTdGVwLS07XG4gICAgICAgIGlmICh0aGlzLl9tZW1vcnlTdGVwIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fbWVtb3J5U3RlcCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lZGl0b3IubWVtb3J5LnN3aXRjaFRvKHRoaXMuX21lbW9yeUtleXNbdGhpcy5fbWVtb3J5U3RlcF0pO1xuICAgIH1cbiAgICByZWRvKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9tZW1vcnlTdGVwKys7XG4gICAgICAgIGNvbnN0IG1heCA9IHRoaXMuX21lbW9yeUtleXMubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKHRoaXMuX21lbW9yeVN0ZXAgPiBtYXgpIHtcbiAgICAgICAgICAgIHRoaXMuX21lbW9yeVN0ZXAgPSBtYXg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lZGl0b3IubWVtb3J5LnN3aXRjaFRvKHRoaXMuX21lbW9yeUtleXNbdGhpcy5fbWVtb3J5U3RlcF0pO1xuICAgIH1cbiAgICBwcml2YXRlIF9yZWdpc3Rlck1lbW9yeUtleShjb21taXRQYXJhbXM6IENvbW1pdFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBzbGljZUtleSA9IHRoaXMuZWRpdG9yLm1lbW9yeS5zbGljZUtleTtcbiAgICAgICAgaWYgKCF0aGlzLl9tZW1vcnlLZXlzLmluY2x1ZGVzKHNsaWNlS2V5KSkge1xuICAgICAgICAgICAgY29uc3QgY29tbWFuZHMgPSBjb21taXRQYXJhbXMuY29tbWFuZE5hbWVzO1xuICAgICAgICAgICAgaWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMSAmJiBjb21tYW5kc1swXSA9PT0gJ3NldFNlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVtb3J5U3RlcCA+IHRoaXMuX21lbW9yeUtleXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBZnRlciBhbiB1bmRvLCBkb24ndCByZXBsYWNlIGhpc3RvcnkgZm9yIHNldFNlbGVjdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2Q29tbWFuZCA9IHRoaXMuX21lbW9yeUNvbW1hbmRzW3RoaXMuX21lbW9yeVN0ZXBdO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2Q29tbWFuZCAmJiBwcmV2Q29tbWFuZC5sZW5ndGggPT09IDEgJiYgcHJldkNvbW1hbmRbMF0gPT09ICdzZXRTZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENvbmNhdCBzZXRTZWxlY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lbW9yeUtleXNbdGhpcy5fbWVtb3J5U3RlcF0gPSBzbGljZUtleTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0b3IubWVtb3J5SW5mby51aUNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9tZW1vcnlTdGVwKys7XG4gICAgICAgICAgICB0aGlzLl9tZW1vcnlLZXlzLnNwbGljZSh0aGlzLl9tZW1vcnlTdGVwLCBJbmZpbml0eSwgc2xpY2VLZXkpO1xuICAgICAgICAgICAgdGhpcy5fbWVtb3J5Q29tbWFuZHMuc3BsaWNlKHRoaXMuX21lbW9yeVN0ZXAsIEluZmluaXR5LCBbLi4uY29tbWFuZHNdKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IE1vZGlmaWVyUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL01vZGlmaWVyUmVuZGVyZXInO1xuaW1wb3J0IHsgTW9kaWZpZXIgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcic7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIERlZmF1bHRIdG1sRG9tTW9kaWZpZXJSZW5kZXJlciBleHRlbmRzIE1vZGlmaWVyUmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gJ2RvbS9odG1sJztcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG5cbiAgICAvKipcbiAgICAgKiBEZWZhdWx0IHJlbmRlcmluZyBmb3IgRm9ybWF0LlxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICogQHBhcmFtIGNvbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKG1vZGlmaWVyOiBNb2RpZmllciwgY29udGVudHM6IE5vZGVbXVtdKTogUHJvbWlzZTxOb2RlW11bXT4ge1xuICAgICAgICByZXR1cm4gY29udGVudHM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4vSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuXG5leHBvcnQgY2xhc3MgRGVmYXVsdEh0bWxEb21SZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSAnZG9tL2h0bWwnO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBWTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KFJlbmRlcmVyKTtcbiAgICAgICAgY29uc3Qgb2JqZWN0RW5naW5lID0gcmVuZGVyZXIuZW5naW5lc1snZG9tL29iamVjdCddIGFzIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCBvYmplY3RFbmdpbmUucmVuZGVyKFtub2RlXSk7XG4gICAgICAgIGNvbnN0IGRvbU5vZGVzOiBOb2RlW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBbLCBkb21PYmplY3RdIG9mIGNhY2hlLnJlbmRlcmluZ3MpIHtcbiAgICAgICAgICAgIGF3YWl0IG9iamVjdEVuZ2luZS5yZXNvbHZlQ2hpbGRyZW4oZG9tT2JqZWN0LCBjYWNoZS53b3JrZXIpO1xuICAgICAgICAgICAgY29uc3QgZG9tTm9kZSA9IHRoaXMuX29iamVjdFRvRG9tKGRvbU9iamVjdCk7XG4gICAgICAgICAgICBpZiAoZG9tTm9kZSBpbnN0YW5jZW9mIERvY3VtZW50RnJhZ21lbnQpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2Rlcy5wdXNoKC4uLmRvbU5vZGUuY2hpbGROb2Rlcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRvbU5vZGVzLnB1c2goZG9tTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGVzO1xuICAgIH1cbiAgICBwcml2YXRlIF9vYmplY3RUb0RvbShkb21PYmplY3Q6IERvbU9iamVjdCk6IE5vZGUge1xuICAgICAgICBsZXQgZG9tTm9kZTogTm9kZTtcbiAgICAgICAgaWYgKCd0YWcnIGluIGRvbU9iamVjdCkge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZG9tT2JqZWN0LnRhZyk7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZG9tT2JqZWN0LmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R5bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMuc3R5bGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoc3R5bGVOYW1lID0+IGAke3N0eWxlTmFtZX06ICR7YXR0cmlidXRlcy5zdHlsZVtzdHlsZU5hbWVdfTtgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbignJyksXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsYXNzTGlzdCA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvbU9iamVjdC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZG9tT2JqZWN0LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9vYmplY3RUb0RvbShjaGlsZCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSW1wbGVtZW50IGF0dGFjaCAmIGRldGFjaDogZG9tT2JqZWN0IGludG8gaHRtbC5cbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGV0YWNoJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIFsuLi5lbGVtZW50LmNoaWxkcmVuXS5mb3JFYWNoKGNoaWxkRWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkRWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnZGV0YWNoJykpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChkb21PYmplY3QuZGV0YWNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbU9iamVjdC5kZXRhY2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoZG9tT2JqZWN0LmF0dGFjaCkge1xuICAgICAgICAgICAgICAgIGRvbU9iamVjdC5hdHRhY2goZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb21Ob2RlID0gZWxlbWVudDtcbiAgICAgICAgfSBlbHNlIGlmICgndGV4dCcgaW4gZG9tT2JqZWN0KSB7XG4gICAgICAgICAgICBkb21Ob2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZG9tT2JqZWN0LnRleHQpO1xuICAgICAgICB9IGVsc2UgaWYgKCdjaGlsZHJlbicgaW4gZG9tT2JqZWN0KSB7XG4gICAgICAgICAgICBkb21Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBkb21PYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tTm9kZS5hcHBlbmRDaGlsZCh0aGlzLl9vYmplY3RUb0RvbShjaGlsZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tT2JqZWN0LmRvbSkge1xuICAgICAgICAgICAgICAgIGRvbU5vZGUuYXBwZW5kQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgSHRtbFRleHRQYXJzaW5nRW5naW5lIH0gZnJvbSAnLi9IdG1sVGV4dFBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuXG5jb25zdCBhdXRvQ2xvc2VSZWdFeHAgPSAvKDwoYXJlYXxiYXNlfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8a2V5Z2VufGxpbmt8bWV0YXxwYXJhbXxzb3VyY2V8dHJhY2t8d2JyKVtePl0qW14vXSk+L2dpO1xuXG5leHBvcnQgY2xhc3MgRGVmYXVsdEh0bWxUZXh0UGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8c3RyaW5nPiB7XG4gICAgc3RhdGljIGlkID0gJ3RleHQvaHRtbCc7XG4gICAgZW5naW5lOiBIdG1sVGV4dFBhcnNpbmdFbmdpbmU7XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBzdHJpbmcpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgZG9tUGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IGl0ZW0ucmVwbGFjZShhdXRvQ2xvc2VSZWdFeHAsICckMS8+Jyk7XG4gICAgICAgIGNvbnN0IHhtbERvYyA9IGRvbVBhcnNlci5wYXJzZUZyb21TdHJpbmcoJzx0PicgKyB0ZW1wbGF0ZSArICc8L3Q+JywgJ3RleHQveG1sJyk7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IHRoaXMuZW5naW5lLmVkaXRvci5wbHVnaW5zLmdldChQYXJzZXIpO1xuICAgICAgICByZXR1cm4gcGFyc2VyLnBhcnNlKCdkb20veG1sJywgLi4ueG1sRG9jLmZpcnN0Q2hpbGQuY2hpbGROb2Rlcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBIdG1sVGV4dFBhcnNpbmdFbmdpbmUgfSBmcm9tICcuL0h0bWxUZXh0UGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBIdG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4vSHRtbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgWG1sIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sJztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgSHRtbEh0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vSHRtbE5vZGVEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBIdG1sPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW1BhcnNlciwgRG9tT2JqZWN0UmVuZGVyZXIsIFhtbF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzaW5nRW5naW5lczogW0h0bWxEb21QYXJzaW5nRW5naW5lLCBIdG1sVGV4dFBhcnNpbmdFbmdpbmVdLFxuICAgICAgICByZW5kZXJpbmdFbmdpbmVzOiBbSHRtbERvbVJlbmRlcmluZ0VuZ2luZV0sXG4gICAgICAgIHJlbmRlcmVyczogW0h0bWxIdG1sRG9tUmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBQYXJzaW5nSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNpbmdFbmdpbmUnO1xuXG5leHBvcnQgdHlwZSBIdG1sTm9kZSA9IEhUTUxFbGVtZW50IHwgQ2hhcmFjdGVyRGF0YTtcblxuZXhwb3J0IGNsYXNzIEh0bWxEb21QYXJzaW5nRW5naW5lPFQgZXh0ZW5kcyBIdG1sTm9kZSA9IEh0bWxOb2RlPiBleHRlbmRzIFhtbERvbVBhcnNpbmdFbmdpbmU8VD4ge1xuICAgIHN0YXRpYyByZWFkb25seSBpZDogUGFyc2luZ0lkZW50aWZpZXIgPSAnZG9tL2h0bWwnO1xuICAgIHN0YXRpYyBleHRlbmRzID0gWydkb20veG1sJ107XG59XG4iLCJpbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBEZWZhdWx0SHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9EZWZhdWx0SHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IERlZmF1bHRIdG1sRG9tTW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4vRGVmYXVsdEh0bWxEb21Nb2RpZmllclJlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgZXh0ZW5kcyBSZW5kZXJpbmdFbmdpbmU8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gJ2RvbS9odG1sJztcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdFJlbmRlcmVyID0gRGVmYXVsdEh0bWxEb21SZW5kZXJlcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdE1vZGlmaWVyUmVuZGVyZXIgPSBEZWZhdWx0SHRtbERvbU1vZGlmaWVyUmVuZGVyZXI7XG59XG4iLCJpbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0F0b21pY05vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEh0bWxOb2RlUGFyYW1zIHtcbiAgICBkb21Ob2RlOiAoKSA9PiBOb2RlO1xufVxuXG5leHBvcnQgY2xhc3MgSHRtbE5vZGUgZXh0ZW5kcyBBdG9taWNOb2RlIHtcbiAgICBkb21Ob2RlOiAoKSA9PiBOb2RlO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogSHRtbE5vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5kb21Ob2RlID0gcGFyYW1zLmRvbU5vZGU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgSHRtbE5vZGUgfSBmcm9tICcuL0h0bWxOb2RlJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBIdG1sSHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBIdG1sTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBIdG1sTm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdDogRG9tT2JqZWN0ID0geyBkb206IFtub2RlLmRvbU5vZGUoKV0gfTtcbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBEZWZhdWx0SHRtbFRleHRQYXJzZXIgfSBmcm9tICcuL0RlZmF1bHRIdG1sVGV4dFBhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBIdG1sVGV4dFBhcnNpbmdFbmdpbmUgZXh0ZW5kcyBQYXJzaW5nRW5naW5lPHN0cmluZz4ge1xuICAgIHN0YXRpYyByZWFkb25seSBpZCA9ICd0ZXh0L2h0bWwnO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UGFyc2VyID0gRGVmYXVsdEh0bWxUZXh0UGFyc2VyO1xufVxuIiwiaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBJZnJhbWVIdG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9JZnJhbWVIdG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IElmcmFtZVhtbERvbVBhcnNlciB9IGZyb20gJy4vSWZyYW1lWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IElmcmFtZURvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9JZnJhbWVEb21PYmplY3RSZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBJZnJhbWU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbUGFyc2VyLCBSZW5kZXJlcl07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbSWZyYW1lWG1sRG9tUGFyc2VyLCBJZnJhbWVIdG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbSWZyYW1lRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgSWZyYW1lTm9kZSB9IGZyb20gJy4vSWZyYW1lTm9kZSc7XG5pbXBvcnQgeyBNZXRhZGF0YU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBJZnJhbWVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gSWZyYW1lTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihpZnJhbWVOb2RlOiBJZnJhbWVOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgbGV0IG9ubG9hZDogKCkgPT4gdm9pZDtcbiAgICAgICAgY29uc3QgY2hpbGRyZW46IFZOb2RlW10gPSBbXTtcbiAgICAgICAgaWZyYW1lTm9kZS5jaGlsZFZOb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIGlmIChjaGlsZC50YW5naWJsZSB8fCBjaGlsZCBpbnN0YW5jZW9mIE1ldGFkYXRhTm9kZSkge1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHdyYXA6IEhUTUxFbGVtZW50O1xuICAgICAgICBjb25zdCBkb21PYmplY3Q6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0YWc6ICdKVy1JRlJBTUUnLFxuICAgICAgICAgICAgICAgICAgICBzaGFkb3dSb290OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRhZzogJ0lGUkFNRScsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbiBub3QgdXNlIHRoZSBkZWZhdWx0IGhyZWYgbG9hZGluZyBpbiB0ZXN0aW5nIG1vZGUgYmVjYXVzZSB0aGUgcG9ydCBpc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlZCBmb3IgdGhlIGxvZywgYW5kIHRoZSBpZnJhbWUgYXJlIG5ldmVyIGxvYWRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgd2luZG93LmxvY2F0aW9uLmhyZWYgdG8ga2VlcCBzdHlsZSwgbGluayBhbmQgbWV0YSB0byBsb2FkIHNvbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgbGlrZSB0aGUgZm9udC1mYWNlLiBUaGUgc3R5bGUgYXJlIG5vdCByZWFsbHkgdXNlZCBpbnRvIHRoZSBzaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnRhaW5lciBidXQgd2UgbmVlZCB0aGUgcmVhbCB1cmwgdG8gbG9hZCBmb250LWZhY2Ugd2l0aCByZWxhdGl2ZSBwYXRoLlxuICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBpZnJhbWVOb2RlLnNyYyB8fCB3aW5kb3cubG9jYXRpb24uaHJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdqdy1kZXZpY2UnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRhY2g6IChpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2ID0gaWZyYW1lLnByZXZpb3VzRWxlbWVudFNpYmxpbmcgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU5hbWUocHJldikgPT09ICdKVy1JRlJBTUUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdyYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcC5yZXBsYWNlV2l0aChwcmV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXAgPSBwcmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWZyYW1lTm9kZS5zcmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmxvYWQgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ1YmJsZXMgdXAgdGhlIGxvYWQtaWZyYW1lIGV2ZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbG9hZC1pZnJhbWUnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9zZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBvbmxvYWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gbG9hZFdpdGhQcmVsb2FkZWRNZXRhKCk6IHZvaWQge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYWxsIHNjcmlwdHMsIGtlZXAgc3R5bGUsIGxpbmsgYW5kIG1ldGEgdG8gbG9hZCBzb21lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgbGlrZSB0aGUgZm9udC1mYWNlLiBUaGUgc3R5bGUgYXJlIG5vdCB1c2VkIGludG8gdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNoYWRvdyBjb250YWluZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZnJhbWUucHJldmlvdXNFbGVtZW50U2libGluZyAhPT0gd3JhcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9jID0gaWZyYW1lLmNvbnRlbnRXaW5kb3c/LmRvY3VtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYyAmJiAoZG9jLmhlYWQgfHwgZG9jLmJvZHkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtZXRhIG9mIHdyYXAuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R5bGUsIGxpbmssIG1ldGEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndyaXRlKG1ldGEub3V0ZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndyaXRlKCc8Ym9keT48L2JvZHk+Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndyaXRlKFwiPHNjcmlwdCB0eXBlPSdhcHBsaWNhdGlvbi94LXN1cHByZXNzJz5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cuY2xvc2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb2MgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBhdHRyaWJ1dGUgZnJvbSB0aGUgc2hhZG93IGNvbnRhaW5lci5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyIG9mIFsuLi53cmFwLmF0dHJpYnV0ZXNdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwLnJlbW92ZUF0dHJpYnV0ZShhdHRyLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5ib2R5LnN0eWxlLm1hcmdpbiA9ICcwcHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuYm9keS5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLmJvZHkuYXBwZW5kKHdyYXApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ1YmJsZXMgdXAgdGhlIGxvYWQtaWZyYW1lIGV2ZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbG9hZC1pZnJhbWUnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9zZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGxvYWRXaXRoUHJlbG9hZGVkTWV0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkZXRhY2g6IChpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlmcmFtZS5zcmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib2R5ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3c/LmRvY3VtZW50LmJvZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmFwcGVuZCguLi5ib2R5LmNoaWxkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZS5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgb25sb2FkKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IEh0bWxEb21QYXJzaW5nRW5naW5lLCBIdG1sTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBJZnJhbWVOb2RlIH0gZnJvbSAnLi9JZnJhbWVOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lLCBmbGF0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IFNoYWRvd05vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tc2hhZG93L3NyYy9TaGFkb3dOb2RlJztcblxuZXhwb3J0IGNsYXNzIElmcmFtZUh0bWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBIVE1MRWxlbWVudCk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnSUZSQU1FJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBzaGFkb3cgbm9kZSBhbmQgZXh0cmFjdCBzdHlsaW5nIGZyb20gc2hhZG93IHJvb3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEhUTUxJRnJhbWVFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IG5ldyBJZnJhbWVOb2RlKCk7XG4gICAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBpdGVtLnNyY1xuICAgICAgICAgICAgPyBbXVxuICAgICAgICAgICAgOiAoQXJyYXkuZnJvbShpdGVtLmNvbnRlbnRXaW5kb3c/LmRvY3VtZW50LmJvZHk/LmNoaWxkTm9kZXMgfHwgW10pIGFzIEh0bWxOb2RlW10pO1xuICAgICAgICBsZXQgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5jaGlsZE5vZGVzKTtcbiAgICAgICAgbm9kZXMgPSBmbGF0KG5vZGVzLm1hcChub2RlID0+IChub2RlIGluc3RhbmNlb2YgU2hhZG93Tm9kZSA/IG5vZGUuY2hpbGRWTm9kZXMgOiBbbm9kZV0pKSk7XG4gICAgICAgIGlmcmFtZS5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2lmcmFtZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBJZnJhbWVOb2RlUGFyYW1zIHtcbiAgICBzcmM/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBJZnJhbWVOb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgZWRpdGFibGUgPSBmYWxzZTtcbiAgICBicmVha2FibGUgPSBmYWxzZTtcbiAgICBzcmM6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM/OiBJZnJhbWVOb2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChwYXJhbXM/LnNyYykge1xuICAgICAgICAgICAgdGhpcy5zcmMgPSBwYXJhbXMuc3JjO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBJZnJhbWVOb2RlIH0gZnJvbSAnLi9JZnJhbWVOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIElmcmFtZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QtSUZSQU1FJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBzaGFkb3cgbm9kZSBhbmQgZXh0cmFjdCBzdHlsaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGNvbnN0IHNoYWRvdyA9IG5ldyBJZnJhbWVOb2RlKHsgc3JjOiBhdHRyaWJ1dGVzLmdldCgnc3JjJykgfSk7XG4gICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCdzcmMnKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzaGFkb3cubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHNoYWRvdy5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW3NoYWRvd107XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSW1hZ2VYbWxEb21QYXJzZXIgfSBmcm9tICcuL0ltYWdlWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IEltYWdlRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL0ltYWdlRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbSW1hZ2VYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtJbWFnZURvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgSW1hZ2VOb2RlIH0gZnJvbSAnLi9JbWFnZU5vZGUnO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5leHBvcnQgY2xhc3MgSW1hZ2VEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gSW1hZ2VOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IEltYWdlTm9kZSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0Pik6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLnNlbGVjdGlvbi5zZWxlY3Qobm9kZSwgbm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaW1hZ2U6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgIHRhZzogJ0lNRycsXG4gICAgICAgICAgICBhdHRhY2g6IChlbDogSFRNTEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbGVjdCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGV0YWNoOiAoZWw6IEhUTUxFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWxlY3QpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaXNTZWxlY3RlZCA9IHRoaXMuZW5naW5lLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2Uuc2VsZWN0ZWROb2RlcyhcbiAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9PiBzZWxlY3RlZE5vZGUgPT09IG5vZGUsXG4gICAgICAgICkubGVuZ3RoO1xuICAgICAgICBpZiAoaXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgaW1hZ2UuYXR0cmlidXRlcyA9IHsgY2xhc3M6IG5ldyBTZXQoWydqd19zZWxlY3RlZF9pbWFnZSddKSB9O1xuICAgICAgICB9XG4gICAgICAgIHdvcmtlci5sb2NhdGUoW25vZGVdLCBpbWFnZSk7XG4gICAgICAgIHJldHVybiBpbWFnZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZU5vZGUgZXh0ZW5kcyBJbmxpbmVOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IEltYWdlTm9kZSB9IGZyb20gJy4vSW1hZ2VOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgSW1hZ2VYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdJTUcnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxJbWFnZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZU5vZGUoKTtcbiAgICAgICAgaW1hZ2UubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICByZXR1cm4gW2ltYWdlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgSldFZGl0b3IsIHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24sIFBvaW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENoYXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tY2hhci9zcmMvQ2hhcic7XG5pbXBvcnQgeyBDaGFyTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyTm9kZSc7XG5pbXBvcnQgeyBMaW5lQnJlYWsgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWsnO1xuaW1wb3J0IHsgTGluZUJyZWFrTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha05vZGUnO1xuaW1wb3J0IHsgVlJhbmdlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlJhbmdlJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IHR5cGUgSW5kZW50UGFyYW1zID0gQ29tbWFuZFBhcmFtcztcbmV4cG9ydCB0eXBlIE91dGRlbnRQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuXG5leHBvcnQgY2xhc3MgSW5kZW50PFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0NoYXIsIExpbmVCcmVha107XG4gICAgZWRpdG9yOiBKV0VkaXRvcjtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgaW5kZW50OiB7XG4gICAgICAgICAgICB0aXRsZTogJ0luZGVudCBjaGFycycsXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluZGVudCxcbiAgICAgICAgfSxcbiAgICAgICAgb3V0ZGVudDoge1xuICAgICAgICAgICAgdGl0bGU6ICdPdXRkZW50IGNoYXJzJyxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMub3V0ZGVudCxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIGxvYWRhYmxlczogTG9hZGFibGVzPEtleW1hcCAmIExheW91dD4gPSB7XG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdUQUInLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2luZGVudCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdTSElGVCtUQUInLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ291dGRlbnQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnSW5kZW50QnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW5kZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnSW5kZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2luZGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtaW5kZW50IGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPdXRkZW50QnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnb3V0ZGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ091dGRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAnb3V0ZGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtb3V0ZGVudCBmYS1mdycgfSldLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtidXR0b25dO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1xuICAgICAgICAgICAgWydJbmRlbnRCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICAgICAgWydPdXRkZW50QnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgXSxcbiAgICB9O1xuICAgIHRhYiA9ICdcXHUyMDAzJzsgLy8gYCZlbXNwO2AgKFwiZW0gc3BhY2VcIilcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbmRlbnQgdGV4dCBvciBsaW5lcy5cbiAgICAgKlxuICAgICAqIC0gSWYgdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSBsaW5lIHNlbGVjdGVkIGluIHJhbmdlLCBpbmRlbnQgZWFjaCBsaW5lcy5cbiAgICAgKiAtIE90aGVyd2lzZSwgaW5zZXJ0IDQgc3BhY2VzLlxuICAgICAqL1xuICAgIGFzeW5jIGluZGVudChwYXJhbXM6IEluZGVudFBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBzZWdtZW50QnJlYWtzID0gcmFuZ2UudHJhdmVyc2VkTm9kZXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICAvLyBPbmx5IGluZGVudCB3aGVuIHRoZXJlIGlzIGF0IGxlYXQgdHdvIGxpbmVzIHNlbGVjdGVkLCB0aGF0IGlzIHdoZW5cbiAgICAgICAgLy8gYXQgbGVhc3Qgb25lIHNlZ21lbnQgYnJlYWsgY291bGQgYmUgaWRlbnRpZmllZCBpbiB0aGUgc2VsZWN0aW9uLlxuICAgICAgICBpZiAocmFuZ2UuaXNDb2xsYXBzZWQoKSB8fCAhc2VnbWVudEJyZWFrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGF3YWl0IHBhcmFtcy5jb250ZXh0LmV4ZWNDb21tYW5kPENoYXI+KCdpbnNlcnRUZXh0Jywge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGFiLFxuICAgICAgICAgICAgICAgIGNvbnRleHQ6IHsgLi4ucGFyYW1zLmNvbnRleHQsIHJhbmdlIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRoZSBmaXJzdCBsaW5lIG9mIHRoZSBzZWxlY3Rpb24gaXMgbmVpdGhlciBmdWxseSBzZWxlY3RlZCBub3JcbiAgICAgICAgICAgIC8vIHRyYXZlcnNlZCBzbyBpdHMgc2VnbWVudCBicmVhayB3YXMgbm90IGluIGByYW5nZS50cmF2ZXJzZWROb2Rlc2AuXG4gICAgICAgICAgICBjb25zdCBuZXh0U2VnbWVudEJyZWFrID0gcmFuZ2Uuc3RhcnQucHJldmlvdXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICAgICAgaWYgKG5leHRTZWdtZW50QnJlYWspIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50QnJlYWtzLnVuc2hpZnQobmV4dFNlZ21lbnRCcmVhayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNlZ21lbnRCcmVhayBvZiBzZWdtZW50QnJlYWtzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IDQgc3BhY2VzIGF0IHRoZSBzdGFydCBvZiBuZXh0IHNlZ21lbnQuXG4gICAgICAgICAgICAgICAgY29uc3QgW25vZGUsIHBvc2l0aW9uXSA9IHRoaXMuX25leHRTZWdtZW50U3RhcnQoc2VnbWVudEJyZWFrKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmVkaXRvci5leGVjV2l0aFJhbmdlPENoYXI+KFZSYW5nZS5hdChub2RlLCBwb3NpdGlvbiksICdpbnNlcnRUZXh0Jywge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRhYixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE91dGRlbnQgbGluZXMuXG4gICAgICpcbiAgICAgKiBJZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIGxpbmUgc2VsZWN0ZWQsIGZvciBlYWNoIG9mIHRoZSBsaW5lcywgcmVtb3ZlIHVwXG4gICAgICogdG8gNCBzcGFjZXMgaW4gdGhlIGJlZ2dpbmluZyBvZiB0aGUgbGluZS5cbiAgICAgKi9cbiAgICBvdXRkZW50KHBhcmFtczogT3V0ZGVudFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBzZWdtZW50QnJlYWtzID0gcmFuZ2UudHJhdmVyc2VkTm9kZXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICAvLyBUaGUgZmlyc3QgbGluZSBvZiB0aGUgc2VsZWN0aW9uIGlzIG5laXRoZXIgZnVsbHkgc2VsZWN0ZWQgbm9yXG4gICAgICAgIC8vIHRyYXZlcnNlZCBzbyBpdHMgc2VnbWVudCBicmVhayB3YXMgbm90IGluIGByYW5nZS50cmF2ZXJzZWROb2Rlc2AuXG4gICAgICAgIGNvbnN0IHByZXZpb3VzU2VnbWVudEJyZWFrID0gcmFuZ2Uuc3RhcnQucHJldmlvdXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICBpZiAocHJldmlvdXNTZWdtZW50QnJlYWspIHtcbiAgICAgICAgICAgIHNlZ21lbnRCcmVha3MudW5zaGlmdChwcmV2aW91c1NlZ21lbnRCcmVhayk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gT25seSBvdXRkZW50IHdoZW4gdGhlcmUgaXMgYXQgbGVhdCB0d28gbGluZXMgc2VsZWN0ZWQsIHRoYXQgaXMgd2hlblxuICAgICAgICAvLyBhdCBsZWFzdCBvbmUgc2VnbWVudCBicmVhayBjb3VsZCBiZSBpZGVudGlmaWVkIGluIHRoZSBzZWxlY3Rpb24uXG4gICAgICAgIGlmIChzZWdtZW50QnJlYWtzLmxlbmd0aCkge1xuICAgICAgICAgICAgc2VnbWVudEJyZWFrcy5mb3JFYWNoKHNlZ21lbnRCcmVhayA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRhYi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFjZSA9IHRoaXMuX25leHRJbmRlbnRhdGlvblNwYWNlKHNlZ21lbnRCcmVhayk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcGFjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2UucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIFZOb2RlIGNhbiBiZSBjb25zaWRlcmVkIHRvIGJlIGEgc2VnbWVudCBicmVhay5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBfaXNTZWdtZW50QnJlYWsobm9kZTogVk5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlIHx8IG5vZGUgaW5zdGFuY2VvZiBMaW5lQnJlYWtOb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIG5leHQgc2VnbWVudCBzdGFydCBwb2ludCBhZnRlciB0aGUgZ2l2ZW4gc2VnbWVudCBicmVhay5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWdtZW50QnJlYWtcbiAgICAgKi9cbiAgICBfbmV4dFNlZ21lbnRTdGFydChzZWdtZW50QnJlYWs6IFZOb2RlKTogUG9pbnQge1xuICAgICAgICBsZXQgcmVmZXJlbmNlID0gc2VnbWVudEJyZWFrO1xuICAgICAgICBsZXQgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgaWYgKHNlZ21lbnRCcmVhayBpbnN0YW5jZW9mIEF0b21pY05vZGUpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHNlZ21lbnRCcmVhay5uZXh0U2libGluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHNlZ21lbnRCcmVhay5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSBzZWdtZW50QnJlYWsuZmlyc3RDaGlsZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3JlZmVyZW5jZSwgcG9zaXRpb25dO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gVk5vZGUgaXMgYSBDaGFyTm9kZSBjb250YWluaW5nIGEgc3BhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIF9pc1NwYWNlKG5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBub2RlIGluc3RhbmNlb2YgQ2hhck5vZGUgJiYgL15cXHMkL2cudGVzdChub2RlLmNoYXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gVk5vZGUgY2FuIGJlIGNvbnNpZGVyZWQgdG8gYmUgYSBzZWdtZW50IGJyZWFrLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlZ21lbnRCcmVha1xuICAgICAqL1xuICAgIF9uZXh0SW5kZW50YXRpb25TcGFjZShzZWdtZW50QnJlYWs6IFZOb2RlKTogVk5vZGUge1xuICAgICAgICBsZXQgc3BhY2U6IFZOb2RlO1xuICAgICAgICBpZiAoc2VnbWVudEJyZWFrIGluc3RhbmNlb2YgQXRvbWljTm9kZSkge1xuICAgICAgICAgICAgc3BhY2UgPSBzZWdtZW50QnJlYWsubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNwYWNlID0gc2VnbWVudEJyZWFrLmZpcnN0Q2hpbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BhY2UgJiYgc3BhY2UudGVzdCh0aGlzLl9pc1NwYWNlKSAmJiBzcGFjZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRm9ybWF0JztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEZvcm1hdFhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHNwYW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2Rlc1xuICAgICAqL1xuICAgIGFwcGx5Rm9ybWF0KGZvcm1hdDogRm9ybWF0LCBub2RlczogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgSW5saW5lTm9kZSkge1xuICAgICAgICAgICAgICAgIGZvcm1hdC5jbG9uZSgpLmFwcGx5VG8obm9kZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlubGluZU5vZGVzID0gbm9kZS5kZXNjZW5kYW50cyhJbmxpbmVOb2RlKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGlubGluZSBvZiBpbmxpbmVOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBmb3JtYXQuY2xvbmUoKS5hcHBseVRvKGlubGluZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRm9ybWF0JztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4vSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcnMnO1xuaW1wb3J0IHsgQ3NzU3R5bGUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9Dc3NTdHlsZSc7XG5pbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrTm9kZSc7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgbWFrZVZlcnNpb25hYmxlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlJztcbmltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZSYW5nZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRm9ybWF0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgRm9ybWF0Q2xhc3M6IENvbnN0cnVjdG9yPEZvcm1hdD47XG59XG5leHBvcnQgdHlwZSBSZW1vdmVGb3JtYXRQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuXG5pbnRlcmZhY2UgSW5saW5lQ2FjaGUge1xuICAgIG1vZGlmaWVyczogTW9kaWZpZXJzIHwgbnVsbDtcbiAgICBzdHlsZTogQ3NzU3R5bGUgfCBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgSW5saW5lPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgdG9nZ2xlRm9ybWF0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnRvZ2dsZUZvcm1hdCxcbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlRm9ybWF0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnJlbW92ZUZvcm1hdCxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIGNvbW1hbmRIb29rcyA9IHtcbiAgICAgICAgc2V0U2VsZWN0aW9uOiB0aGlzLnJlc2V0Q2FjaGUsXG4gICAgfTtcbiAgICBsb2FkYWJsZXM6IExvYWRhYmxlczxSZW5kZXJlciAmIExheW91dD4gPSB7XG4gICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ1JlbW92ZUZvcm1hdEJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3JlbW92ZUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1JlbW92ZSBmb3JtYXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAncmVtb3ZlRm9ybWF0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7fSBhcyBSZW1vdmVGb3JtYXRQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKCk6IGJvb2xlYW4gPT4gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtZXJhc2VyIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydSZW1vdmVGb3JtYXRCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dXSxcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFdoZW4gYXBwbHlpbmcgYSBtb2RpZmllciBvbiBhIGNvbGxhcHNlZCByYW5nZSwgY2FjaGUgdGhlIGNhbGN1bGF0aW9uIG9mXG4gICAgICogdGhlIG1vZGlmaWVyIGluIHRoZSBmb2xsb3dpbmcgcHJvcGVydHkuIFRoaXMgdmFsdWUgaXMgcmVzZXQgZWFjaCB0aW1lIHRoZVxuICAgICAqIHJhbmdlIGNoYW5nZXMgaW4gYSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBjYWNoZTogSW5saW5lQ2FjaGUgPSBtYWtlVmVyc2lvbmFibGUoe1xuICAgICAgICBtb2RpZmllcnM6IHVuZGVmaW5lZCxcbiAgICAgICAgc3R5bGU6IHVuZGVmaW5lZCxcbiAgICB9KTtcblxuICAgIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmVkaXRvci5tZW1vcnkuYXR0YWNoKHRoaXMuY2FjaGUpO1xuICAgICAgICB0aGlzLmdldEN1cnJlbnRNb2RpZmllcnMoKTtcbiAgICAgICAgdGhpcy5nZXRDdXJyZW50U3R5bGUoKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHRoZSBgZm9ybWF0YCB0byB0aGUgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgdG9nZ2xlRm9ybWF0KHBhcmFtczogRm9ybWF0UGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IEZvcm1hdENsYXNzID0gcGFyYW1zLkZvcm1hdENsYXNzO1xuXG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGUubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZS5tb2RpZmllcnMgPSB0aGlzLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gdGhpcy5jYWNoZS5tb2RpZmllcnM/LmZpbmQoRm9ybWF0Q2xhc3MpO1xuICAgICAgICAgICAgaWYgKGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUubW9kaWZpZXJzLnJlbW92ZShmb3JtYXQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGUubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUubW9kaWZpZXJzID0gbmV3IE1vZGlmaWVycygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlLm1vZGlmaWVycy5hcHBlbmQobmV3IEZvcm1hdENsYXNzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbmxpbmVzID0gcmFuZ2Uuc2VsZWN0ZWROb2RlcyhJbmxpbmVOb2RlKTtcblxuICAgICAgICAgICAgLy8gSWYgZXZlcnkgY2hhciBpbiB0aGUgcmFuZ2UgaGFzIHRoZSBmb3JtYXQgYEZvcm1hdENsYXNzYCwgcmVtb3ZlXG4gICAgICAgICAgICAvLyB0aGUgZm9ybWF0IGZvciBhbGwgb2YgdGhlbS5cbiAgICAgICAgICAgIGNvbnN0IGFsbEhhdmVGb3JtYXQgPSBzZWxlY3RlZElubGluZXMuZXZlcnkoaW5saW5lID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFpbmxpbmUubW9kaWZpZXJzLmZpbmQoRm9ybWF0Q2xhc3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoYWxsSGF2ZUZvcm1hdCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaW5saW5lIG9mIHNlbGVjdGVkSW5saW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBpbmxpbmUubW9kaWZpZXJzLmZpbmQoRm9ybWF0Q2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgYXR0cmlidXRlcyBvZiB0aGUgZm9ybWF0IHdlJ3JlIGFib3V0IHRvIHJlbW92ZVxuICAgICAgICAgICAgICAgICAgICAvLyB0byB0aGUgaW5saW5lIGl0c2VsZi5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGlubGluZS5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGluZ0Zvcm1hdEF0dHJpYnV0ZXMgPSBmb3JtYXQubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGluZ0Zvcm1hdEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIG1hdGNoaW5nRm9ybWF0QXR0cmlidXRlcy5rZXlzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnNldChrZXksIG1hdGNoaW5nRm9ybWF0QXR0cmlidXRlcy5nZXQoa2V5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBmb3JtYXQuXG4gICAgICAgICAgICAgICAgICAgIGlubGluZS5tb2RpZmllcnMucmVtb3ZlKGZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBhdCBsZWFzdCBvbmUgY2hhciBpbiB0aGUgcmFuZ2Ugd2l0aG91dCB0aGUgZm9ybWF0XG4gICAgICAgICAgICAgICAgLy8gYEZvcm1hdENsYXNzYCwgc2V0IHRoZSBmb3JtYXQgZm9yIGFsbCBub2Rlcy5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGlubGluZSBvZiBzZWxlY3RlZElubGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbmxpbmUubW9kaWZpZXJzLmZpbmQoRm9ybWF0Q2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRm9ybWF0Q2xhc3MoKS5hcHBseVRvKGlubGluZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaXNBbGxGb3JtYXQoRm9ybWF0Q2xhc3M6IENvbnN0cnVjdG9yPE1vZGlmaWVyPiwgcmFuZ2UgPSB0aGlzLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2UpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZS5tb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpPy5maW5kKEZvcm1hdENsYXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhIXRoaXMuY2FjaGUubW9kaWZpZXJzLmZpbmQoRm9ybWF0Q2xhc3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbmxpbmVzID0gcmFuZ2Uuc2VsZWN0ZWROb2RlcyhJbmxpbmVOb2RlKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hhciBvZiBzZWxlY3RlZElubGluZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWNoYXIubW9kaWZpZXJzLmZpbmQoRm9ybWF0Q2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gISFzZWxlY3RlZElubGluZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbW9kaWZpZXJzIGZvciB0aGUgbmV4dCBpbnNlcnRpb24uXG4gICAgICovXG4gICAgZ2V0Q3VycmVudE1vZGlmaWVycyhyYW5nZT86IFZSYW5nZSk6IE1vZGlmaWVycyB8IG51bGwge1xuICAgICAgICBjb25zdCBzdG9yZUluQ2FjaGUgPSAhcmFuZ2U7XG4gICAgICAgIHJhbmdlID0gcmFuZ2UgfHwgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlO1xuICAgICAgICBpZiAodGhpcy5jYWNoZS5tb2RpZmllcnMgPT09IHVuZGVmaW5lZCB8fCByYW5nZSAhPT0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlKSB7XG4gICAgICAgICAgICBsZXQgaW5saW5lVG9Db3B5TW9kaWZpZXJzOiBWTm9kZTtcbiAgICAgICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogTGluZUJyZWFrTm9kZSBzaG91bGQgaGF2ZSB0aGUgZm9ybWF0cyBhcyB3ZWxsLlxuICAgICAgICAgICAgICAgIGlubGluZVRvQ29weU1vZGlmaWVycyA9XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZyhub2RlID0+ICEobm9kZSBpbnN0YW5jZW9mIExpbmVCcmVha05vZGUpKSB8fFxuICAgICAgICAgICAgICAgICAgICByYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmxpbmVUb0NvcHlNb2RpZmllcnMgPSByYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG1vZGlmaWVyczogTW9kaWZpZXJzID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChpbmxpbmVUb0NvcHlNb2RpZmllcnMgJiYgaW5saW5lVG9Db3B5TW9kaWZpZXJzIGluc3RhbmNlb2YgSW5saW5lTm9kZSkge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVycyA9IGlubGluZVRvQ29weU1vZGlmaWVycy5tb2RpZmllcnMuY2xvbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdG9yZUluQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlLm1vZGlmaWVycyA9IG1vZGlmaWVycztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtb2RpZmllcnM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5tb2RpZmllcnM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBzdHlsZXMgZm9yIHRoZSBuZXh0IGluc2VydGlvbi5cbiAgICAgKi9cbiAgICBnZXRDdXJyZW50U3R5bGUocmFuZ2U/OiBWUmFuZ2UpOiBDc3NTdHlsZSB8IG51bGwge1xuICAgICAgICBjb25zdCBzdG9yZUluQ2FjaGUgPSAhcmFuZ2U7XG4gICAgICAgIHJhbmdlID0gcmFuZ2UgfHwgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlO1xuICAgICAgICBpZiAodGhpcy5jYWNoZS5zdHlsZSA9PT0gdW5kZWZpbmVkIHx8IHJhbmdlICE9PSB0aGlzLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2UpIHtcbiAgICAgICAgICAgIGxldCBpbmxpbmVUb0NvcHlTdHlsZTogVk5vZGU7XG4gICAgICAgICAgICBpZiAocmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgICAgIGlubGluZVRvQ29weVN0eWxlID0gcmFuZ2Uuc3RhcnQucHJldmlvdXNTaWJsaW5nKCkgfHwgcmFuZ2Uuc3RhcnQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5saW5lVG9Db3B5U3R5bGUgPSByYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHN0eWxlOiBDc3NTdHlsZSA9IG51bGw7XG4gICAgICAgICAgICBpZiAoaW5saW5lVG9Db3B5U3R5bGUgJiYgaW5saW5lVG9Db3B5U3R5bGUgaW5zdGFuY2VvZiBJbmxpbmVOb2RlKSB7XG4gICAgICAgICAgICAgICAgc3R5bGUgPSBpbmxpbmVUb0NvcHlTdHlsZS5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUuY2xvbmUoKSB8fCBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0b3JlSW5DYWNoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUuc3R5bGUgPSBzdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5zdHlsZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRWFjaCB0aW1lIHRoZSBzZWxlY3Rpb24gY2hhbmdlcywgd2UgcmVzZXQgaXRzIGZvcm1hdCBhbmQgc3R5bGUuXG4gICAgICovXG4gICAgcmVzZXRDYWNoZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jYWNoZS5tb2RpZmllcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY2FjaGUuc3R5bGUgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgZm9ybWF0dGluZyBvZiB0aGUgbm9kZXMgaW4gdGhlIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHJlbW92ZUZvcm1hdChwYXJhbXM6IFJlbW92ZUZvcm1hdFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBub2RlcyA9IHBhcmFtcy5jb250ZXh0LnJhbmdlLnNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBzb21lIGZvcm1hdHMgbWlnaHQgYmUgb24gdGhlIHBhcmVudC4uLlxuICAgICAgICAgICAgbm9kZS5tb2RpZmllcnMuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBJbmxpbmVOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7fVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBJbnB1dFhtbERvbVBhcnNlciB9IGZyb20gJy4vSW5wdXRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5wdXREb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vSW5wdXREb21PYmplY3RSZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBJbnB1dDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbSW5wdXRYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtJbnB1dERvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgSW5wdXROb2RlIH0gZnJvbSAnLi9JbnB1dE5vZGUnO1xuaW1wb3J0IHsgRG9tT2JqZWN0RWxlbWVudCB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBJbnB1dERvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGU6IFByZWRpY2F0ZSA9IElucHV0Tm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVk5vZGUgdG8gdGhlIGdpdmVuIGZvcm1hdC5cbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXIobm9kZTogSW5wdXROb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgaW5wdXQ6IERvbU9iamVjdEVsZW1lbnQgPSB7XG4gICAgICAgICAgICB0YWc6ICdJTlBVVCcsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogbm9kZS5pbnB1dFR5cGUsXG4gICAgICAgICAgICAgICAgbmFtZTogbm9kZS5pbnB1dE5hbWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IG5vZGUudmFsdWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuXG4gICAgICAgIGxldCBvbkNvbW1pdDogKCkgPT4gdm9pZDtcbiAgICAgICAgbGV0IG1vdXNlZG93bjogKGV2OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBsZXQgY2hhbmdlSGFuZGxlcjogKCkgPT4gdm9pZDtcbiAgICAgICAgaW5wdXQuYXR0YWNoID0gKGVsOiBIVE1MSW5wdXRFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICBvbkNvbW1pdCA9IHRoaXMuX29uQ29tbWl0LmJpbmQodGhpcywgbm9kZSwgZWwpO1xuICAgICAgICAgICAgY2hhbmdlSGFuZGxlciA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY0NvbW1hbmQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBub2RlLnZhbHVlID0gZWwudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuY2hhbmdlKHRoaXMuZW5naW5lLmVkaXRvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbW91c2Vkb3duID0gKGV2OiBNb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG1vdXNlZG93bik7XG4gICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmRIb29rKCdAY29tbWl0Jywgb25Db21taXQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlucHV0LmRldGFjaCA9IChlbDogSFRNTElucHV0RWxlbWVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2hhbmdlSGFuZGxlcik7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBtb3VzZWRvd24pO1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmRpc3BhdGNoZXIucmVtb3ZlQ29tbWFuZEhvb2soJ0Bjb21taXQnLCBvbkNvbW1pdCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPbiBpbnB1dCBjaGFuZ2UgaGFuZGxlci5cbiAgICAgKlxuICAgICAqIE1lYW50IHRvIGJlIG92ZXJyaWRlbi5cbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzLEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIF9vbkNvbW1pdChub2RlOiBJbnB1dE5vZGUsIGVsOiBIVE1MSW5wdXRFbGVtZW50KTogdm9pZCB7fVxufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcblxuZXhwb3J0IGludGVyZmFjZSBJbnB1dE5vZGVQYXJhbXMge1xuICAgIGlucHV0VHlwZT86IHN0cmluZztcbiAgICBpbnB1dE5hbWU/OiBzdHJpbmc7XG4gICAgdmFsdWU/OiBzdHJpbmc7XG4gICAgY2hhbmdlPzogKGVkaXRvcjogSldFZGl0b3IpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBJbnB1dE5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgdmFsdWU6IHN0cmluZztcbiAgICBpbnB1dE5hbWU6IHN0cmluZztcbiAgICBpbnB1dFR5cGU6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IElucHV0Tm9kZVBhcmFtcyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0lOUFVUJyB9KTtcbiAgICAgICAgdGhpcy5pbnB1dE5hbWUgPSBwYXJhbXMuaW5wdXROYW1lIHx8ICcnO1xuICAgICAgICB0aGlzLmlucHV0VHlwZSA9IHBhcmFtcy5pbnB1dFR5cGUgfHwgJ3RleHQnO1xuICAgICAgICB0aGlzLnZhbHVlID0gcGFyYW1zLnZhbHVlIHx8ICcnO1xuICAgICAgICBpZiAocGFyYW1zLmNoYW5nZSkgdGhpcy5jaGFuZ2UgPSBwYXJhbXMuY2hhbmdlO1xuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMsQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgY2hhbmdlKGVkaXRvcjogSldFZGl0b3IpOiB2b2lkIHt9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IElucHV0Tm9kZSB9IGZyb20gJy4vSW5wdXROb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIElucHV0WG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnSU5QVVQnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBIVE1MSW5wdXRFbGVtZW50KTogUHJvbWlzZTxJbnB1dE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBJbnB1dE5vZGUoe1xuICAgICAgICAgICAgaW5wdXRUeXBlOiBpdGVtLmdldEF0dHJpYnV0ZSgndHlwZScpLFxuICAgICAgICAgICAgaW5wdXROYW1lOiBpdGVtLmdldEF0dHJpYnV0ZSgnbmFtZScpLFxuICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ3R5cGUnKTsgLy8gdHlwZSBpcyBvbiBpbnB1dC5pbnB1dFR5cGVcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCduYW1lJyk7IC8vIHR5cGUgaXMgb24gaW5wdXQuaW5wdXROYW1lXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpbnB1dC5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgaW5wdXQuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgcmV0dXJuIFtpbnB1dF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSXRhbGljRm9ybWF0IH0gZnJvbSAnLi9JdGFsaWNGb3JtYXQnO1xuaW1wb3J0IHsgRm9ybWF0UGFyYW1zLCBJbmxpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgSXRhbGljWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9JdGFsaWNYbWxEb21QYXJzZXInO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgSXRhbGljPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0lubGluZV07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgS2V5bWFwICYgTGF5b3V0PiA9IHtcbiAgICAgICAgcGFyc2VyczogW0l0YWxpY1htbERvbVBhcnNlcl0sXG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK0knLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgRm9ybWF0Q2xhc3M6IEl0YWxpY0Zvcm1hdCB9IGFzIEZvcm1hdFBhcmFtcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ0l0YWxpY0J1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2l0YWxpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1RvZ2dsZSBpdGFsaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAndG9nZ2xlRm9ybWF0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IEZvcm1hdENsYXNzOiBJdGFsaWNGb3JtYXQgfSBhcyBGb3JtYXRQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IGVkaXRvci5zZWxlY3Rpb24ucmFuZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGx1Z2luSW5saW5lID0gZWRpdG9yLnBsdWdpbnMuZ2V0KElubGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXBsdWdpbklubGluZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/LmZpbmQoSXRhbGljRm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydElzRm9ybWF0ZWQgPSAhIXJhbmdlLnN0YXJ0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubmV4dFNpYmxpbmcoSW5saW5lTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8ubW9kaWZpZXJzLmZpbmQoSXRhbGljRm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydElzRm9ybWF0ZWQgfHwgcmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0SXNGb3JtYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXJhbmdlLmVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wcmV2aW91c1NpYmxpbmcoSW5saW5lTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/Lm1vZGlmaWVycy5maW5kKEl0YWxpY0Zvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLWl0YWxpYyBmYS1mdycgfSldLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtidXR0b25dO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1snSXRhbGljQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXV0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBJdGFsaWNGb3JtYXQgZXh0ZW5kcyBGb3JtYXQge1xuICAgIGNvbnN0cnVjdG9yKGh0bWxUYWc6ICdJJyB8ICdFTScgPSAnSScpIHtcbiAgICAgICAgc3VwZXIoaHRtbFRhZyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRm9ybWF0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEl0YWxpY0Zvcm1hdCB9IGZyb20gJy4vSXRhbGljRm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEl0YWxpY1htbERvbVBhcnNlciBleHRlbmRzIEZvcm1hdFhtbERvbVBhcnNlciB7XG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIChub2RlTmFtZShpdGVtKSA9PT0gJ0knIHx8IG5vZGVOYW1lKGl0ZW0pID09PSAnRU0nKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYW4gaXRhbGljIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgaXRhbGljID0gbmV3IEl0YWxpY0Zvcm1hdChub2RlTmFtZShpdGVtKSBhcyAnSScgfCAnRU0nKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpdGFsaWMubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHRoaXMuYXBwbHlGb3JtYXQoaXRhbGljLCBjaGlsZHJlbik7XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgQ29udGV4dHVhbCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvbnRleHRNYW5hZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBDb25maWd1cmVkQ29tbWFuZCBleHRlbmRzIENvbnRleHR1YWwge1xuICAgIC8qKlxuICAgICAqIEFuIHVuZGVmaW5lZCBgY29tbWFuZElkYCBlZmZlY3RpdmVseSB1bmJpbmRzIHRoZSBzaG9ydGN1dC5cbiAgICAgKi9cbiAgICByZWFkb25seSBjb21tYW5kSWQ6IENvbW1hbmRJZGVudGlmaWVyIHwgdW5kZWZpbmVkO1xuICAgIHJlYWRvbmx5IGNvbW1hbmRBcmdzPzoge307XG59XG5cbmludGVyZmFjZSBNb2RpZmllZFNob3J0Y3V0IHtcbiAgICBtb2RpZmllcnM6IFNldDxzdHJpbmc+O1xufVxuXG5pbnRlcmZhY2UgS2V5U2hvcnRjdXRQYXR0ZXJuIGV4dGVuZHMgTW9kaWZpZWRTaG9ydGN1dCB7XG4gICAga2V5OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBDb2RlU2hvcnRjdXRQYXR0ZXJuIGV4dGVuZHMgTW9kaWZpZWRTaG9ydGN1dCB7XG4gICAgY29kZTogc3RyaW5nO1xufVxuXG50eXBlIFNob3J0Y3V0UGF0dGVybiA9IEtleVNob3J0Y3V0UGF0dGVybiB8IENvZGVTaG9ydGN1dFBhdHRlcm47XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFwcGluZyB7XG4gICAgcGF0dGVybjogU2hvcnRjdXRQYXR0ZXJuO1xuICAgIGNvbmZpZ3VyZWRDb21tYW5kOiBDb25maWd1cmVkQ29tbWFuZDtcbn1cblxuZXhwb3J0IGVudW0gUGxhdGZvcm0ge1xuICAgIE1BQyA9ICdtYWMnLFxuICAgIFBDID0gJ3BjJyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaG9ydGN1dCBleHRlbmRzIENvbmZpZ3VyZWRDb21tYW5kIHtcbiAgICBwbGF0Zm9ybT86IFBsYXRmb3JtO1xuICAgIHBhdHRlcm46IHN0cmluZztcbn1cblxuZXhwb3J0IGVudW0gTEVWRUwge1xuICAgIERFRkFVTFQsXG4gICAgVVNFUixcbn1cblxuZXhwb3J0IGludGVyZmFjZSBLZXltYXBDb25maWcgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyB7XG4gICAgcGxhdGZvcm0/OiBQbGF0Zm9ybTtcbn1cblxuLyoqXG4gKiBLZXltYXAgYWxsb3cgdG8gYWRkIGFuZCByZW1vdmUgc2hvcnR1Y3RzIGFuZCBwcm92aWRlIGEgZnVuY3Rpb24gdG8gbWF0Y2ggYVxuICoga2V5Ym9hcmQgZXZlbnQgd2l0aCB0aGUgcmVnaXN0ZXJlZCBzaG9ydGN1dHMgcGF0dGVybnMuXG4gKlxuICogIyMgQWRkaW5nIHNob3J0Y3V0c1xuICogVGhlIGV4cHJlc3Npb24gdG8gZGVzY3JpYmUgYSBzaG9ydHVjdCBpcyB6ZXJvIG9yIG1vcmUgYG1vZGlmaWVyc2AgYW5kIG9uZVxuICogYGhvdGtleWAgam9pbmVkIHdpdGggdGhlIHN5bWJvbCBgK2AuXG4gKlxuICogIyMjIE1vZGlmaWVyc1xuICogLSBTSElGVFxuICogLSBBTFRcbiAqIC0gQ1RSTFxuICogLSBNRVRBXG4gKiAtIENNRCAoYWxpYXMgb2YgTUVUQSlcbiAqXG4gKiBFeGFtcGxlOlxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gdXNpbmcgYSBtb2RpZmllciBhbmQgb25lIGtleVxuICoga2V5bWFwLmJpbmQoJ0NUUkwrQScsICdjb21tYW5kSWRlbnRpZmllcicpXG4gKiAvLyB1c2luZyBtdWx0aXBsZXMgbW9kaWZpZXJzIGFuZCBvbmUga2V5XG4gKiBrZXltYXAuYmluZCgnQ1RSTCtBTFQrQScsICdjb21tYW5kSWRlbnRpZmllcicpXG4gKiBgYGBcbiAqXG4gKiAjIyMgSG90a2V5c1xuICogQSBob3RrZXkgY2FuIGJlIHdldGhlciBhIGBrZXlgIG9yIGBjb2RlYC5cbiAqXG4gKiAjIyMjIEtleVxuICogVGhlIHN5bnRheCB0byBkZXNjcmliZSBhIGBrZXlgIGlzIHRvIHdyaXRlIHRoZSBga2V5YCBhcyBpdCBpcy4gVGhlIGNvbnZlbnRpb25cbiAqIGlzIHRvIHdyaXRlIGl0IGluIHVwcGVyY2FzZS5cbiAqXG4gKiBFeGFtcGxlOlxuICogYGBgdHlwZXNjcmlwdFxuICoga2V5bWFwLmJpbmQoJ0NUUkwrQScsICdjb21tYW5kSWRlbnRpZmllcicpXG4gKiBgYGBcbiAqIFRoZSBsaXN0IG9mIHBvc3NpYmxlIGBrZXlgIHZhbHVlcyBhcmUgZGVmaW5lZCBpbiB0aGUgZm9sbG93aW5nIGxpbms6XG4gKiBodHRwczovL3d3dy53My5vcmcvVFIvdWlldmVudHMvI2RvbS1rZXlib2FyZGV2ZW50LWtleVxuICpcbiAqICMjIyMgQ29kZVxuICogVGhlIHN5bnRheCB0byBkZXNjcmliZSBhIGBjb2RlYCBpcyB0byB3cml0ZSBgPGNvZGU+YCAoc3Vycm91bmRlZCBieSBcIjxcIiBhbmRcbiAqIFwiPlwiKS5cbiAqXG4gKiBFeGFtcGxlOlxuICogYGBgdHlwZXNjcmlwdFxuICoga2V5bWFwLmJpbmQoJ0NUUkwrPEtleUE+JywgJ2NvbW1hbmRJZGVudGlmaWVyJylcbiAqIGBgYFxuICpcbiAqIFRoZSBsaXN0IG9mIHBvc3NpYmxlIGBjb2RlYCB2YWx1ZXMgYXJlIGRlZmluZWQgaW4gdGhlIGZvbGxvd2luZyBsaW5rOlxuICogaHR0cHM6Ly93d3cudzMub3JnL1RSL3VpZXZlbnRzLyNkb20ta2V5Ym9hcmRldmVudC1rZXlcbiAqXG4gKiAjIyBSZW1vdmluZyBzaG9ydHVjdHNcbiAqIFRvIHJlbW92ZSBhIHNob3J0dWN0LCBjYWxsIGBiaW5kYCB3aXRob3V0IHNwZWNpZnlpbmcgYSBjb21tYW5kSWRlbnRpZmllci5cbiAqXG4gKiBFeGFtcGxlOlxuICogYGBgdHlwZXNjcmlwdFxuICoga2V5bWFwLmJpbmQoJ0NUUkwrPEtleUE+JylcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgS2V5bWFwPFQgZXh0ZW5kcyBLZXltYXBDb25maWcgPSBLZXltYXBDb25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRlcnMgPSB7XG4gICAgICAgIHNob3J0Y3V0czogdGhpcy5fbG9hZFNob3J0Y3V0cyxcbiAgICB9O1xuICAgIG1hcHBpbmdzOiBNYXBwaW5nW11bXSA9IFsuLi5uZXcgQXJyYXkoTEVWRUwuVVNFUiArIDEpXS5tYXAoKCkgPT4gW10pO1xuICAgIGRlZmF1bHRNYXBwaW5nczogTWFwcGluZ1tdID0gW107XG4gICAgdXNlck1hcHBpbmdzOiBNYXBwaW5nW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBlZGl0b3I6IEpXRWRpdG9yLCBwdWJsaWMgY29uZmlnOiBUKSB7XG4gICAgICAgIHN1cGVyKGVkaXRvciwgY29uZmlnKTtcbiAgICAgICAgaWYgKCFjb25maWcucGxhdGZvcm0pIHtcbiAgICAgICAgICAgIGNvbnN0IGlzTWFjID0gbmF2aWdhdG9yLnBsYXRmb3JtLm1hdGNoKC9NYWMvKTtcbiAgICAgICAgICAgIGNvbmZpZy5wbGF0Zm9ybSA9IGlzTWFjID8gUGxhdGZvcm0uTUFDIDogUGxhdGZvcm0uUEM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQmluZCBhIHNob3J0dWN0LlxuICAgICAqXG4gICAgICogSWYgdGhlcmUgaXMgbm8gYGNvbW1hbmQuY29tbWFuZElkYCwgaXQgbWVhbnMgdGhhdCB3ZSB3YW50IG5vdGhpbmcgdG9cbiAgICAgKiBleGVjdXRlLCB0aHVzIHJlcGxhY2luZyB0aGUgY29tbWFuZCBvcmlnaW5hbGx5IGJvdW5kIG9uIHRoaXMgc2hvcnRjdXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF0dGVyblxuICAgICAqIEBwYXJhbSBjb21tYW5kXG4gICAgICovXG4gICAgYmluZChwYXR0ZXJuOiBzdHJpbmcsIGNvbW1hbmQ6IENvbmZpZ3VyZWRDb21tYW5kLCBsZXZlbCA9IExFVkVMLkRFRkFVTFQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tYXBwaW5nc1tsZXZlbF0ucHVzaCh7XG4gICAgICAgICAgICBwYXR0ZXJuOiB0aGlzLnBhcnNlUGF0dGVybihwYXR0ZXJuKSxcbiAgICAgICAgICAgIGNvbmZpZ3VyZWRDb21tYW5kOiBjb21tYW5kLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIGNvbmZpZ3VyZWQgY29tbWFuZHMgd2hpY2ggc2hvcnRjdXQgbWF0Y2ggdGhlIGdpdmVuIGBrZXlFdmVudGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5RXZlbnRcbiAgICAgKi9cbiAgICBtYXRjaChrZXlFdmVudDogS2V5Ym9hcmRFdmVudCk6IENvbmZpZ3VyZWRDb21tYW5kW10ge1xuICAgICAgICBjb25zdCBtYXRjaGluZ0NvbW1hbmRzOiBDb25maWd1cmVkQ29tbWFuZFtdID0gW107XG4gICAgICAgIGZvciAobGV0IGxldmVsID0gTEVWRUwuVVNFUjsgbGV2ZWwgPj0gMDsgbGV2ZWwtLSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzaG9ydGN1dCBvZiB0aGlzLm1hcHBpbmdzW2xldmVsXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVycyA9IHNob3J0Y3V0LnBhdHRlcm4ubW9kaWZpZXJzO1xuXG4gICAgICAgICAgICAgICAgbGV0IG1hdGNoOiBib29sZWFuO1xuICAgICAgICAgICAgICAgIGlmICgnY29kZScgaW4gc2hvcnRjdXQucGF0dGVybikge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHNob3J0Y3V0LnBhdHRlcm4uY29kZSA9PT0ga2V5RXZlbnQuY29kZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBJbiByYXJlIGNhc2UgdGhlIEtleWJvYXJkRXZlbnQgYGtleWAgaXMgdW5kZWZpbmVkLlxuICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHNob3J0Y3V0LnBhdHRlcm4ua2V5ID09PSBrZXlFdmVudC5rZXk/LnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWF0Y2ggPVxuICAgICAgICAgICAgICAgICAgICBtYXRjaCAmJlxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnMuaGFzKCdDVFJMJykgPT09IGtleUV2ZW50LmN0cmxLZXkgJiZcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzLmhhcygnU0hJRlQnKSA9PT0ga2V5RXZlbnQuc2hpZnRLZXkgJiZcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzLmhhcygnTUVUQScpID09PSBrZXlFdmVudC5tZXRhS2V5ICYmXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVycy5oYXMoJ0FMVCcpID09PSBrZXlFdmVudC5hbHRLZXk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaG9ydGN1dC5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFuIGB1bmRlZmluZWRgIGNvbW1hbmQgdW5ib3VuZHMgdGhlIG90aGVyIGNvbW1hbmRzXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgb24gdGhpcyBzaG9ydGN1dC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nQ29tbWFuZHMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtYXRjaGluZ0NvbW1hbmRzLnB1c2goc2hvcnRjdXQuY29uZmlndXJlZENvbW1hbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1hdGNoaW5nQ29tbWFuZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gTWF0Y2hlcyB3ZXJlIGZvdW5kIGF0IHRoaXMgbGV2ZWwgc28gZG8gbm90IGxvb2sgbG93ZXIuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hdGNoaW5nQ29tbWFuZHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBzdHJpbmcgdGhhdCByZXByZXNlbnRzIGEgcGF0dGVybiBhbmQgcmV0dXJuIGEgYFNob3J0dWN0UGF0dGVybmAuXG4gICAgICogU3VwcG9ydGVkIHBhdHRlcm4gaXM6IFttb2RpZmllcitdKls8Y29kZT58a2V5XVxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdHRlcm5cbiAgICAgKi9cbiAgICBwYXJzZVBhdHRlcm4ocGF0dGVybjogc3RyaW5nKTogU2hvcnRjdXRQYXR0ZXJuIHtcbiAgICAgICAgY29uc3QgdG9rZW5zID0gcGF0dGVyblxuICAgICAgICAgICAgLnJlcGxhY2UoL2NtZC9naSwgJ01FVEEnKVxuICAgICAgICAgICAgLnNwbGl0KC9bK10vKVxuICAgICAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi50cmltKCkpO1xuICAgICAgICBjb25zdCBrZXlDb2RlID0gdG9rZW5zLnBvcCgpO1xuICAgICAgICBjb25zdCBtb2RpZmllcnMgPSBuZXcgU2V0KHRva2Vucy5tYXAodG9rZW4gPT4gdG9rZW4udG9VcHBlckNhc2UoKSkpO1xuICAgICAgICBpZiAoIWtleUNvZGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUga2V5IG9yIGNvZGUuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlcmUgYXJlIHR3byB3YXlzIHRvIHNwZWNpZnkgYSBzaG9ydGN1dCBob3RrZXkgOiBrZXkgb3IgY29kZVxuICAgICAgICAvLyAtIFwiQ1RSTCsxXCIgaXMgdGhlIG1vZGlmaWVyIENUUkwgd2l0aCB0aGUgZXZlbnQua2V5IFwiMVwiLlxuICAgICAgICAvLyAtIFwiQ1RSTCs8S2V5MT5cIiBpcyB0aGUgbW9kaWZpZXIgQ1RSTCB3aXRoIHRoZSBldmVudC5jb2RlIFwiS2V5MVwiXG4gICAgICAgIGNvbnN0IGNvZGVNYXRjaCA9IGtleUNvZGUubWF0Y2goL148KFxcdyspPiQvKTtcbiAgICAgICAgaWYgKGNvZGVNYXRjaCAmJiBjb2RlTWF0Y2gubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgY29kZTogY29kZU1hdGNoWzFdLCBtb2RpZmllcnMgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IGtleToga2V5Q29kZS50b1VwcGVyQ2FzZSgpLCBtb2RpZmllcnMgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRha2UgYSBgU2hvcnR1Y3RQYXR0ZXJuYCBhbmQgcmV0dXJuIGEgc3RyaW5nIHRoYXQgcmVwcmVzZW50cyBhIHBhdHRlcm4sXG4gICAgICogaW4gdGhlIGZvcm0gW21vZGlmaWVyK10qWzxjb2RlPnxrZXldLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdHRlcm5cbiAgICAgKi9cbiAgICBzdHJpbmdpZnlQYXR0ZXJuKHBhdHRlcm46IFNob3J0Y3V0UGF0dGVybik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gQXJyYXkuZnJvbShwYXR0ZXJuLm1vZGlmaWVycyk7XG4gICAgICAgIGlmICgnY29kZScgaW4gcGF0dGVybikge1xuICAgICAgICAgICAgcGFydHMucHVzaChwYXR0ZXJuLmNvZGUpO1xuICAgICAgICB9IGVsc2UgaWYgKCdrZXknIGluIHBhdHRlcm4pIHtcbiAgICAgICAgICAgIHBhcnRzLnB1c2gocGF0dGVybi5rZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcrJyk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGEgc2hvcnRjdXQgaW4gdGhlIGtleW1hcCBkZXBlbmRpbmcgb24gdGhlIHBsYXRmb3JtLlxuICAgICAqXG4gICAgICogLSBJZiB0aGUgc2hvcnR1Y3QgaGFzIG5vIHBsYXRmb3JtIHByb3BlcnR5OyBsb2FkIHRoZSBzaG9ydHVjdCBpbiBib3RoXG4gICAgICogICBwbGF0Zm9ybSAoJ21hYycgYW5kICdwYycpLlxuICAgICAqIC0gSWYgdGhlIHNob3J0dWN0IGhhcyBubyBwbGF0Zm9ybSBwcm9wZXJ0eSBhbmQgdGhlIGN1cnJlbnQgcGxhdGZvcm0gaXNcbiAgICAgKiAgIG1hYywgbW9kaWZ5IHRoZSBjdHJsIGtleSB0byBtZXRhIGtleS5cbiAgICAgKiAtIElmIHRoZSBzaG9ydHVjdCBoYXMgYSBwbGF0Zm9ybSBwcm9wZXJ0eSwgb25seSBsb2FkIHRoZSBzaG9ydGN1dCBmb3JcbiAgICAgKiAgIHRoYXQgcGxhdGZvcm0uXG4gICAgICogLSBJZiBubyBgbWFwcGluZy5jb21tYW5kSWRgIGlzIGRlY2xhcmVkLCBpdCBtZWFucyByZW1vdmluZyB0aGUgc2hvcnRjdXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2hvcnRjdXRzIFRoZSBzaG9ydHVjdCBkZWZpbml0aW9ucy5cbiAgICAgKiBAcGFyYW0gc291cmNlIFRoZSBzb3VyY2Ugb2YgdGhlIHNob3J0Y3V0cy5cbiAgICAgKi9cbiAgICBfbG9hZFNob3J0Y3V0cyhzaG9ydGN1dHM6IFNob3J0Y3V0W10sIHNvdXJjZT86IEpXUGx1Z2luIHwge30pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBzaG9ydGN1dCBvZiBbLi4uc2hvcnRjdXRzXSkge1xuICAgICAgICAgICAgLy8gQSBzaG9ydGN1dCBpcyBhIGNvbmZpZ3VyZWQgY29tbWFuZCBvbiB3aGljaCB0aGUgcHJvcGVydGllc1xuICAgICAgICAgICAgLy8gYHBhdHRlcm5gLCBhbmQgb3B0aW9uYWxseSBgcGxhdGZvcm1gLCB3ZXJlIHNldC5cbiAgICAgICAgICAgIGNvbnN0IHBsYXRmb3JtID0gc2hvcnRjdXQucGxhdGZvcm07XG4gICAgICAgICAgICBpZiAoIXBsYXRmb3JtIHx8IHBsYXRmb3JtID09PSB0aGlzLmNvbmZpZy5wbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIGxldCBwYXR0ZXJuID0gc2hvcnRjdXQucGF0dGVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21tYW5kOiBDb25maWd1cmVkQ29tbWFuZCA9IHNob3J0Y3V0O1xuICAgICAgICAgICAgICAgIC8vIFBhdHRlcm5zIHVzaW5nIHRoZSBDVFJMIG1vZGlmaWVyIHRhcmdldCBDTUQgaW5zdGVhZCBmb3IgTWFjLlxuICAgICAgICAgICAgICAgIGlmICghcGxhdGZvcm0gJiYgdGhpcy5jb25maWcucGxhdGZvcm0gPT09IFBsYXRmb3JtLk1BQykge1xuICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gc2hvcnRjdXQucGF0dGVybi5yZXBsYWNlKC9jdHJsL2dpLCAnQ01EJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBKV1BsdWdpbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmQocGF0dGVybiwgY29tbWFuZCwgTEVWRUwuREVGQVVMVCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iaW5kKHBhdHRlcm4sIGNvbW1hbmQsIExFVkVMLlVTRVIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGVQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBBY3Rpb25hYmxlR3JvdXBOb2RlUGFyYW1zIGV4dGVuZHMgQWJzdHJhY3ROb2RlUGFyYW1zIHtcbiAgICBuYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBBY3Rpb25hYmxlR3JvdXBOb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgZ3JvdXBOYW1lOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM/OiBBY3Rpb25hYmxlR3JvdXBOb2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKHBhcmFtcyk7XG4gICAgICAgIHRoaXMuZ3JvdXBOYW1lID0gcGFyYW1zPy5uYW1lO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZSc7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBtYWtlVmVyc2lvbmFibGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGUnO1xuXG5pbnRlcmZhY2UgQWN0aW9uYWJsZU5vZGVQYXJhbXMgZXh0ZW5kcyBBYnN0cmFjdE5vZGVQYXJhbXMge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIGNvbW1hbmRJZD86IHN0cmluZztcbiAgICBjb21tYW5kQXJncz86IENvbW1hbmRQYXJhbXM7XG4gICAgc2VsZWN0ZWQ/OiAoZWRpdG9yOiBKV0VkaXRvcikgPT4gYm9vbGVhbjtcbiAgICBlbmFibGVkPzogKGVkaXRvcjogSldFZGl0b3IpID0+IGJvb2xlYW47XG4gICAgdmlzaWJsZT86IChlZGl0b3I6IEpXRWRpdG9yKSA9PiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgQWN0aW9uYWJsZU5vZGUgZXh0ZW5kcyBBdG9taWNOb2RlIHtcbiAgICBhY3Rpb25OYW1lOiBzdHJpbmc7XG4gICAgbGFiZWw6IHN0cmluZztcbiAgICBjb21tYW5kSWQ/OiBzdHJpbmc7XG4gICAgY29tbWFuZEFyZ3M/OiBDb21tYW5kUGFyYW1zO1xuXG4gICAgY29uc3RydWN0b3IocGFyYW1zOiBBY3Rpb25hYmxlTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLmFjdGlvbk5hbWUgPSBwYXJhbXMubmFtZTtcbiAgICAgICAgdGhpcy5sYWJlbCA9IHBhcmFtcy5sYWJlbDtcbiAgICAgICAgdGhpcy5jb21tYW5kSWQgPSBwYXJhbXMuY29tbWFuZElkO1xuICAgICAgICB0aGlzLmNvbW1hbmRBcmdzID0gcGFyYW1zLmNvbW1hbmRBcmdzICYmIG1ha2VWZXJzaW9uYWJsZShwYXJhbXMuY29tbWFuZEFyZ3MpO1xuICAgICAgICBpZiAocGFyYW1zLnNlbGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gcGFyYW1zLnNlbGVjdGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gcGFyYW1zLmVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtcy52aXNpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSBwYXJhbXMudmlzaWJsZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBzdXBlci5uYW1lICsgJzogJyArIHRoaXMuYWN0aW9uTmFtZTtcbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgc2VsZWN0ZWQoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBlbmFibGVkKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICB2aXNpYmxlKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZVBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuXG5pbnRlcmZhY2UgTGFiZWxOb2RlUGFyYW1zIGV4dGVuZHMgQWJzdHJhY3ROb2RlUGFyYW1zIHtcbiAgICBsYWJlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgTGFiZWxOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgbGFiZWw6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IExhYmVsTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmxhYmVsID0gcGFyYW1zLmxhYmVsO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7XG4gICAgTGF5b3V0RW5naW5lLFxuICAgIENvbXBvbmVudERlZmluaXRpb24sXG4gICAgQ29tcG9uZW50SWQsXG4gICAgTGF5b3V0RW5naW5lQ29uc3RydWN0b3IsXG4gICAgTGF5b3V0RW5naW5lSWQsXG59IGZyb20gJy4vTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IFpvbmVJZGVudGlmaWVyIH0gZnJvbSAnLi9ab25lTm9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGF5b3V0Q29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIGNvbXBvbmVudHM/OiBDb21wb25lbnREZWZpbml0aW9uW107XG4gICAgY29tcG9uZW50Wm9uZXM/OiBbQ29tcG9uZW50SWQsIFpvbmVJZGVudGlmaWVyW11dW107XG59XG5cbmV4cG9ydCBjbGFzcyBMYXlvdXQ8VCBleHRlbmRzIExheW91dENvbmZpZyA9IExheW91dENvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgZW5naW5lczogUmVjb3JkPExheW91dEVuZ2luZUlkLCBMYXlvdXRFbmdpbmU+ID0ge307XG4gICAgcmVhZG9ubHkgbG9hZGVycyA9IHtcbiAgICAgICAgbGF5b3V0RW5naW5lczogdGhpcy5sb2FkRW5naW5lcyxcbiAgICAgICAgY29tcG9uZW50czogdGhpcy5sb2FkQ29tcG9uZW50cyxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IHRoaXMubG9hZENvbXBvbmVudHNab25lcyxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBzaG93OiB7XG4gICAgICAgICAgICB0aXRsZTogJ1Nob3cgYSBsYXlvdXQgY29tcG9uZW50JyxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuc2hvdy5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICB0aXRsZTogJ0hpZGUgYSBsYXlvdXQgY29tcG9uZW50JyxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaGlkZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5sb2FkQ29tcG9uZW50cyh0aGlzLmNvbmZpZ3VyYXRpb24uY29tcG9uZW50cyB8fCBbXSk7XG4gICAgICAgIHRoaXMubG9hZENvbXBvbmVudHNab25lcyh0aGlzLmNvbmZpZ3VyYXRpb24uY29tcG9uZW50Wm9uZXMgfHwgW10pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmVwZW5kIGEgQ29tcG9uZW50IGluIGEgem9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRJZFxuICAgICAqIEBwYXJhbSB6b25lSWRcbiAgICAgKiBAcGFyYW0gcHJvcHNcbiAgICAgKi9cbiAgICBhc3luYyBwcmVwZW5kKFxuICAgICAgICBjb21wb25lbnRJZDogQ29tcG9uZW50SWQsXG4gICAgICAgIHpvbmVJZDogWm9uZUlkZW50aWZpZXIgPSAnZGVmYXVsdCcsXG4gICAgICAgIHByb3BzPzoge30sXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGVuZ2luZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuZW5naW5lcyk7XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGVuZ2luZXMubWFwKGVuZ2luZSA9PiBlbmdpbmUucHJlcGVuZChjb21wb25lbnRJZCwgem9uZUlkLCBwcm9wcykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwZW5kIGEgQ29tcG9uZW50IGluIGEgem9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRJZFxuICAgICAqIEBwYXJhbSB6b25lSWRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBlbmQoXG4gICAgICAgIGNvbXBvbmVudElkOiBDb21wb25lbnRJZCxcbiAgICAgICAgem9uZUlkOiBab25lSWRlbnRpZmllciA9ICdkZWZhdWx0JyxcbiAgICAgICAgcHJvcHM/OiB7fSxcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZW5naW5lcyA9IE9iamVjdC52YWx1ZXModGhpcy5lbmdpbmVzKTtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoZW5naW5lcy5tYXAoZW5naW5lID0+IGVuZ2luZS5hcHBlbmQoY29tcG9uZW50SWQsIHpvbmVJZCwgcHJvcHMpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFyIGEgem9uZSBjb250ZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHpvbmVJZFxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyKHpvbmVJZDogWm9uZUlkZW50aWZpZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZW5naW5lcyA9IE9iamVjdC52YWx1ZXModGhpcy5lbmdpbmVzKTtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoZW5naW5lcy5tYXAoZW5naW5lID0+IGVuZ2luZS5jbGVhcih6b25lSWQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIGNvbXBvbmVudCAoaW5zdGFuY2Ugb3IgY2xvbnNlKSBmcm9tIHRoZSB6b25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXBvbmVudElkXG4gICAgICogQHBhcmFtIHpvbmVJZCBzcGVjaWZ5aW5nIGEgem9uZSBpZiBpdCBpcyBuZWNlc3NhcnkgdG8gcmVtb3ZlIHRoZVxuICAgICAqICAgICAgY29tcG9uZW50IGZyb20gdGhpcyB6b25lIG9ubHlcbiAgICAgKi9cbiAgICBhc3luYyByZW1vdmUoY29tcG9uZW50SWQ6IENvbXBvbmVudElkLCB6b25lSWQ/OiBab25lSWRlbnRpZmllcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGxheW91dEVuZ2luZSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZW5naW5lcykpIHtcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2gobGF5b3V0RW5naW5lLnJlbW92ZShjb21wb25lbnRJZCwgem9uZUlkKSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTaG93IGNvbXBvbmVudCAoaW5zdGFuY2Ugb3IgY2xvbnNlKSBpbnNpZGUgdGhlIHpvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgc2hvdyhwYXJhbXM6IHsgY29tcG9uZW50SWQ6IENvbXBvbmVudElkIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBsYXlvdXRFbmdpbmUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpKSB7XG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKGxheW91dEVuZ2luZS5zaG93KHBhcmFtcy5jb21wb25lbnRJZCkpO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGlkZSBjb21wb25lbnQgKGluc3RhbmNlIG9yIGNsb25zZSkgaW5zaWRlIHRoZSB6b25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFzeW5jIGhpZGUocGFyYW1zOiB7IGNvbXBvbmVudElkOiBDb21wb25lbnRJZCB9KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHByb21pc2VzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbGF5b3V0RW5naW5lIG9mIE9iamVjdC52YWx1ZXModGhpcy5lbmdpbmVzKSkge1xuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChsYXlvdXRFbmdpbmUuaGlkZShwYXJhbXMuY29tcG9uZW50SWQpKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBsYXlvdXQgZW5naW5lcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsYXlvdXRFbmdpbmVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBsb2FkRW5naW5lcyhsYXlvdXRFbmdpbmVzOiBMYXlvdXRFbmdpbmVDb25zdHJ1Y3RvcltdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgRW5naW5lQ2xhc3Mgb2YgbGF5b3V0RW5naW5lcykge1xuICAgICAgICAgICAgY29uc3QgZW5naW5lID0gbmV3IEVuZ2luZUNsYXNzKHRoaXMuZWRpdG9yKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZ2luZXNbZW5naW5lLmNvbnN0cnVjdG9yLmlkXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUmVuZGVyaW5nIGVuZ2luZSAke0VuZ2luZUNsYXNzLm5hbWV9IGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZW5naW5lc1tlbmdpbmUuY29uc3RydWN0b3IuaWRdID0gZW5naW5lO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvYWQgY29tcG9uZW50cyBpbnRvIGFsbCBsYXlvdXQgZW5naW5lcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBDb21wb25lbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSBsb2FkQ29tcG9uZW50cyhDb21wb25lbnRzOiBDb21wb25lbnREZWZpbml0aW9uW10pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBDb21wb25lbnQgb2YgQ29tcG9uZW50cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBsYXlvdXRFbmdpbmUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpKSB7XG4gICAgICAgICAgICAgICAgbGF5b3V0RW5naW5lLmxvYWRDb21wb25lbnQoQ29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIGNvbXBvbmVudCB6b25lcyBpbnRvIGFsbCBsYXlvdXQgZW5naW5lcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRzWm9uZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIGxvYWRDb21wb25lbnRzWm9uZXMoY29tcG9uZW50c1pvbmVzOiBbQ29tcG9uZW50SWQsIFpvbmVJZGVudGlmaWVyW11dW10pOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgem9uZXM6IFJlY29yZDxDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXJbXT4gPSB7fTtcbiAgICAgICAgZm9yIChjb25zdCBbaWQsIHpvbmVdIG9mIGNvbXBvbmVudHNab25lcykge1xuICAgICAgICAgICAgem9uZXNbaWRdID0gem9uZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGxheW91dEVuZ2luZSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZW5naW5lcykpIHtcbiAgICAgICAgICAgIGxheW91dEVuZ2luZS5sb2FkQ29tcG9uZW50Wm9uZXMoem9uZXMpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFpvbmVJZGVudGlmaWVyLCBab25lTm9kZSB9IGZyb20gJy4vWm9uZU5vZGUnO1xuaW1wb3J0IHsgVmVyc2lvbmFibGVBcnJheSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZUFycmF5JztcbmltcG9ydCB7IFZlcnNpb25hYmxlT2JqZWN0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlT2JqZWN0JztcblxuZXhwb3J0IHR5cGUgQ29tcG9uZW50SWQgPSBzdHJpbmc7XG5leHBvcnQgdHlwZSBMYXlvdXRFbmdpbmVJZCA9IHN0cmluZztcbmV4cG9ydCB0eXBlIERvbVpvbmVQb3NpdGlvbiA9ICdhZnRlcicgfCAncHJlcGVuZCcgfCAnYXBwZW5kJyB8ICdyZXBsYWNlJztcblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnREZWZpbml0aW9uIHtcbiAgICBpZDogQ29tcG9uZW50SWQ7XG4gICAgcmVuZGVyOiAoZWRpdG9yOiBKV0VkaXRvciwgcHJvcHM/OiB7fSkgPT4gUHJvbWlzZTxWTm9kZVtdPjtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIExheW91dEVuZ2luZSB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkOiBMYXlvdXRFbmdpbmVJZDtcbiAgICBwcm90ZWN0ZWQgY29tcG9uZW50RGVmaW5pdGlvbnM6IFJlY29yZDxDb21wb25lbnRJZCwgQ29tcG9uZW50RGVmaW5pdGlvbj4gPSB7fTtcbiAgICBwcm90ZWN0ZWQgY29tcG9uZW50Wm9uZXM6IFJlY29yZDxDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXJbXT4gPSB7fTtcbiAgICByZWFkb25seSByb290ID0gbmV3IFpvbmVOb2RlKHsgbWFuYWdlZFpvbmVzOiBbJ3Jvb3QnXSB9KTtcblxuICAgIGNvbXBvbmVudHMgPSBuZXcgVmVyc2lvbmFibGVPYmplY3QoKSBhcyBSZWNvcmQ8Q29tcG9uZW50SWQsIFZOb2RlW10+O1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGVkaXRvcjogSldFZGl0b3IpIHt9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQXV0b21hdGljYWxseSBpbnRhbmNpYXRlIHRoZSBjb21wb25lbnRzIGluIGF2YWlsYWJsZSB6b25lcy5cbiAgICAgKi9cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgbGV0IGFsbFpvbmVzID0gW3RoaXMucm9vdCwgLi4udGhpcy5yb290LmRlc2NlbmRhbnRzKFpvbmVOb2RlKV07XG4gICAgICAgIGF3YWl0IHRoaXMuZmlsbFpvbmVzKGFsbFpvbmVzKTtcbiAgICAgICAgYWxsWm9uZXMgPSBbdGhpcy5yb290LCAuLi50aGlzLnJvb3QuZGVzY2VuZGFudHMoWm9uZU5vZGUpXTtcbiAgICAgICAgaWYgKCFhbGxab25lcy5maW5kKHpvbmUgPT4gem9uZS5tYW5hZ2VkWm9uZXMuaW5jbHVkZXMoJ2RlZmF1bHQnKSkpIHtcbiAgICAgICAgICAgIC8vIEFkZCBpbnRvIHRoZSBkZWZhdWx0IHpvbmUgaWYgbm8gdmFsaWQgem9uZSBjb3VsZCBiZSBmb3VuZC5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGRlZmluZSBhIFwiZGVmYXVsdFwiIHpvbmUgaW4geW91ciB0ZW1wbGF0ZS4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVkaXRvci5tZW1vcnkuYXR0YWNoKHRoaXMucm9vdCk7XG4gICAgICAgIHRoaXMuZWRpdG9yLm1lbW9yeS5hdHRhY2godGhpcy5jb21wb25lbnRzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGlkZSBhbGwgY29tcG9uZW50cy5cbiAgICAgKi9cbiAgICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBmb3IgKGNvbnN0IGlkIGluIHRoaXMuY29tcG9uZW50cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuY29tcG9uZW50c1tpZF0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCB6b25lID0gbm9kZS5hbmNlc3Rvcihab25lTm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHpvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgem9uZS5oaWRlKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zID0ge307XG4gICAgICAgIHRoaXMuY29tcG9uZW50Wm9uZXMgPSB7fTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRzID0ge307XG4gICAgICAgIHRoaXMucm9vdC5lbXB0eSgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBMb2FkIHRoZSBnaXZlbiBDb21wb25lbnQgaW4gdGhpcyBsYXlvdXQgZW5naW5lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXBvbmVudERlZmluaXRpb25cbiAgICAgKi9cbiAgICBsb2FkQ29tcG9uZW50KGNvbXBvbmVudERlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb21wb25lbnREZWZpbml0aW9uc1tjb21wb25lbnREZWZpbml0aW9uLmlkXSA9IGNvbXBvbmVudERlZmluaXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvYWQgY29tcG9uZW50IHpvbmVzIGluIHRoaXMgbGF5b3V0IGVuZ2luZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRab25lc1xuICAgICAqL1xuICAgIGxvYWRDb21wb25lbnRab25lcyhjb21wb25lbnRab25lczogUmVjb3JkPENvbXBvbmVudElkLCBab25lSWRlbnRpZmllcltdPik6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29tcG9uZW50Wm9uZXMsIGNvbXBvbmVudFpvbmVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmVwZW5kIHRoZSBnaXZlbiBub2RlIGluIHRoZSBnaXZlbiB6b25lIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlLCBhZGQgaXQgaW5cbiAgICAgKiB0aGUgZGVmYXVsdCB6b25lLlxuICAgICAqIFJldHVybiBldmVyeSBjcmVhdGVkIGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKiBAcGFyYW0gem9uZUlkXG4gICAgICogQHBhcmFtIHByb3BzXG4gICAgICovXG4gICAgYXN5bmMgcHJlcGVuZChjb21wb25lbnRJZDogQ29tcG9uZW50SWQsIHpvbmVJZDogWm9uZUlkZW50aWZpZXIsIHByb3BzPzoge30pOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgYWxsWm9uZXMgPSBbdGhpcy5yb290LCAuLi50aGlzLnJvb3QuZGVzY2VuZGFudHMoWm9uZU5vZGUpXTtcbiAgICAgICAgbGV0IG1hdGNoaW5nWm9uZXMgPSBhbGxab25lcy5maWx0ZXIobm9kZSA9PiBub2RlLm1hbmFnZWRab25lcy5pbmNsdWRlcyh6b25lSWQpKTtcbiAgICAgICAgaWYgKCFtYXRjaGluZ1pvbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgbWF0Y2hpbmdab25lcyA9IGFsbFpvbmVzLmZpbHRlcih6b25lID0+IHpvbmUubWFuYWdlZFpvbmVzLmluY2x1ZGVzKCdkZWZhdWx0JykpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudERlZmluaXRpb24gPSB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudElkXTtcbiAgICAgICAgY29uc3QgbmV3Q29tcG9uZW50cyA9IGF3YWl0IHRoaXMuX2luc3RhbnRpYXRlQ29tcG9uZW50KFxuICAgICAgICAgICAgY29tcG9uZW50RGVmaW5pdGlvbixcbiAgICAgICAgICAgIG1hdGNoaW5nWm9uZXMsXG4gICAgICAgICAgICBwcm9wcyxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbGxab25lcyhuZXdDb21wb25lbnRzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwZW5kIHRoZSBnaXZlbiBub2RlIGluIHRoZSBnaXZlbiB6b25lIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlLCBhZGQgaXQgaW5cbiAgICAgKiB0aGUgZGVmYXVsdCB6b25lLlxuICAgICAqIFJldHVybiBldmVyeSBjcmVhdGVkIGluc3RhbmNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50RGVmaW5pdGlvblxuICAgICAqIEBwYXJhbSB6b25lSWRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBlbmQoY29tcG9uZW50SWQ6IENvbXBvbmVudElkLCB6b25lSWQ6IFpvbmVJZGVudGlmaWVyLCBwcm9wcz86IHt9KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGFsbFpvbmVzID0gW3RoaXMucm9vdCwgLi4udGhpcy5yb290LmRlc2NlbmRhbnRzKFpvbmVOb2RlKV07XG4gICAgICAgIGxldCBtYXRjaGluZ1pvbmVzID0gYWxsWm9uZXMuZmlsdGVyKG5vZGUgPT4gbm9kZS5tYW5hZ2VkWm9uZXMuaW5jbHVkZXMoem9uZUlkKSk7XG4gICAgICAgIGlmICghbWF0Y2hpbmdab25lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG1hdGNoaW5nWm9uZXMgPSBhbGxab25lcy5maWx0ZXIoem9uZSA9PiB6b25lLm1hbmFnZWRab25lcy5pbmNsdWRlcygnZGVmYXVsdCcpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb21wb25lbnREZWZpbml0aW9uID0gdGhpcy5jb21wb25lbnREZWZpbml0aW9uc1tjb21wb25lbnRJZF07XG4gICAgICAgIGNvbnN0IG5ld0NvbXBvbmVudHMgPSBhd2FpdCB0aGlzLl9pbnN0YW50aWF0ZUNvbXBvbmVudChcbiAgICAgICAgICAgIGNvbXBvbmVudERlZmluaXRpb24sXG4gICAgICAgICAgICBtYXRjaGluZ1pvbmVzLFxuICAgICAgICAgICAgcHJvcHMsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbGxab25lcyhuZXdDb21wb25lbnRzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBSZW1vdmUgdGhlIGNvbXBvbmVudCBpZGVudGlmaWVkIGJ5IHRoZSBnaXZlbiByZWZlcmVuY2UgZnJvbSBhbGwgem9uZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKiBAcGFyYW0gem9uZUlkIHNwZWNpZnlpbmcgYSB6b25lIGlmIGl0IGlzIG5lY2Vzc2FyeSB0byByZW1vdmUgdGhlXG4gICAgICogICAgICBjb21wb25lbnQgZnJvbSB0aGlzIHpvbmUgb25seVxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShjb21wb25lbnRJZDogQ29tcG9uZW50SWQsIHpvbmVJZD86IFpvbmVJZGVudGlmaWVyKTogUHJvbWlzZTxab25lTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSBbLi4uKHRoaXMuY29tcG9uZW50c1tjb21wb25lbnRJZF0gfHwgW10pXTtcbiAgICAgICAgY29uc3Qgem9uZXM6IFpvbmVOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IGNvbXBvbmVudDogVk5vZGU7XG4gICAgICAgIHdoaWxlICgoY29tcG9uZW50ID0gY29tcG9uZW50cy5wb3AoKSkpIHtcbiAgICAgICAgICAgIC8vIGZpbHRlciBieSB6b25lIGlmIG5lZWRlZFxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICF6b25lSWQgfHxcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuYW5jZXN0b3IoXG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yID0+XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNlc3RvciBpbnN0YW5jZW9mIFpvbmVOb2RlICYmIGFuY2VzdG9yLm1hbmFnZWRab25lcy5pbmNsdWRlcyh6b25lSWQpLFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgaW5zdGFuY2VzIGluIHRoZSB6b25lIGNoaWxkcmVuLlxuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyKGNvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBpbnN0YW5jZS5cbiAgICAgICAgICAgICAgICBjb25zdCB6b25lID0gY29tcG9uZW50LmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoem9uZSAmJiAhem9uZXMuaW5jbHVkZXMoem9uZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgem9uZXMucHVzaCh6b25lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6b25lcztcbiAgICB9XG4gICAgYXN5bmMgY2xlYXIoem9uZUlkOiBab25lSWRlbnRpZmllcik6IFByb21pc2U8Wm9uZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCB6b25lcyA9IHRoaXMucm9vdFxuICAgICAgICAgICAgLmRlc2NlbmRhbnRzKFpvbmVOb2RlKVxuICAgICAgICAgICAgLmZpbHRlcih6b25lID0+IHpvbmUubWFuYWdlZFpvbmVzLmluY2x1ZGVzKHpvbmVJZCkpO1xuICAgICAgICBmb3IgKGNvbnN0IHpvbmUgb2Ygem9uZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyKHpvbmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6b25lcztcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBTaG93IHRoZSBjb21wb25lbnRzIGNvcnJlc3BvbmRpbmcgdG8gZ2l2ZW4gcmVmLiBSZXR1cm4gdGhlIHVwZGF0ZWQgem9uZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KGNvbXBvbmVudElkOiBDb21wb25lbnRJZCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudElkXTtcbiAgICAgICAgaWYgKCFjb21wb25lbnRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignTm8gY29tcG9uZW50IHRvIHNob3cuIFByZXBlbmQgb3IgYXBwZW5kIGl0IGluIGEgem9uZSBmaXJzdC4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIGNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB6b25lID0gY29tcG9uZW50LmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgICAgICAgICB6b25lLnNob3coY29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcG9uZW50cyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBIaWRlIHRoZSBjb21wb25lbnRzIGNvcnJlc3BvbmRpbmcgdG8gZ2l2ZW4gcmVmLiBSZXR1cm4gdGhlIHVwZGF0ZWQgem9uZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKi9cbiAgICBhc3luYyBoaWRlKGNvbXBvbmVudElkOiBDb21wb25lbnRJZCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudElkXTtcbiAgICAgICAgaWYgKCFjb21wb25lbnRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignTm8gY29tcG9uZW50IHRvIGhpZGUuIFByZXBlbmQgb3IgYXBwZW5kIGl0IGluIGEgem9uZSBmaXJzdC4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIGNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB6b25lID0gY29tcG9uZW50LmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgICAgICAgICB6b25lLmhpZGUoY29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcG9uZW50cyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlIHN0cmluZyBpcyBhIHpvbmUgaWQgd2hlcmUgYXQgbGVhdCBvbmUgY29tcG9uZW50IHdpbGwgYmVcbiAgICAgKiBhdXRvbWF0aWNhbGx5IGFkZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHpvbmVJZFxuICAgICAqL1xuICAgIGhhc0NvbmZpZ3VyZWRDb21wb25lbnRzKHpvbmVJZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIENoZWNrIHRoZSB6b25lIGxpc3QuXG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5jb21wb25lbnRab25lcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50Wm9uZXNbY29tcG9uZW50SWRdPy5pbmNsdWRlcyh6b25lSWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIGNvbXBvbmVudHMgYWxsIGhhdmUgYXQgbGVhc3Qgb25lIHpvbmUgZXF1YWwgdG8gdGhlaXIgaWQuXG4gICAgICAgIHJldHVybiAhIXRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnNbem9uZUlkXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VhcmNoIGludG8gdGhpcyBuZXcgbm9kZXMgaWYgdGhleSBhcmUgc29tZSBab25lTm9kZSBhbmQgYXV0b21hdGljYWxseVxuICAgICAqIGZpbGwgaXQgYnkgdGhlIGNvbXBvbmVudHMgd2hpY2ggbWF0Y2ggd2l0aCB0aGlzIHpvbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVzXG4gICAgICovXG4gICAgYXN5bmMgZmlsbFpvbmVzKG5vZGVzOiBWTm9kZVtdKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IG5ld0NvbXBvbmVudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBbLi4ubm9kZXNdO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBjb25zdCB6b25lcyA9IG5vZGUuZGVzY2VuZGFudHMoWm9uZU5vZGUpO1xuICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBab25lTm9kZSkge1xuICAgICAgICAgICAgICAgIHpvbmVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5jb21wb25lbnREZWZpbml0aW9ucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHpvbmVJZHMgPSB0aGlzLmNvbXBvbmVudFpvbmVzW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXlvdXRDb21wb25lbnQgPSB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgdGhlIHpvbmVzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIGlkZW50aWZpZXIuXG4gICAgICAgICAgICAgICAgbGV0IG1hdGNoaW5nWm9uZXMgPSB6b25lcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgIHpvbmUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICh6b25lSWRzICYmIHpvbmUubWFuYWdlZFpvbmVzLmZpbmQoem9uZUlkID0+IHpvbmVJZHMuaW5jbHVkZXMoem9uZUlkKSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICB6b25lLm1hbmFnZWRab25lcy5pbmNsdWRlcyhjb21wb25lbnRJZCksXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudElkXTtcbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50cykge1xuICAgICAgICAgICAgICAgICAgICAvLyBFeGNsdWRpbmcgdGhlIG9uZXMgdGhhdCBhcmUgY29udGFpbmVkIHdpdGhpbiB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgbG9vcCB3aXRoIGNoaWxkIGluIGl0c2VsZi5cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdab25lcyA9IG1hdGNoaW5nWm9uZXMuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgem9uZSA9PiAhem9uZS5jbG9zZXN0KGFuY2VzdG9yID0+IGNvbXBvbmVudHMuaW5jbHVkZXMoYW5jZXN0b3IpKSxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoaW5nWm9uZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4oYXdhaXQgdGhpcy5faW5zdGFudGlhdGVDb21wb25lbnQobGF5b3V0Q29tcG9uZW50LCBtYXRjaGluZ1pvbmVzKSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3Q29tcG9uZW50cy5wdXNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdDb21wb25lbnRzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfaW5zdGFudGlhdGVDb21wb25lbnQoXG4gICAgICAgIGNvbXBvbmVudERlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb24sXG4gICAgICAgIHpvbmVzOiBab25lTm9kZVtdLFxuICAgICAgICBwcm9wcz86IHt9LFxuICAgICAgICBwcmVwZW5kID0gZmFsc2UsXG4gICAgKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGxldCBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzW2NvbXBvbmVudERlZmluaXRpb24uaWRdO1xuICAgICAgICBpZiAoIWNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIC8vIFNldCB0aGUgbG9jYWwgcmVmZXJlbmNlLlxuICAgICAgICAgICAgY29tcG9uZW50cyA9IG5ldyBWZXJzaW9uYWJsZUFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudHNbY29tcG9uZW50RGVmaW5pdGlvbi5pZF0gPSBjb21wb25lbnRzO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFkZCBpbnRvIHRoZSBjb250YWluZXIuXG4gICAgICAgIGNvbnN0IG5ld0NvbXBvbmVudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCB6b25lIG9mIHpvbmVzKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IGNvbXBvbmVudERlZmluaXRpb24ucmVuZGVyKHRoaXMuZWRpdG9yLCBwcm9wcyk7XG4gICAgICAgICAgICBjb21wb25lbnRzLnB1c2goLi4ubm9kZXMpO1xuICAgICAgICAgICAgbmV3Q29tcG9uZW50cy5wdXNoKC4uLm5vZGVzKTtcbiAgICAgICAgICAgIGlmIChwcmVwZW5kKSB7XG4gICAgICAgICAgICAgICAgem9uZS5wcmVwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgem9uZS5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJldHVybiB0aGUgY29tcG9uZW50cyB0aGF0IHdlcmUgbmV3bHkgY3JlYXRlZC5cbiAgICAgICAgcmV0dXJuIG5ld0NvbXBvbmVudHM7XG4gICAgfVxuICAgIHByaXZhdGUgX2NsZWFyKGNvbXBvbmVudDogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgem9uZXMgPSBjb21wb25lbnQuZGVzY2VuZGFudHMoWm9uZU5vZGUpO1xuICAgICAgICBpZiAoY29tcG9uZW50IGluc3RhbmNlb2YgWm9uZU5vZGUpIHtcbiAgICAgICAgICAgIHpvbmVzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHpvbmUgb2Ygem9uZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2Ygem9uZS5jaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgem9uZS5yZW1vdmVDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmNvbXBvbmVudHNbaWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZXMuaW5jbHVkZXMoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2Uobm9kZXMuaW5kZXhPZihjaGlsZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgaW50ZXJmYWNlIExheW91dEVuZ2luZSB7XG4gICAgY29uc3RydWN0b3I6IExheW91dEVuZ2luZUNvbnN0cnVjdG9yICYge1xuICAgICAgICBpZDogTGF5b3V0RW5naW5lSWQ7XG4gICAgfTtcbn1cbmV4cG9ydCB0eXBlIExheW91dEVuZ2luZUNvbnN0cnVjdG9yID0ge1xuICAgIG5ldyAoZWRpdG9yOiBKV0VkaXRvcik6IExheW91dEVuZ2luZTtcbn07XG4iLCJpbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBtYWtlVmVyc2lvbmFibGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGUnO1xuXG5leHBvcnQgdHlwZSBab25lSWRlbnRpZmllciA9IHN0cmluZztcbmV4cG9ydCBpbnRlcmZhY2UgWm9uZU5vZGVQYXJhbXMgZXh0ZW5kcyBBYnN0cmFjdE5vZGVQYXJhbXMge1xuICAgIG1hbmFnZWRab25lczogWm9uZUlkZW50aWZpZXJbXTtcbn1cblxuZXhwb3J0IGNsYXNzIFpvbmVOb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgaGlkZGVuOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjtcbiAgICBlZGl0YWJsZSA9IGZhbHNlO1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xuICAgIG1hbmFnZWRab25lczogWm9uZUlkZW50aWZpZXJbXTtcblxuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogWm9uZU5vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgdGhpcy5tYW5hZ2VkWm9uZXMgPSBtYWtlVmVyc2lvbmFibGUocGFyYW1zLm1hbmFnZWRab25lcyk7XG4gICAgfVxuXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLm5hbWUgKyAnOiAnICsgdGhpcy5tYW5hZ2VkWm9uZXMuam9pbigpO1xuICAgIH1cblxuICAgIGhpZGUoY2hpbGQ6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5oaWRkZW4pIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gbWFrZVZlcnNpb25hYmxlKHt9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhpZGRlbltjaGlsZC5pZF0gPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHNob3coY2hpbGQ6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGlkID0gY2hpbGQuaWQ7XG4gICAgICAgIGlmICh0aGlzLmhpZGRlbj8uW2lkXSkge1xuICAgICAgICAgICAgdGhpcy5oaWRkZW5baWRdID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGFyZW50Wm9uZTogWm9uZU5vZGUgPSB0aGlzLmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgaWYgKHBhcmVudFpvbmUpIHtcbiAgICAgICAgICAgIHBhcmVudFpvbmUuc2hvdyh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfcmVtb3ZlQXRJbmRleChpbmRleDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5jaGlsZFZOb2Rlc1tpbmRleF07XG4gICAgICAgIHN1cGVyLl9yZW1vdmVBdEluZGV4KGluZGV4KTtcbiAgICAgICAgaWYgKHRoaXMuaGlkZGVuKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5oaWRkZW5bY2hpbGQuaWRdO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTGluZUJyZWFrTm9kZSB9IGZyb20gJy4vTGluZUJyZWFrTm9kZSc7XG5pbXBvcnQgeyBMaW5lQnJlYWtYbWxEb21QYXJzZXIgfSBmcm9tICcuL0xpbmVCcmVha1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMaW5lQnJlYWtEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vTGluZUJyZWFrRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgQ29yZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5cbmV4cG9ydCBjbGFzcyBMaW5lQnJlYWs8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0xpbmVCcmVha1htbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW0xpbmVCcmVha0RvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBpbnNlcnRMaW5lQnJlYWs6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0TGluZUJyZWFrLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgbGluZSBicmVhayBub2RlIGF0IHJhbmdlLlxuICAgICAqL1xuICAgIGluc2VydExpbmVCcmVhayhwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHBhcmFtcy5jb250ZXh0LmV4ZWNDb21tYW5kPENvcmU+KCdpbnNlcnQnLCB7XG4gICAgICAgICAgICBub2RlOiBuZXcgTGluZUJyZWFrTm9kZSgpLFxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi9MaW5lQnJlYWtOb2RlJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuZXhwb3J0IGNsYXNzIExpbmVCcmVha0RvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBMaW5lQnJlYWtOb2RlO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSB0byB0aGUgZ2l2ZW4gZm9ybWF0LlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihcbiAgICAgICAgbm9kZTogTGluZUJyZWFrTm9kZSxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBicjogRG9tT2JqZWN0ID0geyB0YWc6ICdCUicgfTtcbiAgICAgICAgd29ya2VyLmxvY2F0ZShbbm9kZV0sIGJyKTtcbiAgICAgICAgaWYgKCFub2RlLm5leHRTaWJsaW5nKCkpIHtcbiAgICAgICAgICAgIC8vIElmIGEgTGluZUJyZWFrTm9kZSBoYXMgbm8gbmV4dCBzaWJsaW5nLCBpdCBtdXN0IGJlIHJlbmRlcmVkXG4gICAgICAgICAgICAvLyBhcyB0d28gQlJzIGluIG9yZGVyIGZvciBpdCB0byBiZSB2aXNpYmxlLlxuICAgICAgICAgICAgY29uc3QgYnIyID0geyB0YWc6ICdCUicgfTtcbiAgICAgICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IHsgY2hpbGRyZW46IFticiwgYnIyXSB9O1xuICAgICAgICAgICAgd29ya2VyLmxvY2F0ZShbbm9kZV0sIGJyMik7XG4gICAgICAgICAgICByZXR1cm4gZG9tT2JqZWN0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBicjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFNlcGFyYXRvck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvU2VwYXJhdG9yTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBMaW5lQnJlYWtOb2RlIGV4dGVuZHMgU2VwYXJhdG9yTm9kZSB7XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuICfihrInO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBUcmFuc2Zvcm0gdGhlIGdpdmVuIERPTSBsb2NhdGlvbiBpbnRvIGl0cyBWRG9jdW1lbnQgY291bnRlcnBhcnQuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcGFyYW0gZG9tTm9kZSBET00gbm9kZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgVk5vZGVcbiAgICAgKiBAcGFyYW0gb2Zmc2V0IFRoZSBvZmZzZXQgb2YgdGhlIGxvY2F0aW9uIGluIHRoZSBnaXZlbiBkb21Ob2RlXG4gICAgICovXG4gICAgbG9jYXRlKGRvbU5vZGU6IE5vZGUsIG9mZnNldDogbnVtYmVyKTogW3RoaXMsIFJlbGF0aXZlUG9zaXRpb25dIHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBzdXBlci5sb2NhdGUoZG9tTm9kZSwgb2Zmc2V0KTtcbiAgICAgICAgLy8gV2hlbiBjbGlja2luZyBvbiBhIHRyYWlsaW5nIGxpbmUgYnJlYWssIHdlIG5lZWQgdG8gdGFyZ2V0IGFmdGVyIHRoZVxuICAgICAgICAvLyBsaW5lIGJyZWFrLiBUaGUgRE9NIHJlcHJlc2VudHMgdGhlc2UgYXMgMiA8YnI+IHNvIHRoaXMgaXMgYSBzcGVjaWFsXG4gICAgICAgIC8vIGNhc2UuXG4gICAgICAgIGlmICghdGhpcy5uZXh0U2libGluZygpICYmICFkb21Ob2RlLm5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICBsb2NhdGlvblsxXSA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvY2F0aW9uO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IExpbmVCcmVha05vZGUgfSBmcm9tICcuL0xpbmVCcmVha05vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBpc0Jsb2NrIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL2lzQmxvY2snO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgTGluZUJyZWFrWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnQlInO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxMaW5lQnJlYWtOb2RlW10+IHtcbiAgICAgICAgaWYgKHRoaXMuX2lzSW52aXNpYmxlQlIoaXRlbSkpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsaW5lQnJlYWsgPSBuZXcgTGluZUJyZWFrTm9kZSgpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxpbmVCcmVhay5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbbGluZUJyZWFrXTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiA8YnIvPiBub2RlIGlzIGludmlzaWJsZS4gQSA8YnIvPiBhdCB0aGUgZW5kIGVkZ2VcbiAgICAgKiBvZiBhIGJsb2NrIG9yIGJlZm9yZSBhbm90aGVyIGJsb2NrIGlzIHRoZXJlIG9ubHkgdG8gbWFrZSBpdHMgcGFyZW50XG4gICAgICogdmlzaWJsZS4gQ29uc3VtZSBpdCBzaW5jZSBpdCB3YXMganVzdCBwYXJzZWQgYXMgaXRzIHBhcmVudCBlbGVtZW50IG5vZGUuXG4gICAgICogVE9ETzogYWNjb3VudCBmb3IgZm9ybWF0dGluZyBzcGFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2lzSW52aXNpYmxlQlIobm9kZTogTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBTZWFyY2ggZm9yIGFub3RoZXIgbm9uLWJsb2NrIGNvdXNpbiBpbiB0aGUgc2FtZSBibG9jayBwYXJlbnQuXG4gICAgICAgIHdoaWxlIChub2RlICYmICFub2RlLm5leHRTaWJsaW5nICYmIG5vZGUucGFyZW50Tm9kZSAmJiAhaXNCbG9jayhub2RlLnBhcmVudE5vZGUpKSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhbm9kZSB8fCAhbm9kZS5uZXh0U2libGluZyB8fCBpc0Jsb2NrKG5vZGUubmV4dFNpYmxpbmcpO1xuICAgIH1cbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGVzPlxcbiAgICA8ZGl2IHQtbmFtZT1cXFwibGlua1xcXCI+XFxuICAgICAgICA8aDI+SW5zZXJ0IGEgbGluazwvaDI+XFxuICAgICAgICA8dGFibGUgY2xhc3M9XFxcImZvcm0tdGFibGVcXFwiPlxcbiAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgPHRkPjxsYWJlbCBmb3I9XFxcImxpbmtVcmxcXFwiPlVSTCA8L2xhYmVsPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZD48aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgaWQ9XFxcImxpbmtVcmxcXFwiIG5hbWU9XFxcInVybFxcXCIgdC1tb2RlbD1cXFwic3RhdGUudXJsXFxcIi8+PC90ZD5cXG4gICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgPHRkPjxsYWJlbCBmb3I9XFxcImxpbmtMYWJlbFxcXCI+TGFiZWwgPC9sYWJlbD48L3RkPlxcbiAgICAgICAgICAgICAgICA8dGQ+PGlucHV0IHR5cGU9XFxcInRleHRcXFwiIGlkPVxcXCJsaW5rTGFiZWxcXFwiIG5hbWU9XFxcImxhYmVsXFxcIiB0LW1vZGVsPVxcXCJzdGF0ZS5sYWJlbFxcXCIvPjwvdGQ+XFxuICAgICAgICAgICAgPC90cj5cXG4gICAgICAgIDwvdGFibGU+XFxuICAgICAgICA8YnIvPlxcbiAgICAgICAgPGJ1dHRvbiBuYW1lPVxcXCJzYXZlXFxcIiB0LW9uLWNsaWNrPVxcXCJzYXZlTGluaygpXFxcIj5TYXZlPC9idXR0b24+IDxidXR0b24gbmFtZT1cXFwic2F2ZVxcXCIgdC1vbi1jbGljaz1cXFwiY2FuY2VsKClcXFwiPkNhbmNlbDwvYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG48L3RlbXBsYXRlcz5cXG5cIiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBMaW5rWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9MaW5rWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcbmltcG9ydCB7IExpbmtGb3JtYXQgfSBmcm9tICcuL0xpbmtGb3JtYXQnO1xuaW1wb3J0IHsgQ2hhciB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IE1vZGlmaWVycyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGlmaWVycyc7XG5pbXBvcnQgeyBWTm9kZSwgVHlwZWd1YXJkIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCBsaW5rRm9ybSBmcm9tICcuLi9hc3NldHMvTGlua0Zvcm0ueG1sJztcbmltcG9ydCB7IE93bCB9IGZyb20gJy4uLy4uL3BsdWdpbi1vd2wvc3JjL093bCc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IE93bE5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xOb2RlJztcbmltcG9ydCB7IExpbmtDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvTGlua0NvbXBvbmVudCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlua1BhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGxhYmVsPzogc3RyaW5nO1xuICAgIHVybD86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IG9mIGFuIGh0bWwgYW5jaG9yLlxuICAgICAqIENvdWxkIGJlIFwiX2JsYW5rXCIsIFwiX3NlbGZcIiAsXCJfcGFyZW50XCIsIFwiX3RvcFwiIG9yIHRoZSBmcmFtZW5hbWUuXG4gICAgICovXG4gICAgdGFyZ2V0Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgTGluazxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGlzTGluayhub2RlOiBWTm9kZSk6IG5vZGUgaXMgSW5saW5lTm9kZTtcbiAgICBzdGF0aWMgaXNMaW5rKGxpbms6IExpbmtGb3JtYXQsIG5vZGU6IFZOb2RlKTogbm9kZSBpcyBJbmxpbmVOb2RlO1xuICAgIHN0YXRpYyBpc0xpbmsobGluazogTGlua0Zvcm1hdCB8IFZOb2RlLCBub2RlPzogVk5vZGUpOiBub2RlIGlzIElubGluZU5vZGUge1xuICAgICAgICBpZiAobGluayBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgbm9kZSA9IGxpbms7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZm9ybWF0ID0gbm9kZSBpbnN0YW5jZW9mIElubGluZU5vZGUgJiYgbm9kZS5tb2RpZmllcnMuZmluZChMaW5rRm9ybWF0KTtcbiAgICAgICAgcmV0dXJuIGxpbmsgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUgPyAhIWZvcm1hdCA6IGxpbmsuaXNTYW1lQXMoZm9ybWF0KTtcbiAgICB9XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBsaW5rOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmxpbmssXG4gICAgICAgIH0sXG4gICAgICAgIHVubGluazoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy51bmxpbmssXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBLZXltYXAgJiBMYXlvdXQgJiBPd2w+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbTGlua1htbERvbVBhcnNlcl0sXG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK0snLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBbKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PiAhTGluay5pc0xpbmsobm9kZSldLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2xpbmsnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtLJyxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogW0xpbmsuaXNMaW5rXSxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bmxpbmsnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnbGluaycsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKGVkaXRvcjogSldFZGl0b3IsIHByb3BzPzoge30pOiBQcm9taXNlPE93bE5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBPd2xOb2RlKHsgQ29tcG9uZW50OiBMaW5rQ29tcG9uZW50LCBwcm9wczogcHJvcHMgfSldO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnTGlua0J1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2xpbmsnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdJbnNlcnQgbGluaycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdsaW5rJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gcmFuZ2Uuc3RhcnQubmV4dFNpYmxpbmcoKSB8fCByYW5nZS5zdGFydC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBJbmxpbmVOb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEhbm9kZS5tb2RpZmllcnMuZmluZChMaW5rRm9ybWF0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLWxpbmsgZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ1VubGlua0J1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3VubGluaycsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1JlbW92ZSBpdGFsaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAndW5saW5rJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSByYW5nZS5zdGFydC5uZXh0U2libGluZygpIHx8IHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSBpbnN0YW5jZW9mIElubGluZU5vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISFub2RlLm1vZGlmaWVycy5maW5kKExpbmtGb3JtYXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtdW5saW5rIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbXG4gICAgICAgICAgICBbJ2xpbmsnLCBbJ2Zsb2F0J11dLFxuICAgICAgICAgICAgWydMaW5rQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgICAgIFsnVW5saW5rQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgXSxcbiAgICAgICAgb3dsVGVtcGxhdGVzOiBbbGlua0Zvcm1dLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYXN5bmMgbGluayhwYXJhbXM6IExpbmtQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gSWYgdGhlIHVybCBpcyB1bmRlZmluZWQsIGFzayB0aGUgdXNlciB0byBwcm92aWRlIG9uZS5cbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbmxpbmVzID0gcmFuZ2Uuc2VsZWN0ZWROb2RlcyhJbmxpbmVOb2RlKTtcbiAgICAgICAgY29uc3QgbGFiZWwgPSBwYXJhbXMubGFiZWwgfHwgc2VsZWN0ZWRJbmxpbmVzLm1hcChub2RlID0+IG5vZGUudGV4dENvbnRlbnQpLmpvaW4oJycpO1xuXG4gICAgICAgIGlmICghcGFyYW1zLnVybCkge1xuICAgICAgICAgICAgY29uc3QgZmlyc3RMaW5rID0gc2VsZWN0ZWRJbmxpbmVzLmZpbmQobm9kZSA9PiBub2RlLm1vZGlmaWVycy5maW5kKExpbmtGb3JtYXQpKTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBmaXJzdExpbmsgJiYgZmlyc3RMaW5rLm1vZGlmaWVycy5maW5kKExpbmtGb3JtYXQpLmNsb25lKCk7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBsaW5rPy51cmwgfHwgJyc7XG5cbiAgICAgICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCk7XG4gICAgICAgICAgICBhd2FpdCBsYXlvdXQucmVtb3ZlKCdsaW5rJyk7XG4gICAgICAgICAgICByZXR1cm4gbGF5b3V0LmFwcGVuZCgnbGluaycsIHVuZGVmaW5lZCwgeyBsYWJlbDogbGFiZWwsIHVybDogdXJsIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIGNyZWF0ZSBhIGxpbmsgYW5kIGluc2VydCBpdC5cbiAgICAgICAgY29uc3QgbGluayA9IG5ldyBMaW5rRm9ybWF0KHBhcmFtcy51cmwpO1xuICAgICAgICBpZiAocGFyYW1zLnRhcmdldCkge1xuICAgICAgICAgICAgbGluay5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgndGFyZ2V0JywgcGFyYW1zLnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcy5jb250ZXh0LmV4ZWNDb21tYW5kPENoYXI+KCdpbnNlcnRUZXh0Jywge1xuICAgICAgICAgICAgdGV4dDogbGFiZWwgfHwgbGluay51cmwsXG4gICAgICAgICAgICBmb3JtYXRzOiBuZXcgTW9kaWZpZXJzKGxpbmspLFxuICAgICAgICAgICAgY29udGV4dDogcGFyYW1zLmNvbnRleHQsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB1bmxpbmsocGFyYW1zOiBMaW5rUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG5cbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIC8vIElmIG5vIHJhbmdlIGlzIHNlbGVjdGVkIGFuZCB3ZSBhcmUgaW4gYSBMaW5rIDogcmVtb3ZlIHRoZSBjb21wbGV0ZSBsaW5rLlxuICAgICAgICAgICAgY29uc3QgcHJldmlvdXNOb2RlID0gcmFuZ2Uuc3RhcnQucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBuZXh0Tm9kZSA9IHJhbmdlLnN0YXJ0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gTGluay5pc0xpbmsocHJldmlvdXNOb2RlKSA/IHByZXZpb3VzTm9kZSA6IG5leHROb2RlO1xuICAgICAgICAgICAgaWYgKCFMaW5rLmlzTGluayhub2RlKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gbm9kZS5tb2RpZmllcnMuZmluZChMaW5rRm9ybWF0KTtcbiAgICAgICAgICAgIGNvbnN0IHNhbWVMaW5rOiBUeXBlZ3VhcmQ8SW5saW5lTm9kZT4gPSBMaW5rLmlzTGluay5iaW5kKExpbmssIGxpbmspO1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlTGlua09uTm9kZXMoW25vZGUsIC4uLm5vZGUuYWRqYWNlbnRzKHNhbWVMaW5rKV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgYSByYW5nZSBpcyBzZWxlY3RlZCA6IHJlbW92ZSBhbnkgbGluayBvbiB0aGUgc2VsZWN0ZWQgcmFuZ2UuXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVzID0gcmFuZ2Uuc2VsZWN0ZWROb2RlcyhJbmxpbmVOb2RlKTtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgZm9ybWF0ICdMaW5rRm9ybWF0JyBmb3IgYWxsIG5vZGVzLlxuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlTGlua09uTm9kZXMoc2VsZWN0ZWROb2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhbGwgbGluayBtb2RpZmllcnMgb24gdGhlIHByb3ZpZGVkIG5vZGVzLlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIG1haW5seSB1c2UgYnkgdGhlIHVubGluayBmdW5jdGlvbiBvZiB0aGUgZWRpdG9yLlxuICAgICAqL1xuICAgIF9yZW1vdmVMaW5rT25Ob2Rlcyhub2RlczogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLnJlbW92ZShMaW5rRm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBWZXJzaW9uYWJsZU9iamVjdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZU9iamVjdCc7XG5pbXBvcnQgeyBNb2RpZmllclByZXNlcnZlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuXG5leHBvcnQgY2xhc3MgTGlua0Zvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IodXJsID0gJyMnLCB0YXJnZXQgPSAnJykge1xuICAgICAgICBzdXBlcignQScpO1xuICAgICAgICB0aGlzLnByZXNlcnZlID0gbmV3IFZlcnNpb25hYmxlT2JqZWN0KHtcbiAgICAgICAgICAgIGFmdGVyOiB0cnVlLFxuICAgICAgICAgICAgcGFyYWdyYXBoQnJlYWs6IGZhbHNlLFxuICAgICAgICAgICAgbGluZUJyZWFrOiB0cnVlLFxuICAgICAgICB9KSBhcyBNb2RpZmllclByZXNlcnZlO1xuICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPOiBBdHRyaWJ1dGVzIG9uIExpbmsgc2hvdWxkIHJlYWN0aXZlbHkgcmVhZCB0aGUgdmFsdWVzIHNldCBvbiB0aGVcbiAgICAvLyBub2RlIGl0c2VsZiByYXRoZXIgdGhhbiBoYXZpbmcgdG8gbWFudWFsbHkgc3luY2hyb25pemUgdGhlbS5cbiAgICBnZXQgdXJsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5nZXQoJ2hyZWYnKTtcbiAgICB9XG5cbiAgICBzZXQgdXJsKHVybDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zZXQoJ2hyZWYnLCB1cmwpO1xuICAgIH1cblxuICAgIGdldCB0YXJnZXQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LmdldCgndGFyZ2V0JykgfHwgJyc7XG4gICAgfVxuXG4gICAgc2V0IHRhcmdldCh0YXJnZXQ6IHN0cmluZykge1xuICAgICAgICBpZiAodGFyZ2V0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgndGFyZ2V0JywgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBjbG9uZSgpOiB0aGlzIHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBzdXBlci5jbG9uZSgpO1xuICAgICAgICBjbG9uZS51cmwgPSB0aGlzLnVybDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdFhtbERvbVBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMaW5rRm9ybWF0IH0gZnJvbSAnLi9MaW5rRm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IExpbmVCcmVha05vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWtOb2RlJztcblxuZXhwb3J0IGNsYXNzIExpbmtYbWxEb21QYXJzZXIgZXh0ZW5kcyBGb3JtYXRYbWxEb21QYXJzZXIge1xuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ0EnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGxpbmsgPSBuZXcgTGlua0Zvcm1hdChpdGVtLmdldEF0dHJpYnV0ZSgnaHJlZicpKTtcbiAgICAgICAgLy8gVE9ETzogTGluayBzaG91bGQgbm90IGhhdmUgYW4gYEF0dHJpYnV0ZXNgIG1vZGlmaWVyIG91dHNpZGUgb2YgWE1MLlxuICAgICAgICAvLyBJbiBYTUwgY29udGV4dCB3ZSBuZWVkIHRvIGNvbnNlcnZlIHRoZSBvcmRlciBvZiBhdHRyaWJ1dGVzLlxuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxpbmsubW9kaWZpZXJzLnJlcGxhY2UoQXR0cmlidXRlcywgYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGxpbmssIGNoaWxkcmVuKTtcbiAgICAgICAgLy8gVGhlIGFwcGx5Rm9ybWF0IGhlbHBlciBvbmx5IGFwcGxpZXMgdGhlIGZvcm1hdCB0byBJbmxpbmVOb2Rlcy5cbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIExpbmVCcmVha05vZGUpIHtcbiAgICAgICAgICAgICAgICBsaW5rLmNsb25lKCkuYXBwbHlUbyhub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgTGlua1BhcmFtcyB9IGZyb20gJy4uL0xpbmsnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSAnQG9kb28vb3dsJztcblxuaW50ZXJmYWNlIExpbmtQcm9wcyB7XG4gICAgdXJsPzogc3RyaW5nO1xuICAgIGxhYmVsPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgTGlua0NvbXBvbmVudDxUIGV4dGVuZHMgTGlua1Byb3BzID0ge30+IGV4dGVuZHMgT3dsQ29tcG9uZW50PFQ+IHtcbiAgICBzdGF0aWMgY29tcG9uZW50cyA9IHt9O1xuICAgIHN0YXRpYyB0ZW1wbGF0ZSA9ICdsaW5rJztcbiAgICBzdGF0ZSA9IHVzZVN0YXRlKHtcbiAgICAgICAgdXJsOiB0aGlzLnByb3BzPy51cmwgfHwgJycsXG4gICAgICAgIGxhYmVsOiB0aGlzLnByb3BzPy5sYWJlbCB8fCAnJyxcbiAgICB9KTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBhc3luYyBzYXZlTGluaygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5lbnYuZWRpdG9yLmV4ZWNDb21tYW5kKGFzeW5jIGNvbnRleHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBMaW5rUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHVybDogdGhpcy5zdGF0ZS51cmwsXG4gICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuc3RhdGUubGFiZWwsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgY29udGV4dC5leGVjQ29tbWFuZCgnbGluaycsIHBhcmFtcyk7XG4gICAgICAgICAgICB0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KS5yZW1vdmUoJ2xpbmsnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgIH1cbiAgICBhc3luYyBjYW5jZWwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMuZW52LmVkaXRvci5leGVjQ29tbWFuZChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KS5yZW1vdmUoJ2xpbmsnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgIH1cbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9jaGVja2xpc3QuY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IExpc3ROb2RlLCBMaXN0VHlwZSB9IGZyb20gJy4vTGlzdE5vZGUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgTGlzdERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9MaXN0RG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgTGlzdEl0ZW1BdHRyaWJ1dGVzRG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4vTGlzdEl0ZW1BdHRyaWJ1dGVzRG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlcic7XG5pbXBvcnQgeyBMaXN0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9MaXN0WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExpc3RJdGVtWG1sRG9tUGFyc2VyLCBMaXN0SXRlbUF0dHJpYnV0ZXMgfSBmcm9tICcuL0xpc3RJdGVtWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZSYW5nZSc7XG5pbXBvcnQgeyBJbmRlbnRQYXJhbXMsIE91dGRlbnRQYXJhbXMgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5kZW50L3NyYy9JbmRlbnQnO1xuaW1wb3J0IHsgQ2hlY2tpbmdDb250ZXh0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvQ29udGV4dE1hbmFnZXInO1xuaW1wb3J0IHsgSW5zZXJ0UGFyYWdyYXBoQnJlYWtQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IERlbGV0ZUJhY2t3YXJkUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvQ29yZSc7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgSldFZGl0b3IsIHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgZGlzdGluY3QgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgUnVsZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlzdFBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIHR5cGU6IExpc3RUeXBlO1xufVxuZXhwb3J0IHR5cGUgdG9nZ2xlQ2hlY2tlZFBhcmFtcyA9IENvbW1hbmRQYXJhbXM7XG5cbmV4cG9ydCBjbGFzcyBMaXN0PFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgaXNMaXN0SXRlbShub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZS5wYXJlbnQgJiYgbm9kZS5wYXJlbnQgaW5zdGFuY2VvZiBMaXN0Tm9kZTtcbiAgICB9XG4gICAgc3RhdGljIGlzSW5MaXN0KHR5cGU6IExpc3RUeXBlLCBub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZT8uYW5jZXN0b3IoTGlzdE5vZGUpPy5saXN0VHlwZSA9PT0gdHlwZTtcbiAgICB9XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIHRvZ2dsZUxpc3Q6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnVG9nZ2xlIGxpc3QnLFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy50b2dnbGVMaXN0LFxuICAgICAgICB9LFxuICAgICAgICBpbmRlbnQ6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnSW5kZW50IGxpc3QgaXRlbXMnLFxuICAgICAgICAgICAgc2VsZWN0b3I6IFtMaXN0Tm9kZV0sXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluZGVudCxcbiAgICAgICAgfSxcbiAgICAgICAgb3V0ZGVudDoge1xuICAgICAgICAgICAgdGl0bGU6ICdPdXRkZW50IGxpc3QgaXRlbXMnLFxuICAgICAgICAgICAgc2VsZWN0b3I6IFtMaXN0Tm9kZV0sXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLm91dGRlbnQsXG4gICAgICAgIH0sXG4gICAgICAgIGluc2VydFBhcmFncmFwaEJyZWFrOiB7XG4gICAgICAgICAgICBzZWxlY3RvcjogW0xpc3ROb2RlLCBMaXN0LmlzTGlzdEl0ZW1dLFxuICAgICAgICAgICAgY2hlY2s6IChjb250ZXh0OiBDaGVja2luZ0NvbnRleHQpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBbbGlzdCwgbGlzdEl0ZW1dID0gY29udGV4dC5zZWxlY3RvcjtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWxpc3RJdGVtLmhhc0NoaWxkcmVuKCkgJiYgbGlzdEl0ZW0gPT09IGxpc3QubGFzdENoaWxkKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5pbnNlcnRQYXJhZ3JhcGhCcmVhayxcbiAgICAgICAgfSxcbiAgICAgICAgdG9nZ2xlQ2hlY2tlZDoge1xuICAgICAgICAgICAgdGl0bGU6ICdDaGVjayBvciB1bmNoZWNrIGxpc3QgaXRlbXMnLFxuICAgICAgICAgICAgc2VsZWN0b3I6IFtMaXN0Tm9kZS5DSEVDS0xJU1RdLFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy50b2dnbGVDaGVja2VkLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgY29tbWFuZEhvb2tzID0ge1xuICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHRoaXMgd2l0aCBgb25TaWJsaW5nc0NoYW5nZWAgd2hlbiB3ZSBpbnRyb2R1Y2UgZXZlbnRzLlxuICAgICAgICBkZWxldGVCYWNrd2FyZDogdGhpcy5yZWpvaW4uYmluZCh0aGlzKSxcbiAgICAgICAgZGVsZXRlRm9yd2FyZDogdGhpcy5yZWpvaW4uYmluZCh0aGlzKSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgS2V5bWFwICYgTGF5b3V0PiA9IHtcbiAgICAgICAgcGFyc2VyczogW0xpc3RYbWxEb21QYXJzZXIsIExpc3RJdGVtWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbTGlzdERvbU9iamVjdFJlbmRlcmVyLCBMaXN0SXRlbUF0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyXSxcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrPERpZ2l0Nz4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUxpc3QnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IExpc3RUeXBlLk9SREVSRUQgfSBhcyBMaXN0UGFyYW1zLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCs8RGlnaXQ4PicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAndG9nZ2xlTGlzdCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuVU5PUkRFUkVEIH0gYXMgTGlzdFBhcmFtcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrPERpZ2l0OT4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUxpc3QnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IExpc3RUeXBlLkNIRUNLTElTVCB9IGFzIExpc3RQYXJhbXMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMKzxTcGFjZT4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUNoZWNrZWQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQmFja3NwYWNlJyxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogW0xpc3QuaXNMaXN0SXRlbV0sXG4gICAgICAgICAgICAgICAgY2hlY2s6IChjb250ZXh0OiBDaGVja2luZ0NvbnRleHQpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFjb250ZXh0LnJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnb3V0ZGVudCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPcmRlcmVkTGlzdEJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ29yZGVyZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdUb2dnbGUgb3JkZXJlZCBsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUxpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuT1JERVJFRCB9IGFzIExpc3RQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IGVkaXRvci5zZWxlY3Rpb24ucmFuZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJc0xpc3QgPSBMaXN0LmlzSW5MaXN0KExpc3RUeXBlLk9SREVSRUQsIHJhbmdlLnN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0SXNMaXN0IHx8IHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0SXNMaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBMaXN0LmlzSW5MaXN0KExpc3RUeXBlLk9SREVSRUQsIHJhbmdlLmVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1saXN0LW9sIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdVbm9yZGVyZWRMaXN0QnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAndW5vcmRlcmVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVG9nZ2xlIHVub3JkZXJlZCBsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUxpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuVU5PUkRFUkVEIH0gYXMgTGlzdFBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydElzTGlzdCA9IExpc3QuaXNJbkxpc3QoTGlzdFR5cGUuVU5PUkRFUkVELCByYW5nZS5zdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydElzTGlzdCB8fCByYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydElzTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTGlzdC5pc0luTGlzdChMaXN0VHlwZS5VTk9SREVSRUQsIHJhbmdlLmVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1saXN0LXVsIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdDaGVja2xpc3RCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjaGVja2JveCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1RvZ2dsZSBjaGVja2JveCBsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUxpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuQ0hFQ0tMSVNUIH0gYXMgTGlzdFBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydElzTGlzdCA9IExpc3QuaXNJbkxpc3QoTGlzdFR5cGUuQ0hFQ0tMSVNULCByYW5nZS5zdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydElzTGlzdCB8fCByYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydElzTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTGlzdC5pc0luTGlzdChMaXN0VHlwZS5DSEVDS0xJU1QsIHJhbmdlLmVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYXIgZmEtY2hlY2stc3F1YXJlIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbXG4gICAgICAgICAgICBbJ09yZGVyZWRMaXN0QnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgICAgIFsnVW5vcmRlcmVkTGlzdEJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ0NoZWNrbGlzdEJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgIF0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQvcmVtb3ZlIGEgbGlzdCBhdCByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICB0b2dnbGVMaXN0KHBhcmFtczogTGlzdFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCB0eXBlID0gcGFyYW1zLnR5cGU7XG4gICAgICAgIGNvbnN0IGJvdW5kcyA9IFZSYW5nZS5jbG9uZShwYXJhbXMuY29udGV4dC5yYW5nZSk7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gbmV3IFZSYW5nZSh0aGlzLmVkaXRvciwgYm91bmRzKTtcblxuICAgICAgICAvLyBFeHRlbmQgdGhlIHJhbmdlIHRvIGNvdmVyIHRoZSBlbnRpcmV0eSBvZiBpdHMgY29udGFpbmVycy5cbiAgICAgICAgaWYgKHJhbmdlLnN0YXJ0Q29udGFpbmVyLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHJhbmdlLnN0YXJ0Q29udGFpbmVyLmZpcnN0Q2hpbGQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhbmdlLmVuZENvbnRhaW5lci5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICByYW5nZS5zZXRFbmQocmFuZ2UuZW5kQ29udGFpbmVyLmxhc3RDaGlsZCgpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBhbGwgdGFyZ2V0ZWQgbm9kZXMgYXJlIHdpdGhpbiBhIGxpc3Qgb2YgZ2l2ZW4gdHlwZSB0aGVuIHVubGlzdFxuICAgICAgICAvLyB0aGVtLiBPdGhlcndpc2UsIGNvbnZlcnQgdGhlbSB0byB0aGUgZ2l2ZW4gbGlzdCB0eXBlLlxuICAgICAgICBjb25zdCB0YXJnZXRlZE5vZGVzID0gcmFuZ2UudGFyZ2V0ZWROb2RlcygpO1xuICAgICAgICBjb25zdCBhbmNlc3RvcnMgPSB0YXJnZXRlZE5vZGVzLm1hcChub2RlID0+IG5vZGUuY2xvc2VzdChMaXN0Tm9kZSkpO1xuICAgICAgICBjb25zdCB0YXJnZXRlZExpc3RzID0gYW5jZXN0b3JzLmZpbHRlcihsaXN0ID0+ICEhbGlzdCk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRhcmdldGVkTGlzdHMubGVuZ3RoID09PSB0YXJnZXRlZE5vZGVzLmxlbmd0aCAmJlxuICAgICAgICAgICAgdGFyZ2V0ZWRMaXN0cy5ldmVyeShsaXN0ID0+IGxpc3QubGlzdFR5cGUgPT09IHR5cGUpXG4gICAgICAgICkge1xuICAgICAgICAgICAgLy8gVW5saXN0IHRoZSB0YXJnZXRlZCBub2RlcyBmcm9tIGFsbCBpdHMgbGlzdCBhbmNlc3RvcnMuXG4gICAgICAgICAgICB3aGlsZSAocmFuZ2Uuc3RhcnQuYW5jZXN0b3IoTGlzdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXNUb1VubGlzdCA9IHJhbmdlLnNwbGl0KExpc3ROb2RlKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3Qgb2Ygbm9kZXNUb1VubGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGxpc3QuY2hpbGRWTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGF1dG9tYXRpY2FsbHkgaW52YWxpZGF0ZSBgbGktYXR0cmlidXRlc2AuXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5tb2RpZmllcnMucmVtb3ZlKExpc3RJdGVtQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGlzdC51bndyYXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0ZWRMaXN0cy5sZW5ndGggPT09IHRhcmdldGVkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBJZiBhbGwgbm9kZXMgYXJlIGluIGxpc3RzLCBjb252ZXJ0IHRoZSB0YXJnZXRlZCBsaXN0XG4gICAgICAgICAgICAvLyBub2RlcyB0byB0aGUgZ2l2ZW4gbGlzdCB0eXBlLlxuICAgICAgICAgICAgY29uc3QgbGlzdHMgPSBkaXN0aW5jdCh0YXJnZXRlZExpc3RzKTtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RzVG9Db252ZXJ0ID0gbGlzdHMuZmlsdGVyKGwgPT4gbC5saXN0VHlwZSAhPT0gdHlwZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3Qgb2YgbGlzdHNUb0NvbnZlcnQpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3TGlzdCA9IG5ldyBMaXN0Tm9kZSh7IGxpc3RUeXBlOiB0eXBlIH0pO1xuICAgICAgICAgICAgICAgIGxpc3QucmVwbGFjZVdpdGgobmV3TGlzdCk7XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbmV3IGxpc3QgaXMgYWZ0ZXIgb3IgYmVmb3JlIGEgbGlzdCBvZiB0aGUgc2FtZVxuICAgICAgICAgICAgICAgIC8vIHR5cGUsIG1lcmdlIHRoZW0uIEV4YW1wbGU6XG4gICAgICAgICAgICAgICAgLy8gPG9sPjxsaT5hPC9saT48L29sPjxvbD48bGk+YjwvbGk+PC9vbD5cbiAgICAgICAgICAgICAgICAvLyA9PiA8b2w+PGxpPmE8L2xpPjxsaT5iPC9saT48L29sPikuXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNTaWJsaW5nID0gbmV3TGlzdC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNTaWJsaW5nICYmIExpc3ROb2RlW3R5cGVdKHByZXZpb3VzU2libGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3TGlzdC5tZXJnZVdpdGgocHJldmlvdXNTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3TGlzdCA9IHByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSBuZXdMaXN0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAgICAgaWYgKG5leHRTaWJsaW5nICYmIExpc3ROb2RlW3R5cGVdKG5leHRTaWJsaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0U2libGluZy5tZXJnZVdpdGgobmV3TGlzdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgb25seSBzb21lIG5vZGVzIGFyZSBpbiBsaXN0cyBhbmQgb3RoZXIgYXJlbid0IHRoZW4gb25seVxuICAgICAgICAgICAgLy8gd3JhcCB0aGUgb25lcyB0aGF0IHdlcmUgbm90IGFscmVhZHkgaW4gYSBsaXN0IGludG8gYSBsaXN0IG9mXG4gICAgICAgICAgICAvLyB0aGUgZ2l2ZW4gdHlwZS5cbiAgICAgICAgICAgIGxldCBuZXdMaXN0ID0gbmV3IExpc3ROb2RlKHsgbGlzdFR5cGU6IHR5cGUgfSk7XG4gICAgICAgICAgICBjb25zdCBub2Rlc1RvQ29udmVydCA9IHJhbmdlLnNwbGl0KExpc3ROb2RlKTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1RvQ29udmVydCkge1xuICAgICAgICAgICAgICAgIC8vIE1lcmdlIHRvcC1sZXZlbCBsaXN0cyBpbnN0ZWFkIG9mIG5lc3RpbmcgdGhlbS5cbiAgICAgICAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIExpc3ROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUubWVyZ2VXaXRoKG5ld0xpc3QpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUud3JhcChuZXdMaXN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBuZXcgbGlzdCBpcyBhZnRlciBvciBiZWZvcmUgYSBsaXN0IG9mIHRoZSBzYW1lIHR5cGUsXG4gICAgICAgICAgICAvLyBtZXJnZSB0aGVtLiBFeGFtcGxlOlxuICAgICAgICAgICAgLy8gPG9sPjxsaT5hPC9saT48L29sPjxvbD48bGk+YjwvbGk+PC9vbD5cbiAgICAgICAgICAgIC8vID0+IDxvbD48bGk+YTwvbGk+PGxpPmI8L2xpPjwvb2w+KS5cbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzU2libGluZyA9IG5ld0xpc3QucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgICAgICBpZiAocHJldmlvdXNTaWJsaW5nICYmIExpc3ROb2RlW3R5cGVdKHByZXZpb3VzU2libGluZykpIHtcbiAgICAgICAgICAgICAgICBuZXdMaXN0Lm1lcmdlV2l0aChwcmV2aW91c1NpYmxpbmcpO1xuICAgICAgICAgICAgICAgIG5ld0xpc3QgPSBwcmV2aW91c1NpYmxpbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gbmV3TGlzdC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgaWYgKG5leHRTaWJsaW5nICYmIExpc3ROb2RlW3R5cGVdKG5leHRTaWJsaW5nKSkge1xuICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nLm1lcmdlV2l0aChuZXdMaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJhbmdlLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluZGVudCBvbmUgb3IgbW9yZSBsaXN0IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGluZGVudChwYXJhbXM6IEluZGVudFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBpdGVtcyA9IHJhbmdlLnRhcmdldGVkTm9kZXMobm9kZSA9PiBub2RlLnBhcmVudCBpbnN0YW5jZW9mIExpc3ROb2RlKTtcblxuICAgICAgICAvLyBEbyBub3QgaW5kZW50IGl0ZW1zIG9mIGEgdGFyZ2V0ZWQgbmVzdGVkIGxpc3QsIHNpbmNlIHRoZXlcbiAgICAgICAgLy8gd2lsbCBhdXRvbWF0aWNhbGx5IGJlIGluZGVudGVkIHdpdGggdGhlaXIgbGlzdCBhbmNlc3Rvci5cbiAgICAgICAgY29uc3QgaXRlbXNUb0luZGVudCA9IGl0ZW1zLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhaXRlbXMuaW5jbHVkZXMoaXRlbS5hbmNlc3RvcihMaXN0Tm9kZSkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXNUb0luZGVudCkge1xuICAgICAgICAgICAgY29uc3QgcHJldiA9IGl0ZW0ucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gaXRlbS5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgLy8gSW5kZW50IHRoZSBpdGVtIGJ5IHB1dHRpbmcgaXQgaW50byBhIHByZS1leGlzdGluZyBsaXN0IHNpYmxpbmcuXG4gICAgICAgICAgICBpZiAocHJldiAmJiBwcmV2IGluc3RhbmNlb2YgTGlzdE5vZGUpIHtcbiAgICAgICAgICAgICAgICBwcmV2LmFwcGVuZChpdGVtKTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgdHdvIGxpc3Qgc2libGluZ3MgbWlnaHQgYmUgcmVqb2luYWJsZSBub3cgdGhhdCB0aGUgbG93ZXJcbiAgICAgICAgICAgICAgICAvLyBsZXZlbCBpdGVtIGJyZWFraW5nIHRoZW0gaW50byB0d28gZGlmZmVyZW50IGxpc3RzIGlzIG5vIG1vcmUuXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdFR5cGUgPSBwcmV2Lmxpc3RUeXBlO1xuICAgICAgICAgICAgICAgIGlmIChMaXN0Tm9kZVtsaXN0VHlwZV0obmV4dCkgJiYgIWl0ZW1zVG9JbmRlbnQuaW5jbHVkZXMobmV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dC5tZXJnZVdpdGgocHJldik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0IGluc3RhbmNlb2YgTGlzdE5vZGUgJiYgIWl0ZW1zVG9JbmRlbnQuaW5jbHVkZXMobmV4dCkpIHtcbiAgICAgICAgICAgICAgICBuZXh0LnByZXBlbmQoaXRlbSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIElmIG5vIG90aGVyIGNhbmRpZGF0ZSBleGlzdHMgdGhlbiB3cmFwIGl0IGluIGEgbmV3IExpc3ROb2RlLlxuICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RUeXBlID0gaXRlbS5hbmNlc3RvcihMaXN0Tm9kZSkubGlzdFR5cGU7XG4gICAgICAgICAgICAgICAgaXRlbS53cmFwKG5ldyBMaXN0Tm9kZSh7IGxpc3RUeXBlOiBsaXN0VHlwZSB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdXRkZW50IG9uZSBvciBtb3JlIGxpc3QgaXRlbXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgb3V0ZGVudChwYXJhbXM6IE91dGRlbnRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgaXRlbXMgPSByYW5nZS50YXJnZXRlZE5vZGVzKG5vZGUgPT4gbm9kZS5wYXJlbnQgaW5zdGFuY2VvZiBMaXN0Tm9kZSk7XG5cbiAgICAgICAgLy8gRG8gbm90IG91dGRlbnQgaXRlbXMgb2YgYSB0YXJnZXRlZCBuZXN0ZWQgbGlzdCwgc2luY2UgdGhleVxuICAgICAgICAvLyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgb3V0ZGVudGVkIHdpdGggdGhlaXIgbGlzdCBhbmNlc3Rvci5cbiAgICAgICAgY29uc3QgaXRlbXNUb091dGRlbnQgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIWl0ZW1zLmluY2x1ZGVzKGl0ZW0uYW5jZXN0b3IoTGlzdE5vZGUpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zVG9PdXRkZW50KSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gaXRlbS5hbmNlc3RvcihMaXN0Tm9kZSk7XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSBpdGVtLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSBpdGVtLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0b3IubW9kZS5pcyhsaXN0LCBSdWxlUHJvcGVydHkuQlJFQUtBQkxFKSkge1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c1NpYmxpbmcgJiYgbmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BsaXRMaXN0ID0gaXRlbS5wYXJlbnQuc3BsaXRBdChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc3BsaXRMaXN0LmJlZm9yZShpdGVtKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgICAgICBsaXN0LmFmdGVyKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdC5iZWZvcmUoaXRlbSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBsaXN0LmNoaWxkVk5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBhdXRvbWF0aWNhbGx5IGludmFsaWRhdGUgYGxpLWF0dHJpYnV0ZXNgLlxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQubW9kaWZpZXJzLnJlbW92ZShMaXN0SXRlbUF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxpc3QudW53cmFwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgcGFyYWdyYXBoIGJyZWFrIGluIHRoZSBsYXN0IGVtcHR5IGl0ZW0gb2YgYSBsaXN0IGJ5IHVud3JhcHBpbmdcbiAgICAgKiB0aGUgbGlzdCBpdGVtIGZyb20gdGhlIGxpc3QsIHRodXMgYmVjb21pbmcgdGhlIG5ldyBwYXJhZ3JhcGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWsocGFyYW1zOiBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBsaXN0SXRlbSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyO1xuICAgICAgICBjb25zdCBsaXN0Tm9kZSA9IGxpc3RJdGVtLmFuY2VzdG9yKExpc3ROb2RlKTtcbiAgICAgICAgaWYgKGxpc3ROb2RlLmNoaWxkcmVuKCkubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBsaXN0Tm9kZS51bndyYXAoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3ROb2RlLmFmdGVyKGxpc3RJdGVtKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlam9pbiBzYW1lIHR5cGUgbGlzdHMgdGhhdCBhcmUgbm93IGRpcmVjdCBzaWJsaW5ncyBhZnRlciB0aGUgcmVtb3ZlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHJlam9pbihwYXJhbXM6IERlbGV0ZUJhY2t3YXJkUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGxpc3RBbmNlc3RvcnMgPSByYW5nZS5zdGFydC5hbmNlc3RvcnMoTGlzdE5vZGUpO1xuICAgICAgICBpZiAobGlzdEFuY2VzdG9ycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBsaXN0OiBWTm9kZSA9IGxpc3RBbmNlc3RvcnNbbGlzdEFuY2VzdG9ycy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGxldCBuZXh0U2libGluZyA9IGxpc3QgJiYgbGlzdC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICAgIGxpc3QgJiZcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZyAmJlxuICAgICAgICAgICAgICAgIGxpc3QgaW5zdGFuY2VvZiBMaXN0Tm9kZSAmJlxuICAgICAgICAgICAgICAgIExpc3ROb2RlW2xpc3QubGlzdFR5cGVdKG5leHRTaWJsaW5nKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dExpc3QgPSBsaXN0Lmxhc3RDaGlsZCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaXN0U2libGluZyA9IG5leHRTaWJsaW5nLmZpcnN0Q2hpbGQoKTtcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZy5tZXJnZVdpdGgobGlzdCk7XG4gICAgICAgICAgICAgICAgbGlzdCA9IG5leHRMaXN0O1xuICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nID0gbmV4dExpc3RTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgb3IgdW5jaGVjayB0aGUgbGlzdCBpdGVtcyBhdCByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICB0b2dnbGVDaGVja2VkKHBhcmFtczogdG9nZ2xlQ2hlY2tlZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBpdGVtcyA9IHJhbmdlLnRhcmdldGVkTm9kZXMobm9kZSA9PiBMaXN0Tm9kZS5DSEVDS0xJU1Qobm9kZS5wYXJlbnQpKTtcblxuICAgICAgICBjb25zdCBhcmVBbGxDaGVja2VkID0gaXRlbXMuZXZlcnkoTGlzdE5vZGUuaXNDaGVja2VkKTtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICAgICAgICBpZiAoYXJlQWxsQ2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIExpc3ROb2RlLnVuY2hlY2soaXRlbSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIExpc3ROb2RlLmNoZWNrKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgTGlzdE5vZGUsIExpc3RUeXBlIH0gZnJvbSAnLi9MaXN0Tm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0RWxlbWVudCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5cbmltcG9ydCAnLi4vYXNzZXRzL2NoZWNrbGlzdC5jc3MnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgVlJhbmdlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlJhbmdlJztcbmltcG9ydCB7IExpc3RJdGVtQXR0cmlidXRlcyB9IGZyb20gJy4vTGlzdEl0ZW1YbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lV29ya2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5pbXBvcnQgeyBMaXN0IH0gZnJvbSAnLi9MaXN0JztcblxuZXhwb3J0IGNsYXNzIExpc3REb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTGlzdE5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobGlzdE5vZGU6IExpc3ROb2RlLCB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+KTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgbGlzdDogRG9tT2JqZWN0RWxlbWVudCA9IHtcbiAgICAgICAgICAgIHRhZzogbGlzdE5vZGUubGlzdFR5cGUgPT09IExpc3RUeXBlLk9SREVSRUQgPyAnT0wnIDogJ1VMJyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKExpc3ROb2RlLkNIRUNLTElTVChsaXN0Tm9kZSkpIHtcbiAgICAgICAgICAgIGxpc3QuYXR0cmlidXRlcyA9IHsgY2xhc3M6IG5ldyBTZXQoWydjaGVja2xpc3QnXSkgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGxpc3ROb2RlLmNoaWxkcmVuKCk7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdHMgPSBhd2FpdCB3b3JrZXIucmVuZGVyKGNoaWxkcmVuKTtcbiAgICAgICAgZm9yIChjb25zdCBpbmRleCBpbiBjaGlsZHJlbikge1xuICAgICAgICAgICAgbGlzdC5jaGlsZHJlbi5wdXNoKFxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckxpKGxpc3ROb2RlLCBjaGlsZHJlbltpbmRleF0sIGRvbU9iamVjdHNbaW5kZXhdLCB3b3JrZXIpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG4gICAgcHJpdmF0ZSBfcmVuZGVyTGkoXG4gICAgICAgIGxpc3ROb2RlOiBMaXN0Tm9kZSxcbiAgICAgICAgbGlzdEl0ZW06IFZOb2RlLFxuICAgICAgICByZW5kZXJpbmc6IERvbU9iamVjdCxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBEb21PYmplY3Qge1xuICAgICAgICBsZXQgbGk6IERvbU9iamVjdEVsZW1lbnQ7XG4gICAgICAgIC8vIFRoZSBub2RlIHdhcyB3cmFwcGVkIGluIGEgXCJMSVwiIGJ1dCBuZWVkcyB0byBiZSByZW5kZXJlZCBhcyB3ZWxsLlxuICAgICAgICBpZiAoJ3RhZycgaW4gcmVuZGVyaW5nICYmIHJlbmRlcmluZy50YWcgPT09ICdQJyAmJiAhcmVuZGVyaW5nLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIC8vIERpcmVjdCBMaXN0Tm9kZSdzIFZFbGVtZW50IGNoaWxkcmVuIFwiUFwiIGFyZSByZW5kZXJlZCBhcyBcIkxJXCJcbiAgICAgICAgICAgIC8vIHdoaWxlIG90aGVyIG5vZGVzIHdpbGwgYmUgcmVuZGVyZWQgaW5zaWRlIHRoZSBcIkxJXCIuXG4gICAgICAgICAgICBsaSA9IHJlbmRlcmluZztcbiAgICAgICAgICAgIGxpLnRhZyA9ICdMSSc7XG4gICAgICAgIH0gZWxzZSBpZiAoJ2RvbScgaW4gcmVuZGVyaW5nICYmIHJlbmRlcmluZy5kb21bMF0ubm9kZU5hbWUgPT09ICdMSScpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGNoaWxkLXNwZWNpZmljIHJlbmRlcmVyLCB0aGUgZGVmYXVsdCByZW5kZXJlclxuICAgICAgICAgICAgLy8gaXMgdXNlZC4gVGhpcyB0YWtlcyB0aGUgcmVzdWx0IG9mIHRoZSBEb20gcmVuZGVyZXIgd2hpY2hcbiAgICAgICAgICAgIC8vIGl0c2VsZiB3cmFwIHRoZSBjaGlsZHJlbiBpbiBMSS5cbiAgICAgICAgICAgIHJlbmRlcmluZy5kb20gPSBbLi4ucmVuZGVyaW5nLmRvbVswXS5jaGlsZE5vZGVzXTtcbiAgICAgICAgICAgIGxpID0ge1xuICAgICAgICAgICAgICAgIHRhZzogJ0xJJyxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3JlbmRlcmluZ10sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gTWFyayBhcyBvcmlnaW4uIElmIHRoZSBsaXN0SXRlbSBvciB0aGUgbGlzdE5vZGUgY2hhbmdlLCB0aGUgb3RoZXIgYXJlIGludmFsaWRhdGUuXG4gICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhsaXN0SXRlbSwgbGkpO1xuICAgICAgICAgICAgd29ya2VyLmRlcGVuZHMobGksIGxpc3RJdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpID0ge1xuICAgICAgICAgICAgICAgIHRhZzogJ0xJJyxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW2xpc3RJdGVtXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBNYXJrIGFzIGRlcGVuZGVudC4gSWYgdGhlIGxpc3RJdGVtIGNoYW5nZSwgdGhlIGxpc3ROb2RlIGFyZSBpbnZhbGlkYXRlLiBCdXQgaWYgdGhlXG4gICAgICAgICAgICAvLyBsaXN0IGNoYW5nZSwgdGhlIGxpc3RJdGVtIHdpbGwgbm90IGludmFsaWRhdGUuXG4gICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhsaSwgbGlzdEl0ZW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgd29ya2VyLmRlcGVuZHMobGksIGxpc3ROb2RlKTtcbiAgICAgICAgd29ya2VyLmRlcGVuZHMobGlzdE5vZGUsIGxpKTtcblxuICAgICAgICAvLyBSZW5kZXIgdGhlIG5vZGUncyBhdHRyaWJ1dGVzIHRoYXQgd2VyZSBzdG9yZWQgb24gdGhlIHRlY2huaWNhbCBrZXlcbiAgICAgICAgLy8gdGhhdCBzcGVjaWZpZXMgdGhvc2UgYXR0cmlidXRlcyBiZWxvbmcgb24gdGhlIGxpc3QgaXRlbS5cbiAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhMaXN0SXRlbUF0dHJpYnV0ZXMsIGxpc3RJdGVtLCBsaSwgd29ya2VyKTtcblxuICAgICAgICBpZiAobGlzdE5vZGUubGlzdFR5cGUgPT09IExpc3RUeXBlLk9SREVSRUQpIHtcbiAgICAgICAgICAgIC8vIEFkYXB0IG51bWJlcmluZyB0byBza2lwIHByZXZpb3VzIGxpc3QgaXRlbVxuICAgICAgICAgICAgLy8gU291cmNlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTI4NjAwODNcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzSWRlbnRlZExpc3QgPSBsaXN0SXRlbS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgIGlmIChwcmV2aW91c0lkZW50ZWRMaXN0IGluc3RhbmNlb2YgTGlzdE5vZGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c0xpcyA9IHByZXZpb3VzSWRlbnRlZExpc3QucHJldmlvdXNTaWJsaW5ncyhcbiAgICAgICAgICAgICAgICAgICAgc2libGluZyA9PiAhKHNpYmxpbmcgaW5zdGFuY2VvZiBMaXN0Tm9kZSksXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IE1hdGgubWF4KHByZXZpb3VzTGlzLmxlbmd0aCwgMSkgKyAxO1xuICAgICAgICAgICAgICAgIGxpLmF0dHJpYnV0ZXMudmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxpc3RJdGVtIGluc3RhbmNlb2YgTGlzdE5vZGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gbGkuYXR0cmlidXRlcy5zdHlsZSB8fCB7fTtcbiAgICAgICAgICAgIGlmICghc3R5bGVbJ2xpc3Qtc3R5bGUnXSkge1xuICAgICAgICAgICAgICAgIHN0eWxlWydsaXN0LXN0eWxlJ10gPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaS5hdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGU7XG5cbiAgICAgICAgICAgIGlmIChMaXN0Tm9kZS5DSEVDS0xJU1QobGlzdEl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IGxpc3RJdGVtLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2ICYmICFMaXN0Tm9kZS5DSEVDS0xJU1QocHJldikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGRlcGVuZGVuY2llIHRvIGNoZWNrL3VuY2hlY2sgd2l0aCBwcmV2aW91cyBjaGVja2xpc3QgaXRlbSB1c2VkIGFzIHRpdGxlLlxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhwcmV2LCBsaXN0SXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5kZXBlbmRzKGxpc3RJdGVtLCBwcmV2KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoTGlzdE5vZGUuQ0hFQ0tMSVNUKGxpc3ROb2RlKSkge1xuICAgICAgICAgICAgLy8gQWRkIGRlcGVuZGVuY2llIGJlY2F1c2UgdGhlIG1vZGlmaWVyIG9uIHRoZSBsaXN0SXRlbSBjaGFuZ2UgdGhlIGxpIHJlbmRlcmluZy5cbiAgICAgICAgICAgIHdvcmtlci5kZXBlbmRzKGxpLCBsaXN0SXRlbSk7XG4gICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhsaXN0SXRlbSwgbGlzdE5vZGUpO1xuXG4gICAgICAgICAgICBjb25zdCBjbGFzc05hbWUgPSBMaXN0Tm9kZS5pc0NoZWNrZWQobGlzdEl0ZW0pID8gJ2NoZWNrZWQnIDogJ3VuY2hlY2tlZCc7XG4gICAgICAgICAgICBpZiAobGkuYXR0cmlidXRlcy5jbGFzcykge1xuICAgICAgICAgICAgICAgIGxpLmF0dHJpYnV0ZXMuY2xhc3MuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxpLmF0dHJpYnV0ZXMuY2xhc3MgPSBuZXcgU2V0KFtjbGFzc05hbWVdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGFuZGxlIGNsaWNrIGluIHRoZSBjaGVja2JveC5cbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXJNb3VzZURvd24gPSAoZXY6IE1vdXNlRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXYub2Zmc2V0WCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNXaXRoUmFuZ2U8TGlzdD4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJhbmdlLmF0KGxpc3RJdGVtLmZpcnN0Q2hpbGQoKSB8fCBsaXN0SXRlbSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RvZ2dsZUNoZWNrZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGxpLmF0dGFjaCA9IChlbDogSFRNTEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVyTW91c2VEb3duKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBsaS5kZXRhY2ggPSAoZWw6IEhUTUxFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlck1vdXNlRG93bik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1vZGlmaWVyUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL01vZGlmaWVyUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IExpc3RJdGVtQXR0cmlidXRlcyB9IGZyb20gJy4vTGlzdEl0ZW1YbWxEb21QYXJzZXInO1xuXG5leHBvcnQgY2xhc3MgTGlzdEl0ZW1BdHRyaWJ1dGVzRG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlciBleHRlbmRzIE1vZGlmaWVyUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IExpc3RJdGVtQXR0cmlidXRlcztcblxuICAgIC8qKlxuICAgICAqIFJlbmRlcmluZyBmb3IgTGlzdEl0ZW1BdHRyaWJ1dGVzIE1vZGlmaWVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGZvcm1hdFxuICAgICAqIEBwYXJhbSBjb250ZW50c1xuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihmb3JtYXQ6IExpc3RJdGVtQXR0cmlidXRlcywgY29udGVudHM6IERvbU9iamVjdFtdKTogUHJvbWlzZTxEb21PYmplY3RbXT4ge1xuICAgICAgICByZXR1cm4gY29udGVudHM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgaXNCbG9jayB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9pc0Jsb2NrJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgTW9kaWZpZXJzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXJzJztcblxuZXhwb3J0IGNsYXNzIExpc3RJdGVtQXR0cmlidXRlcyBleHRlbmRzIEF0dHJpYnV0ZXMge31cblxuZXhwb3J0IGNsYXNzIExpc3RJdGVtWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnTEknO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIGxpc3QgZWxlbWVudCAoTEkpLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gQXJyYXkuZnJvbShpdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgaW5saW5lc0NvbnRhaW5lcjogVk5vZGU7XG4gICAgICAgIC8vIFBhcnNlIHRoZSBsaXN0IGl0ZW0ncyBhdHRyaWJ1dGVzIGludG8gdGhlIG5vZGUncyBMaXN0SXRlbUF0dHJpYnV0ZXMsXG4gICAgICAgIC8vIHdoaWNoIHdpbGwgYmUgcmVhZCBvbmx5IGJ5IExpc3RJdGVtRG9tUmVuZGVyZXIuXG4gICAgICAgIGNvbnN0IGl0ZW1Nb2RpZmllcnMgPSBuZXcgTW9kaWZpZXJzKCk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgaXRlbU1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgQ29udGFpbmVyID0gdGhpcy5lbmdpbmUuZWRpdG9yLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMuQ29udGFpbmVyO1xuICAgICAgICBmb3IgKGxldCBjaGlsZEluZGV4ID0gMDsgY2hpbGRJbmRleCA8IGNoaWxkcmVuLmxlbmd0aDsgY2hpbGRJbmRleCsrKSB7XG4gICAgICAgICAgICBjb25zdCBkb21DaGlsZCA9IGNoaWxkcmVuW2NoaWxkSW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkQ2hpbGQgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZShkb21DaGlsZCk7XG4gICAgICAgICAgICBpZiAocGFyc2VkQ2hpbGQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5saW5lTGlzdEl0ZW0oZG9tQ2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENvbnRpZ3VvdXMgaW5saW5lIGVsZW1lbnRzIGluIGEgbGlzdCBpdGVtIHNob3VsZCBiZVxuICAgICAgICAgICAgICAgICAgICAvLyB3cmFwcGVkIHRvZ2V0aGVyIGluIGEgYmFzZSBjb250YWluZXIuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaW5saW5lc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5saW5lc0NvbnRhaW5lciA9IG5ldyBDb250YWluZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBpdGVtTW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCd2YWx1ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5saW5lc0NvbnRhaW5lci5tb2RpZmllcnMuYXBwZW5kKG5ldyBMaXN0SXRlbUF0dHJpYnV0ZXMoYXR0cmlidXRlcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChpbmxpbmVzQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmxpbmVzQ29udGFpbmVyLmFwcGVuZCguLi5wYXJzZWRDaGlsZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlubGluZXNDb250YWluZXIgJiYgIVsnVUwnLCAnT0wnXS5pbmNsdWRlcyhub2RlTmFtZShkb21DaGlsZCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmVzQ29udGFpbmVyLmFwcGVuZCguLi5wYXJzZWRDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmVzQ29udGFpbmVyID0gbnVsbDsgLy8gQ2xvc2UgdGhlIGlubGluZXNDb250YWluZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHBhcnNlZENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGl0ZW1Nb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCd2YWx1ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLm1vZGlmaWVycy5zZXQobmV3IExpc3RJdGVtQXR0cmlidXRlcyhhdHRyaWJ1dGVzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKC4uLnBhcnNlZENoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBBIGxpc3QgaXRlbSB3aXRoIGNoaWxkcmVuIGJ1dCB3aG9zZSBwYXJzaW5nIHJldHVybmVkIG5vdGhpbmcgc2hvdWxkXG4gICAgICAgIC8vIGJlIHBhcnNlZCBhcyBhbiBlbXB0eSBiYXNlIGNvbnRhaW5lci4gRWc6IDxsaT48YnIvPjwvbGk+OiBsaSBoYXMgYVxuICAgICAgICAvLyBjaGlsZCBzbyBpdCB3aWxsIG5vdCByZXR1cm4gW10gYWJvdmUgKGFuZCB0aGVyZWZvcmUgYmUgaWdub3JlZCksIGJ1dFxuICAgICAgICAvLyBiciB3aWxsIHBhcnNlIHRvIG5vdGhpbmcgYmVjYXVzZSBpdCdzIGEgcGxhY2Vob2xkZXIgYnIsIG5vdCBhIHJlYWxcbiAgICAgICAgLy8gbGluZSBicmVhay4gV2UgY2Fubm90IGlnbm9yZSB0aGF0IGxpIGJlY2F1c2UgaXQgZG9lcyBpbiBmYWN0IGV4aXN0IHNvXG4gICAgICAgIC8vIHdlIHBhcnNlIGl0IGFzIGFuIGVtcHR5IGJhc2UgY29udGFpbmVyLlxuICAgICAgICBpZiAobm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7XG4gICAgICAgICAgICBjb250YWluZXIubW9kaWZpZXJzLmFwcGVuZChuZXcgTGlzdEl0ZW1BdHRyaWJ1dGVzKGl0ZW1Nb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpKSk7XG4gICAgICAgICAgICByZXR1cm4gW2NvbnRhaW5lcl07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBpcyBhbiBpbmxpbmUgbGlzdCBpdGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBfaXNJbmxpbmVMaXN0SXRlbShpdGVtOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBpdGVtICYmICghaXNCbG9jayhpdGVtKSB8fCBub2RlTmFtZShpdGVtKSA9PT0gJ0JSJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5cbmV4cG9ydCBlbnVtIExpc3RUeXBlIHtcbiAgICBPUkRFUkVEID0gJ09SREVSRUQnLFxuICAgIFVOT1JERVJFRCA9ICdVTk9SREVSRUQnLFxuICAgIENIRUNLTElTVCA9ICdDSEVDS0xJU1QnLFxufVxuZXhwb3J0IGludGVyZmFjZSBMaXN0Tm9kZVBhcmFtcyBleHRlbmRzIEFic3RyYWN0Tm9kZVBhcmFtcyB7XG4gICAgbGlzdFR5cGU6IExpc3RUeXBlO1xufVxuXG5leHBvcnQgY2xhc3MgSXNDaGVja2VkIGV4dGVuZHMgTW9kaWZpZXIge31cblxuZXhwb3J0IGNsYXNzIExpc3ROb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgLy8gVHlwZXNjcmlwdCBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0IHVzaW5nIGVudW0gYXMga2V5cyBpbiBpbnRlcmZhY2VzLlxuICAgIC8vIFNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xMzA0MlxuICAgIHN0YXRpYyBPUkRFUkVEKG5vZGU6IFZOb2RlKTogbm9kZSBpcyBMaXN0Tm9kZSB7XG4gICAgICAgIHJldHVybiBub2RlICYmIG5vZGUgaW5zdGFuY2VvZiBMaXN0Tm9kZSAmJiBub2RlLmxpc3RUeXBlID09PSBMaXN0VHlwZS5PUkRFUkVEO1xuICAgIH1cbiAgICBzdGF0aWMgVU5PUkRFUkVEKG5vZGU6IFZOb2RlKTogbm9kZSBpcyBMaXN0Tm9kZSB7XG4gICAgICAgIHJldHVybiBub2RlICYmIG5vZGUgaW5zdGFuY2VvZiBMaXN0Tm9kZSAmJiBub2RlLmxpc3RUeXBlID09PSBMaXN0VHlwZS5VTk9SREVSRUQ7XG4gICAgfVxuICAgIHN0YXRpYyBDSEVDS0xJU1Qobm9kZTogVk5vZGUpOiBub2RlIGlzIExpc3ROb2RlIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZSBpbnN0YW5jZW9mIExpc3ROb2RlICYmIG5vZGUubGlzdFR5cGUgPT09IExpc3RUeXBlLkNIRUNLTElTVDtcbiAgICB9XG4gICAgbGlzdFR5cGU6IExpc3RUeXBlO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogTGlzdE5vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgdGhpcy5saXN0VHlwZSA9IHBhcmFtcy5saXN0VHlwZTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLm5hbWUgKyAnOiAnICsgdGhpcy5saXN0VHlwZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaXMgYSBjaGVja2VkIGNoZWNrbGlzdCBvciBjaGVja2xpc3QgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgc3RhdGljIGlzQ2hlY2tlZChub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoTGlzdE5vZGUuQ0hFQ0tMSVNUKG5vZGUpICYmIG5vZGUuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIG5vZGUgaXMgYSBwb3B1bGF0ZWQgY2hlY2tsaXN0LCBpdCBpcyBjaGVja2VkIGluIHRoZSBjYXNlXG4gICAgICAgICAgICAvLyB0aGF0IGV2ZXJ5IG9uZSBvZiBpdHMgY2hpbGRyZW4gaXMgY2hlY2tlZC5cbiAgICAgICAgICAgIHJldHVybiBub2RlLmNoaWxkcmVuKCkuZXZlcnkoTGlzdE5vZGUuaXNDaGVja2VkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGluZGVudGVkQ2hpbGQgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBpZiAoTGlzdE5vZGUuQ0hFQ0tMSVNUKGluZGVudGVkQ2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIG5leHQgbGlzdCBpdGVtIGlzIGEgY2hlY2tsaXN0LCB0aGlzIGxpc3QgaXRlbSBpcyBpdHNcbiAgICAgICAgICAgICAgICAvLyB0aXRsZSwgd2hpY2ggaXMgY2hlY2tlZCBpZiBzYWlkIGNoZWNrbGlzdCdzIGNoaWxkcmVuIGFyZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIExpc3ROb2RlLmlzQ2hlY2tlZChpbmRlbnRlZENoaWxkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhbm9kZS5tb2RpZmllcnMuZmluZChJc0NoZWNrZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgZ2l2ZW4gbm9kZXMgYXMgY2hlY2tlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2Rlc1xuICAgICAqL1xuICAgIHN0YXRpYyBjaGVjayguLi5ub2RlczogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgTGlzdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayB0aGUgbGlzdCdzIGNoaWxkcmVuLlxuICAgICAgICAgICAgICAgIExpc3ROb2RlLmNoZWNrKC4uLm5vZGUuY2hpbGRyZW4oKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIHRoZSBub2RlIGl0c2VsZiBvdGhlcndpc2UuXG4gICAgICAgICAgICAgICAgbm9kZS5tb2RpZmllcnMuc2V0KElzQ2hlY2tlZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9wYWdhdGUgdG8gbmV4dCBpbmRlbnRlZCBsaXN0IGlmIGFueS5cbiAgICAgICAgICAgICAgICBjb25zdCBpbmRlbnRlZENoaWxkID0gbm9kZS5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChpbmRlbnRlZENoaWxkICYmIGluZGVudGVkQ2hpbGQgaW5zdGFuY2VvZiBMaXN0Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBMaXN0Tm9kZS5jaGVjayhpbmRlbnRlZENoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBnaXZlbiBub2RlcyBhcyB1bmNoZWNrZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZXNcbiAgICAgKi9cbiAgICBzdGF0aWMgdW5jaGVjayguLi5ub2RlczogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgTGlzdE5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBVbmNoZWNrIHRoZSBsaXN0J3MgY2hpbGRyZW4uXG4gICAgICAgICAgICAgICAgTGlzdE5vZGUudW5jaGVjayguLi5ub2RlLmNoaWxkcmVuKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBVbmNoZWNrIHRoZSBub2RlLlxuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLnJlbW92ZShJc0NoZWNrZWQpO1xuXG4gICAgICAgICAgICAgICAgLy8gUHJvcGFnYXRlIHRvIG5leHQgaW5kZW50ZWQgbGlzdC5cbiAgICAgICAgICAgICAgICBjb25zdCBpbmRlbnRlZENoaWxkID0gbm9kZS5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChpbmRlbnRlZENoaWxkICYmIGluZGVudGVkQ2hpbGQgaW5zdGFuY2VvZiBMaXN0Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBMaXN0Tm9kZS51bmNoZWNrKGluZGVudGVkQ2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiAgQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgTGlzdE5vZGU+WzBdID0ge1xuICAgICAgICAgICAgbGlzdFR5cGU6IHRoaXMubGlzdFR5cGUsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzdXBlci5jbG9uZShkZWVwQ2xvbmUsIHsgLi4uZGVmYXVsdHMsIC4uLnBhcmFtcyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMaXN0Tm9kZSwgTGlzdFR5cGUgfSBmcm9tICcuL0xpc3ROb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgTGlzdEl0ZW1BdHRyaWJ1dGVzIH0gZnJvbSAnLi9MaXN0SXRlbVhtbERvbVBhcnNlcic7XG5cbmNvbnN0IGxpc3RUYWdzID0gWydVTCcsICdPTCddO1xuXG5leHBvcnQgY2xhc3MgTGlzdFhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBsaXN0VGFncy5pbmNsdWRlcyhub2RlTmFtZShpdGVtKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgbGlzdCAoVUwsIE9MKSBhbmQgaXRzIGNoaWxkcmVuIGxpc3QgZWxlbWVudHMgKExJKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAvLyBHZXQgdGhlIGxpc3QncyB0eXBlIChPUkRFUkVELCBVTk9SREVSRUQsIENIRUNLTElTVCkuXG4gICAgICAgIGxldCB0eXBlOiBMaXN0VHlwZTtcbiAgICAgICAgaWYgKGl0ZW0uY2xhc3NOYW1lLm1hdGNoKC8oXnwgKWNoZWNrbGlzdCggfCQpL2kpKSB7XG4gICAgICAgICAgICB0eXBlID0gTGlzdFR5cGUuQ0hFQ0tMSVNUO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHlwZSA9IG5vZGVOYW1lKGl0ZW0pID09PSAnVUwnID8gTGlzdFR5cGUuVU5PUkRFUkVEIDogTGlzdFR5cGUuT1JERVJFRDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbGlzdCBub2RlIGFuZCBwYXJzZSBpdHMgY2hpbGRyZW4gYW5kIGF0dHJpYnV0ZXMuXG4gICAgICAgIGNvbnN0IGxpc3QgPSBuZXcgTGlzdE5vZGUoeyBsaXN0VHlwZTogdHlwZSB9KTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKHR5cGUgPT09IExpc3RUeXBlLkNIRUNLTElTVCkge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2xpc3QnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxpc3QubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIGxpc3QuYXBwZW5kKC4uLmNoaWxkcmVuKTtcblxuICAgICAgICAvLyBJbiB0aGUgY2FzZSBvZiBhIGNoZWNrbGlzdCwgcGFyc2UgdGhlaXIgY2hlY2tlZC91bmNoZWNrZWQgc3RhdHVzIGFuZFxuICAgICAgICAvLyBlbnN1cmUgdmVydGljYWwgcHJvcGFnYXRpb24uXG4gICAgICAgIGlmICh0eXBlID09PSBMaXN0VHlwZS5DSEVDS0xJU1QpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaUF0dHJpYnV0ZXMgPSBjaGlsZC5tb2RpZmllcnMuZmluZChMaXN0SXRlbUF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIGlmIChsaUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUGFyc2UgdGhlIGxpc3QgaXRlbSdzIGNoZWNrZWQgc3RhdHVzLlxuICAgICAgICAgICAgICAgICAgICBpZiAobGlBdHRyaWJ1dGVzLmNsYXNzTGlzdC5oYXMoJ2NoZWNrZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlzdE5vZGUuY2hlY2soY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjaGVja2xpc3QtcmVsYXRlZCBjbGFzc2VzIGZyb20gYGxpQXR0cmlidXRlc2AuXG4gICAgICAgICAgICAgICAgICAgIGxpQXR0cmlidXRlcy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2xpc3QgY2hlY2tlZCB1bmNoZWNrZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtsaXN0XTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTWV0YWRhdGFOb2RlIH0gZnJvbSAnLi9NZXRhZGF0YU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTWV0YWRhdGFEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTWV0YWRhdGFOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IE1ldGFkYXRhTm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IG1ldGEgPSB7XG4gICAgICAgICAgICB0YWc6IG5vZGUuaHRtbFRhZyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbeyB0ZXh0OiBub2RlLmNvbnRlbnRzIH1dLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gbWV0YTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBNZXRhZGF0YVhtbERvbVBhcnNlciB9IGZyb20gJy4vTWV0YWRhdGFYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTWV0YWRhdGFEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vTWV0YURhdGFEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtNZXRhZGF0YVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW01ldGFkYXRhRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBNYXJrZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL01hcmtlck5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWV0YWRhdGFOb2RlUGFyYW1zIGV4dGVuZHMgQWJzdHJhY3ROb2RlUGFyYW1zIHtcbiAgICBodG1sVGFnOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YU5vZGUgZXh0ZW5kcyBNYXJrZXJOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbiAgICBodG1sVGFnOiBzdHJpbmc7XG4gICAgY29udGVudHMgPSAnJztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IE1ldGFkYXRhTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLmh0bWxUYWcgPSBwYXJhbXMuaHRtbFRhZztcbiAgICB9XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IubmFtZSArICc6ICcgKyB0aGlzLmh0bWxUYWc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBNZXRhZGF0YU5vZGUgfSBmcm9tICcuL01ldGFkYXRhTm9kZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbi8vIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9IVE1ML0NvbnRlbnRfY2F0ZWdvcmllcyNNZXRhZGF0YV9jb250ZW50XG5jb25zdCBNRVRBREFUQV9OT0RFTkFNRVMgPSBbXG4gICAgJ0JBU0UnLFxuICAgICdDT01NQU5EJyxcbiAgICAnTElOSycsXG4gICAgJ01FVEEnLFxuICAgICdOT1NDUklQVCcsXG4gICAgJ1NDUklQVCcsXG4gICAgJ1NUWUxFJyxcbiAgICAnVElUTEUnLFxuXTtcblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIE1FVEFEQVRBX05PREVOQU1FUy5pbmNsdWRlcyhub2RlTmFtZShpdGVtKSk7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPE1ldGFkYXRhTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHRlY2huaWNhbCA9IG5ldyBNZXRhZGF0YU5vZGUoeyBodG1sVGFnOiBub2RlTmFtZShpdGVtKSBhcyAnU0NSSVBUJyB8ICdTVFlMRScgfSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGVjaG5pY2FsLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGVjaG5pY2FsLmNvbnRlbnRzID0gaXRlbS5pbm5lckhUTUw7XG4gICAgICAgIHJldHVybiBbdGVjaG5pY2FsXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IE9kb29GaWVsZERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9PZG9vRmllbGREb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBPZG9vRmllbGRYbWxEb21QYXJzZXIgfSBmcm9tICcuL09kb29GaWVsZFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBSZWFjdGl2ZVZhbHVlIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL1JlYWN0aXZlVmFsdWUnO1xuaW1wb3J0IHsgT2Rvb0ZpZWxkTWFwIH0gZnJvbSAnLi9PZG9vRmllbGRNYXAnO1xuaW1wb3J0IHsgT2Rvb01vbmV0YXJ5RmllbGRYbWxEb21QYXJzZXIgfSBmcm9tICcuL09kb29Nb25ldGFyeUZpZWxkWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IE9kb29Nb25ldGFyeUZpZWxkRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL09kb29Nb25ldGFyeUZpZWxkRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgbWFrZVZlcnNpb25hYmxlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlJztcblxuZXhwb3J0IGludGVyZmFjZSBPZG9vRmllbGREZWZpbml0aW9uIHtcbiAgICBtb2RlbElkOiBzdHJpbmc7XG4gICAgcmVjb3JkSWQ6IHN0cmluZztcbiAgICBmaWVsZE5hbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPZG9vRmllbGRJbmZvIGV4dGVuZHMgT2Rvb0ZpZWxkRGVmaW5pdGlvbiB7XG4gICAgdmFsdWU6IFJlYWN0aXZlVmFsdWU8c3RyaW5nPjtcbiAgICBpc1ZhbGlkOiBSZWFjdGl2ZVZhbHVlPGJvb2xlYW4+O1xufVxuXG4vKipcbiAqIFJlZ2V4IHVzZWQgdG8gdmFsaWRhdGUgYSBmaWVsZC5cbiAqL1xuZXhwb3J0IGNvbnN0IGZpZWxkVmFsaWRhdG9ycyA9IHtcbiAgICBpbnRlZ2VyOiAvXlswLTldKyQvLFxuICAgIGZsb2F0OiAvXlswLTkuLF0rJC8sXG4gICAgbW9uZXRhcnk6IC9eWzAtOS4sXSskLyxcbn07XG5cbmV4cG9ydCBjbGFzcyBPZG9vRmllbGQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW09kb29GaWVsZFhtbERvbVBhcnNlciwgT2Rvb01vbmV0YXJ5RmllbGRYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtPZG9vTW9uZXRhcnlGaWVsZERvbU9iamVjdFJlbmRlcmVyLCBPZG9vRmllbGREb21PYmplY3RSZW5kZXJlcl0sXG4gICAgfTtcblxuICAgIHByaXZhdGUgX3JlZ2lzdHJ5OiBPZG9vRmllbGRNYXA8T2Rvb0ZpZWxkSW5mbz4gPSBuZXcgT2Rvb0ZpZWxkTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhbiBPZG9vIHJlY29yZC5cbiAgICAgKlxuICAgICAqIE5vIG5lZWQgdG8gZ2V0IHRoZSBpbmZvcmF0aW9uIGZyb20gdGhlIG5ldHdvcmsgaWYgaXQgaXMgYWxyZWFkeSBwcmVzZW50XG4gICAgICogaW4gdGhlIGRvY3VtZW50IHdoZW4gcGFyc2VkIGJ5IHRoZSBlZGl0b3IuXG4gICAgICpcbiAgICAgKiBDcmVhdGUgdHdvIGBSZWFjdGl2ZVZhbHVlYC4gT25lIHRoYXQgcmVwcmVzZW50IHRoZSBhY3R1YWwgdmFsdWUgb2YgdGhlXG4gICAgICogYHJlY29yZERlZmluaXRpb25gIGFuZCB0aGUgb3RoZXIgcmVwcmVzZW50IHRoZSB2YWxpZGl0eSBvZiB0aGUgdmFsdWUuXG4gICAgICpcbiAgICAgKiBTZWUgYGdldGAgdG8gcmV0cmlldmUgdGhlIHZhbHVlcyBmcm9tIGFuIGBPZG9vRmllbGRJbmZvYC5cbiAgICAgKi9cbiAgICByZWdpc3RlcihmaWVsZDogT2Rvb0ZpZWxkRGVmaW5pdGlvbiwgdHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogT2Rvb0ZpZWxkSW5mbyB7XG4gICAgICAgIGlmICghdGhpcy5fcmVnaXN0cnkuZ2V0KGZpZWxkKSkge1xuICAgICAgICAgICAgLy8gVE9ETzogUmV0cmlldmUgdGhlIGZpZWxkIGZyb20gT2RvbyB0aHJvdWdoIFJQQy5cbiAgICAgICAgICAgIGNvbnN0IHJlYWN0aXZlVmFsdWUgPSBuZXcgUmVhY3RpdmVWYWx1ZTxzdHJpbmc+KCk7XG4gICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gbmV3IFJlYWN0aXZlVmFsdWUodHJ1ZSk7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoZmllbGRWYWxpZGF0b3JzKS5pbmNsdWRlcyh0eXBlKSkge1xuICAgICAgICAgICAgICAgIHJlYWN0aXZlVmFsdWUub24oJ3NldCcsIChuZXdWYWx1ZTogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQuc2V0KCEhbmV3VmFsdWUubWF0Y2goZmllbGRWYWxpZGF0b3JzW3R5cGVdKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWFjdGl2ZVZhbHVlLnNldCh2YWx1ZSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlYWN0aXZlT2Rvb0ZpZWxkID0gbWFrZVZlcnNpb25hYmxlKHtcbiAgICAgICAgICAgICAgICAuLi5maWVsZCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcmVhY3RpdmVWYWx1ZSxcbiAgICAgICAgICAgICAgICBpc1ZhbGlkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RyeS5zZXQoZmllbGQsIHJlYWN0aXZlT2Rvb0ZpZWxkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcmVnaXN0cnkuZ2V0KGZpZWxkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgcmVhY3RpdmUgdmFsdWVzIGJ5IHByb3ZpZGluZyBhbiBgT2Rvb0ZpZWxkRGVmaW5pdGlvbmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRcbiAgICAgKi9cbiAgICBnZXQoZmllbGQ6IE9kb29GaWVsZERlZmluaXRpb24pOiBPZG9vRmllbGRJbmZvIHtcbiAgICAgICAgY29uc3QgcmVhY3RpdmVPZG9vRmllbGQgPSB0aGlzLl9yZWdpc3RyeS5nZXQoZmllbGQpO1xuICAgICAgICBpZiAoIXJlYWN0aXZlT2Rvb0ZpZWxkKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBSZXRyaWV2ZSB0aGUgZmllbGQgZnJvbSBPZG9vIHRocm91Z2ggUlBDLlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgIGBJbXBvc3NpYmxlIHRvIGZpbmQgdGhlIGZpZWxkICR7ZmllbGQuZmllbGROYW1lfSBmb3IgbW9kZWwgJHtmaWVsZC5tb2RlbElkfSB3aXRoIGlkICR7ZmllbGQubW9kZWxJZH0uYCxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlYWN0aXZlT2Rvb0ZpZWxkO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IE9kb29GaWVsZE5vZGUgfSBmcm9tICcuL09kb29GaWVsZE5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IERvbU9iamVjdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRG9tT2JqZWN0RWxlbWVudCB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgT2Rvb0ZpZWxkRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZTogUHJlZGljYXRlID0gT2Rvb0ZpZWxkTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBPZG9vRmllbGROb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgZG9tT2JqZWN0OiBEb21PYmplY3RFbGVtZW50ID0geyB0YWc6IG5vZGUuaHRtbFRhZyB9O1xuICAgICAgICBhd2FpdCB0aGlzLl9yZW5kZXJWYWx1ZShub2RlLCBkb21PYmplY3QpO1xuICAgICAgICByZXR1cm4gZG9tT2JqZWN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIG5vZGUgaW50byB0aGUgZ2l2ZW4gY29udGFpbmVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyXG4gICAgICovXG4gICAgYXN5bmMgX3JlbmRlclZhbHVlKG5vZGU6IE9kb29GaWVsZE5vZGUsIGNvbnRhaW5lcjogRG9tT2JqZWN0RWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBUT0RPIENITTogbm90IGhhdmluZyBkZWZhdWx0IHZhbHVlcyBpcyBjdW1iZXJzb21lXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gY29udGFpbmVyLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICBjb25zdCByZW5kZXJlZENoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucmVuZGVyQ2hpbGRyZW4obm9kZSk7XG4gICAgICAgIGNoaWxkcmVuLnB1c2goLi4ucmVuZGVyZWRDaGlsZHJlbik7XG4gICAgICAgIGNvbnRhaW5lci5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuXG4gICAgICAgIC8vIFRPRE8gQ0hNOiBub3QgaGF2aW5nIGRlZmF1bHQgdmFsdWVzIGlzIGN1bWJlcnNvbWVcbiAgICAgICAgY29udGFpbmVyLmF0dHJpYnV0ZXMgPSBjb250YWluZXIuYXR0cmlidXRlcyB8fCB7fTtcblxuICAgICAgICBjb25zdCBjbGFzc0xpc3QgPSBjb250YWluZXIuYXR0cmlidXRlcy5jbGFzcyB8fCBuZXcgU2V0KCk7XG5cbiAgICAgICAgLy8gSW5zdGFuY2VzIG9mIHRoZSBmaWVsZCBjb250YWluaW5nIHRoZSByYW5nZSBhcmUgYXJ0aWZpY2lhbGx5IGZvY3VzZWQuXG4gICAgICAgIGNvbnN0IGZvY3VzZWRGaWVsZCA9IHRoaXMuZW5naW5lLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2Uuc3RhcnQuYW5jZXN0b3IoXG4gICAgICAgICAgICBhbmNlc3RvciA9PlxuICAgICAgICAgICAgICAgIGFuY2VzdG9yIGluc3RhbmNlb2YgT2Rvb0ZpZWxkTm9kZSAmJlxuICAgICAgICAgICAgICAgIGFuY2VzdG9yLmZpZWxkSW5mby52YWx1ZSA9PT0gbm9kZS5maWVsZEluZm8udmFsdWUsXG4gICAgICAgICk7XG4gICAgICAgIGlmIChmb2N1c2VkRmllbGQpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdC5hZGQoJ2p3LWZvY3VzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjbGFzc0xpc3QuYWRkKCdqdy1vZG9vLWZpZWxkJyk7XG5cbiAgICAgICAgaWYgKCFub2RlLmZpZWxkSW5mby5pc1ZhbGlkLmdldCgpKSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QuYWRkKCdqdy1vZG9vLWZpZWxkLWludmFsaWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbm9kZS5kZXNjZW5kYW50cyhBdG9taWNOb2RlKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdC5hZGQoJ2p3LW9kb28tZmllbGQtZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRhaW5lci5hdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NMaXN0O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE9kb29GaWVsZERlZmluaXRpb24gfSBmcm9tICcuL09kb29GaWVsZCc7XG5cbmV4cG9ydCBjbGFzcyBPZG9vRmllbGRNYXA8VD4gZXh0ZW5kcyBNYXA8c3RyaW5nLCBUPiB7XG4gICAgc3RhdGljIGhhc2goZmllbGQ6IE9kb29GaWVsZERlZmluaXRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7ZmllbGQubW9kZWxJZH0tJHtmaWVsZC5yZWNvcmRJZH0tJHtmaWVsZC5maWVsZE5hbWV9YDtcbiAgICB9XG5cbiAgICBnZXQoZmllbGQ6IE9kb29GaWVsZERlZmluaXRpb24pOiBUO1xuICAgIGdldChrZXk6IHN0cmluZyk6IFQ7XG4gICAgZ2V0KGtleTogc3RyaW5nIHwgT2Rvb0ZpZWxkRGVmaW5pdGlvbik6IFQge1xuICAgICAgICBsZXQgaGFzaGVkS2V5OiBzdHJpbmc7XG4gICAgICAgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaGFzaGVkS2V5ID0ga2V5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGFzaGVkS2V5ID0gT2Rvb0ZpZWxkTWFwLmhhc2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0KGhhc2hlZEtleSk7XG4gICAgfVxuXG4gICAgc2V0KGZpZWxkOiBPZG9vRmllbGREZWZpbml0aW9uLCB2YWx1ZTogVCk6IHRoaXM7XG4gICAgc2V0KGtleTogc3RyaW5nLCB2YWx1ZTogVCk6IHRoaXM7XG4gICAgc2V0KGtleTogc3RyaW5nIHwgT2Rvb0ZpZWxkRGVmaW5pdGlvbiwgdmFsdWU6IFQpOiB0aGlzIHtcbiAgICAgICAgbGV0IGhhc2hlZEtleTogc3RyaW5nO1xuICAgICAgICBpZiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGhhc2hlZEtleSA9IGtleTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhhc2hlZEtleSA9IE9kb29GaWVsZE1hcC5oYXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuc2V0KGhhc2hlZEtleSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5pbXBvcnQgeyBPZG9vRmllbGRJbmZvIH0gZnJvbSAnLi9PZG9vRmllbGQnO1xuaW1wb3J0IHsgbWFrZVZlcnNpb25hYmxlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlJztcblxuZXhwb3J0IGNsYXNzIE9kb29GaWVsZE5vZGU8VCBleHRlbmRzIE9kb29GaWVsZEluZm8gPSBPZG9vRmllbGRJbmZvPiBleHRlbmRzIFZFbGVtZW50IHtcbiAgICBmaWVsZEluZm86IFQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcGFyYW1zOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8dHlwZW9mIFZFbGVtZW50PlswXSAmIHtcbiAgICAgICAgICAgIGZpZWxkSW5mbzogVDtcbiAgICAgICAgfSxcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgdGhpcy5maWVsZEluZm8gPSBtYWtlVmVyc2lvbmFibGUocGFyYW1zLmZpZWxkSW5mbyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IFZOb2RlIHdpdGggdGhlIHNhbWUgdHlwZSBhbmQgYXR0cmlidXRlcyBhcyB0aGlzIE9kb29GaWVsZE5vZGUuXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgT2Rvb0ZpZWxkTm9kZT5bMF0gPSB7XG4gICAgICAgICAgICBodG1sVGFnOiB0aGlzLmh0bWxUYWcsXG4gICAgICAgICAgICBmaWVsZEluZm86IHRoaXMuZmllbGRJbmZvLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoZGVlcENsb25lLCB7IC4uLmRlZmF1bHRzLCAuLi5wYXJhbXMgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBPZG9vRmllbGROb2RlIH0gZnJvbSAnLi9PZG9vRmllbGROb2RlJztcbmltcG9ydCB7IE9kb29GaWVsZEluZm8sIE9kb29GaWVsZERlZmluaXRpb24gfSBmcm9tICcuL09kb29GaWVsZCc7XG5pbXBvcnQgeyBPZG9vRmllbGQgfSBmcm9tICcuL09kb29GaWVsZCc7XG5pbXBvcnQgeyBPZG9vRmllbGRNYXAgfSBmcm9tICcuL09kb29GaWVsZE1hcCc7XG5pbXBvcnQgeyBDaGFyTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBPZG9vRmllbGRYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmXG4gICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtdHlwZSddICYmXG4gICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtbW9kZWwnXSAmJlxuICAgICAgICAgICAgKGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdjaGFyJyB8fFxuICAgICAgICAgICAgICAgIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICd0ZXh0JyB8fFxuICAgICAgICAgICAgICAgIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdodG1sJyB8fFxuICAgICAgICAgICAgICAgIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdmbG9hdCcgfHxcbiAgICAgICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtdHlwZSddLnZhbHVlID09PSAnaW50ZWdlcicpXG4gICAgICAgICk7XG4gICAgICAgIC8vIFRPRE86IEhhbmRsZSB0aG9zZSBmaWVsZHMgd2hlbiB0aGVpciBkZXBlbmRlY2llcyBhcmUgbWV0LlxuICAgICAgICAvLyBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtdHlwZSddLnZhbHVlID09PSAnbWFueTJvbmUnIHx8XG4gICAgICAgIC8vIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdkYXRlJyB8fFxuICAgICAgICAvLyBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtdHlwZSddLnZhbHVlID09PSAnZGF0ZXRpbWUnXG4gICAgICAgIC8vIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdpbWFnZScgfHxcbiAgICAgICAgLy8gaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLXR5cGUnXS52YWx1ZSA9PT0gJ2NvbnRhY3QnXG4gICAgfTtcblxuICAgIF9yZWFjdGl2ZUNoYW5nZXMgPSBuZXcgT2Rvb0ZpZWxkTWFwPE9kb29GaWVsZE5vZGU+KCk7XG5cbiAgICBhc3luYyBwYXJzZShlbGVtZW50OiBFbGVtZW50KTogUHJvbWlzZTxPZG9vRmllbGROb2RlW10+IHtcbiAgICAgICAgY29uc3QgZmllbGQ6IE9kb29GaWVsZERlZmluaXRpb24gPSB7XG4gICAgICAgICAgICBtb2RlbElkOiBlbGVtZW50LmF0dHJpYnV0ZXNbJ2RhdGEtb2UtbW9kZWwnXS52YWx1ZSxcbiAgICAgICAgICAgIHJlY29yZElkOiBlbGVtZW50LmF0dHJpYnV0ZXNbJ2RhdGEtb2UtaWQnXS52YWx1ZSxcbiAgICAgICAgICAgIGZpZWxkTmFtZTogZWxlbWVudC5hdHRyaWJ1dGVzWydkYXRhLW9lLWZpZWxkJ10udmFsdWUsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gZGF0YS1vZS10eXBlIGlzIGtpbmQgb2YgYSB3aWRnZXQgaW4gT2Rvby5cbiAgICAgICAgY29uc3QgZmllbGRUeXBlID0gZWxlbWVudC5hdHRyaWJ1dGVzWydkYXRhLW9lLXR5cGUnXS52YWx1ZTtcbiAgICAgICAgY29uc3QgZmllbGRzUmVnaXN0cnkgPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoT2Rvb0ZpZWxkKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9wYXJzZVZhbHVlKGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBmaWVsZHNSZWdpc3RyeS5yZWdpc3RlcihmaWVsZCwgZmllbGRUeXBlLCB2YWx1ZSk7XG5cbiAgICAgICAgY29uc3QgZmllbGROb2RlID0gYXdhaXQgdGhpcy5fcGFyc2VGaWVsZChlbGVtZW50LCBmaWVsZEluZm8pO1xuICAgICAgICBmaWVsZE5vZGUubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoZWxlbWVudCkpO1xuXG4gICAgICAgIC8vIFRPRE86IFJlbW92ZSB0aGUgbXV0ZSBtZWNoYW5pc20gd2hlbiBjaGFuZ2VzIGNvbWUgZnJvbSBtZW1vcnkuXG4gICAgICAgIC8vIFRoaXMgcHJldmVudCBjeWNsaW5nIHdoZW4gcmVnZW5lcmF0aW5nIGNoaWxkcmVuIGFmdGVyIGEgdmFsdWUgY2hhbmdlLlxuICAgICAgICBsZXQgbXV0ZSA9IGZhbHNlO1xuICAgICAgICBmaWVsZE5vZGUub24oJ2NoaWxkTGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmIChtdXRlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLl9yZWFjdGl2ZUNoYW5nZXMuc2V0KGZpZWxkTm9kZS5maWVsZEluZm8sIGZpZWxkTm9kZSk7XG4gICAgICAgICAgICBmaWVsZE5vZGUuZmllbGRJbmZvLnZhbHVlLnNldCh0aGlzLl9wYXJzZVZhbHVlKGZpZWxkTm9kZSkpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUT0RPOiBSZXBsYWNlIHRoaXMgdmFsdWUgbGlzdGVuaW5nIG1lY2hhbmlzbSBieSBtaXJyb3Igbm9kZXMuXG4gICAgICAgIGZpZWxkTm9kZS5maWVsZEluZm8udmFsdWUub24oJ3NldCcsICgpID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE86IFJldHJpZXZpbmcgdGhlIG5vZGUgdGhhdCBtYWRlIHRoZSBjaGFuZ2UgaXMgYSBzbGlnaHQgaGFja1xuICAgICAgICAgICAgLy8gdGhhdCB3aWxsIGJlIHJlbW92ZWQgd2hlbiBtaXJyb3Igbm9kZXMgYXJlIGF2YWlsYWJsZS5cbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsID0gdGhpcy5fcmVhY3RpdmVDaGFuZ2VzLmdldChmaWVsZE5vZGUuZmllbGRJbmZvKTtcbiAgICAgICAgICAgIGlmIChmaWVsZE5vZGUgPT09IG9yaWdpbmFsKSByZXR1cm47XG4gICAgICAgICAgICBtdXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIGZpZWxkTm9kZS5lbXB0eSgpO1xuICAgICAgICAgICAgZmllbGROb2RlLmFwcGVuZCguLi5vcmlnaW5hbC5jaGlsZHJlbigpLm1hcChjaGlsZCA9PiBjaGlsZC5jbG9uZSh0cnVlKSkpO1xuICAgICAgICAgICAgbXV0ZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFtmaWVsZE5vZGVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbiBgT2Rvb0ZpZWxkTm9kZWAgZnJvbSBhbiBlbGVtZW50IGFuZCBhIFJlYWN0aXZlVmFsdWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZWxlbWVudFxuICAgICAqIEBwYXJhbSBmaWVsZEluZm9cbiAgICAgKi9cbiAgICBhc3luYyBfcGFyc2VGaWVsZChlbGVtZW50OiBFbGVtZW50LCBmaWVsZEluZm86IE9kb29GaWVsZEluZm8pOiBQcm9taXNlPE9kb29GaWVsZE5vZGU+IHtcbiAgICAgICAgY29uc3QgZmllbGROb2RlID0gbmV3IE9kb29GaWVsZE5vZGUoeyBodG1sVGFnOiBlbGVtZW50LnRhZ05hbWUsIGZpZWxkSW5mbyB9KTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5lbGVtZW50LmNoaWxkTm9kZXMpO1xuICAgICAgICBmaWVsZE5vZGUuYXBwZW5kKC4uLmNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIGZpZWxkTm9kZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSB0aGUgdmFsdWUgb2YgdGhlIGZpZWxkIGZyb20gdGhlIGdpdmVuIHNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzb3VyY2VcbiAgICAgKi9cbiAgICBfcGFyc2VWYWx1ZShzb3VyY2U6IEVsZW1lbnQpOiBzdHJpbmc7XG4gICAgX3BhcnNlVmFsdWUoc291cmNlOiBPZG9vRmllbGROb2RlKTogc3RyaW5nO1xuICAgIF9wYXJzZVZhbHVlKHNvdXJjZTogRWxlbWVudCB8IE9kb29GaWVsZE5vZGUpOiBzdHJpbmcge1xuICAgICAgICBpZiAoc291cmNlIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZS5pbm5lckhUTUw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjaGFycyA9IHNvdXJjZS5kZXNjZW5kYW50cyhDaGFyTm9kZSkubWFwKGNoaWxkID0+IGNoaWxkLmNoYXIpO1xuICAgICAgICAgICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgT2Rvb0ZpZWxkRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL09kb29GaWVsZERvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IE9kb29Nb25ldGFyeUZpZWxkTm9kZSwgQ3VycmVuY3lQb3NpdGlvbiB9IGZyb20gJy4vT2Rvb01vbmV0YXJ5RmllbGROb2RlJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0RWxlbWVudCxcbiAgICBEb21PYmplY3RUZXh0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIE9kb29Nb25ldGFyeUZpZWxkRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBPZG9vRmllbGREb21PYmplY3RSZW5kZXJlciB7XG4gICAgcHJlZGljYXRlID0gT2Rvb01vbmV0YXJ5RmllbGROb2RlO1xuXG4gICAgYXN5bmMgX3JlbmRlclZhbHVlKG5vZGU6IE9kb29Nb25ldGFyeUZpZWxkTm9kZSwgY29udGFpbmVyOiBEb21PYmplY3RFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyOiBEb21PYmplY3RFbGVtZW50ID0ge1xuICAgICAgICAgICAgdGFnOiAnc3BhbicsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IG5ldyBTZXQoWydvZV9jdXJyZW5jeV92YWx1ZSddKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gVE9ETyBDSE06IG5vdCBoYXZpbmcgZGVmYXVsdCB2YWx1ZXMgaXMgY3VtYmVyc29tZVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGNvbnRhaW5lci5jaGlsZHJlbiB8fCBbXTtcblxuICAgICAgICBjaGlsZHJlbi5wdXNoKHZhbHVlQ29udGFpbmVyKTtcblxuICAgICAgICBjb25zdCBjdXJyZW5jeTogRG9tT2JqZWN0VGV4dCA9IHsgdGV4dDogbm9kZS5maWVsZEluZm8uY3VycmVuY3lWYWx1ZSB9O1xuICAgICAgICBpZiAobm9kZS5maWVsZEluZm8uY3VycmVuY3lQb3NpdGlvbiA9PT0gQ3VycmVuY3lQb3NpdGlvbi5CRUZPUkUpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnVuc2hpZnQoY3VycmVuY3kpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChjdXJyZW5jeSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb250YWluZXIuY2hpbGRyZW4gPSBjaGlsZHJlbjtcblxuICAgICAgICBhd2FpdCBzdXBlci5fcmVuZGVyVmFsdWUobm9kZSwgdmFsdWVDb250YWluZXIpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE9kb29GaWVsZE5vZGUgfSBmcm9tICcuL09kb29GaWVsZE5vZGUnO1xuaW1wb3J0IHsgT2Rvb0ZpZWxkSW5mbyB9IGZyb20gJy4vT2Rvb0ZpZWxkJztcblxuZXhwb3J0IGVudW0gQ3VycmVuY3lQb3NpdGlvbiB7XG4gICAgQkVGT1JFID0gJ0JFRk9SRScsXG4gICAgQUZURVIgPSAnQUZURVInLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9kb29Nb25ldGFyeUZpZWxkSW5mbyBleHRlbmRzIE9kb29GaWVsZEluZm8ge1xuICAgIGN1cnJlbmN5VmFsdWU6IHN0cmluZztcbiAgICBjdXJyZW5jeVBvc2l0aW9uOiBDdXJyZW5jeVBvc2l0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgT2Rvb01vbmV0YXJ5RmllbGROb2RlPFxuICAgIFQgZXh0ZW5kcyBPZG9vTW9uZXRhcnlGaWVsZEluZm8gPSBPZG9vTW9uZXRhcnlGaWVsZEluZm9cbj4gZXh0ZW5kcyBPZG9vRmllbGROb2RlPFQ+IHt9XG4iLCJpbXBvcnQgeyBPZG9vRmllbGRYbWxEb21QYXJzZXIgfSBmcm9tICcuL09kb29GaWVsZFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBPZG9vTW9uZXRhcnlGaWVsZE5vZGUsIEN1cnJlbmN5UG9zaXRpb24gfSBmcm9tICcuL09kb29Nb25ldGFyeUZpZWxkTm9kZSc7XG5pbXBvcnQgeyBPZG9vRmllbGRJbmZvIH0gZnJvbSAnLi9PZG9vRmllbGQnO1xuXG4vLyBUT0RPOiByZXRyaWV2ZSB0aGUgY3VycmVudCBkZWNpbWFsIG9mIHRoZSBjdXJyZW50IGxhbmcgaW4gb2Rvb1xuLy8gY29uc3QgbG9jYWxEZWNpbWFsU2VwYXJhdG9yID0gJy4nO1xuXG5leHBvcnQgY2xhc3MgT2Rvb01vbmV0YXJ5RmllbGRYbWxEb21QYXJzZXIgZXh0ZW5kcyBPZG9vRmllbGRYbWxEb21QYXJzZXIge1xuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLXR5cGUnXSAmJlxuICAgICAgICAgICAgaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLW1vZGVsJ10gJiZcbiAgICAgICAgICAgIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS10eXBlJ10udmFsdWUgPT09ICdtb25ldGFyeSdcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgX3BhcnNlRmllbGQoZWxlbWVudDogRWxlbWVudCwgZmllbGRJbmZvOiBPZG9vRmllbGRJbmZvKTogUHJvbWlzZTxPZG9vTW9uZXRhcnlGaWVsZE5vZGU+IHtcbiAgICAgICAgY29uc3QgYW1vdW50RWxlbWVudCA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignLm9lX2N1cnJlbmN5X3ZhbHVlJyk7XG4gICAgICAgIGNvbnN0IGN1cnJlbmN5RWxlbWVudCA9IGFtb3VudEVsZW1lbnQucHJldmlvdXNTaWJsaW5nIHx8IGFtb3VudEVsZW1lbnQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgY29uc3QgZmllbGROb2RlID0gbmV3IE9kb29Nb25ldGFyeUZpZWxkTm9kZSh7XG4gICAgICAgICAgICBodG1sVGFnOiBlbGVtZW50LnRhZ05hbWUsXG4gICAgICAgICAgICBmaWVsZEluZm86IHtcbiAgICAgICAgICAgICAgICAuLi5maWVsZEluZm8sXG4gICAgICAgICAgICAgICAgY3VycmVuY3lWYWx1ZTogY3VycmVuY3lFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICAgICAgICAgIGN1cnJlbmN5UG9zaXRpb246IGFtb3VudEVsZW1lbnQucHJldmlvdXNTaWJsaW5nXG4gICAgICAgICAgICAgICAgICAgID8gQ3VycmVuY3lQb3NpdGlvbi5CRUZPUkVcbiAgICAgICAgICAgICAgICAgICAgOiBDdXJyZW5jeVBvc2l0aW9uLkFGVEVSLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgY2hpbGROb2Rlc1RvUGFyc2UgPSBhbW91bnRFbGVtZW50LmNoaWxkTm9kZXM7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uY2hpbGROb2Rlc1RvUGFyc2UpO1xuICAgICAgICBmaWVsZE5vZGUuYXBwZW5kKC4uLmNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gZmllbGROb2RlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIF9wYXJzZVZhbHVlKHNvdXJjZTogRWxlbWVudCk6IHN0cmluZztcbiAgICBfcGFyc2VWYWx1ZShzb3VyY2U6IE9kb29Nb25ldGFyeUZpZWxkTm9kZSk6IHN0cmluZztcbiAgICBfcGFyc2VWYWx1ZShzb3VyY2U6IEVsZW1lbnQgfCBPZG9vTW9uZXRhcnlGaWVsZE5vZGUpOiBzdHJpbmcge1xuICAgICAgICBpZiAoc291cmNlIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgYW1vdW50RWxlbWVudCA9IHNvdXJjZS5xdWVyeVNlbGVjdG9yKCcub2VfY3VycmVuY3lfdmFsdWUnKTtcbiAgICAgICAgICAgIHJldHVybiBhbW91bnRFbGVtZW50LnRleHRDb250ZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN1cGVyLl9wYXJzZVZhbHVlKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBPZG9vVmlkZW9YbWxEb21QYXJzZXIgfSBmcm9tICcuL09kb29WaWRlb1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBPZG9vVmlkZW9IdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL09kb29WaWRlb0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgT2Rvb1ZpZGVvPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtPZG9vVmlkZW9YbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtPZG9vVmlkZW9IdG1sRG9tUmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBPZG9vVmlkZW9Ob2RlIH0gZnJvbSAnLi9PZG9vVmlkZW9Ob2RlJztcbmltcG9ydCB7IENvcmUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIE9kb29WaWRlb0h0bWxEb21SZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gT2Rvb1ZpZGVvTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBPZG9vVmlkZW9Ob2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kPENvcmU+KCdzZXRTZWxlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgdlNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBub2RlLFxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgb3Blbk1lZGlhID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kKCdvcGVuTWVkaWEnKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgd3JhcHBlcjogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnRElWJyxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICBjbGFzczogbmV3IFNldChbJ21lZGlhX2lmcmFtZV92aWRlbyddKSxcbiAgICAgICAgICAgICAgICAnZGF0YS1vZS1leHByZXNzaW9uJzogbm9kZS5zcmMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRhZzogJ0RJVicsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHsgY2xhc3M6IG5ldyBTZXQoWydjc3NfZWRpdGFibGVfbW9kZV9kaXNwbGF5J10pIH0sXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbeyB0ZXh0OiAnXFx1MDBBMCcgfV0sXG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaDogKGVsOiBIVE1MRWxlbWVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZXRTZWxlY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCBvcGVuTWVkaWEpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkZXRhY2g6IChlbDogSFRNTEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2V0U2VsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgb3Blbk1lZGlhKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGFnOiAnRElWJyxcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogeyBjbGFzczogbmV3IFNldChbJ21lZGlhX2lmcmFtZV92aWRlb19zaXplJ10pIH0sXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbeyB0ZXh0OiAnXFx1MDBBMCcgfV0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRhZzogJ0lGUkFNRScsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogbm9kZS5zcmMsXG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZWJvcmRlcjogJzAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dmdWxsc2NyZWVuOiAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHdyYXBwZXI7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZVBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9kb29WaWRlb05vZGVQYXJhbXMgZXh0ZW5kcyBBYnN0cmFjdE5vZGVQYXJhbXMge1xuICAgIHNyYzogc3RyaW5nO1xufVxuZXhwb3J0IGNsYXNzIE9kb29WaWRlb05vZGUgZXh0ZW5kcyBBdG9taWNOb2RlIHtcbiAgICBzcmM6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IE9kb29WaWRlb05vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgdGhpcy5zcmMgPSBwYXJhbXMuc3JjO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE9kb29WaWRlb05vZGUgfSBmcm9tICcuL09kb29WaWRlb05vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBPZG9vVmlkZW9YbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAobm9kZTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICBjb25zdCBpc1ZpZGVvID1cbiAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50ICYmXG4gICAgICAgICAgICBub2RlTmFtZShub2RlKSA9PT0gJ0RJVicgJiZcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZWRpYV9pZnJhbWVfdmlkZW8nKSAmJlxuICAgICAgICAgICAgbm9kZS5hdHRyaWJ1dGVzWydkYXRhLW9lLWV4cHJlc3Npb24nXSAmJlxuICAgICAgICAgICAgbm9kZS5hdHRyaWJ1dGVzWydkYXRhLW9lLWV4cHJlc3Npb24nXS52YWx1ZTtcbiAgICAgICAgcmV0dXJuIGlzVmlkZW87XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGVsZW1lbnQ6IEVsZW1lbnQpOiBQcm9taXNlPE9kb29WaWRlb05vZGVbXT4ge1xuICAgICAgICBjb25zdCB2aWRlbyA9IG5ldyBPZG9vVmlkZW9Ob2RlKHsgc3JjOiBlbGVtZW50LmF0dHJpYnV0ZXNbJ2RhdGEtb2UtZXhwcmVzc2lvbiddLnZhbHVlIH0pO1xuICAgICAgICB2aWRlby5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhlbGVtZW50KSk7XG4gICAgICAgIHJldHVybiBbdmlkZW9dO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luQ29uZmlnLCBKV1BsdWdpbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgTGlua0Zvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1saW5rL3NyYy9MaW5rRm9ybWF0JztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCBKV0VkaXRvciwgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExpbmsgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGluay9zcmMvTGluayc7XG5pbXBvcnQgeyBYbWwgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWwnO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBPZG9vU3RydWN0dXJlWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9PZG9vU3RydWN0dXJlWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IE9kb29JbWFnZURvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9PZG9vSW1hZ2VEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBPZG9vRm9udEF3ZXNvbWVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vT2Rvb0ZvbnRBd2Vzb21lRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgT2Rvb1RyYW5zbGF0aW9uWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9PZG9vVHJhbnNsYXRpb25YbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgRGl2aWRlck5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tZGl2aWRlci9zcmMvRGl2aWRlck5vZGUnO1xuaW1wb3J0IHsgSW1hZ2VOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWltYWdlL3NyYy9JbWFnZU5vZGUnO1xuaW1wb3J0IHsgVlJhbmdlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlJhbmdlJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IENvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUnO1xuXG5leHBvcnQgZW51bSBPZG9vUGFkZGluZ0NsYXNzZXMge1xuICAgIE5PTkUgPSAncGFkZGluZy1ub25lJyxcbiAgICBTTUFMTCA9ICdwYWRkaW5nLXNtYWxsJyxcbiAgICBNRURJVU0gPSAncGFkZGluZy1tZWRpdW0nLFxuICAgIExBUkdFID0gJ3BhZGRpbmctbGFyZ2UnLFxuICAgIFhMID0gJ3BhZGRpbmcteGwnLFxufVxuXG5jb25zdCBwYWRkaW5nQ2xhc3Nlc0xhYmVscyA9IHtcbiAgICBbT2Rvb1BhZGRpbmdDbGFzc2VzLk5PTkVdOiAnTm9uZScsXG4gICAgW09kb29QYWRkaW5nQ2xhc3Nlcy5TTUFMTF06ICdTbWFsbCcsXG4gICAgW09kb29QYWRkaW5nQ2xhc3Nlcy5NRURJVU1dOiAnTWVkaXVtJyxcbiAgICBbT2Rvb1BhZGRpbmdDbGFzc2VzLkxBUkdFXTogJ0xhcmdlJyxcbiAgICBbT2Rvb1BhZGRpbmdDbGFzc2VzLlhMXTogJ1hMJyxcbn07XG5cbmNvbnN0IHBhZGRpbmdDbGFzc2VzID0gT2JqZWN0LmtleXMocGFkZGluZ0NsYXNzZXNMYWJlbHMpO1xuXG5leHBvcnQgZW51bSBPZG9vSW1hZ2VDbGFzc2VzIHtcbiAgICBST1VOREVEID0gJ3JvdW5kZWQnLFxuICAgIFJPVU5ERURfQ0lSQ0xFID0gJ3JvdW5kZWQtY2lyY2xlJyxcbiAgICBTSEFET1cgPSAnc2hhZG93JyxcbiAgICBJTUdfVEhVTUJOQUlMID0gJ2ltZy10aHVtYm5haWwnLFxufVxuXG5jb25zdCBpbWFnZUNsYXNzZXNMYWJlbHMgPSB7XG4gICAgW09kb29JbWFnZUNsYXNzZXMuUk9VTkRFRF06ICdSb3VuZGVkJyxcbiAgICBbT2Rvb0ltYWdlQ2xhc3Nlcy5ST1VOREVEX0NJUkNMRV06ICdDaXJjbGUnLFxuICAgIFtPZG9vSW1hZ2VDbGFzc2VzLlNIQURPV106ICdTaGFkb3cnLFxuICAgIFtPZG9vSW1hZ2VDbGFzc2VzLklNR19USFVNQk5BSUxdOiAnVGh1bWJuYWlsJyxcbn07XG5cbi8qKlxuICogR2V0IG9uZSBpbWFnZSB0YXJnZXRlZCB3aXRoaW4gdGhlIHJhbmdlLlxuICogSWYgbW9yZSBpbWFnZXMgYXJlIHdpdGhpbiB0aGUgcmFuZ2UsIHJldHVybiB1bmRlZmluZWQuXG4gKi9cbmZ1bmN0aW9uIGdldFNpbmdsZUltYWdlKHJhbmdlOiBWUmFuZ2UpOiBJbWFnZU5vZGUgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IG5leHQgPSByYW5nZS5zdGFydC5uZXh0TGVhZigpO1xuICAgIGlmIChuZXh0IGluc3RhbmNlb2YgSW1hZ2VOb2RlKSB7XG4gICAgICAgIGNvbnN0IHByZXYgPSByYW5nZS5lbmQubmV4dExlYWYoKTtcbiAgICAgICAgaWYgKHByZXYgPT09IG5leHQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBDaGVjayBpZiB0aGVyZSBpcyBhdCBleGFjdGx5IG9uZSBpbWFnZSB3aXRoaW4gdGhlIGVkaXRvciByYW5nZVxuICovXG5mdW5jdGlvbiBpc0ltYWdlVmlzaWJsZShlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhZ2V0U2luZ2xlSW1hZ2UoZWRpdG9yLnNlbGVjdGlvbi5yYW5nZSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2V0UGFkZGluZ1BhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIC8qKlxuICAgICAqIFRoZSBuYW1lIG9mIHRoZSBwYWRkaW5nIGNsYXNzLlxuICAgICAqL1xuICAgIGNsYXNzTmFtZTogT2Rvb1BhZGRpbmdDbGFzc2VzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNldEltYWdlV2lkdGhQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIGltYWdlIGluIHBlcmNlbnRhZ2UgKGUuZy4gXCIxMFwiKSBvciBcImF1dG9cIiB0byByZW1vdmUgdGhlXG4gICAgICogd2lkdGggYXR0cmlidXRlLlxuICAgICAqL1xuICAgIHdpZHRoOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2V0SW1hZ2VDbGFzc1BhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGNsYXNzTmFtZTogT2Rvb0ltYWdlQ2xhc3Nlcztcbn1cblxuZXhwb3J0IGNsYXNzIE9kb288VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lLCBMaW5rLCBYbWxdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgTGF5b3V0PiA9IHtcbiAgICAgICAgcGFyc2VyczogW09kb29TdHJ1Y3R1cmVYbWxEb21QYXJzZXIsIE9kb29UcmFuc2xhdGlvblhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW09kb29JbWFnZURvbU9iamVjdFJlbmRlcmVyLCBPZG9vRm9udEF3ZXNvbWVEb21PYmplY3RSZW5kZXJlcl0sXG4gICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ09kb29MaW5rQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbGluaycsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0luc2VydCBsaW5rJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ29wZW5MaW5rRGlhbG9nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gcmFuZ2Uuc3RhcnQubmV4dFNpYmxpbmcoKSB8fCByYW5nZS5zdGFydC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBJbmxpbmVOb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEhbm9kZS5tb2RpZmllcnMuZmluZChMaW5rRm9ybWF0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2ZhIGZhLWxpbmsgZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ09kb29NZWRpYUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ21lZGlhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTWVkaWEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAnb3Blbk1lZGlhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1maWxlLWltYWdlLW8gZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ09kb29UZXh0Q29sb3JCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPERpdmlkZXJOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICd0ZXh0Y29sb3JwaWNrZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdUZXh0IENvbG9yIHBpY2tlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdvcGVuVGV4dENvbG9yUGlja2VyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1mb250IGZhLWZ3IGRyb3Bkb3duLXRvZ2dsZScgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEF0dHJpYnV0ZXMoeyAnZGF0YS10b2dnbGUnOiAnZHJvcGRvd24nIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3duQ29udGVudCA9IG5ldyBEaXZpZGVyTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bkNvbnRlbnQubW9kaWZpZXJzLmFwcGVuZChuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZHJvcGRvd24tbWVudScgfSkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IG5ldyBEaXZpZGVyTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bkNvbnRhaW5lci5tb2RpZmllcnMuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEF0dHJpYnV0ZXMoeyBjbGFzczogJ2Ryb3Bkb3duIGp3LWRyb3Bkb3duIGp3LWRyb3Bkb3duLXRleHRjb2xvcicgfSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZChidXR0b24pO1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bkNvbnRhaW5lci5hcHBlbmQoZHJvcGRvd25Db250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkcm9wZG93bkNvbnRhaW5lcl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPZG9vQmFja2dyb3VuZENvbG9yQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxEaXZpZGVyTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmFja2dyb3VuZGNvbG9ycGlja2VyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQmFja2dyb3VuZCBDb2xvciBwaWNrZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZElkOiAnb3BlbkJhY2tncm91bmRDb2xvclBpY2tlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtcGFpbnQtYnJ1c2ggZmEtZncgZHJvcGRvd24tdG9nZ2xlJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQXR0cmlidXRlcyh7ICdkYXRhLXRvZ2dsZSc6ICdkcm9wZG93bicgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZHJvcGRvd25Db250ZW50ID0gbmV3IERpdmlkZXJOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQ29udGVudC5tb2RpZmllcnMuYXBwZW5kKG5ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdkcm9wZG93bi1tZW51JyB9KSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3duQ29udGFpbmVyID0gbmV3IERpdmlkZXJOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQ29udGFpbmVyLm1vZGlmaWVycy5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgQXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICdkcm9wZG93biBqdy1kcm9wZG93biBqdy1kcm9wZG93bi1iYWNrZ3JvdW5kY29sb3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZChidXR0b24pO1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bkNvbnRhaW5lci5hcHBlbmQoZHJvcGRvd25Db250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkcm9wZG93bkNvbnRhaW5lcl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPZG9vRGlzY2FyZEJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2Rpc2NhcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdEaXNjYXJkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2Rpc2NhcmRPZG9vJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS10aW1lcyBmYS1mdyBqdy1kYW5nZXItYnV0dG9uJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPZG9vU2F2ZUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3NhdmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdTYXZlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3NhdmVPZG9vJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS1zYXZlIGZhLWZ3IGp3LXByaW1hcnktYnV0dG9uJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLl9tYWtlSW1hZ2VQYWRkaW5nQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VQYWRkaW5nTm9uZUFjdGlvbmFibGUnLFxuICAgICAgICAgICAgICAgIE9kb29QYWRkaW5nQ2xhc3Nlcy5OT05FLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZVBhZGRpbmdDb21wb25lbnQoXG4gICAgICAgICAgICAgICAgJ09kb29JbWFnZVBhZGRpbmdTbWFsbEFjdGlvbmFibGUnLFxuICAgICAgICAgICAgICAgIE9kb29QYWRkaW5nQ2xhc3Nlcy5TTUFMTCxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB0aGlzLl9tYWtlSW1hZ2VQYWRkaW5nQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VQYWRkaW5nTWVkaXVtQWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgT2Rvb1BhZGRpbmdDbGFzc2VzLk1FRElVTSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB0aGlzLl9tYWtlSW1hZ2VQYWRkaW5nQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VQYWRkaW5nTGFyZ2VBY3Rpb25hYmxlJyxcbiAgICAgICAgICAgICAgICBPZG9vUGFkZGluZ0NsYXNzZXMuTEFSR0UsXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgdGhpcy5fbWFrZUltYWdlUGFkZGluZ0NvbXBvbmVudCgnT2Rvb0ltYWdlUGFkZGluZ1hMQWN0aW9uYWJsZScsIE9kb29QYWRkaW5nQ2xhc3Nlcy5YTCksXG5cbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZVdpZHRoQ29tcG9uZW50KCdPZG9vSW1hZ2VXaWR0aEF1dG9BY3Rpb25hYmxlJywgJ2F1dG8nKSxcbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZVdpZHRoQ29tcG9uZW50KCdPZG9vSW1hZ2VXaWR0aDI1QWN0aW9uYWJsZScsICcyNScpLFxuICAgICAgICAgICAgdGhpcy5fbWFrZUltYWdlV2lkdGhDb21wb25lbnQoJ09kb29JbWFnZVdpZHRoNTBBY3Rpb25hYmxlJywgJzUwJyksXG4gICAgICAgICAgICB0aGlzLl9tYWtlSW1hZ2VXaWR0aENvbXBvbmVudCgnT2Rvb0ltYWdlV2lkdGg3NUFjdGlvbmFibGUnLCAnNzUnKSxcbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZVdpZHRoQ29tcG9uZW50KCdPZG9vSW1hZ2VXaWR0aDEwMEFjdGlvbmFibGUnLCAnMTAwJyksXG5cbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZUNsYXNzQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VSb3VuZGVkQWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgT2Rvb0ltYWdlQ2xhc3Nlcy5ST1VOREVELFxuICAgICAgICAgICAgICAgICdmYS1zcXVhcmUnLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZUNsYXNzQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VSb3VuZGVkQ2lyY2xlQWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgT2Rvb0ltYWdlQ2xhc3Nlcy5ST1VOREVEX0NJUkNMRSxcbiAgICAgICAgICAgICAgICAnZmEtY2lyY2xlLW8nLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuX21ha2VJbWFnZUNsYXNzQ29tcG9uZW50KFxuICAgICAgICAgICAgICAgICdPZG9vSW1hZ2VSb3VuZGVkU2hhZG93QWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgT2Rvb0ltYWdlQ2xhc3Nlcy5TSEFET1csXG4gICAgICAgICAgICAgICAgJ2ZhLXN1bi1vJyxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB0aGlzLl9tYWtlSW1hZ2VDbGFzc0NvbXBvbmVudChcbiAgICAgICAgICAgICAgICAnT2Rvb0ltYWdlUm91bmRlZFRodW1ibmFpbEFjdGlvbmFibGUnLFxuICAgICAgICAgICAgICAgIE9kb29JbWFnZUNsYXNzZXMuSU1HX1RIVU1CTkFJTCxcbiAgICAgICAgICAgICAgICAnZmEtcGljdHVyZS1vJyxcbiAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ09kb29Dcm9wQWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2Nyb3AtaW1hZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdDcm9wJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2Nyb3BJbWFnZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtY3JvcCBmYS1mdycgfSldLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogaXNJbWFnZVZpc2libGUsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdPZG9vVHJhbnNmb3JtQWN0aW9uYWJsZScsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3RyYW5zZm9ybS1pbWFnZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1RyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0cmFuc2Zvcm1JbWFnZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtb2JqZWN0LXVuZ3JvdXAgZmEtZncnIH0pXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGlzSW1hZ2VWaXNpYmxlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtidXR0b25dO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1xuICAgICAgICAgICAgWydPZG9vTGlua0J1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ09kb29NZWRpYUJ1dHRvbicsIFsnYWN0aW9uYWJsZXMnXV0sXG4gICAgICAgICAgICBbJ09kb29EaXNjYXJkQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXSxcbiAgICAgICAgICAgIFsnT2Rvb1NhdmVCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dLFxuICAgICAgICBdLFxuICAgIH07XG5cbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgc2V0SW1hZ2VQYWRkaW5nOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnNldEltYWdlUGFkZGluZyxcbiAgICAgICAgfSxcbiAgICAgICAgc2V0SW1hZ2VXaWR0aDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5zZXRJbWFnZVdpZHRoLFxuICAgICAgICB9LFxuICAgICAgICBzZXRJbWFnZUNsYXNzOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnNldEltYWdlQ2xhc3MsXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIHNldEltYWdlUGFkZGluZyhwYXJhbXM6IFNldFBhZGRpbmdQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSBnZXRTaW5nbGVJbWFnZShwYXJhbXMuY29udGV4dC5yYW5nZSk7XG4gICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgY29uc3QgY2xhc3NMaXN0ID0gaW1hZ2UubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5jbGFzc0xpc3Q7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBwYWRkaW5nQ2xhc3Nlcykge1xuICAgICAgICAgICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJhbXMuY2xhc3NOYW1lID09PSAncGFkZGluZy1ub25lJykgcmV0dXJuO1xuICAgICAgICAgICAgY2xhc3NMaXN0LmFkZChwYXJhbXMuY2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRJbWFnZVdpZHRoKHBhcmFtczogU2V0SW1hZ2VXaWR0aFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBpbWFnZSA9IGdldFNpbmdsZUltYWdlKHBhcmFtcy5jb250ZXh0LnJhbmdlKTtcbiAgICAgICAgaWYgKGltYWdlKSB7XG4gICAgICAgICAgICBjb25zdCBzdHlsZSA9IGltYWdlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGU7XG4gICAgICAgICAgICBpZiAocGFyYW1zLndpZHRoID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgICAgICBzdHlsZS5yZW1vdmUoJ3dpZHRoJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0eWxlLnNldCgnd2lkdGgnLCBwYXJhbXMud2lkdGggKyAnJScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHNldEltYWdlQ2xhc3MocGFyYW1zOiBTZXRJbWFnZUNsYXNzUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGltYWdlID0gZ2V0U2luZ2xlSW1hZ2UocGFyYW1zLmNvbnRleHQucmFuZ2UpO1xuICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzTGlzdCA9IGltYWdlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuY2xhc3NMaXN0O1xuICAgICAgICAgICAgY2xhc3NMaXN0LnRvZ2dsZShwYXJhbXMuY2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9tYWtlSW1hZ2VQYWRkaW5nQ29tcG9uZW50KFxuICAgICAgICBjb21wb25lbnRJZDogc3RyaW5nLFxuICAgICAgICBjbGFzc05hbWU6IE9kb29QYWRkaW5nQ2xhc3NlcyxcbiAgICApOiBDb21wb25lbnREZWZpbml0aW9uIHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50OiBDb21wb25lbnREZWZpbml0aW9uID0ge1xuICAgICAgICAgICAgaWQ6IGNvbXBvbmVudElkLFxuICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtczogU2V0UGFkZGluZ1BhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBgc2V0LSR7Y2xhc3NOYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBwYWRkaW5nQ2xhc3Nlc0xhYmVsc1tjbGFzc05hbWVdLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdzZXRJbWFnZVBhZGRpbmcnLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogcGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBpc0ltYWdlVmlzaWJsZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWFnZSA9IGdldFNpbmdsZUltYWdlKGVkaXRvci5zZWxlY3Rpb24ucmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1hZ2VBdHRyaWJ1dGUgPSBpbWFnZS5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUgPT09IE9kb29QYWRkaW5nQ2xhc3Nlcy5OT05FKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdDbGFzc2VzLmV2ZXJ5KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9PiAhaW1hZ2VBdHRyaWJ1dGUuaGFzKGNsYXNzTmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUF0dHJpYnV0ZS5jbGFzc0xpc3QuaGFzKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb21wb25lbnQ7XG4gICAgfVxuICAgIF9tYWtlSW1hZ2VXaWR0aENvbXBvbmVudChjb21wb25lbnRJZDogc3RyaW5nLCB3aWR0aDogc3RyaW5nKTogQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudDogQ29tcG9uZW50RGVmaW5pdGlvbiA9IHtcbiAgICAgICAgICAgIGlkOiBjb21wb25lbnRJZCxcbiAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXM6IFNldEltYWdlV2lkdGhQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGBzZXQtaW1hZ2Utd2lkdGgtJHt3aWR0aH1gLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogd2lkdGggPT09ICdhdXRvJyA/ICdhdXRvJyA6IHdpZHRoICsgJyUnLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdzZXRJbWFnZVdpZHRoJyxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogaXNJbWFnZVZpc2libGUsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1hZ2UgPSBnZXRTaW5nbGVJbWFnZShlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGltYWdlQXR0cmlidXRlID0gaW1hZ2UubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoaW1hZ2VBdHRyaWJ1dGUuc3R5bGUuZ2V0KCd3aWR0aCcpKSA9PT0gcGFyc2VJbnQod2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb21wb25lbnQ7XG4gICAgfVxuICAgIF9tYWtlSW1hZ2VDbGFzc0NvbXBvbmVudChcbiAgICAgICAgY29tcG9uZW50SWQ6IHN0cmluZyxcbiAgICAgICAgY2xhc3NOYW1lOiBPZG9vSW1hZ2VDbGFzc2VzLFxuICAgICAgICBmYUljb246IHN0cmluZyxcbiAgICApOiBDb21wb25lbnREZWZpbml0aW9uIHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50OiBDb21wb25lbnREZWZpbml0aW9uID0ge1xuICAgICAgICAgICAgaWQ6IGNvbXBvbmVudElkLFxuICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtczogU2V0SW1hZ2VDbGFzc1BhcmFtcyA9IHsgY2xhc3NOYW1lIH07XG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogYHNldC1pbWFnZS1jbGFzcy0ke2NsYXNzTmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogaW1hZ2VDbGFzc2VzTGFiZWxzW2NsYXNzTmFtZV0sXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3NldEltYWdlQ2xhc3MnLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogcGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiBgZmEgJHtmYUljb259IGZhLWZ3YCB9KV0sXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGlzSW1hZ2VWaXNpYmxlLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGltYWdlID0gZ2V0U2luZ2xlSW1hZ2UoZWRpdG9yLnNlbGVjdGlvbi5yYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWFnZUF0dHJpYnV0ZSA9IGltYWdlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGltYWdlQXR0cmlidXRlLmNsYXNzTGlzdC5oYXMoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvbnRBd2Vzb21lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1mb250YXdlc29tZS9zcmMvRm9udEF3ZXNvbWVOb2RlJztcbmltcG9ydCB7IERvbU9iamVjdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRm9udEF3ZXNvbWVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1mb250YXdlc29tZS9zcmMvRm9udEF3ZXNvbWVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuZXhwb3J0IGNsYXNzIE9kb29Gb250QXdlc29tZURvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgRm9udEF3ZXNvbWVEb21PYmplY3RSZW5kZXJlciB7XG4gICAgcHJlZGljYXRlID0gRm9udEF3ZXNvbWVOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKFxuICAgICAgICBub2RlOiBGb250QXdlc29tZU5vZGUsXG4gICAgICAgIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPERvbU9iamVjdD4sXG4gICAgKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgZG9tT2JqZWN0OiBEb21PYmplY3QgPSBhd2FpdCBzdXBlci5yZW5kZXIobm9kZSwgd29ya2VyKTtcbiAgICAgICAgaWYgKGRvbU9iamVjdCAmJiAnY2hpbGRyZW4nIGluIGRvbU9iamVjdCkge1xuICAgICAgICAgICAgY29uc3QgZmEgPSBkb21PYmplY3QuY2hpbGRyZW5bMV07XG4gICAgICAgICAgICBpZiAoJ3RhZycgaW4gZmEpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzYXZlZEF0dGFjaCA9IGZhLmF0dGFjaDtcbiAgICAgICAgICAgICAgICBmYS5hdHRhY2ggPSAoZWw6IEhUTUxFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYXZlZEF0dGFjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZWRBdHRhY2goZWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0geyBpbWFnZTogbm9kZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kKCdvcGVuTWVkaWEnLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkb21PYmplY3Q7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSW1hZ2VEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbWFnZS9zcmMvSW1hZ2VEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBJbWFnZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlTm9kZSc7XG5pbXBvcnQgeyBEb21PYmplY3QgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5leHBvcnQgY2xhc3MgT2Rvb0ltYWdlRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBJbWFnZURvbU9iamVjdFJlbmRlcmVyIHtcbiAgICBwcmVkaWNhdGUgPSBJbWFnZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogSW1hZ2VOb2RlLCB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+KTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlLCB3b3JrZXIpO1xuICAgICAgICBpZiAoaW1hZ2UgJiYgJ3RhZycgaW4gaW1hZ2UpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhdmVkQXR0YWNoID0gaW1hZ2UuYXR0YWNoO1xuICAgICAgICAgICAgY29uc3Qgc2F2ZWREZXRhY2ggPSBpbWFnZS5kZXRhY2g7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVDbGljayA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXMgPSB7IGltYWdlOiBub2RlIH07XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kKCdvcGVuTWVkaWEnLCBwYXJhbXMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltYWdlLmF0dGFjaCA9IChlbDogSFRNTEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWRBdHRhY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgc2F2ZWRBdHRhY2goZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIGhhbmRsZUNsaWNrKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGltYWdlLmRldGFjaCA9IChlbDogSFRNTEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWREZXRhY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgc2F2ZWREZXRhY2goZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIGhhbmRsZUNsaWNrKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZFbGVtZW50LCBWRWxlbWVudFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2Rvb1N0cnVjdHVyZU5vZGVQYXJhbXMgZXh0ZW5kcyBWRWxlbWVudFBhcmFtcyB7XG4gICAgeHBhdGg6IHN0cmluZztcbiAgICB2aWV3SWQ6IHN0cmluZztcbn1cbmV4cG9ydCBjbGFzcyBPZG9vU3RydWN0dXJlTm9kZSBleHRlbmRzIFZFbGVtZW50IHtcbiAgICB4cGF0aDogc3RyaW5nO1xuICAgIHZpZXdJZDogc3RyaW5nO1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IocGFyYW1zOiBPZG9vU3RydWN0dXJlTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLnhwYXRoID0gcGFyYW1zLnhwYXRoO1xuICAgICAgICB0aGlzLnZpZXdJZCA9IHBhcmFtcy52aWV3SWQ7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBPZG9vU3RydWN0dXJlTm9kZSB9IGZyb20gJy4vT2Rvb1N0cnVjdHVyZU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgT2Rvb1N0cnVjdHVyZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyIHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ29lX3N0cnVjdHVyZScpICYmXG4gICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXMgJiZcbiAgICAgICAgICAgIGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS14cGF0aCddICYmXG4gICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UtaWQnXVxuICAgICAgICApO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHN0cnVjdHVyZSBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IG9kb29TdHJ1Y3R1cmUgPSBuZXcgT2Rvb1N0cnVjdHVyZU5vZGUoe1xuICAgICAgICAgICAgaHRtbFRhZzogbm9kZU5hbWUoaXRlbSksXG4gICAgICAgICAgICB4cGF0aDogaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLXhwYXRoJ10udmFsdWUsXG4gICAgICAgICAgICB2aWV3SWQ6IGl0ZW0uYXR0cmlidXRlc1snZGF0YS1vZS1pZCddLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICAgICAgb2Rvb1N0cnVjdHVyZS5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgb2Rvb1N0cnVjdHVyZS5hcHBlbmQoLi4uY2hpbGRyZW4pO1xuICAgICAgICByZXR1cm4gW29kb29TdHJ1Y3R1cmVdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBPZG9vVHJhbnNsYXRpb25Gb3JtYXQgZXh0ZW5kcyBGb3JtYXQge1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xuICAgIGNvbnN0cnVjdG9yKGh0bWxUYWc6IHN0cmluZywgdHJhbnNsYXRpb25JZDogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKGh0bWxUYWcpO1xuICAgICAgICB0aGlzLnRyYW5zbGF0aW9uSWQgPSB0cmFuc2xhdGlvbklkO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYE9kb29UcmFuc2xhdGlvbjogJHtzdXBlci5uYW1lfWA7XG4gICAgfVxuICAgIC8vIFRPRE86IEF0dHJpYnV0ZXMgb24gT2Rvb1RyYW5zbGF0aW9uIHNob3VsZCByZWFjdGl2ZWx5IHJlYWQgdGhlIHZhbHVlcyBzZXRcbiAgICAvLyBvbiB0aGUgbm9kZSBpdHNlbGYgcmF0aGVyIHRoYW4gaGF2aW5nIHRvIG1hbnVhbGx5IHN5bmNocm9uaXplIHRoZW0uXG4gICAgZ2V0IHRyYW5zbGF0aW9uSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LmdldCgnZGF0YS1vZS10cmFuc2xhdGlvbi1pZCcpO1xuICAgIH1cbiAgICBzZXQgdHJhbnNsYXRpb25JZCh0cmFuc2xhdGlvbklkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgnZGF0YS1vZS10cmFuc2xhdGlvbi1pZCcsIHRyYW5zbGF0aW9uSWQpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBjbG9uZSgpOiB0aGlzIHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBzdXBlci5jbG9uZSgpO1xuICAgICAgICBjbG9uZS50cmFuc2xhdGlvbklkID0gdGhpcy50cmFuc2xhdGlvbklkO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRm9ybWF0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IE9kb29UcmFuc2xhdGlvbkZvcm1hdCB9IGZyb20gJy4vT2Rvb1RyYW5zbGF0aW9uRm9ybWF0JztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIE9kb29UcmFuc2xhdGlvblhtbERvbVBhcnNlciBleHRlbmRzIEZvcm1hdFhtbERvbVBhcnNlciB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLXRyYW5zbGF0aW9uLXN0YXRlJ107XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHRyYW5zbGF0aW9uIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgb2Rvb1RyYW5zbGF0aW9uID0gbmV3IE9kb29UcmFuc2xhdGlvbkZvcm1hdChcbiAgICAgICAgICAgIG5vZGVOYW1lKGl0ZW0pLFxuICAgICAgICAgICAgaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtb2UtdHJhbnNsYXRpb24taWQnKSxcbiAgICAgICAgKTtcbiAgICAgICAgb2Rvb1RyYW5zbGF0aW9uLm1vZGlmaWVycy5yZXBsYWNlKEF0dHJpYnV0ZXMsIHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgdGhpcy5hcHBseUZvcm1hdChvZG9vVHJhbnNsYXRpb24sIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUVdlYiB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyBKV1BsdWdpbkNvbmZpZywgSldQbHVnaW4gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBPd2xEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vT3dsRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IE93bEVudiwgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQnJvd3NlciB9IGZyb20gJ0BvZG9vL293bC9kaXN0L3R5cGVzL2Jyb3dzZXInO1xuXG4vLyBUZW1wb3JhcnkgZml4IHdhaXRpbmcgZm9yIHRoZSBgRW52YCBpbnRlcmZhY2Ugb2YgT3dsIHRvIGxldCB0aGUgYGJyb3dzZXJgXG4vLyBwcm9wZXJ0eSBiZSBvcHRpb25hbFxuY29uc3QgYnJvd3NlcjogQnJvd3NlciA9IHtcbiAgICBzZXRUaW1lb3V0OiB3aW5kb3cuc2V0VGltZW91dC5iaW5kKHdpbmRvdyksXG4gICAgY2xlYXJUaW1lb3V0OiB3aW5kb3cuY2xlYXJUaW1lb3V0LmJpbmQod2luZG93KSxcbiAgICBzZXRJbnRlcnZhbDogd2luZG93LnNldEludGVydmFsLmJpbmQod2luZG93KSxcbiAgICBjbGVhckludGVydmFsOiB3aW5kb3cuY2xlYXJJbnRlcnZhbC5iaW5kKHdpbmRvdyksXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lOiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lLmJpbmQod2luZG93KSxcbiAgICByYW5kb206IE1hdGgucmFuZG9tLFxuICAgIERhdGU6IHdpbmRvdy5EYXRlLFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICBmZXRjaDogKHdpbmRvdy5mZXRjaCB8fCAoKCk6IHZvaWQgPT4ge30pKS5iaW5kKHdpbmRvdyksXG4gICAgbG9jYWxTdG9yYWdlOiB3aW5kb3cubG9jYWxTdG9yYWdlLFxufTtcblxuZXhwb3J0IGNsYXNzIE93bDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UmVuZGVyZXI+ID0ge1xuICAgICAgICByZW5kZXJlcnM6IFtPd2xEb21PYmplY3RSZW5kZXJlcl0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkZXJzID0ge1xuICAgICAgICBvd2xUZW1wbGF0ZXM6IHRoaXMuX2xvYWRUZW1wbGF0ZXMsXG4gICAgfTtcblxuICAgIGVudjogT3dsRW52ID0ge1xuICAgICAgICBxd2ViOiBuZXcgUVdlYigpLFxuICAgICAgICBlZGl0b3I6IHRoaXMuZWRpdG9yLFxuICAgICAgICBicm93c2VyOiBicm93c2VyLFxuICAgIH07XG5cbiAgICBjb21wb25lbnRzID0gbmV3IE1hcDxWTm9kZSwgT3dsQ29tcG9uZW50PHt9Pj4oKTtcblxuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgWywgY29tcG9uZW50XSBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb21wb25lbnRzLmNsZWFyKCk7XG4gICAgfVxuICAgIHByaXZhdGUgX2xvYWRUZW1wbGF0ZXModGVtcGxhdGVzOiBBcnJheTxzdHJpbmcgfCBEb2N1bWVudD4pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCB0ZW1wbGF0ZSBvZiB0ZW1wbGF0ZXMpIHtcbiAgICAgICAgICAgIHRoaXMuZW52LnF3ZWIuYWRkVGVtcGxhdGVzKHRlbXBsYXRlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyBFbnYgfSBmcm9tICdAb2Rvby9vd2wvZGlzdC90eXBlcy9jb21wb25lbnQvY29tcG9uZW50JztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3dsRW52IGV4dGVuZHMgRW52IHtcbiAgICBlZGl0b3I6IEpXRWRpdG9yO1xufVxuXG5leHBvcnQgY2xhc3MgT3dsQ29tcG9uZW50PFByb3BzPiBleHRlbmRzIENvbXBvbmVudDxQcm9wcywgT3dsRW52PiB7XG4gICAgc3RhdGU6IHt9O1xuXG4gICAgX3N0b3JhZ2VLZXlQcmVmaXggPSAnT3dsVUknICsgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lICsgJzonO1xuICAgIC8vIFN0YXRlIGl0ZW1zIHdoaWNoIG5hbWVzIGFyZSBsaXN0ZWQgaW4gdGhlIGxvY2FsU3RvcmFnZSBwcm9wZXJ0eSB3aWxsIGJlXG4gICAgLy8gcmVhZCBmcm9tIHRoZSBsb2NhbFN0b3JhZ2UgZHVyaW5nIHRoZSB3aWxsU3RhcnQgb2YgdGhlIGNvbXBvbmVudCwgYW5kXG4gICAgLy8gd3JvdGUgYmFjayB0byB0aGUgbG9jYWxTdG9yYWdlIHdoZW5ldmVyIHRoZSBzdGF0ZSBjaGFuZ2VzLlxuICAgIGxvY2FsU3RvcmFnZTogc3RyaW5nW10gPSBbXTtcbiAgICAvKipcbiAgICAgKiBPd2wgaG9vayBjYWxsZWQgZXhhY3RseSBvbmNlIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcuXG4gICAgICovXG4gICAgd2lsbFN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5faW1wb3J0U3RhdGVGcm9tU3RvcmFnZShsb2NhbFN0b3JhZ2UsIHRoaXMubG9jYWxTdG9yYWdlKTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSB1c2VTdGF0ZSh0aGlzLnN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIud2lsbFN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IHRoZSBPd2wgc3RhdGUgb2JzZXJ2ZXIgZXZlcnkgdGltZSB0aGUgc3RhdGUgY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmb3JjZSBzZWUgT3dsIENvbXBvbmVudFxuICAgICAqL1xuICAgIHJlbmRlcihmb3JjZSA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLl9leHBvcnRTdGF0ZVRvU3RvcmFnZShsb2NhbFN0b3JhZ2UsIHRoaXMubG9jYWxTdG9yYWdlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIucmVuZGVyKGZvcmNlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJlYWQgdGhlIGdpdmVuIHN0b3JhYmxlIHN0YXRlIGl0ZW1zIGZyb20gdGhlIGdpdmVuIGBzdG9yYWdlYCBhbmQgd3JpdGVcbiAgICAgKiB0aGUgaXRlbXMgYXMgdGhlIGtleSBvZiB0aGUgYHN0YXRlYCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdG9yYWdlIGZyb20gd2hpY2ggdG8gcmVhZCB0aGUgc3RhdGUgaXRlbXNcbiAgICAgKiBAcGFyYW0gc3RvcmFibGVJdGVtcyBuYW1lcyBvZiB0aGUgc3RhdGUgaXRlbXMgdG8gcmVhZCBmcm9tIHN0b3JhZ2VcbiAgICAgKi9cbiAgICBfaW1wb3J0U3RhdGVGcm9tU3RvcmFnZShzdG9yYWdlOiBTdG9yYWdlLCBzdG9yYWJsZUl0ZW1zOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBzdG9yYWJsZUl0ZW1zLmZvckVhY2goaXRlbU5hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IHRoaXMuX3N0b3JhZ2VLZXlQcmVmaXggKyBpdGVtTmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gc3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpO1xuXG4gICAgICAgICAgICAvLyBUaGUgdmFsdWUgb2YgaXRlbXMgdGhhdCB3ZXJlIG5vdCB5ZXQgc2V0IGluIHN0b3JhZ2UgaXMgbnVsbC5cbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgdGhlIHZhbHVlIHdhcyBzdG9yZWQgYXMgYSBzdHJpbmcgaW4gdGhlIHN0b3JhZ2UuXG4gICAgICAgICAgICAgICAgLy8gQ29udmVydCBpdCB0byB0aGUgdHlwZSBvZiB0aGUgZGVmYXVsdCB2YWx1ZSBmb3IgdGhlIHN0YXRlLlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVbaXRlbU5hbWVdID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZWQgaXRlbSBpcyBub3QgcGFyc2VhYmxlLiBLZWVwIHRoZSBkZWZhdWx0IHZhbHVlLlxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgICAgICBgU3RvcmFnZTogSWdub3Jpbmcgc3RhdGUuJHtpdGVtTmFtZX0gc3RvcmVkIHZhbHVlLlxcbmAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke2UubmFtZX06ICR7ZS5tZXNzYWdlfVxcbmAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBTdG9yZWQgdmFsdWU6ICR7dmFsdWV9YCxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvciBldmVyeSBrZXkgaW4gdGhlIHByb3BlcnR5IGBzdGF0ZWAsIHdyaXRlIGl0IGJhY2sgdG8gYHN0b3JhZ2VgXG4gICAgICogV3JpdGUgdGhlIGdpdmVuIHN0b3JhYmxlIHN0YXRlIGl0ZW1zIHRvIHRoZSBnaXZlbiBzdG9yYWdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHN0b3JhZ2UgdG8gd3JpdGUgdGhlIHN0YXRlIGl0ZW1zIHRvXG4gICAgICogQHBhcmFtIHN0b3JhYmxlSXRlbXMgbmFtZXMgb2YgdGhlIHN0YXRlIGl0ZW1zIHRvIHdyaXRlIHRvIHN0b3JhZ2VcbiAgICAgKi9cbiAgICBfZXhwb3J0U3RhdGVUb1N0b3JhZ2Uoc3RvcmFnZTogU3RvcmFnZSwgc3RvcmFibGVJdGVtczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgc3RvcmFibGVJdGVtcy5mb3JFYWNoKGl0ZW1OYW1lID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSB0aGlzLl9zdG9yYWdlS2V5UHJlZml4ICsgaXRlbU5hbWU7XG4gICAgICAgICAgICAvLyBTdG9yYWdlIHJlcXVpcmUgaXRlbXMgdG8gYmUgc3RvcmVkIGFzIHN0cmluZ3MuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuc3RhdGVbaXRlbU5hbWVdKTtcbiAgICAgICAgICAgICAgICBzdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgc2VyaWFsaXplZFZhbHVlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBTdGF0ZSBpdGVtIGlzIG5vdCBzZXJpYWxpemFibGUuIFNraXAgc3RvcmluZyBpdC5cbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgIGBTdG9yYWdlOiBVbnNlcmlhbGl6YWJsZSBzdGF0ZS4ke2l0ZW1OYW1lfSB2YWx1ZS5cXG5gICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGAke2UubmFtZX06ICR7ZS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IE93bE5vZGUgfSBmcm9tICcuL093bE5vZGUnO1xuaW1wb3J0IHsgT3dsIH0gZnJvbSAnLi9Pd2wnO1xuaW1wb3J0IHsgT3dsRW52IH0gZnJvbSAnLi9Pd2xDb21wb25lbnQnO1xuXG5leHBvcnQgY2xhc3MgT3dsRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IE93bE5vZGU7XG4gICAgZW52OiBPd2xFbnY7XG5cbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSkge1xuICAgICAgICBzdXBlcihlbmdpbmUpO1xuICAgICAgICB0aGlzLmVudiA9IHRoaXMuZW5naW5lLmVkaXRvci5wbHVnaW5zLmdldChPd2wpLmVudjtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogT3dsTm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoT3dsKS5jb21wb25lbnRzO1xuICAgICAgICBjb25zdCBvbGRPd2xDb21wb25lbnQgPSBjb21wb25lbnRzLmdldChub2RlKTtcblxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2p3LXBsYWNlaG9sZXInKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwbGFjZWhvbGRlcik7XG4gICAgICAgIG5vZGUucGFyYW1zLkNvbXBvbmVudC5lbnYgPSB0aGlzLmVudjtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gbmV3IG5vZGUucGFyYW1zLkNvbXBvbmVudChudWxsLCBub2RlLnBhcmFtcy5wcm9wcyk7XG4gICAgICAgIGNvbXBvbmVudHMuc2V0KG5vZGUsIGNvbXBvbmVudCk7XG4gICAgICAgIGF3YWl0IGNvbXBvbmVudC5tb3VudChwbGFjZWhvbGRlcik7XG4gICAgICAgIHBsYWNlaG9sZGVyLnJlbW92ZSgpO1xuXG4gICAgICAgIGNvbnN0IGRvbU5vZGVzID0gWy4uLnBsYWNlaG9sZGVyLmNoaWxkTm9kZXNdO1xuXG4gICAgICAgIGlmIChvbGRPd2xDb21wb25lbnQpIHtcbiAgICAgICAgICAgIGlmIChvbGRPd2xDb21wb25lbnQuZWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBvbGRPd2xDb21wb25lbnQuZWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9tTm9kZSwgb2xkT3dsQ29tcG9uZW50LmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbGRPd2xDb21wb25lbnQuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkb206IGRvbU5vZGVzLFxuICAgICAgICB9O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE93bENvbXBvbmVudCB9IGZyb20gJy4vT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGVQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IG1hcmtOb3RWZXJzaW9uYWJsZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3dsTm9kZVBhcmFtcyBleHRlbmRzIEFic3RyYWN0Tm9kZVBhcmFtcyB7XG4gICAgQ29tcG9uZW50OiB0eXBlb2YgT3dsQ29tcG9uZW50O1xuICAgIHByb3BzPzogUmVjb3JkPHN0cmluZywge30+O1xufVxuXG5leHBvcnQgY2xhc3MgT3dsTm9kZSBleHRlbmRzIEF0b21pY05vZGUge1xuICAgIHBhcmFtczogT3dsTm9kZVBhcmFtcztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IE93bE5vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgbWFya05vdFZlcnNpb25hYmxlKHBhcmFtcyk7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLnBhcmFtcy5Db21wb25lbnQubmFtZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBQYXJhZ3JhcGhYbWxEb21QYXJzZXIgfSBmcm9tICcuL1BhcmFncmFwaFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuXG5leHBvcnQgY2xhc3MgUGFyYWdyYXBoPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbUGFyYWdyYXBoWG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgUGFyYWdyYXBoTm9kZSBleHRlbmRzIFZFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoeyBodG1sVGFnOiAnUCcgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUGFyYWdyYXBoTm9kZSB9IGZyb20gJy4vUGFyYWdyYXBoTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFBhcmFncmFwaFhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1AnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxQYXJhZ3JhcGhOb2RlW10+IHtcbiAgICAgICAgY29uc3QgcGFyYWdyYXBoID0gbmV3IFBhcmFncmFwaE5vZGUoKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBwYXJhZ3JhcGgubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHBhcmFncmFwaC5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW3BhcmFncmFwaF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSwgUGFyc2luZ0lkZW50aWZpZXIsIFBhcnNlciwgUGFyc2VyQ29uc3RydWN0b3IgfSBmcm9tICcuL1BhcnNpbmdFbmdpbmUnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RQYXJzZXI8VCA9IHt9PiBpbXBsZW1lbnRzIFBhcnNlcjxUPiB7XG4gICAgc3RhdGljIGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICByZWFkb25seSBwcmVkaWNhdGU/OiAoaXRlbTogVCkgPT4gYm9vbGVhbjtcbiAgICByZWFkb25seSBlbmdpbmU6IFBhcnNpbmdFbmdpbmU8VD47XG4gICAgY29uc3RydWN0b3IoZW5naW5lOiBQYXJzaW5nRW5naW5lPFQ+KSB7XG4gICAgICAgIHRoaXMuZW5naW5lID0gZW5naW5lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZSB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgYWJzdHJhY3QgYXN5bmMgcGFyc2UoaXRlbTogVCk6IFByb21pc2U8Vk5vZGVbXT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWJzdHJhY3RQYXJzZXI8VCA9IHt9PiB7XG4gICAgY29uc3RydWN0b3I6IFBhcnNlckNvbnN0cnVjdG9yPFQ+O1xufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSwgUGFyc2VyQ29uc3RydWN0b3IsIFBhcnNpbmdFbmdpbmVDb25zdHJ1Y3RvciB9IGZyb20gJy4vUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBQYXJzZXI8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGVuZ2luZXM6IFJlY29yZDxzdHJpbmcsIFBhcnNpbmdFbmdpbmU+ID0ge307XG4gICAgcmVhZG9ubHkgbG9hZGVycyA9IHtcbiAgICAgICAgcGFyc2luZ0VuZ2luZXM6IHRoaXMubG9hZFBhcnNpbmdFbmdpbmVzLFxuICAgICAgICBwYXJzZXJzOiB0aGlzLmxvYWRQYXJzZXJzLFxuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShlbmdpbmVJZDogc3RyaW5nLCAuLi5pdGVtcyk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBlbmdpbmUgPSB0aGlzLmVuZ2luZXNbZW5naW5lSWRdO1xuICAgICAgICBpZiAoIWVuZ2luZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBwYXJzaW5nIGVuZ2luZSBmb3IgJHtlbmdpbmVJZH0gaW5zdGFsbGVkLmApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbmdpbmUucGFyc2UoLi4uaXRlbXMpO1xuICAgIH1cblxuICAgIGxvYWRQYXJzaW5nRW5naW5lcyhwYXJzaW5nRW5naW5lczogUGFyc2luZ0VuZ2luZUNvbnN0cnVjdG9yW10pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBFbmdpbmVDbGFzcyBvZiBwYXJzaW5nRW5naW5lcykge1xuICAgICAgICAgICAgY29uc3QgaWQgPSBFbmdpbmVDbGFzcy5pZDtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZ2luZXNbaWRdKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQYXJzaW5nIGVuZ2luZSAke2lkfSBhbHJlYWR5IHJlZ2lzdGVyZWQuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lQ2xhc3ModGhpcy5lZGl0b3IpO1xuICAgICAgICAgICAgdGhpcy5lbmdpbmVzW2lkXSA9IGVuZ2luZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxvYWRQYXJzZXJzKHBhcnNlcnM6IFBhcnNlckNvbnN0cnVjdG9yW10pOiB2b2lkIHtcbiAgICAgICAgcGFyc2VycyA9IFsuLi5wYXJzZXJzXS5yZXZlcnNlKCk7XG4gICAgICAgIGZvciAoY29uc3QgUGFyc2VyQ2xhc3Mgb2YgcGFyc2Vycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLmVuZ2luZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJzaW5nRW5naW5lID0gdGhpcy5lbmdpbmVzW2lkXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFtpZCwgLi4ucGFyc2luZ0VuZ2luZS5jb25zdHJ1Y3Rvci5leHRlbmRzXTtcbiAgICAgICAgICAgICAgICBpZiAoc3VwcG9ydGVkVHlwZXMuaW5jbHVkZXMoUGFyc2VyQ2xhc3MuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNpbmdFbmdpbmUucmVnaXN0ZXIoUGFyc2VyQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCB0eXBlIFBhcnNpbmdJZGVudGlmaWVyID0gc3RyaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnNlcjxUID0ge30+IHtcbiAgICBwcmVkaWNhdGU/OiAoaXRlbTogVCkgPT4gYm9vbGVhbjtcbiAgICBwYXJzZTogKGl0ZW06IFQpID0+IFByb21pc2U8Vk5vZGVbXT47XG4gICAgY29uc3RydWN0b3I6IFBhcnNlckNvbnN0cnVjdG9yPFQ+O1xufVxuZXhwb3J0IHR5cGUgUGFyc2VyQ29uc3RydWN0b3I8VCA9IHt9PiA9IHtcbiAgICBuZXcgKC4uLmFyZ3MpOiBQYXJzZXI8VD47XG4gICAgaWQ6IFBhcnNpbmdJZGVudGlmaWVyO1xufTtcblxuZXhwb3J0IGNsYXNzIFBhcnNpbmdFbmdpbmU8VCA9IHt9PiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZXh0ZW5kczogUGFyc2luZ0lkZW50aWZpZXJbXSA9IFtdO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UGFyc2VyOiBQYXJzZXJDb25zdHJ1Y3RvcjtcbiAgICByZWFkb25seSBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIHJlYWRvbmx5IHBhcnNlcnM6IFBhcnNlcjxUPltdID0gW107XG4gICAgcmVhZG9ubHkgcGFyc2luZ01hcCA9IG5ldyBNYXA8VCwgVk5vZGVbXT4oKTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQYXJzZXIgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0UGFyc2VyKHRoaXMpO1xuICAgICAgICBpZiAoZGVmYXVsdFBhcnNlci5wcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGVmYXVsdCByZW5kZXJlciBjYW5ub3QgaGF2ZSBhIHByZWRpY2F0ZS5gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2Vycy5wdXNoKGRlZmF1bHRQYXJzZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIHRoZSBnaXZlbiBwYXJzZXIgYnkgaW5zdGFudGlhdGluZyBpdCB3aXRoIHRoaXMgcGFyc2VyIGVuZ2luZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBQYXJzZXJDbGFzc1xuICAgICAqL1xuICAgIHJlZ2lzdGVyKFBhcnNlckNsYXNzOiBQYXJzZXJDb25zdHJ1Y3RvcjxUPik6IHZvaWQge1xuICAgICAgICBpZiAoUGFyc2VyQ2xhc3MuaWQgPT09IHRoaXMuY29uc3RydWN0b3IuaWQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2Vycy51bnNoaWZ0KG5ldyBQYXJzZXJDbGFzcyh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFt0aGlzLmNvbnN0cnVjdG9yLmlkLCAuLi50aGlzLmNvbnN0cnVjdG9yLmV4dGVuZHNdO1xuICAgICAgICAgICAgY29uc3QgcHJpb3JQYXJzZXJJZHMgPSBzdXBwb3J0ZWRUeXBlcy5zbGljZSgwLCBzdXBwb3J0ZWRUeXBlcy5pbmRleE9mKFBhcnNlckNsYXNzLmlkKSk7XG4gICAgICAgICAgICBjb25zdCBwb3N0UGFyc2VySW5kZXggPSB0aGlzLnBhcnNlcnMuZmluZEluZGV4KFxuICAgICAgICAgICAgICAgIHBhcnNlciA9PiAhcHJpb3JQYXJzZXJJZHMuaW5jbHVkZXMocGFyc2VyLmNvbnN0cnVjdG9yLmlkKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnBhcnNlcnMuc3BsaWNlKHBvc3RQYXJzZXJJbmRleCwgMCwgbmV3IFBhcnNlckNsYXNzKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZSBpdGVtcyBpbnRvIHRoZSBlZGl0b3IncyB2aXJ0dWFsIGBWTm9kZWAgcmVwcmVzZW50YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbXMgdGhlIGl0ZW1zIHRvIHBhcnNlXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZlZCBieSB0aGUgZWxlbWVudCBwYXJzZWQgaW50byB0aGUgZWRpdG9yIHZpcnR1YWxcbiAgICAgKiBWTm9kZSByZXByZXNlbnRhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKC4uLml0ZW1zOiBUW10pOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgbm9kZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgY29uc3QgY2hpbGRQcm9taXNlcyA9IGl0ZW1zLm1hcChub2RlID0+IHRoaXMuX3BhcnNlSXRlbShub2RlKSk7XG4gICAgICAgIGNvbnN0IHJlc0xpc3QgPSBhd2FpdCBQcm9taXNlLmFsbChjaGlsZFByb21pc2VzKTtcbiAgICAgICAgZm9yIChjb25zdCByZXMgb2YgcmVzTGlzdCkge1xuICAgICAgICAgICAgbm9kZXMucHVzaCguLi5yZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGFuIGl0ZW0gaW50byB0aGUgZWRpdG9yJ3MgdmlydHVhbCByZXByZXNlbnRhdGlvbi5cbiAgICAgKlxuICAgICAqL1xuICAgIGFzeW5jIF9wYXJzZUl0ZW0oaXRlbTogVCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBsZXQgbm9kZXM6IFZOb2RlW107XG4gICAgICAgIGZvciAoY29uc3QgcGFyc2VyIG9mIHRoaXMucGFyc2Vycykge1xuICAgICAgICAgICAgaWYgKCFwYXJzZXIucHJlZGljYXRlIHx8IHBhcnNlci5wcmVkaWNhdGUoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGF3YWl0IHBhcnNlci5wYXJzZShpdGVtKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZXMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2luZ01hcC5zZXQoaXRlbSwgbm9kZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG59XG5leHBvcnQgdHlwZSBQYXJzaW5nRW5naW5lQ29uc3RydWN0b3I8VCA9IHt9PiA9IHtcbiAgICBuZXcgKC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgUGFyc2luZ0VuZ2luZT4pOiBQYXJzaW5nRW5naW5lO1xuICAgIGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICBleHRlbmRzOiBQYXJzaW5nSWRlbnRpZmllcltdO1xuICAgIGRlZmF1bHRQYXJzZXI6IFBhcnNlckNvbnN0cnVjdG9yPFQ+O1xufTtcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2luZ0VuZ2luZTxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogUGFyc2luZ0VuZ2luZUNvbnN0cnVjdG9yO1xufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgUHJlWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9QcmVYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgUHJlRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL1ByZURvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IFByZU5vZGUgfSBmcm9tICcuL1ByZU5vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IFByZUNoYXJEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vUHJlQ2hhckRvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFByZVNlcGFyYXRvckRvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9QcmVTZXBhcmF0b3JEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBQcmU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBhcHBseVByZVN0eWxlOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmFwcGx5UHJlU3R5bGUsXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlciAmIExheW91dD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtQcmVYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtQcmVEb21PYmplY3RSZW5kZXJlciwgUHJlU2VwYXJhdG9yRG9tT2JqZWN0UmVuZGVyZXIsIFByZUNoYXJEb21PYmplY3RSZW5kZXJlcl0sXG4gICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ1ByZUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZU5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3ByZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1ByZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhcHBseVByZVN0eWxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFByZSA9ICEhcmFuZ2Uuc3RhcnQuY2xvc2VzdChQcmVOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0UHJlIHx8IHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0UHJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXJhbmdlLmVuZC5jbG9zZXN0KFByZU5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAncHJlJyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydQcmVCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dXSxcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZSB0aGUgZm9ybWF0dGluZyBvZiB0aGUgbm9kZXMgaW4gZ2l2ZW4gcmFuZ2UgdG8gUHJlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFwcGx5UHJlU3R5bGUocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKENvbnRhaW5lck5vZGUpKSB7XG4gICAgICAgICAgICBjb25zdCBwcmUgPSBuZXcgUHJlTm9kZSgpO1xuICAgICAgICAgICAgcHJlLm1vZGlmaWVycyA9IG5vZGUubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgICAgICBub2RlLnJlcGxhY2VXaXRoKHByZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQcmVOb2RlIH0gZnJvbSAnLi9QcmVOb2RlJztcbmltcG9ydCB7IFZOb2RlLCBQcmVkaWNhdGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tY2hhci9zcmMvQ2hhck5vZGUnO1xuaW1wb3J0IHsgQ2hhckRvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWNoYXIvc3JjL0NoYXJEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBEb21PYmplY3QgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lV29ya2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5cbmV4cG9ydCBjbGFzcyBQcmVDaGFyRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBDaGFyRG9tT2JqZWN0UmVuZGVyZXIge1xuICAgIHByZWRpY2F0ZTogUHJlZGljYXRlID0gKGl0ZW06IFZOb2RlKTogYm9vbGVhbiA9PlxuICAgICAgICBpdGVtIGluc3RhbmNlb2YgQ2hhck5vZGUgJiYgISFpdGVtLmFuY2VzdG9yKFByZU5vZGUpO1xuXG4gICAgYXN5bmMgcmVuZGVyKGNoYXJOb2RlOiBDaGFyTm9kZSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0Pik6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IGF3YWl0IHN1cGVyLnJlbmRlcihjaGFyTm9kZSwgd29ya2VyKTtcbiAgICAgICAgdGhpcy5fcmVuZGVySW5QcmUoW2RvbU9iamVjdF0pO1xuICAgICAgICByZXR1cm4gZG9tT2JqZWN0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIENoYXJOb2RlIGFuZCBjb252ZXJ0IHVuYnJlYWthYmxlIHNwYWNlcyBpbnRvIG5vcm1hbCBzcGFjZXMuXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyQmF0Y2goXG4gICAgICAgIGNoYXJOb2RlczogQ2hhck5vZGVbXSxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBQcm9taXNlPERvbU9iamVjdFtdPiB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdHMgPSBhd2FpdCBzdXBlci5yZW5kZXJCYXRjaChjaGFyTm9kZXMsIHdvcmtlcik7XG4gICAgICAgIHRoaXMuX3JlbmRlckluUHJlKGRvbU9iamVjdHMpO1xuICAgICAgICByZXR1cm4gZG9tT2JqZWN0cztcbiAgICB9XG4gICAgcHJpdmF0ZSBfcmVuZGVySW5QcmUoZG9tT2JqZWN0czogRG9tT2JqZWN0W10pOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBbLi4uZG9tT2JqZWN0c107XG4gICAgICAgIGZvciAoY29uc3QgZG9tT2JqZWN0IG9mIHN0YWNrKSB7XG4gICAgICAgICAgICBpZiAoJ3RleHQnIGluIGRvbU9iamVjdCkge1xuICAgICAgICAgICAgICAgIGRvbU9iamVjdC50ZXh0ID0gZG9tT2JqZWN0LnRleHRcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKVxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx1MjAwMy9nLCAnXFx1MDAwOScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCdjaGlsZHJlbicgaW4gZG9tT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBkb21PYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7XG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBQcmVOb2RlIH0gZnJvbSAnLi9QcmVOb2RlJztcblxuZXhwb3J0IGNsYXNzIFByZURvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBQcmVOb2RlO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSB0byB0aGUgZ2l2ZW4gZm9ybWF0LlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBQcmVOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgcHJlOiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdQUkUnLFxuICAgICAgICAgICAgY2hpbGRyZW46IGF3YWl0IHRoaXMuZW5naW5lLnJlbmRlckNoaWxkcmVuKG5vZGUpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcHJlO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBQcmVOb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7fVxuIiwiaW1wb3J0IHsgUHJlTm9kZSB9IGZyb20gJy4vUHJlTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0RnJhZ21lbnQsXG4gICAgRG9tT2JqZWN0RWxlbWVudCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuZXhwb3J0IGNsYXNzIFByZVNlcGFyYXRvckRvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBWTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICBjb25zdCBEZWZhdWx0U2VwYXJhdG9yID0gdGhpcy5lbmdpbmUuZWRpdG9yLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMuU2VwYXJhdG9yO1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIERlZmF1bHRTZXBhcmF0b3IgJiYgISFpdGVtLmFuY2VzdG9yKFByZU5vZGUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIFZOb2RlLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBWTm9kZSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0Pik6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IChhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlLCB3b3JrZXIpKSBhc1xuICAgICAgICAgICAgfCBEb21PYmplY3RFbGVtZW50XG4gICAgICAgICAgICB8IERvbU9iamVjdEZyYWdtZW50O1xuICAgICAgICBsZXQgcmVuZGVyaW5nOiBEb21PYmplY3Q7XG4gICAgICAgIGlmICgndGFnJyBpbiBzZXBhcmF0b3IpIHtcbiAgICAgICAgICAgIHJlbmRlcmluZyA9IHsgdGV4dDogJ1xcbicgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlbmRlcmluZyA9IHsgdGV4dDogJ1xcblxcbicgfTtcbiAgICAgICAgICAgIHdvcmtlci5sb2NhdGUoW25vZGUsIG5vZGVdLCByZW5kZXJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW5kZXJpbmc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUHJlTm9kZSB9IGZyb20gJy4vUHJlTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFByZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1BSRSc7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFByZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCBwcmUgPSBuZXcgUHJlTm9kZSgpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHByZS5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgcHJlLmFwcGVuZCguLi5jaGlsZHJlbik7XG4gICAgICAgIHJldHVybiBbcHJlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNb2RpZmllclJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Nb2RpZmllclJlbmRlcmVyJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLCBEb21PYmplY3QgfSBmcm9tICcuL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0RG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlciBleHRlbmRzIE1vZGlmaWVyUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gJ2RvbS9vYmplY3QnO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCByZW5kZXJpbmcgZm9yIE1vZGlmaWVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICogQHBhcmFtIGNvbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKG1vZGlmaWVyOiBNb2RpZmllciwgY29udGVudHM6IERvbU9iamVjdFtdKTogUHJvbWlzZTxEb21PYmplY3RbXT4ge1xuICAgICAgICByZXR1cm4gY29udGVudHM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgRnJhZ21lbnROb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0ZyYWdtZW50Tm9kZSc7XG5pbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5pbXBvcnQgeyBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsIERvbU9iamVjdCB9IGZyb20gJy4vRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0RG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gJ2RvbS9vYmplY3QnO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IFZOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgbGV0IGRvbU9iamVjdDogRG9tT2JqZWN0O1xuICAgICAgICBpZiAobm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBWRWxlbWVudCAmJiBub2RlLmh0bWxUYWdbMF0gIT09ICcjJykge1xuICAgICAgICAgICAgICAgIGRvbU9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBub2RlLmh0bWxUYWcsXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBhd2FpdCB0aGlzLmVuZ2luZS5yZW5kZXJDaGlsZHJlbihub2RlKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlIGluc3RhbmNlb2YgRnJhZ21lbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgZG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogYXdhaXQgdGhpcy5lbmdpbmUucmVuZGVyQ2hpbGRyZW4obm9kZSksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZSBpbnN0YW5jZW9mIEF0b21pY05vZGUpIHtcbiAgICAgICAgICAgICAgICBkb21PYmplY3QgPSB7IGNoaWxkcmVuOiBbXSB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb21PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRhZzogbm9kZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogbm9kZS5pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogYXdhaXQgdGhpcy5lbmdpbmUucmVuZGVyQ2hpbGRyZW4obm9kZSksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbU9iamVjdCA9IHsgY2hpbGRyZW46IFtdIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IFhtbCB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbCc7XG5pbXBvcnQgeyBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBGb3JtYXREb21PYmplY3RNb2RpZmllclJlbmRlcmVyIH0gZnJvbSAnLi9Gb3JtYXREb21PYmplY3RNb2RpZmllclJlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIERvbU9iamVjdFJlbmRlcmVyPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW1BhcnNlciwgUmVuZGVyZXIsIFhtbF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICByZW5kZXJpbmdFbmdpbmVzOiBbRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbRm9ybWF0RG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZSwgUmVuZGVyaW5nSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IERlZmF1bHREb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vRGVmYXVsdERvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IERlZmF1bHREb21PYmplY3RNb2RpZmllclJlbmRlcmVyIH0gZnJvbSAnLi9EZWZhdWx0RG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgUnVsZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kZSc7XG5pbXBvcnQge1xuICAgIFJlbmRlcmluZ0VuZ2luZVdvcmtlcixcbiAgICBSZW5kZXJpbmdFbmdpbmVDYWNoZSxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5cbi8qKlxuICogUmVuZGVyZXIgYSBub2RlIGNhbiBkZWZpbmUgdGhlIGxvY2F0aW9uIHdoZW4gZGVmaW5lIHRoZSBub2RlcyBhdHRyaWJ1dGVzLlxuICpcbiAqIE9iamVjdCA9IHtcbiAqICB0YWc6ICdESVYnLFxuICogIGNoaWxkcmVuOiBbXG4gKiAgICB7IHRhZzogJ0EnIH0sXG4gKiAgICB7IHRhZzogJ0InIH0sXG4gKiAgICB7IHRhZzogJ0MnIH0sXG4gKiAgXSxcbiAqIH07XG4gKiBXaGljaCByZW5kZXJzOiA8ZGl2PjxhLz48Yi8+PGMvPjwvZGl2PlxuICpcbiAqIEluIHRoaXMgY2FzZSwgdGhlIGxvY2F0aW9uIEJFRk9SRSBjb21lIGZyb206XG4gKiAgICAgIHw8ZGl2PjxhLz48Yi8+PGMvPjwvZGl2PlxuICogSWYgbm90IGNvbnRhaW5lcjpcbiAqICAgICAgPGRpdj5bPGEvPl08Yi8+PGMvPjwvZGl2PlxuICogICAgICA8ZGl2PjxhLz5bPGIvPl08Yy8+PC9kaXY+XG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gSU5TSURFIGNvbWUgZnJvbSAoaWYgY29udGFpbmVyKTpcbiAqICAgICAgPGRpdj5bPGEvPl08Yi8+PGMvPjwvZGl2PlxuICogICAgICA8ZGl2PjxhLz5bPGIvPl08Yy8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz5bPGMvPl08L2Rpdj5cbiAqXG4gKiBJbiB0aGlzIGNhc2UsIHRoZSBsb2NhdGlvbiBBRlRFUiBjb21lIGZyb206XG4gKiAgICAgIDxkaXY+PGEvPjxiLz48Yy8+PC9kaXY+fFxuICogSWYgbm90IGNvbnRhaW5lcjpcbiAqICAgICAgPGRpdj48YS8+PGIvPls8Yy8+XTwvZGl2PlxuICogICAgICA8ZGl2PjxhLz48Yi8+PGMvPnw8L2Rpdj5cbiAqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKlxuICogT2JqZWN0ID0ge1xuICogIHRhZzogJ0RJVicsXG4gKiAgY2hpbGRyZW46IFtcbiAqICAgIHsgdGFnOiAnQScgfSxcbiAqICAgIHsgdGFnOiAnQicgfSxcbiAqICAgIHsgdGFnOiAnQycgfSxcbiAqICAgIHsgdGFnOiAnRCcgfSxcbiAqICBdLFxuICogfTtcbiAqIFdoaWNoIHJlbmRlcnM6IDxkaXY+PGEvPjxiLz48Yy8+PGQvPjwvZGl2PlxuICpcbiAqIEluIHRoaXMgY2FzZSwgdGhlIGxvY2F0aW9uIEJFRk9SRSBjb21lIGZyb206XG4gKiAgICAgIHw8ZGl2PjxhLz48Yi8+PGMvPjxkLz48L2Rpdj5cbiAqIElmIG5vdCBjb250YWluZXI6XG4gKiAgICAgIDxkaXY+WzxhLz5dPGIvPjxjLz48ZC8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPls8Yi8+XTxjLz48ZC8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz5bPGMvPl08ZC8+PC9kaXY+XG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gSU5TSURFIGNvbWUgZnJvbSAoaWYgY29udGFpbmVyKTpcbiAqICAgICAgPGRpdj5bPGEvPl08Yi8+PGMvPjxkLz48L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+WzxiLz5dPGMvPjxkLz48L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPls8Yy8+XTxkLz48L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz5bPGQvPl08L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz48ZC8+fDwvZGl2PlxuICpcbiAqIEluIHRoaXMgY2FzZSwgdGhlIGxvY2F0aW9uIEFGVEVSIGNvbWUgZnJvbTpcbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz48ZC8+PC9kaXY+fFxuICogSWYgbm90IGNvbnRhaW5lcjpcbiAqICAgICAgPGRpdj48YS8+PGIvPls8Yy8+XTxkLz48L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz5bPGQvPl08L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz48ZC8+fDwvZGl2PlxuICpcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBPYmplY3QgPSB7XG4gKiAgdGFnOiAnRElWJyxcbiAqICBjaGlsZHJlbjogW1xuICogICAgeyB0YWc6ICdBJyB9LFxuICogICAgeyB0YWc6ICdCJyB9LFxuICogICAgeyB0YWc6ICdDJyB9LFxuICogIF0sXG4gKiB9O1xuICogV2hpY2ggcmVuZGVyczogPGRpdj48YS8+PGIvPjxjLz48L2Rpdj5cbiAqXG4gKiBXaXRoIHRoZSBmb2xsb3dpbmcgYGxvY2F0ZWBjYWxsOlxuICogdGhpcy5lbmdpbmUubG9jYXRlKFtub2RlXSwgT2JqZWN0LmNoaWxkcmVuWzBdKVxuICpcbiAqIEluIHRoaXMgY2FzZSwgdGhlIGxvY2F0aW9uIEJFRk9SRSBjb21lIGZyb206XG4gKiAgICAgIHw8ZGl2PjxhLz48Yi8+PGMvPjwvZGl2PlxuICogICAgICA8ZGl2Pls8YS8+XTxiLz48Yy8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz48Yy8+PC9kaXY+XG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gQUZURVIgY29tZSBmcm9tOlxuICogICAgICA8ZGl2PjxhLz5bPGIvPl08Yy8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz5bPGMvPl08L2Rpdj5cbiAqICAgICAgPGRpdj48YS8+PGIvPjxjLz58PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz48Yy8+PC9kaXY+fFxuICpcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBPYmplY3QgPSB7XG4gKiAgdGFnOiAnRElWJyxcbiAqICBjaGlsZHJlbjogW1xuICogICAgeyB0YWc6ICdBJyB9LFxuICogICAgeyB0YWc6ICdCJyB9LFxuICogICAgeyB0YWc6ICdDJyB9LFxuICogIF0sXG4gKiB9O1xuICogV2hpY2ggcmVuZGVyczogPGRpdj48YS8+PGIvPjxjLz48L2Rpdj5cbiAqXG4gKiBXaXRoIHRoZSBmb2xsb3dpbmcgYGxvY2F0ZWBjYWxsczpcbiAqIHRoaXMuZW5naW5lLmxvY2F0ZShbbm9kZV0sIE9iamVjdC5jaGlsZHJlblswXSlcbiAqIHRoaXMuZW5naW5lLmxvY2F0ZShbbm9kZV0sIE9iamVjdC5jaGlsZHJlblsxXSlcbiAqXG4gKiBJbiB0aGlzIGNhc2UsIHRoZSBsb2NhdGlvbiBCRUZPUkUgY29tZSBmcm9tOlxuICogICAgICB8PGRpdj48YS8+PGIvPjxjLz48L2Rpdj5cbiAqICAgICAgPGRpdj5bPGEvPl08Yi8+PGMvPjwvZGl2PlxuICogICAgICA8ZGl2PjxhLz48Yi8+WzxjLz5dPC9kaXY+XG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gQUZURVIgY29tZSBmcm9tOlxuICogICAgICA8ZGl2PjxhLz5bPGIvPl08Yy8+PC9kaXY+XG4gKiAgICAgIDxkaXY+PGEvPjxiLz48Yy8+fDwvZGl2PlxuICogICAgICA8ZGl2PjxhLz48Yi8+PGMvPjwvZGl2PnxcbiAqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKlxuICogT2JqZWN0ID0ge1xuICogIGNoaWxkcmVuOiBbXG4gKiAgICB7IHRleHROb2RlOiAnQScgfSxcbiAqICAgIHsgdGFnOiAnQicgfSxcbiAqICAgIHsgdGV4dE5vZGU6ICdDJyB9LFxuICogIF0sXG4gKiB9O1xuICogV2hpY2ggcmVuZGVyczogYTxiLz5iXG4gKlxuICogV2l0aCB0aGUgZm9sbG93aW5nIGBsb2NhdGVgY2FsbHM6XG4gKiB0aGlzLmVuZ2luZS5sb2NhdGUoW25vZGVdLCBPYmplY3QuY2hpbGRyZW5bMF0pXG4gKiB0aGlzLmVuZ2luZS5sb2NhdGUoW25vZGVdLCBPYmplY3QuY2hpbGRyZW5bMV0pXG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gQkVGT1JFIGNvbWUgZnJvbTpcbiAqICAgICAgfGE8Yi8+YlxuICogICAgICBhWzxiLz5dYlxuICogICAgICBhPGIvPnxiXG4gKlxuICogSW4gdGhpcyBjYXNlLCB0aGUgbG9jYXRpb24gQUZURVIgY29tZSBmcm9tOlxuICogICAgICBhfDxiLz5iXG4gKiAgICAgIGE8Yi8+YnxcbiAqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKlxuICogT2JqZWN0ID0ge1xuICogIGNoaWxkcmVuOiBbXG4gKiAgICB7IHRhZzogJ0EnIH0sXG4gKiAgICB7XG4gKiAgICAgIHRhZzogJ0InLFxuICogICAgICBjaGlsZHJlbjogW1xuICogICAgICAgICAgeyB0YWc6ICdCMicgfSxcbiAqICAgICAgICAgIHsgdGFnOiAnQjMnIH0sXG4gKiAgICAgIF0sXG4gKiAgICB9LFxuICogICAgeyB0YWc6ICdDJyB9LFxuICogIF0sXG4gKiB9O1xuICogV2hpY2ggcmVuZGVyczogPGEvPjxiPjxiMi8+PGIzLz48L2I+PGMvPlxuICpcbiAqIFdpdGggdGhlIGZvbGxvd2luZyBgbG9jYXRlYGNhbGw6XG4gKiB0aGlzLmVuZ2luZS5sb2NhdGUoW25vZGVdLCBPYmplY3QuY2hpbGRyZW5bMl0pXG4gKlxuICogSW4gdGhpcyBjYXNlIDxhLz48Yj5bPGIyLz5dPGIzLz4vYj48Yy8+IGlzIEJFRk9SRVxuICpcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBPYmplY3QgPSB7XG4gKiAgY2hpbGRyZW46IFtcbiAqICAgIHsgdGFnOiAnQScgfSxcbiAqICAgIHsgdGFnOiAnQicgfSxcbiAqICAgIHsgdGFnOiAnQycgfSxcbiAqICBdLFxuICogfTtcbiAqIFdoaWNoIHJlbmRlcnM6IDxhLz48L2I+PGMvPlxuICpcbiAqIFdpdGggdGhlIGZvbGxvd2luZyBgbG9jYXRlYGNhbGxzOlxuICogdGhpcy5lbmdpbmUubG9jYXRlKFtub2RlMSwgbm9kZTJdLCBPYmplY3QpXG4gKlxuICogSW4gdGhpcyBjYXNlIDxhLz48L2I+WzxjLz5dIGlzIEFGVEVSIG5vZGUyXG4gKiBJbiB0aGlzIGNhc2UgPGEvPls8L2I+XTxjLz4gaXMgQkVGT1JFIG5vZGUyXG4gKiBJbiB0aGlzIGNhc2UgWzxhLz5dPC9iPjxjLz4gaXMgQkVGT1JFIG5vZGUxXG4gKlxuICovXG5cbmV4cG9ydCB0eXBlIERvbU9iamVjdEF0dHJpYnV0ZXMgPSBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBTZXQ8c3RyaW5nPiB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz4+ICYge1xuICAgIGNsYXNzPzogU2V0PHN0cmluZz47XG4gICAgc3R5bGU/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufTtcbmV4cG9ydCB0eXBlIERvbU9iamVjdEVsZW1lbnQgPSB7XG4gICAgdGFnOiBzdHJpbmc7XG4gICAgYXR0cmlidXRlcz86IERvbU9iamVjdEF0dHJpYnV0ZXM7XG4gICAgY2hpbGRyZW4/OiBBcnJheTxEb21PYmplY3QgfCBWTm9kZT47XG4gICAgYXR0YWNoPzogKGRvbU5vZGU6IEVsZW1lbnQpID0+IHZvaWQ7XG4gICAgZGV0YWNoPzogKGRvbU5vZGU6IEVsZW1lbnQpID0+IHZvaWQ7XG4gICAgc2hhZG93Um9vdD86IGJvb2xlYW47XG59O1xuZXhwb3J0IHR5cGUgRG9tT2JqZWN0RnJhZ21lbnQgPSB7XG4gICAgY2hpbGRyZW46IEFycmF5PERvbU9iamVjdCB8IFZOb2RlPjtcbiAgICBhdHRhY2g/OiAoLi4uZG9tTm9kZXM6IE5vZGVbXSkgPT4gdm9pZDtcbiAgICBkZXRhY2g/OiAoLi4uZG9tTm9kZXM6IE5vZGVbXSkgPT4gdm9pZDtcbn07XG5leHBvcnQgdHlwZSBEb21PYmplY3RUZXh0ID0ge1xuICAgIHRleHQ6IHN0cmluZztcbiAgICBhdHRhY2g/OiAoLi4udGV4dHM6IFRleHRbXSkgPT4gdm9pZDtcbiAgICBkZXRhY2g/OiAoLi4udGV4dHM6IFRleHRbXSkgPT4gdm9pZDtcbn07XG5leHBvcnQgdHlwZSBEb21PYmplY3ROYXRpdmUgPSB7XG4gICAgZG9tOiBOb2RlW107XG4gICAgYXR0YWNoPzogKC4uLmRvbU5vZGVzOiBOb2RlW10pID0+IHZvaWQ7XG4gICAgZGV0YWNoPzogKC4uLmRvbU5vZGVzOiBOb2RlW10pID0+IHZvaWQ7XG59O1xuZXhwb3J0IHR5cGUgRG9tT2JqZWN0ID0gRG9tT2JqZWN0RWxlbWVudCB8IERvbU9iamVjdEZyYWdtZW50IHwgRG9tT2JqZWN0VGV4dCB8IERvbU9iamVjdE5hdGl2ZTtcblxudHlwZSBSZW5kZXJpbmdCYXRjaFVuaXQgPSBbVk5vZGUsIE1vZGlmaWVyW10sIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+XTtcblxuZXhwb3J0IGNsYXNzIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSBleHRlbmRzIFJlbmRlcmluZ0VuZ2luZTxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgaWQ6IFJlbmRlcmluZ0lkZW50aWZpZXIgPSAnZG9tL29iamVjdCc7XG4gICAgc3RhdGljIHJlYWRvbmx5IGRlZmF1bHRSZW5kZXJlciA9IERlZmF1bHREb21PYmplY3RSZW5kZXJlcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdE1vZGlmaWVyUmVuZGVyZXIgPSBEZWZhdWx0RG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlcjtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgYXR0cmlidXRlcyBvZiB0aGUgZ2l2ZW4gVk5vZGUgb250byB0aGUgZ2l2ZW4gRE9NIEVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gQ2xhc3NcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICovXG4gICAgcmVuZGVyQXR0cmlidXRlczxUIGV4dGVuZHMgdHlwZW9mIEF0dHJpYnV0ZXM+KFxuICAgICAgICBDbGFzczogVCxcbiAgICAgICAgbm9kZTogVk5vZGUsXG4gICAgICAgIGl0ZW06IERvbU9iamVjdCxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiB2b2lkIHtcbiAgICAgICAgaWYgKCd0YWcnIGluIGl0ZW0pIHtcbiAgICAgICAgICAgIGlmICghaXRlbS5hdHRyaWJ1dGVzKSBpdGVtLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBub2RlLm1vZGlmaWVycy5maW5kKENsYXNzKTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0ciA9IGl0ZW0uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgYXR0cmlidXRlcy5rZXlzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXR0ci5jbGFzcykgYXR0ci5jbGFzcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIG9mIGF0dHJpYnV0ZXMuY2xhc3NMaXN0Lml0ZW1zKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyLmNsYXNzLmFkZChjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIuc3R5bGUgPSBPYmplY3QuYXNzaWduKHt9LCBhdHRyaWJ1dGVzLnN0eWxlLnRvSlNPTigpLCBhdHRyLnN0eWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJbbmFtZV0gPSBhdHRyaWJ1dGVzLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3b3JrZXIuZGVwZW5kcyhpdGVtLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAb3ZlcndyaXRlXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyQ2hpbGRyZW4obm9kZTogVk5vZGUpOiBQcm9taXNlPEFycmF5PERvbU9iamVjdCB8IFZOb2RlPj4ge1xuICAgICAgICBjb25zdCBjaGlsZHJlbjogQXJyYXk8RG9tT2JqZWN0IHwgVk5vZGU+ID0gbm9kZS5jaGlsZHJlbigpO1xuICAgICAgICBpZiAoIWNoaWxkcmVuLmxlbmd0aCAmJiB0aGlzLmVkaXRvci5tb2RlLmlzKG5vZGUsIFJ1bGVQcm9wZXJ0eS5BTExPV19FTVBUWSkgIT09IHRydWUpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goeyB0YWc6ICdCUicgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgYSBwbGFjZWhvbGRlciBmb3IgdGhlIGdpdmVuIGNoaWxkIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2hpbGRcbiAgICAgKi9cbiAgICByZW5kZXJQbGFjZWhvbGRlcihjaGlsZDogVk5vZGUpOiBOb2RlIHtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdqdy1kb21vYmplY3Qtdm5vZGUnKTtcbiAgICAgICAgcGxhY2Vob2xkZXIuaWQgPSBjaGlsZC5pZC50b1N0cmluZygpO1xuICAgICAgICByZXR1cm4gcGxhY2Vob2xkZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnQgZXZlcnkgVk5vZGUgY2hpbGRyZW4gaW50byBkb21PYmplY3RzXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9tT2JqZWN0XG4gICAgICovXG4gICAgYXN5bmMgcmVzb2x2ZUNoaWxkcmVuKFxuICAgICAgICBkb21PYmplY3Q6IERvbU9iamVjdCxcbiAgICAgICAgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8RG9tT2JqZWN0PixcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBbZG9tT2JqZWN0XTtcbiAgICAgICAgZm9yIChjb25zdCBkb21PYmplY3Qgb2Ygc3RhY2spIHtcbiAgICAgICAgICAgIGlmICgnY2hpbGRyZW4nIGluIGRvbU9iamVjdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuOiBEb21PYmplY3RbXSA9IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBkb21PYmplY3QuY2hpbGRyZW4uZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICBjaGlsZCA9PiBjaGlsZCBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSxcbiAgICAgICAgICAgICAgICApIGFzIFZOb2RlW107XG4gICAgICAgICAgICAgICAgY29uc3QgZG9tT2JqZWN0cyA9IGF3YWl0IHdvcmtlci5yZW5kZXIoY2hpbGROb2Rlcyk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpbmRleCBpbiBkb21PYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBkb21PYmplY3QuY2hpbGRyZW5baW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2hpbGRPYmplY3Q6IERvbU9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZE9iamVjdCA9IGRvbU9iamVjdHMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkT2JqZWN0ID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFjay5pbmNsdWRlcyhjaGlsZE9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGRPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaChjaGlsZE9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZG9tT2JqZWN0LmNoaWxkcmVuID0gY2hpbGRyZW47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR3JvdXAgdGhlIG5vZGVzIGJ5IHJlbmRlcmVyLCBzaWJsaW5ncyBhbmQgZm9ybWF0LlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgcmVuZGVyQmF0Y2hlZChcbiAgICAgICAgY2FjaGU6IFJlbmRlcmluZ0VuZ2luZUNhY2hlPERvbU9iamVjdD4sXG4gICAgICAgIG5vZGVzOiBWTm9kZVtdLFxuICAgICAgICByZW5kZXJlZD86IE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+LFxuICAgICk6IFByb21pc2U8dm9pZD5bXSB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZ1VuaXRzID0gdGhpcy5fZ2V0UmVuZGVyaW5nVW5pdHMoY2FjaGUsIG5vZGVzLCByZW5kZXJlZCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJCYXRjaGVkKGNhY2hlLCByZW5kZXJpbmdVbml0cyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdyb3VwIHRoZSBub2RlcyBieSBmb3JtYXQgYW5kIGJ5IHJlbmRlcmVyIGFuZCBjYWxsICdyZW5kZXJCYXRjaCcgd2l0aFxuICAgICAqIHRoZSBkaWZmZXJlbnQgZ3JvdXAuIFdyYXAgdGhlIGNyZWF0ZWQgZG9tT2JqZWN0IGludG8gdGhlIGZyb21hdGVkXG4gICAgICogZG9tT2JqZWN0RWxlbWVudCBpZiBuZWVkZWQuXG4gICAgICogUmV0dXJuIGEgbGlzdCBvZiB0aGUgcmVuZGVyZWQgdk5vZGUgYW5kIGxpc3Qgb2YgRG9tT2JqZWN0cy4gVGhlIGluZGljZXNcbiAgICAgKiBvZiB0aGUgRG9tT2JqZWN0IGxpc3QgbWF0Y2ggdGhlIGluZGljZXMgb2YgdGhlIGdpdmVuIG5vZGVzXG4gICAgICogbGlzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZW5kZXJpbmdVbml0c1xuICAgICAqL1xuICAgIHByaXZhdGUgX3JlbmRlckJhdGNoZWQoXG4gICAgICAgIGNhY2hlOiBSZW5kZXJpbmdFbmdpbmVDYWNoZTxEb21PYmplY3Q+LFxuICAgICAgICByZW5kZXJpbmdVbml0czogUmVuZGVyaW5nQmF0Y2hVbml0W10sXG4gICAgKTogUHJvbWlzZTx2b2lkPltdIHtcbiAgICAgICAgY29uc3QgYmF0Y2hQcm9taXNlczogUHJvbWlzZTx2b2lkPltdID0gW107XG4gICAgICAgIGZvciAobGV0IHVuaXRJbmRleCA9IDA7IHVuaXRJbmRleCA8IHJlbmRlcmluZ1VuaXRzLmxlbmd0aDsgdW5pdEluZGV4KyspIHtcbiAgICAgICAgICAgIGxldCBuZXh0VW5pdEluZGV4ID0gdW5pdEluZGV4O1xuICAgICAgICAgICAgY29uc3QgdW5pdCA9IHJlbmRlcmluZ1VuaXRzW3VuaXRJbmRleF07XG4gICAgICAgICAgICBpZiAodW5pdCAmJiB1bml0WzFdLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIEdyb3VwIHNhbWUgZm9ybWF0aW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyID0gdW5pdFsxXVswXTtcbiAgICAgICAgICAgICAgICBsZXQgbGFzdFVuaXQ6IFJlbmRlcmluZ0JhdGNoVW5pdCA9IFt1bml0WzBdLCB1bml0WzFdLnNsaWNlKDEpLCB1bml0WzJdXTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdSZW5kZXJpbmdVbml0czogUmVuZGVyaW5nQmF0Y2hVbml0W10gPSBbbGFzdFVuaXRdO1xuICAgICAgICAgICAgICAgIGxldCBuZXh0VW5pdDogUmVuZGVyaW5nQmF0Y2hVbml0O1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgKG5leHRVbml0ID0gcmVuZGVyaW5nVW5pdHNbbmV4dFVuaXRJbmRleCArIDFdKSAmJlxuICAgICAgICAgICAgICAgICAgICBsYXN0VW5pdFswXS5wYXJlbnQgPT09IG5leHRVbml0WzBdLnBhcmVudCAmJlxuICAgICAgICAgICAgICAgICAgICBuZXh0VW5pdFsxXS5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kaWZpZXJJc1NhbWVBcyhjYWNoZSwgbW9kaWZpZXIsIG5leHRVbml0WzFdPy5bMF0pXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRVbml0SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgbGFzdFVuaXQgPSByZW5kZXJpbmdVbml0c1tuZXh0VW5pdEluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgbmV3UmVuZGVyaW5nVW5pdHMucHVzaChbbGFzdFVuaXRbMF0sIGxhc3RVbml0WzFdLnNsaWNlKDEpLCBsYXN0VW5pdFsyXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgd3JhcHBlZCBub2Rlcy5cbiAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IHRoaXMuX3JlbmRlckJhdGNoZWQoY2FjaGUsIG5ld1JlbmRlcmluZ1VuaXRzKTtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IG5ld1JlbmRlcmluZ1VuaXRzLm1hcCh1ID0+IHVbMF0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyUHJvbWlzZSA9IFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tT2JqZWN0czogRG9tT2JqZWN0W10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21PYmplY3Qgb2Ygbm9kZXMubWFwKG5vZGUgPT4gY2FjaGUucmVuZGVyaW5ncy5nZXQobm9kZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvbU9iamVjdHMuaW5jbHVkZXMoZG9tT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbU9iamVjdHMucHVzaChkb21PYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBmb3JtYXQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyUmVuZGVyZXIgPSB0aGlzLmdldENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyKGNhY2hlLCBtb2RpZmllcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdyYXBzID0gYXdhaXQgbW9kaWZpZXJSZW5kZXJlci5yZW5kZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU9iamVjdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlLndvcmtlcixcbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgb3JpZ2lucy5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB3cmFwIG9mIHdyYXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFjayA9IFt3cmFwXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tT2JqZWN0IG9mIHN0YWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2lucyA9IGNhY2hlLnJlbmRlcmluZ0RlcGVuZGVudC5nZXQoZG9tT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3JpZ2lucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG9yaWdpbiBvZiBvcmlnaW5zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXBlbmRzKGNhY2hlLCBvcmlnaW4sIHdyYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVwZW5kcyhjYWNoZSwgd3JhcCwgb3JpZ2luKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2NoaWxkcmVuJyBpbiBkb21PYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBkb21PYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVwZW5kcyhjYWNoZSwgbW9kaWZpZXIsIHdyYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVwZW5kcyhjYWNoZSwgd3JhcCwgbW9kaWZpZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSByZW5kZXJpbmdzIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd3JhcCA9IHdyYXBzLmZpbmQod3JhcCA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlLnJlbmRlcmluZ0RlcGVuZGVudC5nZXQod3JhcCk/Lmhhcyhub2RlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdzLnNldChub2RlLCB3cmFwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdQcm9taXNlcy5zZXQobm9kZSwgbW9kaWZpZXJQcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYmF0Y2hQcm9taXNlcy5wdXNoKG1vZGlmaWVyUHJvbWlzZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFJlbmRlciBlYWNoIG5vZGUuXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRSZW5kZXJlcjogTm9kZVJlbmRlcmVyPERvbU9iamVjdD47XG4gICAgICAgICAgICAgICAgbGV0IHJlbmRlcmluZ1VuaXQ6IFJlbmRlcmluZ0JhdGNoVW5pdDtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWJsaW5nczogVk5vZGVbXSA9IFtdO1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgKHJlbmRlcmluZ1VuaXQgPSByZW5kZXJpbmdVbml0c1tuZXh0VW5pdEluZGV4XSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKCFjdXJyZW50UmVuZGVyZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICghcmVuZGVyaW5nVW5pdFsxXS5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVuZGVyZXIgPT09IHJlbmRlcmluZ1VuaXRbMl0gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIXNpYmxpbmdzLmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWJsaW5nc1tzaWJsaW5ncy5sZW5ndGggLSAxXS5wYXJlbnQgPT09IHJlbmRlcmluZ1VuaXRbMF0ucGFyZW50KSkpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRVbml0SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgc2libGluZ3MucHVzaChyZW5kZXJpbmdVbml0WzBdKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlbmRlcmVyID0gcmVuZGVyaW5nVW5pdFsyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSZW5kZXJlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2U8dm9pZD4ocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVuZGVyZXIucmVuZGVyQmF0Y2goc2libGluZ3MsIGNhY2hlLndvcmtlcikudGhlbihkb21PYmplY3RzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSB2YWx1ZSwgYWRkIG9yaWdpbnMgYW5kIGxvY2F0aW9ucy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpbmRleCBpbiBzaWJsaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHNpYmxpbmdzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZG9tT2JqZWN0c1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXBlbmRzKGNhY2hlLCBub2RlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXBlbmRzKGNhY2hlLCB2YWx1ZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGREZWZhdWx0TG9jYXRpb24oY2FjaGUsIG5vZGUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlLnJlbmRlcmluZ3Muc2V0KG5vZGUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc2libGluZyBvZiBzaWJsaW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVuZGVyaW5nUHJvbWlzZXMuc2V0KHNpYmxpbmcsIHByb21pc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJhdGNoUHJvbWlzZXMucHVzaChwcm9taXNlKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFVuaXRJbmRleC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVuaXRJbmRleCA9IG5leHRVbml0SW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJhdGNoUHJvbWlzZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXB1dGUgbGlzdCBvZiBub2RlcywgZm9ybWF0IGFuZCByZW5kZXJpbmcuXG4gICAgICogQWRkIHRoZSBzaWJsaW5ncyBub2RlIGludG8gdGhlIGxpc3QgZm9yIGZ1dHVyZSBncm91cGluZyBmb3IgJ3JlbmRlckJhdGNoJ1xuICAgICAqIG1ldGhvZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2Rlc1xuICAgICAqIEBwYXJhbSByZW5kZXJlZFxuICAgICAqL1xuICAgIHByaXZhdGUgX2dldFJlbmRlcmluZ1VuaXRzKFxuICAgICAgICBjYWNoZTogUmVuZGVyaW5nRW5naW5lQ2FjaGU8RG9tT2JqZWN0PixcbiAgICAgICAgbm9kZXM6IFZOb2RlW10sXG4gICAgICAgIHJlbmRlcmVkPzogTm9kZVJlbmRlcmVyPERvbU9iamVjdD4sXG4gICAgKTogUmVuZGVyaW5nQmF0Y2hVbml0W10ge1xuICAgICAgICAvLyBDb25zZWN1dGl2ZSBjaGFyIG5vZGVzIGFyZSByZW5kZXJlZCBpbiBzYW1lIHRpbWUuXG4gICAgICAgIGNvbnN0IHJlbmRlcmluZ1VuaXRzOiBSZW5kZXJpbmdCYXRjaFVuaXRbXSA9IFtdO1xuICAgICAgICBjb25zdCBzZXROb2RlcyA9IG5ldyBTZXQobm9kZXMpOyAvLyBVc2Ugc2V0IGZvciBwZXJmLlxuXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbmV3IFNldDxWTm9kZT4oKTtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWQuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZXJzOiBWTm9kZVtdID0gW107XG4gICAgICAgICAgICAgICAgcGFyZW50LmNoaWxkVk5vZGVzLmZvckVhY2goc2libGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciBhbmQgc29ydCB0aGUgbmRvZXMuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXROb2Rlcy5oYXMoc2libGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaWJsaW5nLnRhbmdpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyaW5nVW5pdHMucHVzaCh0aGlzLl9jcmVhdGVVbml0KGNhY2hlLCBzaWJsaW5nLCByZW5kZXJlZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgdGFuZ2libGUgbm9kZSBhcmUgYWRkIGFmdGVyIG90aGVyIG5vZGVzIChkb24ndCBjdXQgdGV4dCBub2RlKS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goc2libGluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZC5hZGQoc2libGluZyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2libGluZy50YW5naWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyaW5nVW5pdHMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWFya2VyIG9mIG1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyaW5nVW5pdHMucHVzaCh0aGlzLl9jcmVhdGVVbml0KGNhY2hlLCBtYXJrZXIsIHJlbmRlcmVkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW5kZXJpbmdVbml0cy5wdXNoKHRoaXMuX2NyZWF0ZVVuaXQoY2FjaGUsIG5vZGUsIHJlbmRlcmVkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlbmRlcmluZ1VuaXRzO1xuICAgIH1cbiAgICBwcml2YXRlIF9jcmVhdGVVbml0KFxuICAgICAgICBjYWNoZTogUmVuZGVyaW5nRW5naW5lQ2FjaGU8RG9tT2JqZWN0PixcbiAgICAgICAgbm9kZTogVk5vZGUsXG4gICAgICAgIHJlbmRlcmVkPzogTm9kZVJlbmRlcmVyPERvbU9iamVjdD4sXG4gICAgKTogUmVuZGVyaW5nQmF0Y2hVbml0IHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBjYWNoZS53b3JrZXIuZ2V0Q29tcGF0aWJsZVJlbmRlcmVyKG5vZGUsIHJlbmRlcmVkKTtcbiAgICAgICAgLy8gUmVtb3ZlIG1vZGlmaWVyIHdobyByZW5kZXIgbm90aGluZy5cbiAgICAgICAgY29uc3QgbW9kaWZpZXJzID0gbm9kZS5tb2RpZmllcnMuZmlsdGVyKFxuICAgICAgICAgICAgbW9kaWZlciA9PiAhdGhpcy5fbW9kaWZpZXJJc1NhbWVBcyhjYWNoZSwgbW9kaWZlciwgbnVsbCksXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBbbm9kZSwgbW9kaWZpZXJzLCByZW5kZXJlcl07XG4gICAgfVxuICAgIHByb3RlY3RlZCBfYWRkRGVmYXVsdExvY2F0aW9uKFxuICAgICAgICBjYWNoZTogUmVuZGVyaW5nRW5naW5lQ2FjaGU8RG9tT2JqZWN0PixcbiAgICAgICAgbm9kZTogVk5vZGUsXG4gICAgICAgIGRvbU9iamVjdDogRG9tT2JqZWN0LFxuICAgICk6IHZvaWQge1xuICAgICAgICBsZXQgbG9jYXRlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBzdGFjayA9IFtkb21PYmplY3RdO1xuICAgICAgICBmb3IgKGNvbnN0IG9iamVjdCBvZiBzdGFjaykge1xuICAgICAgICAgICAgaWYgKGNhY2hlLmxvY2F0aW9ucy5nZXQob2JqZWN0KSkge1xuICAgICAgICAgICAgICAgIGxvY2F0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCdjaGlsZHJlbicgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBvYmplY3QuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhY2suaW5jbHVkZXMoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb29wIGluIHJlbmRlcmluZyBvYmplY3QuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWxvY2F0ZWQpIHtcbiAgICAgICAgICAgIGNhY2hlLmxvY2F0aW9ucy5zZXQoZG9tT2JqZWN0LCBbbm9kZV0pO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTW9kaWZpZXJSZW5kZXJlcic7XG5pbXBvcnQgeyBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsIERvbU9iamVjdCB9IGZyb20gJy4vRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBGb3JtYXREb21PYmplY3RNb2RpZmllclJlbmRlcmVyIGV4dGVuZHMgTW9kaWZpZXJSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gRm9ybWF0O1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyaW5nIGZvciBGb3JtYXQgTW9kaWZpZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZm9ybWF0XG4gICAgICogQHBhcmFtIGNvbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKGZvcm1hdDogRm9ybWF0LCBjb250ZW50czogRG9tT2JqZWN0W10pOiBQcm9taXNlPERvbU9iamVjdFtdPiB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdDogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiBmb3JtYXQuaHRtbFRhZy50b1VwcGVyQ2FzZSgpLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNvbnRlbnRzLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZm9ybWF0Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICBjb25zdCBrZXlzID0gYXR0cmlidXRlcz8ua2V5cygpO1xuICAgICAgICBpZiAoa2V5cz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICBkb21PYmplY3QuYXR0cmlidXRlcyA9IHt9O1xuXG4gICAgICAgICAgICBjb25zdCBhdHRyID0gZG9tT2JqZWN0LmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2Yga2V5cykge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYXR0ci5jbGFzcykgYXR0ci5jbGFzcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgYXR0cmlidXRlcy5jbGFzc0xpc3QuaXRlbXMoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0ci5jbGFzcy5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgICAgICBhdHRyLnN0eWxlID0gT2JqZWN0LmFzc2lnbih7fSwgYXR0cmlidXRlcy5zdHlsZS50b0pTT04oKSwgYXR0ci5zdHlsZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0cltuYW1lXSA9IGF0dHJpYnV0ZXMuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2RvbU9iamVjdF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUmVuZGVyaW5nSWRlbnRpZmllciB9IGZyb20gJy4vUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4vUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgTW9kaWZpZXJQcmVkaWNhdGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuY2xhc3MgU3VwZXJNb2RpZmllclJlbmRlcmVyPFQ+IHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVuZGVyZXI6IE1vZGlmaWVyUmVuZGVyZXI8VD4pIHt9XG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBnaXZlbiBtb2RpZmllciBhbmQgcmV0dXJuIGEgbGlzdCBvZiBEb21PYmplY3Qgd2l0Y2hcbiAgICAgKiB0aGUgYXBwbGllZCBtb2RpZmllci4gVGhlIGxpc3QgY2FuIGhhdmUgYW4gb3RoZXIgbGVuIG9mIHRoZSBnaXZlblxuICAgICAqIGxpc3Qgb2YgRG9tT2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICogQHBhcmFtIGNvbnRlbnRzXG4gICAgICogQHBhcmFtIGJhdGNoXG4gICAgICovXG4gICAgcmVuZGVyKFxuICAgICAgICBtb2RpZmllcjogTW9kaWZpZXIsXG4gICAgICAgIGNvbnRlbnRzOiBUW10sXG4gICAgICAgIGJhdGNoOiBWTm9kZVtdLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxUPixcbiAgICApOiBQcm9taXNlPFRbXT4ge1xuICAgICAgICBjb25zdCBuZXh0UmVuZGVyZXIgPSB3b3JrZXIuZ2V0Q29tcGF0aWJsZU1vZGlmaWVyUmVuZGVyZXIobW9kaWZpZXIsIHRoaXMucmVuZGVyZXIpO1xuICAgICAgICByZXR1cm4gbmV4dFJlbmRlcmVyPy5yZW5kZXIobW9kaWZpZXIsIGNvbnRlbnRzLCBiYXRjaCwgd29ya2VyKTtcbiAgICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBNb2RpZmllclJlbmRlcmVyPFQ+IHtcbiAgICBzdGF0aWMgaWQ6IFJlbmRlcmluZ0lkZW50aWZpZXI7XG4gICAgcmVhZG9ubHkgcHJlZGljYXRlPzogTW9kaWZpZXJQcmVkaWNhdGU7XG4gICAgcmVhZG9ubHkgZW5naW5lOiBSZW5kZXJpbmdFbmdpbmU8VD47XG4gICAgcmVhZG9ubHkgc3VwZXI6IFN1cGVyTW9kaWZpZXJSZW5kZXJlcjxUPjtcbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IFJlbmRlcmluZ0VuZ2luZTxUPikge1xuICAgICAgICB0aGlzLmVuZ2luZSA9IGVuZ2luZTtcbiAgICAgICAgdGhpcy5zdXBlciA9IG5ldyBTdXBlck1vZGlmaWVyUmVuZGVyZXIodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgZ2l2ZW4gbW9kaWZpZXIgYW5kIHJldHVybiBhIGxpc3Qgb2YgRG9tT2JqZWN0IHdpdGNoXG4gICAgICogdGhlIGFwcGxpZWQgbW9kaWZpZXIuIFRoZSBsaXN0IGNhbiBoYXZlIGFuIG90aGVyIGxlbiBvZiB0aGUgZ2l2ZW5cbiAgICAgKiBsaXN0IG9mIERvbU9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtb2RpZmllclxuICAgICAqIEBwYXJhbSBjb250ZW50c1xuICAgICAqIEBwYXJhbSBiYXRjaFxuICAgICAqL1xuICAgIGFic3RyYWN0IHJlbmRlcihcbiAgICAgICAgbW9kaWZpZXI6IE1vZGlmaWVyLFxuICAgICAgICByZW5kZXJpbmdzOiBUW10sXG4gICAgICAgIGJhdGNoOiBWTm9kZVtdLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxUPixcbiAgICApOiBQcm9taXNlPFRbXT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kaWZpZXJSZW5kZXJlcjxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogTW9kaWZpZXJSZW5kZXJlckNvbnN0cnVjdG9yPFQ+O1xufVxuXG5leHBvcnQgdHlwZSBNb2RpZmllclJlbmRlcmVyQ29uc3RydWN0b3I8VCA9IHt9PiA9IHtcbiAgICBuZXcgKGVuZ2luZTogUmVuZGVyaW5nRW5naW5lPFQ+KTogTW9kaWZpZXJSZW5kZXJlcjxUPjtcbiAgICBpZDogUmVuZGVyaW5nSWRlbnRpZmllcjtcbn07XG4iLCJpbXBvcnQgeyBSZW5kZXJpbmdJZGVudGlmaWVyIH0gZnJvbSAnLi9SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi9SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVk5vZGUsIFByZWRpY2F0ZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuY2xhc3MgU3VwZXJSZW5kZXJlcjxUPiB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHJlbmRlcmVyOiBOb2RlUmVuZGVyZXI8VD4pIHt9XG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBnaXZlbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICByZW5kZXIobm9kZTogVk5vZGUsIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPFQ+KTogUHJvbWlzZTxUPiB7XG4gICAgICAgIGNvbnN0IG5leHRSZW5kZXJlciA9IHdvcmtlci5nZXRDb21wYXRpYmxlUmVuZGVyZXIobm9kZSwgdGhpcy5yZW5kZXJlcik7XG4gICAgICAgIHJldHVybiBuZXh0UmVuZGVyZXI/LnJlbmRlcihub2RlLCB3b3JrZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIGdpdmVuIGdyb3VwIG9mIG5vZGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXJCYXRjaChub2RlczogVk5vZGVbXSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8VD4pOiBQcm9taXNlPFRbXT4ge1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh3b3JrZXIucmVuZGVyQmF0Y2hlZChub2RlcywgdGhpcy5yZW5kZXJlcikpO1xuICAgICAgICByZXR1cm4gbm9kZXMubWFwKG5vZGUgPT4gd29ya2VyLmdldFJlbmRlcmluZyhub2RlKSk7XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgU3VwZXJSZW5kZXJlcjxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogUmVuZGVyZXJDb25zdHJ1Y3RvcjxUPjtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE5vZGVSZW5kZXJlcjxUPiB7XG4gICAgc3RhdGljIGlkOiBSZW5kZXJpbmdJZGVudGlmaWVyO1xuICAgIHJlYWRvbmx5IHByZWRpY2F0ZT86IFByZWRpY2F0ZTtcbiAgICByZWFkb25seSBlbmdpbmU6IFJlbmRlcmluZ0VuZ2luZTxUPjtcbiAgICByZWFkb25seSBzdXBlcjogU3VwZXJSZW5kZXJlcjxUPjtcbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IFJlbmRlcmluZ0VuZ2luZTxUPikge1xuICAgICAgICB0aGlzLmVuZ2luZSA9IGVuZ2luZTtcbiAgICAgICAgdGhpcy5zdXBlciA9IG5ldyBTdXBlclJlbmRlcmVyKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIGdpdmVuIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGFic3RyYWN0IHJlbmRlcihub2RlOiBWTm9kZSwgd29ya2VyOiBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8VD4pOiBQcm9taXNlPFQ+O1xuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgZ2l2ZW4gZ3JvdXAgb2Ygbm9kZXMuXG4gICAgICogVGhlIGluZGljZXMgb2YgdGhlIERvbU9iamVjdCBsaXN0IG1hdGNoIHRoZSBpbmRpY2VzIG9mIHRoZSBnaXZlbiBub2Rlc1xuICAgICAqIGxpc3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIHJlbmRlckJhdGNoKG5vZGVzOiBWTm9kZVtdLCB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxUPik6IFByb21pc2U8VFtdPiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChub2Rlcy5tYXAobm9kZSA9PiB0aGlzLnJlbmRlcihub2RlLCB3b3JrZXIpKSk7XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5vZGVSZW5kZXJlcjxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogUmVuZGVyZXJDb25zdHJ1Y3RvcjxUPjtcbn1cblxuZXhwb3J0IHR5cGUgUmVuZGVyZXJDb25zdHJ1Y3RvcjxUID0ge30+ID0ge1xuICAgIG5ldyAoZW5naW5lOiBSZW5kZXJpbmdFbmdpbmU8VD4pOiBOb2RlUmVuZGVyZXI8VD47XG4gICAgaWQ6IFJlbmRlcmluZ0lkZW50aWZpZXI7XG59O1xuIiwiaW1wb3J0IHsgSldQbHVnaW5Db25maWcsIEpXUGx1Z2luIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHtcbiAgICBSZW5kZXJpbmdJZGVudGlmaWVyLFxuICAgIFJlbmRlcmluZ0VuZ2luZSxcbiAgICBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3Rvcixcbn0gZnJvbSAnLi9SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTW9kaWZpZXJSZW5kZXJlckNvbnN0cnVjdG9yIH0gZnJvbSAnLi9Nb2RpZmllclJlbmRlcmVyJztcbmltcG9ydCB7IFJlbmRlcmVyQ29uc3RydWN0b3IgfSBmcm9tICcuL05vZGVSZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBSZW5kZXJlcjxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgbG9hZGVycyA9IHtcbiAgICAgICAgcmVuZGVyaW5nRW5naW5lczogdGhpcy5sb2FkUmVuZGVyaW5nRW5naW5lcyxcbiAgICAgICAgcmVuZGVyZXJzOiB0aGlzLmxvYWRSZW5kZXJlcnMsXG4gICAgfTtcbiAgICBlbmdpbmVzOiBSZWNvcmQ8UmVuZGVyaW5nSWRlbnRpZmllciwgUmVuZGVyaW5nRW5naW5lPiA9IHt9O1xuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgc3RvcCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5lbmdpbmVzID0ge307XG4gICAgICAgIHJldHVybiBzdXBlci5zdG9wKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSBhbmQgcmV0dXJuIHRoZSByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVuZGVyaW5nSWRcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcjxUPihyZW5kZXJpbmdJZDogc3RyaW5nLCBub2RlOiBWTm9kZSk6IFByb21pc2U8VCB8IHZvaWQ+O1xuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVk5vZGVzIGFuZCByZXR1cm4gYSBsaXN0IG9mIHJlbmRlcmluZ3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVuZGVyaW5nSWRcbiAgICAgKiBAcGFyYW0gbm9kZXNcbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXI8VD4ocmVuZGVyaW5nSWQ6IHN0cmluZywgbm9kZXM6IFZOb2RlW10pOiBQcm9taXNlPFRbXSB8IHZvaWQ+O1xuICAgIGFzeW5jIHJlbmRlcjxUPihyZW5kZXJpbmdJZDogc3RyaW5nLCBub2RlczogVk5vZGUgfCBWTm9kZVtdKTogUHJvbWlzZTxUIHwgVFtdIHwgdm9pZD4ge1xuICAgICAgICBjb25zdCBlbmdpbmUgPSB0aGlzLmVuZ2luZXNbcmVuZGVyaW5nSWRdIGFzIFJlbmRlcmluZ0VuZ2luZTxUPjtcbiAgICAgICAgaWYgKCFlbmdpbmUpIHtcbiAgICAgICAgICAgIC8vIFRoZSBjYWxsZXIgbWlnaHQgd2FudCB0byBmYWxsYmFjayBvbiBhbm90aGVyIHJlbmRlcmluZy5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZXMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCBlbmdpbmUucmVuZGVyKG5vZGVzKTtcbiAgICAgICAgICAgIG5vZGVzLm1hcChub2RlID0+IGNhY2hlLnJlbmRlcmluZ3MuZ2V0KG5vZGUpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgZW5naW5lLnJlbmRlcihbbm9kZXNdKTtcbiAgICAgICAgICAgIHJldHVybiBjYWNoZS5yZW5kZXJpbmdzLmdldChub2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsb2FkUmVuZGVyaW5nRW5naW5lcyhyZW5kZXJpbmdFbmdpbmVzOiBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3RvcltdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgRW5naW5lQ2xhc3Mgb2YgcmVuZGVyaW5nRW5naW5lcykge1xuICAgICAgICAgICAgY29uc3QgaWQgPSBFbmdpbmVDbGFzcy5pZDtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZ2luZXNbaWRdKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJpbmcgZW5naW5lICR7aWR9IGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmVDbGFzcyh0aGlzLmVkaXRvcik7XG4gICAgICAgICAgICB0aGlzLmVuZ2luZXNbaWRdID0gZW5naW5lO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbG9hZFJlbmRlcmVycyhyZW5kZXJlcnM6IEFycmF5PFJlbmRlcmVyQ29uc3RydWN0b3IgfCBNb2RpZmllclJlbmRlcmVyQ29uc3RydWN0b3I+KTogdm9pZCB7XG4gICAgICAgIHJlbmRlcmVycyA9IFsuLi5yZW5kZXJlcnNdLnJldmVyc2UoKSBhcyBSZW5kZXJlckNvbnN0cnVjdG9yW107XG4gICAgICAgIGZvciAoY29uc3QgUmVuZGVyZXJDbGFzcyBvZiByZW5kZXJlcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaWQgaW4gdGhpcy5lbmdpbmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyaW5nRW5naW5lID0gdGhpcy5lbmdpbmVzW2lkXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFtpZCwgLi4ucmVuZGVyaW5nRW5naW5lLmNvbnN0cnVjdG9yLmV4dGVuZHNdO1xuICAgICAgICAgICAgICAgIGlmIChzdXBwb3J0ZWRUeXBlcy5pbmNsdWRlcyhSZW5kZXJlckNsYXNzLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJpbmdFbmdpbmUucmVnaXN0ZXIoUmVuZGVyZXJDbGFzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgaXNDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgTW9kaWZpZXIgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcic7XG5pbXBvcnQgeyBNb2RpZmllclJlbmRlcmVyLCBNb2RpZmllclJlbmRlcmVyQ29uc3RydWN0b3IgfSBmcm9tICcuL01vZGlmaWVyUmVuZGVyZXInO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyLCBSZW5kZXJlckNvbnN0cnVjdG9yIH0gZnJvbSAnLi9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVDYWNoZSwgTW9kaWZpZXJQYWlySWQgfSBmcm9tICcuL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcblxuZXhwb3J0IHR5cGUgUmVuZGVyaW5nSWRlbnRpZmllciA9IHN0cmluZztcblxubGV0IG1vZGlmaWVySWQgPSAwO1xuXG5leHBvcnQgY2xhc3MgUmVuZGVyaW5nRW5naW5lPFQgPSB7fT4ge1xuICAgIHN0YXRpYyByZWFkb25seSBpZDogUmVuZGVyaW5nSWRlbnRpZmllcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZXh0ZW5kczogUmVuZGVyaW5nSWRlbnRpZmllcltdID0gW107XG4gICAgc3RhdGljIHJlYWRvbmx5IGRlZmF1bHRSZW5kZXJlcjogUmVuZGVyZXJDb25zdHJ1Y3RvcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdE1vZGlmaWVyUmVuZGVyZXI6IE1vZGlmaWVyUmVuZGVyZXJDb25zdHJ1Y3RvcjtcbiAgICByZWFkb25seSBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIHJlYWRvbmx5IHJlbmRlcmVyczogTm9kZVJlbmRlcmVyPFQ+W10gPSBbXTtcbiAgICByZWFkb25seSBtb2RpZmllclJlbmRlcmVyczogTW9kaWZpZXJSZW5kZXJlcjxUPltdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihlZGl0b3I6IEpXRWRpdG9yKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yO1xuICAgICAgICBjb25zdCBkZWZhdWx0UmVuZGVyZXIgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0UmVuZGVyZXIodGhpcyk7XG4gICAgICAgIGlmIChkZWZhdWx0UmVuZGVyZXIucHJlZGljYXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYERlZmF1bHQgcmVuZGVyZXIgY2Fubm90IGhhdmUgYSBwcmVkaWNhdGUuYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVycy5wdXNoKGRlZmF1bHRSZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVmYXVsdE1vZGlmaWVyUmVuZGVyZXIgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0TW9kaWZpZXJSZW5kZXJlcih0aGlzKTtcbiAgICAgICAgaWYgKGRlZmF1bHRNb2RpZmllclJlbmRlcmVyLnByZWRpY2F0ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEZWZhdWx0IHJlbmRlcmVyIGNhbm5vdCBoYXZlIGEgcHJlZGljYXRlLmApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tb2RpZmllclJlbmRlcmVycy5wdXNoKGRlZmF1bHRNb2RpZmllclJlbmRlcmVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciB0aGUgZ2l2ZW4gcmVuZGVyZXIgYnkgaW5zdGFudGlhdGluZyBpdCB3aXRoIHRoaXMgcmVuZGVyaW5nXG4gICAgICogZW5naW5lLiBUaGUgcmVuZGVyZXIgY29uc3RydWN0b3Igd2lsbCByZWNlaXZlIGEgc3BlY2lhbCBzZWNvbmQgcGFyYW1ldGVyXG4gICAgICogd2hpY2ggaXMgYSBtYWdpYyByZW5kZXJlciB3aG9zZSBgcmVuZGVyYCBtZXRob2Qgd2lsbCBjYWxsIHRoZSBuZXh0XG4gICAgICogY29tcGF0aWJsZSByZW5kZXJlciBpbiBsaW5lIGZvciB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBSZW5kZXJlckNsYXNzXG4gICAgICovXG4gICAgcmVnaXN0ZXIoUmVuZGVyZXJDbGFzczogUmVuZGVyZXJDb25zdHJ1Y3RvcjxUPiB8IE1vZGlmaWVyUmVuZGVyZXJDb25zdHJ1Y3RvcjxUPik6IHZvaWQge1xuICAgICAgICAvLyBCb3RoIGlucHV0IHBhcmFtZXRlciB0eXBlcyBoYXZlIHRoZSBzYW1lIGZlYXR1cmVzIHdpdGggcmVzcGVjdCB0b1xuICAgICAgICAvLyB3aGF0IHdlIGFyZSBkb2luZyBpbiB0aGlzIGZ1bmN0aW9uLiBIb3dldmVyLCBUeXBlc2NyaXB0IHJlcXVpcmVzIGFcbiAgICAgICAgLy8gc3Ryb25nZXIgdHlwaW5nIGZvciBpbnNlcnRpbmcgdGhlbSBpbnRvIGFuIGFycmF5LiBXZSBjaG9zZSB0byB1c2UgYVxuICAgICAgICAvLyBibGluZCwgc29tZXdoYXQgd3JvbmcsIHR5cGVjYXN0IHRvIHJlZHVjZSB0aGUgc2NvcGUgb2YgdGhlIHR5cGVzXG4gICAgICAgIC8vIGluIG9yZGVyIHRvIGF2b2lkIGR1cGxpY2F0aW5nIHRoZSBsb2dpYyBvZiB0aGlzIGZ1bmN0aW9uLlxuICAgICAgICBjb25zdCByZW5kZXJlcnMgPSAoaXNDb25zdHJ1Y3RvcihSZW5kZXJlckNsYXNzLCBOb2RlUmVuZGVyZXIpXG4gICAgICAgICAgICA/IHRoaXMucmVuZGVyZXJzXG4gICAgICAgICAgICA6IHRoaXMubW9kaWZpZXJSZW5kZXJlcnMpIGFzIE5vZGVSZW5kZXJlcjxUPltdO1xuICAgICAgICBSZW5kZXJlckNsYXNzID0gUmVuZGVyZXJDbGFzcyBhcyBSZW5kZXJlckNvbnN0cnVjdG9yPFQ+O1xuXG4gICAgICAgIGlmIChSZW5kZXJlckNsYXNzLmlkID09PSB0aGlzLmNvbnN0cnVjdG9yLmlkKSB7XG4gICAgICAgICAgICByZW5kZXJlcnMudW5zaGlmdChuZXcgUmVuZGVyZXJDbGFzcyh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFt0aGlzLmNvbnN0cnVjdG9yLmlkLCAuLi50aGlzLmNvbnN0cnVjdG9yLmV4dGVuZHNdO1xuICAgICAgICAgICAgY29uc3QgcHJpb3JSZW5kZXJlcklkcyA9IHN1cHBvcnRlZFR5cGVzLnNsaWNlKFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgc3VwcG9ydGVkVHlwZXMuaW5kZXhPZihSZW5kZXJlckNsYXNzLmlkKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBwb3N0UmVuZGVyZXJJbmRleCA9IHJlbmRlcmVycy5maW5kSW5kZXgoXG4gICAgICAgICAgICAgICAgcGFyc2VyID0+ICFwcmlvclJlbmRlcmVySWRzLmluY2x1ZGVzKHBhcnNlci5jb25zdHJ1Y3Rvci5pZCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmVuZGVyZXJzLnNwbGljZShwb3N0UmVuZGVyZXJJbmRleCwgMCwgbmV3IFJlbmRlcmVyQ2xhc3ModGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgZ2l2ZW4gbm9kZS4gSWYgYSBwcmlvciByZW5kZXJpbmcgYWxyZWFkeSBleGlzdHMgZm9yIHRoaXMgbm9kZVxuICAgICAqIGluIHRoaXMgcnVuLCByZXR1cm4gaXQgZGlyZWN0bHkuXG4gICAgICogVGhlIGNhY2hlIGFyZSBhdXRvbWF0aWNhbHkgaW52YWxpZGF0ZSBpZiB0aGUgbm9kZXMgYXJlIG5vdCBsaW5rZWQgdG8gdGhlXG4gICAgICogbWVtb3J5IChsaW5rZWQgdG8gYSBsYXlvdXQgcm9vdCBmb3IgZWcpXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZXNcbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXIoXG4gICAgICAgIG5vZGVzOiBWTm9kZVtdLFxuICAgICAgICBjYWNoZT86IFJlbmRlcmluZ0VuZ2luZUNhY2hlPFQ+LFxuICAgICk6IFByb21pc2U8UmVuZGVyaW5nRW5naW5lQ2FjaGU8VD4+IHtcbiAgICAgICAgaWYgKCFjYWNoZSkge1xuICAgICAgICAgICAgY2FjaGUgPSBuZXcgUmVuZGVyaW5nRW5naW5lQ2FjaGUoKTtcbiAgICAgICAgICAgIGNhY2hlLndvcmtlciA9IHtcbiAgICAgICAgICAgICAgICBkZXBlbmRzOiB0aGlzLl9kZXBlbmRzLmJpbmQodGhpcywgY2FjaGUpLFxuICAgICAgICAgICAgICAgIHJlbmRlckJhdGNoZWQ6IHRoaXMucmVuZGVyQmF0Y2hlZC5iaW5kKHRoaXMsIGNhY2hlKSxcbiAgICAgICAgICAgICAgICBnZXRDb21wYXRpYmxlUmVuZGVyZXI6IHRoaXMuZ2V0Q29tcGF0aWJsZVJlbmRlcmVyLmJpbmQodGhpcywgY2FjaGUpLFxuICAgICAgICAgICAgICAgIGdldENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyOiB0aGlzLmdldENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyLmJpbmQodGhpcywgY2FjaGUpLFxuICAgICAgICAgICAgICAgIGxvY2F0ZTogdGhpcy5sb2NhdGUuYmluZCh0aGlzLCBjYWNoZSksXG4gICAgICAgICAgICAgICAgZ2V0UmVuZGVyaW5nOiAobm9kZSk6IFQgPT4gY2FjaGUucmVuZGVyaW5ncy5nZXQobm9kZSksXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBhc3luYyAobm9kZXM6IFZOb2RlW10pOiBQcm9taXNlPFRbXT4gPT4ge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcihub2RlcywgY2FjaGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXMubWFwKG5vZGUgPT4gY2FjaGUucmVuZGVyaW5ncy5nZXQobm9kZSkpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSB0aGlzLnJlbmRlckJhdGNoZWQoXG4gICAgICAgICAgICBjYWNoZSxcbiAgICAgICAgICAgIG5vZGVzLmZpbHRlcihub2RlID0+ICFjYWNoZS5yZW5kZXJpbmdQcm9taXNlcy5nZXQobm9kZSkpLFxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7IC8vIHdhaXQgdGhlIG5ld2VzdCBwcm9taXNlc1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChub2Rlcy5tYXAobm9kZSA9PiBjYWNoZS5yZW5kZXJpbmdQcm9taXNlcy5nZXQobm9kZSkpKTsgLy8gd2FpdCBpbmRpZmlkdWFsIHByb21pc2VcbiAgICAgICAgcmV0dXJuIGNhY2hlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGxvY2F0aW9uIG9mIHRoZSBub2RlcyBpbiB0aGUgcmVuZGVyaW5nIHBlcmZvcm1lZC5cbiAgICAgKlxuICAgICAqIEZvciBleGFtcGxlLCBpZiB5b3UgYXZlYyBhIDIgY2hhck5vZGVzIChYLCBZKSBzZXBlcmF0ZSBieSBhIGxpbmVicmVha1xuICAgICAqIGJ1dCwgeW91IHdhbnQgdG8gZGlzcGxheSBvbmUgdGV4dCBub2RlLCB5b3UgY2FuIGhhdmUgYSB0ZXh0IG5vZGUgZXF1YWxcbiAgICAgKiB0byAneF95JyBhbmQgaW5kaWNhdGUgdGhhdCBpdCdzIFtjaGFyTm9kZSwgTGluZUJyZWFrLCBDaGFyTm9kZV0uXG4gICAgICogT3IgeW91IHdhbnQgdG8gZGlzcGxheSB0aGUgTGluZWJyZWFrIHR3aWNlOiAneF95XycgYW5kIGluZGljYXRlIHRoaXNcbiAgICAgKiBbY2hhck5vZGUsIExpbmVCcmVhaywgQ2hhck5vZGUsIExpbmVCcmVha11cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2Rlc1xuICAgICAqIEBwYXJhbSByZW5kZXJpbmdcbiAgICAgKi9cbiAgICBsb2NhdGUoY2FjaGU6IFJlbmRlcmluZ0VuZ2luZUNhY2hlPFQ+LCBub2RlczogVk5vZGVbXSwgdmFsdWU6IFQpOiB2b2lkIHtcbiAgICAgICAgY2FjaGUubG9jYXRpb25zLnNldCh2YWx1ZSwgbm9kZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHcm91cCB0aGUgbm9kZXMgYW5kIGNhbGwgdGhlIHJlbmRlcmVyICdyZW5kZXJCYXRjaCcgbWV0aG9kIHdpdGggdGhlXG4gICAgICogZGlmZmVyZW50IGdyb3VwcyBvZiBub2Rlcy4gQnkgZGVmYXVsdCBlYWNoIGdyb3VwIGlzIGNvbXBvc2VkIHdpdGggb25seVxuICAgICAqIG9uZSBub2RlLlxuICAgICAqIFRoZSBpbmRpY2VzIG9mIHRoZSBEb21PYmplY3QgbGlzdCBtYXRjaCB0aGUgaW5kaWNlcyBvZiB0aGUgZ2l2ZW4gbm9kZXNcbiAgICAgKiBsaXN0LlxuICAgICAqXG4gICAgICogQHNlZSByZW5kZXJCYXRjaFxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVzXG4gICAgICogQHBhcmFtIHJlbmRlcmVkXG4gICAgICovXG4gICAgcmVuZGVyQmF0Y2hlZChcbiAgICAgICAgY2FjaGU6IFJlbmRlcmluZ0VuZ2luZUNhY2hlPFQ+LFxuICAgICAgICBub2RlczogVk5vZGVbXSxcbiAgICAgICAgcmVuZGVyZWQ/OiBOb2RlUmVuZGVyZXI8VD4sXG4gICAgKTogUHJvbWlzZTx2b2lkPltdIHtcbiAgICAgICAgY29uc3QgcHJvbWlzZXM6IFByb21pc2U8dm9pZD5bXSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVyID0gY2FjaGUud29ya2VyLmdldENvbXBhdGlibGVSZW5kZXJlcihub2RlLCByZW5kZXJlZCk7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJpbmdzID0gcmVuZGVyZXIucmVuZGVyQmF0Y2gobm9kZXMsIGNhY2hlLndvcmtlcik7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlID0gcmVuZGVyaW5ncy50aGVuKHZhbHVlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVwZW5kcyhjYWNoZSwgbm9kZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlcGVuZHMoY2FjaGUsIHZhbHVlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGREZWZhdWx0TG9jYXRpb24oY2FjaGUsIG5vZGUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICBjYWNoZS5yZW5kZXJpbmdzLnNldChub2RlLCB2YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhY2hlLnJlbmRlcmluZ1Byb21pc2VzLnNldChub2RlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2gocHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb21pc2VzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpcnN0IG1hdGNoZSBSZW5kZXJlciBmb3IgdGhpcyBWTm9kZSwgc3RhcnRpbmcgZnJvbSB0aGVcbiAgICAgKiBwcmV2aW91cyByZW5kZXJlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICogQHBhcmFtIHByZXZpb3VzUmVuZGVyZXJcbiAgICAgKi9cbiAgICBnZXRDb21wYXRpYmxlUmVuZGVyZXIoXG4gICAgICAgIGNhY2hlOiBSZW5kZXJpbmdFbmdpbmVDYWNoZTxUPixcbiAgICAgICAgbm9kZTogVk5vZGUsXG4gICAgICAgIHByZXZpb3VzUmVuZGVyZXI6IE5vZGVSZW5kZXJlcjxUPixcbiAgICApOiBOb2RlUmVuZGVyZXI8VD4ge1xuICAgICAgICBsZXQgY2FjaGVDb21wYXRpYmxlID0gY2FjaGUuY2FjaGVkQ29tcGF0aWJsZVJlbmRlcmVyLmdldChub2RlKTtcbiAgICAgICAgaWYgKCFjYWNoZUNvbXBhdGlibGUpIHtcbiAgICAgICAgICAgIGNhY2hlQ29tcGF0aWJsZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIGNhY2hlLmNhY2hlZENvbXBhdGlibGVSZW5kZXJlci5zZXQobm9kZSwgY2FjaGVDb21wYXRpYmxlKTtcbiAgICAgICAgfSBlbHNlIGlmIChjYWNoZUNvbXBhdGlibGUuZ2V0KHByZXZpb3VzUmVuZGVyZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVDb21wYXRpYmxlLmdldChwcmV2aW91c1JlbmRlcmVyKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbmV4dFJlbmRlcmVySW5kZXggPSB0aGlzLnJlbmRlcmVycy5pbmRleE9mKHByZXZpb3VzUmVuZGVyZXIpICsgMTtcbiAgICAgICAgbGV0IG5leHRSZW5kZXJlcjogTm9kZVJlbmRlcmVyPFQ+O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXh0UmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyc1tuZXh0UmVuZGVyZXJJbmRleF07XG4gICAgICAgICAgICBuZXh0UmVuZGVyZXJJbmRleCsrO1xuICAgICAgICB9IHdoaWxlIChuZXh0UmVuZGVyZXIgJiYgIW5vZGUudGVzdChuZXh0UmVuZGVyZXIucHJlZGljYXRlKSk7XG4gICAgICAgIGNhY2hlQ29tcGF0aWJsZS5zZXQocHJldmlvdXNSZW5kZXJlciwgbmV4dFJlbmRlcmVyKTtcbiAgICAgICAgcmV0dXJuIG5leHRSZW5kZXJlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBtYXRjaGUgUmVuZGVyZXIgZm9yIHRoaXMgVk5vZGUsIHN0YXJ0aW5nIGZyb20gdGhlXG4gICAgICogcHJldmlvdXMgcmVuZGVyZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBwcmV2aW91c1JlbmRlcmVyXG4gICAgICovXG4gICAgZ2V0Q29tcGF0aWJsZU1vZGlmaWVyUmVuZGVyZXIoXG4gICAgICAgIGNhY2hlOiBSZW5kZXJpbmdFbmdpbmVDYWNoZTxUPixcbiAgICAgICAgbW9kaWZpZXI6IE1vZGlmaWVyLFxuICAgICAgICBwcmV2aW91c1JlbmRlcmVyPzogTW9kaWZpZXJSZW5kZXJlcjxUPixcbiAgICApOiBNb2RpZmllclJlbmRlcmVyPFQ+IHtcbiAgICAgICAgbGV0IGNhY2hlQ29tcGF0aWJsZSA9IGNhY2hlLmNhY2hlZENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyLmdldChtb2RpZmllcik7XG4gICAgICAgIGlmICghY2FjaGVDb21wYXRpYmxlKSB7XG4gICAgICAgICAgICBjYWNoZUNvbXBhdGlibGUgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBjYWNoZS5jYWNoZWRDb21wYXRpYmxlTW9kaWZpZXJSZW5kZXJlci5zZXQobW9kaWZpZXIsIGNhY2hlQ29tcGF0aWJsZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2FjaGVDb21wYXRpYmxlLmdldChwcmV2aW91c1JlbmRlcmVyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlQ29tcGF0aWJsZS5nZXQocHJldmlvdXNSZW5kZXJlcik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbmV4dFJlbmRlcmVySW5kZXggPSB0aGlzLm1vZGlmaWVyUmVuZGVyZXJzLmluZGV4T2YocHJldmlvdXNSZW5kZXJlcikgKyAxO1xuICAgICAgICBsZXQgbmV4dFJlbmRlcmVyOiBNb2RpZmllclJlbmRlcmVyPFQ+O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXh0UmVuZGVyZXIgPSB0aGlzLm1vZGlmaWVyUmVuZGVyZXJzW25leHRSZW5kZXJlckluZGV4XTtcbiAgICAgICAgICAgIG5leHRSZW5kZXJlckluZGV4Kys7XG4gICAgICAgIH0gd2hpbGUgKFxuICAgICAgICAgICAgbmV4dFJlbmRlcmVyLnByZWRpY2F0ZSAmJlxuICAgICAgICAgICAgIShpc0NvbnN0cnVjdG9yKG5leHRSZW5kZXJlci5wcmVkaWNhdGUsIE1vZGlmaWVyKVxuICAgICAgICAgICAgICAgID8gbW9kaWZpZXIgaW5zdGFuY2VvZiBuZXh0UmVuZGVyZXIucHJlZGljYXRlXG4gICAgICAgICAgICAgICAgOiBuZXh0UmVuZGVyZXIucHJlZGljYXRlKG1vZGlmaWVyKSlcbiAgICAgICAgKTtcbiAgICAgICAgY2FjaGVDb21wYXRpYmxlLnNldChwcmV2aW91c1JlbmRlcmVyLCBuZXh0UmVuZGVyZXIpO1xuICAgICAgICByZXR1cm4gbmV4dFJlbmRlcmVyO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgX2RlcGVuZHMoXG4gICAgICAgIGNhY2hlOiBSZW5kZXJpbmdFbmdpbmVDYWNoZTxUPixcbiAgICAgICAgZGVwZW5kZW50OiBUIHwgVk5vZGUgfCBNb2RpZmllcixcbiAgICAgICAgZGVwZW5kZW5jeTogVCB8IFZOb2RlIHwgTW9kaWZpZXIsXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGxldCBkTm9kZTogVk5vZGUgfCBNb2RpZmllcjtcbiAgICAgICAgbGV0IGRSZW5kZXJpbmc6IFQ7XG4gICAgICAgIGxldCBkeU5vZGU6IFZOb2RlIHwgTW9kaWZpZXI7XG4gICAgICAgIGxldCBkeVJlbmRlcmluZzogVDtcbiAgICAgICAgaWYgKGRlcGVuZGVudCBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSB8fCBkZXBlbmRlbnQgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgZE5vZGUgPSBkZXBlbmRlbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkUmVuZGVyaW5nID0gZGVwZW5kZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZXBlbmRlbmN5IGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlIHx8IGRlcGVuZGVuY3kgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgZHlOb2RlID0gZGVwZW5kZW5jeTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGR5UmVuZGVyaW5nID0gZGVwZW5kZW5jeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkTm9kZSkge1xuICAgICAgICAgICAgaWYgKGR5Tm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtlZCA9IGNhY2hlLmxpbmtlZE5vZGVzLmdldChkeU5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChsaW5rZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VkLmFkZChkTm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUubGlua2VkTm9kZXMuc2V0KGR5Tm9kZSwgbmV3IFNldChbZE5vZGVdKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9tID0gY2FjaGUucmVuZGVyaW5nRGVwZW5kZW50LmdldChkeVJlbmRlcmluZyk7XG4gICAgICAgICAgICAgICAgaWYgKGZyb20pIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbS5hZGQoZE5vZGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlLnJlbmRlcmluZ0RlcGVuZGVudC5zZXQoZHlSZW5kZXJpbmcsIG5ldyBTZXQoW2ROb2RlXSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChkeU5vZGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmtlZCA9IGNhY2hlLm5vZGVEZXBlbmRlbnQuZ2V0KGR5Tm9kZSk7XG4gICAgICAgICAgICBpZiAobGlua2VkKSB7XG4gICAgICAgICAgICAgICAgbGlua2VkLmFkZChkUmVuZGVyaW5nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FjaGUubm9kZURlcGVuZGVudC5zZXQoZHlOb2RlLCBuZXcgU2V0KFtkUmVuZGVyaW5nXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb3RlY3RlZCBfYWRkRGVmYXVsdExvY2F0aW9uKGNhY2hlOiBSZW5kZXJpbmdFbmdpbmVDYWNoZTxUPiwgbm9kZTogVk5vZGUsIHZhbHVlOiBUKTogdm9pZCB7XG4gICAgICAgIGNhY2hlLmxvY2F0aW9ucy5zZXQodmFsdWUsIFtub2RlXSk7XG4gICAgfVxuICAgIHByb3RlY3RlZCBfbW9kaWZpZXJJc1NhbWVBcyhcbiAgICAgICAgY2FjaGU6IFJlbmRlcmluZ0VuZ2luZUNhY2hlPFQ+LFxuICAgICAgICBtb2RpZmllckE6IE1vZGlmaWVyIHwgdm9pZCxcbiAgICAgICAgbW9kaWZpZXJCOiBNb2RpZmllciB8IHZvaWQsXG4gICAgKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChtb2RpZmllckEgPT09IG1vZGlmaWVyQikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGlkQSA9IG1vZGlmaWVyQSA/IGNhY2hlLmNhY2hlZE1vZGlmaWVySWQuZ2V0KG1vZGlmaWVyQSkgOiAnbnVsbCc7XG4gICAgICAgIGlmICghaWRBKSB7XG4gICAgICAgICAgICBpZEEgPSArK21vZGlmaWVySWQ7XG4gICAgICAgICAgICBjYWNoZS5jYWNoZWRNb2RpZmllcklkLnNldChtb2RpZmllckEsIGlkQSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGlkQiA9IG1vZGlmaWVyQiA/IGNhY2hlLmNhY2hlZE1vZGlmaWVySWQuZ2V0KG1vZGlmaWVyQikgOiAnbnVsbCc7XG4gICAgICAgIGlmICghaWRCKSB7XG4gICAgICAgICAgICBpZEIgPSArK21vZGlmaWVySWQ7XG4gICAgICAgICAgICBjYWNoZS5jYWNoZWRNb2RpZmllcklkLnNldChtb2RpZmllckIsIGlkQik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5OiBNb2RpZmllclBhaXJJZCA9IGlkQSA+IGlkQiA/IGlkQSArICctJyArIGlkQiA6IGlkQiArICctJyArIGlkQTtcbiAgICAgICAgaWYgKGtleSBpbiBjYWNoZS5jYWNoZWRJc1NhbWVBc01vZGlmaWVyKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGUuY2FjaGVkSXNTYW1lQXNNb2RpZmllcltrZXldO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzU2FtZSA9XG4gICAgICAgICAgICAoIW1vZGlmaWVyQSB8fCBtb2RpZmllckEuaXNTYW1lQXMobW9kaWZpZXJCKSkgJiZcbiAgICAgICAgICAgICghbW9kaWZpZXJCIHx8IG1vZGlmaWVyQi5pc1NhbWVBcyhtb2RpZmllckEpKTtcbiAgICAgICAgY2FjaGUuY2FjaGVkSXNTYW1lQXNNb2RpZmllcltrZXldID0gaXNTYW1lO1xuICAgICAgICBpZiAoIWNhY2hlLmNhY2hlZElzU2FtZUFzTW9kaWZpZXJJZHNbaWRBXSkge1xuICAgICAgICAgICAgY2FjaGUuY2FjaGVkSXNTYW1lQXNNb2RpZmllcklkc1tpZEFdID0gW2tleV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZS5jYWNoZWRJc1NhbWVBc01vZGlmaWVySWRzW2lkQV0ucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY2FjaGUuY2FjaGVkSXNTYW1lQXNNb2RpZmllcklkc1tpZEJdKSB7XG4gICAgICAgICAgICBjYWNoZS5jYWNoZWRJc1NhbWVBc01vZGlmaWVySWRzW2lkQl0gPSBba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlLmNhY2hlZElzU2FtZUFzTW9kaWZpZXJJZHNbaWRCXS5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzU2FtZTtcbiAgICB9XG59XG5cbmV4cG9ydCB0eXBlIFJlbmRlcmluZ0VuZ2luZUNvbnN0cnVjdG9yPFQgPSB7fT4gPSB7XG4gICAgbmV3ICguLi5hcmdzOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8dHlwZW9mIFJlbmRlcmluZ0VuZ2luZT4pOiBSZW5kZXJpbmdFbmdpbmU7XG4gICAgaWQ6IFJlbmRlcmluZ0lkZW50aWZpZXI7XG4gICAgZXh0ZW5kczogUmVuZGVyaW5nSWRlbnRpZmllcltdO1xuICAgIGRlZmF1bHRSZW5kZXJlcjogUmVuZGVyZXJDb25zdHJ1Y3RvcjxUPjtcbiAgICBkZWZhdWx0TW9kaWZpZXJSZW5kZXJlcjogTW9kaWZpZXJSZW5kZXJlckNvbnN0cnVjdG9yPFQ+O1xufTtcbmV4cG9ydCBpbnRlcmZhY2UgUmVuZGVyaW5nRW5naW5lPFQgPSB7fT4ge1xuICAgIGNvbnN0cnVjdG9yOiBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3RvcjxUPjtcbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgTW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4vTW9kaWZpZXJSZW5kZXJlcic7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuL05vZGVSZW5kZXJlcic7XG5cbmV4cG9ydCB0eXBlIE1vZGlmaWVySWQgPSBudW1iZXI7XG5leHBvcnQgdHlwZSBNb2RpZmllclBhaXJJZCA9IHN0cmluZztcblxuZXhwb3J0IGludGVyZmFjZSBSZW5kZXJpbmdFbmdpbmVXb3JrZXI8VD4ge1xuICAgIC8qKlxuICAgICAqIEludmFsaWRhdGUgdGhlIGZpcnN0IGlmIHRoZSBzZWNvbmQgaXMgaW52YWxpZGF0ZWQuXG4gICAgICpcbiAgICAgKiBJZiB0aGUgZ2l2ZW4gZGVwZW5kZW50IGlzIFZOb2RlIG9yIE1vZGlmaWVyIGFuZCB0aGUgZGVwZW5kZW5jeSBpcyBhXG4gICAgICogVk5vZGUgb3IgTW9kaWZpZXIgd2hlbiB0aGUgZGVwZW5kZW5jeSBpcyBpbnZhbGlkYXRlZCB0aGUgZGVwZW5kZW50IHdpbGxcbiAgICAgKiBiZSBpbnZhbGlkYXRlZC5cbiAgICAgKlxuICAgICAqIElmIHRoZSBnaXZlbiBkZXBlbmRlbnQgaXMgVk5vZGUgb3IgTW9kaWZpZXIgYW5kIHRoZSBkZXBlbmRlbmN5IGlzIGFcbiAgICAgKiByZW5kZXJpbmcsIHdoZW4gdGhlIHJlbmRlcmluZyBpcyBpbnZhbGlkYXRlZCBldmVyeSBkZXBlbmRlbnQgd2lsbCBiZVxuICAgICAqIGludmFsaWRhdGVkLlxuICAgICAqXG4gICAgICogSWYgdGhlIGdpdmVuIGRlcGVuZGVudCBpcyByZW5kZXJpbmcgd2hlbiB0aGUgVk5vZGUgb3IgTW9kaWZpZXIgaXNcbiAgICAgKiBpbnZhbGlkYXRlZCB0aGUgcmVuZGVyaW5nIHdpbGwgYmUgaW52YWxpZGF0ZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGVwZW5kZW50XG4gICAgICogQHBhcmFtIGRlcGVuZGVuY3lcbiAgICAgKi9cbiAgICBkZXBlbmRzKGRlcGVuZGVudDogVk5vZGUgfCBNb2RpZmllciwgZGVwZW5kZW5jeTogVk5vZGUgfCBNb2RpZmllcik6IHZvaWQ7XG4gICAgZGVwZW5kcyhkZXBlbmRlbnQ6IFZOb2RlIHwgTW9kaWZpZXIsIGRlcGVuZGVuY3k6IFQpOiB2b2lkO1xuICAgIGRlcGVuZHMoZGVwZW5kZW50OiBULCBkZXBlbmRlbmN5OiBWTm9kZSB8IE1vZGlmaWVyKTogdm9pZDtcbiAgICBkZXBlbmRzKGRlcGVuZGVudDogVCB8IFZOb2RlIHwgTW9kaWZpZXIsIGRlcGVuZGVuY3k6IFQgfCBWTm9kZSB8IE1vZGlmaWVyKTogdm9pZDtcblxuICAgIHJlbmRlckJhdGNoZWQobm9kZXM6IFZOb2RlW10sIHJlbmRlcmVkPzogTm9kZVJlbmRlcmVyPFQ+KTogUHJvbWlzZTx2b2lkPltdO1xuICAgIGdldENvbXBhdGlibGVSZW5kZXJlcihub2RlOiBWTm9kZSwgcHJldmlvdXNSZW5kZXJlcjogTm9kZVJlbmRlcmVyPFQ+KTogTm9kZVJlbmRlcmVyPFQ+O1xuICAgIGdldENvbXBhdGlibGVNb2RpZmllclJlbmRlcmVyKFxuICAgICAgICBtb2RpZmllcjogTW9kaWZpZXIsXG4gICAgICAgIHByZXZpb3VzUmVuZGVyZXI/OiBNb2RpZmllclJlbmRlcmVyPFQ+LFxuICAgICk6IE1vZGlmaWVyUmVuZGVyZXI8VD47XG4gICAgZ2V0UmVuZGVyaW5nKG5vZGU6IFZOb2RlKTogVDtcbiAgICBsb2NhdGUobm9kZXM6IFZOb2RlW10sIHZhbHVlOiBUKTogdm9pZDtcbiAgICByZW5kZXIobm9kZXM6IFZOb2RlW10pOiBQcm9taXNlPFRbXT47XG59XG5cbmV4cG9ydCBjbGFzcyBSZW5kZXJpbmdFbmdpbmVDYWNoZTxUPiB7XG4gICAgLy8gUmVuZGVyaW5nIGNyZWF0ZWQgYnkgYSBWTm9kZS5cbiAgICByZW5kZXJpbmdzID0gbmV3IE1hcDxWTm9kZSwgVD4oKTtcbiAgICAvLyBQcm9taXNlIHJlc29sdmVkIHdoZW4gdGhlIHJlbmRlcmluZ3MgaXMgcmVhZHkuIFdlIGNhbiBoYXZlIGEgdmFsdWUgaW4gcmVuZGVyaW5ncyBiZWZvcmUgdGhlXG4gICAgLy8gcHJvbWlzZSBpcyByZXNvbHZlZCBidXQgaXQncyBub3QgdGhlIGNvbXBsZXRlIHZhbHVlIChmb3IgZWc6IHdlIGNyZWF0ZSB0aGUgbm9kZSBhbmQgYW4gb3RoZXJcbiAgICAvLyByZW5kZXJlciBhZGQgdGhlIGF0dHJpYnV0ZXMgb24gdGhpcyBub2RlKVxuICAgIHJlbmRlcmluZ1Byb21pc2VzID0gbmV3IE1hcDxWTm9kZSwgUHJvbWlzZTx2b2lkPj4oKTtcblxuICAgIC8vIFZOb2RlcyBsb2NhdGlvbnMgaW4gYSByZW5kZXJpbmcgKGJ5IGRlZmF1bHQgdGhlIHJlbmRlcmluZyBpcyBlcXVhbCB0byB0aGUgbG9jYXRpb24pLlxuICAgIGxvY2F0aW9ucyA9IG5ldyBNYXA8VCwgVk5vZGVbXT4oKTtcbiAgICAvLyBMaXN0IG9mIFZOb2RlIGFuZCBNb2RpZmllcnMgbGlua2VkIHRvIGEgcmVuZGVyaW5nLlxuICAgIC8vIFdoZW4gdGhlIHJlbmRlcmluZyBpcyBpbnZhbGlkYXRlZCBldmVyeSBWTm9kZSBvciBNb2RpZmllciB3aWxsIGJlIGludmFsaWRhdGVkLlxuICAgIHJlbmRlcmluZ0RlcGVuZGVudCA9IG5ldyBNYXA8VCwgU2V0PFZOb2RlIHwgTW9kaWZpZXI+PigpO1xuICAgIC8vIFdoZW4gdGhlIFZOb2RlIG9yIE1vZGlmaWVyIGlzIGludmFsaWRhdGVkIGV2ZXJ5IHJlbmRlcmluZyB3aWxsIGJlIGludmFsaWRhdGVkLlxuICAgIG5vZGVEZXBlbmRlbnQgPSBuZXcgTWFwPFZOb2RlIHwgTW9kaWZpZXIsIFNldDxUPj4oKTtcbiAgICAvLyBXaGVuIHRoZSBkZXBlbmRlbmN5IGlzIGludmFsaWRhdGVkIGV2ZXJ5IGRlcGVuZGVudHMgd2lsbCBiZSBpbnZhbGlkYXRlZC5cbiAgICBsaW5rZWROb2RlcyA9IG5ldyBNYXA8Vk5vZGUgfCBNb2RpZmllciwgU2V0PFZOb2RlIHwgTW9kaWZpZXI+PigpO1xuXG4gICAgLy8gQ2FjaGUgZm9yIGZvdW5kZWQgcmVuZGVyZXIuXG4gICAgY2FjaGVkQ29tcGF0aWJsZVJlbmRlcmVyID0gbmV3IE1hcDxWTm9kZSwgTWFwPE5vZGVSZW5kZXJlcjxUPiwgTm9kZVJlbmRlcmVyPFQ+Pj4oKTtcbiAgICBjYWNoZWRDb21wYXRpYmxlTW9kaWZpZXJSZW5kZXJlciA9IG5ldyBNYXA8XG4gICAgICAgIE1vZGlmaWVyLFxuICAgICAgICBNYXA8TW9kaWZpZXJSZW5kZXJlcjxUPiwgTW9kaWZpZXJSZW5kZXJlcjxUPj5cbiAgICA+KCk7XG5cbiAgICAvLyBDYWNoZSB0byBjb21wYXJlIG1vZGlmaWVycy5cbiAgICBjYWNoZWRNb2RpZmllcklkID0gbmV3IE1hcDxNb2RpZmllciB8IHZvaWQsIE1vZGlmaWVySWQ+KCk7XG4gICAgY2FjaGVkSXNTYW1lQXNNb2RpZmllcjogUmVjb3JkPE1vZGlmaWVyUGFpcklkLCBib29sZWFuPiA9IHt9O1xuICAgIC8vIFVzZWQgdG8gaW52YWxpZGF0ZSB0aGUgY2FjaGVkSXNTYW1lQXNNb2RpZmllciB2YWx1ZXMuXG4gICAgY2FjaGVkSXNTYW1lQXNNb2RpZmllcklkczogUmVjb3JkPE1vZGlmaWVySWQsIE1vZGlmaWVyUGFpcklkW10+ID0ge307XG5cbiAgICAvLyBXb3JrZXIgc2VuZCB0byByZW5kZXJlcnMgbWV0aG9kICdyZW5kZXInLlxuICAgIHdvcmtlcj86IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxUPjtcbn1cbiIsImltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgU2hhZG93SHRtbERvbVBhcnNlciB9IGZyb20gJy4vU2hhZG93SHRtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBTaGFkb3dYbWxEb21QYXJzZXIgfSBmcm9tICcuL1NoYWRvd1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBTaGFkb3dEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vU2hhZG93RG9tT2JqZWN0UmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgU2hhZG93PFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW1BhcnNlciwgUmVuZGVyZXJdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1NoYWRvd1htbERvbVBhcnNlciwgU2hhZG93SHRtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW1NoYWRvd0RvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IE5vZGVSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTm9kZVJlbmRlcmVyJztcbmltcG9ydCB7IFNoYWRvd05vZGUgfSBmcm9tICcuL1NoYWRvd05vZGUnO1xuaW1wb3J0IHsgTWV0YWRhdGFOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLW1ldGFkYXRhL3NyYy9NZXRhZGF0YU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgU2hhZG93RG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFNoYWRvd05vZGU7XG5cbiAgICBhc3luYyByZW5kZXIoc2hhZG93OiBTaGFkb3dOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgZG9tT2JqZWN0OiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdKVy1TSEFET1cnLFxuICAgICAgICAgICAgc2hhZG93Um9vdDogdHJ1ZSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBzaGFkb3cuY2hpbGRWTm9kZXMuZmlsdGVyKFxuICAgICAgICAgICAgICAgIGNoaWxkID0+IGNoaWxkLnRhbmdpYmxlIHx8IGNoaWxkIGluc3RhbmNlb2YgTWV0YWRhdGFOb2RlLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IEh0bWxEb21QYXJzaW5nRW5naW5lLCBIdG1sTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBTaGFkb3dOb2RlIH0gZnJvbSAnLi9TaGFkb3dOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcblxuZXhwb3J0IGNsYXNzIFNoYWRvd0h0bWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBIVE1MRWxlbWVudCk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmICEhaXRlbS5zaGFkb3dSb290O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHNoYWRvdyBub2RlIGFuZCBleHRyYWN0IHN0eWxpbmcgZnJvbSBzaGFkb3cgcm9vdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogSFRNTEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgc2hhZG93Um9vdCA9IGl0ZW0uc2hhZG93Um9vdDtcbiAgICAgICAgY29uc3Qgc2hhZG93ID0gbmV3IFNoYWRvd05vZGUoKTtcbiAgICAgICAgY29uc3QgY2hpbGROb2RlcyA9IEFycmF5LmZyb20oc2hhZG93Um9vdC5jaGlsZE5vZGVzKSBhcyBIdG1sTm9kZVtdO1xuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLmNoaWxkTm9kZXMpO1xuICAgICAgICBzaGFkb3cuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgaWYgKG5vZGVOYW1lKGl0ZW0pID09PSAnSlctU0hBRE9XJykge1xuICAgICAgICAgICAgcmV0dXJuIFtzaGFkb3ddO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IG5ldyBWRWxlbWVudCh7IGh0bWxUYWc6IG5vZGVOYW1lKGl0ZW0pIH0pO1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKHNoYWRvdyk7XG4gICAgICAgICAgICByZXR1cm4gW2VsZW1lbnRdO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGNsYXNzIFNoYWRvd05vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHtcbiAgICBlZGl0YWJsZSA9IGZhbHNlO1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBTaGFkb3dOb2RlIH0gZnJvbSAnLi9TaGFkb3dOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNoYWRvd1htbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QtU0hBRE9XJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBzaGFkb3cgbm9kZSBhbmQgZXh0cmFjdCBzdHlsaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHNoYWRvdyA9IG5ldyBTaGFkb3dOb2RlKCk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgc2hhZG93Lm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBzaGFkb3cuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgcmV0dXJuIFtzaGFkb3ddO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFNwYW5YbWxEb21QYXJzZXIgfSBmcm9tICcuL1NwYW5YbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBTcGFuPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0lubGluZV07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1NwYW5YbWxEb21QYXJzZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBGb3JtYXQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Gb3JtYXQnO1xuXG5leHBvcnQgY2xhc3MgU3BhbkZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IoaHRtbFRhZzogJ1NQQU4nIHwgJ0ZPTlQnID0gJ1NQQU4nKSB7XG4gICAgICAgIHN1cGVyKGh0bWxUYWcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdFhtbERvbVBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBTcGFuRm9ybWF0IH0gZnJvbSAnLi9TcGFuRm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcblxuZXhwb3J0IGNsYXNzIFNwYW5YbWxEb21QYXJzZXIgZXh0ZW5kcyBGb3JtYXRYbWxEb21QYXJzZXIge1xuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiAobm9kZU5hbWUoaXRlbSkgPT09ICdTUEFOJyB8fCBub2RlTmFtZShpdGVtKSA9PT0gJ0ZPTlQnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBzcGFuIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgc3BhbiA9IG5ldyBTcGFuRm9ybWF0KG5vZGVOYW1lKGl0ZW0pIGFzICdTUEFOJyB8ICdGT05UJyk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgc3Bhbi5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgLy8gSGFuZGxlIGVtcHR5IHNwYW5zLlxuICAgICAgICBpZiAoIWNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChuZXcgSW5saW5lTm9kZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHNwYW4sIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgU3Vic2NyaXB0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9TdWJzY3JpcHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbU3Vic2NyaXB0WG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRm9ybWF0JztcblxuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdEZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdTVUInKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRYbWxEb21QYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0Rm9ybWF0IH0gZnJvbSAnLi9TdWJzY3JpcHRGb3JtYXQnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgU3Vic2NyaXB0WG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0WG1sRG9tUGFyc2VyIHtcbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdTVUInO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHNwYW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHQgPSBuZXcgU3Vic2NyaXB0Rm9ybWF0KCk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgc3Vic2NyaXB0Lm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHN1YnNjcmlwdCwgY2hpbGRyZW4pO1xuXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBTdXBlcnNjcmlwdFhtbERvbVBhcnNlciB9IGZyb20gJy4vU3VwZXJzY3JpcHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBTdXBlcnNjcmlwdDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtTdXBlcnNjcmlwdFhtbERvbVBhcnNlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBTdXBlcnNjcmlwdEZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdTVVAnKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRYbWxEb21QYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgU3VwZXJzY3JpcHRGb3JtYXQgfSBmcm9tICcuL1N1cGVyc2NyaXB0Rm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFN1cGVyc2NyaXB0WG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0WG1sRG9tUGFyc2VyIHtcbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdTVVAnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHNwYW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBzdXBlcnNjcmlwdCA9IG5ldyBTdXBlcnNjcmlwdEZvcm1hdCgpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHN1cGVyc2NyaXB0Lm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHN1cGVyc2NyaXB0LCBjaGlsZHJlbik7XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi90YWJsZVVJLmNzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxudmFyIGV4cG9ydGVkID0gY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHt9O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRlZDsiLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBUYWJsZVhtbERvbVBhcnNlciB9IGZyb20gJy4vVGFibGVYbWxEb21QYXJzZXInO1xuaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBUYWJsZVJvd1htbERvbVBhcnNlciB9IGZyb20gJy4vVGFibGVSb3dYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVGFibGVDZWxsWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9UYWJsZUNlbGxYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVGFibGVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vVGFibGVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZVJvd0RvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9UYWJsZVJvd0RvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IFRhYmxlQ2VsbERvbU9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9UYWJsZUNlbGxEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzRG9tT2JqZWN0TW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4vVGFibGVTZWN0aW9uQXR0cmlidXRlc0RvbU9iamVjdE1vZGlmaWVyUmVuZGVyZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVGFibGVOb2RlIH0gZnJvbSAnLi9UYWJsZU5vZGUnO1xuaW1wb3J0IHsgZGlzdGluY3QgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgUmVsYXRpdmVQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgVGFibGVQaWNrZXJEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vVGFibGVQaWNrZXJEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZVBpY2tlckNlbGxEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vVGFibGVQaWNrZXJDZWxsRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgVGFibGVQaWNrZXJOb2RlIH0gZnJvbSAnLi9UYWJsZVBpY2tlck5vZGUnO1xuaW1wb3J0ICcuLi9hc3NldHMvdGFibGVVSS5jc3MnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRhYmxlQ29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIG1pblJvd0NvdW50PzogbnVtYmVyO1xuICAgIG1pbkNvbHVtbkNvdW50PzogbnVtYmVyO1xuICAgIGlubGluZVVJPzogYm9vbGVhbjtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgSW5zZXJ0VGFibGVQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICByb3dDb3VudD86IG51bWJlcjtcbiAgICBjb2x1bW5Db3VudD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFRhYmxlPFQgZXh0ZW5kcyBUYWJsZUNvbmZpZyA9IFRhYmxlQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlciAmIEtleW1hcCAmIExheW91dD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtUYWJsZVhtbERvbVBhcnNlciwgVGFibGVSb3dYbWxEb21QYXJzZXIsIFRhYmxlQ2VsbFhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW1xuICAgICAgICAgICAgVGFibGVQaWNrZXJEb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIFRhYmxlUGlja2VyQ2VsbERvbU9iamVjdFJlbmRlcmVyLFxuICAgICAgICAgICAgVGFibGVEb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIFRhYmxlUm93RG9tT2JqZWN0UmVuZGVyZXIsXG4gICAgICAgICAgICBUYWJsZUNlbGxEb21PYmplY3RSZW5kZXJlcixcbiAgICAgICAgICAgIFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyLFxuICAgICAgICBdLFxuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCs8U2xhc2g+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhZGRSb3dCZWxvdycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxTbGFzaD4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FkZFJvd0Fib3ZlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrPEVxdWFsPicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWRkQ29sdW1uQWZ0ZXInLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCs8RXF1YWw+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhZGRDb2x1bW5CZWZvcmUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCtERUxFVEUnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2RlbGV0ZVJvdycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUK0JBQ0tTUEFDRScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnZGVsZXRlQ29sdW1uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrQUxUK1NISUZUK0RFTEVURScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnZGVsZXRlVGFibGUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCs8UGVyaW9kPicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnbWVyZ2VDZWxscycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxQZXJpb2Q+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bm1lcmdlQ2VsbHMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnVGFibGVCdXR0b24nLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gbmV3IEFjdGlvbmFibGVOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICd0YWJsZUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1BpY2sgdGhlIHNpemUgb2YgdGhlIHRhYmxlIHlvdSB3YW50IHRvIGluc2VydCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdpbnNlcnRUYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnBsdWdpbnMuZ2V0KFRhYmxlKS5pc1RhYmxlUGlja2VyT3BlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW25ldyBBdHRyaWJ1dGVzKHsgY2xhc3M6ICdmYSBmYS10YWJsZSBmYS1mdycgfSldLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtidXR0b25dO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnVGFibGVQaWNrZXInLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlbmRlcihlZGl0b3I6IEpXRWRpdG9yKTogUHJvbWlzZTxUYWJsZVBpY2tlck5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWJsZVBsdWdpbiA9IGVkaXRvci5wbHVnaW5zLmdldChUYWJsZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhYmxlID0gbmV3IFRhYmxlUGlja2VyTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3dDb3VudDogdGFibGVQbHVnaW4ubWluUm93Q291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5Db3VudDogdGFibGVQbHVnaW4ubWluQ29sdW1uQ291bnQsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3RhYmxlXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtbJ1RhYmxlQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXV0sXG4gICAgfTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgaW5zZXJ0VGFibGU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0VGFibGUuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRkUm93QWJvdmU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuYWRkUm93QWJvdmUuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRkUm93QmVsb3c6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuYWRkUm93QmVsb3cuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRkQ29sdW1uQmVmb3JlOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmFkZENvbHVtbkJlZm9yZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBhZGRDb2x1bW5BZnRlcjoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hZGRDb2x1bW5BZnRlci5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBkZWxldGVSb3c6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuZGVsZXRlUm93LmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUNvbHVtbjoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5kZWxldGVDb2x1bW4uYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlVGFibGU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuZGVsZXRlVGFibGUuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgbWVyZ2VDZWxsczoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5tZXJnZUNlbGxzLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIHVubWVyZ2VDZWxsczoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy51bm1lcmdlQ2VsbHMuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIGlzVGFibGVQaWNrZXJPcGVuID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogVGhlIG1pbmltdW0gcm93IGNvdW50IGZvciB0aGUgdGFibGUgcGlja2VyIChkZWZhdWx0OiA1KS5cbiAgICAgKi9cbiAgICBtaW5Sb3dDb3VudCA9IDU7XG4gICAgLyoqXG4gICAgICogVGhlIG1pbmltdW0gY29sdW1uIGNvdW50IGZvciB0aGUgdGFibGUgcGlja2VyIChkZWZhdWx0OiA1KS5cbiAgICAgKi9cbiAgICBtaW5Db2x1bW5Db3VudCA9IDU7XG4gICAgLyoqXG4gICAgICogSWYgdHJ1ZSwgYWRkIFVJIGJ1dHRvbnMgaW5saW5lIGluIHRoZSB0YWJsZSBvbiByZW5kZXIgdG8gYWRkL3JlbW92ZVxuICAgICAqIGNvbHVtbnMvcm93cy5cbiAgICAgKi9cbiAgICBpbmxpbmVVSSA9IGZhbHNlO1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBlZGl0b3I6IEpXRWRpdG9yLCBwdWJsaWMgY29uZmlnOiBUKSB7XG4gICAgICAgIHN1cGVyKGVkaXRvciwgY29uZmlnKTtcbiAgICAgICAgaWYgKGNvbmZpZy5taW5Sb3dDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5taW5Sb3dDb3VudCA9IGNvbmZpZy5taW5Sb3dDb3VudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLm1pbkNvbHVtbkNvdW50KSB7XG4gICAgICAgICAgICB0aGlzLm1pbkNvbHVtbkNvdW50ID0gY29uZmlnLm1pbkNvbHVtbkNvdW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5saW5lVUkgPSAhIWNvbmZpZy5pbmxpbmVVSTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgdGFibGUgYXQgcmFuZ2UuIElmIG5vIGRpbWVuc2lvbnMgYXJlIGdpdmVuIGZvciB0aGUgdGFibGUsIG9wZW5cbiAgICAgKiB0aGUgdGFibGUgcGlja2VyIGluIG9yZGVyIHRvIGFzayB0aGUgdXNlciBmb3IgZGltZW5zaW9ucy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyBpbnNlcnRUYWJsZShwYXJhbXM6IEluc2VydFRhYmxlUGFyYW1zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCk7XG4gICAgICAgIGlmICh0aGlzLmlzVGFibGVQaWNrZXJPcGVuKSB7XG4gICAgICAgICAgICBhd2FpdCBsYXlvdXQucmVtb3ZlKCdUYWJsZVBpY2tlcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1zLnJvd0NvdW50IHx8ICFwYXJhbXMuY29sdW1uQ291bnQpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1lbW9yeUluZm8udWlDb21tYW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1RhYmxlUGlja2VyT3Blbikge1xuICAgICAgICAgICAgICAgIGF3YWl0IGxheW91dC5hcHBlbmQoJ1RhYmxlUGlja2VyJywgJ1RhYmxlQnV0dG9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0LnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0LmJlZm9yZShuZXcgVGFibGVOb2RlKHBhcmFtcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJvdyBhYm92ZSB0aGUgY2VsbCBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhZGRSb3dBYm92ZShwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgY2VsbCA9IHJhbmdlLnN0YXJ0LmFuY2VzdG9yKFRhYmxlQ2VsbE5vZGUpO1xuICAgICAgICBpZiAoIWNlbGwpIHJldHVybjtcblxuICAgICAgICBjZWxsLmFuY2VzdG9yKFRhYmxlTm9kZSkuYWRkUm93QWJvdmUoY2VsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJvdyBiZWxvdyB0aGUgY2VsbCBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhZGRSb3dCZWxvdyhwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3Qgcm93ID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICghcm93KSByZXR1cm47XG5cbiAgICAgICAgcm93LmFuY2VzdG9yKFRhYmxlTm9kZSkuYWRkUm93QmVsb3cocm93KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgY29sdW1uIGJlZm9yZSB0aGUgY2VsbCBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhZGRDb2x1bW5CZWZvcmUocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGNlbGwgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKCFjZWxsKSByZXR1cm47XG5cbiAgICAgICAgY2VsbC5hbmNlc3RvcihUYWJsZU5vZGUpLmFkZENvbHVtbkJlZm9yZShjZWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgY29sdW1uIGFmdGVyIHRoZSBjZWxsIGF0IGdpdmVuIHJhbmdlIHN0YXJ0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFkZENvbHVtbkFmdGVyKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxsID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICghY2VsbCkgcmV0dXJuO1xuXG4gICAgICAgIGNlbGwuYW5jZXN0b3IoVGFibGVOb2RlKS5hZGRDb2x1bW5BZnRlcihjZWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSByb3cgYXQgZ2l2ZW4gcmFuZ2Ugc3RhcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgZGVsZXRlUm93KHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxsID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICghY2VsbCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHJvdyA9IGNlbGwuYW5jZXN0b3IoVGFibGVSb3dOb2RlKTtcbiAgICAgICAgY29uc3QgbmV4dFJvdyA9IHJvdy5uZXh0U2libGluZyhUYWJsZVJvd05vZGUpIHx8IHJvdy5wcmV2aW91c1NpYmxpbmcoVGFibGVSb3dOb2RlKTtcbiAgICAgICAgY29uc3QgbmV4dENlbGwgPSBuZXh0Um93ICYmIG5leHRSb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSlbY2VsbC5jb2x1bW5JbmRleF07XG5cbiAgICAgICAgaWYgKG5leHRDZWxsKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0Um93SW5kZXggPSBuZXh0Q2VsbC5yb3dJbmRleDtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIHJvd3NwYW5zLlxuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSByb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgY2VsbHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbC5yb3dzcGFuID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDZWxscyBtYW5hZ2VkIGJ5IHRoaXMgY2VsbCB3aWxsIG5vdyBiZSBtYW5hZ2VkIGJ5IHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBjZWxsIGJlbG93IChvciBhYm92ZSBpZiB0aGVyZSBpcyBub25lIGJlbG93KSBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBiZWxvd0NlbGwgPSBBcnJheS5mcm9tKGNlbGwubWFuYWdlZENlbGxzKS5maW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlZENlbGwgPT4gbWFuYWdlZENlbGwucm93SW5kZXggPT09IG5leHRSb3dJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJlbG93Q2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmVsb3dDZWxsLnVubWVyZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWFuYWdlZENlbGwgb2YgY2VsbC5tYW5hZ2VkQ2VsbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFuYWdlZENlbGwgIT09IGJlbG93Q2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VkQ2VsbC5tZXJnZVdpdGgoYmVsb3dDZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFjZWxsLmlzQWN0aXZlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBjZWxsIGlzIGluYWN0aXZlLCB1bm1lcmdlIGl0IHNvIGl0cyBtYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvZXNuJ3QgYmVsaWV2ZSBpdCBzdGlsbCBtYW5hZ2VzIGl0LlxuICAgICAgICAgICAgICAgICAgICBjZWxsLnVubWVyZ2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHJvdy5cbiAgICAgICAgICAgIHJvdy5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy8gVGhlIHBsYWNlIHdoZXJlIHRoZSByYW5nZSB1c2VkIHRvIGxpdmUgd2FzIGp1c3QgZGVtb2xpc2hlZC4gR2l2ZVxuICAgICAgICAgICAgLy8gaXQgc2hlbHRlciB3aXRoaW4gdGhlIG5leHQgYWN0aXZlIGNlbGwuXG4gICAgICAgICAgICBjb25zdCBuZXh0QWN0aXZlQ2VsbCA9IG5leHRDZWxsLm1hbmFnZXJDZWxsIHx8IG5leHRDZWxsO1xuICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobmV4dEFjdGl2ZUNlbGwuZmlyc3RMZWFmKCksIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTtcbiAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBgbmV4dENlbGxgLCB3ZSdyZSB0cnlpbmcgdG8gZGVsZXRlIHRoZSBvbmx5IHJvdyBpblxuICAgICAgICAgICAgLy8gdGhpcyB0YWJsZSBzbyBqdXN0IHJlbW92ZSB0aGUgdGFibGUuXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVRhYmxlKHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSBjb2x1bW4gYXQgZ2l2ZW4gcmFuZ2Ugc3RhcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgZGVsZXRlQ29sdW1uKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxsID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICghY2VsbCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGNvbHVtbiA9IGNlbGwuY29sdW1uO1xuICAgICAgICBjb25zdCBuZXh0Q2VsbCA9IGNlbGwubmV4dFNpYmxpbmcoVGFibGVDZWxsTm9kZSkgfHwgY2VsbC5wcmV2aW91c1NpYmxpbmcoVGFibGVDZWxsTm9kZSk7XG5cbiAgICAgICAgaWYgKG5leHRDZWxsKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0Q29sdW1uSW5kZXggPSBuZXh0Q2VsbC5jb2x1bW5JbmRleDtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIGNvbHNwYW5zIGFuZCBjZWxsIHJlbW92YWwuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgY29sdW1uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNlbGwuY29sc3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2VsbHMgbWFuYWdlZCBieSB0aGlzIGNlbGwgd2lsbCBub3cgYmUgbWFuYWdlZCBieSB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gY2VsbCBhZnRlciAob3IgYmVmb3JlIGlmIHRoZXJlIGlzIG5vbmUgYWZ0ZXIpIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFmdGVyQ2VsbCA9IEFycmF5LmZyb20oY2VsbC5tYW5hZ2VkQ2VsbHMpLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VkQ2VsbCA9PiBtYW5hZ2VkQ2VsbC5jb2x1bW5JbmRleCA9PT0gbmV4dENvbHVtbkluZGV4LFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWZ0ZXJDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlckNlbGwudW5tZXJnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYW5hZ2VkQ2VsbCBvZiBjZWxsLm1hbmFnZWRDZWxscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5hZ2VkQ2VsbCAhPT0gYWZ0ZXJDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZWRDZWxsLm1lcmdlV2l0aChhZnRlckNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWNlbGwuaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGNlbGwgaXMgaW5hY3RpdmUsIHVubWVyZ2UgaXQgc28gaXRzIG1hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZG9lc24ndCBiZWxpZXZlIGl0IHN0aWxsIG1hbmFnZXMgaXQuXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudW5tZXJnZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGNlbGwuXG4gICAgICAgICAgICAgICAgY2VsbC5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vIFRoZSBwbGFjZSB3aGVyZSB0aGUgcmFuZ2UgdXNlZCB0byBsaXZlIHdhcyBqdXN0IGRlbW9saXNoZWQuXG4gICAgICAgICAgICAgICAgLy8gR2l2ZSBpdCBzaGVsdGVyIHdpdGhpbiB0aGUgbmV4dCBhY3RpdmUgY2VsbC5cbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0TWFuYWdlckNlbGwgPSBuZXh0Q2VsbC5tYW5hZ2VyQ2VsbCB8fCBuZXh0Q2VsbDtcbiAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChuZXh0TWFuYWdlckNlbGwuZmlyc3RMZWFmKCksIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTtcbiAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gYG5leHRDZWxsYCwgd2UncmUgdHJ5aW5nIHRvIGRlbGV0ZSB0aGUgb25seSBjb2x1bW5cbiAgICAgICAgICAgIC8vIGluIHRoaXMgdGFibGUgc28ganVzdCByZW1vdmUgdGhlIHRhYmxlLlxuICAgICAgICAgICAgdGhpcy5kZWxldGVUYWJsZShwYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZSB0aGUgdGFibGUgYXQgZ2l2ZW4gcmFuZ2Ugc3RhcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgZGVsZXRlVGFibGUocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IHRhYmxlID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVOb2RlKTtcbiAgICAgICAgaWYgKCF0YWJsZSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gdGFibGUubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgY29uc3QgcHJldmlvdXNTaWJsaW5nID0gdGFibGUucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIGlmIChuZXh0U2libGluZykge1xuICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobmV4dFNpYmxpbmcuZmlyc3RMZWFmKCksIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKTtcbiAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgICAgICByYW5nZS5zZXRTdGFydChwcmV2aW91c1NpYmxpbmcubGFzdExlYWYoKSwgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUik7XG4gICAgICAgICAgICByYW5nZS5jb2xsYXBzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRhYmxlLnJlbW92ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXJnZSB0aGUgY2VsbHMgYXQgZ2l2ZW4gcmFuZ2UgaW50byB0aGUgZmlyc3QgY2VsbCBhdCBnaXZlbiByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBtZXJnZUNlbGxzKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxscyA9IHJhbmdlLnRhcmdldGVkTm9kZXMoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICh0aGlzLl9pc1JlY3RhbmdsZShjZWxscykpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgbWVyZ2UgdGhlIGNlbGxzIGlmIHRoZXkgd291bGQgbm90IGltcGx5IHRvIG1lcmdlXG4gICAgICAgICAgICAvLyB1bnJlbGF0ZWQgY2VsbHMsIGllLiB0aGUgc2VsZWN0ZWQgY2VsbHMgZm9ybSBhIHJlY3RhbmdsZS5cbiAgICAgICAgICAgIGNvbnN0IG1hbmFnZXJDZWxsID0gY2VsbHMuc2hpZnQoKTtcbiAgICAgICAgICAgIGNvbnN0IFNlcGFyYXRvciA9IHRoaXMuZWRpdG9yLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMuU2VwYXJhdG9yO1xuICAgICAgICAgICAgZm9yIChjb25zdCBjZWxsIG9mIGNlbGxzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hbmFnZXJDZWxsLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFuYWdlckNlbGwuYXBwZW5kKG5ldyBTZXBhcmF0b3IoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNlbGwubWVyZ2VXaXRoKG1hbmFnZXJDZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbm1lcmdlIHByZXZpb3VzbHkgbWVyZ2VkIGNlbGxzIGF0IGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHVubWVyZ2VDZWxscyhwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgY2VsbHMgPSByYW5nZS50YXJnZXRlZE5vZGVzKFRhYmxlQ2VsbE5vZGUpO1xuICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgY2VsbHMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWFuYWdlZENlbGwgb2YgY2VsbC5tYW5hZ2VkQ2VsbHMpIHtcbiAgICAgICAgICAgICAgICBtYW5hZ2VkQ2VsbC51bm1lcmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBhcnJheSBvZiBjZWxscyBmb3JtcyBhIHJlY3RhbmdsZSBpbiB0aGUgdGFibGVcbiAgICAgKiBncmlkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNlbGxzXG4gICAgICovXG4gICAgX2lzUmVjdGFuZ2xlKGNlbGxzOiBUYWJsZUNlbGxOb2RlW10pOiBib29sZWFuIHtcbiAgICAgICAgY2VsbHMgPSBbLi4uY2VsbHNdO1xuXG4gICAgICAgIC8vIEFkZCBtYW5hZ2VkIGNlbGxzIHRvIHRoZSBsaXN0LlxuICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgWy4uLmNlbGxzXSkge1xuICAgICAgICAgICAgaWYgKGNlbGwubWFuYWdlZENlbGxzLnNpemUpIHtcbiAgICAgICAgICAgICAgICBjZWxscy5wdXNoKC4uLmNlbGwubWFuYWdlZENlbGxzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjZWxscyA9IGRpc3RpbmN0KGNlbGxzKTtcblxuICAgICAgICAvLyBDb21wdXRlIHRoZSByb3cvY29sdW1uIGluZGV4IGV4dHJlbWEuXG4gICAgICAgIGNvbnN0IHJvd0luZGljZXMgPSBjZWxscy5tYXAoY2VsbCA9PiBjZWxsLnJvd0luZGV4KTtcbiAgICAgICAgY29uc3QgY29sdW1uSW5kaWNlcyA9IGNlbGxzLm1hcChjZWxsID0+IGNlbGwuY29sdW1uSW5kZXgpO1xuICAgICAgICBjb25zdCBtaW5Sb3dJbmRleCA9IE1hdGgubWluKC4uLnJvd0luZGljZXMpO1xuICAgICAgICBjb25zdCBtaW5Db2x1bW5JbmRleCA9IE1hdGgubWluKC4uLmNvbHVtbkluZGljZXMpO1xuICAgICAgICBjb25zdCBtYXhSb3dJbmRleCA9IE1hdGgubWF4KC4uLnJvd0luZGljZXMpO1xuICAgICAgICBjb25zdCBtYXhDb2x1bW5JbmRleCA9IE1hdGgubWF4KC4uLmNvbHVtbkluZGljZXMpO1xuXG4gICAgICAgIC8vIElmIGEgY2VsbCBiZXR3ZWVuIHRoZSBleHRyZW1hIGNhbm5vdCBiZSBmb3VuZCBpbiB0aGUgbGlzdCwgdGhlXG4gICAgICAgIC8vIHNlbGVjdGVkIGNlbGxzIGRvIG5vdCBmb3JtIGEgcmVjdGFuZ2xlLlxuICAgICAgICBmb3IgKGxldCByb3dJbmRleCA9IG1pblJvd0luZGV4OyByb3dJbmRleCA8PSBtYXhSb3dJbmRleDsgcm93SW5kZXgrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgY29sdW1uSW5kZXggPSBtaW5Db2x1bW5JbmRleDsgY29sdW1uSW5kZXggPD0gbWF4Q29sdW1uSW5kZXg7IGNvbHVtbkluZGV4KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gY2VsbHMuZmluZChjZWxsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbGwucm93SW5kZXggPT09IHJvd0luZGV4ICYmIGNlbGwuY29sdW1uSW5kZXggPT09IGNvbHVtbkluZGV4O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghY2VsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgVGFibGVDZWxsTm9kZSB9IGZyb20gJy4vVGFibGVDZWxsTm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0TmF0aXZlLFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZSYW5nZSc7XG5pbXBvcnQgeyBUYWJsZSB9IGZyb20gJy4vVGFibGUnO1xuaW1wb3J0IHsgVGFibGVOb2RlIH0gZnJvbSAnLi9UYWJsZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVDZWxsRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFRhYmxlQ2VsbE5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIoY2VsbDogVGFibGVDZWxsTm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIC8vIElmIHRoZSBjZWxsIGlzIG5vdCBhY3RpdmUsIGRvIG5vdCByZW5kZXIgaXQgKGl0IG1lYW5zIGl0IGlzXG4gICAgICAgIC8vIHJlcHJlc2VudGVkIGJ5IGl0cyBtYW5hZ2VyIGNlbGwncyBjb2xzcGFuIG9yIHJvd3NwYW46IGl0IHdhcyBtZXJnZWQpLlxuICAgICAgICAvLyBUT0RPOiByZW1vdmUgYFRhYmxlTm9kZWAgY2hlY2s6IGl0J3MgYSB0ZW1wb3JhcnkgZml4IGZvciB0aGUgbWVtb3J5XG4gICAgICAgIC8vIHN5c3RlbSwgd2hpY2ggc2hvdWxkIG5vdCB0cnkgdG8gcmVuZGVyIHRoZSBjZWxsIGlmIGl0J3Mgbm90IGluIHRoZVxuICAgICAgICAvLyBWRG9jdW1lbnQuXG4gICAgICAgIGlmICghY2VsbC5pc0FjdGl2ZSgpIHx8ICFjZWxsLmFuY2VzdG9yKFRhYmxlTm9kZSkpIHJldHVybiB7IGNoaWxkcmVuOiBbXSB9O1xuXG4gICAgICAgIC8vIFJlbmRlciB0aGUgY2VsbCBhbmQgaXRzIGNvbnRlbnRzLlxuICAgICAgICBjb25zdCBkb21PYmplY3Q6IERvbU9iamVjdCA9IHtcbiAgICAgICAgICAgIHRhZzogY2VsbC5oZWFkZXIgPyAnVEgnIDogJ1REJyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBhd2FpdCB0aGlzLmVuZ2luZS5yZW5kZXJDaGlsZHJlbihjZWxsKSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHt9LFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENvbHNwYW4gYW5kIHJvd3NwYW4gYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkgZnJvbSBvdGhlciBhdHRyaWJ1dGVzOlxuICAgICAgICAvLyB0aGV5IGFyZSBhdXRvbWF0aWNhbGx5IGNhbGN1bGF0ZWQgaW4gZnVuY3Rpb24gb2YgdGhlIGNlbGwncyBtYW5hZ2VkXG4gICAgICAgIC8vIGNlbGxzLiBSZW5kZXIgdGhlbSBoZXJlLiBJZiB0aGVpciB2YWx1ZSBpcyAxIG9yIGxlc3MsIHRoZXkgYXJlXG4gICAgICAgIC8vIGluc2lnbmlmaWNhbnQgc28gbm8gbmVlZCB0byByZW5kZXIgdGhlbS5cbiAgICAgICAgaWYgKGNlbGwuY29sc3BhbiA+IDEpIHtcbiAgICAgICAgICAgIGRvbU9iamVjdC5hdHRyaWJ1dGVzLmNvbHNwYW4gPSBjZWxsLmNvbHNwYW4udG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5yb3dzcGFuID4gMSkge1xuICAgICAgICAgICAgZG9tT2JqZWN0LmF0dHJpYnV0ZXMucm93c3BhbiA9IGNlbGwucm93c3Bhbi50b1N0cmluZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGJ1dHRvbnMuXG4gICAgICAgIGNvbnN0IHRhYmxlID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KFRhYmxlKTtcbiAgICAgICAgaWYgKHRhYmxlLmlubGluZVVJICYmIHRoaXMuZW5naW5lLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2UuaXNJbihjZWxsKSkge1xuICAgICAgICAgICAgLy8gQWRkIHJvdyBiZWxvdy5cbiAgICAgICAgICAgIGNvbnN0IHJvd0JlbG93T2JqZWN0ID0gdGhpcy5fbWFrZUJ1dHRvbignYWRkUm93QmVsb3cnLCBjZWxsLCAnZmEtcGx1cy1zcXVhcmUnKTtcbiAgICAgICAgICAgIGRvbU9iamVjdC5jaGlsZHJlbi5wdXNoKHJvd0JlbG93T2JqZWN0KTtcbiAgICAgICAgICAgIC8vIERlbGV0ZSByb3cuXG4gICAgICAgICAgICBjb25zdCBkZWxldGVSb3dPYmplY3QgPSB0aGlzLl9tYWtlQnV0dG9uKCdkZWxldGVSb3cnLCBjZWxsLCAnZmEtbWludXMtc3F1YXJlJyk7XG4gICAgICAgICAgICBkb21PYmplY3QuY2hpbGRyZW4ucHVzaChkZWxldGVSb3dPYmplY3QpO1xuICAgICAgICAgICAgLy8gQWRkIHJvdyBhYm92ZS5cbiAgICAgICAgICAgIGNvbnN0IHJvd0Fib3ZlT2JqZWN0ID0gdGhpcy5fbWFrZUJ1dHRvbignYWRkUm93QWJvdmUnLCBjZWxsLCAnZmEtcGx1cy1zcXVhcmUnKTtcbiAgICAgICAgICAgIGRvbU9iamVjdC5jaGlsZHJlbi5wdXNoKHJvd0Fib3ZlT2JqZWN0KTtcblxuICAgICAgICAgICAgLy8gQWRkIGNvbHVtbiBiZWZvcmUuXG4gICAgICAgICAgICBjb25zdCBjb2x1bW5CZWZvcmVPYmplY3QgPSB0aGlzLl9tYWtlQnV0dG9uKCdhZGRDb2x1bW5CZWZvcmUnLCBjZWxsLCAnZmEtcGx1cy1zcXVhcmUnKTtcbiAgICAgICAgICAgIGRvbU9iamVjdC5jaGlsZHJlbi5wdXNoKGNvbHVtbkJlZm9yZU9iamVjdCk7XG4gICAgICAgICAgICAvLyBEZWxldGUgY29sdW1uLlxuICAgICAgICAgICAgY29uc3QgZGVsZXRlQ29sdW1uT2JqZWN0ID0gdGhpcy5fbWFrZUJ1dHRvbignZGVsZXRlQ29sdW1uJywgY2VsbCwgJ2ZhLW1pbnVzLXNxdWFyZScpO1xuICAgICAgICAgICAgZG9tT2JqZWN0LmNoaWxkcmVuLnB1c2goZGVsZXRlQ29sdW1uT2JqZWN0KTtcbiAgICAgICAgICAgIC8vIEFkZCBjb2x1bW4gYWZ0ZXIuXG4gICAgICAgICAgICBjb25zdCBjb2x1bW5BZnRlck9iamVjdCA9IHRoaXMuX21ha2VCdXR0b24oJ2FkZENvbHVtbkFmdGVyJywgY2VsbCwgJ2ZhLXBsdXMtc3F1YXJlJyk7XG4gICAgICAgICAgICBkb21PYmplY3QuY2hpbGRyZW4ucHVzaChjb2x1bW5BZnRlck9iamVjdCk7XG5cbiAgICAgICAgICAgIC8vIFBvc2l0aW9uIHRoZSBidXR0b25zLlxuICAgICAgICAgICAgZG9tT2JqZWN0LmF0dGFjaCA9IChkb21Ob2RlOiBFbGVtZW50KTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYm94ID0gZG9tTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRvcCA9IHdpbmRvdy5zY3JvbGxZICsgYm94LnRvcDtcbiAgICAgICAgICAgICAgICBjb25zdCBib3R0b20gPSB3aW5kb3cuc2Nyb2xsWSArIGJveC50b3AgKyBib3guaGVpZ2h0O1xuICAgICAgICAgICAgICAgIGNvbnN0IG1pZGRsZVggPSBib3gubGVmdCArIGJveC53aWR0aCAvIDI7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb25CdXR0b24ocm93QWJvdmVPYmplY3QsIHRvcCwgbWlkZGxlWCAtIDkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Bvc2l0aW9uQnV0dG9uKGRlbGV0ZVJvd09iamVjdCwgdG9wLCBtaWRkbGVYICsgOSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb25CdXR0b24ocm93QmVsb3dPYmplY3QsIGJvdHRvbSwgbWlkZGxlWCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtaWRkbGVZID0gd2luZG93LnNjcm9sbFkgKyBib3gudG9wICsgYm94LmhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVmdCA9IGJveC5sZWZ0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0ID0gYm94LmxlZnQgKyBib3gud2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb25CdXR0b24oY29sdW1uQmVmb3JlT2JqZWN0LCBtaWRkbGVZIC0gOSwgbGVmdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb25CdXR0b24oZGVsZXRlQ29sdW1uT2JqZWN0LCBtaWRkbGVZICsgOSwgbGVmdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zaXRpb25CdXR0b24oY29sdW1uQWZ0ZXJPYmplY3QsIG1pZGRsZVksIHJpZ2h0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU9iamVjdDtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIERvbU9iamVjdE5hdGl2ZSByZXByZXNlbnRpbmcgYSBidXR0b24gdGhhdCBleGVjdXRlcyB0aGUgZ2l2ZVxuICAgICAqIGNvbW1hbmQgd2l0aCBhIHJhbmdlIGF0IHRoZSBnaXZlbiByZWZlcmVuY2UgY2VsbC4gSWYgYHJlbW92ZWAgaXMgdHJ1ZSxcbiAgICAgKiBtYWtlIGEgXCJtaW51c1wiIGJ1dHRvbi4gT3RoZXJ3aXNlLCBtYWtlIGl0IGEgXCJwbHVzXCIgYnV0dG9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbW1hbmRJZFxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VDZWxsXG4gICAgICogQHBhcmFtIGZhQ2xhc3NcbiAgICAgKi9cbiAgICBfbWFrZUJ1dHRvbihjb21tYW5kSWQ6IHN0cmluZywgcmVmZXJlbmNlQ2VsbDogVGFibGVDZWxsTm9kZSwgZmFDbGFzczogc3RyaW5nKTogRG9tT2JqZWN0TmF0aXZlIHtcbiAgICAgICAgY29uc3Qgcm93QWJvdmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHJvd0Fib3ZlQnV0dG9uLmNsYXNzTmFtZSA9ICdmYSAnICsgZmFDbGFzcyArICcgZmEtZncgdGFibGUtaGFuZGxlcic7XG4gICAgICAgIGNvbnN0IHJvd0Fib3ZlT2JqZWN0OiBEb21PYmplY3ROYXRpdmUgPSB7IGRvbTogW3Jvd0Fib3ZlQnV0dG9uXSB9O1xuICAgICAgICBjb25zdCBjYWxsYmFjayA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+XG4gICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY1dpdGhSYW5nZShWUmFuZ2UuYXQocmVmZXJlbmNlQ2VsbCksIGNvbW1hbmRJZCk7XG4gICAgICAgIHJvd0Fib3ZlT2JqZWN0LmF0dGFjaCA9ICguLi5kb21Ob2RlczogTm9kZVtdKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByb3dBYm92ZU9iamVjdC5kZXRhY2ggPSAoLi4uZG9tTm9kZXM6IE5vZGVbXSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRvbU5vZGVzKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJvd0Fib3ZlT2JqZWN0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQb3NpdGlvbiB0aGUgYnV0dG9uIHJlcHJlc2VudGVkIGJ5IGEgRG9tT2JqZWN0TmF0aXZlIGF0IHRoZSBnaXZlbiB0b3AgYW5kXG4gICAgICogbGVmdCBjb29yZGluYXRlcywgdGFraW5nIGludG8gYWNjb3VudCB0aGUgZGltZW5zaW9ucyBvZiB0aGUgYnV0dG9uXG4gICAgICogaXRzZWxmLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJ1dHRvbk9iamVjdFxuICAgICAqIEBwYXJhbSB0b3BcbiAgICAgKiBAcGFyYW0gbGVmdFxuICAgICAqL1xuICAgIF9wb3NpdGlvbkJ1dHRvbihidXR0b25PYmplY3Q6IERvbU9iamVjdE5hdGl2ZSwgdG9wOiBudW1iZXIsIGxlZnQ6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBidXR0b25PYmplY3QuZG9tWzBdIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICBjb25zdCBidXR0b25Cb3ggPSBidXR0b24uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS50b3AgPSB0b3AgLSBidXR0b25Cb3guaGVpZ2h0IC8gMiArICdweCc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5sZWZ0ID0gbGVmdCAtIGJ1dHRvbkJveC53aWR0aCAvIDIgKyAncHgnO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcbmltcG9ydCB7IFRhYmxlUm93Tm9kZSB9IGZyb20gJy4vVGFibGVSb3dOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGVQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBUYWJsZUNlbGxOb2RlUGFyYW1zIGV4dGVuZHMgQWJzdHJhY3ROb2RlUGFyYW1zIHtcbiAgICBoZWFkZXI6IGJvb2xlYW47XG59XG5pbXBvcnQgeyBWZXJzaW9uYWJsZVNldCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZVNldCc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZUNlbGxOb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgYnJlYWthYmxlID0gZmFsc2U7XG4gICAgaGVhZGVyOiBib29sZWFuO1xuICAgIC8vIE9ubHkgdGhlIGBtYW5hZ2VyQ2VsbGAgc2V0dGVyIHNob3VsZCBtb2RpZnkgdGhlIGZvbGxvd2luZyBwcml2YXRlIGtleXMuXG4gICAgX19tYW5hZ2VyQ2VsbDogVGFibGVDZWxsTm9kZTtcbiAgICBfX21hbmFnZWRDZWxscyA9IG5ldyBWZXJzaW9uYWJsZVNldDxUYWJsZUNlbGxOb2RlPigpO1xuXG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogVGFibGVDZWxsTm9kZVBhcmFtcykge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLmhlYWRlciA9IHBhcmFtcz8uaGVhZGVyIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiAgQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgVGFibGVDZWxsTm9kZT5bMF0gPSB7XG4gICAgICAgICAgICBoZWFkZXI6IHRoaXMuaGVhZGVyLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoZGVlcENsb25lLCB7IC4uLmRlZmF1bHRzLCAuLi5wYXJhbXMgfSk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdldHRlcnNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgY29vcmRpbmF0ZXNSZXByID0gJyA8KCcgKyB0aGlzLnJvd0luZGV4ICsgJywgJyArIHRoaXMuY29sdW1uSW5kZXggKyAnKSc7XG4gICAgICAgIGlmICh0aGlzLmNvbHNwYW4gPiAxIHx8IHRoaXMucm93c3BhbiA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVuZFJvdyA9IHRoaXMucm93SW5kZXggKyB0aGlzLnJvd3NwYW4gLSAxO1xuICAgICAgICAgICAgY29uc3QgZW5kQ29sdW1uID0gdGhpcy5jb2x1bW5JbmRleCArIHRoaXMuY29sc3BhbiAtIDE7XG4gICAgICAgICAgICBjb29yZGluYXRlc1JlcHIgKz0gJzooJyArIGVuZFJvdyArICcsICcgKyBlbmRDb2x1bW4gKyAnKSc7XG4gICAgICAgIH1cbiAgICAgICAgY29vcmRpbmF0ZXNSZXByICs9ICc+JztcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHN1cGVyLm5hbWUgK1xuICAgICAgICAgICAgY29vcmRpbmF0ZXNSZXByICtcbiAgICAgICAgICAgICh0aGlzLmhlYWRlciA/ICc6IGhlYWRlcicgOiAnJykgK1xuICAgICAgICAgICAgKHRoaXMuaXNBY3RpdmUoKSA/ICcnIDogJyAoaW5hY3RpdmUpJylcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjZWxsIHRoYXQgbWFuYWdlcyB0aGlzIGNlbGwsIGlmIGFueS5cbiAgICAgKi9cbiAgICBnZXQgbWFuYWdlckNlbGwoKTogVGFibGVDZWxsTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9fbWFuYWdlckNlbGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgc2V0IG9mIGNlbGxzIHRoYXQgdGhpcyBjZWxsIG1hbmFnZXMuXG4gICAgICovXG4gICAgZ2V0IG1hbmFnZWRDZWxscygpOiBTZXQ8VGFibGVDZWxsTm9kZT4ge1xuICAgICAgICByZXR1cm4gbmV3IFNldCh0aGlzLl9fbWFuYWdlZENlbGxzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjb21wdXRlZCBjb2x1bW4gc3BhbiBvZiB0aGlzIGNlbGwsIGluIGZ1bmN0aW9uIG9mIGl0cyBtYW5hZ2VkXG4gICAgICogY2VsbHMuXG4gICAgICovXG4gICAgZ2V0IGNvbHNwYW4oKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgY2VsbHNBcnJheSA9IEFycmF5LmZyb20odGhpcy5tYW5hZ2VkQ2VsbHMpO1xuICAgICAgICBjb25zdCBzYW1lUm93Q2VsbHMgPSBjZWxsc0FycmF5LmZpbHRlcihjZWxsID0+IGNlbGwucm93SW5kZXggPT09IHRoaXMucm93SW5kZXgpO1xuICAgICAgICByZXR1cm4gMSArIHNhbWVSb3dDZWxscy5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgY29tcHV0ZWQgcm93IHNwYW4gb2YgdGhpcyBjZWxsLCBpbiBmdW5jdGlvbiBvZiBpdHMgbWFuYWdlZFxuICAgICAqIGNlbGxzLlxuICAgICAqL1xuICAgIGdldCByb3dzcGFuKCk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IGNlbGxzQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMubWFuYWdlZENlbGxzKTtcbiAgICAgICAgY29uc3Qgc2FtZUNvbHVtbkNlbGxzID0gY2VsbHNBcnJheS5maWx0ZXIoY2VsbCA9PiBjZWxsLmNvbHVtbkluZGV4ID09PSB0aGlzLmNvbHVtbkluZGV4KTtcbiAgICAgICAgcmV0dXJuIDEgKyBzYW1lQ29sdW1uQ2VsbHMubGVuZ3RoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHJvdyB0byB3aGljaCB0aGlzIGNlbGwgYmVsb25ncy5cbiAgICAgKi9cbiAgICBnZXQgcm93KCk6IFRhYmxlQ2VsbE5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKFRhYmxlUm93Tm9kZSkuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgY29sdW1uIHRvIHdoaWNoIHRoaXMgY2VsbCBiZWxvbmdzLCBhcyBhbiBhcnJheSBvZiBjZWxscy5cbiAgICAgKi9cbiAgICBnZXQgY29sdW1uKCk6IFRhYmxlQ2VsbE5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKFRhYmxlTm9kZSkuY29sdW1uc1t0aGlzLmNvbHVtbkluZGV4XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBpbmRleCBvZiB0aGUgcm93IHRvIHdoaWNoIHRoaXMgY2VsbCBiZWxvbmdzLlxuICAgICAqL1xuICAgIGdldCByb3dJbmRleCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5hbmNlc3RvcihUYWJsZVJvd05vZGUpLnJvd0luZGV4O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IG9mIHRoZSBjb2x1bW4gdG8gd2hpY2ggdGhpcyBjZWxsIGJlbG9uZ3MuXG4gICAgICovXG4gICAgZ2V0IGNvbHVtbkluZGV4KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKS5pbmRleE9mKHRoaXMpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGlzIGNlbGwgaXMgYWN0aXZlIChpZSBub3QgbWFuYWdlZCBieSBhbm90aGVyIGNlbGwpLlxuICAgICAqL1xuICAgIGlzQWN0aXZlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gIXRoaXMubWFuYWdlckNlbGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgZ2l2ZW4gY2VsbCBhcyBtYW5hZ2VyIG9mIHRoaXMgY2VsbC5cbiAgICAgKiBOb3RlOiBBIGNlbGwgbWFuYWdlZCBieSBhbm90aGVyIGNlbGwgYWxzbyBjb3BpZXMgaXRzIG1hbmFnZXIncyBhdHRyaWJ1dGVzXG4gICAgICogYW5kIHByb3BlcnRpZXMgYW5kIGhhbmRzIG92ZXIgaXRzIGNoaWxkcmVuIHRvIGl0cyBtYW5hZ2VyLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgbWVyZ2VXaXRoKG5ld01hbmFnZXI6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRoaXNUYWJsZSA9IHRoaXMuYW5jZXN0b3IoVGFibGVOb2RlKTtcbiAgICAgICAgY29uc3Qgb3RoZXJUYWJsZSA9IG5ld01hbmFnZXIuYW5jZXN0b3IoVGFibGVOb2RlKTtcbiAgICAgICAgaWYgKCEobmV3TWFuYWdlciBpbnN0YW5jZW9mIFRhYmxlQ2VsbE5vZGUpIHx8IHRoaXNUYWJsZSAhPT0gb3RoZXJUYWJsZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuX19tYW5hZ2VyQ2VsbCA9IG5ld01hbmFnZXI7XG4gICAgICAgIG5ld01hbmFnZXIubWFuYWdlKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbm1lcmdlIHRoaXMgY2VsbCBmcm9tIGl0cyBtYW5hZ2VyLlxuICAgICAqL1xuICAgIHVubWVyZ2UoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLl9fbWFuYWdlckNlbGw7XG4gICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9fbWFuYWdlckNlbGwgPSBudWxsO1xuICAgICAgICAgICAgLy8gSWYgd2UganVzdCByZW1vdmVkIHRoaXMgY2VsbCdzIG1hbmFnZXIsIGFsc28gcmVtb3ZlIHRoaXMgY2VsbFxuICAgICAgICAgICAgLy8gZnJvbSB0aGUgb2xkIG1hbmFnZXIncyBtYW5hZ2VkIGNlbGxzLlxuICAgICAgICAgICAgbWFuYWdlci51bm1hbmFnZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGdpdmVuIGNlbGwgYXMgbWFuYWdlZCBieSB0aGlzIGNlbGwuXG4gICAgICogTm90ZTogQSBjZWxsIG1hbmFnZWQgYnkgYW5vdGhlciBjZWxsIGFsc28gY29waWVzIGl0cyBtYW5hZ2VyJ3MgbW9kaWZpZXJzXG4gICAgICogYW5kIHByb3BlcnRpZXMgYW5kIGhhbmRzIG92ZXIgaXRzIGNoaWxkcmVuIHRvIGl0cyBtYW5hZ2VyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNlbGxcbiAgICAgKi9cbiAgICBtYW5hZ2UoY2VsbDogVGFibGVDZWxsTm9kZSk6IHZvaWQge1xuICAgICAgICB0aGlzLl9fbWFuYWdlZENlbGxzLmFkZChjZWxsKTtcblxuICAgICAgICAvLyBDb3B5IHRoZSBtYW5hZ2VyJ3MgbW9kaWZpZXJzIGFuZCBwcm9wZXJ0aWVzLlxuICAgICAgICBjZWxsLm1vZGlmaWVycyA9IHRoaXMubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgIGNlbGwuaGVhZGVyID0gdGhpcy5oZWFkZXI7XG5cbiAgICAgICAgLy8gTW92ZSB0aGUgY2hpbGRyZW4gdG8gdGhlIG1hbmFnZXIuXG4gICAgICAgIHRoaXMuYXBwZW5kKC4uLmNlbGwuY2hpbGRWTm9kZXMpO1xuXG4gICAgICAgIC8vIEhhbmQgdGhlIG1hbmFnZWQgY2VsbHMgb3ZlciB0byB0aGUgbWFuYWdlci5cbiAgICAgICAgZm9yIChjb25zdCBtYW5hZ2VkQ2VsbCBvZiBjZWxsLm1hbmFnZWRDZWxscykge1xuICAgICAgICAgICAgbWFuYWdlZENlbGwubWVyZ2VXaXRoKHRoaXMpO1xuICAgICAgICAgICAgY2VsbC51bm1hbmFnZShtYW5hZ2VkQ2VsbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb3B5IHRoZSBtYW5hZ2VyJ3Mgcm93IGlmIGFuIGVudGlyZSByb3cgd2FzIG1lcmdlZFxuICAgICAgICBjb25zdCByb3cgPSBjZWxsLmFuY2VzdG9yKFRhYmxlUm93Tm9kZSk7XG4gICAgICAgIGlmIChyb3cpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gcm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpO1xuICAgICAgICAgICAgY29uc3Qgcm93SXNNZXJnZWQgPSBjZWxscy5ldmVyeShyb3dDZWxsID0+IHJvd0NlbGwubWFuYWdlckNlbGwgPT09IHRoaXMpO1xuICAgICAgICAgICAgaWYgKHJvd0lzTWVyZ2VkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlclJvdyA9IGNlbGwubWFuYWdlckNlbGwuYW5jZXN0b3IoVGFibGVSb3dOb2RlKTtcbiAgICAgICAgICAgICAgICByb3cuaGVhZGVyID0gbWFuYWdlclJvdy5oZWFkZXI7XG4gICAgICAgICAgICAgICAgcm93Lm1vZGlmaWVycyA9IG1hbmFnZXJSb3cubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgcmVjaXByb2NpdHkuXG4gICAgICAgIGlmIChjZWxsLm1hbmFnZXJDZWxsICE9PSB0aGlzKSB7XG4gICAgICAgICAgICBjZWxsLm1lcmdlV2l0aCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXN0b3JlIHRoZSBpbmRlcGVuZGVuY2Ugb2YgdGhlIGdpdmVuIGNlbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2VsbFxuICAgICAqL1xuICAgIHVubWFuYWdlKGNlbGw6IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fX21hbmFnZWRDZWxscy5kZWxldGUoY2VsbCk7XG5cbiAgICAgICAgLy8gRW5zdXJlIHJlY2lwcm9jaXR5LlxuICAgICAgICBpZiAoY2VsbC5tYW5hZ2VyQ2VsbCA9PT0gdGhpcykge1xuICAgICAgICAgICAgY2VsbC51bm1lcmdlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVDZWxsWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBpdGVtIGlzIEhUTUxUYWJsZUNlbGxFbGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IG5vZGVOYW1lKGl0ZW0pO1xuICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ1REJyB8fCBuYW1lID09PSAnVEgnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHRhYmxlIGNlbGwgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogSFRNTFRhYmxlQ2VsbEVsZW1lbnQpOiBQcm9taXNlPFRhYmxlQ2VsbE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gbmV3IFRhYmxlQ2VsbE5vZGUoeyBoZWFkZXI6IG5vZGVOYW1lKGl0ZW0pID09PSAnVEgnIH0pO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNlbGwubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIGNlbGwuYXBwZW5kKC4uLmNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIFtjZWxsXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZU5vZGUgfSBmcm9tICcuL1RhYmxlTm9kZSc7XG5pbXBvcnQgeyBUYWJsZVJvd05vZGUgfSBmcm9tICcuL1RhYmxlUm93Tm9kZSc7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVTZWN0aW9uQXR0cmlidXRlcyB9IGZyb20gJy4vVGFibGVSb3dYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lV29ya2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZURvbU9iamVjdFJlbmRlcmVyIGV4dGVuZHMgTm9kZVJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBUYWJsZU5vZGU7XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIFRhYmxlTm9kZSBhbG9uZyB3aXRoIGl0cyBjb250ZW50cyAoVGFibGVSb3dOb2RlcykuXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKHRhYmxlOiBUYWJsZU5vZGUsIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPERvbU9iamVjdD4pOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBvYmplY3RUYWJsZTogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnVEFCTEUnLFxuICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBvYmplY3RIZWFkOiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdUSEVBRCcsXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgIH07XG4gICAgICAgIGxldCBvYmplY3RCb2R5OiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdUQk9EWScsXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiB0YWJsZS5jaGlsZHJlbigpKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBUYWJsZVJvd05vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY2hpbGQgaXMgYSByb3csIGFwcGVuZCBpdCB0byBpdHMgY29udGFpbmluZyBzZWN0aW9uLlxuICAgICAgICAgICAgICAgIGNvbnN0IHRhYmxlU2VjdGlvbiA9IGNoaWxkLmhlYWRlciA/IG9iamVjdEhlYWQgOiBvYmplY3RCb2R5O1xuICAgICAgICAgICAgICAgIHRhYmxlU2VjdGlvbi5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5yZW5kZXJBdHRyaWJ1dGVzKFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXMsIGNoaWxkLCB0YWJsZVNlY3Rpb24sIHdvcmtlcik7XG4gICAgICAgICAgICAgICAgaWYgKCFvYmplY3RUYWJsZS5jaGlsZHJlbi5pbmNsdWRlcyh0YWJsZVNlY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdFRhYmxlLmNoaWxkcmVuLnB1c2godGFibGVTZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9iamVjdFRhYmxlLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyA8dGJvZHk+IHNvIHRoZSByZXN0IG9mIHRoZSByb3dzLCBpZiBhbnksIGdldFxuICAgICAgICAgICAgICAgIC8vIGFwcGVuZGVkIHRvIGl0LCBhZnRlciB0aGlzIGVsZW1lbnQuXG4gICAgICAgICAgICAgICAgb2JqZWN0Qm9keSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnOiAnVEJPRFknLFxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0VGFibGU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgVGFibGVDZWxsTm9kZSB9IGZyb20gJy4vVGFibGVDZWxsTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZU5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgYnJlYWthYmxlID0gZmFsc2U7XG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogeyByb3dDb3VudD86IG51bWJlcjsgY29sdW1uQ291bnQ/OiBudW1iZXIgfSkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdUQUJMRScgfSk7XG4gICAgICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLnJvd0NvdW50ICYmIHBhcmFtcy5jb2x1bW5Db3VudCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldChwYXJhbXMucm93Q291bnQsIHBhcmFtcy5jb2x1bW5Db3VudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR2V0dGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBzdXBlci5uYW1lICsgJzogJyArIHRoaXMucm93Q291bnQgKyAneCcgKyB0aGlzLmNvbHVtbkNvdW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2Ygcm93cyBpbiB0aGlzIHRhYmxlLCBhcyBhcnJheXMgb2YgY2VsbHMuXG4gICAgICovXG4gICAgZ2V0IHJvd3MoKTogVGFibGVDZWxsTm9kZVtdW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbihUYWJsZVJvd05vZGUpLm1hcChyb3cgPT4gcm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIGFycmF5IG9mIGNvbHVtbnMgaW4gdGhpcyB0YWJsZSwgYXMgYXJyYXlzIG9mIGNlbGxzLlxuICAgICAqL1xuICAgIGdldCBjb2x1bW5zKCk6IFRhYmxlQ2VsbE5vZGVbXVtdIHtcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IG5ldyBBcnJheSh0aGlzLmNvbHVtbkNvdW50KS5maWxsKHVuZGVmaW5lZCk7XG4gICAgICAgIHJldHVybiBjb2x1bW5zLm1hcCgoXywgY29sdW1uSW5kZXgpID0+XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuKFRhYmxlUm93Tm9kZSkubWFwKHJvdyA9PiByb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSlbY29sdW1uSW5kZXhdKSxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2Ygcm93cyBpbiB0aGlzIHRhYmxlLlxuICAgICAqL1xuICAgIGdldCByb3dDb3VudCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbihUYWJsZVJvd05vZGUpLmxlbmd0aDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgY29sdW1ucyBpbiB0aGlzIHRhYmxlLlxuICAgICAqL1xuICAgIGdldCBjb2x1bW5Db3VudCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5maXJzdENoaWxkKFRhYmxlUm93Tm9kZSkuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSkubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNlbGwgb2YgdGhpcyB0YWJsZSB0aGF0IGNhbiBiZSBmb3VuZCBhdCB0aGUgZ2l2ZW4gY29vcmRpbmF0ZXMsXG4gICAgICogaWYgYW55LlxuICAgICAqXG4gICAgICogQHBhcmFtIHJvd0luZGV4XG4gICAgICogQHBhcmFtIGNvbHVtbkluZGV4XG4gICAgICovXG4gICAgZ2V0Q2VsbEF0KHJvd0luZGV4OiBudW1iZXIsIGNvbHVtbkluZGV4OiBudW1iZXIpOiBUYWJsZUNlbGxOb2RlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4oVGFibGVSb3dOb2RlKVtyb3dJbmRleF0uY2hpbGRyZW4oVGFibGVDZWxsTm9kZSlbY29sdW1uSW5kZXhdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSBuZXcgcm93IGFib3ZlIHRoZSByZWZlcmVuY2Ugcm93ICh0aGUgcm93IG9mIHRoZSBnaXZlbiByZWZlcmVuY2VcbiAgICAgKiBjZWxsKS4gQ29weSB0aGUgc3R5bGVzIGFuZCBjb2xzcGFucyBvZiB0aGUgY2VsbHMgb2YgdGhlIHJlZmVyZW5jZSByb3cuIElmXG4gICAgICogdGhlIHJlZmVyZW5jZSByb3cgdHJhdmVyc2VzIGEgcm93c3BhbiwgZXh0ZW5kIHRoYXQgcm93c3Bhbi5cbiAgICAgKiBJZiBubyBgcmVmZXJlbmNlQ2VsbGAgd2FzIHBhc3NlZCwgYWRkIGEgcm93IG9uIHRvcCBvZiB0aGUgdGFibGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3JlZmVyZW5jZUNlbGxdXG4gICAgICovXG4gICAgYWRkUm93QWJvdmUocmVmZXJlbmNlQ2VsbD86IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCFyZWZlcmVuY2VDZWxsKSB7XG4gICAgICAgICAgICByZWZlcmVuY2VDZWxsID0gdGhpcy5maXJzdERlc2NlbmRhbnQoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVmZXJlbmNlUm93ID0gcmVmZXJlbmNlQ2VsbC5hbmNlc3RvcihUYWJsZVJvd05vZGUpO1xuICAgICAgICBjb25zdCBuZXdSb3cgPSByZWZlcmVuY2VSb3cuY2xvbmUoKTtcbiAgICAgICAgcmVmZXJlbmNlUm93LmJlZm9yZShuZXdSb3cpO1xuICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgcmVmZXJlbmNlUm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9uZSA9IGNlbGwuY2xvbmUoKTtcbiAgICAgICAgICAgIG5ld1Jvdy5hcHBlbmQoY2xvbmUpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgbWFuYWdlcnMuXG4gICAgICAgICAgICBjb25zdCBtYW5hZ2VyID0gY2VsbC5tYW5hZ2VyQ2VsbDtcbiAgICAgICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hbmFnZXIucm93SW5kZXggPT09IHJlZmVyZW5jZVJvdy5yb3dJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBjZWxsJ3MgbWFuYWdlciBpcyBpbiB0aGUgcmVmZXJlbmNlIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsb25lJ3MgbWFuYWdlciBzaG91bGQgYmUgdGhhdCBtYW5hZ2VyJ3MgY2xvbmUuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hbmFnZXJDbG9uZSA9IHRoaXMuZ2V0Q2VsbEF0KG5ld1Jvdy5yb3dJbmRleCwgbWFuYWdlci5jb2x1bW5JbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyQ2xvbmUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgbmV3IHJvdyBiZWxvdyB0aGUgcmVmZXJlbmNlIHJvdyAodGhlIHJvdyBvZiB0aGUgZ2l2ZW4gcmVmZXJlbmNlXG4gICAgICogY2VsbCkuIENvcHkgdGhlIHN0eWxlcyBhbmQgY29sc3BhbnMgb2YgdGhlIGNlbGxzIG9mIHRoZSByZWZlcmVuY2Ugcm93LiBJZlxuICAgICAqIHRoZSByZWZlcmVuY2Ugcm93IHRyYXZlcnNlcyBhIHJvd3NwYW4sIGV4dGVuZCB0aGF0IHJvd3NwYW4uXG4gICAgICogSWYgbm8gYHJlZmVyZW5jZUNlbGxgIHdhcyBwYXNzZWQsIGFkZCBhIHJvdyBhdCB0aGUgYm90dG9tIG9mIHRoZSB0YWJsZS5cbiAgICAgKiBOb3RlOiBhIHJvd3NwYW4gZW5kaW5nIGF0IHRoZSByZWZlcmVuY2UgY2VsbCBpcyBub3QgZXh0ZW5kZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3JlZmVyZW5jZUNlbGxdXG4gICAgICovXG4gICAgYWRkUm93QmVsb3cocmVmZXJlbmNlQ2VsbD86IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCFyZWZlcmVuY2VDZWxsKSB7XG4gICAgICAgICAgICByZWZlcmVuY2VDZWxsID0gdGhpcy5sYXN0RGVzY2VuZGFudChUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByb3dJbmRleCA9IHJlZmVyZW5jZUNlbGwucm93SW5kZXggKyByZWZlcmVuY2VDZWxsLnJvd3NwYW4gLSAxO1xuICAgICAgICBjb25zdCByZWZlcmVuY2VSb3cgPSB0aGlzLmNoaWxkcmVuKFRhYmxlUm93Tm9kZSlbcm93SW5kZXhdO1xuICAgICAgICBjb25zdCBuZXdSb3cgPSByZWZlcmVuY2VSb3cuY2xvbmUoKTtcbiAgICAgICAgcmVmZXJlbmNlUm93LmFmdGVyKG5ld1Jvdyk7XG4gICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiByZWZlcmVuY2VSb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsb25lID0gY2VsbC5jbG9uZSgpO1xuICAgICAgICAgICAgbmV3Um93LmFwcGVuZChjbG9uZSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBtYW5hZ2Vycy5cbiAgICAgICAgICAgIGlmIChjZWxsLm1hbmFnZXJDZWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlciA9IGNlbGwubWFuYWdlckNlbGw7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlckVuZFJvdyA9IG1hbmFnZXIucm93SW5kZXggKyBtYW5hZ2VyLnJvd3NwYW4gLSAxO1xuICAgICAgICAgICAgICAgIGlmIChtYW5hZ2VyRW5kUm93ID09PSByb3dJbmRleCAmJiBtYW5hZ2VyLmNvbHVtbkluZGV4ICE9PSBjZWxsLmNvbHVtbkluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRha2UgdGhlIG5ldyByb3cgZXF1aXZhbGVudCBvZiB0aGUgYWJvdmUgY2VsbCdzIG1hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gKGNvcHkgY29sc3BhbikuXG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aCh0aGlzLmdldENlbGxBdChuZXdSb3cucm93SW5kZXgsIG1hbmFnZXIuY29sdW1uSW5kZXgpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hbmFnZXJFbmRSb3cgIT09IHJvd0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRha2UgdGhlIG1hbmFnZXIgY2VsbCBvZiB0aGUgYWJvdmUgY2VsbCAoZXh0ZW5kIHJvd3NwYW4pLFxuICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGlmIHNhaWQgbWFuYWdlcidzIHJvd3NwYW4gaXMgbm90IGVuZGluZyB3aXRoIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBhYm92ZSBjZWxsLlxuICAgICAgICAgICAgICAgICAgICBjbG9uZS5tZXJnZVdpdGgobWFuYWdlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChjZWxsLnJvd3NwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGNlbGwgaGFzIGEgcm93c3BhbiwgZXh0ZW5kIGl0LlxuICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChjZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSBuZXcgY29sdW1uIGJlZm9yZSB0aGUgcmVmZXJlbmNlIGNvbHVtbiAodGhlIGNvbHVtbiBvZiB0aGUgZ2l2ZW5cbiAgICAgKiByZWZlcmVuY2UgY2VsbCkuIENvcHkgdGhlIHN0eWxlcyBhbmQgcm93c3BhbnMgb2YgdGhlIGNlbGxzIG9mIHRoZVxuICAgICAqIHJlZmVyZW5jZSBjb2x1bW4uIElmIHRoZSByZWZlcmVuY2UgY29sdW1uIHRyYXZlcnNlcyBhIGNvbHNwYW4sIGV4dGVuZFxuICAgICAqIHRoYXQgY29sc3Bhbi5cbiAgICAgKiBJZiBubyBgcmVmZXJlbmNlQ2VsbGAgd2FzIHBhc3NlZCwgYWRkIGEgY29sdW1uIHRvIHRoZSBsZWZ0IG9mIHRoZSB0YWJsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcmVmZXJlbmNlQ2VsbF1cbiAgICAgKi9cbiAgICBhZGRDb2x1bW5CZWZvcmUocmVmZXJlbmNlQ2VsbD86IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCFyZWZlcmVuY2VDZWxsKSB7XG4gICAgICAgICAgICByZWZlcmVuY2VDZWxsID0gdGhpcy5maXJzdERlc2NlbmRhbnQoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVmZXJlbmNlQ29sdW1uID0gcmVmZXJlbmNlQ2VsbC5jb2x1bW47XG4gICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiByZWZlcmVuY2VDb2x1bW4pIHtcbiAgICAgICAgICAgIGNvbnN0IGNsb25lID0gY2VsbC5jbG9uZSgpO1xuICAgICAgICAgICAgY2VsbC5iZWZvcmUoY2xvbmUpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgbWFuYWdlcnMuXG4gICAgICAgICAgICBjb25zdCBtYW5hZ2VyID0gY2VsbC5tYW5hZ2VyQ2VsbDtcbiAgICAgICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hbmFnZXIuY29sdW1uSW5kZXggPT09IHJlZmVyZW5jZUNlbGwuY29sdW1uSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgY2VsbCdzIG1hbmFnZXIgaXMgaW4gdGhlIHJlZmVyZW5jZSBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjbG9uZSdzIG1hbmFnZXIgc2hvdWxkIGJlIHRoYXQgbWFuYWdlcidzIGNsb25lLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYW5hZ2VyQ2xvbmUgPSB0aGlzLmdldENlbGxBdChtYW5hZ2VyLnJvd0luZGV4LCBjbG9uZS5jb2x1bW5JbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyQ2xvbmUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgbmV3IGNvbHVtbiBhZnRlciB0aGUgcmVmZXJlbmNlIGNvbHVtbiAodGhlIGNvbHVtbiBvZiB0aGUgZ2l2ZW5cbiAgICAgKiByZWZlcmVuY2UgY2VsbCkuIENvcHkgdGhlIHN0eWxlcyBhbmQgcm93c3BhbnMgb2YgdGhlIGNlbGxzIG9mIHRoZVxuICAgICAqIHJlZmVyZW5jZSBjb2x1bW4uIElmIHRoZSByZWZlcmVuY2UgY29sdW1uIHRyYXZlcnNlcyBhIGNvbHBhbiwgZXh0ZW5kIHRoYXRcbiAgICAgKiBjb2xzcGFuLlxuICAgICAqIElmIG5vIGByZWZlcmVuY2VDZWxsYCB3YXMgcGFzc2VkLCBhZGQgYSBjb2x1bW4gdG8gdGhlIHJpZ2h0IG9mIHRoZSB0YWJsZS5cbiAgICAgKiBOb3RlOiBhIGNvbHNwYW4gZW5kaW5nIGF0IHRoZSByZWZlcmVuY2UgY2VsbCBpcyBub3QgZXh0ZW5kZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3JlZmVyZW5jZUNlbGxdXG4gICAgICovXG4gICAgYWRkQ29sdW1uQWZ0ZXIocmVmZXJlbmNlQ2VsbD86IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCFyZWZlcmVuY2VDZWxsKSB7XG4gICAgICAgICAgICByZWZlcmVuY2VDZWxsID0gdGhpcy5sYXN0RGVzY2VuZGFudChUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb2x1bW5JbmRleCA9IHJlZmVyZW5jZUNlbGwuY29sdW1uSW5kZXggKyByZWZlcmVuY2VDZWxsLmNvbHNwYW4gLSAxO1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb2x1bW4gPSB0aGlzLmNvbHVtbnNbY29sdW1uSW5kZXhdO1xuICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgcmVmZXJlbmNlQ29sdW1uKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9uZSA9IGNlbGwuY2xvbmUoKTtcbiAgICAgICAgICAgIGNlbGwuYWZ0ZXIoY2xvbmUpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgbWFuYWdlcnMuXG4gICAgICAgICAgICBpZiAoY2VsbC5tYW5hZ2VyQ2VsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hbmFnZXIgPSBjZWxsLm1hbmFnZXJDZWxsO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hbmFnZXJFbmRDb2x1bW4gPSBtYW5hZ2VyLmNvbHVtbkluZGV4ICsgbWFuYWdlci5jb2xzcGFuIC0gMTtcbiAgICAgICAgICAgICAgICBpZiAobWFuYWdlckVuZENvbHVtbiA9PT0gY29sdW1uSW5kZXggJiYgbWFuYWdlci5yb3dJbmRleCAhPT0gY2VsbC5yb3dJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUYWtlIHRoZSBuZXcgY29sdW1uIGVxdWl2YWxlbnQgb2YgdGhlIHByZXZpb3VzIGNlbGwnc1xuICAgICAgICAgICAgICAgICAgICAvLyBtYW5hZ2VyIChjb3B5IHJvd3NwYW4pLlxuICAgICAgICAgICAgICAgICAgICBjbG9uZS5tZXJnZVdpdGgodGhpcy5nZXRDZWxsQXQobWFuYWdlci5yb3dJbmRleCwgY2xvbmUuY29sdW1uSW5kZXgpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hbmFnZXJFbmRDb2x1bW4gIT09IGNvbHVtbkluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRha2UgdGhlIG1hbmFnZXIgY2VsbCBvZiB0aGUgcHJldmlvdXMgY2VsbCAoZXh0ZW5kXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbHNwYW4pLCBvbmx5IGlmIHNhaWQgbWFuYWdlcidzIGNvbHNwYW4gaXMgbm90IGVuZGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIHRoZSBwcmV2aW91cyBjZWxsLlxuICAgICAgICAgICAgICAgICAgICBjbG9uZS5tZXJnZVdpdGgobWFuYWdlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChjZWxsLmNvbHNwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGNlbGwgaGFzIGEgY29sc3BhbiwgZXh0ZW5kIGl0LlxuICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChjZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbXB0eSB0aGlzIHRhYmxlIGFuZCByZWZpbGwgaXQgd2l0aCB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHJvd3MgYW5kIGNvbHVtbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcm93Q291bnRcbiAgICAgKiBAcGFyYW0gY29sdW1uQ291bnRcbiAgICAgKi9cbiAgICByZXNldChyb3dDb3VudDogbnVtYmVyLCBjb2x1bW5Db3VudDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW1wdHkoKTtcbiAgICAgICAgY29uc3Qgcm93czogVGFibGVSb3dOb2RlW10gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgcm93TnVtYmVyID0gMDsgcm93TnVtYmVyIDwgcm93Q291bnQ7IHJvd051bWJlciArPSAxKSB7XG4gICAgICAgICAgICByb3dzLnB1c2gobmV3IFRhYmxlUm93Tm9kZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgICAgICBjb25zdCBjZWxsczogVGFibGVDZWxsTm9kZVtdID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBjb2xOdW1iZXIgPSAwOyBjb2xOdW1iZXIgPCBjb2x1bW5Db3VudDsgY29sTnVtYmVyICs9IDEpIHtcbiAgICAgICAgICAgICAgICBjZWxscy5wdXNoKG5ldyBUYWJsZUNlbGxOb2RlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93LmFwcGVuZCguLi5jZWxscyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hcHBlbmQoLi4ucm93cyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdEVsZW1lbnQsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVDZWxsTm9kZSB9IGZyb20gJy4vVGFibGVDZWxsTm9kZSc7XG5pbXBvcnQgeyBUYWJsZU5vZGUgfSBmcm9tICcuL1RhYmxlTm9kZSc7XG5pbXBvcnQgeyBUYWJsZVJvd05vZGUgfSBmcm9tICcuL1RhYmxlUm93Tm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBUYWJsZSB9IGZyb20gJy4vVGFibGUnO1xuaW1wb3J0IHsgVGFibGVQaWNrZXJOb2RlIH0gZnJvbSAnLi9UYWJsZVBpY2tlck5vZGUnO1xuaW1wb3J0IHsgUmVuZGVyaW5nRW5naW5lV29ya2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJpbmdFbmdpbmVDYWNoZSc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVBpY2tlckNlbGxEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PlxuICAgICAgICBub2RlIGluc3RhbmNlb2YgVGFibGVDZWxsTm9kZSAmJiBub2RlLnBhcmVudD8ucGFyZW50IGluc3RhbmNlb2YgVGFibGVQaWNrZXJOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKFxuICAgICAgICB0YWJsZVBpY2tlckNlbGw6IFRhYmxlQ2VsbE5vZGUsXG4gICAgICAgIHdvcmtlcjogUmVuZGVyaW5nRW5naW5lV29ya2VyPERvbU9iamVjdD4sXG4gICAgKTogUHJvbWlzZTxEb21PYmplY3RFbGVtZW50PiB7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdCA9IChhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcih0YWJsZVBpY2tlckNlbGwsIHdvcmtlcikpIGFzIERvbU9iamVjdEVsZW1lbnQ7XG4gICAgICAgIGRvbU9iamVjdC5hdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgLi4uZG9tT2JqZWN0LmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAuLi57XG4gICAgICAgICAgICAgICAgJ2RhdGEtcm93Q291bnQnOiAnJyArICh0YWJsZVBpY2tlckNlbGwucm93SW5kZXggKyAxKSxcbiAgICAgICAgICAgICAgICAnZGF0YS1jb2x1bW5Db3VudCc6ICcnICsgKHRhYmxlUGlja2VyQ2VsbC5jb2x1bW5JbmRleCArIDEpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdGFibGVQbHVnaW4gPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoVGFibGUpO1xuICAgICAgICBjb25zdCBtaW5Sb3dDb3VudCA9IHRhYmxlUGx1Z2luLm1pblJvd0NvdW50O1xuICAgICAgICBjb25zdCBtaW5Db2x1bW5Db3VudCA9IHRhYmxlUGx1Z2luLm1pbkNvbHVtbkNvdW50O1xuXG4gICAgICAgIGNvbnN0IG9uTW91c2VPdmVyID0gKGV2OiBFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFibGUgPSAoZXYudGFyZ2V0IGFzIEhUTUxUYWJsZUNlbGxFbGVtZW50KS5jbG9zZXN0KCd0YWJsZS50YWJsZS1waWNrZXInKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCcpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm93SW5kZXggPSArY2VsbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm93Q291bnQnKSAtIDE7XG4gICAgICAgICAgICAgICAgY29uc3QgY29sdW1uSW5kZXggPSArY2VsbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sdW1uQ291bnQnKSAtIDE7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICByb3dJbmRleCA8PSB0YWJsZVBpY2tlckNlbGwucm93SW5kZXggJiZcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPD0gdGFibGVQaWNrZXJDZWxsLmNvbHVtbkluZGV4XG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0YWJsZVBpY2tlciA9IHRhYmxlUGlja2VyQ2VsbC5hbmNlc3RvcihUYWJsZU5vZGUpO1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIHRhYmxlUGlja2VyQ2VsbC5yb3dJbmRleCA+PSB0YWJsZVBpY2tlci5yb3dDb3VudCAtIDEgfHxcbiAgICAgICAgICAgICAgICB0YWJsZVBpY2tlci5yb3dDb3VudCA+IG1pblJvd0NvdW50IHx8XG4gICAgICAgICAgICAgICAgdGFibGVQaWNrZXJDZWxsLmNvbHVtbkluZGV4ID49IHRhYmxlUGlja2VyLmNvbHVtbkNvdW50IC0gMSB8fFxuICAgICAgICAgICAgICAgIHRhYmxlUGlja2VyLmNvbHVtbkNvdW50ID4gbWluQ29sdW1uQ291bnRcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5tZW1vcnlJbmZvLnVpQ29tbWFuZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9SZWRyYXcgPSBuZXcgU2V0PFZOb2RlPigpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBZGQvcmVtb3ZlIHJvd3MuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZVBpY2tlckNlbGwucm93SW5kZXggPj0gdGFibGVQaWNrZXIucm93Q291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdSb3cgPSBuZXcgVGFibGVSb3dOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b1JlZHJhdy5hZGQobmV3Um93KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlUGlja2VyLmFwcGVuZChuZXdSb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY2VsbEluZGV4ID0gMDsgY2VsbEluZGV4IDwgdGFibGVQaWNrZXIuY29sdW1uQ291bnQ7IGNlbGxJbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2VsbCA9IG5ldyBUYWJsZUNlbGxOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Um93LmFwcGVuZChuZXdDZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1JlZHJhdy5hZGQobmV3Q2VsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFibGVQaWNrZXIucm93Q291bnQgPiBtaW5Sb3dDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93cyA9IHRhYmxlUGlja2VyLmNoaWxkcmVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkIGluc3RhbmNlb2YgVGFibGVSb3dOb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnJvd0luZGV4ID49IG1pblJvd0NvdW50ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLnJvd0luZGV4ID4gdGFibGVQaWNrZXJDZWxsLnJvd0luZGV4ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCByb3dDZWxsIG9mIHJvdy5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dDZWxsLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93cy5sZW5ndGgpIHRvUmVkcmF3LmFkZCh0YWJsZVBpY2tlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkL3JlbW92ZSBDb2x1bW5zLlxuICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVQaWNrZXJDZWxsLmNvbHVtbkluZGV4ID49IHRhYmxlUGlja2VyLmNvbHVtbkNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCByb3cgb2YgdGFibGVQaWNrZXIuY2hpbGRyZW4oVGFibGVSb3dOb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NlbGwgPSBuZXcgVGFibGVDZWxsTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmQobmV3Q2VsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9SZWRyYXcuYWRkKG5ld0NlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhYmxlUGlja2VyLmNvbHVtbkNvdW50ID4gbWluQ29sdW1uQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxzVG9SZW1vdmUgPSB0YWJsZVBpY2tlci5kZXNjZW5kYW50cyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjZW5kYW50ID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NlbmRhbnQgaW5zdGFuY2VvZiBUYWJsZUNlbGxOb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NlbmRhbnQuY29sdW1uSW5kZXggPj0gbWluQ29sdW1uQ291bnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY2VuZGFudC5jb2x1bW5JbmRleCA+IHRhYmxlUGlja2VyQ2VsbC5jb2x1bW5JbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjZWxsVG9SZW1vdmUgb2YgY2VsbHNUb1JlbW92ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUmVkcmF3LmFkZChjZWxsVG9SZW1vdmUucGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsVG9SZW1vdmUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbHNUb1JlbW92ZS5sZW5ndGgpIHRvUmVkcmF3LmFkZCh0YWJsZVBpY2tlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgb25DbGljayA9IGFzeW5jIChldjogRXZlbnQpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBldi50YXJnZXQgYXMgRWxlbWVudDtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgnaW5zZXJ0VGFibGUnLCB7XG4gICAgICAgICAgICAgICAgcm93Q291bnQ6IGNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLXJvd0NvdW50JyksXG4gICAgICAgICAgICAgICAgY29sdW1uQ291bnQ6IGNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLWNvbHVtbkNvdW50JyksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBkb21PYmplY3QuYXR0YWNoID0gKGVsOiBIVE1MVGFibGVDZWxsRWxlbWVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgb25Nb3VzZU92ZXIpO1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrKTtcbiAgICAgICAgfTtcbiAgICAgICAgZG9tT2JqZWN0LmRldGFjaCA9IChlbDogSFRNTFRhYmxlQ2VsbEVsZW1lbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIG9uTW91c2VPdmVyKTtcbiAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbGljayk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkb21PYmplY3Q7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3QsXG4gICAgRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLFxuICAgIERvbU9iamVjdEVsZW1lbnQsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGUgfSBmcm9tICcuL1RhYmxlJztcbmltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBUYWJsZVBpY2tlck5vZGUgfSBmcm9tICcuL1RhYmxlUGlja2VyTm9kZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmVXb3JrZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZUNhY2hlJztcbmltcG9ydCB7IERvbUxheW91dEVuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXRFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVQaWNrZXJEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gVGFibGVQaWNrZXJOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKFxuICAgICAgICB0YWJsZVBpY2tlcjogVGFibGVOb2RlLFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+LFxuICAgICk6IFByb21pc2U8RG9tT2JqZWN0RWxlbWVudD4ge1xuICAgICAgICBjb25zdCBkb21PYmplY3QgPSAoYXdhaXQgdGhpcy5zdXBlci5yZW5kZXIodGFibGVQaWNrZXIsIHdvcmtlcikpIGFzIERvbU9iamVjdEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHRhYmxlUGx1Z2luID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KFRhYmxlKTtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICBsZXQgYXR0YWNoOiBib29sZWFuO1xuXG4gICAgICAgIGNvbnN0IGNsb3NlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IubWVtb3J5SW5mby51aUNvbW1hbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoICYmXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlUGx1Z2luLmlzVGFibGVQaWNrZXJPcGVuICYmXG4gICAgICAgICAgICAgICAgICAgIGxheW91dC5jb21wb25lbnRzLlRhYmxlUGlja2VyLmxlbmd0aFxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBsYXlvdXQucmVtb3ZlKCdUYWJsZVBpY2tlcicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGRvbU9iamVjdC5hdHRhY2ggPSAoKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBhdHRhY2ggPSB0cnVlO1xuICAgICAgICAgICAgdGFibGVQbHVnaW4uaXNUYWJsZVBpY2tlck9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2UsIHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICBkb21PYmplY3QuZGV0YWNoID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgYXR0YWNoID0gZmFsc2U7XG4gICAgICAgICAgICB0YWJsZVBsdWdpbi5pc1RhYmxlUGlja2VyT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2UsIHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZG9tT2JqZWN0O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlUGlja2VyTm9kZSBleHRlbmRzIFRhYmxlTm9kZSB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogeyByb3dDb3VudD86IG51bWJlcjsgY29sdW1uQ291bnQ/OiBudW1iZXIgfSkge1xuICAgICAgICBzdXBlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuY2xhc3NMaXN0LmFkZCgndGFibGUtcGlja2VyJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlUm93RG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFRhYmxlUm93Tm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVGFibGVSb3dOb2RlIGFsb25nIHdpdGggaXRzIGNvbnRlbnRzLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihyb3c6IFRhYmxlUm93Tm9kZSk6IFByb21pc2U8RG9tT2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IG9iamVjdFJvdzogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnVFInLFxuICAgICAgICAgICAgY2hpbGRyZW46IHJvdy5jaGlsZHJlbigpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gb2JqZWN0Um93O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlUm93Tm9kZSBleHRlbmRzIFZFbGVtZW50IHtcbiAgICBicmVha2FibGUgPSBmYWxzZTtcbiAgICBoZWFkZXI6IGJvb2xlYW47XG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogeyBoZWFkZXI6IGJvb2xlYW4gfSkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdUUicgfSk7XG4gICAgICAgIHRoaXMuaGVhZGVyID0gcGFyYW1zPy5oZWFkZXIgfHwgZmFsc2U7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBWTm9kZSB3aXRoIHRoZSBzYW1lIHR5cGUgYW5kIGF0dHJpYnV0ZXMgYXMgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqICBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBkZWZhdWx0czogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBUYWJsZVJvd05vZGU+WzBdID0ge1xuICAgICAgICAgICAgaGVhZGVyOiB0aGlzLmhlYWRlcixcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb25lKGRlZXBDbG9uZSwgeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHZXR0ZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLm5hbWUgKyAodGhpcy5oZWFkZXIgPyAnOiBoZWFkZXInIDogJycpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IG9mIHRoaXMgcm93IGluIHRoZSB0YWJsZS5cbiAgICAgKi9cbiAgICBnZXQgcm93SW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5jZXN0b3IoVGFibGVOb2RlKVxuICAgICAgICAgICAgLmNoaWxkcmVuKFRhYmxlUm93Tm9kZSlcbiAgICAgICAgICAgIC5pbmRleE9mKHRoaXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgTW9kaWZpZXJzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXJzJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXMgZXh0ZW5kcyBBdHRyaWJ1dGVzIHt9XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVJvd1htbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogaXRlbSBpcyBFbGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IG5vZGVOYW1lKGl0ZW0pO1xuICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ1RIRUFEJyB8fCBuYW1lID09PSAnVEJPRFknIHx8IG5hbWUgPT09ICdUUic7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgcm93IG5vZGUgb3IgYSB0YWJsZSBzZWN0aW9uIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFRhYmxlUm93Tm9kZVtdPiB7XG4gICAgICAgIGlmICh0aGlzLl9pc1RhYmxlU2VjdGlvbihpdGVtKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VUYWJsZVNlY3Rpb24oaXRlbSk7XG4gICAgICAgIH0gZWxzZSBpZiAobm9kZU5hbWUoaXRlbSkgPT09ICdUUicpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IG5ldyBUYWJsZVJvd05vZGUoKTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByb3cubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgICAgIHJvdy5hcHBlbmQoLi4uY2VsbHMpO1xuICAgICAgICAgICAgcmV0dXJuIFtyb3ddO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgPHRib2R5PiBvciBhIDx0aGVhZD4gaW50byBhbiBhcnJheSBvZiB0YWJsZSByb3dzIHdpdGggdGhlaXJcbiAgICAgKiBgaGVhZGVyYCBwcm9wZXJ0eSBzZXQgaW4gZnVuY3Rpb24gb2Ygd2hldGhlciB0aGV5IGFyZSBjb250YWluZWQgaW4gYVxuICAgICAqIDx0Ym9keT4gb3IgYSA8dGhlYWQ+LlxuICAgICAqXG4gICAgICogQHBhcmFtIHRhYmxlU2VjdGlvblxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlVGFibGVTZWN0aW9uKHRhYmxlU2VjdGlvbjogSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnQpOiBQcm9taXNlPFRhYmxlUm93Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZE5vZGVzID0gW107XG5cbiAgICAgICAgLy8gUGFyc2UgdGhlIHNlY3Rpb24ncyBjaGlsZHJlbi5cbiAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiB0YWJsZVNlY3Rpb24uY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgcGFyc2VkTm9kZXMucHVzaCguLi4oYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoY2hpbGQpKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQYXJzZSB0aGUgPHRib2R5PiBvciA8dGhlYWQ+J3MgbW9kaWZpZXJzLlxuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKHRhYmxlU2VjdGlvbik7XG5cbiAgICAgICAgLy8gQXBwbHkgdGhlIGF0dHJpYnV0ZXMsIHN0eWxlIGFuZCBgaGVhZGVyYCBwcm9wZXJ0eSBvZiB0aGUgY29udGFpbmVyIHRvXG4gICAgICAgIC8vIGVhY2ggcm93LlxuICAgICAgICBjb25zdCBuYW1lID0gbm9kZU5hbWUodGFibGVTZWN0aW9uKTtcbiAgICAgICAgZm9yIChjb25zdCBwYXJzZWROb2RlIG9mIHBhcnNlZE5vZGVzKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VkTm9kZSBpbnN0YW5jZW9mIFRhYmxlUm93Tm9kZSkge1xuICAgICAgICAgICAgICAgIHBhcnNlZE5vZGUuaGVhZGVyID0gbmFtZSA9PT0gJ1RIRUFEJztcbiAgICAgICAgICAgICAgICBwYXJzZWROb2RlLm1vZGlmaWVycy5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICBUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgICAgICBuZXcgVGFibGVTZWN0aW9uQXR0cmlidXRlcyhhdHRyaWJ1dGVzKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJzZWROb2RlcztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBpdGVtIGlzIGEgdGFibGUgc2VjdGlvbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBfaXNUYWJsZVNlY3Rpb24oaXRlbTogTm9kZSk6IGl0ZW0gaXMgSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnQge1xuICAgICAgICBjb25zdCBuYW1lID0gbm9kZU5hbWUoaXRlbSk7XG4gICAgICAgIHJldHVybiBuYW1lID09PSAnVEhFQUQnIHx8IG5hbWUgPT09ICdUQk9EWSc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTW9kaWZpZXJSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvTW9kaWZpZXJSZW5kZXJlcic7XG5pbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVTZWN0aW9uQXR0cmlidXRlcyB9IGZyb20gJy4vVGFibGVSb3dYbWxEb21QYXJzZXInO1xuXG5leHBvcnQgY2xhc3MgVGFibGVTZWN0aW9uQXR0cmlidXRlc0RvbU9iamVjdE1vZGlmaWVyUmVuZGVyZXIgZXh0ZW5kcyBNb2RpZmllclJlbmRlcmVyPERvbU9iamVjdD4ge1xuICAgIHN0YXRpYyBpZCA9IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyaW5nIGZvciBUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzIE1vZGlmaWVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGZvcm1hdFxuICAgICAqIEBwYXJhbSBjb250ZW50c1xuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihmb3JtYXQ6IFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXMsIGNvbnRlbnRzOiBEb21PYmplY3RbXSk6IFByb21pc2U8RG9tT2JqZWN0W10+IHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnRzO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVOb2RlIH0gZnJvbSAnLi9UYWJsZU5vZGUnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgVGFibGVDZWxsTm9kZSB9IGZyb20gJy4vVGFibGVDZWxsTm9kZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogaXRlbSBpcyBIVE1MVGFibGVFbGVtZW50ID0+IHtcbiAgICAgICAgcmV0dXJuIG5vZGVOYW1lKGl0ZW0pID09PSAnVEFCTEUnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHRhYmxlIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEhUTUxUYWJsZUVsZW1lbnQpOiBQcm9taXNlPFRhYmxlTm9kZVtdPiB7XG4gICAgICAgIC8vIFBhcnNlIHRoZSB0YWJsZSBpdHNlbGYgYW5kIGl0cyBhdHRyaWJ1dGVzLlxuICAgICAgICBjb25zdCB0YWJsZSA9IG5ldyBUYWJsZU5vZGUoKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0YWJsZS5tb2RpZmllcnMuYXBwZW5kKGF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGFyc2UgdGhlIGNvbnRlbnRzIG9mIHRoZSB0YWJsZS5cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBncmlkLlxuICAgICAgICBjb25zdCBkaW1lbnNpb25zID0gdGhpcy5fZ2V0VGFibGVEaW1lbnNpb25zKGl0ZW0pO1xuICAgICAgICBjb25zdCBwYXJzZWRSb3dzID0gY2hpbGRyZW4uZmlsdGVyKHJvdyA9PiByb3cgaW5zdGFuY2VvZiBUYWJsZVJvd05vZGUpIGFzIFRhYmxlUm93Tm9kZVtdO1xuICAgICAgICBjb25zdCBncmlkID0gdGhpcy5fY3JlYXRlVGFibGVHcmlkKGRpbWVuc2lvbnMsIHBhcnNlZFJvd3MpO1xuXG4gICAgICAgIC8vIEFwcGVuZCB0aGUgY2VsbHMgdG8gdGhlIHJvd3MuXG4gICAgICAgIGNvbnN0IHJvd3MgPSBuZXcgQXJyYXk8VGFibGVSb3dOb2RlPihkaW1lbnNpb25zWzBdKTtcbiAgICAgICAgZm9yIChsZXQgcm93SW5kZXggPSAwOyByb3dJbmRleCA8IGdyaWQubGVuZ3RoOyByb3dJbmRleCArPSAxKSB7XG4gICAgICAgICAgICByb3dzW3Jvd0luZGV4XSA9IHBhcnNlZFJvd3Nbcm93SW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSBncmlkW3Jvd0luZGV4XTtcbiAgICAgICAgICAgIGxldCByb3cgPSByb3dzW3Jvd0luZGV4XTtcbiAgICAgICAgICAgIGlmICghcm93KSB7XG4gICAgICAgICAgICAgICAgcm93ID0gbmV3IFRhYmxlUm93Tm9kZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93LmFwcGVuZCguLi5jZWxscyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBcHBlbmQgdGhlIHJvd3MgYW5kIG90aGVyIGNoaWxkcmVuIHRvIHRoZSB0YWJsZS5cbiAgICAgICAgbGV0IHJvd0luZGV4ID0gMDtcbiAgICAgICAgZm9yIChsZXQgY2hpbGRJbmRleCA9IDA7IGNoaWxkSW5kZXggPCBjaGlsZHJlbi5sZW5ndGg7IGNoaWxkSW5kZXggKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltjaGlsZEluZGV4XTtcbiAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFRhYmxlUm93Tm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IHJvd3Nbcm93SW5kZXhdO1xuICAgICAgICAgICAgICAgIHRhYmxlLmFwcGVuZChyb3cpO1xuICAgICAgICAgICAgICAgIHJvd0luZGV4ICs9IDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhYmxlLmFwcGVuZChjaGlsZHJlbltjaGlsZEluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0YWJsZV07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSB0dXBsZSB3aXRoIHRoZSByb3cgbGVuZ3RoIGFuZCB0aGUgY29sdW1uIGxlbmd0aCBvZiB0aGUgZ2l2ZW4gRE9NXG4gICAgICogdGFibGUgZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb21UYWJsZVxuICAgICAqL1xuICAgIF9nZXRUYWJsZURpbWVuc2lvbnMoZG9tVGFibGU6IEhUTUxUYWJsZUVsZW1lbnQpOiBbbnVtYmVyLCBudW1iZXJdIHtcbiAgICAgICAgY29uc3QgZG9tUm93cyA9IEFycmF5LmZyb20oZG9tVGFibGUucXVlcnlTZWxlY3RvckFsbCgndHInKSk7XG4gICAgICAgIGNvbnN0IGRvbVRhYmxlUm93cyA9IGRvbVJvd3MuZmlsdGVyKHJvdyA9PiByb3cuY2xvc2VzdCgndGFibGUnKSA9PT0gZG9tVGFibGUpO1xuICAgICAgICBsZXQgY29sdW1uQ291bnQgPSAwO1xuICAgICAgICBpZiAoZG9tVGFibGVSb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgZG9tQ2VsbHMgPSBBcnJheS5mcm9tKGRvbVRhYmxlUm93c1swXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCwgdGgnKSk7XG4gICAgICAgICAgICBjb25zdCBkb21UYWJsZUNlbGxzID0gZG9tQ2VsbHMuZmlsdGVyKGNlbGwgPT4gY2VsbC5jbG9zZXN0KCd0YWJsZScpID09PSBkb21UYWJsZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbUNoaWxkIG9mIGRvbVRhYmxlQ2VsbHMpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5Db3VudCArPSBwYXJzZUludChkb21DaGlsZC5nZXRBdHRyaWJ1dGUoJ2NvbFNwYW4nKSB8fCAnMScsIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2RvbVRhYmxlUm93cy5sZW5ndGgsIGNvbHVtbkNvdW50XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVpbGQgYW5kIHJldHVybiB0aGUgZ3JpZCAoMkQgYXJyYXk6IHJvd3Mgb2YgY2VsbHMpIHRoYXQgd2lsbCBiZSB1c2VkIHRvXG4gICAgICogY3JlYXRlIHRoZSB0YWJsZS4gV2Ugd2FudCBhbGwgdGhlIHJvd3MgdG8gaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgY2VsbHMsXG4gICAgICogYW5kIGFsbCB0aGUgY29sdW1ucyB0byBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBjZWxscy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkaW1lbnNpb25zXG4gICAgICogQHBhcmFtIHJvd3NcbiAgICAgKi9cbiAgICBfY3JlYXRlVGFibGVHcmlkKGRpbWVuc2lvbnM6IFtudW1iZXIsIG51bWJlcl0sIHJvd3M6IFRhYmxlUm93Tm9kZVtdKTogVGFibGVDZWxsTm9kZVtdW10ge1xuICAgICAgICBjb25zdCBbcm93Q291bnQsIGNvbHVtbkNvdW50XSA9IGRpbWVuc2lvbnM7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgZ3JpZCAoMkQgYXJyYXk6IHJvd3Mgb2YgY2VsbHMpLlxuICAgICAgICBjb25zdCBncmlkOiBUYWJsZUNlbGxOb2RlW11bXSA9IEFycmF5LmZyb20oQXJyYXkocm93Q291bnQpLCAoKSA9PiBuZXcgQXJyYXkoY29sdW1uQ291bnQpKTtcblxuICAgICAgICAvLyBNb3ZlIGV2ZXJ5IHBhcnNlZCBjaGlsZCByb3cgdG8gaXRzIHBsYWNlIGluIHRoZSBncmlkLCBhbmQgY3JlYXRlXG4gICAgICAgIC8vIHBsYWNlaG9sZGVyIGNlbGxzIHdoZXJlIHRoZXJlIGFyZW4ndCBhbnksIGFjY291bnRpbmcgZm9yIGNvbHVtbiBzcGFuc1xuICAgICAgICAvLyBhbmQgcm93IHNwYW5zLlxuICAgICAgICBmb3IgKGxldCByb3dJbmRleCA9IDA7IHJvd0luZGV4IDwgcm93Q291bnQ7IHJvd0luZGV4ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHJvd3Nbcm93SW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSByb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSkuc2xpY2UoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGRvbUNlbGxJbmRleCA9IDA7IGRvbUNlbGxJbmRleCA8IGNlbGxzLmxlbmd0aDsgZG9tQ2VsbEluZGV4ICs9IDEpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gY2VsbHNbZG9tQ2VsbEluZGV4XTtcblxuICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGEgY2VsbCBhdCB0aGlzIGdyaWQgcG9zaXRpb24gYWxyZWFkeSwgaXQgbWVhbnMgd2VcbiAgICAgICAgICAgICAgICAvLyBhZGRlZCBpdCB0aGVyZSB3aGVuIGhhbmRsaW5nIGFub3RoZXIgY2VsbCwgaWUuIGl0J3MgYVxuICAgICAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyIGNlbGwsIG1hbmFnZWQgYnkgYSBwcmV2aW91c2x5IGhhbmRsZWQgY2VsbC5cbiAgICAgICAgICAgICAgICAvLyBUaGUgY3VycmVudCBjZWxsIG5lZWRzIHRvIGJlIGFkZGVkIGF0IHRoZSBuZXh0IGF2YWlsYWJsZSBzbG90XG4gICAgICAgICAgICAgICAgLy8gaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBsZXQgY29sdW1uSW5kZXggPSBkb21DZWxsSW5kZXg7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdyaWRbcm93SW5kZXhdW2NvbHVtbkluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCArPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIHRyYXZlcnNpbmcgY29sc3BhbiBhbmQgcm93c3BhbiB0byBpbnNlcnQgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAvLyBjZWxscyB3aGVyZSBuZWNlc3NhcnkuIENvbnN1bWUgdGhlc2UgYXR0cmlidXRlcyBhcyB0aGV5IHdpbGxcbiAgICAgICAgICAgICAgICAvLyBiZSByZXBsYWNlZCB3aXRoIGdldHRlcnMuXG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGNlbGwubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgbGV0IGNvbHNwYW4gPSAxO1xuICAgICAgICAgICAgICAgIGxldCByb3dzcGFuID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBjb2xzcGFuID0gcGFyc2VJbnQoYXR0cmlidXRlcy5nZXQoJ2NvbHNwYW4nKSwgMTApIHx8IDE7XG4gICAgICAgICAgICAgICAgICAgIHJvd3NwYW4gPSBwYXJzZUludChhdHRyaWJ1dGVzLmdldCgncm93c3BhbicpLCAxMCkgfHwgMTtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ2NvbHNwYW4nKTtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ3Jvd3NwYW4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHJvd0luZGV4OyBpIDwgcm93SW5kZXggKyByb3dzcGFuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IGNvbHVtbkluZGV4OyBqIDwgY29sdW1uSW5kZXggKyBjb2xzcGFuOyBqICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09PSByb3dJbmRleCAmJiBqID09PSBjb2x1bW5JbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY3VycmVudCBjZWxsIHRvIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRbaV1bal0gPSBjZWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYSBwbGFjZWhvbGRlciBjZWxsIHRvIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyQ2VsbCA9IG5ldyBUYWJsZUNlbGxOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDZWxsLm1lcmdlV2l0aChjZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmlkW2ldW2pdID0gcGxhY2Vob2xkZXJDZWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5zZXJ0IGVtcHR5IGNlbGxzIGluIGV2ZXJ5IHVuZGVmaW5lZCBlbGVtZW50IG9mIHRoZSBncmlkLlxuICAgICAgICByZXR1cm4gZ3JpZC5tYXAocm93ID0+IEFycmF5LmZyb20ocm93LCBjZWxsID0+IGNlbGwgfHwgbmV3IFRhYmxlQ2VsbE5vZGUoKSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4vLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEpXUGx1Z2luQ29uZmlnLCBKV1BsdWdpbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFRleHRhcmVhWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9UZXh0YXJlYVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgVGV4dGFyZWFEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vVGV4dGFyZWFEb21PYmplY3RSZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBUZXh0YXJlYTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbVGV4dGFyZWFYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtUZXh0YXJlYURvbU9iamVjdFJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFRleHRhcmVhTm9kZSB9IGZyb20gJy4vVGV4dGFyZWFOb2RlJztcbmltcG9ydCB7IERvbU9iamVjdFRleHQgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIFRleHRhcmVhRG9tT2JqZWN0UmVuZGVyZXIgZXh0ZW5kcyBOb2RlUmVuZGVyZXI8RG9tT2JqZWN0PiB7XG4gICAgc3RhdGljIGlkID0gRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFRleHRhcmVhTm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVGV4dGFyZWFOb2RlLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBUZXh0YXJlYU5vZGUpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCB0ZXh0OiBEb21PYmplY3RUZXh0ID0geyB0ZXh0OiBub2RlLnZhbHVlIH07XG4gICAgICAgIGNvbnN0IHRleHRhcmVhOiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdURVhUQVJFQScsXG4gICAgICAgICAgICBjaGlsZHJlbjogW3RleHRdLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGV4dGFyZWE7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmludGVyZmFjZSBUZXh0YXJlYVBhcmFtcyB7XG4gICAgdmFsdWU/OiBzdHJpbmc7XG59XG5leHBvcnQgY2xhc3MgVGV4dGFyZWFOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgdmFsdWUgPSAnJztcblxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcz86IFRleHRhcmVhUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmFsdWUgPSAocGFyYW1zICYmIHBhcmFtcy52YWx1ZSkgfHwgJyc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBUZXh0YXJlYU5vZGUgfSBmcm9tICcuL1RleHRhcmVhTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBUZXh0YXJlYVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4gaXRlbSBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIGxpc3QgKFVMLCBPTCkgYW5kIGl0cyBjaGlsZHJlbiBsaXN0IGVsZW1lbnRzIChMSSkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEhUTUxUZXh0QXJlYUVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBuZXcgVGV4dGFyZWFOb2RlKHsgdmFsdWU6IGl0ZW0udmFsdWUgfSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGV4dGFyZWEubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3RleHRhcmVhXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb2xvciwgQ29sb3JDb25maWcgfSBmcm9tICcuLi8uLi9wbHVnaW4tY29sb3Ivc3JjL0NvbG9yJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5cbmV4cG9ydCBjbGFzcyBUZXh0Q29sb3I8VCBleHRlbmRzIENvbG9yQ29uZmlnID0gQ29sb3JDb25maWc+IGV4dGVuZHMgQ29sb3I8VD4ge1xuICAgIHN0eWxlTmFtZSA9ICdjb2xvcic7XG4gICAgY29uZmlndXJhdGlvbiA9IHsgZGVmYXVsdENvbG9yOiAnYmxhY2snLCAuLi50aGlzLmNvbmZpZ3VyYXRpb24gfTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgY29sb3JUZXh0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmNvbG9yLFxuICAgICAgICB9LFxuICAgICAgICB1bmNvbG9yVGV4dDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy51bmNvbG9yLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8S2V5bWFwPiA9IHtcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrRycsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnY29sb3JUZXh0JyxcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiB1c2UgZGlhbG9nIHRvIGdldCBwYXJhbXNcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczoge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3JlZCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrRycsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAndW5jb2xvclRleHQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgVGhlbWVYbWxEb21QYXJzZXIgfSBmcm9tICcuL1RoZW1lWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFRoZW1lRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL1RoZW1lRG9tT2JqZWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IENvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVGhlbWVOb2RlIH0gZnJvbSAnLi9UaGVtZU5vZGUnO1xuaW1wb3J0IHsgWm9uZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9ab25lTm9kZSc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlR3JvdXBOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZUdyb3VwTm9kZSc7XG5pbXBvcnQgeyBBY3Rpb25hYmxlTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVOb2RlJztcbmltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcblxuaW50ZXJmYWNlIFRoZW1lQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gICAgbGFiZWw/OiBzdHJpbmc7XG59XG5pbnRlcmZhY2UgVGhlbWVDb25maWcgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyB7XG4gICAgY29tcG9uZW50cz86IFRoZW1lQ29tcG9uZW50W107XG59XG5pbnRlcmZhY2UgQ2hhbmdlVGhlbWVQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICB0aGVtZTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgVGhlbWU8VCBleHRlbmRzIFRoZW1lQ29uZmlnID0gVGhlbWVDb25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlciAmIExheW91dD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtUaGVtZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW1RoZW1lRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdUaGVtZUJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8QWN0aW9uYWJsZUdyb3VwTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbmV3IEFjdGlvbmFibGVHcm91cE5vZGUoeyBuYW1lOiAndGhlbWVzJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgem9uZSA9IG5ldyBab25lTm9kZSh7IG1hbmFnZWRab25lczogWyd0aGVtZUJ1dHRvbnMnXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXAuYXBwZW5kKHpvbmUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2dyb3VwXTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50Wm9uZXM6IFtbJ1RoZW1lQnV0dG9uJywgWydhY3Rpb25hYmxlcyddXV0sXG4gICAgfTtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgY2hhbmdlVGhlbWU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuY2hhbmdlVGhlbWUsXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICB0aGVtZXM6IFJlY29yZDxzdHJpbmcsIFRoZW1lQ29tcG9uZW50PiA9IHtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgaWQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPFZFbGVtZW50W10+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBWRWxlbWVudCh7IGh0bWxUYWc6ICdULVBMQUNFSE9MREVSJyB9KV07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGFiZWw6ICdUaGVtZTogRGVmYXVsdCcsXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IsIGNvbmZpZ3VyYXRpb246IFBhcnRpYWw8VD4gPSB7fSkge1xuICAgICAgICBzdXBlcihlZGl0b3IsIGNvbmZpZ3VyYXRpb24pO1xuICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdGhlbWUgb2YgdGhpcy5jb25maWd1cmF0aW9uLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFRoZW1lKHRoZW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGRUaGVtZSh0aGVtZTogVGhlbWVDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50aGVtZXNbdGhlbWUuaWRdID0gdGhlbWU7XG4gICAgICAgIHRoaXMubG9hZGFibGVzLmNvbXBvbmVudHMucHVzaCh0aGlzLl9jcmVhdGVUaGVtZUJ1dHRvbih0aGVtZS5pZCkpO1xuICAgICAgICB0aGlzLmxvYWRhYmxlcy5jb21wb25lbnRab25lcy5wdXNoKFsnVGhlbWUnICsgdGhlbWUuaWQgKyAnQnV0dG9uJywgWyd0aGVtZUJ1dHRvbnMnXV0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSB0aGVtZSBidXR0b24gQ29tcG9uZW50RGVmaW5pdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICovXG4gICAgcHJpdmF0ZSBfY3JlYXRlVGhlbWVCdXR0b24obmFtZTogc3RyaW5nKTogQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gICAgICAgIGNvbnN0IHRoZW1lID0gdGhpcy50aGVtZXNbbmFtZV07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogJ1RoZW1lJyArIG5hbWUgKyAnQnV0dG9uJyxcbiAgICAgICAgICAgIGFzeW5jIHJlbmRlcigpOiBQcm9taXNlPEFjdGlvbmFibGVOb2RlW10+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBuZXcgQWN0aW9uYWJsZU5vZGUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAndGhlbWUtJyArIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0aGVtZS5sYWJlbCB8fCAnVGhlbWU6ICcgKyBuYW1lLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdjaGFuZ2VUaGVtZScsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHRoZW1lOiBuYW1lIH0gYXMgQ2hhbmdlVGhlbWVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5jZXN0b3IgPSBlZGl0b3Iuc2VsZWN0aW9uLmFuY2hvci5hbmNlc3RvcihUaGVtZU5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuY2VzdG9yPy50aGVtZU5hbWUgPT09IG5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFlZGl0b3Iuc2VsZWN0aW9uLmFuY2hvci5hbmNlc3RvcihUaGVtZU5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbYnV0dG9uXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZSB0aGUgY3VycmVudCB0aGVtZSBhbmQgdGVtcGxhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgY2hhbmdlVGhlbWUocGFyYW1zOiBDaGFuZ2VUaGVtZVBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhbmNlc3RvciA9IHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IuYW5jZXN0b3IoVGhlbWVOb2RlKTtcbiAgICAgICAgaWYgKGFuY2VzdG9yKSB7XG4gICAgICAgICAgICBhbmNlc3Rvci50aGVtZU5hbWUgPSBwYXJhbXMudGhlbWU7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQge1xuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbiAgICBEb21PYmplY3QsXG59IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci1kb20tb2JqZWN0L3NyYy9Eb21PYmplY3RSZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTm9kZVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9Ob2RlUmVuZGVyZXInO1xuaW1wb3J0IHsgVGhlbWVOb2RlIH0gZnJvbSAnLi9UaGVtZU5vZGUnO1xuaW1wb3J0IHsgVGhlbWUgfSBmcm9tICcuL1RoZW1lJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZVdvcmtlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lQ2FjaGUnO1xuXG5leHBvcnQgY2xhc3MgVGhlbWVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gVGhlbWVOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKHRoZW1lTm9kZTogVGhlbWVOb2RlKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgdGhlbWVQbHVnaW4gPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoVGhlbWUpO1xuICAgICAgICBjb25zdCBjb21wb25lbnQgPSB0aGVtZVBsdWdpbi50aGVtZXNbdGhlbWVOb2RlLnRoZW1lTmFtZV07XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgY29tcG9uZW50LnJlbmRlcih0aGlzLmVuZ2luZS5lZGl0b3IpO1xuICAgICAgICBjb25zdCBjYWNoZSA9IGF3YWl0IHRoaXMuZW5naW5lLnJlbmRlcihub2Rlcyk7XG4gICAgICAgIGNvbnN0IGRvbU9iamVjdHMgPSBub2Rlcy5tYXAobm9kZSA9PiBjYWNoZS5yZW5kZXJpbmdzLmdldChub2RlKSk7XG4gICAgICAgIGZvciAoY29uc3QgZG9tT2JqZWN0IG9mIGRvbU9iamVjdHMpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3Jlc29sdmVQbGFjZWhvbGRlcih0aGVtZU5vZGUsIGRvbU9iamVjdCwgY2FjaGUud29ya2VyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBjaGlsZHJlbjogZG9tT2JqZWN0cyB9O1xuICAgIH1cbiAgICBwcml2YXRlIGFzeW5jIF9yZXNvbHZlUGxhY2Vob2xkZXIoXG4gICAgICAgIHRoZW1lOiBUaGVtZU5vZGUsXG4gICAgICAgIGRvbU9iamVjdDogRG9tT2JqZWN0LFxuICAgICAgICB3b3JrZXI6IFJlbmRlcmluZ0VuZ2luZVdvcmtlcjxEb21PYmplY3Q+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCB0aGlzLmVuZ2luZS5yZXNvbHZlQ2hpbGRyZW4oZG9tT2JqZWN0LCB3b3JrZXIpO1xuICAgICAgICBsZXQgcGxhY2Vob2xkZXJGb3VuZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBkb21PYmplY3RzOiBEb21PYmplY3RbXSA9IFtkb21PYmplY3RdO1xuICAgICAgICBmb3IgKGNvbnN0IGRvbU9iamVjdCBvZiBkb21PYmplY3RzKSB7XG4gICAgICAgICAgICBpZiAoJ3RhZycgaW4gZG9tT2JqZWN0ICYmIGRvbU9iamVjdC50YWcgPT09ICdULVBMQUNFSE9MREVSJykge1xuICAgICAgICAgICAgICAgIGlmICghcGxhY2Vob2xkZXJGb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgZG9tT2JqZWN0LnRhZztcbiAgICAgICAgICAgICAgICAgICAgZG9tT2JqZWN0LmNoaWxkcmVuID0gdGhlbWUuY2hpbGRyZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICgnZG9tJyBpbiBkb21PYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXBsYWNlaG9sZGVyRm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRvbU9iamVjdC5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlIGluc3RhbmNlb2YgRWxlbWVudCAmJiBkb21Ob2RlLnF1ZXJ5U2VsZWN0b3IoJ1QtUExBQ0VIT0xERVInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhlbWUuY2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLnJlbmRlclBsYWNlaG9sZGVyKGNoaWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHBsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJ2NoaWxkcmVuJyBpbiBkb21PYmplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyBSZWN1cnNpdmVseSBhcHBseSBvbiBjaGlsZHJlbiBpbiBvbmUgc3RhY2suXG4gICAgICAgICAgICAgICAgZG9tT2JqZWN0cy5wdXNoKC4uLihkb21PYmplY3QuY2hpbGRyZW4gYXMgRG9tT2JqZWN0W10pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBUaGVtZU5vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHtcbiAgICBlZGl0YWJsZSA9IGZhbHNlO1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xuICAgIHRoZW1lTmFtZTogc3RyaW5nO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcz86IHsgdGhlbWU6IHN0cmluZyB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGhlbWVOYW1lID0gcGFyYW1zPy50aGVtZSB8fCAnZGVmYXVsdCc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBUaGVtZU5vZGUgfSBmcm9tICcuL1RoZW1lTm9kZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBUaGVtZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QtVEhFTUUnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHNoYWRvdyBub2RlIGFuZCBleHRyYWN0IHN0eWxpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgdGhlbWUgPSBuZXcgVGhlbWVOb2RlKHsgdGhlbWU6IGl0ZW0uZ2V0QXR0cmlidXRlKCduYW1lJykgfSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCduYW1lJyk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhlbWUubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHRoZW1lLmFwcGVuZCguLi5ub2Rlcyk7XG4gICAgICAgIHJldHVybiBbdGhlbWVdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgVG9vbGJhclpvbmVYbWxEb21QYXJzZXIgfSBmcm9tICcuL1Rvb2xiYXJYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgVG9vbGJhclpvbmVEb21PYmplY3RSZW5kZXJlciB9IGZyb20gJy4vVG9vbGJhckRvbU9iamVjdFJlbmRlcmVyJztcbmltcG9ydCB7IEFjdGlvbmFibGVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvQWN0aW9uYWJsZU5vZGUnO1xuaW1wb3J0IHsgRG9tTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dCc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuXG5pbXBvcnQgeyBUb29sYmFyTm9kZSB9IGZyb20gJy4vVG9vbGJhck5vZGUnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZUdyb3VwTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0FjdGlvbmFibGVHcm91cE5vZGUnO1xuaW1wb3J0IHsgU2VwYXJhdG9yTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9TZXBhcmF0b3JOb2RlJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgTGFiZWxOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGFiZWxOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BYnN0cmFjdE5vZGUnO1xuXG5leHBvcnQgdHlwZSBUb29sYmFySXRlbSA9IEFjdGlvbmFibGVOb2RlIHwgc3RyaW5nIHwgc3RyaW5nW107XG5leHBvcnQgdHlwZSBUb29sYmFyT3B0R3JvdXAgPSBUb29sYmFySXRlbVtdO1xuZXhwb3J0IHR5cGUgVG9vbGJhckdyb3VwID0gQXJyYXk8VG9vbGJhckl0ZW0gfCBUb29sYmFyT3B0R3JvdXA+O1xuZXhwb3J0IHR5cGUgVG9vbGJhckxheW91dCA9IEFycmF5PFRvb2xiYXJHcm91cCB8IHN0cmluZz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG9vbGJhckNvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBsYXlvdXQ/OiBUb29sYmFyTGF5b3V0O1xufVxuXG5leHBvcnQgY2xhc3MgVG9vbGJhcjxUIGV4dGVuZHMgVG9vbGJhckNvbmZpZyA9IHt9PiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0RvbUxheW91dF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXIgJiBMYXlvdXQ+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbVG9vbGJhclpvbmVYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtUb29sYmFyWm9uZURvbU9iamVjdFJlbmRlcmVyXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAndG9vbGJhcicsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBhc3luYyAoKTogUHJvbWlzZTxUb29sYmFyTm9kZVtdPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2xiYXIgPSBuZXcgVG9vbGJhck5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRUb29sYmFySXRlbXModG9vbGJhciwgdGhpcy5jb25maWd1cmF0aW9uPy5sYXlvdXQgfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3Rvb2xiYXJdO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1sndG9vbGJhcicsIFsndG9vbHMnXV1dLFxuICAgIH07XG4gICAgY29uZmlndXJhdGlvbiA9IHsgbGF5b3V0OiBbXSwgLi4udGhpcy5jb25maWd1cmF0aW9uIH07XG4gICAgYWRkVG9vbGJhckl0ZW1zKHRvb2xiYXI6IFRvb2xiYXJOb2RlLCBsYXlvdXQ6IFRvb2xiYXJMYXlvdXQpOiB2b2lkO1xuICAgIGFkZFRvb2xiYXJJdGVtcyhncm91cDogQWN0aW9uYWJsZUdyb3VwTm9kZSwgbGF5b3V0R3JvdXA6IFRvb2xiYXJHcm91cCB8IHN0cmluZ1tdKTogdm9pZDtcbiAgICBhZGRUb29sYmFySXRlbXMoXG4gICAgICAgIG5vZGU6IFRvb2xiYXJOb2RlIHwgQWN0aW9uYWJsZUdyb3VwTm9kZSxcbiAgICAgICAgaXRlbXM6IFRvb2xiYXJMYXlvdXQgfCBUb29sYmFyR3JvdXAgfCBUb29sYmFyT3B0R3JvdXAgfCBzdHJpbmdbXSxcbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZG9tRW5naW5lID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KS5lbmdpbmVzLmRvbTtcblxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PT0gJ3wnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kKG5ldyBTZXBhcmF0b3JOb2RlKCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9tRW5naW5lLmhhc0NvbmZpZ3VyZWRDb21wb25lbnRzKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kKG5ldyBab25lTm9kZSh7IG1hbmFnZWRab25lczogW2l0ZW1dIH0pKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZChuZXcgTGFiZWxOb2RlKHsgbGFiZWw6IGl0ZW0gfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbSBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kKG5vZGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IG5ldyBBY3Rpb25hYmxlR3JvdXBOb2RlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRUb29sYmFySXRlbXMoZ3JvdXAsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kKGdyb3VwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBUb29sYmFyTm9kZSB9IGZyb20gJy4vVG9vbGJhck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgVG9vbGJhclpvbmVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gVG9vbGJhck5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIodG9vbGJhcjogVG9vbGJhck5vZGUpOiBQcm9taXNlPERvbU9iamVjdD4ge1xuICAgICAgICBjb25zdCBvYmplY3RUb29sYmFyOiBEb21PYmplY3QgPSB7XG4gICAgICAgICAgICB0YWc6ICdKVy1UT09MQkFSJyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiB0b29sYmFyLmNoaWxkcmVuKCksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvYmplY3RUb29sYmFyO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBUb29sYmFyTm9kZSBleHRlbmRzIENvbnRhaW5lck5vZGUge31cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgVG9vbGJhck5vZGUgfSBmcm9tICcuL1Rvb2xiYXJOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IFRvb2xiYXIgfSBmcm9tICcuL1Rvb2xiYXInO1xuXG5leHBvcnQgY2xhc3MgVG9vbGJhclpvbmVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdULVRPT0xCQVInO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHRvb2xiYXIgPSBuZXcgVG9vbGJhck5vZGUoKTtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0b29sYmFyLmFwcGVuZCguLi5ub2Rlcyk7XG4gICAgICAgIGNvbnN0IHRvb2xiYXJQbHVnaW4gPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoVG9vbGJhcik7XG4gICAgICAgIHRvb2xiYXJQbHVnaW4uYWRkVG9vbGJhckl0ZW1zKHRvb2xiYXIsIHRvb2xiYXJQbHVnaW4uY29uZmlndXJhdGlvbj8ubGF5b3V0KTtcbiAgICAgICAgcmV0dXJuIFt0b29sYmFyXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBVbmRlcmxpbmVGb3JtYXQgfSBmcm9tICcuL1VuZGVybGluZUZvcm1hdCc7XG5pbXBvcnQgeyBGb3JtYXRQYXJhbXMsIElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBVbmRlcmxpbmVYbWxEb21QYXJzZXIgfSBmcm9tICcuL1VuZGVybGluZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgSldFZGl0b3IsIHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgQWN0aW9uYWJsZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9BY3Rpb25hYmxlTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5cbmV4cG9ydCBjbGFzcyBVbmRlcmxpbmU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBLZXltYXAgJiBMYXlvdXQ+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbVW5kZXJsaW5lWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrVScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAndG9nZ2xlRm9ybWF0JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyBGb3JtYXRDbGFzczogVW5kZXJsaW5lRm9ybWF0IH0gYXMgRm9ybWF0UGFyYW1zLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnVW5kZXJsaW5lQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxBY3Rpb25hYmxlTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IG5ldyBBY3Rpb25hYmxlTm9kZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAndW5kZXJsaW5lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVG9nZ2xlIHVuZGVybGluZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0b2dnbGVGb3JtYXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgRm9ybWF0Q2xhc3M6IFVuZGVybGluZUZvcm1hdCB9IGFzIEZvcm1hdFBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5yYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwbHVnaW5JbmxpbmUgPSBlZGl0b3IucGx1Z2lucy5nZXQoSW5saW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhcGx1Z2luSW5saW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Q3VycmVudE1vZGlmaWVycyhyYW5nZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uZmluZChVbmRlcmxpbmVGb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0SXNGb3JtYXRlZCA9ICEhcmFuZ2Uuc3RhcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXh0U2libGluZyhJbmxpbmVOb2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPy5tb2RpZmllcnMuZmluZChVbmRlcmxpbmVGb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0SXNGb3JtYXRlZCB8fCByYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnRJc0Zvcm1hdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhcmFuZ2UuZW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnByZXZpb3VzU2libGluZyhJbmxpbmVOb2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8ubW9kaWZpZXJzLmZpbmQoVW5kZXJsaW5lRm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtuZXcgQXR0cmlidXRlcyh7IGNsYXNzOiAnZmEgZmEtdW5kZXJsaW5lIGZhLWZ3JyB9KV0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2J1dHRvbl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydVbmRlcmxpbmVCdXR0b24nLCBbJ2FjdGlvbmFibGVzJ11dXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRm9ybWF0JztcblxuZXhwb3J0IGNsYXNzIFVuZGVybGluZUZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgaHRtbFRhZyA9ICdVJztcbn1cbiIsImltcG9ydCB7IEZvcm1hdFhtbERvbVBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBVbmRlcmxpbmVGb3JtYXQgfSBmcm9tICcuL1VuZGVybGluZUZvcm1hdCc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBVbmRlcmxpbmVYbWxEb21QYXJzZXIgZXh0ZW5kcyBGb3JtYXRYbWxEb21QYXJzZXIge1xuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1UnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhbiB1bmRlcmxpbmUgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCB1bmRlcmxpbmUgPSBuZXcgVW5kZXJsaW5lRm9ybWF0KCk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdW5kZXJsaW5lLm1vZGlmaWVycy5hcHBlbmQoYXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHVuZGVybGluZSwgY2hpbGRyZW4pO1xuXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNb2RpZmllciwgTW9kaWZpZXJQcmVzZXJ2ZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGlmaWVyJztcbmltcG9ydCB7IENzc1N0eWxlIH0gZnJvbSAnLi9Dc3NTdHlsZSc7XG5pbXBvcnQgeyBDbGFzc0xpc3QgfSBmcm9tICcuL0NsYXNzTGlzdCc7XG5pbXBvcnQgeyBtYWtlVmVyc2lvbmFibGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGUnO1xuaW1wb3J0IHsgVmVyc2lvbmFibGVPYmplY3QgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGVPYmplY3QnO1xuXG5leHBvcnQgY2xhc3MgQXR0cmlidXRlcyBleHRlbmRzIE1vZGlmaWVyIHtcbiAgICBwcml2YXRlIF9yZWNvcmQ6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgc3R5bGUgPSBuZXcgQ3NzU3R5bGUoKTtcbiAgICAvLyBBdm9pZCBjb3BpeWluZyBGb250QXdlc29tZSBjbGFzc2VzIG9uIHBhcmFncmFwaCBicmVhay5cbiAgICAvLyBUT0RPIDogbmVlZCB0byBiZSBpbXByb3ZlZCB0byBiZXR0ZXIgdGFrZSBjYXJlIG9mIGNvbG9yIGNsYXNzZXMsIGV0Yy5cbiAgICBwcmVzZXJ2ZSA9IG5ldyBWZXJzaW9uYWJsZU9iamVjdCh7XG4gICAgICAgIGFmdGVyOiB0cnVlLFxuICAgICAgICBwYXJhZ3JhcGhCcmVhazogZmFsc2UsXG4gICAgICAgIGxpbmVCcmVhazogdHJ1ZSxcbiAgICB9KSBhcyBNb2RpZmllclByZXNlcnZlO1xuICAgIGNsYXNzTGlzdCA9IG5ldyBDbGFzc0xpc3QoKTtcbiAgICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzPzogQXR0cmlidXRlcyB8IE5hbWVkTm9kZU1hcCB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMgaW5zdGFuY2VvZiBBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBhdHRyaWJ1dGVzLmtleXMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0KGtleSwgYXR0cmlidXRlcy5nZXQoa2V5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoYXR0cmlidXRlcyBpbnN0YW5jZW9mIE5hbWVkTm9kZU1hcCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgQXJyYXkuZnJvbShhdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0KGF0dHJpYnV0ZS5uYW1lLCBhdHRyaWJ1dGUudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoa2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdldHRlcnNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMoKS5sZW5ndGg7XG4gICAgfVxuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGVOYW1lIG9mIHRoaXMua2V5cygpKSB7XG4gICAgICAgICAgICBuYW1lLnB1c2goYCR7YXR0cmlidXRlTmFtZX06IFwiJHt0aGlzLmdldChhdHRyaWJ1dGVOYW1lKX1cImApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgeyR7bmFtZS5qb2luKCcsICcpfX1gO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBjbG9uZSBvZiB0aGlzIHJlY29yZC5cbiAgICAgKi9cbiAgICBjbG9uZSgpOiB0aGlzIHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpO1xuICAgICAgICBpZiAodGhpcy5fcmVjb3JkKSB7XG4gICAgICAgICAgICBjbG9uZS5fcmVjb3JkID0gbWFrZVZlcnNpb25hYmxlKHsgLi4udGhpcy5fcmVjb3JkIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN0eWxlLmxlbmd0aCkge1xuICAgICAgICAgICAgY2xvbmUuc3R5bGUgPSB0aGlzLnN0eWxlLmNsb25lKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2xhc3NMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgY2xvbmUuY2xhc3NMaXN0ID0gdGhpcy5jbGFzc0xpc3QuY2xvbmUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGF0dHJpYnV0ZXMuXG4gICAgICovXG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0aGlzLmxlbmd0aCkgcmV0dXJuIGAke3RoaXMuY29uc3RydWN0b3IubmFtZX06IHt9YDtcbiAgICAgICAgY29uc3QgdmFsdWVSZXByID0gW107XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMua2V5cygpKSB7XG4gICAgICAgICAgICB2YWx1ZVJlcHIucHVzaChgJHtrZXl9OiBcIiR7dGhpcy5nZXQoa2V5KX1cImApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9OiB7ICR7dmFsdWVSZXByLmpvaW4oJywgJyl9IH1gO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgcmVjb3JkIGhhcyB0aGUgZ2l2ZW4ga2V5LCBmYWxzZSBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICovXG4gICAgaGFzKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMoKS5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBjb250YWluaW5nIGFsbCB0aGUga2V5cyBpbiB0aGUgcmVjb3JkLlxuICAgICAqL1xuICAgIGtleXMoKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBrZXlzID0gdGhpcy5fcmVjb3JkXG4gICAgICAgICAgICA/IE9iamVjdC5rZXlzKHRoaXMuX3JlY29yZCkuZmlsdGVyKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgIChrZXkgIT09ICdzdHlsZScgfHwgISF0aGlzLnN0eWxlLmxlbmd0aCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAoa2V5ICE9PSAnY2xhc3MnIHx8ICEhdGhpcy5jbGFzc0xpc3QubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogW107XG4gICAgICAgIGlmICh0aGlzLmNsYXNzTGlzdC5sZW5ndGggJiYgIWtleXMuaW5jbHVkZXMoJ2NsYXNzJykpIHtcbiAgICAgICAgICAgIC8vIFRoZSBub2RlIHdhcyBub3QgcGFyc2VkIHdpdGggYSBjbGFzcyBhdHRyaWJ1dGUsIGFkZCBpdCBpbiBwbGFjZS5cbiAgICAgICAgICAgIC8vIFVzZSBgZ2V0YCBmb3IgaXRzIHZhbHVlIGJ1dCByZWNvcmQgaXRzIHBvc2l0aW9uIGluIHRoZSByZWNvcmQuXG4gICAgICAgICAgICBrZXlzLnB1c2goJ2NsYXNzJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3R5bGUubGVuZ3RoICYmICFrZXlzLmluY2x1ZGVzKCdzdHlsZScpKSB7XG4gICAgICAgICAgICAvLyBUaGUgbm9kZSB3YXMgbm90IHBhcnNlZCB3aXRoIGEgc3R5bGUgYXR0cmlidXRlLCBrZWVwIGl0IGFsd2F5cyBhdFxuICAgICAgICAgICAgLy8gdGhlIGVuZCBvZiB0aGUgYXR0cmlidXRlcyBsaXN0LlxuICAgICAgICAgICAga2V5cy5wdXNoKCdzdHlsZScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIHZhbHVlcyBpbiB0aGUgcmVjb3JkLlxuICAgICAqL1xuICAgIHZhbHVlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMoKS5tYXAoa2V5ID0+IHRoaXMuZ2V0KGtleSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHJlY29yZCBtYXRjaGluZyB0aGUgZ2l2ZW4gbmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICovXG4gICAgZ2V0KG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChuYW1lID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZT8uY3NzVGV4dDtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc0xpc3Q/LmNsYXNzTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNvcmQ/LltuYW1lXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHJlY29yZCB3aXRoIHRoZSBnaXZlbiBuYW1lIHRvIHRoZSBnaXZlbiB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICovXG4gICAgc2V0KG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoIXRoaXMuX3JlY29yZCkge1xuICAgICAgICAgICAgdGhpcy5fcmVjb3JkID0gbWFrZVZlcnNpb25hYmxlKHt9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLnJlc2V0KHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZSA9IG5ldyBDc3NTdHlsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVXNlIGBnZXRgIGZvciBpdHMgdmFsdWUgYnV0IHJlY29yZCBpdHMgcG9zaXRpb24gaW4gdGhlIHJlY29yZC5cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZC5zdHlsZSA9IG51bGw7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVzZXQodmFsdWUpO1xuICAgICAgICAgICAgLy8gVXNlIGBnZXRgIGZvciBpdHMgdmFsdWUgYnV0IHJlY29yZCBpdHMgcG9zaXRpb24gaW4gdGhlIHJlY29yZC5cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZC5jbGFzcyA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIHJlY29yZHMgd2l0aCB0aGUgZ2l2ZW4gbmFtZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZXNcbiAgICAgKi9cbiAgICByZW1vdmUoLi4ubmFtZXM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgICAgIGZvciAobGV0IG5hbWUgb2YgbmFtZXMpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUuY2xlYXIoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3JlY29yZCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yZWNvcmRbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xlYXIoKTogdm9pZCB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9yZWNvcmQ7XG4gICAgICAgIHRoaXMuc3R5bGUuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5jbGFzc0xpc3QuY2xlYXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGF0dHJpYnV0ZXMgYXJlIHRoZSBzYW1lIGFzIHRoZSBvbmVzIGluIHRoaXNcbiAgICAgKiByZWNvcmQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXJBdHRyaWJ1dGVzXG4gICAgICovXG4gICAgaXNTYW1lQXMob3RoZXJBdHRyaWJ1dGVzOiBBdHRyaWJ1dGVzKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChvdGhlckF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgdGhpcy5sZW5ndGggPT09IG90aGVyQXR0cmlidXRlcy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICB0aGlzLmtleXMoKS5ldmVyeShrZXkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoa2V5KSA9PT0gb3RoZXJBdHRyaWJ1dGVzLmdldChrZXkpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IE1vZGlmaWVyUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL01vZGlmaWVyUmVuZGVyZXInO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxuICAgIERvbU9iamVjdEF0dHJpYnV0ZXMsXG4gICAgRG9tT2JqZWN0RWxlbWVudCxcbn0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyLWRvbS1vYmplY3Qvc3JjL0RvbU9iamVjdFJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIEF0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyIGV4dGVuZHMgTW9kaWZpZXJSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gQXR0cmlidXRlcztcblxuICAgIC8qKlxuICAgICAqIFJlbmRlcmluZyBmb3IgRm9ybWF0IE1vZGlmaWVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGZvcm1hdFxuICAgICAqIEBwYXJhbSBjb250ZW50c1xuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihtb2RpZmllcjogQXR0cmlidXRlcywgY29udGVudHM6IERvbU9iamVjdFtdKTogUHJvbWlzZTxEb21PYmplY3RbXT4ge1xuICAgICAgICBjb25zdCBrZXlzID0gbW9kaWZpZXIua2V5cygpO1xuICAgICAgICBjb25zdCBjbGFzc0hpc3Rvcnk6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+ID0gbW9kaWZpZXIuY2xhc3NMaXN0Lmhpc3RvcnkoKTtcbiAgICAgICAgaWYgKGtleXMubGVuZ3RoIHx8IE9iamVjdC5rZXlzKGNsYXNzSGlzdG9yeSkubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzOiBEb21PYmplY3RBdHRyaWJ1dGVzID0ge307XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2Yga2V5cykge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgZ29pbmcgdG8gdXNlIHRoZSBjbGFzcyBoaXN0b3J5IGZlYXR1cmUgYW55d2F5LlxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaGlzIGVudGlyZSBmaWxlIHNob3VsZCBwcm9iYWJseSBiZSByZW9yZ2FuaXplZCB0b1xuICAgICAgICAgICAgICAgICAgICAvLyBhdm9pZCB1c2luZyBhIGBEb21PYmplY3RBdHRyaWJ1dGVzYCBvYmplY3QgaW4gYmV0d2Vlbi5cbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IG1vZGlmaWVyLnN0eWxlLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNbbmFtZV0gPSBtb2RpZmllci5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBjb250ZW50cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IGNvbnRlbnRzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAoJ3RhZycgaW4gY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hcHBseUF0dHJpYnV0ZXMoY29udGVudCwgYXR0cmlidXRlcywgY2xhc3NIaXN0b3J5KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgICAgICAnY2hpbGRyZW4nIGluIGNvbnRlbnQgJiZcbiAgICAgICAgICAgICAgICAgICAgIWNvbnRlbnQuY2hpbGRyZW4uZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbU9iamVjdCA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEoJ3RhZycgaW4gZG9tT2JqZWN0KSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEoJ3RleHQnIGluIGRvbU9iamVjdCAmJiBkb21PYmplY3QudGV4dCA9PT0gJ1xcdTIwMGInKSxcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNvbnRlbnQuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgndGFnJyBpbiBjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FwcGx5QXR0cmlidXRlcyhjaGlsZCwgYXR0cmlidXRlcywgY2xhc3NIaXN0b3J5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gW107XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXdJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleCA8PSBjb250ZW50cy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICgndGV4dCcgaW4gY29udGVudCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkb20nIGluIGNvbnRlbnQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ2NoaWxkcmVuJyBpbiBjb250ZW50ICYmIGNvbnRlbnQuY2hpbGRyZW4ubGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNoaWxkcmVuLmluY2x1ZGVzKGNvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWc6ICdTUEFOJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBPYmplY3QuYXNzaWduKHt9LCBhdHRyaWJ1dGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnRzLnB1c2goY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZW50cyA9IG5ld0NvbnRlbnRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250ZW50cztcbiAgICB9XG5cbiAgICBwcml2YXRlIF9hcHBseUF0dHJpYnV0ZXMoXG4gICAgICAgIGNvbnRlbnQ6IERvbU9iamVjdEVsZW1lbnQsXG4gICAgICAgIGF0dHJpYnV0ZXM6IERvbU9iamVjdEF0dHJpYnV0ZXMsXG4gICAgICAgIGNsYXNzSGlzdG9yeTogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4sXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmICghY29udGVudC5hdHRyaWJ1dGVzKSBjb250ZW50LmF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgY29uc3QgYXR0ciA9IGNvbnRlbnQuYXR0cmlidXRlcztcbiAgICAgICAgZm9yIChjb25zdCBuYW1lIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXBwbHlDbGFzc0hpc3RvcnkoY29udGVudCwgY2xhc3NIaXN0b3J5KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgIGF0dHIuc3R5bGUgPSBPYmplY3QuYXNzaWduKHt9LCBhdHRyaWJ1dGVzLnN0eWxlLCBhdHRyLnN0eWxlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXR0cltuYW1lXSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSB0aGUgaGlzdG9yeSBvZiB0aGUgY2xhc3MgYXR0cmlidXRlcyBzdG9yZWQgaW4gdGhlIGdpdmVuIFJlY29yZCB0b1xuICAgICAqIHRoZSBnaXZlbiBEb21PYmplY3QuIEJhc2ljYWxseSwgaWYgdGhlIERvbU9iamVjdCBpcyByZXN0b3JpbmcgYSBjbGFzc1xuICAgICAqIHRoYXQgdXNlZCB0byBiZSBwcmVzZW50IGluIHRoZSBjbGFzcyBoaXN0b3J5LCBpdCB3aWxsIGJlIHJlb3JkZXJlZCB0b1xuICAgICAqIG1hdGNoIGl0cyBvcmlnaW5hbCBwb3NpdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb250ZW50XG4gICAgICogQHBhcmFtIGNsYXNzSGlzdG9yeVxuICAgICAqL1xuICAgIHByaXZhdGUgX2FwcGx5Q2xhc3NIaXN0b3J5KFxuICAgICAgICBjb250ZW50OiBEb21PYmplY3RFbGVtZW50LFxuICAgICAgICBjbGFzc0hpc3Rvcnk6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+LFxuICAgICk6IHZvaWQge1xuICAgICAgICAvLyBSZW9yZ2FuaXplIGBjbGFzc2Agc2V0IHRvIHJlc3RvcmUgb3JkZXIgdGhhbmtzIHRvIENsYXNzTGlzdCBoaXN0b3J5LlxuICAgICAgICBjb25zdCBjbGFzc05hbWVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGlmIChjb250ZW50LmF0dHJpYnV0ZXMuY2xhc3MpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIG9mIGNvbnRlbnQuYXR0cmlidXRlcy5jbGFzcykge1xuICAgICAgICAgICAgICAgIGlmIChjbGFzc0hpc3RvcnlbY2xhc3NOYW1lXSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lcy5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgaW4gY2xhc3NIaXN0b3J5KSB7XG4gICAgICAgICAgICBpZiAoY2xhc3NIaXN0b3J5W2NsYXNzTmFtZV0gfHwgY29udGVudC5hdHRyaWJ1dGVzLmNsYXNzPy5oYXMoY2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29udGVudC5hdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NOYW1lcztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWZXJzaW9uYWJsZU9iamVjdCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZU9iamVjdCc7XG5cbmV4cG9ydCBjbGFzcyBDbGFzc0xpc3QgZXh0ZW5kcyBWZXJzaW9uYWJsZU9iamVjdCB7XG4gICAgcHJpdmF0ZSBfY2xhc3NMaXN0OiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcbiAgICBjb25zdHJ1Y3RvciguLi5jbGFzc0xpc3Q6IHN0cmluZ1tdKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIG9mIGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgdGhpcy5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHZXR0ZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgY2xhc3NlcyBpbiB0aGUgc2V0LlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NsYXNzTGlzdCA/IHRoaXMuaXRlbXMoKS5sZW5ndGggOiAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSB0ZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBzZXQuXG4gICAgICovXG4gICAgZ2V0IGNsYXNzTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMubGVuZ3RoKSByZXR1cm47XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zKCkuam9pbignICcpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWluaXRpYWxpemUgdGhlIHNldCB3aXRoIGEgbmV3IHNldCBvZiBjbGFzc2VzLCBmcm9tIGEgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqL1xuICAgIHNldCBjbGFzc05hbWUoY2xhc3NOYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5yZXNldChjbGFzc05hbWUpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgc2V0IG9mIGNsYXNzZXMsIHBhcnNlZCBmcm9tIGEgY2xhc3NOYW1lIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjbGFzc05hbWVcbiAgICAgKi9cbiAgICBwYXJzZUNsYXNzTmFtZShjbGFzc05hbWU6IHN0cmluZyk6IFNldDxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXQoXG4gICAgICAgICAgICBjbGFzc05hbWVcbiAgICAgICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAgICAgLnNwbGl0KC9cXHMrLylcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGMgPT4gYy5sZW5ndGgpLFxuICAgICAgICApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBjbG9uZSBvZiB0aGlzIGxpc3QuXG4gICAgICovXG4gICAgY2xvbmUoKTogQ2xhc3NMaXN0IHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBuZXcgQ2xhc3NMaXN0KCk7XG4gICAgICAgIC8vIFRPRE86IE1heWJlIHRoaXMgc2hvdWxkIGNvcHkgdGhlIGVudGlyZSBoaXN0b3J5IHJhdGhlciB0aGFuIG9ubHkgdGhlXG4gICAgICAgIC8vIGN1cnJlbnRseSBhY3RpdmUgY2xhc3NlcyA/XG4gICAgICAgIGNsb25lLmFkZCguLi50aGlzLml0ZW1zKCkpO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBzZXQgaGFzIHRoZSBnaXZlbiBjbGFzcywgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGFzc0xpc3Q/LltuYW1lXSB8fCBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIGFycmF5IGNvbnRhaW5pbmcgYWxsIHRoZSBpdGVtcyBpbiB0aGUgbGlzdC5cbiAgICAgKi9cbiAgICBpdGVtcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGFzc0xpc3RcbiAgICAgICAgICAgID8gT2JqZWN0LmtleXModGhpcy5fY2xhc3NMaXN0KS5maWx0ZXIoa2V5ID0+IHRoaXMuX2NsYXNzTGlzdFtrZXldKVxuICAgICAgICAgICAgOiBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgcmVjb3JkIGNvbnRhaW5pbmcgYWxsIHRoZSBwYXN0IGFuZCBjdXJyZW50IGNsYXNzZXMuIENsYXNzZXMgdGhhdFxuICAgICAqIGFyZSBub3QgYWN0aXZlIGFueW1vcmUgaGF2ZSB0aGVpciB2YWx1ZSBzZXQgdG8gYGZhbHNlYC5cbiAgICAgKlxuICAgICAqL1xuICAgIGhpc3RvcnkoKTogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7IC4uLnRoaXMuX2NsYXNzTGlzdCB9IHx8IHt9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIHRoZSBnaXZlbiBjbGFzcyhlcykgdG8gdGhlIHNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjbGFzc05hbWVzXG4gICAgICovXG4gICAgYWRkKC4uLmNsYXNzTmFtZXM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5fY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9jbGFzc0xpc3QgPSBuZXcgVmVyc2lvbmFibGVPYmplY3QoKSBhcyBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBjbGFzc05hbWVzKSB7XG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IHRoaXMucGFyc2VDbGFzc05hbWUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgY2xhc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc0xpc3RbbmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIGNsYXNzKGVzKSBmcm9tIHRoZSBzZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2xhc3NOYW1lc1xuICAgICAqL1xuICAgIHJlbW92ZSguLi5jbGFzc05hbWVzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuX2NsYXNzTGlzdCkgcmV0dXJuO1xuICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBjbGFzc05hbWVzKSB7XG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IHRoaXMucGFyc2VDbGFzc05hbWUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgY2xhc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc0xpc3RbbmFtZV0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIHNldCBvZiBhbGwgaXRzIGNsYXNzZXMuXG4gICAgICovXG4gICAgY2xlYXIoKTogdm9pZCB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9jbGFzc0xpc3Q7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlaW5pdGlhbGl6ZSB0aGUgc2V0IHdpdGggYSBuZXcgc2V0IG9mIGNsYXNzZXMgKGVtcHR5IGlmIG5vIGFyZ3VtZW50IGlzXG4gICAgICogcGFzc2VkKS4gVGhlIGFyZ3VtZW50IGNhbiBiZSBhIHNldCBvZiBjbGFzc2VzIG9yIGEgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNsYXNzTGlzdFxuICAgICAqL1xuICAgIHJlc2V0KC4uLmNsYXNzTGlzdDogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2NsYXNzTGlzdDtcbiAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICB0aGlzLmFkZChjbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBlYWNoIGdpdmVuIGNsYXNzLCBhZGQgaXQgdG8gdGhlIHNldCBpZiBpdCBkb2Vzbid0IGhhdmUgaXQgeWV0LFxuICAgICAqIG90aGVyd2lzZSByZW1vdmUgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2xhc3Nlc1xuICAgICAqL1xuICAgIHRvZ2dsZSguLi5jbGFzc2VzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuX2NsYXNzTGlzdCkge1xuICAgICAgICAgICAgdGhpcy5fY2xhc3NMaXN0ID0gbmV3IFZlcnNpb25hYmxlT2JqZWN0KCkgYXMgUmVjb3JkPHN0cmluZywgYm9vbGVhbj47XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgY2xhc3Nlcykge1xuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IHRoaXMucGFyc2VDbGFzc05hbWUoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgcGFyc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jbGFzc0xpc3RbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NsYXNzTGlzdFtuYW1lXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xhc3NMaXN0W25hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IFZlcnNpb25hYmxlT2JqZWN0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlT2JqZWN0JztcbmltcG9ydCB7IG1ha2VWZXJzaW9uYWJsZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01lbW9yeS9WZXJzaW9uYWJsZSc7XG5cbmV4cG9ydCBjbGFzcyBDc3NTdHlsZSBleHRlbmRzIFZlcnNpb25hYmxlT2JqZWN0IHtcbiAgICBwcml2YXRlIF9zdHlsZTogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICBjb25zdHJ1Y3RvcihzdHlsZT86IHN0cmluZyB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKHN0eWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KHN0eWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHZXR0ZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2Ygc3R5bGVzIGluIHRoZSBzZXQuXG4gICAgICovXG4gICAgZ2V0IGxlbmd0aCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3R5bGUgPyBPYmplY3Qua2V5cyh0aGlzLl9zdHlsZSkubGVuZ3RoIDogMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiB0aGUgQ1NTIGRlY2xhcmF0aW9uIGJsb2NrLlxuICAgICAqL1xuICAgIGdldCBjc3NUZXh0KCk6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5fc3R5bGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5fc3R5bGUpO1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHRoaXMuX3N0eWxlKS5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWVSZXByID0gW107XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgIHZhbHVlUmVwci5wdXNoKGAke2tleX06ICR7dGhpcy5fc3R5bGVba2V5XX1gKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0ID0gdmFsdWVSZXByLmpvaW4oJzsgJyk7XG4gICAgICAgIGlmICh2YWx1ZVJlcHIubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gJzsnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlaW5pdGlhbGl6ZSB0aGUgcmVjb3JkIHdpdGggYSBuZXcgcmVjb3JkIG9mIHN0eWxlcywgZnJvbSBhIHN0cmluZyB0b1xuICAgICAqIHBhcnNlLlxuICAgICAqL1xuICAgIHNldCBjc3NUZXh0KGNzc1RleHQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnJlc2V0KGNzc1RleHQpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgcmVjb3JkIG9mIHN0eWxlcywgcGFyc2VkIGZyb20gYSBjc3NUZXh0IHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjbGFzc05hbWVcbiAgICAgKi9cbiAgICBwYXJzZUNzc1RleHQoY3NzVGV4dDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHN0eWxlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIHJldHVybiBjc3NUZXh0XG4gICAgICAgICAgICAuc3BsaXQoJzsnKVxuICAgICAgICAgICAgLm1hcChzdHlsZSA9PiBzdHlsZS50cmltKCkpXG4gICAgICAgICAgICAuZmlsdGVyKHN0eWxlID0+IHN0eWxlLmxlbmd0aClcbiAgICAgICAgICAgIC5yZWR1Y2UoKGFjY3VtdWxhdG9yLCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtrZXksIHZdID0gdmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICBzdHlsZVtrZXkudHJpbSgpXSA9IHYudHJpbSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgICAgICAgIH0sIHN0eWxlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgY2xvbmUgb2YgdGhpcyByZWNvcmQuXG4gICAgICovXG4gICAgY2xvbmUoKTogQ3NzU3R5bGUge1xuICAgICAgICBjb25zdCBjbG9uZSA9IG5ldyBDc3NTdHlsZSgpO1xuICAgICAgICBpZiAodGhpcy5fc3R5bGUpIHtcbiAgICAgICAgICAgIGNsb25lLl9zdHlsZSA9IG1ha2VWZXJzaW9uYWJsZSh7IC4uLnRoaXMuX3N0eWxlIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBzdHlsZSB2YWx1ZSBhcyByZWNvcmQuXG4gICAgICovXG4gICAgdG9KU09OKCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fc3R5bGUpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgcmVjb3JkIGhhcyB0aGUgZ2l2ZW4gc3R5bGUsIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKi9cbiAgICBoYXMoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5fc3R5bGU/LltrZXldO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIGtleXMgaW4gdGhlIHJlY29yZC5cbiAgICAgKi9cbiAgICBrZXlzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlID8gT2JqZWN0LmtleXModGhpcy5fc3R5bGUpIDogW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBjb250YWluaW5nIGFsbCB0aGUgdmFsdWVzIGluIHRoZSByZWNvcmQuXG4gICAgICovXG4gICAgdmFsdWVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlID8gT2JqZWN0LnZhbHVlcyh0aGlzLl9zdHlsZSkgOiBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSByZWNvcmQgbWF0Y2hpbmcgdGhlIGdpdmVuIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqL1xuICAgIGdldChuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3R5bGU/LltuYW1lXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSByZWNvcmRzIHdpdGggdGhlIGdpdmVuIG5hbWVzIHRvIHRoZSBnaXZlbiB2YWx1ZXMuXG4gICAgICogRWc6IGBzZXQoeyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJyB9KTtgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFpcnMgW25hbWUsIHZhbHVlXVxuICAgICAqL1xuICAgIHNldChwYWlyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPik6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSByZWNvcmQgd2l0aCB0aGUgZ2l2ZW4gbmFtZSB0byB0aGUgZ2l2ZW4gdmFsdWUuXG4gICAgICogRWc6IGBzZXQoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7YFxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKi9cbiAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZDtcbiAgICBzZXQocGFpcnNPck5hbWU6IHN0cmluZyB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIHZhbHVlPzogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5fc3R5bGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlID0gbWFrZVZlcnNpb25hYmxlKHt9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHBhaXJzT3JOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy5fc3R5bGVbcGFpcnNPck5hbWVdID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmtleXMocGFpcnNPck5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVbbmFtZV0gPSBwYWlyc09yTmFtZVtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIHJlY29yZChzKSB3aXRoIHRoZSBnaXZlbiBuYW1lKHMpLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICByZW1vdmUoLi4ubmFtZXM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9zdHlsZSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIG5hbWVzKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3N0eWxlW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSByZWNvcmQgb2YgYWxsIGl0cyBzdHlsZXMuXG4gICAgICovXG4gICAgY2xlYXIoKTogdm9pZCB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9zdHlsZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVpbml0aWFsaXplIHRoZSByZWNvcmQgd2l0aCBhIG5ldyByZWNvcmQgb2Ygc3R5bGVzIChlbXB0eSBpZiBubyBhcmd1bWVudFxuICAgICAqIGlzIHBhc3NlZCkuIFRoZSBhcmd1bWVudCBjYW4gYmUgYSByZWNvcmQgb2Ygc3R5bGVzIG9yIGEgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHN0eWxlXG4gICAgICovXG4gICAgcmVzZXQoc3R5bGU6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCBzdHJpbmcgPSAnJyk6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHN0eWxlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHN0eWxlKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdHlsZSA9IG1ha2VWZXJzaW9uYWJsZShzdHlsZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9zdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChzdHlsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlID0gbWFrZVZlcnNpb25hYmxlKHRoaXMucGFyc2VDc3NUZXh0KHN0eWxlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fc3R5bGU7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgRGVmYXVsdFhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSAnZG9tL3htbCc7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogTm9kZSk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAvLyBJZiB0aGUgbm9kZSBjb3VsZCBub3QgYmUgcGFyc2VkLCBjcmVhdGUgYSBnZW5lcmljIGVsZW1lbnQgbm9kZSB3aXRoXG4gICAgICAgIC8vIHRoZSBIVE1MIHRhZyBvZiB0aGUgRE9NIE5vZGUuIFRoaXMgd2F5IHdlIG1heSBub3Qgc3VwcG9ydCB0aGUgbm9kZVxuICAgICAgICAvLyBidXQgd2UgZG9uJ3QgYnJlYWsgaXQgZWl0aGVyLlxuICAgICAgICBjb25zdCBlbGVtZW50ID0gbmV3IFZFbGVtZW50KHsgaHRtbFRhZzogbm9kZU5hbWUoaXRlbSkgfSk7XG4gICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQubW9kaWZpZXJzLmFwcGVuZChhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIGVsZW1lbnQuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgcmV0dXJuIFtlbGVtZW50XTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQXR0cmlidXRlc0RvbU9iamVjdE1vZGlmaWVyUmVuZGVyZXIgfSBmcm9tICcuL0F0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIFhtbDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtQYXJzZXIsIFJlbmRlcmVyXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNpbmdFbmdpbmVzOiBbWG1sRG9tUGFyc2luZ0VuZ2luZV0sXG4gICAgICAgIHJlbmRlcmVyczogW0F0dHJpYnV0ZXNEb21PYmplY3RNb2RpZmllclJlbmRlcmVyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSwgUGFyc2luZ0lkZW50aWZpZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IERlZmF1bHRYbWxEb21QYXJzZXIgfSBmcm9tICcuL0RlZmF1bHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4vQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBYbWxEb21QYXJzaW5nRW5naW5lPFQgZXh0ZW5kcyBOb2RlID0gTm9kZT4gZXh0ZW5kcyBQYXJzaW5nRW5naW5lPFQ+IHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgaWQ6IFBhcnNpbmdJZGVudGlmaWVyID0gJ2RvbS94bWwnO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UGFyc2VyID0gRGVmYXVsdFhtbERvbVBhcnNlcjtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG5vZGUncyBhdHRyaWJ1dGVzIGFuZCByZXR1cm4gdGhlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgcGFyc2VBdHRyaWJ1dGVzKG5vZGU6IEVsZW1lbnQpOiBBdHRyaWJ1dGVzIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVzKG5vZGUuYXR0cmlidXRlcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgWW91dHViZVhtbERvbVBhcnNlciB9IGZyb20gJy4vWW91dHViZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBZb3V0dWJlRG9tT2JqZWN0UmVuZGVyZXIgfSBmcm9tICcuL1lvdXR1YmVEb21PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIFlvdXR1YmU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1lvdXR1YmVYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtZb3V0dWJlRG9tT2JqZWN0UmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBOb2RlUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL05vZGVSZW5kZXJlcic7XG5pbXBvcnQgeyBZb3V0dWJlTm9kZSB9IGZyb20gJy4vWW91dHViZU5vZGUnO1xuaW1wb3J0IHtcbiAgICBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUsXG4gICAgRG9tT2JqZWN0LFxufSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXItZG9tLW9iamVjdC9zcmMvRG9tT2JqZWN0UmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIFlvdXR1YmVEb21PYmplY3RSZW5kZXJlciBleHRlbmRzIE5vZGVSZW5kZXJlcjxEb21PYmplY3Q+IHtcbiAgICBzdGF0aWMgaWQgPSBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBEb21PYmplY3RSZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gWW91dHViZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxEb21PYmplY3Q+IHtcbiAgICAgICAgY29uc3QgeW91dHViZTogRG9tT2JqZWN0ID0ge1xuICAgICAgICAgICAgdGFnOiAnSUZSQU1FJyxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHlvdXR1YmU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgWW91dHViZU5vZGUgZXh0ZW5kcyBJbmxpbmVOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IFlvdXR1YmVOb2RlIH0gZnJvbSAnLi9Zb3V0dWJlTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFlvdXR1YmVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICBjb25zdCBpc1lvdXR1YmVWaWRlbyA9XG4gICAgICAgICAgICBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgbm9kZU5hbWUoaXRlbSkgPT09ICdJRlJBTUUnICYmXG4gICAgICAgICAgICBpdGVtLmdldEF0dHJpYnV0ZSgnc3JjJykuaW5jbHVkZXMoJ3lvdXR1Jyk7XG4gICAgICAgIHJldHVybiBpc1lvdXR1YmVWaWRlbztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8WW91dHViZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCB5b3V0dWJlID0gbmV3IFlvdXR1YmVOb2RlKCk7XG4gICAgICAgIHlvdXR1YmUubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICByZXR1cm4gW3lvdXR1YmVdO1xuICAgIH1cbn1cbiIsIi8qKlxuICogUmV0dXJuIHRoZSBkZWVwZXN0IGNoaWxkIG9mIGEgZ2l2ZW4gY29udGFpbmVyIGF0IGEgZ2l2ZW4gb2Zmc2V0LCBhbmQgaXRzXG4gKiBhZGFwdGVkIG9mZnNldC5cbiAqXG4gKiBAcGFyYW0gY29udGFpbmVyXG4gKiBAcGFyYW0gb2Zmc2V0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXJnZXREZWVwZXN0KGNvbnRhaW5lcjogTm9kZSwgb2Zmc2V0OiBudW1iZXIpOiBbTm9kZSwgbnVtYmVyXSB7XG4gICAgd2hpbGUgKGNvbnRhaW5lci5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICAgICAgbGV0IGNoaWxkTm9kZXM6IE5vZGVMaXN0T2Y8Q2hpbGROb2RlPjtcbiAgICAgICAgaWYgKGNvbnRhaW5lciBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgY29udGFpbmVyLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIGNoaWxkTm9kZXMgPSBjb250YWluZXIuc2hhZG93Um9vdC5jaGlsZE5vZGVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hpbGROb2RlcyA9IGNvbnRhaW5lci5jaGlsZE5vZGVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQgPj0gY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5sYXN0Q2hpbGQ7XG4gICAgICAgICAgICAvLyBUaGUgbmV3IGNvbnRhaW5lciBtaWdodCBiZSBhIHRleHQgbm9kZSwgc28gY29uc2lkZXJpbmcgb25seVxuICAgICAgICAgICAgLy8gdGhlIGBjaGlsZE5vZGVzYCBwcm9wZXJ0eSB3b3VsZCBiZSB3cm9uZy5cbiAgICAgICAgICAgIG9mZnNldCA9IG5vZGVMZW5ndGgoY29udGFpbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRhaW5lciA9IGNoaWxkTm9kZXNbb2Zmc2V0XTtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFtjb250YWluZXIsIG9mZnNldF07XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSBsZW5ndGggb2YgYSBET00gTm9kZS5cbiAqXG4gKiBAcGFyYW0gbm9kZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9kZUxlbmd0aChub2RlOiBOb2RlKTogbnVtYmVyIHtcbiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVZhbHVlLmxlbmd0aDtcbiAgICB9IGVsc2UgaWYgKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGUuc2hhZG93Um9vdCkge1xuICAgICAgICByZXR1cm4gbm9kZS5zaGFkb3dSb290LmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBub2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm4gaWYgdGhlIG5vZGUgaXMgYSB0ZXh0IG5vZGUuIERvbid0IHVzZSBpbnN0YW5jZSBvZiB0byBhbGxvdyBpZnJhbWVcbiAqIHVzZXMuXG4gKlxuICogQHBhcmFtIG5vZGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVGV4dE5vZGUobm9kZTogTm9kZSk6IG5vZGUgaXMgVGV4dCB7XG4gICAgcmV0dXJuIG5vZGUubm9kZU5hbWUgPT09ICcjdGV4dCc7XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMYXlvdXRDb250YWluZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvTGF5b3V0Q29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBEb21Qb2ludCB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXRFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgRG9tTWFwIHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9mcm9tRG9tID0gbmV3IE1hcDxOb2RlLCBWTm9kZVtdPigpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3RvRG9tID0gbmV3IE1hcDxWTm9kZSwgRG9tUG9pbnRbXT4oKTtcbiAgICAvKipcbiAgICAgKiBNYXAgdGhlIGdpdmVuIFZOb2RlIHRvIGl0cyBjb3JyZXNwb25kaW5nIERPTSBOb2RlIGFuZCBpdHMgb2Zmc2V0IGluIGl0LlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gZG9tTm9kZVxuICAgICAqIEBwYXJhbSBvZmZzZXRcbiAgICAgKiBAcGFyYW0gbWV0aG9kXG4gICAgICovXG4gICAgc2V0KG5vZGU6IFZOb2RlLCBkb21Ob2RlOiBOb2RlLCBvZmZzZXQgPSAwLCBtZXRob2QgPSAncHVzaCcpOiB2b2lkIHtcbiAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBMYXlvdXRDb250YWluZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fZnJvbURvbS5oYXMoZG9tTm9kZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSB0aGlzLl9mcm9tRG9tLmdldChkb21Ob2RlKTtcbiAgICAgICAgICAgIGlmICghbWF0Y2hlcy5zb21lKChtYXRjaDogVk5vZGUpID0+IG1hdGNoLmlkID09PSBub2RlLmlkKSkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXNbbWV0aG9kXShub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2Zyb21Eb20uc2V0KGRvbU5vZGUsIFtub2RlXSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbG9jYXRpb25zID0gdGhpcy5fdG9Eb20uZ2V0KG5vZGUpIHx8IFtdO1xuICAgICAgICBsb2NhdGlvbnMucHVzaChbZG9tTm9kZSwgb2Zmc2V0XSk7XG4gICAgICAgIHRoaXMuX3RvRG9tLnNldChub2RlLCBsb2NhdGlvbnMpO1xuXG4gICAgICAgIC8vIFNldCBjaGlsZHJlbi5cbiAgICAgICAgZm9yIChjb25zdCByZW5kZXJlZENoaWxkIG9mIGRvbU5vZGUuY2hpbGROb2Rlcykge1xuICAgICAgICAgICAgY29uc3QgbWFwcGluZyA9IHRoaXMudG9Eb21Qb2ludChub2RlKTtcbiAgICAgICAgICAgIGlmICghbWFwcGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0KG5vZGUsIHJlbmRlcmVkQ2hpbGQsIC0xLCAndW5zaGlmdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgVk5vZGUocykgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gRE9NIE5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9tTm9kZVxuICAgICAqL1xuICAgIGZyb21Eb20oZG9tTm9kZTogTm9kZSk6IFZOb2RlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZnJvbURvbS5nZXQoZG9tTm9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgYXJyYXkgb2YgdHVwbGUgKG5vZGUsIG51bWJlcikgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIHRvRG9tUG9pbnQobm9kZTogVk5vZGUpOiBEb21Qb2ludFtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RvRG9tLmdldChub2RlKSB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBET00gTm9kZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgdG9Eb20obm9kZTogVk5vZGUpOiBOb2RlW10ge1xuICAgICAgICBjb25zdCBkb21Ob2RlczogTm9kZVtdID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcG9pbnQgb2YgdGhpcy5fdG9Eb20uZ2V0KG5vZGUpIHx8IFtdKSB7XG4gICAgICAgICAgICBkb21Ob2Rlcy5wdXNoKHBvaW50WzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZG9tTm9kZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSBtYXAgb2YgYWxsIGNvcnJlc3BvbmRhbmNlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbbm9kZV1cbiAgICAgKi9cbiAgICBjbGVhcihub2RlPzogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKG5vZGUpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcG9pbnQgb2YgdGhpcy5fdG9Eb20uZ2V0KG5vZGUpIHx8IFtdKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLl9mcm9tRG9tLmdldChwb2ludFswXSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBub2Rlcy5pbmRleE9mKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuc3BsaWNlKGluZGV4LCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mcm9tRG9tLmRlbGV0ZShwb2ludFswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdG9Eb20uZGVsZXRlKG5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZnJvbURvbS5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fdG9Eb20uY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IFZlcnNpb25hYmxlT2JqZWN0IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTWVtb3J5L1ZlcnNpb25hYmxlT2JqZWN0JztcbmltcG9ydCB7IFZlcnNpb25hYmxlQXJyYXkgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGVBcnJheSc7XG5pbXBvcnQgeyBtYWtlVmVyc2lvbmFibGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGUnO1xuaW1wb3J0IHsgVmVyc2lvbmFibGVTZXQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9NZW1vcnkvVmVyc2lvbmFibGVTZXQnO1xuXG4vKipcbiAqIEFic3RyYWN0IGNsYXNzIHRvIGFkZCBldmVudCBtZWNoYW5pc20uXG4gKi9cbmV4cG9ydCBjbGFzcyBFdmVudE1peGluIGV4dGVuZHMgVmVyc2lvbmFibGVPYmplY3Qge1xuICAgIF9ldmVudENhbGxiYWNrczogUmVjb3JkPHN0cmluZywgRnVuY3Rpb25bXT47XG4gICAgX2NhbGxiYWNrV29ya2luZzogU2V0PEZ1bmN0aW9uPjtcblxuICAgIC8qKlxuICAgICAqIFN1YnNjcmliZSB0byBhbiBldmVudCB3aXRoIGEgY2FsbGJhY2suXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICovXG4gICAgb24oZXZlbnROYW1lOiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbik6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuX2V2ZW50Q2FsbGJhY2tzKSB7XG4gICAgICAgICAgICB0aGlzLl9ldmVudENhbGxiYWNrcyA9IG1ha2VWZXJzaW9uYWJsZSh7fSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9ldmVudENhbGxiYWNrc1tldmVudE5hbWVdKSB7XG4gICAgICAgICAgICB0aGlzLl9ldmVudENhbGxiYWNrc1tldmVudE5hbWVdID0gbmV3IFZlcnNpb25hYmxlQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9ldmVudENhbGxiYWNrc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmUgYW4gZXZlbnQgZm9yIG9mIHRoaXMgb2JqZWN0IGFuZCBhbGwgYW5jZXN0b3JzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZVxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICovXG4gICAgdHJpZ2dlcjxBPihldmVudE5hbWU6IHN0cmluZywgYXJncz86IEEpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuX2V2ZW50Q2FsbGJhY2tzPy5bZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jYWxsYmFja1dvcmtpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFja1dvcmtpbmcgPSBuZXcgVmVyc2lvbmFibGVTZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgY2FsbGJhY2sgb2YgdGhpcy5fZXZlbnRDYWxsYmFja3NbZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY2FsbGJhY2tXb3JraW5nLmhhcyhjYWxsYmFjaykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2tXb3JraW5nLmFkZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFja1dvcmtpbmcuZGVsZXRlKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFdmVudE1peGluIH0gZnJvbSAnLi9FdmVudE1peGluJztcblxuZXhwb3J0IGNsYXNzIFJlYWN0aXZlVmFsdWU8VD4gZXh0ZW5kcyBFdmVudE1peGluIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIF92YWx1ZT86IFQpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoaXMgcmVhY3RpdmVWYWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7VH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmaXJlPXRydWVdIEZpcmUgYW4gZXZlbnQgaWYgdHJ1ZS5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgICAgKiBAbWVtYmVyb2YgUmVhY3RpdmVWYWx1ZVxuICAgICAqL1xuICAgIHNldCh2YWx1ZTogVCwgZmlyZSA9IHRydWUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl92YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChmaXJlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdzZXQnLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZhbHVlIG9mIHRoaXMgcmVhY3RpdmVWYWx1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtUfVxuICAgICAqIEBtZW1iZXJvZiBSZWFjdGl2ZVZhbHVlXG4gICAgICovXG4gICAgZ2V0KCk6IFQge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRG9tTWFwIH0gZnJvbSAnLi9Eb21NYXAnO1xuaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFZOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uLCBQb2ludCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgbm9kZUxlbmd0aCB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IERpcmVjdGlvbiwgVlNlbGVjdGlvbkRlc2NyaXB0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUVsZW1lbnQoZWRpdG9yOiBKV0VkaXRvciwgZWxlbWVudDogSFRNTEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICBjb25zdCBwYXJzZXIgPSBlZGl0b3IucGx1Z2lucy5nZXQoUGFyc2VyKTtcbiAgICBjb25zdCBkb21QYXJzZXJFbmdpbmUgPSBwYXJzZXIuZW5naW5lc1snZG9tL2h0bWwnXSBhcyBQYXJzaW5nRW5naW5lPE5vZGU+O1xuICAgIGlmICghZG9tUGFyc2VyRW5naW5lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVG8gdXNlIHRoaXMgcGFyc2luZyB1dGlscyB5b3UgbXVzdCBhZGQgdGhlIEh0bWwgcGx1Z2luLicpO1xuICAgIH1cbiAgICBjb25zdCBwYXJzZWRWTm9kZXMgPSBhd2FpdCBkb21QYXJzZXJFbmdpbmUucGFyc2UoZWxlbWVudCk7XG4gICAgY29uc3QgZG9tU2VsZWN0aW9uID0gZWxlbWVudC5vd25lckRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgIGNvbnN0IGFuY2hvck5vZGUgPSBkb21TZWxlY3Rpb24uYW5jaG9yTm9kZTtcbiAgICBpZiAoZWxlbWVudCA9PT0gYW5jaG9yTm9kZSB8fCBlbGVtZW50LmNvbnRhaW5zKGFuY2hvck5vZGUpKSB7XG4gICAgICAgIGNvbnN0IGRvbU1hcCA9IG5ldyBEb21NYXAoKTtcblxuICAgICAgICAvLyBDb25zdHJ1Y3QgRE9NIG1hcCBmcm9tIHRoZSBwYXJzaW5nIGluIG9yZGVyIHRvIHBhcnNlIHRoZSBzZWxlY3Rpb24uXG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJzZWRWTm9kZXMpIHtcbiAgICAgICAgICAgIGRvbU1hcC5zZXQobm9kZSwgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBbZG9tTm9kZSwgbm9kZXNdIG9mIGRvbVBhcnNlckVuZ2luZS5wYXJzaW5nTWFwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgICAgICBkb21NYXAuc2V0KG5vZGUsIGRvbU5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgX2xvY2F0ZSA9IChkb21Ob2RlOiBOb2RlLCBkb21PZmZzZXQ6IG51bWJlcik6IFBvaW50ID0+IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV0dXJuIGEgcG9zaXRpb24gaW4gdGhlIFZOb2RlcyBhcyBhIHR1cGxlIGNvbnRhaW5pbmcgYSByZWZlcmVuY2VcbiAgICAgICAgICAgICAqIG5vZGUgYW5kIGEgcmVsYXRpdmUgcG9zaXRpb24gd2l0aCByZXNwZWN0IHRvIHRoaXMgbm9kZSAoJ0JFRk9SRScgb3JcbiAgICAgICAgICAgICAqICdBRlRFUicpLiBUaGUgcG9zaXRpb24gaXMgYWx3YXlzIGdpdmVuIG9uIHRoZSBsZWFmLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSBjb250YWluZXJcbiAgICAgICAgICAgICAqIEBwYXJhbSBvZmZzZXRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbGV0IGZvcmNlQWZ0ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBmb3JjZVByZXBlbmQgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBkb21Ob2RlLmNoaWxkTm9kZXNbZG9tT2Zmc2V0XSB8fCBkb21Ob2RlO1xuICAgICAgICAgICAgbGV0IG9mZnNldCA9IGNvbnRhaW5lciA9PT0gZG9tTm9kZSA/IGRvbU9mZnNldCA6IDA7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyID09PSBkb21Ob2RlICYmIGNvbnRhaW5lci5jaGlsZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5jaGlsZE5vZGVzW2NvbnRhaW5lci5jaGlsZE5vZGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IG5vZGVMZW5ndGgoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBmb3JjZUFmdGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICghZG9tTWFwLmZyb21Eb20oY29udGFpbmVyKSkge1xuICAgICAgICAgICAgICAgIGZvcmNlQWZ0ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3JjZVByZXBlbmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgICAgICBmb3JjZUFmdGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gY29udGFpbmVyLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gbm9kZUxlbmd0aChjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcmNlUHJlcGVuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IFtdLmluZGV4T2YuY2FsbChjb250YWluZXIucGFyZW50Tm9kZS5jaGlsZE5vZGVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSBjb250YWluZXIucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdoZW4gdGFyZ2V0dGluZyB0aGUgZW5kIG9mIGEgbm9kZSwgdGhlIERPTSBnaXZlcyBhbiBvZmZzZXQgdGhhdCBpc1xuICAgICAgICAgICAgLy8gZXF1YWwgdG8gdGhlIGxlbmd0aCBvZiB0aGUgY29udGFpbmVyLiBJbiBvcmRlciB0byByZXRyaWV2ZSB0aGUgbGFzdFxuICAgICAgICAgICAgLy8gZGVzY2VuZGVudCwgd2UgbmVlZCB0byBtYWtlIHN1cmUgd2UgdGFyZ2V0IGFuIGV4aXN0aW5nIG5vZGUsIGllLiBhblxuICAgICAgICAgICAgLy8gZXhpc3RpbmcgaW5kZXguXG4gICAgICAgICAgICBjb25zdCBpc0FmdGVyRW5kID0gb2Zmc2V0ID49IG5vZGVMZW5ndGgoY29udGFpbmVyKTtcbiAgICAgICAgICAgIGxldCBpbmRleCA9IGlzQWZ0ZXJFbmQgPyBub2RlTGVuZ3RoKGNvbnRhaW5lcikgLSAxIDogb2Zmc2V0O1xuICAgICAgICAgICAgLy8gTW92ZSB0byBkZWVwZXN0IGNoaWxkIG9mIGNvbnRhaW5lci5cbiAgICAgICAgICAgIHdoaWxlIChjb250YWluZXIuaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjb250YWluZXIuY2hpbGROb2Rlc1tpbmRleF07XG4gICAgICAgICAgICAgICAgaWYgKCFkb21NYXAuZnJvbURvbShjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNoaWxkO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaXNBZnRlckVuZCA/IG5vZGVMZW5ndGgoY29udGFpbmVyKSAtIDEgOiAwO1xuICAgICAgICAgICAgICAgIC8vIEFkYXB0IHRoZSBvZmZzZXQgdG8gYmUgaXRzIGVxdWl2YWxlbnQgd2l0aGluIHRoZSBuZXcgY29udGFpbmVyLlxuICAgICAgICAgICAgICAgIG9mZnNldCA9IGlzQWZ0ZXJFbmQgPyBub2RlTGVuZ3RoKGNvbnRhaW5lcikgOiBpbmRleDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBkb21NYXAuZnJvbURvbShjb250YWluZXIpO1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIFZOb2RlcyBtYXRjaGluZyB0aGUgY29udGFpbmVyLlxuICAgICAgICAgICAgbGV0IHJlZmVyZW5jZTogVk5vZGU7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICAgICAgICAgIC8vIFRoZSByZWZlcmVuY2UgaXMgdGhlIGluZGV4LXRoIG1hdGNoIChlZy46IHRleHQgc3BsaXQgaW50byBjaGFycykuXG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gZm9yY2VBZnRlciA/IG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdIDogbm9kZXNbaW5kZXhdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSBub2Rlc1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmb3JjZUFmdGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtyZWZlcmVuY2UsIFJlbGF0aXZlUG9zaXRpb24uQUZURVJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcmNlUHJlcGVuZCAmJiByZWZlcmVuY2UgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtyZWZlcmVuY2UsIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlZmVyZW5jZS5sb2NhdGUoY29udGFpbmVyLCBvZmZzZXQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFBhcnNlIHRoZSBkb20gc2VsZWN0aW9uIGludG8gdGhlIGRlc2NyaXB0aW9uIG9mIGEgVlNlbGVjdGlvbi5cbiAgICAgICAgY29uc3Qgc3RhcnQgPSBfbG9jYXRlKGRvbVNlbGVjdGlvbi5hbmNob3JOb2RlLCBkb21TZWxlY3Rpb24uYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgY29uc3QgZW5kID0gX2xvY2F0ZShkb21TZWxlY3Rpb24uZm9jdXNOb2RlLCBkb21TZWxlY3Rpb24uZm9jdXNPZmZzZXQpO1xuICAgICAgICBjb25zdCBbc3RhcnRWTm9kZSwgc3RhcnRQb3NpdGlvbl0gPSBzdGFydDtcbiAgICAgICAgY29uc3QgW2VuZFZOb2RlLCBlbmRQb3NpdGlvbl0gPSBlbmQ7XG4gICAgICAgIGxldCBkaXJlY3Rpb246IERpcmVjdGlvbjtcbiAgICAgICAgaWYgKGRvbVNlbGVjdGlvbiBpbnN0YW5jZW9mIFNlbGVjdGlvbikge1xuICAgICAgICAgICAgY29uc3QgZG9tUmFuZ2UgPSBkb21TZWxlY3Rpb24ucmFuZ2VDb3VudCAmJiBkb21TZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBkb21SYW5nZS5zdGFydENvbnRhaW5lciA9PT0gZG9tU2VsZWN0aW9uLmFuY2hvck5vZGUgJiZcbiAgICAgICAgICAgICAgICBkb21SYW5nZS5zdGFydE9mZnNldCA9PT0gZG9tU2VsZWN0aW9uLmFuY2hvck9mZnNldFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gRGlyZWN0aW9uLkZPUldBUkQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5CQUNLV0FSRDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzZWxlY3Rpb246IFZTZWxlY3Rpb25EZXNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgIGFuY2hvck5vZGU6IHN0YXJ0Vk5vZGUsXG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbjogc3RhcnRQb3NpdGlvbixcbiAgICAgICAgICAgIGZvY3VzTm9kZTogZW5kVk5vZGUsXG4gICAgICAgICAgICBmb2N1c1Bvc2l0aW9uOiBlbmRQb3NpdGlvbixcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICB9O1xuICAgICAgICBlZGl0b3Iuc2VsZWN0aW9uLnNldChzZWxlY3Rpb24pO1xuXG4gICAgICAgIGRvbU1hcC5jbGVhcigpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJzZWRWTm9kZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUVkaXRhYmxlKFxuICAgIGVkaXRvcjogSldFZGl0b3IsXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgYXV0b2ZvY3VzID0gZmFsc2UsXG4pOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICBjb25zdCBub2RlcyA9IGF3YWl0IHBhcnNlRWxlbWVudChlZGl0b3IsIGVsZW1lbnQpO1xuICAgIG5vZGVzWzBdLmVkaXRhYmxlID0gZmFsc2U7XG4gICAgbm9kZXNbMF0uYnJlYWthYmxlID0gZmFsc2U7XG4gICAgbm9kZXNbMF0ubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zZXQoJ2NvbnRlbnRFZGl0YWJsZScsICd0cnVlJyk7XG4gICAgaWYgKGF1dG9mb2N1cyAmJiAhZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IucGFyZW50KSB7XG4gICAgICAgIGlmIChub2Rlc1swXS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICBlZGl0b3Iuc2VsZWN0aW9uLnNldEF0KG5vZGVzWzBdLmZpcnN0Q2hpbGQoKSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWRpdG9yLnNlbGVjdGlvbi5zZXRBdChub2Rlc1swXSwgUmVsYXRpdmVQb3NpdGlvbi5JTlNJREUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBub2Rlcztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUVkaXRhYmxlKGVkaXRvcjogSldFZGl0b3IsIGF1dG9mb2N1cyA9IGZhbHNlKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgY29uc3Qgcm9vdCA9IG5ldyBWRWxlbWVudCh7IGh0bWxUYWc6ICdqdy1lZGl0YWJsZScgfSk7XG4gICAgLy8gU2VtYW50aWMgZWxlbWVudHMgYXJlIGlubGluZSBieSBkZWZhdWx0LlxuICAgIC8vIFdlIG5lZWQgdG8gZ3VhcmFudGVlIGl0J3MgYSBibG9jayBzbyBpdCBjYW4gY29udGFpblxuICAgIC8vIG90aGVyIGJsb2Nrcy5cbiAgICByb290Lm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc2V0KCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsnKTtcbiAgICByb290LmVkaXRhYmxlID0gZmFsc2U7XG4gICAgcm9vdC5icmVha2FibGUgPSBmYWxzZTtcbiAgICByb290Lm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc2V0KCdjb250ZW50RWRpdGFibGUnLCAndHJ1ZScpO1xuICAgIGlmIChhdXRvZm9jdXMgJiYgIWVkaXRvci5zZWxlY3Rpb24uYW5jaG9yLnBhcmVudCkge1xuICAgICAgICBlZGl0b3Iuc2VsZWN0aW9uLnNldEF0KHJvb3QsIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFKTtcbiAgICB9XG4gICAgcmV0dXJuIFtyb290XTtcbn1cbiIsImltcG9ydCB7IEVkaXRvclN0YWdlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2UgcmVwcmVzZW50aW5nIGEgY3VzdG9tIGVycm9yIGFkYXB0aW5nIHRvIHRoZSBjb25zdHJ1Y3RvclxuICogbmFtZSBvZiB0aGUgY3VzdG9tIGVycm9yIGFuZCB0YWtpbmcgYWR2YW50YWdlIG9mIGBjYXB0dXJlU3RhY2tUcmFjZWAgb2YgVjguXG4gKlxuICogU291cmNlOlxuICogaHR0cDovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yXG4gKi9cbmV4cG9ydCBjbGFzcyBDdXN0b21FcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvciguLi5wYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoLi4ucGFyYW1zKTtcbiAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuXG4gICAgICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duLlxuICAgICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgb25seSBhdmFpbGFibGUgb24gVjguXG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIHJlcHJlc2VudGluZyBhbiBlcnJvciB0aGF0IG9jY3VycyB3aGVuIGEgZnVuY3Rpb24gb25seVxuICogYWxsb3dlZCB0byBiZSBjYWxsZWQgaW4gYSBzcGVjaWZpYyBtb2RlIGlzIGNhbGxlZCBpbiBhIGRpZmZlcmVudCBtb2RlLlxuICovXG5leHBvcnQgY2xhc3MgU3RhZ2VFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihzdGFnZTogRWRpdG9yU3RhZ2UsIC4uLnBhcmFtcykge1xuICAgICAgICBzdXBlciguLi5wYXJhbXMpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBgVGhpcyBvcGVyYXRpb24gaXMgb25seSBhbGxvd2VkIGluICR7c3RhZ2V9IHN0YWdlLmA7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2UgcmVwcmVzZW50aW5nIGFuIGVycm9yIHRoYXQgb2NjdXJzIHdoZW4gYSBWTm9kZSBnaXZlbiBhc1xuICogY2hpbGQgZnVuY3Rpb24gcGFyYW1ldGVyIGlzIGFjdHVhbGx5IG5vdCBhIGNoaWxkIG9mIHRoZSBjdXJyZW50IFZOb2RlLlxuICovXG5leHBvcnQgY2xhc3MgQ2hpbGRFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcih0aGlzTm9kZTogVk5vZGUsIG5vZGU6IFZOb2RlLCAuLi5wYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoLi4ucGFyYW1zKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gYCR7bm9kZS5uYW1lfSBpcyBub3QgYSBjaGlsZCBvZiAke3RoaXNOb2RlLm5hbWV9YDtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBpbnN0YW5jZSByZXByZXNlbnRpbmcgYW4gZXJyb3IgdGhhdCBvY2N1cnMgd2hlbiBhbiBhY3Rpb24gd291bGRcbiAqIHZpb2xhdGUgdGhlIGF0b21pY2l0eSBvZiBhIFZOb2RlLlxuICovXG5leHBvcnQgY2xhc3MgQXRvbWljaXR5RXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XG4gICAgY29uc3RydWN0b3Iobm9kZTogVk5vZGUsIC4uLnBhcmFtcykge1xuICAgICAgICBzdXBlciguLi5wYXJhbXMpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBgJHtub2RlLm5hbWV9IGlzIGF0b21pYy5gO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IGlzQmxvY2sgfSBmcm9tICcuL2lzQmxvY2snO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3Qgc3BhY2VCZWZvcmVOZXdsaW5lID0gLyhbIFxcdF0pKihcXG4pL2c7XG5jb25zdCBzcGFjZUFmdGVyTmV3bGluZSA9IC8oXFxuKShbIFxcdF0pKi9nO1xuY29uc3QgdGFicyA9IC9cXHQvZztcbmNvbnN0IG5ld2xpbmVzID0gL1xcbi9nO1xuY29uc3Qgb25seVRhYnNTcGFjZXNBbmROZXdMaW5lcyA9IC9eW1xcdCBcXG5dKiQvZztcbmNvbnN0IGNvbnNlY3V0aXZlU3BhY2UgPSAvICAqL2c7XG5jb25zdCBlbmRXaXRoU3BhY2UgPSAvWyBcXHRcXG5dJC9nO1xuY29uc3Qgc3RhcnRTcGFjZSA9IC9eICovZztcbmNvbnN0IGVuZFNwYWNlID0gL1sgXFx1MzAwMF0qJC9nO1xuXG4vKipcbiAqIFJldHVybiBhIHN0cmluZyB3aXRoIHRoZSB2YWx1ZSBvZiBhIHRleHQgbm9kZSBzdHJpcHBlZCBvZiBpdHMgZm9ybWF0dGluZ1xuICogc3BhY2UsIGFwcGx5aW5nIHRoZSB3MyBydWxlcyBmb3Igd2hpdGUgc3BhY2UgcHJvY2Vzc2luZ1xuICogVE9ETzogZGVjaWRlIHdoYXQgZXhhY3RseSB0byBkbyB3aXRoIGZvcm1hdHRpbmcgc3BhY2VzOlxuICogcmVtb3ZlLCBrZWVwLCByZWNvbXB1dGU/XG4gKlxuICogQHNlZSBodHRwczovL3d3dy53My5vcmcvVFIvY3NzLXRleHQtMy8jd2hpdGUtc3BhY2UtcHJvY2Vzc2luZ1xuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUZvcm1hdHRpbmdTcGFjZShub2RlOiBOb2RlKTogc3RyaW5nIHtcbiAgICAvLyBUT0RPOiBjaGVjayB0aGUgdmFsdWUgb2YgdGhlIGB3aGl0ZS1zcGFjZWAgcHJvcGVydHlcbiAgICBjb25zdCB0ZXh0OiBzdHJpbmcgPSBub2RlLnRleHRDb250ZW50O1xuICAgIGlmIChub2RlLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoJ1BSRSwgVEVYVEFSRUEnKSkge1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG5cbiAgICAvLyAoQ29tbWVudHMgcmVmZXIgdG8gdGhlIHczIGxpbmsgcHJvdmlkZWQgYWJvdmUuKVxuICAgIC8vIFBoYXNlIEk6IENvbGxhcHNpbmcgYW5kIFRyYW5zZm9ybWF0aW9uXG4gICAgbGV0IG5ld1RleHQgPSB0ZXh0XG4gICAgICAgIC8vIDEuIEFsbCBzcGFjZXMgYW5kIHRhYnMgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIG9yIGZvbGxvd2luZyBhXG4gICAgICAgIC8vICAgIHNlZ21lbnQgYnJlYWsgYXJlIHJlbW92ZWQuXG4gICAgICAgIC5yZXBsYWNlKHNwYWNlQmVmb3JlTmV3bGluZSwgJyQyJylcbiAgICAgICAgLnJlcGxhY2Uoc3BhY2VBZnRlck5ld2xpbmUsICckMScpXG4gICAgICAgIC8vIDIuIFNlZ21lbnQgYnJlYWtzIGFyZSB0cmFuc2Zvcm1lZCBmb3IgcmVuZGVyaW5nIGFjY29yZGluZyB0byB0aGVcbiAgICAgICAgLy8gICAgc2VnbWVudCBicmVhayB0cmFuc2Zvcm1hdGlvbiBydWxlcy5cbiAgICAgICAgLnJlcGxhY2UobmV3bGluZXMsICcgJylcbiAgICAgICAgLy8gMy4gRXZlcnkgdGFiIGlzIGNvbnZlcnRlZCB0byBhIHNwYWNlIChVKzAwMjApLlxuICAgICAgICAucmVwbGFjZSh0YWJzLCAnICcpXG4gICAgICAgIC8vIDQuIEFueSBzcGFjZSBpbW1lZGlhdGVseSBmb2xsb3dpbmcgYW5vdGhlciBjb2xsYXBzaWJsZSBzcGFjZSDigJRcbiAgICAgICAgLy8gICAgZXZlbiBvbmUgb3V0c2lkZSB0aGUgYm91bmRhcnkgb2YgdGhlIGlubGluZSBjb250YWluaW5nIHRoYXRcbiAgICAgICAgLy8gICAgc3BhY2UsIHByb3ZpZGVkIGJvdGggc3BhY2VzIGFyZSB3aXRoaW4gdGhlIHNhbWUgaW5saW5lXG4gICAgICAgIC8vICAgIGZvcm1hdHRpbmcgY29udGV4dOKAlGlzIGNvbGxhcHNlZCB0byBoYXZlIHplcm8gYWR2YW5jZSB3aWR0aC5cbiAgICAgICAgLy8gICAgKEl0IGlzIGludmlzaWJsZSwgYnV0IHJldGFpbnMgaXRzIHNvZnQgd3JhcCBvcHBvcnR1bml0eSwgaWZcbiAgICAgICAgLy8gICAgYW55LilcbiAgICAgICAgLnJlcGxhY2UoY29uc2VjdXRpdmVTcGFjZSwgJyAnKTtcblxuICAgIC8vIFBoYXNlIElJOiBUcmltbWluZyBhbmQgUG9zaXRpb25pbmdcbiAgICAvLyAxLiBBIHNlcXVlbmNlIG9mIGNvbGxhcHNpYmxlIHNwYWNlcyBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgbGluZVxuICAgIC8vICAgIChpZ25vcmluZyBhbnkgaW50ZXJ2ZW5pbmcgaW5saW5lIGJveCBib3VuZGFyaWVzKSBpcyByZW1vdmVkLlxuICAgIC8vIDEuMi4gVGhlIHNwYWNlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpbmUgaXMgY29sbGFwc2VkIGlmXG4gICAgLy8gICAgYSBzcGFjZSBpcyBwcmVzZW50IGluIHRoZSBwcmV2aW91cyBpbmxpbmUgc2libGluZ3Mgbm9kZVxuICAgIC8vICAgIHNlZSA6IGh0dHBzOi8vd3d3LnczLm9yZy9UUi9jc3MtdGV4dC0zLyNjb2xsYXBzZVxuICAgIGlmIChfaXNBdFNlZ21lbnRCcmVhayhub2RlLCAnc3RhcnQnKSB8fCBfZm9sbG93c0lubGluZVNwYWNlKG5vZGUpKSB7XG4gICAgICAgIG5ld1RleHQgPSBuZXdUZXh0LnJlcGxhY2Uoc3RhcnRTcGFjZSwgJycpO1xuICAgIH1cbiAgICAvLyAyLiBJZiB0aGUgdGFiIHNpemUgaXMgemVybywgdGFicyBhcmUgbm90IHJlbmRlcmVkLiBPdGhlcndpc2UsIGVhY2hcbiAgICAvLyAgICB0YWIgaXMgcmVuZGVyZWQgYXMgYSBob3Jpem9udGFsIHNoaWZ0IHRoYXQgbGluZXMgdXAgdGhlIHN0YXJ0IGVkZ2VcbiAgICAvLyAgICBvZiB0aGUgbmV4dCBnbHlwaCB3aXRoIHRoZSBuZXh0IHRhYiBzdG9wLiBJZiB0aGlzIGRpc3RhbmNlIGlzIGxlc3NcbiAgICAvLyAgICB0aGFuIDAuNWNoLCB0aGVuIHRoZSBzdWJzZXF1ZW50IHRhYiBzdG9wIGlzIHVzZWQgaW5zdGVhZC4gVGFiXG4gICAgLy8gICAgc3RvcHMgb2NjdXIgYXQgcG9pbnRzIHRoYXQgYXJlIG11bHRpcGxlcyBvZiB0aGUgdGFiIHNpemUgZnJvbSB0aGVcbiAgICAvLyAgICBibG9ja+KAmXMgc3RhcnRpbmcgY29udGVudCBlZGdlLiBUaGUgdGFiIHNpemUgaXMgZ2l2ZW4gYnkgdGhlXG4gICAgLy8gICAgdGFiLXNpemUgcHJvcGVydHkuXG4gICAgLy8gVE9ET1xuICAgIC8vIDMuIEEgc2VxdWVuY2UgYXQgdGhlIGVuZCBvZiBhIGxpbmUgKGlnbm9yaW5nIGFueSBpbnRlcnZlbmluZyBpbmxpbmVcbiAgICAvLyAgICBib3ggYm91bmRhcmllcykgb2YgY29sbGFwc2libGUgc3BhY2VzIChVKzAwMjApIGFuZC9vciBpZGVvZ3JhcGhpY1xuICAgIC8vICAgIHNwYWNlcyAoVSszMDAwKSB3aG9zZSB3aGl0ZS1zcGFjZSB2YWx1ZSBjb2xsYXBzZXMgc3BhY2VzIGlzXG4gICAgLy8gICAgcmVtb3ZlZC5cbiAgICBpZiAoX2lzQXRTZWdtZW50QnJlYWsobm9kZSwgJ2VuZCcpKSB7XG4gICAgICAgIG5ld1RleHQgPSBuZXdUZXh0LnJlcGxhY2UoZW5kU3BhY2UsICcnKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1RleHQ7XG59XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGlzIGltbWVkaWF0ZWx5IGZvbG93aW5nIGEgc3BhY2UgaW5zaWRlIHRoZSBzYW1lIGlubGluZSBjb250ZXh0LFxuICogdG8gc2VlIGlmIGl0cyBmcm9udGFsIHNwYWNlIG11c3QgYmUgcmVtb3ZlZC5cbiAqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IG5vZGVcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBfZm9sbG93c0lubGluZVNwYWNlKG5vZGU6IE5vZGUpOiBib29sZWFuIHtcbiAgICBsZXQgc2libGluZyA9IG5vZGUgJiYgbm9kZS5wcmV2aW91c1NpYmxpbmc7XG4gICAgaWYgKF9pc1RleHROb2RlKG5vZGUpICYmICFzaWJsaW5nKSB7XG4gICAgICAgIHNpYmxpbmcgPSBub2RlLnBhcmVudEVsZW1lbnQucHJldmlvdXNTaWJsaW5nO1xuICAgIH1cbiAgICBpZiAoIXNpYmxpbmcgfHwgaXNCbG9jayhzaWJsaW5nKSkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiAhIXNpYmxpbmcudGV4dENvbnRlbnQubWF0Y2goZW5kV2l0aFNwYWNlKTtcbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaXMgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIChgc2lkZWAgPT09ICdlbmQnKVxuICogb3IgZm9sbG93aW5nIChgc2lkZWAgPT09ICdzdGFydCcpIGEgc2VnbWVudCBicmVhaywgdG8gc2VlIGlmIGl0cyBlZGdlXG4gKiBzcGFjZSBtdXN0IGJlIHJlbW92ZWQuXG4gKiBBIHNlZ21lbnQgYnJlYWsgaXMgYSBzb3J0IG9mIGxpbmUgYnJlYWssIG5vdCBjb25zaWRlcmluZyBhdXRvbWF0aWMgYnJlYWtzXG4gKiB0aGF0IGFyZSBmdW5jdGlvbiBvZiB0aGUgc2NyZWVuIHNpemUuIEluIHRoaXMgY29udGV4dCwgYSBzZWdtZW50IGlzIHdoYXRcbiAqIHlvdSBzZWUgd2hlbiB5b3UgdHJpcGxlIGNsaWNrIGluIHRleHQgaW4gdGhlIGJyb3dzZXIuXG4gKiBFZzogYDxkaXY+PHA+4peGb25l4peGPC9wPuKXhnR3b+KXhjxicj7il4Z0aHJlZeKXhjwvZGl2PmAgd2hlcmUg4peGID0gc2VnbWVudCBicmVha3MuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBub2RlXG4gKiBAcGFyYW0geydzdGFydCd8J2VuZCd9IHNpZGVcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBfaXNBdFNlZ21lbnRCcmVhayhub2RlOiBOb2RlLCBzaWRlOiAnc3RhcnQnIHwgJ2VuZCcpOiBib29sZWFuIHtcbiAgICBjb25zdCBzaWJsaW5nU2lkZSA9IHNpZGUgPT09ICdzdGFydCcgPyAncHJldmlvdXNTaWJsaW5nJyA6ICduZXh0U2libGluZyc7XG4gICAgY29uc3Qgc2libGluZyA9IG5vZGUgJiYgbm9kZVtzaWJsaW5nU2lkZV07XG4gICAgY29uc3QgaXNBZ2FpbnN0QW5vdGhlclNlZ21lbnQgPSBzaWJsaW5nICYmIF9pc1NlZ21lbnQoc2libGluZyk7XG4gICAgY29uc3QgaXNBdEVkZ2VPZk93blNlZ21lbnQgPSBfaXNCbG9ja0VkZ2Uobm9kZSwgc2lkZSk7XG4gICAgLy8gSW4gdGhlIERPTSwgYSBzcGFjZSBiZWZvcmUgYSBCUiBpcyByZW5kZXJlZCBidXQgYSBzcGFjZSBhZnRlciBhIEJSIGlzbid0LlxuICAgIGNvbnN0IGlzQmVmb3JlQlIgPSBzaWRlID09PSAnZW5kJyAmJiBzaWJsaW5nICYmIG5vZGVOYW1lKHNpYmxpbmcpID09PSAnQlInO1xuICAgIHJldHVybiAoaXNBZ2FpbnN0QW5vdGhlclNlZ21lbnQgJiYgIWlzQmVmb3JlQlIpIHx8IGlzQXRFZGdlT2ZPd25TZWdtZW50O1xufVxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgbm9kZSBpcyBhIHNlZ21lbnQgYWNjb3JkaW5nIHRvIFczIGZvcm1hdHRpbmcgbW9kZWwuXG4gKlxuICogQHBhcmFtIG5vZGUgdG8gY2hlY2tcbiAqL1xuZnVuY3Rpb24gX2lzU2VnbWVudChub2RlOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgaWYgKG5vZGUubm9kZVR5cGUgIT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgIC8vIE9ubHkgcHJvcGVyIGVsZW1lbnRzIGNhbiBiZSBhIHNlZ21lbnQuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKG5vZGVOYW1lKG5vZGUpID09PSAnQlInKSB7XG4gICAgICAgIC8vIEJyZWFrIChCUikgdGFncyBlbmQgYSBzZWdtZW50LlxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUaGUgVzMgc3BlY2lmaWNhdGlvbiBoYXMgbWFueSBzcGVjaWZpYyBjYXNlcyB0aGF0IGRlZmluZXMgd2hhdCBpc1xuICAgICAgICAvLyBvciBpcyBub3QgYSBzZWdtZW50LiBGb3IgdGhlIG1vbWVudCwgd2Ugb25seSBoYW5kbGUgZGlzcGxheTogYmxvY2suXG4gICAgICAgIHJldHVybiBpc0Jsb2NrKG5vZGUpO1xuICAgIH1cbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIG5vZGUgaXMgYXQgdGhlIGdpdmVuIGVkZ2Ugb2YgYSBibG9jay5cbiAqXG4gKiBAcGFyYW0gbm9kZSB0byBjaGVja1xuICogQHBhcmFtIHNpZGUgb2YgdGhlIGJsb2NrIHRvIGNoZWNrICgnc3RhcnQnIG9yICdlbmQnKVxuICovXG5mdW5jdGlvbiBfaXNCbG9ja0VkZ2Uobm9kZTogTm9kZSwgc2lkZTogJ3N0YXJ0JyB8ICdlbmQnKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYW5jZXN0b3JzVXBUb0Jsb2NrOiBOb2RlW10gPSBbXTtcblxuICAgIC8vIE1vdmUgdXAgdG8gdGhlIGZpcnN0IGJsb2NrIGFuY2VzdG9yXG4gICAgbGV0IGFuY2VzdG9yID0gbm9kZTtcbiAgICB3aGlsZSAoYW5jZXN0b3IgJiYgKF9pc1RleHROb2RlKGFuY2VzdG9yKSB8fCAhX2lzU2VnbWVudChhbmNlc3RvcikpKSB7XG4gICAgICAgIGFuY2VzdG9yc1VwVG9CbG9jay5wdXNoKGFuY2VzdG9yKTtcbiAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnRFbGVtZW50O1xuICAgIH1cblxuICAgIC8vIFJldHVybiB0cnVlIGlmIG5vIGFuY2VzdG9yIHVwIHRvIHRoZSBmaXJzdCBibG9jayBhbmNlc3RvciBoYXMgYVxuICAgIC8vIHNpYmxpbmcgb24gdGhlIHNwZWNpZmllZCBzaWRlXG4gICAgY29uc3Qgc2libGluZ1NpZGUgPSBzaWRlID09PSAnc3RhcnQnID8gJ3ByZXZpb3VzU2libGluZycgOiAnbmV4dFNpYmxpbmcnO1xuICAgIHJldHVybiBhbmNlc3RvcnNVcFRvQmxvY2suZXZlcnkoYW5jZXN0b3IgPT4ge1xuICAgICAgICBsZXQgc2libGluZyA9IGFuY2VzdG9yW3NpYmxpbmdTaWRlXTtcbiAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgc2libGluZyAmJlxuICAgICAgICAgICAgX2lzVGV4dE5vZGUoc2libGluZykgJiZcbiAgICAgICAgICAgIHNpYmxpbmcudGV4dENvbnRlbnQubWF0Y2gob25seVRhYnNTcGFjZXNBbmROZXdMaW5lcylcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBzaWJsaW5nID0gc2libGluZ1tzaWJsaW5nU2lkZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFzaWJsaW5nO1xuICAgIH0pO1xufVxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBpcyBhIHRleHQgbm9kZSwgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSBub2RlIHRvIGNoZWNrXG4gKi9cbmZ1bmN0aW9uIF9pc1RleHROb2RlKG5vZGU6IE5vZGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREU7XG59XG4iLCJpbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4vdXRpbHMnO1xuXG4vKipcbiAqIFRoZSBmb2xsb3dpbmcgaXMgYSBjb21wbGV0ZSBsaXN0IG9mIGFsbCBIVE1MIFwiYmxvY2stbGV2ZWxcIiBlbGVtZW50cy5cbiAqXG4gKiBTb3VyY2U6XG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0Jsb2NrLWxldmVsX2VsZW1lbnRzXG4gKlxuICogKi9cbmNvbnN0IGJsb2NrVGFnTmFtZXMgPSBbXG4gICAgJ0FERFJFU1MnLFxuICAgICdBUlRJQ0xFJyxcbiAgICAnQVNJREUnLFxuICAgICdCTE9DS1FVT1RFJyxcbiAgICAnREVUQUlMUycsXG4gICAgJ0RJQUxPRycsXG4gICAgJ0REJyxcbiAgICAnRElWJyxcbiAgICAnREwnLFxuICAgICdEVCcsXG4gICAgJ0ZJRUxEU0VUJyxcbiAgICAnRklHQ0FQVElPTicsXG4gICAgJ0ZJR1VSRScsXG4gICAgJ0ZPT1RFUicsXG4gICAgJ0ZPUk0nLFxuICAgICdIMScsXG4gICAgJ0gyJyxcbiAgICAnSDMnLFxuICAgICdINCcsXG4gICAgJ0g1JyxcbiAgICAnSDYnLFxuICAgICdIRUFERVInLFxuICAgICdIR1JPVVAnLFxuICAgICdIUicsXG4gICAgJ0xJJyxcbiAgICAnTUFJTicsXG4gICAgJ05BVicsXG4gICAgJ09MJyxcbiAgICAnUCcsXG4gICAgJ1BSRScsXG4gICAgJ1NFQ1RJT04nLFxuICAgICdUQUJMRScsXG4gICAgJ1VMJyxcbiAgICAvLyBUaGUgZm9sbG93aW5nIGVsZW1lbnRzIGFyZSBub3QgaW4gdGhlIFczQyBsaXN0LCBmb3Igc29tZSByZWFzb24uXG4gICAgJ1RSJyxcbiAgICAnVEQnLFxuICAgICdUQk9EWScsXG4gICAgJ1RIRUFEJyxcbiAgICAnVEgnLFxuXTtcblxuY29uc3QgY29tcHV0ZWRTdHlsZXMgPSBuZXcgV2Vha01hcDxOb2RlLCBDU1NTdHlsZURlY2xhcmF0aW9uPigpO1xuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGlzIGEgYmxvY2stbGV2ZWwgZWxlbWVudCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSBub2RlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Jsb2NrKG5vZGU6IE5vZGUpOiBib29sZWFuIHtcbiAgICBsZXQgcmVzdWx0OiBib29sZWFuO1xuICAgIGlmIChub2RlIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICBjb25zdCB0YWdOYW1lID0gbm9kZU5hbWUobm9kZSk7XG4gICAgICAgIC8vIGV2ZXJ5IGN1c3RvbSBqdy0qIG5vZGUgd2lsbCBiZSBjb25zaWRlcmVkIGFzIGJsb2Nrc1xuICAgICAgICBpZiAodGFnTmFtZS5zdGFydHNXaXRoKCdKVy0nKSB8fCB0YWdOYW1lID09PSAnVCcpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdlIHdvbid0IGNhbGwgYGdldENvbXB1dGVkU3R5bGVgIG1vcmUgdGhhbiBvbmNlIHBlciBub2RlLlxuICAgICAgICBsZXQgc3R5bGUgPSBjb21wdXRlZFN0eWxlcy5nZXQobm9kZSk7XG4gICAgICAgIGlmICghc3R5bGUpIHtcbiAgICAgICAgICAgIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIG5vZGUgbWlnaHQgbm90IGJlIGluIHRoZSBET00sIGluIHdoaWNoIGNhc2UgaXQgaGFzIG5vIENTUyB2YWx1ZXMuXG4gICAgICAgIGlmIChzdHlsZS5kaXNwbGF5KSB7XG4gICAgICAgICAgICByZXN1bHQgPSAhc3R5bGUuZGlzcGxheS5pbmNsdWRlcygnaW5saW5lJykgJiYgc3R5bGUuZGlzcGxheSAhPT0gJ2NvbnRlbnRzJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGJsb2NrVGFnTmFtZXMuaW5jbHVkZXModGFnTmFtZSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsImltcG9ydCB7IENhcmV0UG9zaXRpb24gfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9FdmVudE5vcm1hbGl6ZXInO1xuaW1wb3J0IHsgdGFyZ2V0RGVlcGVzdCB9IGZyb20gJy4vRG9tJztcbmltcG9ydCB7IGdldERvY3VtZW50IH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBlbGVtZW50RnJvbVBvaW50KFxuICAgIHg6IG51bWJlcixcbiAgICB5OiBudW1iZXIsXG4gICAgcm9vdDogRG9jdW1lbnQgfCBTaGFkb3dSb290ID0gZG9jdW1lbnQsXG4pOiBOb2RlIHtcbiAgICBsZXQgZWxlbWVudCA9IHJvb3QuZWxlbWVudEZyb21Qb2ludCh4LCB5KTtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICByb290ID0gZWxlbWVudC5vd25lckRvY3VtZW50O1xuICAgICAgICB3aGlsZSAoZWxlbWVudC5zaGFkb3dSb290KSB7XG4gICAgICAgICAgICByb290ID0gZWxlbWVudC5zaGFkb3dSb290O1xuICAgICAgICAgICAgZWxlbWVudCA9IHJvb3QuZWxlbWVudEZyb21Qb2ludCh4LCB5KTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnNoYWRvd1Jvb3QgPT09IHJvb3QpIHtcbiAgICAgICAgICAgICAgICBpZiAocm9vdC5maXJzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gcm9vdC5sYXN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54ID4geCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IHJvb3QuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FyZXRQb3NpdGlvbkZyb21Qb2ludChcbiAgICB4OiBudW1iZXIsXG4gICAgeTogbnVtYmVyLFxuICAgIHJvb3Q6IERvY3VtZW50IHwgU2hhZG93Um9vdCA9IGRvY3VtZW50LFxuKTogQ2FyZXRQb3NpdGlvbiB7XG4gICAgaWYgKCgheCAmJiB4ICE9PSAwKSB8fCAoIXkgJiYgeSAhPT0gMCkpIHJldHVybjtcblxuICAgIC8vIFRoZXJlIGlzIG5vIGNyb3NzLWJyb3dzZXIgZnVuY3Rpb24gZm9yIHRoaXMsIGJ1dCB0aGUgdGhyZWUgZnVuY3Rpb25zIGJlbG93XG4gICAgLy8gY292ZXIgYWxsIG1vZGVybiBicm93c2VycyBhcyB3ZWxsIGFzIHRoZSBzaGFkb3cgRE9NLlxuICAgIGxldCBjYXJldFBvc2l0aW9uOiBDYXJldFBvc2l0aW9uO1xuXG4gICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRGcm9tUG9pbnQoeCwgeSwgcm9vdCk7XG5cbiAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJvb3QgPSBnZXREb2N1bWVudChlbGVtZW50KTtcbiAgICBpZiAocm9vdC5jYXJldFBvc2l0aW9uRnJvbVBvaW50KSB7XG4gICAgICAgIGNhcmV0UG9zaXRpb24gPSByb290LmNhcmV0UG9zaXRpb25Gcm9tUG9pbnQoeCwgeSk7XG4gICAgfSBlbHNlIGlmIChyb290IGluc3RhbmNlb2YgU2hhZG93Um9vdCkge1xuICAgICAgICAvLyBGaW5kIHRoZSBuZWFyZXN0IG5vZGUgbGVhZiBvciBjaGFyIGluIGxlYWYuXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY2FyZXRQb3NpdGlvbkZyb21Qb2ludEluU2hhZG93RG9tKHgsIHksIGVsZW1lbnQpO1xuICAgICAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIGNhcmV0UG9zaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0Tm9kZTogcG9zaXRpb24ubm9kZSxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IHBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjYXJldFJhbmdlID0gcm9vdC5jYXJldFJhbmdlRnJvbVBvaW50KHgsIHkpO1xuICAgICAgICBjYXJldFBvc2l0aW9uID0gY2FyZXRSYW5nZSAmJiB7XG4gICAgICAgICAgICBvZmZzZXROb2RlOiBjYXJldFJhbmdlLnN0YXJ0Q29udGFpbmVyLFxuICAgICAgICAgICAgb2Zmc2V0OiBjYXJldFJhbmdlLnN0YXJ0T2Zmc2V0LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGlmIChjYXJldFBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnN0IFtvZmZzZXROb2RlLCBvZmZzZXRdID0gdGFyZ2V0RGVlcGVzdChjYXJldFBvc2l0aW9uLm9mZnNldE5vZGUsIGNhcmV0UG9zaXRpb24ub2Zmc2V0KTtcbiAgICAgICAgcmV0dXJuIHsgb2Zmc2V0Tm9kZSwgb2Zmc2V0IH07XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjYXJldFBvc2l0aW9uRnJvbVBvaW50SW5TaGFkb3dEb20oXG4gICAgeDogbnVtYmVyLFxuICAgIHk6IG51bWJlcixcbiAgICBlbGVtZW50OiBOb2RlLFxuKTogeyBub2RlOiBOb2RlOyBvZmZzZXQ6IG51bWJlciB9IHtcbiAgICBjb25zdCByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgbGV0IGRpc3RYID0gSW5maW5pdHk7XG4gICAgbGV0IGRpc3RZID0gSW5maW5pdHk7XG4gICAgbGV0IG5vZGU6IE5vZGU7XG4gICAgbGV0IG9mZnNldDogbnVtYmVyO1xuXG4gICAgY29uc3QgbGVhZnM6IE5vZGVbXSA9IFtdO1xuICAgIGNvbnN0IGVsZW1lbnRzOiBOb2RlW10gPSBbZWxlbWVudF07XG4gICAgd2hpbGUgKGVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHMuc2hpZnQoKTtcbiAgICAgICAgaWYgKGVsZW1lbnQuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGVsZW1lbnRzLnB1c2goLi4uZWxlbWVudC5jaGlsZE5vZGVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxlYWZzLnB1c2goZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaW5kIHRoZSBuZWFyZXN0IG5vZGUgbGVhZi5cbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhZnMpIHtcbiAgICAgICAgbGV0IGJveDogRE9NUmVjdDtcbiAgICAgICAgaWYgKGxlYWYgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG4gICAgICAgICAgICBib3ggPSBsZWFmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobGVhZiwgMCk7XG4gICAgICAgICAgICByYW5nZS5zZXRFbmQobGVhZiwgbGVhZi50ZXh0Q29udGVudC5sZW5ndGgpO1xuICAgICAgICAgICAgYm94ID0gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJveC55ICsgYm94LmhlaWdodCA8IHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnRPZmZzZXQgPSAwO1xuICAgICAgICBsZXQgbmV3RGlzdFk6IG51bWJlcjtcbiAgICAgICAgaWYgKGJveC55IDw9IHkgJiYgYm94LnkgKyBib3guaGVpZ2h0ID49IHkpIHtcbiAgICAgICAgICAgIG5ld0Rpc3RZID0gMDtcbiAgICAgICAgICAgIGlmIChsZWFmLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRPZmZzZXQgPSBnZXROZWFyZXN0Q2hhck9mZnNldCh4LCB5LCBsZWFmKTtcbiAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChsZWFmLCBjdXJyZW50T2Zmc2V0KTtcbiAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQobGVhZiwgY3VycmVudE9mZnNldCk7XG4gICAgICAgICAgICAgICAgYm94ID0gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdEaXN0WSA9IE1hdGguYWJzKGJveC55ICsgYm94LmhlaWdodCAvIDIgLSB5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBuZXdEaXN0WDogbnVtYmVyO1xuICAgICAgICBpZiAoYm94LnggPD0geCAmJiBib3gueCArIGJveC53aWR0aCA+PSB4KSB7XG4gICAgICAgICAgICBuZXdEaXN0WCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdEaXN0WCA9IE1hdGguYWJzKGJveC54ICsgYm94LndpZHRoIC8gMiAtIHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5ld0Rpc3RZIDwgZGlzdFkpIHtcbiAgICAgICAgICAgIGRpc3RZID0gbmV3RGlzdFk7XG4gICAgICAgICAgICBkaXN0WCA9IG5ld0Rpc3RYO1xuICAgICAgICAgICAgbm9kZSA9IGxlYWY7XG4gICAgICAgICAgICBvZmZzZXQgPSBjdXJyZW50T2Zmc2V0O1xuICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgbmV3RGlzdFkgPT09IGRpc3RZICYmXG4gICAgICAgICAgICAoKG5ld0Rpc3RZID09PSAwICYmIG5ld0Rpc3RYIDw9IGRpc3RYKSB8fCAobmV3RGlzdFkgIT09IDAgJiYgbmV3RGlzdFggPiBkaXN0WCkpXG4gICAgICAgICkge1xuICAgICAgICAgICAgZGlzdFkgPSBuZXdEaXN0WTtcbiAgICAgICAgICAgIGRpc3RYID0gbmV3RGlzdFg7XG4gICAgICAgICAgICBub2RlID0gbGVhZjtcbiAgICAgICAgICAgIG9mZnNldCA9IGN1cnJlbnRPZmZzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpc3RYID09PSAwICYmIGRpc3RZID09PSAwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBub2RlICYmIHsgbm9kZSwgb2Zmc2V0IH07XG59XG5cbmZ1bmN0aW9uIGdldE5lYXJlc3RDaGFyT2Zmc2V0KHg6IG51bWJlciwgeTogbnVtYmVyLCB0ZXh0OiBOb2RlKTogbnVtYmVyIHtcbiAgICAvLyBTZWFyY2ggd2l0aCBhIHBzZXVkbyBkaWNob3RvbWljIGZvciBwZXJmb3JtYW5jZS5cbiAgICBjb25zdCByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgY29uc3QgcG9zVG9UZXN0ID0gW1swLCB0ZXh0LnRleHRDb250ZW50Lmxlbmd0aF1dO1xuICAgIGNvbnN0IHZlcnRpY2FsTWF0Y2hlczogbnVtYmVyW11bXSA9IFtdO1xuICAgIHdoaWxlIChwb3NUb1Rlc3QubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHBvcyA9IHBvc1RvVGVzdC5wb3AoKTtcbiAgICAgICAgcmFuZ2Uuc2V0U3RhcnQodGV4dCwgcG9zWzBdKTtcbiAgICAgICAgcmFuZ2Uuc2V0RW5kKHRleHQsIHBvc1sxXSk7XG4gICAgICAgIGNvbnN0IGJveCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIGlmIChib3gueSA8PSB5ICYmIGJveC55ICsgYm94LmhlaWdodCA+PSB5KSB7XG4gICAgICAgICAgICBpZiAoYm94LnggPD0geCAmJiBib3gueCArIGJveC53aWR0aCA+PSB4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvc1sxXSAtIHBvc1swXSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBib3gueCArIGJveC53aWR0aCAvIDIgPD0geCA/IHBvc1sxXSA6IHBvc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgYWxmID0gTWF0aC5mbG9vcigocG9zWzBdICsgcG9zWzFdKSAvIDIpO1xuICAgICAgICAgICAgICAgIHBvc1RvVGVzdC5wdXNoKFtwb3NbMF0sIGFsZl0sIFthbGYsIHBvc1sxXV0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbE1hdGNoZXMucHVzaChwb3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGlkIG5vdCBmb3VuZCB0aGUgY2hhciwgZWc6IHVzZXIgY2xpY2sgb24gbGVmdCBhYm92ZSB0aGUgY29udGFpbmVyIGxpa2VcbiAgICAvLyB0aGUgYnJvd3NlciB3ZSBnZXQgdGhlIG5lYXJlc3QgY2hhciBhdCB0aGUgc2FtZSBjdXJzb3Igb2YgdGhlIHBvaW50ZXIuXG4gICAgbGV0IGRpc3QgPSBJbmZpbml0eTtcbiAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICBmb3IgKGNvbnN0IHBvcyBvZiB2ZXJ0aWNhbE1hdGNoZXMucmV2ZXJzZSgpKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBwb3NbMF07IGkgPCBwb3NbMV07IGkrKykge1xuICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQodGV4dCwgaSk7XG4gICAgICAgICAgICByYW5nZS5zZXRFbmQodGV4dCwgaSArIDEpO1xuICAgICAgICAgICAgY29uc3QgYm94ID0gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCBkeCA9IGJveC54ICsgYm94LndpZHRoIC8gMjtcbiAgICAgICAgICAgIGNvbnN0IGR5ID0gYm94LnkgKyBib3guaGVpZ2h0IC8gMjtcbiAgICAgICAgICAgIGNvbnN0IGRlbHRhID0gTWF0aC5wb3coZHggLSB4LCAyKSArIE1hdGgucG93KGR5IC0geSwgNCk7XG4gICAgICAgICAgICBpZiAoZGVsdGEgPD0gZGlzdCkge1xuICAgICAgICAgICAgICAgIGRpc3QgPSBkZWx0YTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBpICsgKGR4IDwgeCA/IDEgOiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2Zmc2V0O1xufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCB0eXBlIENvbnN0cnVjdG9yPFQ+ID0gbmV3ICguLi5hcmdzKSA9PiBUO1xuXG4vKipcbiAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBjb25zdHJ1Y3RvciBpcyBhIGNvbnN0cnVjdG9yIG9mIGdpdmVuIHN1cGVyQ2xhc3MuXG4gKlxuICogQHBhcmFtIGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0gc3VwZXJDbGFzc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb25zdHJ1Y3RvcjxUIGV4dGVuZHMgRnVuY3Rpb24+KGNvbnN0cnVjdG9yLCBzdXBlckNsYXNzOiBUKTogY29uc3RydWN0b3IgaXMgVCB7XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yLnByb3RvdHlwZSBpbnN0YW5jZW9mIHN1cGVyQ2xhc3MgfHwgY29uc3RydWN0b3IgPT09IHN1cGVyQ2xhc3M7XG59XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBub2RlIGhhcyB0aGUgYGNvbnRlbnRFZGl0YWJsZWAgYXR0cmlidXRlLlxuICpcbiAqIEBwYXJhbSBub2RlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNDb250ZW50RWRpdGFibGUobm9kZTogQWJzdHJhY3ROb2RlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG5vZGUubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LmhhcygnY29udGVudEVkaXRhYmxlJykgfHwgZmFsc2U7XG59XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBub2RlIGhhcyB0aGUgYGNvbnRlbnRFZGl0YWJsZWAgYXR0cmlidXRlIHNldCB0byB0cnVlLiBUaGlzXG4gKiBpbXBsaWVzIHRoYXQgaXRzIGNoaWxkcmVuIGFyZSBlZGl0YWJsZSBidXQgaXQgaXMgbm90IG5lY2Vzc2FyaWx5IGl0c2VsZlxuICogZWRpdGFibGUuXG4gKlxuICogVE9ETzogdW5iaW5kIGZyb20gYEF0dHJpYnV0ZXNgLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb250ZW50RWRpdGFibGUobm9kZTogQWJzdHJhY3ROb2RlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgZWRpdGFibGUgPSBub2RlLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5nZXQoJ2NvbnRlbnRFZGl0YWJsZScpO1xuICAgIHJldHVybiBlZGl0YWJsZSA9PT0gJycgfHwgZWRpdGFibGU/LnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJyB8fCBmYWxzZTtcbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgb2JqZWN0IGEgaXMgZGVlcCBlcXVhbCB0byBvYmplY3QgYiwgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSBhXG4gKiBAcGFyYW0gYlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcEVxdWFsT2JqZWN0cyhhOiBvYmplY3QsIGI6IG9iamVjdCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFLZXlzID0gT2JqZWN0LmtleXMoYSk7XG4gICAgaWYgKGFLZXlzLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMoYikubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgZm9yIChjb25zdCBrZXkgb2YgYUtleXMpIHtcbiAgICAgICAgY29uc3QgYVZhbHVlID0gYVtrZXldO1xuICAgICAgICBjb25zdCBiVmFsdWUgPSBiW2tleV07XG4gICAgICAgIGlmICh0eXBlb2YgYVZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKCFkZWVwRXF1YWxPYmplY3RzKGFWYWx1ZSwgYlZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhVmFsdWUgIT09IGJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGFycmF5IHdpdGggYWxsIHN1Yi1hcnJheSBlbGVtZW50cyBjb25jYXRlbmF0ZWQgaW50byBpdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZsYXQ8VD4oYXJyOiBUW11bXSk6IFRbXSB7XG4gICAgcmV0dXJuIFtdLmNvbmNhdCguLi5hcnIpO1xufVxuXG4vKipcbiAqIENvbnZlcnQgY2VydGFpbiBzcGVjaWFsIGNoYXJhY3RlcnMgdG8gdW5pY29kZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvVW5pY29kZShzdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHN0cmluZyA9PT0gJyAnKSB7XG4gICAgICAgIHJldHVybiAnXFx1MDBBMCc7XG4gICAgfVxuICAgIGlmIChzdHJpbmcgPT09ICdcXG4nKSB7XG4gICAgICAgIHJldHVybiAnXFx1MDAwZCc7XG4gICAgfVxuICAgIGlmIChzdHJpbmcgPT09ICdcXHQnKSB7XG4gICAgICAgIHJldHVybiAnXFx1MDAwOSc7XG4gICAgfVxuICAgIHJldHVybiBzdHJpbmc7XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSBsZW5ndGggb2YgYSBET00gTm9kZS5cbiAqXG4gKiBAcGFyYW0gbm9kZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9kZUxlbmd0aChub2RlOiBOb2RlKTogbnVtYmVyIHtcbiAgICBjb25zdCBpc1RleHROb2RlID0gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREU7XG4gICAgY29uc3QgY29udGVudCA9IGlzVGV4dE5vZGUgPyBub2RlLm5vZGVWYWx1ZSA6IG5vZGUuY2hpbGROb2RlcztcbiAgICByZXR1cm4gY29udGVudC5sZW5ndGg7XG59XG5cbi8qKlxuICogUmV0dXJuIGEgZHVwbGljYXRlLWZyZWUgdmVyc2lvbiBvZiBhbiBhcnJheS5cbiAqXG4gKiBAcGFyYW0gYXJyYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc3RpbmN0PFQ+KGFycmF5OiBBcnJheTxUPik6IEFycmF5PFQ+IHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KGFycmF5KSk7XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSB1cHBlcmNhc2UgbmFtZSBvZiB0aGUgZ2l2ZW4gRE9NIG5vZGUuXG4gKlxuICogQHBhcmFtIG5vZGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vZGVOYW1lKG5vZGU6IE5vZGUpOiBzdHJpbmcge1xuICAgIHJldHVybiBub2RlLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREb2N1bWVudChub2RlOiBOb2RlKTogRG9jdW1lbnQgfCBTaGFkb3dSb290IHtcbiAgICBsZXQgcm9vdDogRG9jdW1lbnQgfCBTaGFkb3dSb290O1xuICAgIHdoaWxlIChub2RlICYmICFyb290KSB7XG4gICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgRG9jdW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIHJvb3QgPSBub2RlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcm9vdCB8fCBkb2N1bWVudDtcbn1cblxuLy8gRmxhdHRlbnMgdHdvIHVuaW9uIHR5cGVzIGludG8gYSBzaW5nbGUgdHlwZSB3aXRoIG9wdGlvbmFsIHZhbHVlc1xuLy8gaS5lLiBGbGF0dGVuVW5pb248eyBhOiBudW1iZXIsIGM6IG51bWJlciB9IHwgeyBiOiBzdHJpbmcsIGM6IG51bWJlciB9PiA9IHsgYT86IG51bWJlciwgYj86IHN0cmluZywgYzogbnVtYmVyIH1cbmV4cG9ydCB0eXBlIEZsYXR0ZW5VbmlvbjxUPiA9IHtcbiAgICBbSyBpbiBrZXlvZiBVbmlvblRvSW50ZXJzZWN0aW9uPFQ+XTogSyBleHRlbmRzIGtleW9mIFRcbiAgICAgICAgPyBUW0tdIGV4dGVuZHMge31bXVxuICAgICAgICAgICAgPyBUW0tdXG4gICAgICAgICAgICA6IFRbS10gZXh0ZW5kcyBvYmplY3RcbiAgICAgICAgICAgID8gRmxhdHRlblVuaW9uPFRbS10+XG4gICAgICAgICAgICA6IFRbS11cbiAgICAgICAgOiBVbmlvblRvSW50ZXJzZWN0aW9uPFQ+W0tdIHwgdW5kZWZpbmVkO1xufTtcblxuLy8gQ29udmVydHMgYSB1bmlvbiBvZiB0d28gdHlwZXMgaW50byBhbiBpbnRlcnNlY3Rpb25cbi8vIGkuZS4gQSB8IEIgLT4gQSAmIEJcbnR5cGUgVW5pb25Ub0ludGVyc2VjdGlvbjxVPiA9IChVIGV4dGVuZHMge31cbiAgPyAoazogVSkgPT4gdm9pZFxuICA6IG5ldmVyKSBleHRlbmRzIChrOiBpbmZlciBJKSA9PiB2b2lkXG4gICAgPyBJXG4gICAgOiBuZXZlcjtcbiJdLCJzb3VyY2VSb290IjoiIn0=
return JWEditor
});